<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
         xmlns:h="http://java.sun.com/jsf/html"
         xmlns:f="http://java.sun.com/jsf/core"
         xmlns:c="http://java.sun.com/jsp/jstl/core"
         xmlns:ui="http://java.sun.com/jsf/facelets"
         xmlns:p="http://primefaces.org/ui"
         xmlns:pe="http://primefaces.org/ui/extensions"
         xmlns:ssicc="http://java.sun.com/jsf/composite/componentes/ssicc"
         xmlns:composite="http://java.sun.com/jsf/composite">
 <h:head>
   
   <title>This will not be present in rendered output</title>
 </h:head>
 <h:body>
   <composite:interface displayName="label texto" >
      <composite:attribute name="id" required="true" />
      <composite:attribute name="required" required="false" default="false"/>
      <composite:attribute name="readonly" required="false" default="false" />
      <composite:attribute name="class" required="false" />
      <composite:attribute name="manage" required="true" />
      <composite:attribute name="value"  required="true" />
      <composite:attribute name="deshabilitado"   required="false" default="false" />
      <composite:attribute name="mostrarPopup"   required="false" default="true" />
      <composite:attribute name="mostrarCheckBoxPopup"   required="false" default="false"/> 
      <composite:attribute name="activarEnter"  required="false" default="false"/>
      <composite:attribute name="actionListener" required="false" method-signature="void f(java.lang.String)" />  
      <composite:attribute name="activarBlurAjax" required="false" default="true"  />
      <composite:attribute name="update" required="false" default=" " />
   </composite:interface>
   
   <composite:implementation>    
    
	    <h:panelGrid id="panelcampanya" columns="6" border="0" styleClass="clsPanelGridSinMargen">
	 	    	<h:inputText id="campanya" size="12" required="#{cc.attrs.required}" 
	  			   maxlength="6" 
	  			   styleClass="#{component.valid ? 'cls-inputfield' : 'ui-state-error'}"
	  			   onkeypress="return soloNumero(event);"
	  			   value="#{cc.attrs.value}"
	  			   disabled="#{cc.attrs.deshabilitado}"
	  			   readonly="#{cc.attrs.readonly}">
	  			   
	  			   <c:if test="${cc.attrs.activarBlurAjax}">
		               <p:ajax event="blur"/>
		          </c:if>
	  			   
	  			   <c:if test="${cc.attrs.activarEnter}">
	  			      <p:ajax event="keyup" process="@this" onstart="if(event.keyCode == 13) return true;else return false;" 
	  			              listener="#{cc.attrs.actionListener}" update="#{cc.attrs.update}"  />
	  			   </c:if>
	  			</h:inputText>
	
	    <c:if test="${not cc.attrs.readonly}">
	  		<c:if test="${not cc.attrs.deshabilitado}">
  			    <c:if test="${cc.attrs.mostrarPopup}">
		 			<p:commandLink  style="margin:0" id="#{cc.id}_idCampaignCalendar" >
			    		<p:graphicImage value="#{resource['images:iconCalendar.gif']}" style="border:0px; vertical-align:middle;"/>&nbsp; 
			    	</p:commandLink> 
				     
				    <p:overlayPanel id="campaignPanelOverlay" 
			   	            for="#{cc.id}_idCampaignCalendar" 
			   	            hideEffect="fade" 
			   	            appendTo="@(body)" 
			   	    		my="left top" 
			   	    		at="right top"
			   	    		widgetVar="#{cc.id}_campanyaDialogVar">
				        
					            <h:panelGrid id="panelCampanyas" columns="3" styleClass="#{cc.attrs.class}">
					            	
					            	<p:commandLink id="anyoAnterior" onclick="actualizarAnyo('#{cc.clientId}',-1);" value="&lt;&lt;" styleClass="clsLabelRequerido" style="align:center;" />
									
									<h:inputText id="currentYear" value="#{cc.attrs.manage.anyoPeriodo}" size="4" 
												required="#{cc.attrs.required}" maxlength="4" styleClass="clsLabelRequerido" readonly="true" style="align:center;">
							    		<f:validateBean/>
							    	</h:inputText>
									
									<p:commandLink id="anyoSiguiente" onclick="actualizarAnyo('#{cc.clientId}',1);" value="&gt;&gt;" styleClass="clsLabelRequerido" style="align:center;"/>					
					            	            		
					            	<p:commandLink id="c01" oncomplete="eleccionCampanya('#{cc.clientId}','01');PF('#{cc.id}_campanyaDialogVar').hide();" value="C01" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c02" oncomplete="eleccionCampanya('#{cc.clientId}','02');PF('#{cc.id}_campanyaDialogVar').hide();" value="C02" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c03" oncomplete="eleccionCampanya('#{cc.clientId}','03');PF('#{cc.id}_campanyaDialogVar').hide();" value="C03" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c04" oncomplete="eleccionCampanya('#{cc.clientId}','04');PF('#{cc.id}_campanyaDialogVar').hide();" value="C04" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c05" oncomplete="eleccionCampanya('#{cc.clientId}','05');PF('#{cc.id}_campanyaDialogVar').hide();" value="C05" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c06" oncomplete="eleccionCampanya('#{cc.clientId}','06');PF('#{cc.id}_campanyaDialogVar').hide();" value="C06" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c07" oncomplete="eleccionCampanya('#{cc.clientId}','07');PF('#{cc.id}_campanyaDialogVar').hide();" value="C07" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c08" oncomplete="eleccionCampanya('#{cc.clientId}','08');PF('#{cc.id}_campanyaDialogVar').hide();" value="C08" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c09" oncomplete="eleccionCampanya('#{cc.clientId}','09');PF('#{cc.id}_campanyaDialogVar').hide();" value="C09" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c10" oncomplete="eleccionCampanya('#{cc.clientId}','10');PF('#{cc.id}_campanyaDialogVar').hide();" value="C10" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c11" oncomplete="eleccionCampanya('#{cc.clientId}','11');PF('#{cc.id}_campanyaDialogVar').hide();" value="C11" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c12" oncomplete="eleccionCampanya('#{cc.clientId}','12');PF('#{cc.id}_campanyaDialogVar').hide();" value="C12" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c13" oncomplete="eleccionCampanya('#{cc.clientId}','13');PF('#{cc.id}_campanyaDialogVar').hide();" value="C13" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c14" oncomplete="eleccionCampanya('#{cc.clientId}','14');PF('#{cc.id}_campanyaDialogVar').hide();" value="C14" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c15" oncomplete="eleccionCampanya('#{cc.clientId}','15');PF('#{cc.id}_campanyaDialogVar').hide();" value="C15" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c16" oncomplete="eleccionCampanya('#{cc.clientId}','16');PF('#{cc.id}_campanyaDialogVar').hide();" value="C16" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c17" oncomplete="eleccionCampanya('#{cc.clientId}','17');PF('#{cc.id}_campanyaDialogVar').hide();" value="C17" style="align:center;"></p:commandLink>
					            	<p:commandLink id="c18" oncomplete="eleccionCampanya('#{cc.clientId}','18');PF('#{cc.id}_campanyaDialogVar').hide();" value="C18" style="align:center;"></p:commandLink>
					    		</h:panelGrid>
				    </p:overlayPanel>
				</c:if>
				<c:if test="${cc.attrs.mostrarCheckBoxPopup}">
					 <p:selectBooleanCheckbox value = "#{cc.attrs.mostrarPopup}" >
						    	<p:ajax event="change" update="panelcampanya" />
					 </p:selectBooleanCheckbox>	
				</c:if>
		 	</c:if>
		 </c:if>
		    
	  </h:panelGrid>  	
	  <c:if test="${cc.attrs.mostrarCheckBoxPopup}">
				   
			    </c:if>
	   

	<script type="text/javascript"> 
		function actualizarAnyo(clientId, anyo){
			var idElemento = clientId + ":currentYear";	
				
			var idCurrentYear = document.getElementById(idElemento);					
			var anyoActual = parseInt(idCurrentYear.value);
			anyoActual =  anyoActual + parseInt(anyo);
			idCurrentYear.value = anyoActual; 
		}
	
		function eleccionCampanya(clientId, campanya, panelVar){
			var idElemento = clientId + ":currentYear";
			
			var anyoElegido = document.getElementById(idElemento).value;			
			var codCampanya = anyoElegido.concat(campanya);
			idElemento = clientId + ":campanya";
			document.getElementById(idElemento).value = codCampanya;
			document.getElementById(idElemento).onblur();
		}
		
	</script>
	
   </composite:implementation>
 </h:body>
</html>
