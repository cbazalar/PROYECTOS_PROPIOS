<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ssicc="http://java.sun.com/jsf/composite/componentes/ssicc"
	xmlns:bel="http://www.belcorp.biz/ssicc/components">

<body>

	<ui:composition template="/templates/templateConsultaSearch.xhtml">
		<ui:param name="mAlias"
			value="#{procesoSTOConsultaValidacionesAction}" />

		<ui:define name="titulo_Pantalla">
			<h:outputText
				value="#{i18n['procesoSTOConsultaValidacionesForm.title']}"
				styleClass="clsEncabezadoPantalla" />
		</ui:define>

		<ui:define name="body_criterio_busqueda">
			<h:panelGrid columns="2">
				<h:panelGroup>
					<h:panelGrid columns="2">
						<h:panelGrid columns="2" >	
							<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.codigoPais']}"	required="true" />
							<ssicc:label value="#{mPantallaPrincipalBean.currentUser.pais.descripcion}" header="true" required="true" />
	
							<ssicc:label key="#{i18n['procesoSTOEliminarPolizasFamiliaSeguraForm.tipoDocumento']}" required="true" />
							<ssicc:selectMenu id="tipoDocumento" value="#{mAlias.formBusqueda.tipoDocumento}" required="true">
								<f:selectItem itemLabel="" itemValue="" />
								<f:selectItems value="#{mAlias.stoTipoDocumentoList}" var="lista" itemLabel="#{lista.descripcion}" itemValue="#{lista.codigo}" />
							</ssicc:selectMenu>
							<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.codigoPeriodo']}" />
							<ssicc:campaignCalendar2 id="codigoCampanhaCDR" manage="#{mAlias}" value="#{mAlias.formBusqueda.codigoPeriodo}" />
	
							
						</h:panelGrid>
						<ssicc:labelBlank />
						
						<p:fieldset legend="#{i18n['procesoSTOConsultaValidacionesForm.carga']}">
				       		<h:panelGrid columns="10">
				       			<!-- Fecha Inicio -->
								<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.fechaInicio']}" />
								<p:calendar id="fecInicCarga"
											value="#{mAlias.formBusqueda.fechaInicioD}"
											pattern="dd/MM/yyyy HH:mm" mode="popup" showOn="button"
											navigator="true" popupIcon="#{resource['images:menu.png']}"
											locale="es" style="width:300px" popupIconOnly="true" mask="true" />
								<ssicc:labelBlank/><ssicc:labelBlank/>
								<!-- Fecha Fin -->
								<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.fechaFin']}" />
								<p:calendar id="fecFinCarga"
											value="#{mAlias.formBusqueda.fechaFinD}"
											pattern="dd/MM/yyyy HH:mm" mode="popup" showOn="button"
											navigator="true" popupIcon="#{resource['images:menu.png']}"
											locale="es" style="width:300px" popupIconOnly="true" mask="true" />	
							</h:panelGrid>					
				       	</p:fieldset>
			       		<p:fieldset legend="#{i18n['procesoSTOConsultaValidacionesForm.proceso']}">
				       		<h:panelGrid columns="10">
				       			<!-- Fecha Inicio -->
								<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.fechaInicio']}" />
								<p:calendar id="fechaInicioProceso"
											value="#{mAlias.formBusqueda.fechaInicioProcesoD}"
											pattern="dd/MM/yyyy HH:mm" mode="popup" showOn="button"
											navigator="true" popupIcon="#{resource['images:menu.png']}"
											locale="es" style="width:450px" popupIconOnly="true" mask="true" />	
								<ssicc:labelBlank/><ssicc:labelBlank/>
								<!-- Fecha Fin -->
								<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.fechaFin']}" />
								<p:calendar id="fechaFinProceso" 
											value="#{mAlias.formBusqueda.fechaFinProcesoD}"
											pattern="dd/MM/yyyy HH:mm" mode="popup" showOn="button"
											navigator="true" popupIcon="#{resource['images:menu.png']}"
											locale="es" style="width:350px" popupIconOnly="true" mask="true" />	
							</h:panelGrid>					
			       		</p:fieldset>
						<p:fieldset legend="#{i18n['procesoSTOConsultaValidacionesForm.seccionDocumento']}">
			       			<h:panelGrid columns="1">       			
				       			<ssicc:selectOneRadio id="IdTipo" value="#{mAlias.formBusqueda.indicadorDocumento}">
									<f:selectItem itemLabel="#{i18n['procesoSTOConsultaValidacionesForm.indicadorDocumento.Cabecera']}" itemValue="#{mAlias.stoTipoDocumentoCabecera}" />
									<f:selectItem itemLabel="#{i18n['procesoSTOConsultaValidacionesForm.indicadorDocumento.Detalle']}" itemValue="#{mAlias.stoTIpoDocumentoDetalle}" />
									<f:selectItem itemLabel="#{i18n['procesoSTOConsultaValidacionesForm.indicadorDocumento.Todos']}" itemValue="#{mAlias.stoTipoDocumentoTodos}" />
								</ssicc:selectOneRadio>
							</h:panelGrid>	
			       		</p:fieldset>
						<h:panelGrid columns="6" >	
							<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.numeroLote']}" />
							<p:inputText id="codigoLote" value="#{mAlias.formBusqueda.numeroLote}" maxlength="10"/>
							
							<ssicc:labelBlank/><ssicc:labelBlank/>
							
							<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.codigoCliente']}" />
							<p:inputText id="codigo" value="#{mAlias.formBusqueda.codigoCliente}" maxlength="20" size="15" />
							
							<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.numPreimpreso']}" />
							<p:inputText id="numPreimpreso" value="#{mAlias.formBusqueda.numPreimpreso}" onkeypress="verificarCodigoLote(this)" onchange="cambiarValorLote(this)" maxlength="15"/>
						</h:panelGrid>

						<!-- Region -->
						<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.regionList']}" esRight="false"/>
						<!-- Zona -->
						<ssicc:label key="#{i18n['procesoSTOConsultaValidacionesForm.zonaList']}" esRight="false"/>
						<ssicc:selectManyMenu id="codigoRegion"
							value="#{mAlias.formBusqueda.regionList}"
							process=":principalForm:zonaList @this"
							accionListener="#{procesoSTOConsultaValidacionesAction.loadZonas}"
							update=":principalForm:zonaList:select">
							<f:selectItem itemLabel="Todos" itemValue="" />
							<f:selectItems value="#{mAlias.siccRegionList}" var="lista"
								itemLabel="#{lista.descripcion}" itemValue="#{lista.codigo}" />
						</ssicc:selectManyMenu>

						<ssicc:selectManyMenu id="zonaList"
							value="#{mAlias.formBusqueda.zonaList}">
							<f:selectItems value="#{mAlias.siccZonaList}" var="lista"
								itemLabel="#{lista.label}" itemValue="#{lista.value}" />
						</ssicc:selectManyMenu>

						
						<ssicc:labelBlank />
						<ssicc:labelBlank />

					</h:panelGrid>
				</h:panelGroup>

				<h:panelGroup columns="4">
					<p:fieldset legend="Agrupado Por :" style="margin-bottom:20px">
						<h:panelGrid columns="2" styleClass="ui-panelgrid ui-widget"
							width="90%" title="Agrupado Por">
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.Periodo']}" />
							<p:selectBooleanCheckbox value="#{mAlias.agrupacionPeriodo}" />
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.FechaCarga']}" />
							<p:selectBooleanCheckbox value="#{mAlias.agrupacionFechaCarga}" />
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.FechaProceso']}" />
							<p:selectBooleanCheckbox value="#{mAlias.agrupacionFechaProceso}" />
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.Lote']}" />
							<p:selectBooleanCheckbox value="#{mAlias.agrupacionLote}" />
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.Region']}" />
							<p:selectBooleanCheckbox value="#{mAlias.agrupacionRegion}" />
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.Zona']}" />
							<p:selectBooleanCheckbox value="#{mAlias.agrupacionZona}" />
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.Cliente']}" />
							<p:selectBooleanCheckbox value="#{mAlias.agrupacionCliente}" />
							<h:outputText
								value="#{i18n['procesoSTOConsultaValidacionesForm.agrupacion.NumeroPreimpreso']}" />
							<p:selectBooleanCheckbox
								value="#{mAlias.agrupacionNumeroPreimpreso}" />

						</h:panelGrid>
					</p:fieldset>

				</h:panelGroup>



			</h:panelGrid>



			<h:panelGrid id="panelDatateble">

				<p:remoteCommand name="refreshFooter"
					update=":principalForm:dataTableTest:footerItems :principalForm:dataTableTest"
					process=":principalForm:dataTableTest" />

				<p:dataTable widgetVar="dataTableWidgetConsultaValidaciones"
					id="dataTableTest"
					emptyMessage="#{msg['dataTable.noExistenRegistrosFiltro']}"
					style="width:1200px;" var="lista" paginator="true"
					value="#{mAlias.stoListaValidaciones}"
					paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {Exporters}"
					currentPageReportTemplate="{totalRecords} registros encontrados"
					rows="#{mAlias.cantidadRowsDefaultDatatable}" rowIndexVar="rowIndex" rowKey="#{lista}"
					selection="#{mAlias.beanProcesoSTOConsultaValidaciones}"
					paginatorPosition="top">

					<!-- Exportar -->
					<f:facet name="{Exporters}">
					            &nbsp;&nbsp;&nbsp;&nbsp;
								<h:commandLink>
							<p:graphicImage value="#{resource['images:excelForm.png']}"
								width="26" height="24" title="#{msg['botonExcel.tooltip']}"
								styleClass="clsImagen" style="vertical-align:middle" />
							<p:dataExporter type="xls" target="dataTableTest"
								fileName="findSTOConsultaValidaciones"
								postProcessor="#{mDataExporterBean.postProcessXLS}" />
						</h:commandLink>

					</f:facet>

					<p:ajax event="page"
						listener="#{procesoSTOConsultaValidacionesAction.onPage}"
						update=":principalForm:dataTableTest:footerItems :principalForm:dataTableTest"
						oncomplete="refreshFooter();"
						process=":principalForm:dataTableTest @this" />


					<p:column style="width:70px" />

					<p:column headerText="#{i18n['stoListaValidaciones.tipoDocumento']}" width="120" exportable="true">
						<h:outputText value="#{lista.tipoDocumento}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.fecha']}" rendered="#{mAlias.agrupacionFechaCarga}" width="50" exportable="false">
						<h:outputText value="#{lista.fecha}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.fecha']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.fecha}" />
					</p:column>
					
					<p:column headerText="#{i18n['stoListaValidaciones.fechaModificacion']}" width="50" rendered="#{mAlias.agrupacionFechaProceso}" exportable="false">
						<h:outputText value="#{lista.fechaModificacion}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.fechaModificacion']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.fechaModificacion}" />
					</p:column>
					
					<p:column headerText="#{i18n['stoListaValidaciones.lote']}" width="60" rendered="#{mAlias.agrupacionLote}" exportable="false">
						<h:outputText value="#{lista.lote}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.lote']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.lote}" />
					</p:column>
					
					<p:column headerText="#{i18n['stoListaValidaciones.codRegion']}" width="65" rendered="#{mAlias.agrupacionRegion}" exportable="false">
						<h:outputText value="#{lista.codRegion}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.codRegion']}" width="65" exportable="true" style="display: none;">
						<h:outputText value="#{lista.codRegion}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.codZonaActual']}" exportable="false" rendered="#{ mAlias.formBusqueda.isActualizacionDatos eq '1' and mAlias.agrupacionCliente}" width="50">
						<h:outputText value="#{lista.codZonaActual}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.codZonaActual']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.codZonaActual}" />
					</p:column>
					
					<p:column headerText="#{i18n['stoListaValidaciones.codZona']}" rendered="#{mAlias.agrupacionZona}" width="50" exportable="false">
						<h:outputText value="#{lista.codZona}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.codZona']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.codZona}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.cliente']}" exportable="false" width="50" rendered="#{mAlias.formBusqueda.isActualizacionDatos ne '1' and mAlias.agrupacionCliente}">
						<h:outputText value="#{lista.cliente}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.cliente']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.cliente}" />
					</p:column>


					<p:column headerText="#{i18n['stoListaValidaciones.cliente']}" exportable="false" rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1' and mAlias.agrupacionCliente}" width="50">
						<h:outputText value="#{lista.cliente}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.nomcliente']}" rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1' and mAlias.agrupacionCliente}" width="80">
						<h:outputText value="#{lista.nomcliente}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.codigoPeriodo']}" rendered="#{mAlias.agrupacionPeriodo}" exportable="false" width="45">
						<h:outputText value="#{lista.codigoPeriodo}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.codigoPeriodo']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.codigoPeriodo}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.agrupacionNumeroPreimpreso']}" width="80" rendered="#{mAlias.agrupacionNumeroPreimpreso}" exportable="false">
						<h:outputText value="#{lista.numeroPreimpreso}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.agrupacionNumeroPreimpreso']}" exportable="true" style="display: none;">
						<h:outputText value="#{lista.numeroPreimpreso}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.indicadorDNInuevoCliente']}" rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1'}">
						<h:outputText value="#{lista.indicadorDNInuevoCliente}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.montoCupon']}" rendered="#{mAlias.formBusqueda.isCuponPago eq '1'}">
						<h:outputText value="#{lista.montoCupon}" />
					</p:column>
					
					<p:column headerText="#{i18n['stoListaValidaciones.totalCarga']}" style="text-align: right;" exportable="true" width="35">
						<h:outputText value="#{lista.totalCarga}" />
					</p:column>
					<p:column headerText="#{i18n['stoListaValidaciones.correctas']}" style="text-align: right;" exportable="true" width="50">
						<h:outputText value="#{lista.correctas}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.erradas']}" style="text-align: right;" exportable="true" width="40">
						<h:outputText value="#{lista.erradas}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.rechazadas']}" style="text-align: right;" exportable="true" width="50">
						<h:outputText value="#{lista.rechazadas}" />
					</p:column>

					<p:column headerText="#{i18n['stoListaValidaciones.detallesOK']}" width="70" style="text-align: right;" exportable="true">
						<h:outputText value="#{lista.detallesOK}" />
					</p:column>

					<p:columnGroup type="footer" id="footerItems">

						<p:row>
							<p:column footerText="SubTotales :" />
							<p:column rendered="true" />
							<p:column rendered="#{mAlias.agrupacionFechaCarga}" />
							<p:column rendered="#{mAlias.agrupacionFechaProceso}" />
							<p:column rendered="#{mAlias.agrupacionLote}" />
							<p:column rendered="#{mAlias.agrupacionRegion}" />
							<p:column rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1' and mAlias.agrupacionCliente}" />
							<p:column rendered="#{mAlias.agrupacionZona}" />
							<p:column rendered="#{mAlias.agrupacionCliente}" />
							<p:column rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1' and mAlias.agrupacionCliente}" />
							<p:column rendered="#{mAlias.agrupacionPeriodo}" />

							<p:column rendered="#{mAlias.agrupacionNumeroPreimpreso}" />

							<p:column rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1'}" />
							<p:column rendered="#{mAlias.formBusqueda.isCuponPago eq '1'}" />



							<p:column style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaSubtotalCargasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>
							<p:column 
								style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaSubtotalCorrectasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>

							<p:column 
								style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaSubtotalErradasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>

							<p:column 
								style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaSubtotalRechazadasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>

							<p:column
								style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaSubtotalDetallesOkT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>

						</p:row>

						<p:row>
							<p:column footerText="Totales :" />
							<p:column rendered="true" />
							<p:column rendered="#{mAlias.agrupacionFechaCarga}" />

							<p:column rendered="#{mAlias.agrupacionFechaProceso}" />

							<p:column rendered="#{mAlias.agrupacionLote}" />

							<p:column rendered="#{mAlias.agrupacionRegion}" />
							<p:column rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1' and mAlias.agrupacionCliente}" />
							<p:column rendered="#{mAlias.agrupacionZona}" />

							<p:column rendered="#{mAlias.agrupacionCliente}" />

							<p:column
								rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1' and mAlias.agrupacionCliente}" />

							<p:column rendered="#{mAlias.agrupacionPeriodo}" />

							<p:column rendered="#{mAlias.agrupacionNumeroPreimpreso}" />

							<p:column
								rendered="#{mAlias.formBusqueda.isActualizacionDatos eq '1'}" />

							<p:column rendered="#{mAlias.formBusqueda.isCuponPago eq '1'}" />

							<p:column 
								style="text-align: right;">

								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaCargasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>


							</p:column>

							<p:column 
								style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaCorrectasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>

							<p:column
								style="text-align: right;">

								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaErradasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>
							<p:column 
								style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaRechazadasT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>

							<p:column 
								style="text-align: right;">
								<f:facet name="footer">
									<h:outputText value="#{mAlias.sumaDetallesOkT}">
										<f:convertNumber locale="es_PE" />
									</h:outputText>
								</f:facet>
							</p:column>
						</p:row>

					</p:columnGroup>


				</p:dataTable>
			</h:panelGrid>
		</ui:define>
	</ui:composition>
</body>
</html>
