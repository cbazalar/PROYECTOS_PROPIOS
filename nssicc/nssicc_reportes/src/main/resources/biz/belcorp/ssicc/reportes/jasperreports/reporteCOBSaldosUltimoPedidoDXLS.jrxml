<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
		 name="reporteCOBSaldosUltimoPedidoDXLS"
		 columnCount="1"
		 printOrder="Vertical"
		 orientation="Portrait"
		 pageWidth="1100"
		 pageHeight="436118"
		 columnWidth="1100"
		 columnSpacing="0"
		 leftMargin="0"
		 rightMargin="0"
		 topMargin="0"
		 bottomMargin="0"
		 whenNoDataType="AllSectionsNoDetail"
		 isTitleNewPage="false"
		 isSummaryNewPage="false"
		 resourceBundle="ReportResources"
		 whenResourceMissingType="Empty">
	<property name="ireport.scriptlethandling" value="0" />
	<property name="ireport.encoding" value="UTF-8" />
	<import value="java.util.*" />
	<import value="net.sf.jasperreports.engine.*" />
	<import value="net.sf.jasperreports.engine.data.*" />

	<parameter name="parameterMap" isForPrompting="false" class="java.util.Map"/>
	<parameter name="condicion" isForPrompting="true" class="java.lang.String">
		<defaultValueExpression ><![CDATA[$P{parameterMap}.get("condicion")]]></defaultValueExpression>
	</parameter>
	<parameter name="codigoPeriodo" isForPrompting="false" class="java.lang.String">
		<defaultValueExpression ><![CDATA[$P{parameterMap}.get("codigoPeriodo")]]></defaultValueExpression>
	</parameter>
	<parameter name="codigoSociedad" isForPrompting="false" class="java.lang.String">
		<defaultValueExpression ><![CDATA[$P{parameterMap}.get("codigoSociedad")]]></defaultValueExpression>
	</parameter>
	<queryString><![CDATA[WITH temp1
 AS
   (SELECT psc.clie_oid_clie ,MAX(spc.cod_peri) ult_ped
   FROM ped_solic_cabec psc, 
             seg_socie ss,
             cra_perio cp, 
             seg_perio_corpo spc,
             ped_tipo_solic_pais ptsp,
             ped_tipo_solic pts 
    WHERE ss.oid_soci = psc.soci_oid_soci
    AND spc.oid_peri = cp.peri_oid_peri 
    AND psc.perd_oid_peri = cp.oid_peri
    AND psc.tspa_oid_tipo_soli_pais=ptsp.oid_tipo_soli_pais
    AND ptsp.tsol_oid_tipo_soli=pts.oid_tipo_soli
    AND pts.cod_tipo_soli='SOC'
    AND psc.esso_oid_esta_soli = 1
    AND psc.fec_fact IS NOT NULL
    AND ss.cod_soci=$P{codigoSociedad}
    HAVING  MAX(spc.cod_peri)=$P{codigoPeriodo}
    GROUP BY  psc.clie_oid_clie)
    SELECT *
    FROM 
    (SELECT      
       zz.cod_zona ZONA,
       mc.cod_clie CODIGO,
       mc.val_nom1 || ' ' || mc.val_nom2 || ' ' || mc.val_ape1 || ' ' || mc.val_ape2 NOMBRES,
       TRIM(FIN_PKG_GENER.FIN_FN_OBTIE_DIREC_CLIEN(mc.oid_clie) || ' ' || FIN_PKG_GENER.FIN_FN_OBTIE_DIREC_CLIEN_REFER(mc.oid_clie)) DIRECCION,
       TRIM(FIN_PKG_GENER.FIN_FN_OBTIE_NUMER_TELEF_CLIEN(mc.oid_clie,'TF') || ' ' ||                
       FIN_PKG_GENER.FIN_FN_OBTIE_NUMER_TELEF_CLIEN(mc.oid_clie,'TT') || ' ' ||                
       FIN_PKG_GENER.FIN_FN_OBTIE_NUMER_TELEF_CLIEN(mc.oid_clie,'TM')) TELEFONO,
       t1.ULT_PED,
       CCC_PKG_GENER.CCC_FN_OBTIE_SALDO_TOTAL(mc.oid_clie) SALDO_CONTABLE
    FROM temp1 t1,
              mae_clien mc,
              mae_clien_unida_admin mcua,
              zon_terri_admin zta,       
              zon_secci zs,
              zon_zona zz,
              zon_regio zr
    WHERE t1.clie_oid_clie=mc.oid_clie
    AND mc.oid_clie =mcua.clie_oid_clie
    AND mcua.Ind_Acti=1
    AND mcua.ztad_oid_terr_admi=zta.oid_terr_admi
    AND zta.zscc_oid_secc=zs.oid_secc
    AND zs.zzon_oid_zona=zz.oid_zona
    AND zr.oid_regi = zz.zorg_oid_regi
    $P!{condicion}) 
    ORDER BY SALDO_CONTABLE DESC]]></queryString>

	<field name="ZONA" class="java.lang.String"/>
	<field name="CODIGO" class="java.lang.String"/>
	<field name="NOMBRES" class="java.lang.String"/>
	<field name="DIRECCION" class="java.lang.String"/>
	<field name="TELEFONO" class="java.lang.String"/>
	<field name="ULT_PED" class="java.lang.String"/>
	<field name="SALDO_CONTABLE" class="java.math.BigDecimal"/>

		<background>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</background>
		<title>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</title>
		<pageHeader>
			<band height="24"  isSplitAllowed="true" >
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Opaque"
						x="0"
						y="0"
						width="48"
						height="24"
						forecolor="#000000"
						backcolor="#CCCCCC"
						key="textField-4"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font pdfFontName="Helvetica-Bold" size="7" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$R{reporteCOBSaldosUltimoPedidoForm.zona}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Opaque"
						x="98"
						y="0"
						width="254"
						height="24"
						forecolor="#000000"
						backcolor="#CCCCCC"
						key="textField-7"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font pdfFontName="Helvetica-Bold" size="7" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$R{reporteCOBSaldosUltimoPedidoForm.nombres}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Opaque"
						x="352"
						y="0"
						width="481"
						height="24"
						forecolor="#000000"
						backcolor="#CCCCCC"
						key="textField-11"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font pdfFontName="Helvetica-Bold" size="7" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$R{reporteCOBSaldosUltimoPedidoForm.direccion}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Opaque"
						x="833"
						y="0"
						width="108"
						height="24"
						forecolor="#000000"
						backcolor="#CCCCCC"
						key="textField-17"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font pdfFontName="Helvetica-Bold" size="7" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$R{reporteCOBSaldosUltimoPedidoForm.telefono}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Opaque"
						x="996"
						y="0"
						width="104"
						height="24"
						forecolor="#000000"
						backcolor="#CCCCCC"
						key="textField-22"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font pdfFontName="Helvetica-Bold" size="7" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$R{reporteCOBSaldosUltimoPedidoForm.saldo_contable}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Opaque"
						x="941"
						y="0"
						width="55"
						height="24"
						forecolor="#000000"
						backcolor="#CCCCCC"
						key="textField-23"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font pdfFontName="Helvetica-Bold" size="7" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$R{reporteCOBSaldosUltimoPedidoForm.ult_ped}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						mode="Opaque"
						x="48"
						y="0"
						width="50"
						height="24"
						forecolor="#000000"
						backcolor="#CCCCCC"
						key="textField-25"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font pdfFontName="Helvetica-Bold" size="7" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$R{reporteCOBSaldosUltimoPedidoForm.codigo}]]></textFieldExpression>
				</textField>
			</band>
		</pageHeader>
		<columnHeader>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnHeader>
		<detail>
			<band height="12"  isSplitAllowed="true" >
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="0"
						y="0"
						width="48"
						height="12"
						forecolor="#000000"
						key="textField"
						stretchType="RelativeToBandHeight"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{ZONA}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="98"
						y="0"
						width="254"
						height="12"
						forecolor="#000000"
						key="textField"
						stretchType="RelativeToBandHeight"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement verticalAlignment="Middle">
						<font size="7" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{NOMBRES}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="352"
						y="0"
						width="481"
						height="12"
						forecolor="#000000"
						key="textField"
						stretchType="RelativeToBandHeight"/>
					<box>					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement verticalAlignment="Middle">
						<font size="7" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{DIRECCION}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="833"
						y="0"
						width="108"
						height="12"
						forecolor="#000000"
						key="textField"
						stretchType="RelativeToBandHeight"/>
					<box>					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{TELEFONO}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="996"
						y="0"
						width="104"
						height="12"
						forecolor="#000000"
						key="textField"
						stretchType="RelativeToBandHeight"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="7" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.math.BigDecimal"><![CDATA[$F{SALDO_CONTABLE}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="941"
						y="0"
						width="55"
						height="12"
						forecolor="#000000"
						key="textField-24"
						stretchType="RelativeToBandHeight"/>
					<box>					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{ULT_PED}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="48"
						y="0"
						width="50"
						height="12"
						forecolor="#000000"
						key="textField-26"
						stretchType="RelativeToBandHeight"/>
					<box leftPadding="1" rightPadding="1">					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#999999"/>
					<bottomPen lineWidth="1.0" lineColor="#999999"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
</box>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" isStrikeThrough="false" />
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{CODIGO}]]></textFieldExpression>
				</textField>
			</band>
		</detail>
		<columnFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnFooter>
		<pageFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</pageFooter>
		<summary>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</summary>
</jasperReport>
