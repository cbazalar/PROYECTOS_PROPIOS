<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.ape.MantenimientoAPESQL">

	<typeAlias alias="baseGenerico"    	  type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
	<typeAlias alias="centroDistribucion" type="biz.belcorp.ssicc.dao.spusicc.ape.model.CentroDistribucion"/>
	<typeAlias alias="lineaArmado" 		  type="biz.belcorp.ssicc.dao.spusicc.ape.model.LineaArmado"/>
	<typeAlias alias="subLineaArmado" 	  type="biz.belcorp.ssicc.dao.spusicc.ape.model.SubLineaArmado"/>
	<typeAlias alias="tipoAnaquel" 		  type="biz.belcorp.ssicc.dao.spusicc.ape.model.TipoAnaquel"/>
	<typeAlias alias="ordenAnaquel" 	  type="biz.belcorp.ssicc.dao.spusicc.ape.model.OrdenAnaquel"/>
	<typeAlias alias="tipoCajaProducto"   type="biz.belcorp.ssicc.dao.spusicc.ape.model.TipoCajaProducto"/>
	<typeAlias alias="configuracionBalanceo" type="biz.belcorp.ssicc.dao.spusicc.ape.model.ConfiguracionBalanceo"/>
	<typeAlias alias="materialesVista"    type="biz.belcorp.ssicc.dao.spusicc.ape.model.MaterialesVista"/>
	<typeAlias alias="versionProducto"    type="biz.belcorp.ssicc.dao.spusicc.ape.model.VersionProducto"/>
	<typeAlias alias="cabeceraTipoAnaquel"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.TipoAnaquelMapaCD"/>
	<typeAlias alias="ConfiguracionBalanceoSubLinea"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.ConfiguracionBalanceoSubLinea"/>
	<typeAlias alias="FactorConversion"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.FactorConversion"/>
	<typeAlias alias="estimadoProducto"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.EstimadoProducto"/>
    <typeAlias alias="etiquetayListadoPicado"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.EtiquetayListadoPicado"/>
	<typeAlias alias="tipoCajaEmbalaje"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.TiposCajaEmbalaje"/>
	<typeAlias alias="consultaFacturasCajas"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.ConsultaFacturasCajas"/>
	<typeAlias alias="configuracionTextosVariables"  type="biz.belcorp.ssicc.dao.spusicc.ape.model.ConfiguracionTextosVariables"/>
	<typeAlias alias="controlEnvioWCS"    type="biz.belcorp.ssicc.dao.spusicc.ape.model.ControlEnvioWCS"/>
	<typeAlias alias="estadoOla"    	  type="biz.belcorp.ssicc.dao.spusicc.ape.model.EstadoOlaWCS"/>
	<typeAlias alias="copiarAsignarProductos"   type="biz.belcorp.ssicc.dao.spusicc.ape.model.CopiarAsignarProductos"/>
	<typeAlias alias="mantenimientoAPEProductoNoalmPlantaPrincipal"   type="biz.belcorp.ssicc.dao.spusicc.ape.model.MantenimientoAPEProductoNoalmPlantaPrincipal"/>
	
	<resultMap id="baseResult"          class="baseGenerico">
		<result property="codigo" 		column="CODIGO" 	/>
		<result property="descripcion" 	column="DESCRIPCION"/>
	</resultMap>
	
	<select id="getCodigoCentroDistribucionList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	a.cod_cent_dist as CODIGO,
				a.cod_cent_dist as DESCRIPCION
  		  FROM 	app_confi_centr_distr a
 		 WHERE  a.pais_oid_pais = to_number(#oidPais#)
	</select>
	
	<select id="getDescripcionCentroDistribucionList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	b.val_i18n as CODIGO,
       			b.val_i18n as DESCRIPCION
           FROM app_confi_centr_distr a,
       			gen_i18n_sicc_pais b
          WHERE a.pais_oid_pais = to_number(#oidPais#)
            AND b.attr_enti = 'APP_CONFI_CENTR_DISTR'
   			AND a.oid_conf_cent_dist = b.val_oid
	</select>
	
	<select id="getFuentePeriodoPreasignacionList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT FUENTE.VAL_CODI as CODIGO, 
       		I18.VAL_I18N as DESCRIPCION
  			FROM APE_FUENT_PERIO_PREAS FUENTE, GEN_I18N_SICC_COMUN I18
 			WHERE FUENTE.OID_FUENT_PERIO_PREAS = I18.VAL_OID
   				AND I18.ATTR_ENTI = 'APE_FUENT_PERIO_PREAS'
	</select>
	
	
	<resultMap id="centroDistribucionResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidCentro"			column="OID_CENTRO"/>
    	<result property="codCentro"			column="COD_CENTRO"/>
    	<result property="desCentro" 			column="DES_CENTRO"/>
    	<result property="valDefecto" 			column="VAL_DEFECTO"/>
    	<result property="nivOutsourcing" 		column="NIV_OUTSOURCING"/>
    	<result property="ordListaPicado" 		column="ORD_LISTA_PICADO"/>
	    <result property="orden" 				column="ORDEN"/>
	    <result property="texChequeo" 	   	    column="TEX_CHEQUEO"/>
	    <result property="texPrimerosPedidos" 	column="TEX_PRIMEROS_PEDIDOS"/>
	    <result property="preEtiquetado" 		column="PRE_ETIQUETADO"/>
	    <result property="agrDefault" 	   		column="AGR_DEFAULT"/>
	    <result property="impDatosBasicos" 		column="IMP_DATOS_BASICOS"/>
	    <result property="codVisualizacion" 	column="COD_VISUALIZACION"/>
	    <result property="ordVisualizacion" 	column="ORD_VISUALIZACION"/>
	    <result property="agrOlas" 				column="AGR_OLAS"/>
	    <result property="nroMinimoPedidos" 	column="NRO_MINIMO_PEDIDOS"/>
	    <result property="nroEtiqueta" 			column="NUM_ETIQUETA"/>
	</resultMap>
	
	<select id="getCentroDistribucionList" parameterClass="java.util.Map" resultMap="centroDistribucionResult">
	  SELECT a.oid_conf_cent_dist                                            OID_CENTRO,
       		 a.cod_cent_dist                                                 COD_CENTRO,
       		 b.val_i18n                                                      DES_CENTRO,
       		 a.val_defe                                                      VAL_DEFECTO,
       		 d.val_i18n                                                      NIV_OUTSOURCING,
       		 f.val_i18n                                                      ORD_LISTA_PICADO,
       		 h.val_i18n                                                      ORDEN,
       		 a.val_text_cheq                                                 TEX_CHEQUEO,
       		 a.val_text_prim_pedi                                            TEX_PRIMEROS_PEDIDOS,
       		 a.val_pref_barr_cons                                            PRE_ETIQUETADO,
       		 j.val_i18n                                                      AGR_DEFAULT,
       		 decode(a.ind_impr_dato_basi_clie,'1','SI','NO')                 IMP_DATOS_BASICOS,
       		 k.des_visu_cheq                                                 COD_VISUALIZACION,
             decode(a.val_orde_visu_cheq, 'A', 'Ascendente', 'Descendente')  ORD_VISUALIZACION,
             (SELECT m.val_i18n FROM gen_i18n_sicc_comun m
               WHERE m.attr_enti = 'APE_AGRUP_AFP'  AND m.val_oid = a.aafp_oid_aafp_olas)  AGR_OLAS,
             a.num_mini_pedi_olas                                            NRO_MINIMO_PEDIDOS,
             a.num_long_etiq											     NUM_ETIQUETA
  	    FROM app_confi_centr_distr a,
       		 gen_i18n_sicc_pais b,
       		 ape_nivel_outso c,
       		 gen_i18n_sicc_comun d,
       		 ape_orden_lista_picad e,
       		 gen_i18n_sicc_comun f,
       		 ape_orden_produ g,
       		 gen_i18n_sicc_comun h,
       		 ape_agrup_afp i,
       		 gen_i18n_sicc_comun j,
       		 ape_orden_visua_chequ k,
       		 ape_agrup_afp l   
 	  WHERE  a.pais_oid_pais = #oidPais#
   	    AND  b.attr_enti = 'APP_CONFI_CENTR_DISTR'
   		AND  a.oid_conf_cent_dist = b.val_oid
   		AND  a.niou_oid_nive_outs = c.oid_nive_outs
   		AND  d.attr_enti = 'APE_NIVEL_OUTSO'
   		AND  c.oid_nive_outs = d.val_oid
   		AND  a.orlp_oid_orde_list_pica = e.oid_orde_list_pica
   		AND  f.attr_enti = 'APE_ORDEN_LISTA_PICAD'
   		AND  e.oid_orde_list_pica = f.val_oid
   		AND  a.orpr_oid_orde_prod = g.oid_orde_prod
   		AND  h.attr_enti = 'APE_ORDEN_PRODU'
   		AND  g.oid_orde_prod = h.val_oid
   		AND  a.aafp_oid_aafp = i.oid_aafp
   		AND  j.attr_enti = 'APE_AGRUP_AFP'
   		AND  i.oid_aafp = j.val_oid
   		AND  a.ovch_oid_orde_visu_cheq = k.oid_orde_visu_cheq
   		AND  a.aafp_oid_aafp_olas = l.oid_aafp (+)
 	         
 	   	<isNotEmpty property="codigoCentroDistribucion">
			AND a.cod_cent_dist = #codigoCentroDistribucion#
		</isNotEmpty>
 	         
 	   	<isNotEmpty property="descripcionCentroDistribucion">
			AND b.val_i18n = #descripcionCentroDistribucion#
		</isNotEmpty>
		
		ORDER BY a.cod_cent_dist
	</select>
	
	<select id="getNivelOutsourcingList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_nive_outs as CODIGO,
			   s.val_i18n 		as DESCRIPCION
  		  FROM ape_nivel_outso a,
  		  	   gen_i18n_sicc_comun s
 		 WHERE s.attr_enti = 'APE_NIVEL_OUTSO'
 	       AND a.oid_nive_outs = s.val_oid
	</select>
	
	<select id="getOrdenList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_orde_prod 	as CODIGO,
			   s.val_i18n 		as DESCRIPCION
  		  FROM ape_orden_produ a,
       		   gen_i18n_sicc_comun s
 		 WHERE s.attr_enti = 'APE_ORDEN_PRODU'
           AND a.oid_orde_prod = s.val_oid
	</select>
	
	<select id="getOrdenListaPicadoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_orde_list_pica as CODIGO,
			   s.val_i18n 			as DESCRIPCION
  		  FROM ape_orden_lista_picad a,
       		   gen_i18n_sicc_comun s
 		 WHERE s.attr_enti = 'APE_ORDEN_LISTA_PICAD'
           AND a.oid_orde_list_pica = s.val_oid
	</select>
	
	<select id="getAgrupacionList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_aafp as CODIGO,
			   s.val_i18n as DESCRIPCION
  		  FROM ape_agrup_afp a,
       		   gen_i18n_sicc_comun s
 		 WHERE s.attr_enti = 'APE_AGRUP_AFP'
           AND a.oid_aafp = s.val_oid
	</select>
	
	<select id="getVisualizacionChequeoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_visu_cheq  as CODIGO,
			   a.des_visu_cheq as DESCRIPCION
  		  FROM ape_orden_visua_chequ a
	</select>
	
	
	
	<resultMap id="productosPendientesAsignacionResult" class="java.util.HashMap">
			<result property="oidLineaArmado"  			column="OID_LINEA"/>
			<result property="oidProducto"  			column="OID_PRODUCTO"/>	 
  			<result property="codigoProducto"  		    column="COD_PRODUCTO"/>
  			<result property="descripcionProducto"  	column="DES_PRODUCTO"/>
	 		<result property="unidadesEstimadas"  		column="NUM_ESTIMADO"/>	 		
    </resultMap>
    
	<select id="getProductosPendientesAsignacionList" parameterClass="java.util.Map" resultMap="productosPendientesAsignacionResult">
		SELECT 	linea.oid_line_arma          OID_LINEA,
       			estimado.prod_oid_prod       OID_PRODUCTO,
       			producto.cod_sap             COD_PRODUCTO,
       			i18n.val_i18n                DES_PRODUCTO,
       			estimado.num_unid_esti       NUM_ESTIMADO
  		  FROM 	ape_estim_produ estimado,
       			mae_produ producto,
       			ape_linea_armad linea,
       			gen_i18n_sicc_pais i18n
 	      WHERE estimado.liar_oid_line_arma = #oidLinea#
   			AND estimado.perd_oid_peri = #oidPeriodo#
   			AND producto.oid_prod = estimado.prod_oid_prod
   			AND i18n.attr_enti = 'MAE_PRODU'
   			AND i18n.val_oid = producto.oid_prod
   			AND i18n.attr_num_atri = 1
   			AND i18n.idio_oid_idio = 1
   			AND linea.oid_line_arma = estimado.liar_oid_line_arma
   			AND ((producto.cod_ind_dent_caja IN ('F', 'B') AND linea.num_line_afp = 1) OR
        		 (producto.cod_ind_dent_caja NOT IN ('F', 'B') AND linea.num_line_afp = 0) OR  producto.cod_ind_dent_caja IS NULL)
   			AND NOT EXISTS ( SELECT b.prod_oid_prod
                      		   FROM ape_asign_produ_anaqu_cabec a,
                           			ape_asign_produ_anaqu_detal b
                     		  WHERE a.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentroCab#
                       			AND a.val_vers =  #codigoVersion#
                       			AND a.perd_oid_peri = #oidPeriodo#
                       			AND a.oid_asig_prod_anaq_cabe = b.apac_oid_asig_prod_anaq_cabe
                       			AND b.prod_oid_prod = producto.oid_prod )
		ORDER BY estimado.num_unid_esti DESC
	</select>
	
	
	
	<resultMap id="centroDistribucionObjectResult" class="centroDistribucion">
  			<result property="oidCentroDistribucion"  		    column="OID_CENTRO"/>
  			<result property="codigoCentroDistribucion"  		column="COD_CENTRO"/>
	 		<result property="descripcionCentroDistribucion"  	column="DES_CENTRO"/>
	 		<result property="codigoNivelOutsourcing"          	column="NIV_OUTSOURCING"/>
	 		<result property="indicadorValorDefecto"  			column="IND_DEFECTO"/>
	 		<result property="codigoOrdenListaPicado"  			column="COD_LISTA_PICADO"/> 
	 		<result property="codigoOrden"  					column="COD_ORDEN"/>
	 		<result property="textoChequeo"  					column="TEX_CHEQUEO"/>
	 		<result property="textoPrimerosPedidos"  			column="TEX_PRIMEROS_PEDIDOS"/>
	 		<result property="prefijoEtiquetado"  				column="PRE_ETIQUETADO"/>
	 		<result property="codigoAgrupacionDefault"          column="COD_AGRUPACION_DEFECTO"/>
	 		<result property="indicadorImpresionDatosBasicos"  	column="IND_IMPRESION_DATOS"/>
	 		<result property="codigoVisualizacionChequeo"  		column="COD_VISUALIZACION_CHEQUEO"/>
	 		<result property="indicadorOrdenvisualizacion"  	column="IND_ORDEN_VISUALIZACION"/>
	 		<result property="codigoNivelAgrupacionOlas"  		column="COD_NIVEL_OLAS"/>
	 		<result property="numeroMinimoPedidos"  			column="NUM_MINIMO_PEDIDOS"/>
	 		<result property="numeroEtiqueta"  					column="NUM_ETIQUETA"/>
    </resultMap>
  
	<select id="getCentroDistribucionObject" parameterClass="java.util.Map" resultMap="centroDistribucionObjectResult">
		SELECT 	a.oid_conf_cent_dist         OID_CENTRO,
       			a.cod_cent_dist              COD_CENTRO,
       			b.val_i18n                   DES_CENTRO,
       			c.cod_nive_outs              NIV_OUTSOURCING,
       			a.val_defe                   IND_DEFECTO,
       			e.cod_orde_list_pica         COD_LISTA_PICADO,
       			g.cod_orde_prod              COD_ORDEN,
       			a.val_text_cheq              TEX_CHEQUEO,
       			a.val_text_prim_pedi         TEX_PRIMEROS_PEDIDOS,
       			a.val_pref_barr_cons         PRE_ETIQUETADO,
       			i.cod_aafp                   COD_AGRUPACION_DEFECTO,
       			a.ind_impr_dato_basi_clie    IND_IMPRESION_DATOS,
       			k.cod_visu_cheq              COD_VISUALIZACION_CHEQUEO,
       			a.val_orde_visu_cheq         IND_ORDEN_VISUALIZACION,
       			l.cod_aafp                   COD_NIVEL_OLAS,
       			a.num_mini_pedi_olas         NUM_MINIMO_PEDIDOS,
       			a.num_long_etiq				 NUM_ETIQUETA
		  FROM 	app_confi_centr_distr a,
       			gen_i18n_sicc_pais b,
       			ape_nivel_outso c,
       			ape_orden_lista_picad e,
       			ape_orden_produ g,
       			ape_agrup_afp i,
       			ape_orden_visua_chequ k,
       			ape_agrup_afp l
		 WHERE 	a.pais_oid_pais    = #oidPais#
		   AND  a.oid_conf_cent_dist = #oidCentro#
		   AND 	b.attr_enti = 'APP_CONFI_CENTR_DISTR'
   		   AND 	a.oid_conf_cent_dist = b.val_oid
           AND 	a.niou_oid_nive_outs = c.oid_nive_outs
           AND 	a.orlp_oid_orde_list_pica = e.oid_orde_list_pica
           AND 	a.orpr_oid_orde_prod = g.oid_orde_prod
           AND 	a.aafp_oid_aafp = i.oid_aafp
           AND 	a.ovch_oid_orde_visu_cheq = k.oid_orde_visu_cheq
           AND 	a.aafp_oid_aafp_olas = l.oid_aafp (+)
	</select>
	
	<select id="getOidNivelOutsourcing" parameterClass="java.util.Map" resultClass="string">
		SELECT  a.oid_nive_outs
          FROM  ape_nivel_outso a
         WHERE  a.cod_nive_outs = #codigoNivelOutsourcing#
	</select>
	
	<select id="getOidOrdenListaPicado" parameterClass="java.util.Map" resultClass="string">
		SELECT  a.oid_orde_list_pica
          FROM  ape_orden_lista_picad a
         WHERE  a.cod_orde_list_pica = #codigoOrdenListaPicado#
	</select>
	
	<select id="getOidOrden" parameterClass="java.util.Map" resultClass="string">
		SELECT  a.oid_orde_prod
          FROM  ape_orden_produ a
         WHERE  a.cod_orde_prod = #codigoOrden#
	</select>
	
	<select id="getOidAgrupacionAFP" parameterClass="java.util.Map" resultClass="string">
		SELECT  a.oid_aafp
          FROM  ape_agrup_afp a
         WHERE  a.cod_aafp = #codigoAgrupacionDefault#
	</select>
	
	<select id="getOidOrdenVisualizacion" parameterClass="java.util.Map" resultClass="string">
		SELECT  a.oid_orde_visu_cheq
          FROM  ape_orden_visua_chequ a
         WHERE  a.cod_visu_cheq = #codigoVisualizacionChequeo#
	</select>
	
	<select id="getOidAgrupacionOLAS" parameterClass="java.util.Map" resultClass="string">
		SELECT  a.oid_aafp
          FROM  ape_agrup_afp a
         WHERE  a.cod_aafp = #codigoNivelAgrupacionOlas#
	</select>
	
	<select id="getCodigoFuncionDistribucionPorOidSublinea" parameterClass="string" resultClass="string">
		SELECT fun.cod_func_dist
     		FROM ape_subli_armad sla,ape_funci_distr fun  
     		WHERE fun.oid_func_dist = sla.fndi_oid_func_dist
    		and sla.oid_subl_arma = #oidSublinea#
	</select>
	
	<insert id="insertCentroDistribucion" parameterClass="java.util.Map">
		INSERT INTO app_confi_centr_distr (  
			pais_oid_pais,
			oid_conf_cent_dist,
   			cod_cent_dist,
   			niou_oid_nive_outs,
   			val_defe,
   			orlp_oid_orde_list_pica,
   			orpr_oid_orde_prod,
   			val_text_cheq,
   			val_text_prim_pedi,
   			val_pref_barr_cons,
   			aafp_oid_aafp,
   			ind_impr_dato_basi_clie,
   			ovch_oid_orde_visu_cheq,
   			val_orde_visu_cheq,
   			aafp_oid_aafp_olas,
   			num_mini_pedi_olas,
   			num_long_etiq
		)
		VALUES (  
			#oidPais#,
			app_ccdi_seq.nextval,
   			app_ccdi_seq.currval,
   			#oidNivelOutsourcing#,
   			#valorDefecto#,
   			#oidOrdenListaPicado#,
   			#oidOrden#,
   			#textoChequeo#,
   			#textoPrimerosPedidos#,
   			#prefijoEtiquetado#,
   			#oidAgrupacionDefault#,
   			#indImpresionDatos#,
   			#oidOrdenVisualizacion#,
   			#valOrdenVisualizacion#,
   			#oidAgrupacionOlas#,
   			#numMinimoPedidoOlas#,
   			#numLongitudEtiqueta#
		)
	</insert>
	
	<insert id="insertIdiomasAPE" parameterClass="java.util.Map">
		INSERT INTO gen_i18n_sicc_pais (
   			oid_i18n,
   			attr_enti,
   			attr_num_atri,
   			idio_oid_idio,
   			val_i18n,
   			val_oid
		)
		VALUES(
   			gen_i18n_seq.nextval,
   			#nombreTabla#,
   			#numAtributo#,
   			#oidIdioma#,
   			#valAtributo#,
   			#valOidAtributo#
		)
	</insert>
	
	<update id="updateCentroDistribucion" parameterClass="java.util.Map">
		UPDATE app_confi_centr_distr
           SET niou_oid_nive_outs      = #oidNivelOutsourcing#,
               val_defe				   = #valorDefecto#,
       		   orlp_oid_orde_list_pica = #oidOrdenListaPicado#,
       		   orpr_oid_orde_prod      = #oidOrden#,
               val_text_cheq           = #textoChequeo#,
       		   val_text_prim_pedi      = #textoPrimerosPedidos#,
       		   val_pref_barr_cons      = #prefijoEtiquetado#,
       		   aafp_oid_aafp           = #oidAgrupacionDefault#,
       		   ind_impr_dato_basi_clie = #indImpresionDatos#,
       		   ovch_oid_orde_visu_cheq = #oidOrdenVisualizacion#,
       		   val_orde_visu_cheq      = #valOrdenVisualizacion#,
       		   aafp_oid_aafp_olas      = #oidAgrupacionOlas#,
               num_mini_pedi_olas      = #numMinimoPedidoOlas#,
               num_long_etiq		   = #numLongitudEtiqueta#
         WHERE oid_conf_cent_dist = #oidCentro#
           AND pais_oid_pais = #oidPais#
   		   AND cod_cent_dist = #codCentro#
	</update>
	
	<update id="updateIdiomasAPE" parameterClass="java.util.Map">
		UPDATE gen_i18n_sicc_pais
           SET val_i18n = #valAtributo#
         WHERE attr_enti = #nombreTabla#
           AND val_oid = #valOidAtributo#
	</update>
	
	<select id="getNumAtributoIdioma" parameterClass="java.util.Map" resultClass="string">
		SELECT  g.num_atri
          FROM  gen_atrib_tradu g
         WHERE  g.nom_enti = #nombreTabla#
	</select>
	
	<select id="getMaximoOidCentroDistribucion" parameterClass="java.util.Map" resultClass="string">
		SELECT  nvl(max(a.oid_conf_cent_dist),0)
          FROM  app_confi_centr_distr a
	</select>
	
	<select id="getExisteCentroDefault" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
          FROM app_confi_centr_distr a
         WHERE a.pais_oid_pais = #oidPais#
           AND a.val_defe = 'S'
	</select>
	
	<select id="getDescripcionCentroDefault" parameterClass="java.util.Map" resultClass="string">
		SELECT 	b.val_i18n
          FROM  app_confi_centr_distr a,
       			gen_i18n_sicc_pais b
         WHERE 	a.pais_oid_pais = #oidPais#
           AND 	b.attr_enti = 'APP_CONFI_CENTR_DISTR'
   		   AND 	a.oid_conf_cent_dist = b.val_oid
   		   AND 	a.val_defe = 'S'
	</select>
	
	<delete id="deleteCentroDistribucion" parameterClass="java.util.Map">
		DELETE FROM app_confi_centr_distr a
         WHERE a.pais_oid_pais = #oidPais#
           AND a.oid_conf_cent_dist =  #oidCentro#
	</delete>
	
	<delete id="deleteIdiomaAPE" parameterClass="java.util.Map">
		DELETE FROM gen_i18n_sicc_pais
         WHERE attr_enti = #nombreTabla#
           AND val_oid =  #oidCentro#
	</delete>
	
	<parameterMap id="paramExecuteValidarRegistrosCentroDistribucion" class="java.util.Map">
		<parameter property="oidPais"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidCentro"            	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="valError"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>			
		<parameter property="nomTabla"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidarRegistrosCentroDistribucion" parameterMap="paramExecuteValidarRegistrosCentroDistribucion">
		{call APE_PKG_PROCE.APE_PR_VALID_REGIS_CENTR_DISTR(?,?,?,?) }
	</procedure>
	
	<select id="getSistemaPicadoLista" parameterClass="java.util.Map"  resultMap="baseResult">
		     SELECT a.cod_sist_pica as CODIGO, 
		            b.val_i18n as DESCRIPCION
		     FROM ape_siste_picad a,
		          gen_i18n_sicc_comun b
		     WHERE b.attr_enti = 'APE_SISTE_PICAD' 
		       AND a.oid_sist_pica = b.val_oid
	</select>
	
	<select id="getOidCentroDistribucionPais" parameterClass="java.util.Map" resultClass="string">
		SELECT 	a.oid_conf_cent_dist
        FROM 	app_confi_centr_distr a
        WHERE 	a.cod_cent_dist = #codCentro#
        AND 	a.pais_oid_pais = #oidPais#
	</select>
	
	<select id="getCodCDDefecto" parameterClass="java.util.Map" resultClass="string">
		SELECT cod_cent_dist as CODIGO 
		FROM   app_confi_centr_distr
		WHERE  pais_oid_pais = #oidPais#
		AND    val_defe='S'
	</select>
	
	<select id="getLineaArmadoListar" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	b.val_i18n as CODIGO,
	    		b.val_i18n as DESCRIPCION
	    FROM    ape_linea_armad a, gen_i18n_sicc_pais b
	    WHERE   a.oid_line_arma = b.val_oid
	    AND     a.ccdi_oid_conf_cent_dist = to_number(#oidCentro#)
	    AND     b.attr_enti = 'APE_LINEA_ARMAD'
	</select>
	
	<select id="getCodLineaArmadaDefecto" parameterClass="java.util.Map" resultClass="string">
		SELECT 	b.val_i18n as CODIGO
	    FROM    ape_linea_armad a, gen_i18n_sicc_pais b
	    WHERE   a.oid_line_arma = b.val_oid
	    AND     a.ccdi_oid_conf_cent_dist = to_number(#oidCentro#)
	    AND     b.attr_enti = 'APE_LINEA_ARMAD'
	    AND     a.num_valo_defe = 1
	</select>
	
	<select id="getOidLineaArmado" parameterClass="java.util.Map" resultClass="string">
		SELECT 	b.oid_line_arma 
	    FROM    gen_i18n_sicc_pais a, ape_linea_armad b
	  	WHERE   a.val_oid=b.oid_line_arma 
	  	AND     a.attr_enti = 'APE_LINEA_ARMAD'
	  	AND     a.val_i18n = #descLiArmad#
    	AND     rownum = 1
	</select>
	
    <parameterMap id="executeInsertaLineaUAdminAPE" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oidLineaArmado"	         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oidAAFP"	         		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoRegion"	         	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoZona"	         	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSeccion"	         	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeInsertaUnidadAdmLinea" 
   			  parameterMap="executeInsertaLineaUAdminAPE" >
		{call APE_PKG_PROCE.APE_PR_REGIS_LINEA_UADMI(?,?,?,?,?,?)}
    </procedure> 
    
    <select id="getValidaExisteUadmLineaAPE" parameterClass="java.util.Map" resultClass="string">
		SELECT APE_PKG_PROCE.APE_FN_VALIDA_UADMI_LINEA(#codigoPais#,#oidLineaArmado#,#oidAAFP#,#codigoRegion#,#codigoZona#,#codigoSeccion#) FROM DUAL
	</select>

	<select id="getOidNivelAgrupacionOlas" parameterClass="java.util.Map" resultClass="string">
		SELECT aafp_oid_aafp_olas
		FROM   app_confi_centr_distr
		WHERE  oid_conf_cent_dist = to_number(#oidCentro#)
	</select>

	<resultMap id="unidadAdministrativaResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidLineaArmado"		column="OID_LINEARMD"/>
    	<result property="desLineaArmado"		column="LINEA_ARMADO"/>
    	<result property="desAgrpOlas"			column="AGRP_OLAS"/>
    	<result property="desRegion" 			column="REGION_DESC"/>
    	<result property="desZona" 			    column="ZONA_DESC"/>
    	<result property="desSeccion" 			column="SECCION_DESC"/>
	</resultMap>
	
	<select id="getUnidadAdmLineaList" parameterClass="java.util.Map" resultMap="unidadAdministrativaResult">
		SELECT apelaudm.oid_line_uadm OID_LINEARMD, linarmado.val_i18n LINEA_ARMADO,
		       apeafp.val_i18n AGRP_OLAS,
		       region.DESCRIPCION REGION_DESC,
		      (SELECT a.des_zona 
		       FROM ZON_ZONA A
		       WHERE A.ZORG_OID_REGI = apelaudm.zorg_oid_regi
		       AND   A.OID_ZONA      = NVL(apelaudm.zzon_oid_zona,0)) ZONA_DESC,
		      (SELECT SEC.COD_SECC 
		       FROM   ZON_SECCI SEC
		       WHERE  SEC.zzon_oid_zona = NVL(apelaudm.zzon_oid_zona,0)
		       AND    SEC.OID_SECC      = NVL(apelaudm.zscc_oid_secc,0)) SECCION_DESC
		FROM ape_linea_uadmi apelaudm,
        	 ape_linea_armad linarm,
		    (SELECT afp.oid_aafp, s.val_i18n 
		  	 FROM   ape_agrup_afp afp,
		   		    gen_i18n_sicc_comun s
			 WHERE  s.attr_enti = 'APE_AGRUP_AFP'
		     AND    afp.oid_aafp = s.val_oid) apeafp,
			(SELECT 	b.oid_line_arma, a.val_i18n 
		     FROM    gen_i18n_sicc_pais a, ape_linea_armad b
  		     WHERE   a.val_oid       = b.oid_line_arma 
		     AND     a.attr_enti     = 'APE_LINEA_ARMAD') linarmado,
    		(SELECT ZON_REGIO.OID_REGI AS OID, 
		     ZON_REGIO.DES_REGI AS DESCRIPCION
		     FROM SEG_PAIS, SEG_MARCA, SEG_CANAL, ZON_REGIO
		     WHERE ZON_REGIO.IND_ACTI = 1
     		 AND  SEG_PAIS.COD_PAIS = #codigoPais#
		     AND  SEG_MARCA.COD_MARC = 'T'
		     AND  SEG_CANAL.COD_CANA = 'VD'
		     AND  SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS
		     AND  SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC
		     AND  SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA) region
		WHERE apelaudm.liar_oid_line_arma = linarm.oid_line_arma
    	AND   apelaudm.aafp_oid_aafp      = apeafp.oid_aafp
		AND   apelaudm.liar_oid_line_arma = linarmado.oid_line_arma (+)  
		AND   apelaudm.zorg_oid_regi      = region.OID (+)
			
	   	<isNotEmpty property="oidCentro">
			AND linarm.ccdi_oid_conf_cent_dist  = #oidCentro#
		</isNotEmpty>
 	         
 	   	<isNotEmpty property="oidLinArmado">
			AND apelaudm.liar_oid_line_arma = #oidLinArmado#
		</isNotEmpty>
		
	</select>
	
	<delete id="deleteUnidadAdministrativa" parameterClass="java.util.Map">
		DELETE FROM ape_linea_uadmi
		WHERE oid_line_uadm = to_number(#oidLineUadm#)
	</delete>
		
	<select id="getCentroDistList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	a.oid_conf_cent_dist as CODIGO,
       			b.val_i18n as DESCRIPCION
           FROM app_confi_centr_distr a,
       			gen_i18n_sicc_pais b
          WHERE a.pais_oid_pais = to_number(#oidPais#)
            AND b.attr_enti = #nombreTabla1#
   			AND a.oid_conf_cent_dist = b.val_oid
	</select>
	
	<select id="getLineaArmadobyOidCentro" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	b.val_i18n as CODIGO,
       			b.val_i18n as DESCRIPCION
           FROM ape_linea_armad a,
       			gen_i18n_sicc_pais b
          WHERE a.ccdi_oid_conf_cent_dist = to_number(#oidCentro#)
            AND b.attr_enti = #nombreTabla2#
   			AND a.oid_line_arma = b.val_oid
	</select>

	<select id="getCentroDistribucionDefecto" parameterClass="java.util.Map" resultClass="string">
		SELECT a.oid_conf_cent_dist
          FROM app_confi_centr_distr a
         WHERE a.pais_oid_pais = to_number(#oidPais#)
           AND a.val_defe = 'S'
	</select>
	
	<resultMap id="lineaArmadoCabecResult" class="java.util.HashMap"  >
  			<result property="oidCentroDistribucion"  		    column="OID_CENTRO"/>
	 		<result property="descripcionCentroDistribucion"  	column="DES_CENTRO"/>
	 		<result property="oidLineaArmado"          			column="OID_LINEA"/>
	 		<result property="codigoLineaArmado"          		column="COD_LINEA"/>
	 		<result property="descripcionLineaArmado"  			column="DES_LINEA"/>
	 		<result property="lineaAFP"  						column="LIN_AFP"/>
	 		<result property="lineaDefecto"  					column="LIN_DEFECTO"/>
    </resultMap>
  
	<select id="getLineaArmadoCabec" parameterClass="java.util.Map" resultMap="lineaArmadoCabecResult">
		SELECT b.oid_conf_cent_dist                 OID_CENTRO,
       		   c.val_i18n                           DES_CENTRO,
       		   a.oid_line_arma                      OID_LINEA,
       		   a.num_codi_line                      COD_LINEA,
       		   d.val_i18n                           DES_LINEA,
               decode(a.num_line_afp,1,'SI','N0')   LIN_AFP,
               decode(a.num_valo_defe,1,'SI','NO')  LIN_DEFECTO
		  FROM ape_linea_armad a,
       	       app_confi_centr_distr b,
               gen_i18n_sicc_pais c,
               gen_i18n_sicc_pais d	
		 WHERE b.oid_conf_cent_dist = #oidCentro#
		   AND c.attr_enti = #nombreTabla1#
   		   AND d.attr_enti = #nombreTabla2#
           AND b.oid_conf_cent_dist = a.ccdi_oid_conf_cent_dist
           AND b.oid_conf_cent_dist = c.val_oid
           AND a.oid_line_arma = d.val_oid
           
		   <isNotEmpty property="codigoLineaArmado">
		     AND a.num_codi_line = #codigoLineaArmado#
		   </isNotEmpty>
		   
		   <isNotEmpty property="descripcionLineaArmado">
		     AND d.val_i18n = #descripcionLineaArmado#
		   </isNotEmpty>
	</select>
	
	<parameterMap id="paramDeleteLineaArmado" class="java.util.Map">
		<parameter property="oidCentro"            	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="oidLinea"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="valError"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>			
		<parameter property="nomTabla"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
	</parameterMap>
	
	<procedure id="deleteLineaArmado" parameterMap="paramDeleteLineaArmado">
		{call APE_PKG_PROCE.APE_PR_ELIMI_LINEA_ARMAD(?,?,?,?) }
	</procedure>

    <select id="getProgramaCubicajeList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_cubi       as CODIGO,
			   s.val_i18n 		as DESCRIPCION
  		  FROM ape_progr_cubic a,
  		  	   gen_i18n_sicc_comun s
 		 WHERE s.attr_enti = 'APE_PROGR_CUBIC'
 	       AND a.oid_prog_cubi = s.val_oid
	</select>
	
	<select id="getPlataformaList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_plat_pica as CODIGO,
			   s.val_i18n 		as DESCRIPCION
  		  FROM ape_plata_picad a,
  		  	   gen_i18n_sicc_comun s
 		 WHERE s.attr_enti = 'APE_PLATA_PICAD'
 	       AND a.oid_plat_pica = s.val_oid
	</select>
	
	<select id="getTipoSolicitudConsoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	tsp.oid_tipo_soli_pais       	as CODIGO,
			   	i18n.val_i18n					as DESCRIPCION
  		  FROM 	ped_tipo_solic_pais tsp, 
  		  		ped_tipo_solic ts, 
  		  		v_gen_i18n_sicc i18n
 		 WHERE  tsp.tsol_oid_tipo_soli = ts.oid_tipo_soli
           AND 	ts.ind_cons = 1
		   AND  tsp.pais_oid_pais = to_number(#oidPais#)
           AND  i18n.attr_enti = 'PED_TIPO_SOLIC'
           AND 	i18n.attr_num_atri = 1
           AND 	i18n.idio_oid_idio = 1
           AND 	i18n.val_oid = ts.oid_tipo_soli
      ORDER BY descripcion
	</select>

	
    <select id="getTipoSolicitudConsoSelecList" parameterClass="java.util.Map"  resultClass="string">
		SELECT 	to_char(a.tspa_oid_tipo_soli_pais) AS OID_TIPO_SOLICITUD
  		  FROM 	ape_tipo_solic_linea a, 
       			ped_tipo_solic_pais b
 		 WHERE  liar_oid_line_arma = #oidLinea#
           AND a.tspa_oid_tipo_soli_pais = b.oid_tipo_soli_pais
	</select>
	
	<resultMap id="lineaArmadoObjectResult"  class="lineaArmado"  >                                                                       
    	<result property="codigoCentroDistribucion"			column="OID_CENTRO"/>
    	<result property="oidLineaArmado"					column="OID_LINEA"/>
    	<result property="codigoLineaArmado"				column="COD_LINEA"/>
    	<result property="descripcionLineaArmado"			column="DES_LINEA"/>
    	<result property="codigoCubicaje"					column="COD_CUBICAJE"/>
    	<result property="codigoPlataforma"					column="COD_PLATAFORMA"/>
    	<result property="indicadorLineaAFP"			    column="IND_LINEA_AFP"/>
    	<result property="indicadorLineaDefecto"			column="IND_LINEA_DEFECTO"/>
    	<result property="numeroCopias"					    column="NUM_COPIA_ETIQUETAS"/>
    	<result property="codigoLineaAframe"				column="COD_LINEA_AFRAME"/>
	</resultMap>
	<select id="getLineaArmadoObject" parameterClass="java.util.Map" resultMap="lineaArmadoObjectResult">
		SELECT 	b.oid_conf_cent_dist                 OID_CENTRO,
				a.oid_line_arma                      OID_LINEA,
       			a.num_codi_line                      COD_LINEA,
       			d.val_i18n                           DES_LINEA,
       			e.cod_cubi                           COD_CUBICAJE,
       			f.cod_plat_pica                      COD_PLATAFORMA,
       			a.num_line_afp						 IND_LINEA_AFP,
       			a.num_valo_defe                      IND_LINEA_DEFECTO,
       			a.num_etiq                           NUM_COPIA_ETIQUETAS,
       			a.cod_line_wcs				         COD_LINEA_AFRAME
          FROM  ape_linea_armad a,
       			app_confi_centr_distr b,
       			gen_i18n_sicc_pais c,
       			gen_i18n_sicc_pais d,
       			ape_progr_cubic e,
       			ape_plata_picad f
         WHERE  b.oid_conf_cent_dist =  #oidCentro#
   		   AND 	a.oid_line_arma = #oidLinea#
   		   AND 	c.attr_enti = #nombreTabla1#
   		   AND 	d.attr_enti = #nombreTabla2#
   		   AND  b.oid_conf_cent_dist = a.ccdi_oid_conf_cent_dist
   		   AND 	b.oid_conf_cent_dist = c.val_oid
           AND  a.oid_line_arma = d.val_oid
           AND  a.sicj_oid_prog_cubi = e.oid_prog_cubi
   		   AND  a.plpi_oid_plat_pica = f.oid_plat_pica(+)
	</select>
	
	<resultMap id="usuarioAlarmaResult"  class="java.util.HashMap"  >
		<result property="oidUsuarioAlarma"		column="OID_USUARIO"/>
		<result property="usuarioAlarma"		column="VAL_MAIL"/>
	</resultMap>
	<select id="getUsuarioAlarmaList" parameterClass="java.util.Map"  resultMap="usuarioAlarmaResult">
		SELECT 	a.oid_usua_alar_line   OID_USUARIO,
				a.val_mail 		       VAL_MAIL
           FROM ape_usuar_alarm_linea a,
       			ape_linea_armad b
          WHERE b.oid_line_arma = #oidLinea#
            AND a.liar_oid_line_arma = b.oid_line_arma 
	</select>
	
	<select id="getNextOidLinaeArmado" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  APE_LIAR_SEQ.NEXTVAL FROM  dual
	</select>
	
	<select id="getMaxCodLinaeArmado" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  nvl(MAX(a.num_codi_line),0)+1 
		  FROM  ape_linea_armad a
	</select>
	
	<select id="getOidProgCubicaje" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  a.oid_prog_cubi 
		  FROM  ape_progr_cubic a
		 WHERE  a.cod_cubi = #codCubicaje#
	</select>
	
	<select id="getOidPlataforma" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  a.oid_plat_pica 
		  FROM  ape_plata_picad a
		 WHERE  a.cod_plat_pica = #codPlataforma#
	</select>
	
	<select id="getExisteLineaDefault" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
          FROM ape_linea_armad a
         WHERE a.ccdi_oid_conf_cent_dist = #oidCentro#
           AND a.num_valo_defe = 1
	</select>
	
	<select id="getCodigoLineaDefault" parameterClass="java.util.Map" resultClass="string">
		SELECT a.num_codi_line
          FROM ape_linea_armad a
         WHERE a.ccdi_oid_conf_cent_dist = #oidCentro#
           AND a.num_valo_defe = 1
	</select>
	
	<select id="getDescripcionLineaDefault" parameterClass="java.util.Map" resultClass="string">
		SELECT 	b.val_i18n
          FROM  ape_linea_armad a,
       			gen_i18n_sicc_pais b
         WHERE  a.ccdi_oid_conf_cent_dist = #oidCentro#
   	       AND 	a.num_valo_defe = 1 
           AND 	b.attr_enti = #nombreTablaLinea#
           AND 	a.oid_line_arma = b.val_oid 	
    </select>
    
    <insert id="insertLineaArmado" parameterClass="java.util.Map">
		INSERT INTO ape_linea_armad (  
			ccdi_oid_conf_cent_dist,
			oid_line_arma,
   			num_codi_line,
   			sicj_oid_prog_cubi,
   			plpi_oid_plat_pica,
   			num_line_afp,
   			num_valo_defe,
   			num_etiq,
   			cod_line_wcs,
   			num_long_nume_etiq
		)
		VALUES (  
			#oidCentro#,
			#oidLinea#,
			#codLinea#,
			#oidCubicaje#,
			#oidPlataforma#,
			#indLineaAFP#,
			#valorDefecto#,
			#numeroCopias#,
			#codLineaAframe#,
			0
		)
	</insert>
	
	<select id="getNextOidUsuarioAlarma" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  APE_UALI_SEQ.NEXTVAL 
		  FROM  dual
	</select>
	
	<insert id="insertUsuarioAlarma" parameterClass="java.util.Map">
		INSERT INTO ape_usuar_alarm_linea (  
			oid_usua_alar_line,
  			val_mail,
  			liar_oid_line_arma
		)
		VALUES (  
			#oidUsuarioAlarma#,
			#usuarioAlarma#,
			#oidLinea#
		)
	</insert>
	
	<delete id="deleteTipoSolicitudLinea" parameterClass="java.util.Map">
		DELETE FROM ape_tipo_solic_linea a
         WHERE a.liar_oid_line_arma = #oidLinea#
	</delete>
	
	<insert id="insertTipoSolicitudLinea" parameterClass="java.util.Map">
		INSERT INTO ape_tipo_solic_linea (  
			oid_tipo_soli_line,
   			tspa_oid_tipo_soli_pais,
   			liar_oid_line_arma 
		)
		VALUES (  
			APE_TSLI_SEQ.NEXTVAL,
			#oidTipoSolicitud#,
			#oidLinea#
		)
	</insert>
	
	<select id="getMapaZonaList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_mapa_zona as CODIGO,
		       s.val_i18n as DESCRIPCION
  		FROM   ape_mapa_zona_cabec a,
       	   	   gen_i18n_sicc_pais s
 		WHERE  s.attr_enti = 'APE_MAPA_ZONA_CABEC'
    	AND    a.oid_mapa_zona_cabe = s.val_oid
    	ORDER BY 1
	</select>
	
	<select id="getOidMapaZona" parameterClass="java.util.Map" resultClass="string">
	    SELECT c.oid_mapa_zona_cabe as CODIGO
	    FROM ape_mapa_zona_cabec c
	    WHERE c.cod_mapa_zona = #codMapaZona#
	</select>

	<select id="getMapaCentrDistList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.num_codi_mapa as CODIGO,
			   s.val_i18n as DESCRIPCION
	  	FROM   ape_mapa_centr_distr_cabec a,
    	   	   gen_i18n_sicc_pais s
		WHERE    a.oid_mapa_cent_dist_cabe = s.val_oid
	    AND      s.attr_enti = 'APE_MAPA_CENTR_DISTR_CABEC'
    	AND      a.ccdi_oid_conf_cent_dist = #oidCentro#
	</select>
	
	<select id="getOidMapaCentrDist" parameterClass="java.util.Map" resultClass="string">
	    SELECT c.oid_mapa_cent_dist_cabe as CODIGO
	    FROM   ape_mapa_centr_distr_cabec c
	    WHERE  c.num_codi_mapa = #codMapCentrDist#
	</select>

	<select id="getSubLiArmadoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT sl.cod_subl_arma as CODIGO,
		       s.val_i18n as DESCRIPCION
  		FROM   ape_subli_armad sl,
       	   	   gen_i18n_sicc_pais s
 		WHERE  s.attr_enti = 'APE_SUBLI_ARMAD'
    	AND    sl.oid_subl_arma = s.val_oid
    	AND    sl.liar_oid_line_arma = #oidLinArmado# 
    	ORDER BY 1
	</select>
	
	<select id="getOidSubLiArmado" parameterClass="java.util.Map" resultClass="string">
    	SELECT oid_subl_arma as CODIGO
    	FROM  ape_subli_armad
    	WHERE cod_subl_arma = #codSubLiArmado#
    </select>

	<resultMap id="subLineaResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidSubLinea"			column="OID_SUBLI"/>
    	<result property="oidMapaCD"			column="OID_MAPACD"/>
    	<result property="oidSistPicad"			column="OID_SISTPICAD"/>
    	<result property="desSubLinea"			column="DESC_SUBLINEA"/>
    	<result property="desSistPicad"			column="DESC_SISTPICAD"/>
    	<result property="desTipoAsig" 			column="TIPO_ASIG"/>
	</resultMap>

	<select id="getSubLineaList" parameterClass="java.util.Map" resultMap="subLineaResult">
	    SELECT DISTINCT subli.oid_subl_arma 	            OID_SUBLI,
    	       mctc.oid_mapa_cent_dist_cabe 				OID_MAPACD, 
   	    	   subli.sipi_oid_sist_pica 		  			OID_SISTPICAD, 
	    	   APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_SUBLI_ARMAD',subli.oid_subl_arma,'P') 		  DESC_SUBLINEA, 
	           APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_SISTE_PICAD',subli.sipi_oid_sist_pica,'C') 	DESC_SISTPICAD,
               CASE WHEN detanaq.TOTALVAL = detanaq.TOTAL 
               THEN 'SI' ELSE 'NO' END as     				TIPO_ASIG
	    FROM   ape_subli_armad             		subli, 
	           ape_linea_armad             		linarm,                                                                                   
	           app_confi_centr_distr       		cdis,
	           ape_mapa_centr_distr_cabec  		mctc,
              (SELECT DISTINCT detal.mcdc_oid_mapa_cent_dist_cabe,detal.sbar_oid_subl_arma, 
               NVL(CONVALORTIPO.TOTALVAL,0) + NVL(SINVALORTIPO.TOTALSINVAL,0) as TOTAL,
               NVL(CONVALORTIPO.TOTALVAL,0) as TOTALVAL, 
               NVL(SINVALORTIPO.TOTALSINVAL,0) as TOTALSINVAL
               FROM   ape_mapa_centr_distr_detal detal,
              (SELECT mcdc_oid_mapa_cent_dist_cabe,sbar_oid_subl_arma, COUNT(1) as TOTALVAL 
               FROM   ape_mapa_centr_distr_detal 
               WHERE  tian_oid_tipo_anaq IS NOT NULL
               GROUP BY mcdc_oid_mapa_cent_dist_cabe, sbar_oid_subl_arma) CONVALORTIPO,
              (SELECT mcdc_oid_mapa_cent_dist_cabe,sbar_oid_subl_arma, COUNT(1) as TOTALSINVAL 
               FROM   ape_mapa_centr_distr_detal 
               WHERE  tian_oid_tipo_anaq IS NULL
               GROUP BY mcdc_oid_mapa_cent_dist_cabe,sbar_oid_subl_arma) SINVALORTIPO
               WHERE  detal.sbar_oid_subl_arma           = CONVALORTIPO.sbar_oid_subl_arma(+)
               AND    detal.sbar_oid_subl_arma           = SINVALORTIPO.sbar_oid_subl_arma(+)
               AND    detal.mcdc_oid_mapa_cent_dist_cabe = CONVALORTIPO.mcdc_oid_mapa_cent_dist_cabe(+)
               AND    detal.mcdc_oid_mapa_cent_dist_cabe = SINVALORTIPO.mcdc_oid_mapa_cent_dist_cabe(+)) detanaq
	    WHERE  (subli.liar_oid_line_arma       = linarm.oid_line_arma     
	    AND     subli.ccdi_oid_conf_cent_dist  = cdis.oid_conf_cent_dist)
	    AND    (linarm.ccdi_oid_conf_cent_dist = cdis.oid_conf_cent_dist 
	    AND     linarm.ccdi_oid_conf_cent_dist = cdis.oid_conf_cent_dist)
	    AND    cdis.oid_conf_cent_dist         = mctc.ccdi_oid_conf_cent_dist
        AND    subli.oid_subl_arma             = detanaq.sbar_oid_subl_arma
        AND    mctc.oid_mapa_cent_dist_cabe    = detanaq.mcdc_oid_mapa_cent_dist_cabe
		AND    cdis.oid_conf_cent_dist 		   = #oidCentro#
		AND    mctc.oid_mapa_cent_dist_cabe    = #oidMapaCDist#
		AND    linarm.oid_line_arma            = #oidLinArmado#

	 <isNotEmpty property="oidSubLinArmado">
		AND    subli.oid_subl_arma  		   = #oidSubLinArmado#
	</isNotEmpty>
		
	</select>

	<resultMap id="subListaAnaqueles"  class="java.util.HashMap" >                                                                       
    	<result property="oidMapaCDDet"			column="OID_MAPACDDET"/>
    	<result property="numAnaquel"			column="NUM_ANAQUEL"/>
    	<result property="oidTipoAnaq"			column="OID_TIPOANAQ"/>
    	<result property="indTipoAfra"			column="INDTIPOAFRA"/>
    	<result property="oidTipoChanel"		column="OID_TIPOCHANEL"/>
    	<result property="desTipoChanel"		column="DESC_TIPOCHANEL"/>
    	<result property="desSide" 				column="SIDE"/>
    	<result property="frameNumber"			column="FRAME_NUMBER"/>
    	<result property="chanelAddr"			column="CHANELADDR"/>
    	<result property="machAddr"				column="MACHADDR"/>
    	<result property="levelNumber"			column="LEVELNUMBER"/>
    	<result property="desAlto"				column="ALTO"/>
    	<result property="desAncho"				column="ANCHO"/>
	</resultMap>
	
	<select id="getListaAnaquelesMapaCD" parameterClass="java.util.Map" resultMap="subListaAnaqueles">
		SELECT mcd.oid_mapa_cent_dist_deta 	OID_MAPACDDET, 
			   mcd.num_anaq 				NUM_ANAQUEL,
	       	   mcd.tian_oid_tipo_anaq 		OID_TIPOANAQ, 
	       	   mcd.ind_expa 				INDTIPOAFRA,
	           tipchane.oid_tipo_chan 		OID_TIPOCHANEL,
               APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_TIPO_CHANE',tipanaq.tich_oid_tipo_chan,'C') as DESC_TIPOCHANEL,
	           mcd.val_side 				SIDE, 
	           mcd.num_afra_fram_numb 		FRAME_NUMBER, 
	           mcd.num_afra_chan_addr 		CHANELADDR,
	           mcd.num_afra_mach_addr 		MACHADDR, 
	           mcd.num_afra_leve_numb 		LEVELNUMBER, 
	           mcd.num_afra_heig 			ALTO, 
	           mcd.num_afra_widt 			ANCHO
		FROM   APE_MAPA_CENTR_DISTR_DETAL 	mcd,
	       	   APE_TIPO_ANAQU 				tipanaq,
	           APE_TIPO_CHANE 				tipchane
		WHERE  mcd.tian_oid_tipo_anaq            = tipanaq.oid_tipo_anaq(+)
		AND    tipanaq.tich_oid_tipo_chan        = tipchane.oid_tipo_chan(+)
		AND    mcd.sbar_oid_subl_arma 			 = #oidSubLinArmado#
		AND    mcd.mcdc_oid_mapa_cent_dist_cabe  = #oidMapaCD#
	
	  <isNotEmpty property="oidMapaCDDet">
		AND    mcd.oid_mapa_cent_dist_deta       = #oidMapaCDDet#
	  </isNotEmpty>
	  
	  <isEmpty property="oidTipoAnaquel">
        AND    mcd.tian_oid_tipo_anaq IS NULL
	  </isEmpty>
	  
	  <isNotEmpty property="oidTipoAnaquel1">
        AND    mcd.tian_oid_tipo_anaq = #oidTipoAnaquel1#
	  </isNotEmpty>
	  
	  <isNotEmpty property="oidTipoAnaquel2">
        AND    mcd.tian_oid_tipo_anaq IS NOT NULL 
	  </isNotEmpty>
	  ORDER BY mcd.num_anaq ASC
	
	</select>
	
	<update id="updateLineaArmado" parameterClass="java.util.Map">
		UPDATE 	ape_linea_armad
           SET 	sicj_oid_prog_cubi = #oidCubicaje#,
   				plpi_oid_plat_pica = #oidPlataforma#,
   				num_line_afp = #indLineaAFP#,
   				num_valo_defe = #valorDefecto#,
   				num_etiq = #numeroCopias#,
   				cod_line_wcs = #codLineaAframe#
         WHERE 	ccdi_oid_conf_cent_dist = #oidCentro#
           AND  oid_line_arma = #oidLinea#
	</update>
	
	<delete id="deleteUsuarioAlarma" parameterClass="java.util.Map">
		DELETE FROM ape_usuar_alarm_linea a
         WHERE a.oid_usua_alar_line = #oidUsuarioAlarma#
	</delete>
	
	<select id="getTipoAnaquelFiltroList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT   anq.oid_tipo_anaq as CODIGO,
			     NVL(s.val_i18n,'TIPO ANAQUEL A') as DESCRIPCION
		FROM     ape_tipo_anaqu anq,
	    	   	 gen_i18n_sicc_comun s
	 	WHERE    anq.oid_tipo_anaq = s.val_oid (+)
	    AND      s.attr_enti (+) = 'APE_TIPO_ANAQU' 
	    AND      anq.ind_tipo_afrm = #indTipoAfrm#
	</select>	

	<update id="updateMapaCentroDistrDetalNoAframe" parameterClass="java.util.Map">
		UPDATE APE_MAPA_CENTR_DISTR_DETAL
	    SET    tian_oid_tipo_anaq = #oidTipoAnaqu#
	    WHERE  oid_mapa_cent_dist_deta = to_number(#oidMapaCentDist#)
	</update>
	
	<update id="updateMapaCentroDistrDetalAframe" parameterClass="java.util.Map">
	    UPDATE APE_MAPA_CENTR_DISTR_DETAL 
	    SET    tian_oid_tipo_anaq =  #oidTipoAnaqu#,
	           val_side           =  #valSide#,
	           num_afra_fram_numb =  #frameNumber#,
	           num_afra_chan_addr =  #chanelAddress#,
	           num_afra_mach_addr =  #machineAddress#,
	           num_afra_leve_numb =  #levelNumber#,
	           num_afra_heig      =  #alto#,
	           num_afra_widt      =  #ancho#
	    WHERE  oid_mapa_cent_dist_deta = to_number(#oidMapaCentDist#)	
    </update>
	
	<select id="getSistemaPicadoList" parameterClass="java.util.Map"  resultMap="baseResult">
		     SELECT a.cod_sist_pica as CODIGO, 
		            s.val_i18n 		as DESCRIPCION
		       FROM ape_siste_picad a,
		            gen_i18n_sicc_comun s
		      WHERE s.attr_enti = #nombreTablaSistemaPicado#
                AND s.attr_num_atri = 1
   				AND s.idio_oid_idio = 1
   				AND a.oid_sist_pica = s.val_oid 
           ORDER BY 2
	</select>
	
	<select id="getCodigoImpresoraList" parameterClass="java.util.Map"  resultMap="baseResult">
		     SELECT f.cod_impr 	as CODIGO, 
		            f.des_impr 	as DESCRIPCION
		       FROM fac_impre_virtu f
		      WHERE f.ind_esta_acti = 1
           ORDER BY f.cod_impr
	</select>
	
	<resultMap id="subLineaArmadoCabecResult" class="java.util.HashMap"  >
  			<result property="oidCentroDistribucion"  		    column="OID_CENTRO"/>
	 		<result property="descripcionCentroDistribucion"  	column="DES_CENTRO"/>
	 		<result property="oidLineaArmado"          			column="OID_LINEA"/>
	 		<result property="descripcionLineaArmado"  			column="DES_LINEA"/>
	 		<result property="oidSubLineaArmado"  				column="OID_SUBLINEA"/>
	 		<result property="codSubLineaArmado"  				column="COD_SUBLINEA"/>
	 		<result property="descripcionSubLineaArmado"  		column="DES_SUBLINEA"/>
	 		<result property="oidSistemaPicado"  				column="OID_SIST_PICADO"/>
	 		<result property="descripcionSistemaPicado"  		column="DES_SIST_PICADO"/>
	 		<result property="codLetra"  						column="LETRA"/>
	 		<result property="oidImpresora"  					column="OID_IMPRESORA"/>
	 		<result property="descripcionImpresora"  			column="COD_IMPRESORA"/>
	 		<result property="numImpresoraPTL"  				column="NUM_IMPRESORA_PTL"/>
    </resultMap>
  
	<select id="getSubLineaArmadoCabec" parameterClass="java.util.Map" resultMap="subLineaArmadoCabecResult">
			 SELECT	 ccd.oid_conf_cent_dist                      AS OID_CENTRO,
        			(SELECT b.val_i18n
           			   FROM gen_i18n_sicc_pais b
          			  WHERE b.attr_enti = #nombreTablaCentro#
            			AND b.idio_oid_idio = 1
            			AND b.val_oid = ccd.oid_conf_cent_dist)  AS DES_CENTRO,
        			 la.oid_line_arma                            AS OID_LINEA,
         			(SELECT b.val_i18n
           			   FROM gen_i18n_sicc_pais b
          			  WHERE b.attr_enti = #nombreTablaLinea#
            			AND b.idio_oid_idio = 1
            			AND b.val_oid = la.oid_line_arma)        AS DES_LINEA,
        			 sla.oid_subl_arma                           AS OID_SUBLINEA,
        			 sla.cod_subl_arma                           AS COD_SUBLINEA,
        			 i18sp.val_i18n 							 AS DES_SUBLINEA,
        			 sla.sipi_oid_sist_pica                      AS OID_SIST_PICADO,
        			(SELECT b.val_i18n
           			   FROM gen_i18n_sicc_comun b
          			  WHERE b.attr_enti = #nombreTablaSistemaPicado#
            		    AND b.idio_oid_idio = 1
            			AND b.val_oid = sp.oid_sist_pica)        AS DES_SIST_PICADO,
        			 sla.val_letr_para_anaq                      AS LETRA,
        			 fiv.oid_impr                                AS OID_IMPRESORA,
        			 fiv.cod_impr                                AS COD_IMPRESORA,
        			 aai.num_impr_ptl                            AS NUM_IMPRESORA_PTL
               FROM  app_confi_centr_distr ccd, 
        			 ape_linea_armad la,
        			 ape_subli_armad sla,
        			 ape_siste_picad sp,
        			 ape_asign_impre aai,
        			 fac_impre_virtu fiv,
        		 	 gen_i18n_sicc_pais i18sp
              WHERE  ccd.pais_oid_pais = #oidPais#
   				AND  ccd.oid_conf_cent_dist = la.ccdi_oid_conf_cent_dist
   				AND  la.oid_line_arma = sla.liar_oid_line_arma
   				AND  sla.sipi_oid_sist_pica = sp.oid_sist_pica
   				AND  sla.oid_subl_arma = aai.sbar_oid_subl_arma
   				AND  aai.imvi_oid_impr = fiv.oid_impr
   				AND  i18sp.attr_enti = #nombreTablaSubLinea#
   				AND  i18sp.idio_oid_idio = 1
   				AND  i18sp.val_oid = sla.oid_subl_arma
   				AND  la.ccdi_oid_conf_cent_dist = #oidCentro#
   				AND  la.oid_line_arma = #oidLinea#

				<isNotEmpty property="codigoSubLinea">
   					AND  sla.cod_subl_arma = #codigoSubLinea#
   				</isNotEmpty>
   				<isNotEmpty property="descripcionSubLinea">
   					AND  i18sp.val_i18n = #descripcionSubLinea#
   				</isNotEmpty>
   				<isNotEmpty property="codigoSistemaPicado">
   					AND  sp.cod_sist_pica = #codigoSistemaPicado#
   				</isNotEmpty> 
   				<isNotEmpty property="codigoLetraAnaquel">
   					AND  sla.val_letr_para_anaq = #codigoLetraAnaquel#
   				</isNotEmpty> 
   				<isNotEmpty property="codigoImpresora">
   					AND  fiv.cod_impr = #codigoImpresora#
   				</isNotEmpty> 
		   ORDER BY COD_SUBLINEA
	</select>
	
	<select id="getOidLineaArmadobyCodigo" parameterClass="java.util.Map" resultClass="string">
		SELECT	la.oid_line_arma
	      FROM  ape_linea_armad la
	  	 WHERE  la.num_codi_line = #codLinea#
	</select>
	
	<parameterMap id="paramDeleteSubLineaArmado" class="java.util.Map">
		<parameter property="oidSubLinea"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="valError"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>			
		<parameter property="nomTabla"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
	</parameterMap>
	
	<procedure id="deleteSubLineaArmado" parameterMap="paramDeleteSubLineaArmado">
		{call APE_PKG_PROCE.APE_PR_ELIMI_SUBLI_ARMAD(?, ?, ?) }
	</procedure>
	
	<select id="getLineaArmadoComboList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	a.num_codi_line as CODIGO,
       			b.val_i18n 		as DESCRIPCION
           FROM ape_linea_armad a,
       			gen_i18n_sicc_pais b
          WHERE a.ccdi_oid_conf_cent_dist = to_number(#oidCentro#)
            AND b.attr_enti = #nombreTabla2#
   			AND a.oid_line_arma = b.val_oid
   	   ORDER BY a.num_valo_defe DESC
	</select>
	
	<select id="getCodLineaArmadaDefectoList" parameterClass="java.util.Map" resultClass="string">
		SELECT 	a.num_codi_line
	      FROM  ape_linea_armad a
	     WHERE  a.num_valo_defe = 1
	       AND  a.ccdi_oid_conf_cent_dist = to_number(#oidCentro#)
	</select>
	
	<resultMap id="subLineaArmadoResult"  class="subLineaArmado"  >                                                                       
    	<result property="oidCentroDistribucion"			column="OID_CENTRO"/>
    	<result property="oidLineaArmado"					column="OID_LINEA"/>
    	<result property="oidSubLinea"						column="OID_SUBLINEA"/>
    	<result property="codigoSubLinea"					column="COD_SUBLINEA"/>
    	<result property="descripcionSubLinea"				column="DES_SUBLINEA"/>
    	<result property="codigoImpresora"					column="COD_IMPRESORA"/>
    	<result property="codigoSistemaPicado"				column="COD_SIST_PICADO"/>
    	<result property="numeroImpresoraPTL"			    column="NUM_IMPRESORA_PTL"/>
    	<result property="indicadorPostVenta"				column="IND_POST_VENTA"/>
    	<result property="numeroOrdenImpresion"			    column="NUM_ORDEN_IMPRESION"/>
    	<result property="codigoLetra"					    column="LETRA"/>
    	<result property="indicadorListaPicado"				column="IND_LISTA_PICADO"/>
    	<result property="indicadorFrenteEspalda"			column="IND_FRENTE_ESPALDA"/>
    	<result property="numeroBahiaFrente"				column="NUM_BAHIA_FRENTE"/>
    	<result property="numeroBahiaEspalda"				column="NUM_BAHIA_ESPALDA"/>
    	<result property="numeroNivelFrente"				column="NUM_NIVEL_FRENTE"/>
    	<result property="numeroNivelEspalda"				column="NUM_NIVEL_ESPALDA"/>
    	<result property="numeroColumnaFrente"				column="NUM_COLUMNA_FRENTE"/>
    	<result property="numeroColumnaEspalda"				column="NUM_COLUMNA_ESPALDA"/>
    	<result property="numeroOrdenBalanceo"				column="NUM_ORDEN_BALANCEO"/>
    	<result property="codigoSubLineaAframe"				column="COD_SUBLINEA_AFRAME"/>
    	<result property="numeroMaximoChanels"				column="NUM_MAXI_ANAQ_PROD"/>
	</resultMap>
	<select id="getSubLineaArmadoObject" parameterClass="java.util.Map" resultMap="subLineaArmadoResult">
		SELECT 	ccd.oid_conf_cent_dist                      AS OID_CENTRO,
        		la.oid_line_arma                            AS OID_LINEA,
        		sla.oid_subl_arma                           AS OID_SUBLINEA,
        		sla.cod_subl_arma                           AS COD_SUBLINEA,
        		i18sp.val_i18n                              AS DES_SUBLINEA,
        		fiv.cod_impr                                AS COD_IMPRESORA,
        		sp.cod_sist_pica                            AS COD_SIST_PICADO,        
        		aai.num_impr_ptl                            AS NUM_IMPRESORA_PTL,
        		sla.ind_post_vent                           AS IND_POST_VENTA,
        		num_ord_impr_subl							AS NUM_ORDEN_IMPRESION,
        		sla.val_letr_para_anaq                      AS LETRA,
        		sla.ind_impr_list_pica                      AS IND_LISTA_PICADO,
        		sla.Ind_Fren_Espa                           AS IND_FRENTE_ESPALDA,
        		sla.num_bahi_fren                           AS NUM_BAHIA_FRENTE,
        		sla.num_bahi_espa                           AS NUM_BAHIA_ESPALDA,
        		sla.num_nive_fren                           AS NUM_NIVEL_FRENTE,
        		sla.num_nive_espa                           AS NUM_NIVEL_ESPALDA,
        		sla.num_colu_fren                           AS NUM_COLUMNA_FRENTE,
        		sla.num_colu_espa                           AS NUM_COLUMNA_ESPALDA,
        		sla.num_orde_bala                           AS NUM_ORDEN_BALANCEO,
        		sla.cod_subl_wcs							AS COD_SUBLINEA_AFRAME,
        		sla.num_maxi_anaq_prod				        AS NUM_MAXI_ANAQ_PROD
          FROM  app_confi_centr_distr ccd, 
        		ape_linea_armad la,
        		ape_subli_armad sla,
        		ape_siste_picad sp,
        		ape_asign_impre aai,
        		fac_impre_virtu fiv,
        		gen_i18n_sicc_pais i18sp
         WHERE  ccd.pais_oid_pais = #oidPais#
           AND  la.ccdi_oid_conf_cent_dist = #oidCentro#
           AND  la.oid_line_arma = #oidLinea#
           AND  sla.oid_subl_arma = #oidSubLinea#
           AND  i18sp.attr_enti = #nombreTablaSubLineaArmado#
           AND  ccd.oid_conf_cent_dist = la.ccdi_oid_conf_cent_dist
   		   AND  la.oid_line_arma = sla.liar_oid_line_arma
   		   AND  sla.sipi_oid_sist_pica = sp.oid_sist_pica
   		   AND  sla.oid_subl_arma = aai.sbar_oid_subl_arma
   		   AND  aai.imvi_oid_impr = fiv.oid_impr
           AND  i18sp.idio_oid_idio = 1
   		   AND  i18sp.val_oid = sla.oid_subl_arma
	</select>
	
	<select id="getTipoCajaProductoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	tcp.cod_caja 	as CODIGO,
       			tcp.cod_caja 	as DESCRIPCION
           FROM app_tipo_caja_produ tcp
          WHERE tcp.pais_oid_pais = to_number(#oidPais#)
	</select>
	
	<select id="getOidTipoCajaProducto" parameterClass="java.util.Map" resultClass="string">
		SELECT	tcp.oid_tipo_caja_prod
	      FROM  app_tipo_caja_produ tcp
	  	 WHERE  tcp.pais_oid_pais = to_number(#oidPais#)
           AND 	tcp.cod_caja = #codigoTipoCaja#
	</select>
	
	<resultMap id="tipoCajaSubLineaResult"  class="java.util.HashMap"  >
		<result property="oidTipoCaja"		    column="OID_TIPO_CAJA"/>
		<result property="codigoTipoCaja"		column="COD_TIPO_CAJA"/>
		<result property="capacidadTipoCaja"	column="CAPACIDAD"/>
	</resultMap>
	<select id="getTipoCajaSubLineaList" parameterClass="java.util.Map"  resultMap="tipoCajaSubLineaResult">
		SELECT 	tcs.oid_tipo_caja_subl OID_TIPO_CAJA,
				tcp.cod_caja  COD_TIPO_CAJA,
       			tcs.num_caja  CAPACIDAD
           FROM ape_subli_armad sla,
       			ape_tipo_caja_subli tcs,
       			app_tipo_caja_produ tcp
          WHERE sla.oid_subl_arma = #oidSubLinea#
            AND sla.oid_subl_arma = tcs.sbar_oid_subl_arma
            AND tcp.oid_tipo_caja_prod = tcs.ticp_oid_tipo_caja_prod 
	</select>
	
	<select id="getOidSubLineaArmadobyCodigo" parameterClass="java.util.Map" resultClass="string">
		SELECT	sla.oid_subl_arma
	      FROM  ape_subli_armad sla
	  	 WHERE  sla.liar_oid_line_arma = #oidLinea#
           AND 	sla.cod_subl_arma = #codSubLinea#
	</select>
	
	<delete id="deleteTipoCaja" parameterClass="java.util.Map">
		 DELETE FROM ape_tipo_caja_subli a
         WHERE a.oid_tipo_caja_subl = #oidTipoCaja#
	</delete>
	
	<select id="getNextOidTipoCaja" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  APE_TCSB_SEQ.NEXTVAL FROM  dual
	</select>
	
	<select id="getNextOidSubLinea" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  APE_SBAR_SEQ.NEXTVAL FROM  dual
	</select>
	
	<insert id="insertTipoCaja" parameterClass="java.util.Map">
		INSERT INTO ape_tipo_caja_subli (  
			oid_tipo_caja_subl, 
       		num_caja,
       		sbar_oid_subl_arma, 
       		ticp_oid_tipo_caja_prod 
		)
		VALUES (  
			#oidNextTipoCaja#,
			#capacidadTipoCaja#,
			#oidSubLinea#,
			#oidTipoCaja#
		)
	</insert>
	
	<insert id="insertSubLineaArmado" parameterClass="java.util.Map">
		INSERT INTO ape_subli_armad 
		(  
			ccdi_oid_conf_cent_dist,
			liar_oid_line_arma,
			oid_subl_arma, 
   			cod_subl_arma,
   			sipi_oid_sist_pica,
   			ind_post_vent,
   			val_letr_para_anaq,
   			ind_impr_list_pica,
   			ind_fren_espa,
   			num_bahi_fren,
   			num_bahi_espa,
   			num_nive_fren,
   			num_nive_espa,
   			num_colu_fren,
   			num_colu_espa,
   			num_orde_bala,
   			num_ord_impr_subl,
   			cod_subl_wcs,
   			num_maxi_anaq_prod
		)
		VALUES 
		(  
			#oidCentro#,
			#oidLinea#,
			#oidSubLinea#,
			#codSubLinea#,
			#oidSistemaPicado#,
			#indPostVenta#,
			#codLetra#,
			#indImpresionListaPicado#,
			#indFrenteEspalda#,
			#numBahiaFrente#,
			#numBahiaEspalda#,
			#numNivelFrente#,
			#numNivelEspalda#,
			#numColumnaFrente#,
			#numColumnaEspalda#,
			#numOrdenBalanceo#,
			#numOrdenImpresion#,
			#codSubLineaAframe#,
			#numMaximoChanels#
		)
	</insert>
	
	<insert id="insertImpresoraSubLinea" parameterClass="java.util.Map">
		INSERT INTO ape_asign_impre (  
			oid_asign_impre,
   			imvi_oid_impr,
   			sbar_oid_subl_arma,
   			teim_oid_tecn,
   			num_impr_ptl  
		)
		VALUES (  
			ape_aimp_seq.NEXTVAL,
			#oidImpresoraVirtual#,
			#oidSubLinea#,
			#oidTecnologia#,
			#numImpresoraPTL#
		)
	</insert>
	
	<select id="getOidSistemaPicado" parameterClass="java.util.Map" resultClass="string">
		SELECT	a.oid_sist_pica
          FROM 	ape_siste_picad a
        WHERE 	a.cod_sist_pica = #codSistemaPicado#
	</select>
	
	<select id="getMaxCodSubLinesArmado" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  nvl(MAX(a.cod_subl_arma),0)+1 FROM  ape_subli_armad a
	</select>
	
	<update id="updateSubLineaArmado" parameterClass="java.util.Map">
		UPDATE 	ape_subli_armad
           SET 	sipi_oid_sist_pica = #oidSistemaPicado#,
       			ind_post_vent = #indPostVenta#,
       			ind_impr_list_pica = #indImpresionListaPicado#,
       			ind_fren_espa = #indFrenteEspalda#,
       			num_bahi_fren = #numBahiaFrente#,
       			num_bahi_espa = #numBahiaEspalda#,
       			num_nive_fren = #numNivelFrente#,
       			num_nive_espa = #numNivelEspalda#,
       			num_colu_fren = #numColumnaFrente#,
       			num_colu_espa = #numColumnaEspalda#,
       			num_orde_bala = #numOrdenBalanceo#,
       			num_ord_impr_subl = #numOrdenImpresion#,
       			cod_subl_wcs  = #codSubLineaAframe#,
       			num_maxi_anaq_prod = #numMaximoChanels#
         WHERE 	ccdi_oid_conf_cent_dist = #oidCentro#
           AND  liar_oid_line_arma = #oidLinea#
           AND 	oid_subl_arma = #oidSubLinea#
	</update>
	
	<select id="getExisteLetraAnquelCD" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
          FROM ape_subli_armad a
         WHERE a.ccdi_oid_conf_cent_dist = #oidCentro#
   		   AND a.liar_oid_line_arma = #oidLinea#
   		   AND a.val_letr_para_anaq = #codLetra#
	</select>
	
	<select id="getOidCodigoImpresora" parameterClass="java.util.Map" resultClass="int">
		SELECT	a.oid_impr
          FROM 	fac_impre_virtu a
         WHERE 	a.cod_impr = #codImpresora#
	</select>
	
	<delete id="deleteCodigoImpresora" parameterClass="java.util.Map">
		DELETE FROM ape_asign_impre a
         WHERE a.sbar_oid_subl_arma = #oidSubLinea#
	</delete>
	
	<select id="getCodigoLineaArmadobyOid" parameterClass="java.util.Map" resultClass="string">
		SELECT to_char(a.num_codi_line)
          FROM ape_linea_armad a
         WHERE a.oid_line_arma = to_number(#oidLinea#)
	</select>
	
	<select id="getCodigoTipoAnaquelesList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	a.cod_tipo_anaq AS CODIGO,
				b.val_i18n      AS DESCRIPCION
          FROM 	ape_tipo_anaqu a,
        		gen_i18n_sicc_comun b
 		 WHERE  a.oid_tipo_anaq = b.val_oid
           AND  b.attr_enti = #nombreTablaTipoAnaquel#
   		   AND  b.attr_num_atri = 1
   		   AND  b.idio_oid_idio = 1
	</select>
	
	<resultMap id="tipoAnaquelesResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidTipoAnaquel"				column="OID_TIPO_ANAQUEL"/>
    	<result property="codTipoAnaquel"				column="COD_TIPO_ANAQUEL"/>
    	<result property="desTipoAnaquel" 				column="DES_TIPO_ANAQUEL"/>
    	<result property="tipo" 						column="COD_TIPO"/>
    	<result property="oidTipoChanel" 				column="OID_TIPO_CHANEL"/>
    	<result property="desTipoChanel" 				column="DES_TIPO_CHANEL"/>
    	<result property="indDefault" 					column="IND_DEFAULT"/>
	</resultMap>
	<select id="getTipoAnaquelesList" parameterClass="java.util.Map" resultMap="tipoAnaquelesResult">
		SELECT	a.oid_tipo_anaq                            			AS OID_TIPO_ANAQUEL,
        		a.cod_tipo_anaq                            			AS COD_TIPO_ANAQUEL,
        		b.val_i18n                                 			AS DES_TIPO_ANAQUEL,
        		decode(a.ind_tipo_afrm, '0','NORMAL','AFRAME')      AS COD_TIPO,
        		c.oid_tipo_chan                            			AS OID_TIPO_CHANEL,
        		(SELECT d.val_i18n
   			       FROM gen_i18n_sicc_comun d
   			      WHERE d.attr_enti = #nombreTablaTipoChanel#
                    AND d.idio_oid_idio = 1
                    AND d.val_oid = c.oid_tipo_chan)       			AS DES_TIPO_CHANEL,
        		decode(a.ind_anaq_defa,'1', 'S', 'N' )              AS IND_DEFAULT           
  	      FROM	ape_tipo_anaqu a,
        		gen_i18n_sicc_comun b,
        		ape_tipo_chane c
 	     WHERE  b.attr_enti = #nombreTablaTipoAnaquel#
   		   AND  b.attr_num_atri = 1
   		   AND  b.idio_oid_idio = 1
   		   AND  a.oid_tipo_anaq = b.val_oid
           AND  a.tich_oid_tipo_chan = c.oid_tipo_chan(+)
           
        <isNotEmpty property="codTipoAnaquel">
   		   AND  a.cod_tipo_anaq = #codTipoAnaquel#
   		</isNotEmpty>
           
	</select>
	
	<parameterMap id="paramDeleteTipoAnaquel" class="java.util.Map">
		<parameter property="oidTipoAnaquel"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="valError"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>			
		<parameter property="nomTabla"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
	</parameterMap>
	<procedure id="deleteTipoAnaquel" parameterMap="paramDeleteTipoAnaquel">
		{call APE_PKG_PROCE.APE_PR_ELIMI_TIPO_ANAQU(?, ?, ?) }
	</procedure>
	
	<resultMap id="getTipoAnaquelObjectResult"  class="tipoAnaquel"  >                                                                       
    	<result property="oidTipoAnaquel"				column="OID_TIPO_ANAQUEL"/>
    	<result property="codigoTipoAnaquel"			column="COD_TIPO_ANAQUEL"/>
    	<result property="descripcionTipoAnaquel"		column="DES_TIPO_ANAQUEL"/>
    	<result property="tipo" 						column="COD_TIPO"/>
    	<result property="codigoTipoChanel" 			column="COD_TIPO_CHANEL"/>
    	<result property="indDefault" 					column="IND_DEFAULT"/>
	</resultMap>
	<select id="getTipoAnaquelObject" parameterClass="java.util.Map" resultMap="getTipoAnaquelObjectResult">
		SELECT 	a.oid_tipo_anaq       								AS OID_TIPO_ANAQUEL,
        		a.cod_tipo_anaq       								AS COD_TIPO_ANAQUEL,
        		b.val_i18n            								AS DES_TIPO_ANAQUEL,
        		a.ind_tipo_afrm      								AS COD_TIPO,
        		c.cod_tipo_chan       								AS COD_TIPO_CHANEL,
        		a.ind_anaq_defa										AS IND_DEFAULT
          FROM  ape_tipo_anaqu a,
        		gen_i18n_sicc_comun b,
        		ape_tipo_chane c
         WHERE  a.oid_tipo_anaq = #oidTipoAnaquel#
   		   AND  b.attr_enti = #nombreTablaTipoAnaquel#
   		   AND  b.attr_num_atri = 1
   		   AND  b.idio_oid_idio = 1
   		   AND  a.oid_tipo_anaq = b.val_oid
   		   AND  a.tich_oid_tipo_chan = c.oid_tipo_chan(+)
	</select>
	
	<select id="getTipoChanelList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	a.cod_tipo_chan as CODIGO,
				b.val_i18n 		as DESCRIPCION
  		  FROM 	ape_tipo_chane a,
       		    gen_i18n_sicc_comun b
 		 WHERE  a.oid_tipo_chan = b.val_oid
   		   AND 	b.attr_enti = #nombreTablaTipoChanel#
   		   AND 	b.attr_num_atri = 1
           AND 	b.idio_oid_idio = 1 
	</select>
	
	<select id="getOidTipoChanel" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT a.oid_tipo_chan
  		  FROM ape_tipo_chane a
         WHERE a.cod_tipo_chan = #codigoTipoChanel#
	</select>
	
	<update id="updateTipoAnaquel" parameterClass="java.util.Map">
		UPDATE ape_tipo_anaqu a
           SET ind_tipo_afrm = #tipo#,
           	   tich_oid_tipo_chan = #oidTipoChanel#,
           	   ind_anaq_defa = #valorDefecto#
         WHERE a.oid_tipo_anaq = #oidTipoAnaquel#	
	</update>
	
	<select id="getNextOidTipoAnaquel" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT APE_TIAN_SEQ.NEXTVAL FROM dual  
	</select>
	
	<select id="getExisteCodTipoAnaquel" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
		  FROM ape_tipo_anaqu a
		 WHERE a.cod_tipo_anaq = #codTipoAnaquel#
	</select>
	
	<insert id="insertTipoAnaquel" parameterClass="java.util.Map">
		INSERT INTO ape_tipo_anaqu 
		(  
    		oid_tipo_anaq,
  			cod_tipo_anaq,
  			ind_tipo_afrm,
  			tich_oid_tipo_chan,
  			ind_anaq_defa
		)
		VALUES 
		(  
			#oidTipoAnaquel#,
			#codTipoAnaquel#,
			#tipo#,
			#oidTipoChanel#,
			#valorDefecto#
		)
	</insert>
	
	<insert id="insertIdiomasComunAPE" parameterClass="java.util.Map">
		INSERT INTO gen_i18n_sicc_comun (
   			oid_i18n,
   			attr_enti,
   			attr_num_atri,
   			idio_oid_idio,
   			val_i18n,
   			val_oid
		)
		VALUES(
   			gen_i18n_seq.nextval,
   			#nombreTabla#,
   			#numAtributo#,
   			#oidIdioma#,
   			#valAtributo#,
   			#valOidAtributo#
		)
	</insert>
	
	<update id="updateIdiomasComunAPE" parameterClass="java.util.Map">
		UPDATE gen_i18n_sicc_comun
           SET val_i18n = #valAtributo#
         WHERE attr_enti = #nombreTabla#
           AND val_oid = #valOidAtributo#
	</update>
	
	<select id="validaTipoAnaquelDefaultbyOid" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
		  FROM ape_tipo_anaqu a
		 WHERE a.oid_tipo_anaq = #oidTipoAnaquel#
		   AND a.ind_anaq_defa = 1
	</select>
	
	<select id="validaExisteTipoAnaquelDefaultbyTipo" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
		  FROM ape_tipo_anaqu a
		 WHERE a.ind_anaq_defa = 1
           AND a.ind_tipo_afrm = decode(#valTipo#,'N',0,1)
	</select>
	
	<update id="updateValorTipoDefault" parameterClass="java.util.Map">
		UPDATE ape_tipo_anaqu a
           SET a.ind_anaq_defa = decode(#valDefecto#,'D',1,0)
         WHERE a.oid_tipo_anaq = #oidTipoAnaquel#
	</update>
	
	<select id="getOidTipoAnaquelbyTipoDefault" parameterClass="java.util.Map" resultClass="string">
		SELECT to_char(a.oid_tipo_anaq)
          FROM ape_tipo_anaqu a 
         WHERE a.ind_tipo_afrm = decode(#valTipo#,'N',0,1)
           AND a.ind_anaq_defa = 1
	</select>
	
    <select id="getMaxCodMapaZona" parameterClass="java.util.Map" resultClass="java.lang.Integer">
			SELECT nvl(MAX(a.cod_mapa_zona),0)+1 
			FROM ape_mapa_zona_cabec a	
	</select>

	<insert id="insertMapaZonaCabecera" parameterClass="java.util.Map">	
		INSERT INTO APE_MAPA_ZONA_CABEC(
			oid_mapa_zona_cabe,
			cod_mapa_zona,
			val_defe,
			mcdc_oid_mapa_cent_dist_cabe)
		VALUES(
			#oidMapaZonacab#,
			#codMapaZona#,
			#valDefecto#,
			#oidMapaCDCab#)
	</insert>
	
	<select id="getOidSequenceMapaZona" parameterClass="java.util.Map" resultClass="java.lang.String">
			SELECT ape_mzca_seq.nextval FROM dual	
	</select>

	<insert id="insertMapaZonaDetalle" parameterClass="java.util.Map">	
			INSERT INTO APE_MAPA_ZONA_DETAL(
			       oid_mapa_zona_deta,
			       num_idzo,
			       num_bahi_desd,
			       num_bahi_hast,
			       sbar_oid_subl_arma,
			       mzca_oid_mapa_zona_cabe)
			VALUES(
			       ape_mzcd_seq.nextval,
			       #numIdzona#,
			       #bahiaIni#,
			       #bahiaFin#,
			       #oidSubLinea#,
			       #oidMapacab#
			       )
	</insert>
	
	<select id="getMapaZonaListxOidMapaCD" parameterClass="java.util.Map"  resultMap="baseResult">
			SELECT a.cod_mapa_zona as CODIGO,
			       s.val_i18n as DESCRIPCION
	  		FROM   ape_mapa_zona_cabec a,
	       	   	   gen_i18n_sicc_pais s
	 		WHERE  a.oid_mapa_zona_cabe = s.val_oid
	    	AND    s.attr_enti = 'APE_MAPA_ZONA_CABEC'
	    	AND    a.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
	    	ORDER BY 1
	</select>
	
	<resultMap id="subListaMapaZonaLA"  class="java.util.HashMap" >                                                                       
    	<result property="oidMapaZona"			column="OIDMAPAZONA"/>
    	<result property="codMapaZona"			column="CODMAPAZONA"/>
    	<result property="desMapaZona"			column="DESC_MAPAZONA"/>
    	<result property="idValDefecto"			column="IDVALDEFECTO"/>
    	<result property="desValDefecto"		column="VALDEFECTO"/>
	</resultMap>
	
	<select id="getListaMapaZonaLineaArmado" parameterClass="java.util.Map" resultMap="subListaMapaZonaLA">
        SELECT  cab.oid_mapa_zona_cabe        OIDMAPAZONA, 
                cab.cod_mapa_zona             CODMAPAZONA,
                APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_MAPA_ZONA_CABEC',cab.oid_mapa_zona_cabe,'P') DESC_MAPAZONA,
                cab.val_defe                  IDVALDEFECTO,
                CASE WHEN cab.val_defe = 1 
                THEN 'SI' ELSE 'NO' END as    VALDEFECTO
        FROM 	ape_mapa_zona_cabec cab
        WHERE 	cab.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
        
    	<isNotEmpty property="oidMapaZona">
	    AND		cab.oid_mapa_zona_cabe			 = #oidMapaZona#
	    </isNotEmpty>
	</select>

	<resultMap id="subListaDetalleMZ"  class="java.util.HashMap" >                                                                       
    	<result property="oidMapaZona"			column="OIDMAPAZONA"/>
    	<result property="idValdefecto"			column="VALDEFECTO"/>
    	<result property="codigoZona"			column="NUMIDZONA"/>
    	<result property="descripcionMapaZona"	column="DESC_MAPAZONA"/>
    	<result property="descripcionSubLinea"	column="DESC_SUBLINEA"/>
    	<result property="bahiaInicial"			column="BAHIAINICIAL"/>
    	<result property="bahiaFinal"			column="BAHIAFINAL"/>
    	<result property="oidSubLinea"			column="OIDSUBLINEA"/>
    	<result property="oidMapaCD"			column="OIDMAPACD"/>
	</resultMap>
	
	<select id="getObtenerDetMapaZonaLineaArmado" parameterClass="java.util.Map" resultMap="subListaDetalleMZ">
        SELECT cab.oid_mapa_zona_cabe 	        OIDMAPAZONA, 
               cab.val_defe			  	        VALDEFECTO, 
               det.num_idzo 		  	        NUMIDZONA,
               APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_MAPA_ZONA_CABEC',cab.oid_mapa_zona_cabe,'P') DESC_MAPAZONA,
               APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_SUBLI_ARMAD',det.sbar_oid_subl_arma,'P') DESC_SUBLINEA,
               det.num_bahi_desd	  	        BAHIAINICIAL, 	
               det.num_bahi_hast 	  	        BAHIAFINAL,	
               det.sbar_oid_subl_arma 	        OIDSUBLINEA,
               cab.mcdc_oid_mapa_cent_dist_cabe OIDMAPACD
        FROM   ape_mapa_zona_cabec cab,
               ape_mapa_zona_detal det
        WHERE  cab.oid_mapa_zona_cabe = det.mzca_oid_mapa_zona_cabe
        AND    cab.oid_mapa_zona_cabe = #oidMapaZona#
    </select>
    
	<select id="getSubLineaComboList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT sl.oid_subl_arma as CODIGO,
		       s.val_i18n as DESCRIPCION
  		FROM   ape_subli_armad sl,
       	   	   gen_i18n_sicc_pais s
 		WHERE  s.attr_enti = 'APE_SUBLI_ARMAD'
    	AND    sl.oid_subl_arma = s.val_oid
	</select>
	
	<select id="getObtenerCodigoCDxOidMapaCD" parameterClass="java.util.Map"  resultClass="string">
        SELECT acc.cod_cent_dist
        FROM   ape_mapa_centr_distr_cabec mpc, 
               app_confi_centr_distr acc
        WHERE  mpc.ccdi_oid_conf_cent_dist = acc.oid_conf_cent_dist
        AND    mpc.oid_mapa_cent_dist_cabe = #oidMapaCD#
        AND    ROWNUM = 1
	</select>
	
	<select id="getObtenerCodLinArmadxOidSubLinArmad" parameterClass="java.util.Map"  resultClass="string">
	    SELECT 	b.num_codi_line
	  	FROM    ape_subli_armad sl,
                ape_linea_armad b
	  	WHERE   sl.liar_oid_line_arma = b.oid_line_arma
	  	AND     sl.oid_subl_arma = #oidSubLinArmad#
	</select>

	<select id="getObtenerCodigoMapaCD" parameterClass="java.util.Map"  resultClass="string">
        SELECT mp.num_codi_mapa
        FROM   ape_mapa_centr_distr_cabec mp
        WHERE  mp.oid_mapa_cent_dist_cabe = #oidMapaCD#
	</select>
	
	<select id="getSubLineaporLineaList" parameterClass="java.util.Map"  resultMap="baseResult">
			SELECT sl.oid_subl_arma as CODIGO,
		    	   s.val_i18n as DESCRIPCION
		  	FROM   ape_subli_armad sl,
       			   gen_i18n_sicc_pais s
			WHERE  sl.oid_subl_arma = s.val_oid
		    AND    sl.liar_oid_line_arma = #oidLinArmado#
		    AND    s.attr_enti = 'APE_SUBLI_ARMAD'
	</select>
	
	<update id="updateMapaZonaCabecera" parameterClass="java.util.Map">
    	UPDATE 	ape_mapa_zona_cabec 
    	SET 	val_defe = #valDefecto#
    	WHERE 	oid_mapa_zona_cabe = #oidMapaZona#
	</update>
	
	<parameterMap id="paramDeleteMapaZona" class="java.util.Map">
 		<parameter property="oidMapaZona"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="valError"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>			
		<parameter property="nomTabla"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
	</parameterMap>
	
	<procedure id="deleteMapaZona" parameterMap="paramDeleteMapaZona">
		{call APE_PKG_PROCE.APE_PR_ELIMI_MAPA_ZONA(?,?,?) }
	</procedure>
	
	<delete id="deleteMapaZonaxLineaArmado" parameterClass="java.util.Map">
        DELETE FROM APE_MAPA_ZONA_DETAL det
        WHERE det.mzca_oid_mapa_zona_cabe = #oidMapaZona# 
        AND   det.sbar_oid_subl_arma 
        IN    (SELECT sl.oid_subl_arma
               FROM   ape_subli_armad sl, ape_linea_armad liar
               WHERE  sl.liar_oid_line_arma = liar.oid_line_arma
               AND    liar.oid_line_arma = #oidLinArmado#)
	</delete>
	
    <parameterMap id="paramGenerMapaCDDetal" class="map" >
		<parameter property="oidPais"                    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oidCentrDistr"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oidMapaCentDist"	   		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="descMapaCentDist"	       	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oid_idiomaISO"	       	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeGenerMapaCDDetal" parameterMap="paramGenerMapaCDDetal" >
		{call APE_PKG_PROCE.APE_PR_GENER_MAPA_CD_DETAL(?,?,?,?,?)}
    </procedure>
	
		
	<select id="getNextCodigoMapaCentroDistribucion" parameterClass="java.util.Map" resultClass="string">
		SELECT DECODE(MAX (AMCDC.NUM_CODI_MAPA), NULL, 0,  MAX (AMCDC.NUM_CODI_MAPA))  + 1
          FROM APE_MAPA_CENTR_DISTR_CABEC AMCDC
	</select>
	
	<parameterMap id="paramGenerarMapaCentroDistribucion" class="java.util.Map">
		<parameter property="oidCentro"        		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="codMapaCentro"     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="desMapaCentro"      	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="oidIdiomaISO"        	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	<procedure id="executeGenerarMapaCentroDistribucion" parameterMap="paramGenerarMapaCentroDistribucion">
		{call APE_PKG_PROCE.APE_PR_GENER_MAPA_CENTR_DISTR(?, ?, ?, ?) }
	</procedure>
	
	<select id="getAnaquelDestinoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT    oid_mapa_cent_dist_deta 	as CODIGO,
			      num_anaq                	as DESCRIPCION
		FROM      APE_MAPA_CENTR_DISTR_DETAL 
		WHERE     mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
	    ORDER BY  num_anaq
	</select>
	
	<select id="getAnaquelOrigenList" parameterClass="java.util.Map"  resultMap="baseResult">
	     SELECT mcdc.oid_mapa_cent_dist_deta as CODIGO,
	            mcdc.num_anaq                as DESCRIPCION
	     FROM APE_MAPA_CENTR_DISTR_DETAL mcdc
	     WHERE mcdc.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
	     AND SUBSTR(mcdc.num_anaq,1,3) 
	     IN (
	        SELECT SUBSTR(num_anaq,1,3)
	        FROM APE_MAPA_CENTR_DISTR_DETAL 
	        WHERE oid_mapa_cent_dist_deta = #oidMapaCDDet#
	        )
	     AND mcdc.oid_mapa_cent_dist_deta NOT IN (#oidMapaCDDet#)
	     AND mcdc.sbar_oid_subl_arma = #oidSubLinea#                          
	</select>
	
	<select id="getObtenerSubLineaxOidMapaCDDet" parameterClass="java.util.Map"  resultClass="string">
	    SELECT mcdt.sbar_oid_subl_arma as OIDSUBLINEA
   		FROM   APE_MAPA_CENTR_DISTR_DETAL mcdt
   		WHERE  mcdt.oid_mapa_cent_dist_deta = #oidMapaCDDet# 
	</select>
	
	<select id="getValidaNoExisteAsignaProductoAAnaquelDet" parameterClass="java.util.Map"  resultClass="string">
		SELECT COUNT(1)
		FROM   APE_ASIGN_PRODU_ANAQU_DETAL asgprddet,
		       APE_ASIGN_PRODU_ANAQU_CABEC asgprdcab,
		       CRA_PERIO per,
		       SEG_CANAL c,
		       SEG_MARCA d      
		WHERE  asgprddet.apac_oid_asig_prod_anaq_cabe  = asgprdcab.oid_asig_prod_anaq_cabe
		AND    asgprdcab.perd_oid_peri                 = per.peri_oid_peri
		AND    per.cana_oid_cana                       = c.oid_cana 
		AND    per.marc_oid_marc                       = d.oid_marc
		AND    asgprdcab.mcdc_oid_mapa_cent_dist_cabe  = #oidMapaCD#
		AND    asgprddet.mcdd_oid_mapa_cent_dist_deta  = #oidMapaCDDet#
		AND    per.peri_oid_peri                      >= #periodo#
		AND    c.cod_cana                              = 'VD'
		AND    d.cod_marc                              = 'T'
	</select>
	
	<select id="getOidMarcaxCod" parameterClass="java.util.Map"  resultClass="string">
		SELECT oid_marc 
		FROM SEG_MARCA
		WHERE cod_marc = #codMarca#
	</select>
	
	<select id="getOidCanalxCod" parameterClass="java.util.Map"  resultClass="string">
		SELECT oid_cana
		FROM SEG_CANAL
		WHERE cod_cana = #codCanal#
	</select>
	
	<select id="getOidPeriodo" parameterClass="java.util.Map"  resultClass="string">
		SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codPeriod#) FROM DUAL
	</select>
	
	<update id="updateCapacidadMapCDDetalle" parameterClass="java.util.Map">
		UPDATE APE_MAPA_CENTR_DISTR_DETAL
		SET    num_capa = #numCapa# 
		WHERE  oid_mapa_cent_dist_deta = #oidMapaCDDet# 
	</update>
	
	<update id="updateAnaquelOrigenMapaCDDetalle" parameterClass="java.util.Map">
		UPDATE APE_MAPA_CENTR_DISTR_DETAL
		SET   mcdd_oid_mapa_cent_dist_deta = #oidMapaCDDet#,
		      ind_expa                     = #indicador#
		WHERE oid_mapa_cent_dist_deta = #oidMapaCDOrigen#
	</update>
	
	<select id="getCodAnaqOrigenList" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT DISTINCT oid_mapa_cent_dist_deta as CODIGO,
           	   num_anaq as DESCRIPCION
		FROM   APE_MAPA_CENTR_DISTR_DETAL
		WHERE  oid_mapa_cent_dist_deta IN (
           	   SELECT mcdd_oid_mapa_cent_dist_deta
           	   FROM   APE_MAPA_CENTR_DISTR_DETAL
           	   WHERE  mcdd_oid_mapa_cent_dist_deta IS NOT NULL
           	   AND    mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD# )
	</select>

	<update id="updateAnaquelOrigOpcionDividir" parameterClass="java.util.Map">
		UPDATE APE_MAPA_CENTR_DISTR_DETAL
		SET    ind_expa = #indicador#,
		       num_capa = #capacidad#,
		       mcdd_oid_mapa_cent_dist_deta = #oidMapaCDDetFK#
		WHERE  oid_mapa_cent_dist_deta = #oidMapaCDDet#	
	</update>
	
	<select id="getOrdenAnaquelList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT a.cod_mapa_orde as CODIGO,
		       s.val_i18n as DESCRIPCION
 		FROM   APE_ORDEN_ANAQU_CABEC a,
       	   	   gen_i18n_sicc_pais s
 		WHERE  a.oid_anaq_cabe = s.val_oid
    	AND    s.attr_enti = 'APE_ORDEN_ANAQU_CABEC'
   		AND    a.mzca_oid_mapa_zona_cabe = #oidMapaZona#
   		ORDER BY 1
   	</select>
   	
	<select id="getOidOrdenAnaqueles" parameterClass="java.util.Map"  resultClass="string">
	    SELECT oid_anaq_cabe
	    FROM   APE_ORDEN_ANAQU_CABEC
	    WHERE  cod_mapa_orde = #codOrdenAnaqu#
	    AND    mzca_oid_mapa_zona_cabe = #oidMapaZona#
	</select>  
	
	<select id="getMapaZonaDefault" parameterClass="java.util.Map"  resultClass="string">
	    SELECT cod_mapa_zona
	    FROM   APE_MAPA_ZONA_CABEC
	    WHERE  mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
	    AND    val_defe = 1
	    AND    ROWNUM = 1
	</select>
	
	<parameterMap id="paramGenerarOrdenAnaquelesDet" class="map" >
	    <parameter property="oidMapaZonaOrig"	         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oidOrdenAnaqOrig"	   		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="descOrdenAnaq"	       	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oidMapaZonaDest"	       	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oid_idiomaISO"	       	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeGenerarOrdenAnaquelDet" parameterMap="paramGenerarOrdenAnaquelesDet" >
		{call APE_PKG_PROCE.APE_PR_GENER_ORD_ANAQUEL_DETAL(?,?,?,?,?)}
    </procedure>
	
	<resultMap id="mapaOrdenLineaResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidCentro"			column="OID_CENTRO_DISTRIBUCION"/>
    	<result property="desCentro"			column="DES_CENTRO_DISTRIBUCION"/>
    	<result property="oidMapaCentro" 		column="OID_MAPA_CENTRO_DISTRIBUCION"/>
    	<result property="desMapaCentro" 		column="DES_MAPA_CENTRO_DISTRIBUCION"/>
    	<result property="oidMapaZona" 			column="OID_MAPA_ZONA"/>
    	<result property="desMapaZona" 			column="DES_MAPA_ZONA"/>
	    <result property="oidMapaOrden" 		column="OID_MAPA_ORDEN"/>
	    <result property="codMapaOrden" 	   	column="COD_MAPA_ORDEN"/>
	    <result property="desMapaOrden" 		column="DES_MAPA_ORDEN"/>
	    <result property="oidLinea" 			column="OID_LINEA_ARMADO"/>
	    <result property="desLinea" 	   		column="DES_LINEA_ARMADO"/>
	    <result property="valDefecto" 			column="VAL_DEFECTO"/>
	</resultMap>
	
	<select id="getMapaOrdenLineaList" parameterClass="java.util.Map" resultMap="mapaOrdenLineaResult">
		SELECT	ccd.oid_conf_cent_dist                                      OID_CENTRO_DISTRIBUCION,
       			(SELECT  gisp.val_i18n
          		   FROM  gen_i18n_sicc_pais gisp
         	      WHERE  gisp.attr_enti = #nombreTablaCentroDistribucion#
           		    AND  gisp.idio_oid_idio = 1
           			AND  gisp.attr_num_atri = 1
           			AND  gisp.val_oid = ccd.oid_conf_cent_dist)             DES_CENTRO_DISTRIBUCION,
       			mcdc.oid_mapa_cent_dist_cabe                                OID_MAPA_CENTRO_DISTRIBUCION,
       			(SELECT  gisp.val_i18n
          		   FROM  gen_i18n_sicc_pais gisp
         		  WHERE  gisp.attr_enti = #nombreTablaMapaCentroDistribucionCab#
           		    AND  gisp.idio_oid_idio = 1
           			AND  gisp.attr_num_atri = 1
           			AND  gisp.val_oid = mcdc.oid_mapa_cent_dist_cabe)       DES_MAPA_CENTRO_DISTRIBUCION,
       			mzc.oid_mapa_zona_cabe                                      OID_MAPA_ZONA,
       			(SELECT  gisp.val_i18n
          		   FROM  gen_i18n_sicc_pais gisp
         		  WHERE  gisp.attr_enti = #nombreTablaMapaZonaCab#
           		    AND  gisp.idio_oid_idio = 1
           			AND  gisp.attr_num_atri = 1
           			AND  gisp.val_oid = mzc.oid_mapa_zona_cabe)             DES_MAPA_ZONA,
       			oac.oid_anaq_cabe                                           OID_MAPA_ORDEN,
       			oac.cod_mapa_orde                                           COD_MAPA_ORDEN,
       			(SELECT  gisp.val_i18n
          		   FROM  gen_i18n_sicc_pais gisp
         		  WHERE  gisp.attr_enti = #nombreTablaOrdenAnaquelesCab#
           			AND  gisp.idio_oid_idio = 1
           			AND  gisp.attr_num_atri = 1
           			AND  gisp.val_oid = oac.oid_anaq_cabe)                  DES_MAPA_ORDEN,
       			la.oid_line_arma                                            OID_LINEA_ARMADO,
       			(SELECT  gisp.val_i18n
          		   FROM  gen_i18n_sicc_pais gisp
         		  WHERE  gisp.attr_enti = #nombreTablaLineaArmado#
           			AND  gisp.idio_oid_idio = 1
           			AND  gisp.attr_num_atri = 1
           			AND  gisp.val_oid = la.oid_line_arma)                   DES_LINEA_ARMADO,
       			decode(oac.val_defe,1,'SI','NO')                            VAL_DEFECTO	 
  	      FROM  app_confi_centr_distr ccd,
       			ape_mapa_centr_distr_cabec mcdc,
       			ape_mapa_zona_cabec mzc,
       			ape_orden_anaqu_cabec oac,
       			ape_linea_armad la
 	   	 WHERE  ccd.oid_conf_cent_dist = mcdc.ccdi_oid_conf_cent_dist
   		   AND 	ccd.oid_conf_cent_dist = #oidCentro#
   		   AND 	mcdc.oid_mapa_cent_dist_cabe = mzc.mcdc_oid_mapa_cent_dist_cabe
   		   AND 	mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
   		   AND 	mzc.oid_mapa_zona_cabe = oac.mzca_oid_mapa_zona_cabe
      	   AND 	mzc.oid_mapa_zona_cabe = #oidMapaZona#
   		   AND 	oac.oid_anaq_cabe = #oidMapaOrden#
   		   AND 	oac.liar_oid_line_arma = la.oid_line_arma
	</select>
	
	<select id="getMapaCentroDistribucionComboList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	mcdc.num_codi_mapa 	as CODIGO,
			   	i18n.val_i18n 		as DESCRIPCION
	  	  FROM  ape_mapa_centr_distr_cabec mcdc,
    	   	   	gen_i18n_sicc_pais i18n
		 WHERE  mcdc.oid_mapa_cent_dist_cabe = i18n.val_oid
	       AND  i18n.attr_enti = #nombreTablaMapaCentroDistribucionCab#
    	   AND  mcdc.ccdi_oid_conf_cent_dist = #oidCentro#
    	   AND 	i18n.idio_oid_idio = 1
   	       AND 	i18n.attr_num_atri = 1
      ORDER BY 	i18n.val_i18n
	</select>
	
	<select id="getMapaZonaComboList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	mzc.cod_mapa_zona AS CODIGO,
			 	i18n.val_i18n     AS DESCRIPCION
	  	  FROM  ape_mapa_zona_cabec mzc,
	     		gen_i18n_sicc_pais i18n
	     WHERE  mzc.oid_mapa_zona_cabe = i18n.val_oid
	       AND i18n.attr_enti = #nombreTablaMapaZonaCab#
   		   AND i18n.idio_oid_idio = 1
   		   AND i18n.attr_num_atri = 1
	 	   AND mzc.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
      ORDER BY mzc.val_defe DESC
	</select>
	
	<select id="getMapaOrdenComboList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	oac.cod_mapa_orde  AS CODIGO,
       			i18n.val_i18n      AS DESCRIPCION
	  	  FROM  ape_orden_anaqu_cabec oac,
       			gen_i18n_sicc_pais i18n
	     WHERE  oac.oid_anaq_cabe = i18n.val_oid
   		   AND 	i18n.attr_enti = #nombreTablaOrdenAnaquelesCab#
           AND 	i18n.idio_oid_idio = 1
           AND 	i18n.attr_num_atri = 1
           AND 	oac.mzca_oid_mapa_zona_cabe = #oidMapaZona#
      ORDER BY oac.val_defe DESC
	</select>
	
	<select id="getOidOrdenAnaquel" parameterClass="java.util.Map" resultClass="java.lang.String">
		SELECT a.oid_anaq_cabe
          FROM ape_orden_anaqu_cabec a
         WHERE a.cod_mapa_orde = #codMapaOrden#
           AND a.mzca_oid_mapa_zona_cabe = #oidMapaZona#
	</select>
	
	<select id="getOidMapaZonaByCodMapaZona" parameterClass="java.util.Map" resultClass="string">
    	SELECT	c.oid_mapa_zona_cabe
	      FROM	ape_mapa_zona_cabec c
	     WHERE	c.cod_mapa_zona = #codMapaZona#
	</select>
	
	<select id="getLineaMapaOrdenComboList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	DISTINCT lin.num_codi_line  AS CODIGO,
       			i18n.val_i18n      AS DESCRIPCION
	  	  FROM  ape_mapa_centr_distr_detal cendet,
       			ape_linea_armad            lin,
       			ape_subli_armad            sublin,
       			v_gen_i18n_sicc            i18n
	     WHERE  cendet.sbar_oid_subl_arma = sublin.oid_subl_arma
   		   AND 	sublin.liar_oid_line_arma = lin.oid_line_arma
   		   AND 	cendet.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
   		   AND 	lin.oid_line_arma = i18n.val_oid
   		   AND 	i18n.idio_oid_idio = 1
   		   AND 	i18n.attr_num_atri = 1
   		   AND 	i18n.attr_enti = #nombreTablaLineaArmado#
	</select>
	
	<resultMap id="subLineasNuevoOrdenAnaquelResult"  class="java.util.HashMap" >                                                                       
    	<result property="oidMapaCentro"		column="OID_MAPA_CENTRO"/>
    	<result property="oidLinea"				column="OID_LINEA"/>
    	<result property="oidSubLinea"			column="OID_SUBLINEA"/>
    	<result property="desSubLinea"			column="DES_SUBLINEA"/>
    	<result property="numOrdenado"			column="NUM_ORDENADO"/>
	</resultMap>	
	<select id="getSubLineasNuevoOrdenAnaquel" parameterClass="java.util.Map" resultMap="subLineasNuevoOrdenAnaquelResult">
    	SELECT	#oidMapaCentro#			        OID_MAPA_CENTRO,
    			lin.oid_line_arma     			OID_LINEA,
    			sublin.oid_subl_arma  			OID_SUBLINEA, 
       			i18n.val_i18n         			DES_SUBLINEA,
       			#ordenado#                  	NUM_ORDENADO
          FROM	ape_linea_armad lin,
          		ape_subli_armad sublin, 
       			gen_i18n_sicc_pais i18n  
         WHERE  lin.oid_line_arma = #oidLinea#
           AND 	lin.oid_line_arma = sublin.liar_oid_line_arma
   		   AND 	sublin.oid_subl_arma = i18n.val_oid 
   		   AND 	i18n.idio_oid_idio = 1 
   		   AND 	i18n.attr_num_atri = 1  
   		   AND 	i18n.attr_enti = #nombreTablaSubLineaArmado#
	  ORDER BY 	i18n.val_i18n 
    </select>
    
    <select id="validaExisteOrdeAnaquelDefault" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
  	      FROM ape_orden_anaqu_cabec oac
         WHERE oac.mzca_oid_mapa_zona_cabe = #oidMapaZona#
           AND oac.val_defe = 1
	</select>
	
	
	<select id="validaSublineaArmadoMatching" parameterClass="java.util.Map" resultClass="java.lang.Integer">
	 	select count(*) from ape_subli_armad sl
      	where FNDI_OID_FUNC_DIST = 1
      	and COD_SUBL_ARMA=#codSublinea#
	</select>
	
	
	<select id="getDescripcionCentroDistribucion" parameterClass="java.util.Map" resultClass="string">
    	SELECT 	b.val_i18n 
   		  FROM 	app_confi_centr_distr a,
       			gen_i18n_sicc_pais b
  		 WHERE 	a.pais_oid_pais = #oidPais#
           AND 	a.oid_conf_cent_dist = #oidCentro#
    	   AND 	b.attr_enti = #nombreTablaCentroDistribucion#
   		   AND 	a.oid_conf_cent_dist = b.val_oid
    	   AND 	b.attr_num_atri = 1
    	   AND 	b.idio_oid_idio = 1
	</select>
	
	<select id="getDescripcionMapaCentroDistribucion" parameterClass="java.util.Map" resultClass="string">
    	SELECT 	b.val_i18n 
  		  FROM 	ape_mapa_centr_distr_cabec a,
       			gen_i18n_sicc_pais b
 	     WHERE 	a.oid_mapa_cent_dist_cabe = #oidMapaCentro#
           AND 	a.oid_mapa_cent_dist_cabe = b.val_oid
   		   AND 	b.attr_enti = #nombreTablaMapaCentroDistribucion#
   		   AND 	b.attr_num_atri = 1
   		   AND 	b.idio_oid_idio = 1
	</select>
	
	<select id="getDescripcionMapaZona" parameterClass="java.util.Map" resultClass="string">
    	SELECT 	b.val_i18n 
  		  FROM 	ape_mapa_zona_cabec a,
       			gen_i18n_sicc_pais b
 		 WHERE 	a.oid_mapa_zona_cabe = #oidMapaZona#
   		   AND 	a.oid_mapa_zona_cabe = b.val_oid
   		   AND 	b.attr_enti = #nombreTablaMapaZona#
   		   AND 	b.attr_num_atri = 1
   		   AND 	b.idio_oid_idio = 1
	</select>
	
	<select id="getDescripcionMapaAnaquelDefault" parameterClass="java.util.Map" resultClass="string">
    	SELECT 	b.val_i18n 
  		  FROM 	ape_orden_anaqu_cabec a,
       			gen_i18n_sicc_pais b
 		 WHERE 	a.mzca_oid_mapa_zona_cabe = #oidMapaZona#
 		   AND 	a.val_defe = 1
   		   AND 	a.oid_anaq_cabe = b.val_oid
   		   AND 	b.attr_enti = #nombreTablaOrdenAnaquel#
   		   AND 	b.attr_num_atri = 1
   		   AND 	b.idio_oid_idio = 1
	</select>
	
	<resultMap id="getOrdenAnaquelObjectResult"  class="ordenAnaquel"  >                                                                       
    	<result property="codigoCentroDistribucion"				column="COD_CENTRO"/>
    	<result property="codigoMapaCentroDistribucion"			column="COD_MAPA_CENTRO"/>
    	<result property="codigoMapaZona"						column="COD_MAPA_ZONA"/>
    	<result property="codigoOrdenAnaqueles" 				column="COD_ORDEN_ANAQUEL"/>
    	<result property="descripcionOrdenAnaqueles" 			column="DES_ORDEN_ANAQUEL"/>
    	<result property="indicadorDefecto" 					column="VAL_DEFAULT"/>
	</resultMap>
	<select id="getOrdenAnaquelObject" parameterClass="java.util.Map" resultMap="getOrdenAnaquelObjectResult">
		SELECT 	ccd.cod_cent_dist  				COD_CENTRO,
       			mcdc.num_codi_mapa 				COD_MAPA_CENTRO,
       			mzc.cod_mapa_zona  				COD_MAPA_ZONA,
       			oac.cod_mapa_orde  				COD_ORDEN_ANAQUEL,
       			i18.val_i18n       				DES_ORDEN_ANAQUEL,
       			oac.val_defe       				VAL_DEFAULT
  		  FROM 	app_confi_centr_distr ccd,
       			ape_mapa_centr_distr_cabec mcdc,
       			ape_mapa_zona_cabec mzc,
       			ape_orden_anaqu_cabec oac,
       			gen_i18n_sicc_pais i18
 	      WHERE ccd.oid_conf_cent_dist = mcdc.ccdi_oid_conf_cent_dist
   			AND mcdc.oid_mapa_cent_dist_cabe = mzc.mcdc_oid_mapa_cent_dist_cabe
   			AND mzc.oid_mapa_zona_cabe = oac.mzca_oid_mapa_zona_cabe
   			AND oac.oid_anaq_cabe = i18.val_oid
   			AND i18.attr_enti = #nombreTablaOrdenAnaquel#
   			AND i18.attr_num_atri = 1
   			AND i18.idio_oid_idio = 1
   			AND ccd.oid_conf_cent_dist = #oidCentro#
   			AND mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
   			AND mzc.oid_mapa_zona_cabe = #oidMapaZona#
   			AND oac.oid_anaq_cabe = #oidMapaOrden#
	</select>
	
	<resultMap id="subLineasModificarOrdenAnaquelResult"  class="java.util.HashMap" >                                                                       
    	<result property="oidMapaCentro"		column="OID_MAPA_CENTRO"/>
    	<result property="oidLinea"				column="OID_LINEA"/>
    	<result property="oidSubLinea"			column="OID_SUBLINEA"/>
    	<result property="desSubLinea"			column="DES_SUBLINEA"/>
    	<result property="numOrdenado"			column="NUM_ORDENADO"/>
	</resultMap>	
	<select id="getSubLineasModificarOrdenAnaquel" parameterClass="java.util.Map" resultMap="subLineasModificarOrdenAnaquelResult">
    	SELECT	#oidMapaCentro#			        	OID_MAPA_CENTRO,
    			lin.oid_line_arma     				OID_LINEA,
    			sublin.oid_subl_arma  				OID_SUBLINEA, 
       			i18n.val_i18n         				DES_SUBLINEA,
       			DECODE(
        			(SELECT COUNT(1) 
           			   FROM ape_mapa_centr_distr_detal mcdd,
                			ape_mapa_centr_distr_detal mcdd1,
                			ape_orden_anaqu_detal      oad,
                			ape_subli_armad            sublin2,
                			ape_orden_anaqu_cabec      oac
          			  WHERE mcdd.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
                        AND mcdd.sbar_oid_subl_arma = sublin2.oid_subl_arma
            			AND oac.oid_anaq_cabe = oad.oaca_oid_anaq_cabe
            			AND oac.oid_anaq_cabe = #oidMapaOrden#
            			AND oad.num_orde != 0
            			AND mcdd.mcdd_oid_mapa_cent_dist_deta = mcdd1.oid_mapa_cent_dist_deta(+)
            			AND oad.mcdd_oid_mapa_cent_dist_deta = mcdd.oid_mapa_cent_dist_deta
            			AND sublin.oid_subl_arma = mcdd.sbar_oid_subl_arma), 0, 'NO','SI'  	)NUM_ORDENADO
          FROM	ape_linea_armad lin,
          		ape_subli_armad sublin, 
       			gen_i18n_sicc_pais i18n 
         WHERE  lin.oid_line_arma = #oidLinea#
           AND 	lin.oid_line_arma = sublin.liar_oid_line_arma
   		   AND 	sublin.oid_subl_arma = i18n.val_oid 
   		   AND 	i18n.idio_oid_idio = 1 
   		   AND 	i18n.attr_num_atri = 1  
   		   AND 	i18n.attr_enti = #nombreTablaSubLineaArmado#
	  ORDER BY 	i18n.val_i18n 
    </select>
    
    <resultMap id="detalleOrdenAnaquelResult"  class="java.util.HashMap" >                                                                       
    	<result property="oidSubLinea"					column="OID_SUBLINEA"/>
    	<result property="oidMapaCentroDet"				column="OID_MAPA_CENTRO_DET"/>
    	<result property="numeroAnaquel"				column="NUM_ANAQUEL"/>
    	<result property="numeroOrden"					column="NUM_ORDEN"/>
    	<result property="indicadorExpandido"			column="IND_EXPANDIDO"/>
    	<result property="numeroAnquelDestino"			column="NUM_ANAQUEL_DES"/>
    	<result property="numeroOrdenLista"				column="NUM_ORDEN_LISTA"/>
	</resultMap>	
	<select id="getDetalleOrdenAnaquelList" parameterClass="java.util.Map" resultMap="detalleOrdenAnaquelResult">
    	SELECT	DISTINCT
    			sublin.oid_subl_arma                            OID_SUBLINEA,
        		mcdd.oid_mapa_cent_dist_deta                    OID_MAPA_CENTRO_DET,
        		mcdd.num_anaq                                   NUM_ANAQUEL,
        		decode(#opcionDetalle#,'N','',oad.num_orde)     NUM_ORDEN,
        		decode(nvl(mcdd.ind_expa, 0), 0,'NO','SI')      IND_EXPANDIDO,
        		NVL (mcdd1.num_anaq, '')                        NUM_ANAQUEL_DES,
        		num_orde_list_pica								NUM_ORDEN_LISTA
          FROM	ape_mapa_centr_distr_detal mcdd,
        		ape_mapa_centr_distr_detal mcdd1,
        		ape_orden_anaqu_detal oad,
        		ape_subli_armad sublin
         WHERE  mcdd.mcdc_oid_mapa_cent_dist_cabe =  #oidMapaCentro#
   		   AND  mcdd.sbar_oid_subl_arma =  #oidSubLinea#
   		   AND  mcdd.mcdd_oid_mapa_cent_dist_deta = mcdd1.oid_mapa_cent_dist_deta(+)
   		   AND  oad.mcdd_oid_mapa_cent_dist_deta(+) = mcdd.oid_mapa_cent_dist_deta
   		   AND  sublin.oid_subl_arma = mcdd.sbar_oid_subl_arma
	  ORDER BY	mcdd.num_anaq 	
    </select>
    
    <resultMap id="detalleOrdenAnaquelConsultaResult"  class="java.util.HashMap" >                                                                       
    	<result property="oidOrdenAnaquelCab"			column="OID_ORDEN_ANAQUEL_CAB"/>
    	<result property="oidSubLinea"					column="OID_SUBLINEA"/>
    	<result property="oidMapaCentroDet"				column="OID_MAPA_CENTRO_DET"/>
    	<result property="numeroAnaquel"				column="NUM_ANAQUEL"/>
    	<result property="numeroOrden"					column="NUM_ORDEN"/>
    	<result property="indicadorExpandido"			column="IND_EXPANDIDO"/>
    	<result property="numeroAnquelDestino"			column="NUM_ANAQUEL_DES"/>
    	<result property="numeroOrdenLista"				column="NUM_ORDEN_LISTA"/>
	</resultMap>	
	<select id="getDetalleOrdenAnaquelConsultaList" parameterClass="java.util.Map" resultMap="detalleOrdenAnaquelConsultaResult">
    	SELECT	oad.oaca_oid_anaq_cabe                          OID_ORDEN_ANAQUEL_CAB,
        		sublin.oid_subl_arma                            OID_SUBLINEA,
        		mcdd.oid_mapa_cent_dist_deta                    OID_MAPA_CENTRO_DET,
        		mcdd.num_anaq                                   NUM_ANAQUEL,
        		decode(#opcionDetalle#,'N','',oad.num_orde)     NUM_ORDEN,
        		decode(nvl(mcdd.ind_expa, 0), 0,'NO','SI')      IND_EXPANDIDO,
        		NVL (mcdd1.num_anaq, '')                        NUM_ANAQUEL_DES,
        		num_orde_list_pica								NUM_ORDEN_LISTA
          FROM	ape_mapa_centr_distr_detal mcdd,
        		ape_mapa_centr_distr_detal mcdd1,
        		ape_orden_anaqu_detal oad,
        		ape_subli_armad sublin,
        		ape_orden_anaqu_cabec oac
         WHERE  mcdd.mcdc_oid_mapa_cent_dist_cabe =  #oidMapaCentro#
   		   AND  mcdd.sbar_oid_subl_arma =  #oidSubLinea#
   		   AND 	oac.oid_anaq_cabe = oad.oaca_oid_anaq_cabe
   		   AND 	oac.oid_anaq_cabe = #oidMapaOrdenCab#
   		   AND  mcdd.mcdd_oid_mapa_cent_dist_deta = mcdd1.oid_mapa_cent_dist_deta(+)
   		   AND  oad.mcdd_oid_mapa_cent_dist_deta = mcdd.oid_mapa_cent_dist_deta
   		   AND  sublin.oid_subl_arma = mcdd.sbar_oid_subl_arma
	  ORDER BY	mcdd.num_anaq 	
    </select>
    
	<insert id="insertOrdenAnaquelCabecera" parameterClass="java.util.Map">	
		INSERT INTO ape_orden_anaqu_cabec (
			oid_anaq_cabe,
  			cod_mapa_orde,
  			mzca_oid_mapa_zona_cabe,
  			val_defe,
  			liar_oid_line_arma 	
		)
		VALUES(
			#oidMapaOrdenCab#,
			#codMapaOrdenCab#,
			#oidMapaZonaCab#,
			#valDefault#,
			#oidLinea#
		)
	</insert>
	    
	<insert id="insertOrdenAnaquelDetalle" parameterClass="java.util.Map">	
		INSERT INTO ape_orden_anaqu_detal (
			oid_orde_anaq_deta,
  			num_orde,
  			oaca_oid_anaq_cabe,
  			mcdd_oid_mapa_cent_dist_deta,
  			num_orde_list_pica
		)
		VALUES(
			APE_OACD_SEQ.NEXTVAL,
			#numOrden#,
			#oidMapaOrdenCab#,
			#oidMapaCentroDet#,
			#numOrdenLista#
		)
	</insert>
	
	<select id="getNextOidOrdenAnaquelCab" parameterClass="java.util.Map" resultClass="string">
		SELECT  APE_OACA_SEQ.NEXTVAL FROM  dual
	</select>
	
	<select id="getNextOidOrdenAnaquelDet" parameterClass="java.util.Map" resultClass="string">
		SELECT  APE_OACD_SEQ.NEXTVAL FROM  dual
	</select>
	
	<select id="getMaxCodOrdenAnaquel" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  NVL(MAX(oac.cod_mapa_orde),0)+1 
		  FROM  ape_orden_anaqu_cabec oac
		 WHERE 	oac.mzca_oid_mapa_zona_cabe = #oidMapaZonaCab#
	</select>
	
	<update id="updateOrdenAnaquelDetalle" parameterClass="java.util.Map">
		UPDATE ape_orden_anaqu_detal a
           SET a.num_orde = #numOrden#,
           	   a.num_orde_list_pica = #numOrdenLista#
         WHERE a.mcdd_oid_mapa_cent_dist_deta = #oidMapaCentroDet#
           AND a.oaca_oid_anaq_cabe = #oidMapaOrdenCab#
	</update>
	
	<delete id="deleteOrdenAnaquelDetalle" parameterClass="java.util.Map">
		DELETE FROM ape_orden_anaqu_detal 
         WHERE oaca_oid_anaq_cabe = #oidMapaOrden#
	</delete>
	
	<delete id="deleteOrdenAnaquelCabecera" parameterClass="java.util.Map">
		DELETE FROM ape_orden_anaqu_cabec 
         WHERE oid_anaq_cabe = #oidMapaOrden#
	</delete>
	
	<delete id="deleteIdiomaAnaquel" parameterClass="java.util.Map">
		DELETE FROM gen_i18n_sicc_pais
         WHERE attr_enti = #nombreTablaOrdenAnaquel#
           AND val_oid =  #oidMapaOrden#
	</delete>
	
	<select id="validaExisteAnaquelDetalle" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT  COUNT(1)
		  FROM  ape_orden_anaqu_cabec      oac,
       			ape_orden_anaqu_detal      oad,
       			ape_mapa_centr_distr_detal mcdd
		 WHERE 	mcdd.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
   		   AND 	mcdd.sbar_oid_subl_arma = #oidSubLinea#
   		   AND 	oac.oid_anaq_cabe = #oidMapaOrdenCab#
   		   AND 	oac.oid_anaq_cabe = oad.oaca_oid_anaq_cabe
   		   AND 	oad.mcdd_oid_mapa_cent_dist_deta = mcdd.oid_mapa_cent_dist_deta
	</select>
	
	<resultMap id="tipoCajaProdResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidTipoCajaProd"		column="OID_TIPO_CAJA_PROD"/>
    	<result property="codTipoCajaProd"		column="COD_TIPO_CAJA_PROD"/>
    	<result property="desTipoCajaProd" 		column="DES_TIPO_CAJA_PROD"/>
	</resultMap>
	
	<select id="getTipoCajaProdList" parameterClass="java.util.Map" resultMap="tipoCajaProdResult">
		SELECT	tcp.oid_tipo_caja_prod   OID_TIPO_CAJA_PROD,
       			tcp.cod_caja             COD_TIPO_CAJA_PROD,
       			i18.val_i18n             DES_TIPO_CAJA_PROD
  	      FROM  app_tipo_caja_produ tcp,
       			gen_i18n_sicc_pais i18  
 	     WHERE  tcp.pais_oid_pais = #oidPais#
   		   AND i18.attr_enti = #nombreTablaTipoCajaProducto#
   		   AND tcp.oid_tipo_caja_prod = i18.val_oid
   		   AND i18.attr_num_atri = 1
   		   AND i18.idio_oid_idio = 1
 	         
 	   	 <isNotEmpty property="codigoTipoCajaProducto">
		 	AND tcp.cod_caja = #codigoTipoCajaProducto#
		 </isNotEmpty>
 	         
 	   	 <isNotEmpty property="descripcionTipoCajaProducto">
			AND i18.val_i18n = #descripcionTipoCajaProducto#
		 </isNotEmpty>
		
		ORDER BY tcp.cod_caja
	</select>
	
	<resultMap id="getTipoCajaProductoObjectResult"  class="tipoCajaProducto"  >                                                                       
    	<result property="oidTipoCajaProducto"				column="OID_TIPO_CAJA_PROD"/>
    	<result property="codigoTipoCajaProducto"			column="COD_TIPO_CAJA_PROD"/>
    	<result property="descripcionTipoCajaProducto"		column="DES_TIPO_CAJA_PROD"/>
	</resultMap>
	<select id="getTipoCajaProductoObject" parameterClass="java.util.Map" resultMap="getTipoCajaProductoObjectResult">
		SELECT 	tcp.oid_tipo_caja_prod   OID_TIPO_CAJA_PROD,
       			tcp.cod_caja             COD_TIPO_CAJA_PROD,
       			i18.val_i18n             DES_TIPO_CAJA_PROD
          FROM  app_tipo_caja_produ tcp,
       			gen_i18n_sicc_pais i18
         WHERE  tcp.pais_oid_pais = #oidPais#
   		   AND 	i18.attr_enti = #nombreTablaTipoCajaProducto#
   		   AND 	tcp.oid_tipo_caja_prod = i18.val_oid
   		   AND 	i18.attr_num_atri = 1
   		   AND 	i18.idio_oid_idio = 1
   		   AND  tcp.oid_tipo_caja_prod = #oidTipoCajaProd#
   		   AND 	tcp.cod_caja = #codTipoCajaProd#
	</select>
	
	<insert id="insertTipoCajaProducto" parameterClass="java.util.Map">
		INSERT INTO app_tipo_caja_produ (  
			oid_tipo_caja_prod, 
  			cod_caja, 
  			pais_oid_pais 
		)
		VALUES (  
			#oidTipoCajaProductoNuevo#,
 			#codTipoCajaProducto#,
 			#oidPais#
		)
	</insert>
	
	<select id="getExisteCodTipoCajaProducto" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
		  FROM app_tipo_caja_produ a
		 WHERE a.cod_caja = #codTipoCajaProducto#
		   and pais_oid_pais = #oidPais#
	</select>
	
	<select id="getNextOidTipoCajaProducto" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT APP_TICP_SEQ.NEXTVAL FROM dual  
	</select>
	
	<delete id="deleteTipoCajaProducto" parameterClass="java.util.Map">
		DELETE FROM app_tipo_caja_produ a
         WHERE a.pais_oid_pais = #oidPais#
           AND a.oid_tipo_caja_prod =  #oidTipoCajaProd#
	</delete>
	
	<delete id="deleteIdiomaTipoCajaProducto" parameterClass="java.util.Map">
		DELETE FROM gen_i18n_sicc_pais
         WHERE attr_enti = #nombreTablaTipoCajaProducto#
           AND val_oid =  #oidTipoCajaProd#
	</delete>
	
	<parameterMap id="paramExecuteValidarRegistrosTipoCajaProducto" class="java.util.Map">
		<parameter property="oidPais"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidTipoCajaProd"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="valError"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>			
		<parameter property="nomTabla"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidarRegistrosTipoCajaProducto" parameterMap="paramExecuteValidarRegistrosTipoCajaProducto">
		{call APE_PKG_PROCE.APE_PR_VALID_REGIS_TIPO_CAJA(?,?,?,?) }
	</procedure>
	
	<update id="updateNumeroOrdenAnaquelDetalle" parameterClass="java.util.Map">
		UPDATE ape_orden_anaqu_detal oad
           SET num_orde = 0
         WHERE oad.oaca_oid_anaq_cabe = #oidMapaOrden#
           AND oad.mcdd_oid_mapa_cent_dist_deta IN (SELECT	mcdd.oid_mapa_cent_dist_deta
                                        			  FROM  ape_mapa_centr_distr_detal mcdd,
                                                      		ape_subli_armad sublin,
                                                    		ape_orden_anaqu_cabec      oac
                                                      WHERE mcdd.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
                                                	    AND mcdd.sbar_oid_subl_arma = #oidSubLinea#
                                                		AND oac.oid_anaq_cabe = oad.oaca_oid_anaq_cabe
                                                		AND oad.mcdd_oid_mapa_cent_dist_deta = mcdd.oid_mapa_cent_dist_deta
                                                		AND sublin.oid_subl_arma = mcdd.sbar_oid_subl_arma
                                        			  )
	</update>
	
	<select id="getObtenerNivelOlas" parameterClass="java.util.Map"  resultMap="baseResult">
		  SELECT 
		         CASE WHEN apcd.aafp_oid_aafp_olas IS NULL
		         THEN 2 ELSE apcd.aafp_oid_aafp_olas END as CODIGO,
		         CASE WHEN s.val_i18n IS NULL
		         THEN 'Regin' ELSE s.val_i18n END as DESCRIPCION
		  FROM   app_confi_centr_distr apcd,
		         ape_agrup_afp nvlolas,
		         gen_i18n_sicc_comun s
		  WHERE  apcd.aafp_oid_aafp_olas = nvlolas.oid_aafp(+)
		  AND    nvlolas.oid_aafp           = s.val_oid(+)
		  AND    s.attr_enti(+)             = 'APE_AGRUP_AFP'
		  AND    apcd.oid_conf_cent_dist    = #oidCentro#
		  AND    apcd.pais_oid_pais         = #oidPais#
	</select>

	<resultMap id="configuracionBalanceoResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidLineaArmado"			column="OIDLINEARMADO"/>
    	<result property="desCentroDistribucion"	column="DESC_CD"/>
    	<result property="desLineaArmado"	 		column="DESC_LINEA_ARMADO"/>
    	<result property="desPorcentaje"	 		column="PORCENTAJE"/>
    	<result property="numUnidad"		 		column="NUMUNIDAD"/>
    	<result property="desFuncDist"	 			column="DESC_FUNC_DIST"/>
	</resultMap>
		
	<select id="getConfiguracionBalanceoList" parameterClass="java.util.Map"  resultMap="configuracionBalanceoResult">
		SELECT linarmad.oid_line_arma as OIDLINEARMADO, 
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APP_CONFI_CENTR_DISTR',linarmad.ccdi_oid_conf_cent_dist,'P') as DESC_CD,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_LINEA_ARMAD',linarmad.oid_line_arma,'P') as DESC_LINEA_ARMADO,
		       linarmad.num_porc_vari_esti as PORCENTAJE,
		       linarmad.NUM_UNID_PREA as NUMUNIDAD,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_FUNCI_DISTR',linarmad.fndi_oid_func_dist,'C') as DESC_FUNC_DIST
		FROM   APE_LINEA_ARMAD linarmad,
		       APP_CONFI_CENTR_DISTR centdist,
		       APE_FUNCI_DISTR fundist
		WHERE  linarmad.ccdi_oid_conf_cent_dist = centdist.oid_conf_cent_dist
		AND    linarmad.fndi_oid_func_dist      = fundist.oid_func_dist(+) 
		AND    centdist.pais_oid_pais           = #oidPais#
		
		<isNotEmpty property="oidCentro">
			AND    centdist.oid_conf_cent_dist  = #oidCentro#
		</isNotEmpty> 

		<isNotEmpty property="oidLinArmado">
			AND    linarmad.oid_line_arma       = #oidLinArmado#
		</isNotEmpty> 

	</select>

	<select id="getFuncionDistribucionList" parameterClass="java.util.Map"  resultMap="baseResult">
		  SELECT c.cod_func_dist as CODIGO,
			     s.val_i18n as DESCRIPCION
		  FROM   APE_FUNCI_DISTR c,
	    	   	 gen_i18n_sicc_comun s
		  WHERE  c.oid_func_dist = s.val_oid
		  AND    s.attr_enti = 'APE_FUNCI_DISTR'

		<isNotEmpty property="codFuncDist">
	      AND    c.cod_func_dist = #codFuncDist#
		</isNotEmpty> 
	</select>	

	<select id="getOidFuncionDist" parameterClass="java.util.Map"  resultClass="string">
		SELECT oid_func_dist 
		FROM   APE_FUNCI_DISTR
		WHERE  cod_func_dist = #codFuncDist#
	</select>	

	<update id="insertarConfiguracionBalanceo" parameterClass="java.util.Map">
		UPDATE APE_LINEA_ARMAD
		SET    num_porc_vari_esti = TO_NUMBER(#porcVariaEstimado#,'99.99'),
		       fndi_oid_func_dist = #oidFuncDist#,
		       num_unid_prea = #numUnidad#
		WHERE  oid_line_arma = #oidLineaArmado#
	</update>
	
	<select id="getValidaExisteConfiguracionBalanceo" parameterClass="java.util.Map"  resultClass="string">
		SELECT COUNT(1)
		FROM  APE_LINEA_ARMAD
		WHERE oid_line_arma = #oidLineaArmado#
		AND   num_porc_vari_esti IS NOT NULL
		AND   fndi_oid_func_dist IS NOT NULL
	</select>
	
	<select id="getNumeroAnaquel" parameterClass="java.util.Map" resultClass="string">
		SELECT NUM_ANAQ
		FROM   APE_MAPA_CENTR_DISTR_DETAL
		WHERE  oid_mapa_cent_dist_deta = #oidMapaCDDet#
	</select>

	<resultMap id="codigoAnaquelDividirResult" class="java.util.HashMap">                                                                       
    	<result property="oidMapaCDDet"			column="CODIGO"/>
    	<result property="descripcionAnaquel"	column="DESCRIPCION"/>
    	<result property="capacidad"	 		column="CAPACIDAD"/>
	</resultMap>
		
	<select id="getCodigoAnaquelDividirList" parameterClass="java.util.Map" resultMap="codigoAnaquelDividirResult" >
	    SELECT oid_mapa_cent_dist_deta as CODIGO,
           num_anaq as DESCRIPCION,
           '1' as CAPACIDAD
	    FROM   APE_MAPA_CENTR_DISTR_DETAL
	    WHERE  mcdd_oid_mapa_cent_dist_deta = #oidMapaCDDet#
	    AND    mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
	</select>
		
	<select id="getTipoDispensacionList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT td.cod_tipo_disp as CODIGO,
		       i18.val_i18n as DESCRIPCION
 		FROM   ape_tipo_dispe td,
       		   gen_i18n_sicc_comun i18
 		WHERE  td.oid_tipo_disp = i18.val_oid
          AND  i18.attr_enti = #nombreTablaTipoDispensacion#
          AND  i18.attr_num_atri = 1
          AND  i18.idio_oid_idio = 1
   		ORDER BY 1
   	</select>
   	
   	<resultMap id="materialesVistaResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidSAP"					column="OID_PRODUCTO"/>
    	<result property="codSAP"					column="COD_SAP"/>
    	<result property="desSAP" 					column="DES_SAP"/>
    	<result property="dispensacion"				column="TIPO_DISPENSACION"/>
    	<result property="tipoAnaquel"				column="TIPO_ANAQUEL"/>
    	<result property="NumHoraInventario" 		column="NUM_HORA_INVENTARIO"/>
    	<result property="cajaMaestra" 				column="CAJA_MAESTRA"/>
    	<result property="uniCajaMaestra" 			column="UNI_CAJA_MAESTRA"/>
    	<result property="porAdicionalHolgura" 		column="POR_HOLGURA"/>
	</resultMap>
	<select id="getMaterialesVistaList" parameterClass="java.util.Map" resultMap="materialesVistaResult">
		SELECT	mp.oid_prod   									OID_PRODUCTO,
       			mp.cod_sap    									COD_SAP,
       			i18.val_i18n  									DES_SAP,
       			(SELECT i18c.val_i18n
          		   FROM gen_i18n_sicc_comun i18c
                  WHERE atd.oid_tipo_disp = i18c.val_oid
                    AND i18c.attr_enti = #nombreTablaTipoDispensacion#
                    AND i18c.attr_num_atri = 1
                    AND i18c.idio_oid_idio = 1) 				TIPO_DISPENSACION,
               	(SELECT i18c.val_i18n
                   FROM gen_i18n_sicc_comun i18c
                  WHERE ta.oid_tipo_anaq = i18c.val_oid
                    AND i18c.attr_enti = #nombreTablaTipoAnaquel#
                    AND i18c.attr_num_atri = 1
                    AND i18c.idio_oid_idio = 1)                 TIPO_ANAQUEL,
       		   	ap.num_hora_inve                				NUM_HORA_INVENTARIO,
       		   (SELECT i18p.val_i18n
          		  FROM gen_i18n_sicc_pais i18p
                 WHERE tcp.oid_tipo_caja_prod = i18p.val_oid
                   AND i18p.attr_enti = #nombreTablaTipoCajaProducto#
                   AND i18p.attr_num_atri = 1
                   AND i18p.idio_oid_idio = 1) 					CAJA_MAESTRA,
       		   	ap.num_unid_caja_maes           				UNI_CAJA_MAESTRA,
       		   	ap.num_holg_adic_cubi           				POR_HOLGURA
  	      FROM 	mae_produ mp,
       		    gen_i18n_sicc_pais i18,
       			ape_produ ap,
       			ape_tipo_dispe atd,
       			app_tipo_caja_produ tcp,
       			ape_tipo_anaqu ta
 	     WHERE  mp.pais_oid_pais = #oidPais#
   		   AND 	i18.attr_enti = #nombreTablaMaestroProducto#
   		   AND 	i18.attr_num_atri = 1
   		   AND 	i18.idio_oid_idio = 1
   		   AND 	mp.oid_prod = i18.val_oid
   		   AND 	mp.oid_prod = ap.prod_oid_prod(+)
   		   AND 	ap.tidi_oid_tipo_dispe = atd.oid_tipo_disp(+)
   		   AND 	ap.ticp_oid_tipo_caja_prod = tcp.oid_tipo_caja_prod (+)
 	       AND  ap.tian_oid_tipo_anaq = ta.oid_tipo_anaq(+)  
 	   	 <isNotEmpty property="codigoSAP">
		 	AND mp.cod_sap = #codigoSAP#
		 </isNotEmpty>
 	         
 	   	 <isNotEmpty property="descripcionSAP">
			AND UPPER(i18.val_i18n) LIKE UPPER(#descripcionSAP#)||'%'
		 </isNotEmpty>
		
		 <isNotEmpty property="descripcionCortaSAP">
			AND UPPER(mp.des_cort) LIKE UPPER(#descripcionCortaSAP#)||'%'
		 </isNotEmpty>
		 
		 <isNotEmpty property="codigoTipoDispensacion">
		 	AND atd.cod_tipo_disp = #codigoTipoDispensacion#
		 </isNotEmpty>
		ORDER BY mp.oid_prod
	</select>
	
	<resultMap id="getMaterialesVistaObjectResult"  class="materialesVista"  >                                                                       
    	<result property="oidSAP"							column="OID_PRODUCTO"/>
    	<result property="codigoSAP"						column="COD_SAP"/>
    	<result property="descripcionSAP"					column="DES_SAP"/>
    	<result property="descripcionCortaSAP"				column="DES_CORTA_SAP"/>
    	<result property="codigoTipoDispensacion"			column="COD_TIPO_DISPENSACION"/>
    	<result property="unidadesEmpaque"					column="UNI_EMPAQUE"/>
    	<result property="codigoTipoAnaquel"				column="COD_TIPO_ANAQUEL"/>
    	<result property="pickSpeed"						column="PIC_SPEED"/>
    	<result property="largo"							column="LARGO"/>
    	<result property="alto"								column="ALTO"/>
    	<result property="ancho"							column="ANCHO"/>
    	<result property="codigoUMDimension"				column="UM_DIMENSIONES"/>
    	<result property="numHoraInventario"				column="NUM_HORA_INVENTARIO"/>
    	<result property="codigoCajaMaestra"				column="COD_CAJA_MAESTRA"/>
    	<result property="unidadCajaMaestra"				column="NUM_CAJA_MAESTRA"/>
    	<result property="porcentajeAdicionalHolgura"		column="POR_HOLGURA_CUBICAJE"/>
    	<result property="packSize"							column="PAC_SIZE"/>
    	<result property="screenQTY"						column="SCR_QTY"/>
    	<result property="lane60"							column="NUM_LANE60"/>
    	<result property="lane95"							column="NUM_LANE95"/>
    	<result property="numAsignacionMaximaChanel"		column="ASIG_MAXIMA_CHANEL"/>
    	<result property="unidadCajaGrande"					column="NUM_CAJA_GRANDE"/>
    	<result property="unidadCajaPequena"				column="NUM_CAJA_PEQUENA"/>
	</resultMap>
	<select id="getMaterialesVistaObject" parameterClass="java.util.Map" resultMap="getMaterialesVistaObjectResult">
		SELECT 	mp.oid_prod   			OID_PRODUCTO,
        		mp.cod_sap    			COD_SAP,
        		i18.val_i18n  			DES_SAP,
        		mp.des_cort   			DES_CORTA_SAP,
        		td.cod_tipo_disp        COD_TIPO_DISPENSACION,
        		ap.num_unid_caja_maes   UNI_EMPAQUE,
        		ta.cod_tipo_anaq        COD_TIPO_ANAQUEL,
        		ap.num_afra_pick_sped   PIC_SPEED,
        		ap.num_afra_larg        LARGO,
        		ap.num_afra_alto        ALTO,
        		ap.num_afra_anch        ANCHO,
        		um2.cod_unid_medi       UM_DIMENSIONES,
        		ap.num_hora_inve        NUM_HORA_INVENTARIO,
        		tcp.cod_caja            COD_CAJA_MAESTRA,
        		ap.num_unid_caja_maes   NUM_CAJA_MAESTRA,
        		ap.num_holg_adic_cubi   POR_HOLGURA_CUBICAJE,
        		ap.num_afra_pack_size   PAC_SIZE,
        		ap.num_afra_scre_quty   SCR_QTY,
        		ap.num_lane_capa_60     NUM_LANE60,
        		ap.num_lane_capa_95     NUM_LANE95,
        		ap.num_asig_maxi_chan	ASIG_MAXIMA_CHANEL,
        		num_unid_caja_gran		NUM_CAJA_GRANDE,
        		num_unid_caja_pequ		NUM_CAJA_PEQUENA
          FROM  mae_produ mp,
        		gen_i18n_sicc_pais i18,
        		ape_produ ap,
        		ape_tipo_dispe td,
        		mae_unida_medid um2,
        		app_tipo_caja_produ tcp,
        		ape_tipo_anaqu ta
         WHERE  mp.pais_oid_pais =  #oidPais#
   		   AND  i18.attr_enti = #nombreTablaMaestroProducto#
           AND  i18.attr_num_atri = 1
           AND  i18.idio_oid_idio = 1
   		   AND  mp.oid_prod = i18.val_oid
   		   AND  mp.oid_prod = #oidSAP#
   		   AND  mp.oid_prod = ap.prod_oid_prod (+)
   		   AND  ap.tidi_oid_tipo_dispe = td.oid_tipo_disp(+)
           AND  mp.unmd_oid_unid_medi = um2.oid_unid_medi(+)
           AND  ap.ticp_oid_tipo_caja_prod = tcp.oid_tipo_caja_prod(+)
           AND  ap.tian_oid_tipo_anaq = ta.oid_tipo_anaq(+)
	</select>
	
	<select id="getCodTipoCajaProductoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	tcp.cod_caja 	as CODIGO,
       			i18p.val_i18n 	as DESCRIPCION
          FROM 	app_tipo_caja_produ tcp,
       			gen_i18n_sicc_pais i18p,
        		ape_tipo_caja_embal tce
         WHERE 	tcp.pais_oid_pais = to_number(#oidPais#)
           AND 	i18p.attr_enti = #nombreTablaTipoCajaProducto#
   		   AND 	i18p.attr_num_atri = 1
   		   AND 	i18p.idio_oid_idio = 1
   		   AND 	tcp.oid_tipo_caja_prod = i18p.val_oid
   		   AND  tce.ticp_oid_tipo_caja_prod = tcp.oid_tipo_caja_prod
   		   AND  tce.pais_oid_pais = tcp.pais_oid_pais
   	  ORDER BY tcp.cod_caja
	</select>
	
	<update id="updateMaterialesVista" parameterClass="java.util.Map">
		UPDATE 	ape_produ
           SET 	tidi_oid_tipo_dispe = #oidTipoDispensacion#,
           		num_afra_pick_sped = #pickSpeed#,
           		num_afra_larg = #largo#,
           		num_afra_alto = #alto#,
           		num_afra_anch = #ancho#,
           		tian_oid_tipo_anaq = #oidTipoAnaquel#,
           		num_hora_inve = #numHoraInventario#,
           		ticp_oid_tipo_caja_prod = #oidCajaMaestra#,
           		num_unid_caja_maes = #uniCajaMaestra#,
           		num_holg_adic_cubi = #holguraCubicaje#,
           		num_afra_pack_size = #packSize#,
           		num_afra_scre_quty = #screenQTY#,
           		num_lane_capa_60 = #lane60#,
           		num_lane_capa_95 = #lane95#,
           		num_asig_maxi_chan = #numAsigMaxChanel#,
           		num_unid_caja_gran = #uniCajaGrande#,
				num_unid_caja_pequ = #uniCajaPequena#
         WHERE 	prod_oid_prod = #oidSAP#
	</update>

	<resultMap id="configuraBalanceoObjectResult"  class="configuracionBalanceo">                                                                       
    	<result property="oidCentro"						column="OID_CENTRO"/>
    	<result property="codCentro"						column="COD_CENTRO"/>
    	<result property="oidLineaArmado"					column="OID_LINEA"/>
    	<result property="codigoLineaArmado"				column="COD_LINEA"/>
    	<result property="numPorcentaje"					column="NUMPORCENTAJE"/>
    	<result property="numUnidad"						column="NUMUNIDAD"/>
    	<result property="oidFuncDist"						column="OIDFUNCDIST"/>
    	<result property="codigoFuncDist"					column="CODFUNCDIST"/>
	</resultMap>
	
	<select id="getConfiguracionBalanceoObject" parameterClass="java.util.Map" resultMap="configuraBalanceoObjectResult">
			SELECT liar.ccdi_oid_conf_cent_dist         OID_CENTRO,
             	   app.cod_cent_dist                    COD_CENTRO,
			       liar.oid_line_arma                   OID_LINEA, 
                   liar.num_codi_line                   COD_LINEA,
			       liar.num_porc_vari_esti              NUMPORCENTAJE,
			       liar.num_unid_prea                   NUMUNIDAD,
			       liar.fndi_oid_func_dist              OIDFUNCDIST,
         	       fun.cod_func_dist                    CODFUNCDIST
			FROM   APE_LINEA_ARMAD       liar,
	               APP_CONFI_CENTR_DISTR app,
	               APE_FUNCI_DISTR       fun
			WHERE  liar.ccdi_oid_conf_cent_dist = app.oid_conf_cent_dist
	        AND    liar.fndi_oid_func_dist      = fun.oid_func_dist(+)
			AND    oid_line_arma = #oidLinArmado#
	</select>

	<select id="getNumeroAnaquelxSubLineaList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT oid_mapa_cent_dist_deta as CODIGO, 
		       num_anaq                as DESCRIPCION
		FROM   ape_mapa_centr_distr_detal
		WHERE  sbar_oid_subl_arma = #oidSubLinArmado#
		AND    mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
	</select>
	
	<select id="getTipoAnaquelList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT   anq.oid_tipo_anaq as CODIGO,
  			     s.val_i18n as DESCRIPCION
		FROM     ape_tipo_anaqu anq,
	    	   	 gen_i18n_sicc_comun s
	 	WHERE    anq.oid_tipo_anaq = s.val_oid 
	    AND      s.attr_enti = 'APE_TIPO_ANAQU' 
	</select>	
	
	<select id="getOidTipoDispensacionByCodigo" parameterClass="java.util.Map" resultClass="string">
    	SELECT	td.oid_tipo_disp
	      FROM	ape_tipo_dispe td
	     WHERE	td.cod_tipo_disp = #codigoTipoDispensacion#
	</select>
	
	<select id="getVersionesList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	apa.val_vers as CODIGO,
       			apa.val_vers as DESCRIPCION
           FROM ape_asign_produ_anaqu_cabec apa
	</select>
	
	<select id="getVersionesbyPeriodoList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	DISTINCT
				apa.val_vers as CODIGO,
       			apa.val_vers as DESCRIPCION
           FROM ape_asign_produ_anaqu_cabec apa,
       			ape_mapa_centr_distr_cabec mcdc,
       			ape_mapa_zona_cabec mzc,
       			ape_mapa_zona_detal mzd
       	  WHERE apa.mcdc_oid_mapa_cent_dist_cabe = mcdc.oid_mapa_cent_dist_cabe
   			AND mzc.oid_mapa_zona_cabe = apa.mzca_oid_mapa_zona_cabe
   			AND mzc.oid_mapa_zona_cabe = mzd.mzca_oid_mapa_zona_cabe
   			AND mcdc.ccdi_oid_conf_cent_dist = #oidCentro#
   			AND apa.perd_oid_peri = #oidPeriodo#
	   ORDER BY apa.val_vers
	</select>
	
   	<resultMap id="versionesAsignadosListResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidAsigProd"					column="OID_ASIG_PROD"/>
    	<result property="oidMapaCD"					column="OID_MAPA_CD"/>
    	<result property="desMapaCD" 					column="DES_MAPA_CD"/>
    	<result property="codVersion"					column="COD_VERSION"/>
    	<result property="oidMapaZona"					column="OID_MAPA_ZONA"/>
    	<result property="desMapaZona" 					column="DES_MAPA_ZONA"/>
    	<result property="indActivoFact" 				column="IND_ACTIVO_FACT"/>
    	<result property="oidLinea" 					column="OID_LINEA"/>
    	<result property="oidPeriodo" 					column="OID_PERIODO"/>
	</resultMap>
	<select id="getVersionesAsignadosList" parameterClass="java.util.Map" resultMap="versionesAsignadosListResult">
		SELECT	pac.oid_asig_prod_anaq_cabe                  OID_ASIG_PROD,
       			mcdc.oid_mapa_cent_dist_cabe                 OID_MAPA_CD,
       			i1.val_i18n                                  DES_MAPA_CD,
       			pac.val_vers                                 COD_VERSION, 
       			pac.mzca_oid_mapa_zona_cabe                  OID_MAPA_ZONA,
       			i2.val_i18n||' - '||i3.val_i18n              DES_MAPA_ZONA,
       			DECODE (pac.ind_acti_fact, 'S', 'SI', 'NO')  IND_ACTIVO_FACT,
       			mapLin.liar_oid_line_arma                    OID_LINEA,
       			pac.perd_oid_peri                            OID_PERIODO
  	      FROM 	ape_asign_produ_anaqu_cabec pac,
       			app_confi_centr_distr ccd,
       			ape_mapa_centr_distr_cabec mcdc,
       			(SELECT DISTINCT
               			mapdet.mzca_oid_mapa_zona_cabe,
               			sublin.liar_oid_line_arma
          		   FROM ape_mapa_zona_detal mapDet,
               			ape_subli_armad sublin
         		  WHERE sublin.oid_subl_arma = mapdet.sbar_oid_subl_arma ) mapLin,
         		v_gen_i18n_sicc i1,
         		v_gen_i18n_sicc i2,
         		v_gen_i18n_sicc i3
 	     WHERE  ccd.oid_conf_cent_dist = mcdc.ccdi_oid_conf_cent_dist
   		   AND 	mcdc.oid_mapa_cent_dist_cabe = pac.mcdc_oid_mapa_cent_dist_cabe
   		   AND 	maplin.mzca_oid_mapa_zona_cabe = pac.mzca_oid_mapa_zona_cabe
   		   AND 	i1.attr_enti = #nombreTablaMapaCentroDistribucionCabec#
   		   AND 	i1.attr_num_atri = 1 
   		   AND  i1.val_oid = mcdc.oid_mapa_cent_dist_cabe
   		   AND  i1.idio_oid_idio = #oidIdiomaISO#
   		   AND  i2.attr_enti = #nombreTablaMapaZonaCabec#
   		   AND  i2.attr_num_atri = 1
   		   AND  i2.val_oid = pac.mzca_oid_mapa_zona_cabe
   		   AND  i2.idio_oid_idio = #oidIdiomaISO#
   		   AND  i3.attr_enti = #nombreTablaLinea#
           AND  i3.attr_num_atri = 1
   		   AND  i3.val_oid = mapLin.liar_oid_line_arma 
   		   AND  i3.idio_oid_idio = #oidIdiomaISO#
   		   AND  ccd.oid_conf_cent_dist = #oidCentro#
   		   AND	mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
   		   AND  pac.perd_oid_peri = #oidPeriodo#
 	         
 	   	 <isNotEmpty property="codigoVersion">
		 	AND pac.val_vers = #codigoVersion#
		 </isNotEmpty>
 	     
	</select>
	
	<select id="getOidPeriodobyMarcaCanal" parameterClass="java.util.Map"  resultClass="string">
		SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codPeriodo#,
														  gen_pkg_gener.gen_fn_devuelve_id_marca(#codigoMarca#),
		     											  gen_pkg_gener.gen_fn_devuelve_id_canal(#codigoCanal#)	) 
		  FROM DUAL
	</select>

	<select id="getMapaZonaVersionList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	DISTINCT
				pac.mzca_oid_mapa_zona_cabe	as CODIGO,
       			i2.val_i18n 				as DESCRIPCION
          FROM 	ape_asign_produ_anaqu_cabec pac,
          		v_gen_i18n_sicc i2
       	 WHERE 	pac.ind_acti_fact = 'S'
       	   AND  i2.attr_enti = #nombreTablaMapaZonaCabec#
       	   AND  i2.idio_oid_idio = #oidIdiomaISO#
   		   AND  i2.attr_num_atri = 1
   		   AND  i2.val_oid = pac.mzca_oid_mapa_zona_cabe
   	  ORDER BY 	pac.mzca_oid_mapa_zona_cabe
	</select>
	
	<resultMap id="versionProductoObjectResult" class="versionProducto">
  		<result property="codigoMapaZona"  		column="COD_MAPA_ZONA"/>
  		<result property="codigoVersion"  		column="COD_VERSION"/>
    </resultMap>
  
	<select id="getVersionProductoObject" parameterClass="java.util.Map" resultMap="versionProductoObjectResult">
		SELECT 	pac.mzca_oid_mapa_zona_cabe	COD_MAPA_ZONA,
				pac.val_vers				COD_VERSION
		  FROM 	ape_asign_produ_anaqu_cabec pac
		 WHERE 	pac.oid_asig_prod_anaq_cabe = #oidAsigProd#
	</select>
	
	<select id="getCodigoMapaZona" parameterClass="java.util.Map" resultClass="string">
	    SELECT 	cod_mapa_zona
	      FROM 	ape_mapa_zona_cabec
	     WHERE 	oid_mapa_zona_cabe = #oidMapaZona#
	</select>
	
	<select id="getExisteVersionPeriodoMapaCD" parameterClass="java.util.Map" resultClass="string">
		SELECT 	COUNT(1)
          FROM 	ape_asign_produ_anaqu_cabec a
         WHERE 	a.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
           AND 	a.val_vers = #codigoVersion#
   		   AND 	a.perd_oid_peri = #oidPeriodo#
	</select>
	
	<select id="getVerificaVersionActiva" parameterClass="java.util.Map" resultClass="string">
		SELECT 	COUNT(1)
          FROM	ape_asign_produ_anaqu_cabec pac,
        		ape_mapa_centr_distr_cabec mcdc,
       			(SELECT DISTINCT
               			mapdet.mzca_oid_mapa_zona_cabe,
               			sublin.liar_oid_line_arma
          		   FROM ape_mapa_zona_detal mapDet,
               			ape_subli_armad sublin
                  WHERE sublin.oid_subl_arma = mapdet.sbar_oid_subl_arma ) mapLin
         WHERE 	pac.ind_acti_fact = 'S'
           AND	mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
           AND  pac.perd_oid_peri = #oidPeriodo#
           AND 	mcdc.oid_mapa_cent_dist_cabe = pac.mcdc_oid_mapa_cent_dist_cabe
   		   AND 	maplin.mzca_oid_mapa_zona_cabe = pac.mzca_oid_mapa_zona_cabe
	</select>
	
	<select id="getNextOidAsignacionProductoCab" parameterClass="java.util.Map" resultClass="string">
		SELECT  APE_APAC_SEQ.NEXTVAL FROM  dual
	</select>
	
	<select id="getOidProcesoAPEEstimado" parameterClass="java.util.Map" resultClass="string">
		SELECT 	oid_proc
          FROM	ape_proce
         WHERE 	cod_proc = #codProceEstimado#
	</select>
	
	<insert id="insertVersionesCab" parameterClass="java.util.Map">
		INSERT INTO ape_asign_produ_anaqu_cabec (
   			oid_asig_prod_anaq_cabe, 
      		val_vers, 
      		ind_acti_fact, 
      		perd_oid_peri, 
      		mcdc_oid_mapa_cent_dist_cabe, 
      		mzca_oid_mapa_zona_cabe 
		)
		VALUES(
   			#oidAsignacionProductoCab#,
   			#codigoVersion#,
   			#indActivaFact#,
   			#oidPeriodo#,
   			#oidMapaCentro#,
   			#oidMapaZona#
		)
	</insert>
	
	<parameterMap id="paramExecuteInsertVersionesDetalle" class="java.util.Map">
		<parameter property="oidMapaCentro"               	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidMapaZona"       			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="oidLinea"     		    		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="oidAsignacionProductoCab"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="oidProcesoApeEstimado"      	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	</parameterMap>
	
	<procedure id="executeInsertVersionesDetalle" parameterMap="paramExecuteInsertVersionesDetalle">
		{call APE_PKG_PROCE.APE_PR_INSER_ASIGN_DETAL(?, ?, ?, ?, ?) }
	</procedure>
	
	<update id="desactivarVersionesActuales" parameterClass="java.util.Map">
		UPDATE 	ape_asign_produ_anaqu_cabec
           SET 	ind_acti_fact = 'N'
         WHERE 	oid_asig_prod_anaq_cabe IN ( SELECT asigprodancabe.oid_asig_prod_anaq_cabe
                                               FROM ape_asign_produ_anaqu_cabec asigprodancabe,
                                           			ape_mapa_centr_distr_cabec mapcdcabe,
                                           		    (SELECT distinct mapdet.mzca_oid_mapa_zona_cabe
                                                       FROM ape_mapa_zona_detal mapdet, 
                                                   			ape_subli_armad sublin
                                                      WHERE sublin.oid_subl_arma = mapdet.sbar_oid_subl_arma
                                                        AND sublin.liar_oid_line_arma = #oidLinea# ) mapLin
                                              WHERE mapcdcabe.oid_mapa_cent_dist_cabe = #oidMapaCentro#
                                       		    AND asigprodancabe.mcdc_oid_mapa_cent_dist_cabe = mapcdcabe.oid_mapa_cent_dist_cabe
                                       		    AND asigprodancabe.mzca_oid_mapa_zona_cabe = mapLin.mzca_oid_mapa_zona_cabe
                                       		    AND asigprodancabe.perd_oid_peri = #oidPeriodo# )
	</update>
	
	<update id="updateVersiones" parameterClass="java.util.Map">
		UPDATE	ape_asign_produ_anaqu_cabec
           SET 	ind_acti_fact = #indActivaFact#
         WHERE 	oid_asig_prod_anaq_cabe = #oidAsignacion#
	</update>
	
	<delete id="deleteVersionesCab" parameterClass="java.util.Map">
		DELETE FROM ape_asign_produ_anaqu_cabec
         WHERE oid_asig_prod_anaq_cabe = #oidAsignacion#
	</delete>
	
	<delete id="deleteVersionesDet" parameterClass="java.util.Map">
		DELETE FROM ape_asign_produ_anaqu_detal
         WHERE apac_oid_asig_prod_anaq_cabe = #oidAsignacion#
	</delete>
	
	<select id="validaVersionAnaquelListaPicado" parameterClass="java.util.Map" resultClass="string">
		SELECT 	COUNT(mcdd.num_anaq)
          FROM 	ape_asign_produ_anaqu_cabec apac,
       			ape_lista_picad_detal lpd,
       			ape_lista_picad_cabec lpc,
       			ape_mapa_centr_distr_detal mcdd,
       			ape_mapa_centr_distr_cabec mcdc
         WHERE 	mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
   		   AND 	lpc.perd_oid_peri = #oidPeriodo#
   		   AND 	apac.oid_asig_prod_anaq_cabe = #oidAsignacion# 
   		   AND 	mcdc.oid_mapa_cent_dist_cabe = mcdd.mcdc_oid_mapa_cent_dist_cabe
   		   AND 	lpd.mcdd_oid_mapa_cent_dist_deta = mcdd.oid_mapa_cent_dist_deta
   		   AND 	lpc.oid_list_pica_cabe = lpd.lpca_oid_list_pica_cabe
   		   AND 	apac.mcdc_oid_mapa_cent_dist_cabe = mcdc.oid_mapa_cent_dist_cabe
   		   AND 	apac.perd_oid_peri = lpc.perd_oid_peri
	</select>
	
	<select id="getOidMapaCDbyCod" parameterClass="java.util.Map" resultClass="string">
	    SELECT c.oid_mapa_cent_dist_cabe as CODIGO
	      FROM ape_mapa_centr_distr_cabec c
	     WHERE c.num_codi_mapa = #codMapCentrDist#
	       AND c.ccdi_oid_conf_cent_dist = #oidCentro#
	</select>
	
	<select id="getOidLineaVersion" parameterClass="java.util.Map" resultClass="string">
	    SELECT DISTINCT
       		   sublin.liar_oid_line_arma
	      FROM ape_mapa_zona_cabec mapcab,
       		   ape_mapa_zona_detal mapdet,
               ape_subli_armad sublin
	     WHERE mapcab.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
           AND mapcab.oid_mapa_zona_cabe = #oidMapaZona#
   		   AND mapcab.oid_mapa_zona_cabe = mapdet.mzca_oid_mapa_zona_cabe
           AND mapdet.sbar_oid_subl_arma = sublin.oid_subl_arma
	</select>
	
	<select id="getTipoChanelComboList" parameterClass="java.util.Map"  resultMap="baseResult">
	    SELECT  tc.oid_tipo_chan as CODIGO,
        	    s.val_i18n       as DESCRIPCION
    	FROM    APE_TIPO_CHANE tc,
            	gen_i18n_sicc_comun s
    	WHERE   tc.oid_tipo_chan = s.val_oid
    	AND     s.attr_enti = 'APE_TIPO_CHANE'
	</select>
	
	<parameterMap id="paramExecuteActualizarTiposAnaquelesMapaCD" class="java.util.Map">		
		<parameter property="oidSistPicado"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="numAnaquel"     		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codTipoAnaquel"       	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="valSide"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="nroAframe"       		jdbcType="NUMBER" javaType="java.math.BigDecimal"  mode="IN"/>	
		<parameter property="addressAframe"       	jdbcType="NUMBER" javaType="java.math.BigDecimal"  mode="IN"/>	
		<parameter property="heightAframe"       	jdbcType="NUMBER" javaType="java.math.BigDecimal"  mode="IN"/>	
		<parameter property="widthAframe"       	jdbcType="NUMBER" javaType="java.math.BigDecimal"  mode="IN"/>	
		<parameter property="machAddressAframe"     jdbcType="NUMBER" javaType="java.math.BigDecimal"  mode="IN"/>	
		<parameter property="levelAframe"       	jdbcType="NUMBER" javaType="java.math.BigDecimal"  mode="IN"/>	
		<parameter property="oidSublinea"       	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="oidMapaCD"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="valError"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>		

	</parameterMap>
	
	<procedure id="executeActualizarTiposAnaquelesMapaCD" parameterMap="paramExecuteActualizarTiposAnaquelesMapaCD">
		{call APE_PKG_PROCE.APE_PR_ACTUA_TIPOS_ANAQU_MAPCD(?,?,?,?,?,?,?,?,?,?,?,?,?) }
	</procedure>

	<resultMap id="cabeceraTipoAnaquelObjectResult"  class="cabeceraTipoAnaquel">                                                                       
    	<result property="oidCentro"						column="OIDCENTRO"/>
    	<result property="codigoCD"			     			column="CODCENTRO"/>
    	<result property="descripcionCD"					column="DESC_CENTRODIST"/>
    	<result property="oidMapaCD"						column="OIDMAPACD"/>
    	<result property="codigoMapaCD"						column="CODMAPACD"/>
    	<result property="descripcionMapaCD"				column="DESC_MAPACD"/>
    	<result property="oidSubLinea"						column="OIDSUBLINARMADO"/>
    	<result property="codigoSubLineaArmado"				column="CODSUBLINARMADO"/>
    	<result property="descripcionSubLineaArmado"	    column="DESC_SUBLINARMADO"/>
    	<result property="oidLineaArmado"					column="OIDLINARMADO"/>
    	<result property="codigoLineaArmado"				column="COD_LINARMADO"/>
    	<result property="descripcionLineaArmado"			column="DESC_LINARMADO"/>
	</resultMap>
	
	<select id="getObtenerDatosCabTipoAnaquel" parameterClass="java.util.Map" resultMap="cabeceraTipoAnaquelObjectResult">
		SELECT DISTINCT
               cab.ccdi_oid_conf_cent_dist OIDCENTRO,
		       app.cod_cent_dist           CODCENTRO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APP_CONFI_CENTR_DISTR',cab.ccdi_oid_conf_cent_dist,'P') DESC_CENTRODIST,
		       cab.oid_mapa_cent_dist_cabe OIDMAPACD,
		       cab.num_codi_mapa           CODMAPACD,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_MAPA_CENTR_DISTR_CABEC',cab.oid_mapa_cent_dist_cabe,'P') DESC_MAPACD,
		       det.sbar_oid_subl_arma      OIDSUBLINARMADO,
		       sli.cod_subl_arma           CODSUBLINARMADO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_SUBLI_ARMAD',det.sbar_oid_subl_arma,'P') DESC_SUBLINARMADO,
		       sli.liar_oid_line_arma      OIDLINARMADO,
               lar.num_codi_line                                                                  COD_LINARMADO,
               APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_LINEA_ARMAD',lar.oid_line_arma,'P') DESC_LINARMADO
		FROM   APE_MAPA_CENTR_DISTR_CABEC cab,
		       APE_MAPA_CENTR_DISTR_DETAL det,
		       APP_CONFI_CENTR_DISTR app,
		       APE_SUBLI_ARMAD       sli,
		       APE_LINEA_ARMAD       lar
		WHERE  cab.oid_mapa_cent_dist_cabe = det.mcdc_oid_mapa_cent_dist_cabe
		AND    cab.ccdi_oid_conf_cent_dist = app.oid_conf_cent_dist
		AND    det.sbar_oid_subl_arma      = sli.oid_subl_arma
		AND    sli.liar_oid_line_arma      = lar.oid_line_arma
		AND    cab.oid_mapa_cent_dist_cabe = #oidMapaCD#
		AND    det.sbar_oid_subl_arma      = #oidSubLinArmado#
		AND    ROWNUM                      = 1		
	</select>

	<select id="getOidTipoAnaquelbyCodigo" parameterClass="java.util.Map" resultClass="string">
		SELECT a.oid_tipo_anaq
  		  FROM ape_tipo_anaqu a
         WHERE a.cod_tipo_anaq = #codigoTipoAnaquel#
	</select>
	
	<delete id="deleteConfiguracionBalanceo" parameterClass="java.util.Map">
	     UPDATE APE_LINEA_ARMAD 
	     SET    num_unid_prea = NULL,
	            num_porc_vari_esti = NULL,
	            fndi_oid_func_dist = NULL
	     WHERE  oid_line_arma = #oidLinArmado# 	
	</delete>
	
	<select id="getOidLineaArmadoxOidCD" parameterClass="java.util.Map" resultClass="string">
		SELECT 	b.oid_line_arma 
		FROM    gen_i18n_sicc_pais a, 
		        ape_linea_armad b,
		        app_confi_centr_distr app
		WHERE   a.val_oid                 = b.oid_line_arma
		AND     b.ccdi_oid_conf_cent_dist = app.oid_conf_cent_dist 
		AND     a.attr_enti               = 'APE_LINEA_ARMAD'
		AND     a.val_i18n                = #descLiArmad#
		AND     app.oid_conf_cent_dist    = #oidCentro#
		AND     rownum = 1	
	</select>
	
	<select id="getValidaExisteMapaZonaDefecto" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)
		FROM   APE_MAPA_ZONA_CABEC
		WHERE  MCDC_OID_MAPA_CENT_DIST_CABE = #oidMapaCD# 
		AND    VAL_DEFE = 1	
	</select>
	
	<select id="getObtenerBahiaMayorxSubLinea" parameterClass="java.util.Map" resultClass="string">
		SELECT NVL(MAX(TO_NUMBER(SUBSTR(num_anaq,2,2))),0) as BAHIAMAYOR
		FROM   APE_MAPA_CENTR_DISTR_DETAL
		WHERE  sbar_oid_subl_arma = #oidSubLinArmado#
	</select>
	
	<select id="getObtenerDescripcionSubLinea" parameterClass="java.util.Map" resultClass="string">
		SELECT s.val_i18n as DESCRIPCION
	  	FROM   ape_subli_armad sl,
	       	   gen_i18n_sicc_pais s
		WHERE  s.attr_enti = 'APE_SUBLI_ARMAD'
	    AND    sl.oid_subl_arma = s.val_oid
	    AND    sl.oid_subl_arma = #oidSubLinArmado#
	</select>
		
    <resultMap id="EmitirAlarmaResult"  class="java.util.HashMap"  >                                                                       
    	<result property="codigoSap"			column="CODIGO"/>
    	<result property="descripcionCorta"		column="DESCRIPCION"/>
  	</resultMap>
	<select id="getEmitirAlarmaList" parameterClass="java.util.Map" resultMap="EmitirAlarmaResult">
    	SELECT 	DISTINCT Z1.COD_SAP codigo, 
    			ltrim(rtrim(Z2.VAL_I18N)) descripcion
          FROM 	PRE_MATRI_FACTU_CABEC A,PRE_OFERT B        ,
              	PRE_OFERT_DETAL C      ,PRE_MATRI_FACTU D  ,
              	APE_LINEA_ARMAD Z      ,
              	MAE_PRODU       Z1     ,GEN_I18N_SICC_PAIS Z2
         WHERE 	A.PERD_OID_PERI      = #oidPeriodo#    AND
              	B.MFCA_OID_CABE      = A.oid_cabe      AND
              	B.OID_OFER           = C.OFER_OID_OFER AND
              	D.MFCA_OID_CABE      = B.mfca_oid_cabe AND
              	D.ofde_oid_deta_ofer = C.oid_deta_ofer AND
              	Z.OID_LINE_ARMA       = #oidLinea#     AND
              	C.PROD_OID_PROD       = Z1.OID_PROD    AND
              	Z2.ATTR_ENTI          ='MAE_PRODU'     AND
              	C.PROD_OID_PROD       = Z2.VAL_OID     AND
              	NOT EXISTS( SELECT 	X2.PROD_OID_PROD 
                              FROM 	APE_ASIGN_PRODU_ANAQU_CABEC X1,
                                	APE_ASIGN_PRODU_ANAQU_DETAL X2
                             WHERE 	X1.MCDC_OID_MAPA_CENT_DIST_CABE = #oidMapaCentro#       			AND
                                 	X1.PERD_OID_PERI                = #oidPeriodo#          			AND
                                 	X1.OID_ASIG_PROD_ANAQ_CABE      = X2.APAC_OID_ASIG_PROD_ANAQ_CABE   AND
                                 	X2.PROD_OID_PROD                = C.PROD_OID_PROD       			AND
                                 	X1.Val_Vers 					= #codVersion#  					AND
									X1.ind_acti_fact                = 'S'  							    AND
                                    ROWNUM = 1
                         )
     ORDER BY 	ltrim(rtrim(Z2.VAL_I18N)) ASC                                       
    </select>

	<update id="updateEmitirAlarma" parameterClass="java.util.Map">
	    UPDATE APE_LINEA_ARMAD 
	           SET FEC_HORA_REVI_ALAR=SYSDATE 
        WHERE OID_LINE_ARMA=#oidLinea#  
	</update>
	
    <select id="getMailEmitirAlarmaList" parameterClass="java.util.Map" resultClass="string">
         SELECT VAL_MAIL MAIL
           FROM APE_USUAR_ALARM_LINEA
         WHERE LIAR_OID_LINE_ARMA=#oidLinea#            
    </select>	
    
	<select id="getExistePeriodobyMarcaCanal" parameterClass="java.util.Map"  resultClass="int">
	    SELECT COUNT(1)  
	      FROM seg_perio_corpo a,cra_perio b
         WHERE a.cod_peri      = #codPeriodo#
           AND b.Marc_Oid_Marc = gen_pkg_gener.gen_fn_devuelve_id_marca(#codigoMarca#)
           AND b.cana_oid_cana = gen_pkg_gener.gen_fn_devuelve_id_canal(#codigoCanal#)
           AND a.oid_peri      = b.peri_oid_peri
    </select>
	
	<select id="getOidAsignacionVersion" parameterClass="java.util.Map" resultClass="string">
		SELECT	a.oid_asig_prod_anaq_cabe 
		  FROM  ape_asign_produ_anaqu_cabec a
		 WHERE  a.val_vers = #codigoVersion#
   		   AND 	a.perd_oid_peri = #oidPeriodo#
           AND 	a.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#	
	</select>
	
	<resultMap id="productosAnaquelesResult"  class="java.util.HashMap"  >                                                                
    	<result property="oidAsigOrdenCab"			column="OID_ASIG_ORDEN_CAB"/>
    	<result property="oidAsigOrdenDet"			column="OID_ASIG_ORDEN_DET"/>
    	<result property="numAnaquel"			    column="NUM_ANAQUEL"/>
    	<result property="codSAP"					column="COD_SAP"/>
    	<result property="desSAP"					column="DES_SAP"/>
    	<result property="indActivo"				column="IND_ACTIVO"/>
    	<result property="oidSubLinea"				column="OID_SUB_LINEA"/>
    	<result property="oidLinea"					column="OID_LINEA"/>
    	<result property="oidMapaCentroDet"			column="OID_MAPA_CENTRO_DET"/>
    	<result property="oidMapaCentroCab"			column="OID_MAPA_CENTRO_CAB"/>
    	<result property="oidTipoAnaquel"			column="OID_TIPO_ANAQUEL"/>
    	<result property="desTipoAnaquel"			column="DES_TIPO_ANAQUEL"/>
	</resultMap>
	<select id="getProductosAnaquelesList" parameterClass="java.util.Map" resultMap="productosAnaquelesResult">
		SELECT	pad.apac_oid_asig_prod_anaq_cabe    OID_ASIG_ORDEN_CAB,
				pad.oid_asig_prod_anaq          	OID_ASIG_ORDEN_DET,
        		mcd.num_anaq						NUM_ANAQUEL,
        		mae.cod_sap							COD_SAP,
        		i18p.val_i18n                       DES_SAP,
        		decode(mcd.ind_expa,0,'SI','NO')	IND_ACTIVO,
        		mcd.sbar_oid_subl_arma				OID_SUB_LINEA,
        		sa.liar_oid_line_arma				OID_LINEA,
        		mcd.oid_mapa_cent_dist_deta         OID_MAPA_CENTRO_DET,
        		mcd.mcdc_oid_mapa_cent_dist_cabe  	OID_MAPA_CENTRO_CAB,
        		mcd.tian_oid_tipo_anaq              OID_TIPO_ANAQUEL,
        		i18C.val_i18n                       DES_TIPO_ANAQUEL
  		  FROM  ape_asign_produ_anaqu_detal pad,
        		ape_mapa_centr_distr_detal mcd,
        		mae_produ mae,
        		ape_subli_armad sa,
        		gen_i18n_sicc_comun i18c,
        		gen_i18n_sicc_pais i18p
 	     WHERE  pad.apac_oid_asig_prod_anaq_cabe = #oidAsigOrdenCab#
   		   AND  pad.mcdd_oid_mapa_cent_dist_deta = mcd.oid_mapa_cent_dist_deta
   		   AND  pad.prod_oid_prod = mae.oid_prod (+)
   		   AND  sa.oid_subl_arma = mcd.sbar_oid_subl_arma
   		   AND  i18c.attr_enti = 'APE_TIPO_ANAQU'
   		   AND  i18c.idio_oid_idio = #oidIdiomaISO#
   		   AND  i18c.attr_num_atri = 1
   		   AND  i18c.val_oid = mcd.tian_oid_tipo_anaq
   		   AND  i18p.attr_enti(+) = #nombreTablaMaeProducto#
   		   AND  i18p.idio_oid_idio(+) = #oidIdiomaISO#
   		   AND  i18p.attr_num_atri(+) = 1
   		   AND  i18p.val_oid (+)= pad.prod_oid_prod
          
          
         <isEmpty property="codigoAnaquel">
         	<isEmpty property="codigoSAP">
         		<isEmpty property="descripcionSAP">
           			ORDER BY mcd.num_anaq ASC
         		</isEmpty>
         	</isEmpty>
         </isEmpty>  
          
         <isNotEmpty property="codigoAnaquel">
		 	AND  mcd.num_anaq >= #codigoAnaquel#
		 	ORDER BY mcd.num_anaq ASC
		 </isNotEmpty>
		 
		  <isNotEmpty property="codigoSAP">
		 	AND  mae.cod_sap >= #codigoSAP#
		 	ORDER BY mae.cod_sap ASC
		 </isNotEmpty>
		 
		  <isNotEmpty property="descripcionSAP">
		 	AND EXISTS (SELECT I18N2.VAL_I18N
                 FROM GEN_I18N_SICC_PAIS I18N2
                WHERE I18N2.VAL_OID = PAD.PROD_OID_PROD
                  AND I18N2.ATTR_ENTI = 'MAE_PRODU'
                  AND I18N2.IDIO_OID_IDIO = 1
                  AND I18N2.ATTR_NUM_ATRI = 1
                  AND UPPER(I18N2.val_i18n) LIKE UPPER(#descripcionSAP#)||'%')
		 	ORDER BY mae.cod_sap ASC
		 </isNotEmpty>
	</select>
	
	<select id="getOidMapaZonaByMapaCentroZona" parameterClass="java.util.Map" resultClass="string">
    	SELECT	c.oid_mapa_zona_cabe
	      FROM	ape_mapa_zona_cabec c
	     WHERE	c.cod_mapa_zona = #codMapaZona#
	       AND	c.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
	</select>
	
	<select id="getLineaMapaOrdenZonaList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	DISTINCT lin.num_codi_line  AS CODIGO,
       			i18n.val_i18n      			AS DESCRIPCION
	  	  FROM  ape_mapa_centr_distr_cabec cencab, 
        		ape_mapa_centr_distr_detal cendet,
       			ape_linea_armad            lin,
       			ape_subli_armad            sublin,
       			v_gen_i18n_sicc            i18n,
        		ape_mapa_zona_cabec        mzc,
        		ape_mapa_zona_detal        mzd
	     WHERE  cendet.sbar_oid_subl_arma = sublin.oid_subl_arma
   		   AND 	sublin.liar_oid_line_arma = lin.oid_line_arma
   		   AND 	cendet.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
   		   AND 	lin.oid_line_arma = i18n.val_oid
   		   AND 	i18n.idio_oid_idio = 1
   		   AND 	i18n.attr_num_atri = 1
   		   AND 	i18n.attr_enti = #nombreTablaLineaArmado#
   		   AND  mzd.sbar_oid_subl_arma = sublin.oid_subl_arma
   		   AND  cencab.oid_mapa_cent_dist_cabe = cendet.mcdc_oid_mapa_cent_dist_cabe
   		   AND  mzc.oid_mapa_zona_cabe = mzd.mzca_oid_mapa_zona_cabe
           AND  cencab.oid_mapa_cent_dist_cabe = mzc.mcdc_oid_mapa_cent_dist_cabe
           AND  mzc.oid_mapa_zona_cabe = #oidMapaZona#
	</select>
	
	<update id="desasignarProductoAnaquel" parameterClass="java.util.Map">
		UPDATE ape_asign_produ_anaqu_detal
           SET prod_oid_prod = NULL
         WHERE oid_asig_prod_anaq = #oidAsigOrdenDet#
	</update>
	
	<select id="getAnaquelesDestinoList" parameterClass="java.util.Map"  resultMap="baseResult">
	    SELECT  mcd.num_anaq	as CODIGO,
        	    mcd.num_anaq	as DESCRIPCION
    	  FROM  ape_asign_produ_anaqu_detal pad,
        		ape_mapa_centr_distr_detal mcd
    	 WHERE  pad.apac_oid_asig_prod_anaq_cabe = #oidAsigOrdenCab#
           AND  pad.mcdd_oid_mapa_cent_dist_deta = mcd.oid_mapa_cent_dist_deta
	</select>
	
	<update id="asignarProductoAnaquel" parameterClass="java.util.Map">
		UPDATE ape_asign_produ_anaqu_detal
           SET prod_oid_prod = #oidSAP#,
           	   prce_oid_proc = 1
         WHERE oid_asig_prod_anaq = #oidAsigOrdenDet#
	</update>
	
	<parameterMap id="paramValidaProductoAnaquel" class="java.util.Map">
		<parameter property="oidPais"            		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="oidSAP"              		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidPeriodo"            	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="codAnaquel"              	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidSubLinea"            	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="oidMapaCentroCab"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidMapaCentroDet"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidAsigOrdenCab"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="indIntercambio"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="valError"     		    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	</parameterMap>
	
	<procedure id="validaProductoAnaquel" parameterMap="paramValidaProductoAnaquel">
		{call APE_PKG_PROCE.APE_PR_VALID_PRODU_ANAQU(?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<parameterMap id="paramIntercambioProductoAnaquel" class="java.util.Map">
		<parameter property="oidPais"            		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="oidSAP"              		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidPeriodo"            	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="codAnaquel"              	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="codAnaquelDestino"        	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidSubLinea"            	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="oidMapaCentroDet"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidMapaCentroCab"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidAsigOrdenDet"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidAsigOrdenCab"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="indIntercambio"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="valError"     		    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	</parameterMap>
	
	<procedure id="intercambioProductoAnaquel" parameterMap="paramIntercambioProductoAnaquel">
		{call APE_PKG_PROCE.APE_PR_INTER_PRODU_ANAQU(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<select id="getOidMapaCDxOidCentro" parameterClass="java.util.Map" resultClass="string">
		SELECT c.oid_mapa_cent_dist_cabe as CODIGO      
		FROM   ape_mapa_centr_distr_cabec c      
		WHERE  c.num_codi_mapa = #codMapCentrDist#
		AND    c.ccdi_oid_conf_cent_dist = #oidCentro#
	</select>

	
	

	<resultMap id="configuracionBalancSubLineaResult"  class="java.util.HashMap"  >                                                                
    	<result property="oidSubLinea"					column="OID_SUBLINEA"/>
    	<result property="descLineaArmado"		    	column="DESC_LINEAARMADO"/>
    	<result property="descFunDistLinea"				column="DESC_FUNDISTLINEA"/>
    	<result property="descSubLinea"					column="DESC_SUBLINEA"/>
    	<result property="varPorcentaje"				column="VARPORCENTAJE"/>
    	<result property="nroUnidadPre"					column="NROUNIDADPRE"/>
    	<result property="descFunDistSubLinea"			column="DESC_FUNDISTSUBLINEA"/>
	</resultMap>

	<select id="getConfiguracionBlSublineaList" parameterClass="java.util.Map" resultMap="configuracionBalancSubLineaResult">
		SELECT sl.oid_subl_arma 			OID_SUBLINEA, 
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_LINEA_ARMAD',la.oid_line_arma,'P') 		DESC_LINEAARMADO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_FUNCI_DISTR',la.fndi_oid_func_dist,'C') 	DESC_FUNDISTLINEA,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_SUBLI_ARMAD',sl.oid_subl_arma,'P') 		DESC_SUBLINEA,
		       sl.val_porc_vari_esti		VARPORCENTAJE,
		       sl.num_unid_prea 			NROUNIDADPRE,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_FUNCI_DISTR',sl.fndi_oid_func_dist,'C') 	DESC_FUNDISTSUBLINEA       
		FROM   APE_SUBLI_ARMAD sl,
		       APE_LINEA_ARMAD la
		WHERE  sl.liar_oid_line_arma = la.oid_line_arma
		AND    la.oid_line_arma      = #oidLinArmado#

	  <isNotEmpty property="oidSubLineaArmado">
		AND    sl.oid_subl_arma      = #oidSubLineaArmado#
	  </isNotEmpty>
	  
	</select>

	<resultMap id="configuracionBalanceoSubLineaObjectResult"  class="ConfiguracionBalanceoSubLinea">  
		<result property="oidCentro"						column="OID_CENTRO"/>
	    <result property="desCentroDist"					column="DESC_CENTRODIST"/>
    	<result property="oidSubLinea"						column="OID_SUBLINEA"/>
    	<result property="oidLinArmado"						column="OID_LINARMADO"/>
    	<result property="descLineaArmado"	     			column="DESC_LINEAARMADO"/>
    	<result property="descFunDistLinea"					column="DESC_FUNDISTLINEA"/>
    	<result property="oidFunDistLinea"					column="OIDFUNCDISTLINEA"/>
    	<result property="descSubLinea"						column="DESC_SUBLINEA"/>
    	<result property="varPorcentaje"					column="VARPORCENTAJE"/>
    	<result property="nroUnidadPreAsigna"				column="NROUNIDADPRE"/>
    	<result property="maxAnaquelProd"					column="MAXANAQPROD"/>
    	<result property="oidFuncDist"					    column="OID_FUNCDIST"/>
    	<result property="codigoFuncion"				    column="COD_FUNCDIST"/>
    	<result property="descFunDistSubLinea"				column="DESC_FUNDISTSUBLINEA"/>
	</resultMap>
	
	<select id="getObtenerConfiguracionBalSubLinea" parameterClass="java.util.Map" resultMap="configuracionBalanceoSubLineaObjectResult">
		SELECT app.oid_conf_cent_dist    OID_CENTRO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APP_CONFI_CENTR_DISTR',app.oid_conf_cent_dist,'P') DESC_CENTRODIST,
		       sl.oid_subl_arma          OID_SUBLINEA,
           	   la.oid_line_arma          OID_LINARMADO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_LINEA_ARMAD',la.oid_line_arma,'P') DESC_LINEAARMADO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_FUNCI_DISTR',la.fndi_oid_func_dist,'C') DESC_FUNDISTLINEA,
		       la.fndi_oid_func_dist OIDFUNCDISTLINEA,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_SUBLI_ARMAD',sl.oid_subl_arma,'P') DESC_SUBLINEA,
		       sl.val_porc_vari_esti     VARPORCENTAJE,
		       sl.num_unid_prea          NROUNIDADPRE,
		       sl.num_maxi_anaq_prod     MAXANAQPROD,
		       fd.oid_func_dist          OID_FUNCDIST,
	           fd.cod_func_dist          COD_FUNCDIST,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_FUNCI_DISTR',sl.fndi_oid_func_dist,'C') DESC_FUNDISTSUBLINEA
		FROM   APE_SUBLI_ARMAD sl,
		       APE_LINEA_ARMAD la,
		       APP_CONFI_CENTR_DISTR app,
		       APE_FUNCI_DISTR fd
		WHERE  sl.liar_oid_line_arma = la.oid_line_arma
		AND    la.ccdi_oid_conf_cent_dist = app.oid_conf_cent_dist
		AND    sl.fndi_oid_func_dist = fd.oid_func_dist(+)
		AND    sl.oid_subl_arma      = #oidSubLinArmado#	
	</select>
	
	<update id="updateConfiguracionSubLinea" parameterClass="java.util.Map">
	    UPDATE APE_SUBLI_ARMAD 
	    SET    val_porc_vari_esti 	= #porcVariaEstimado#,
	           num_unid_prea      	= #numUnidPrea#,
	           num_maxi_anaq_prod 	= #numMaxiAnaquel#,
	           fndi_oid_func_dist 	= #oidFuncDist#
	    WHERE  oid_subl_arma           = #oidSubLinArmado#
	    AND    liar_oid_line_arma      = #oidLinArmado#
	</update>

  	<resultMap id="factoresConversionResult"  class="java.util.HashMap">                                                               
    	<result property="oidFactConv"				column="OID_FACTCONV"/>
    	<result property="descMagnitud"				column="DESC_MAGNITUD"/>
    	<result property="descUnidMedOrigen" 		column="DESC_UNIDMEDORIGEN"/>
    	<result property="descUnidMedDestino"		column="DESC_UNIDMEDDESTINO"/>
    	<result property="factor"					column="FACTOR"/>
	</resultMap>
		
	<select id="getFactoresConversionList" parameterClass="java.util.Map" resultMap="factoresConversionResult">
		SELECT oid_fact_conv      OID_FACTCONV,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('MAE_MAGNI',magn_oid_magn,'C') DESC_MAGNITUD,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('MAE_UNIDA_MEDID',unmd_oid_unid_medi_orig,'P') DESC_UNIDMEDORIGEN,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('MAE_UNIDA_MEDID',unmd_oid_unid_medi_dest,'P') DESC_UNIDMEDDESTINO,
		       num_fact_conv      FACTOR
		FROM   APE_FACTO_CONVE

	  <isNotEmpty property="oidMagn">
		WHERE  magn_oid_magn           = #oidMagn#
	  </isNotEmpty>
		
	  <isNotEmpty property="oidUnidMediOrig">
		AND    unmd_oid_unid_medi_orig = #oidUnidMediOrig#
	  </isNotEmpty>

	  <isNotEmpty property="oidUnidMediDest">
		AND    unmd_oid_unid_medi_dest = #oidUnidMediDest#
	  </isNotEmpty>
	
	</select>
	
	<select id="getUnidadMedidaList" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT c.cod_unid_medi as CODIGO,
	     	   s.val_i18n as DESCRIPCION
		FROM   MAE_UNIDA_MEDID c,
	       	   gen_i18n_sicc_pais s
		WHERE  c.oid_unid_medi = s.val_oid
		AND    s.attr_enti = 'MAE_UNIDA_MEDID'

	  <isNotEmpty property="oidPais">
		AND    c.pais_oid_pais = #oidPais#
	  </isNotEmpty>		

	  <isNotEmpty property="oidMagn">
        AND    c.magn_oid_magn = #oidMagn#
	  </isNotEmpty>		
		
	</select>

	<select id="getMagnitudList" parameterClass="java.util.Map" resultMap="baseResult">
	  	  SELECT c.cod_magn as CODIGO,
	   			 s.val_i18n as DESCRIPCION
		  FROM   MAE_MAGNI c,
	    	   	 gen_i18n_sicc_comun s
		  WHERE  c.oid_magn = s.val_oid
		  AND    s.attr_enti = 'MAE_MAGNI'
	</select>
	
	<select id="getObtenerOidMagnitud" parameterClass="java.util.Map" resultClass="string">
		  SELECT oid_magn
		  FROM   MAE_MAGNI
		  WHERE  cod_magn = #codMagn#
	</select>	
	
	<select id="getObtenerOidUnidadMedida" parameterClass="java.util.Map" resultClass="string">
		  SELECT oid_unid_medi
		  FROM   MAE_UNIDA_MEDID
		  WHERE  pais_oid_pais = #oidPais#
		  AND    cod_unid_medi = #codUnidMedi#
	</select>
	
	<insert id="insertFactoresConversion" parameterClass="java.util.Map">
		INSERT INTO APE_FACTO_CONVE(oid_fact_conv,num_fact_conv,unmd_oid_unid_medi_orig,unmd_oid_unid_medi_dest,magn_oid_magn)
		VALUES(ape_faco_seq.nextval,TO_NUMBER(#numFactConv#,'9999.999'),#oidUnidMediOrig#,#oidUnidMediDest#,#oidMagn#)
	</insert>
	
	<update id="updateFactoresConversion" parameterClass="java.util.Map">
		UPDATE APE_FACTO_CONVE
		SET magn_oid_magn           = #oidMagn#,
		    unmd_oid_unid_medi_orig = #oidUnidMediOrig#,
		    unmd_oid_unid_medi_dest = #oidUnidMediDest#,
		    num_fact_conv           = TO_NUMBER(#numFactConv#,'9999.999')
		WHERE oid_fact_conv         = #oidFactConv#
	</update>

  	<resultMap id="factorConversionObject"  class="FactorConversion">                                                               
    	<result property="oidFactorConv"			column="OID_FACTCONV"/>
    	<result property="codigoMagn"				column="COD_MAGN"/>
    	<result property="codigoUnidMediOrig" 		column="COD_UNIDMEDORIGEN"/>
    	<result property="codigoUnidMediDest"		column="COD_UNIDMEDDESTINO"/>
    	<result property="factor"					column="FACTOR"/>
	</resultMap>
	
	<select id="getFactorConversionObject" parameterClass="java.util.Map" resultMap="factorConversionObject">
		SELECT fc.oid_fact_conv      OID_FACTCONV,
		       mg.cod_magn           COD_MAGN,
		       (SELECT cod_unid_medi FROM MAE_UNIDA_MEDID WHERE oid_unid_medi = fc.unmd_oid_unid_medi_orig) COD_UNIDMEDORIGEN,
		       (SELECT cod_unid_medi FROM MAE_UNIDA_MEDID WHERE oid_unid_medi = fc.unmd_oid_unid_medi_dest) COD_UNIDMEDDESTINO,
		       fc.num_fact_conv      FACTOR
		FROM   APE_FACTO_CONVE fc,
		       MAE_MAGNI       mg
		WHERE  fc.magn_oid_magn = mg.oid_magn
		AND    fc.oid_fact_conv = #oidFactConv#	
	</select>
	
	<delete id="deleteFactorConversion" parameterClass="java.util.Map">
		DELETE FROM APE_FACTO_CONVE
		WHERE oid_fact_conv = #oidFactConv#	
	</delete>
	
	<select id="validaRepeticionUndOrigenUndDestino" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)
		FROM   APE_FACTO_CONVE apefact
		WHERE  apefact.unmd_oid_unid_medi_orig = #oidUnidMediOrig#
		AND    apefact.unmd_oid_unid_medi_dest = #oidUnidMediDest#	
	</select>
	
	<select id="validaExisteGeneraEstimado" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)      
		  FROM ape_estim_produ ep      
		 WHERE ep.perd_oid_peri = #oidPeriodo#
           AND ep.liar_oid_line_arma = #oidLinea#
	</select>
	
	<parameterMap id="paramGenerarEstimadoProducto" class="java.util.Map">
		<parameter property="oidPeriodo"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidLinea"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="indBorraManual"      	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	</parameterMap>
	
	<procedure id="executeGenerarEstimadoProducto" parameterMap="paramGenerarEstimadoProducto">
		{call APE_PKG_PROCE.APE_PR_GENER_ESTIM_PRODU(?, ?, ?) }
	</procedure>
	
	
	<parameterMap id="paramPreasignacionPorVariacionEstimados" class="java.util.Map">	
		<parameter property="oidMapaCD"            		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="oidSubLinea"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="oidPeriodoOrigen"      	jdbcType="NUMBER" javaType="java.lang.String"  mode="IN" />
		<parameter property="oidPeriodoDestino"         jdbcType="NUMBER" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="codigoVersionOrigen"     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="codigoVersionDestino"     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="codigofuente"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	</parameterMap>
	
	<procedure id="executePreasignacionPorVariacionEstimados" parameterMap="paramPreasignacionPorVariacionEstimados">
		{call APE_PKG_PROCE.APE_PR_PREAS_VARIA_ESTIM(?, ?, ?, ?, ?, ?,?) }
	</procedure>
	
	
	
	<parameterMap id="paramPreasignacionAframe" class="java.util.Map">	
		<parameter property="oidMapaCD"            		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidLinea"     		    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
 		<parameter property="oidSubLinea"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="oidPeriodoOrigen"      	jdbcType="NUMBER" javaType="java.lang.String"  mode="IN" />
		<parameter property="oidPeriodoDestino"         jdbcType="NUMBER" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="codigoVersionOrigen"     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="codigoVersionDestino"     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigofuente"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	</parameterMap>
	
	
	<procedure id="executePreasignacionAframe" parameterMap="paramPreasignacionAframe">
		{call APE_PKG_PROCE.APE_PR_PREAS_AFRAM(?, ?, ?, ?, ?, ?,?,?) }
	</procedure>
	
		
    <resultMap id="EstimadoProductoResult"  class="java.util.HashMap"  >
        <result property="codCentro"	    	column="COD_CENTRO"/>
        <result property="codLinea"	    		column="COD_LINEA"/>
        <result property="codMarca"	    		column="COD_MARCA"/>
        <result property="codCanal"	    		column="COD_CANAL"/>
    	<result property="oidPeri"	    		column="OID_PERI"/>
        <result property="codPeri"	    		column="COD_PERI"/>        
    	<result property="oidProd"	     		column="OID_PROD"/>
    	<result property="codigoSap"			column="CODIGO"/>
    	<result property="descripcionSap"		column="DESCRIPCION"/>
    	<result property="unidadEstimada"		column="NUM_UNID_ESTI"/>
    	<result property="flagFueraPedido"		column="IND_FUER_PEDI"/>
    	<result property="desProceso"		    column="DES_PROC"/>
    	<result property="oidProceso"		    column="OID_PROC"/>
  	</resultMap>
    
    <select id="getEstimadoProductoList" parameterClass="java.util.Map" resultMap="EstimadoProductoResult">
    SELECT 
        #codCentro#         COD_CENTRO ,
        #codLinea#          COD_LINEA  ,
        #codigoMarca#       COD_MARCA  ,
        #codigoCanal#       COD_CANAL  ,
        #codPeriodo#        COD_PERI   ,
        A.PERD_OID_PERI     OID_PERI   ,
        TO_CHAR(B.OID_PROD) OID_PROD   ,
        B.COD_SAP           CODIGO     ,
        Z2.VAL_I18N         DESCRIPCION,
        A.NUM_UNID_ESTI     NUM_UNID_ESTI,
        CASE WHEN B.COD_IND_DENT_CAJA IN('F','B') THEN 'S'
        ELSE
            'N'
        END IND_FUER_PEDI ,
        ( SELECT  X2.val_i18n DESCRIPCION FROM gen_i18n_sicc_comun X2            
            WHERE X2.attr_enti = 'APE_PROCE' AND
                  X2.val_oid   = A.PRCE_OID_PROC
        ) DES_PROC,
        A.PRCE_OID_PROC	OID_PROC
    FROM APE_ESTIM_PRODU A, MAE_PRODU B,GEN_I18N_SICC_PAIS Z2
    WHERE
        A.PERD_OID_PERI      = #oidPeriodo#         AND
        A.LIAR_OID_LINE_ARMA = #oidLinea#           AND
        A.PROD_OID_PROD      = B.OID_PROD           AND
        B.PAIS_OID_PAIS      = to_number(#oidPais#) AND
        Z2.ATTR_ENTI         ='MAE_PRODU'           AND
        B.OID_PROD           = Z2.VAL_OID           

		  <isNotEmpty property="flagFuePed">
		 	AND 
		     ( CASE WHEN UPPER(#flagFuePed#) = 'S' AND A.IND_FUER_PEDI=1 THEN 1
		            WHEN UPPER(#flagFuePed#) = 'N' AND A.IND_FUER_PEDI=0 THEN 1
		       ELSE
		           0
               END ) = 1    			 	
		 </isNotEmpty>
		         
	     <isNotEmpty property="codSap"> 
		 	AND B.COD_SAP >= #codSap#
		 	ORDER BY B.COD_SAP ASC
		 </isNotEmpty>
		 
		  <isNotEmpty property="desSap">
		 	AND UPPER(Z2.VAL_I18N) LIKE UPPER(#desSap#)||'%'
            ORDER BY Z2.VAL_I18N ASC
		 </isNotEmpty>
		 
	 
    </select>
   
   	<select id="getNextOidEstimadoProducto" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT APE_ESPR_SEQ.NEXTVAL FROM  dual
	</select>
	
	<insert id="insertEstimadoProducto" parameterClass="java.util.Map">
		INSERT INTO ape_estim_produ 
		(  
         oid_esti_prod,  num_unid_esti     ,  ind_fuer_pedi, 
         prce_oid_proc,  liar_oid_line_arma,  perd_oid_peri, 
         prod_oid_prod
 		)
		VALUES 
		(  
			#oidSec#  , #undEstimada#  , 
   			CASE WHEN #flagFuePed# = 'S' THEN 1
            ELSE
                 0
             END      ,
			1         , #oidLinea#     , #oidPeriodo# ,
			#oidProd#
		)
	</insert>
	
	<update id="updateEstimadoProducto" parameterClass="java.util.Map">
		UPDATE 	ape_estim_produ
           SET 	num_unid_esti = #undEstimada#,
                prce_oid_proc = 1
         WHERE 	perd_oid_peri = #oidPeriodo#
           AND  prod_oid_prod = #oidProd#
           AND	liar_oid_line_arma = #oidLinea#
	</update>	

	<delete id="deleteEstimadoProducto" parameterClass="java.util.Map">
		DELETE FROM ape_estim_produ 
         WHERE 	perd_oid_peri = #oidPeriodo#
           AND  prod_oid_prod = #oidProd#
           AND	liar_oid_line_arma = #oidLinea#
           AND  prce_oid_proc = #oidProc#
	</delete>
	
	<select id="getExisteEstimadoProductoCD" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
          FROM ape_estim_produ 
         WHERE 	perd_oid_peri      = #oidPeriodo#
           AND  prod_oid_prod      = #oidProd#
           AND  liar_oid_line_arma = #oidLinea#
	</select>	
	
	<select id="getOidProductoByCodigoyPais" parameterClass="java.util.Map" resultClass="string">
      SELECT oid_prod FROM mae_produ
       WHERE cod_sap      = #codSap# AND
             pais_oid_pais= to_number(#oidPais#)
	</select>	
	    	
	<select id="getExisteProductoCD" parameterClass="java.util.Map" resultClass="int">
      SELECT COUNT(1) FROM mae_produ
       WHERE cod_sap      = #codSap# AND
             pais_oid_pais= to_number(#oidPais#)
	</select>	

    <resultMap id="productoByCodSapyOidPaisResult"  class="estimadoProducto">                                                                      
    	<result property="oidSap"	   column="OID_SAP"/>
    	<result property="codSap"	   column="COD_SAP"/>
    	<result property="desSap"	   column="DES_SAP"/>
    	<result property="flagFuePed"  column="FLAG_FUE_PED"/>
    	<result property="flagLinAfp"  column="FLAG_LIN_AFP"/>
  	</resultMap>
    
    <select id="getProductoByCodSapyOidPaisObject" parameterClass="java.util.Map" resultMap="productoByCodSapyOidPaisResult">
      SELECT 
        TO_CHAR(Z2.VAL_OID)  OID_SAP,
        B.COD_SAP       COD_SAP,
        Z2.VAL_I18N     DES_SAP,
        CASE WHEN B.COD_IND_DENT_CAJA IN('F','B') THEN 'S'
        ELSE
            'N'
        END             FLAG_FUE_PED,
        DECODE(X.NUM_LINE_AFP,1,'S','N') FLAG_LIN_AFP 
      FROM MAE_PRODU B,GEN_I18N_SICC_PAIS Z2,APE_LINEA_ARMAD X 
      WHERE B.cod_sap       = #codSap#             AND
            B.pais_oid_pais = gen_pkg_gener.GEN_FN_DEVUELVE_ID_PAIS(#codPais#)  AND 
            Z2.ATTR_ENTI    ='MAE_PRODU'           AND
            B.OID_PROD      = Z2.VAL_OID           AND
            X.NUM_CODI_LINE = #codLinea#
    </select>
	
	<resultMap id="TipoCajaLineaResult"  class="java.util.HashMap"  >                                                                
    	<result property="oidLineaTipoCajaEmbal"		column="OID_LINEA_TIPO_CAJA_EMBAL"/>
    	<result property="oidLineaArmado"				column="OID_LINEA_ARMADO"/>
    	<result property="desLineaArmado"			    column="DES_LINEA_ARMADO"/>
    	<result property="oidTipoCajaEmbal"				column="OID_TIPO_CAJA_EMBAL"/>
    	<result property="codTipoCaja"					column="COD_TIPO_CAJA"/>
    	<result property="desTipoCaja"					column="DES_TIPO_CAJA"/>
	</resultMap>
	<select id="getTipoCajaLineaList" parameterClass="java.util.Map" resultMap="TipoCajaLineaResult">
		SELECT	ltce.oid_line_tipo_caja_emba    					OID_LINEA_TIPO_CAJA_EMBAL,
       			la.oid_line_arma                					OID_LINEA_ARMADO,
       			(SELECT i18.val_i18n
          		   FROM gen_i18n_sicc_pais i18
         		  WHERE i18.val_oid = la.oid_line_arma 
                    AND i18.attr_enti = #nombreTablaLinea#
           		    AND i18.attr_num_atri = 1
           			AND i18.idio_oid_idio = #oidIdiomaIso#)  		DES_LINEA_ARMADO,
       			tce.oid_tipo_caja_emba          					OID_TIPO_CAJA_EMBAL,
       			tce.val_tipo_caja               					COD_TIPO_CAJA,
       			(SELECT i18.val_i18n
          		   FROM gen_i18n_sicc_pais i18
         		  WHERE i18.val_oid = tce.oid_tipo_caja_emba
           			AND i18.attr_enti = #nombreTablaTipoCajaEmbalaje#
           			AND i18.attr_num_atri = 1
           			AND i18.idio_oid_idio = #oidIdiomaIso#)  		DES_TIPO_CAJA
		  FROM	ape_linea_tipo_caja_embal ltce,
       			ape_linea_armad la,
       			ape_tipo_caja_embal tce  
		 WHERE  la.oid_line_arma = #oidLinea#
   		   AND 	la.ccdi_oid_conf_cent_dist = #oidCentro#
   		   AND 	la.oid_line_arma = ltce.liar_oid_line_arma
   		   AND 	tce.oid_tipo_caja_emba = ltce.tcem_oid_tipo_caja_emba
      ORDER BY 	ltce.oid_line_tipo_caja_emba, 
      		   	tce.oid_tipo_caja_emba
	</select>
	
	<delete id="deleteTipoCajaLinea" parameterClass="java.util.Map">
		DELETE FROM ape_linea_tipo_caja_embal a
         WHERE a.oid_line_tipo_caja_emba = #oidTipoCajaLinea#
	</delete>
	
	<insert id="insertTipoCajaLinea" parameterClass="java.util.Map">
		INSERT INTO ape_linea_tipo_caja_embal (
   			oid_line_tipo_caja_emba,
   			liar_oid_line_arma,
   			tcem_oid_tipo_caja_emba
		)
		VALUES(
   			APE_LTCE_SEQ.NEXTVAL,
   			#oidLinea#,
   			#oidTipoCajaEmbalaje#
		)
	</insert>
	
	<select id="validaExisteTipoCajaLinea" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)      
		  FROM ape_linea_tipo_caja_embal a
		 WHERE a.liar_oid_line_arma = #oidLinea#
           AND a.tcem_oid_tipo_caja_emba = #oidTipoCajaEmbalaje#
	</select>
	
	<select id="validaMinimoTipoCajaLinea" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)      
		  FROM ape_linea_tipo_caja_embal a
		 WHERE a.liar_oid_line_arma = #oidLinea#
	</select>
	
	<select id="getTipoCajaEmbalajeComboList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	tce.val_tipo_caja as CODIGO,
				i18.val_i18n as DESCRIPCION
  		  FROM 	ape_tipo_caja_embal tce,
       			gen_i18n_sicc_pais i18 
 		 WHERE  tce.oid_tipo_caja_emba = i18.val_oid
   		   AND 	i18.attr_enti = #nombreTablaTipoCajaEmbalaje#
   		   AND 	i18.attr_num_atri = 1
   		   AND 	i18.idio_oid_idio = #oidIdiomaIso#
	</select>
	
	<select id="getOidTipoCajaEmbalbyCodigo" parameterClass="java.util.Map" resultClass="string">
		SELECT tce.oid_tipo_caja_emba      
		  FROM ape_tipo_caja_embal tce      
		 WHERE tce.pais_oid_pais = #oidPais#
		   AND tce.val_tipo_caja = #codTipoCajaEmbalaje#
	</select>
	
	<select id="getDescripcionLineabyOid" parameterClass="java.util.Map" resultClass="string">
		SELECT 	b.val_i18n
          FROM  ape_linea_armad a, 
       			gen_i18n_sicc_pais b
         WHERE  oid_line_arma = #oidLinea#
	       AND 	b.attr_enti = #nombreTablaLinea#
   		   AND  a.oid_line_arma = b.val_oid  
    	   AND  b.attr_num_atri = 1
    	   AND 	b.idio_oid_idio = #oidIdiomaIso#
    </select>
    
    <select id="getDescripcionTipoCajabyOid" parameterClass="java.util.Map" resultClass="string">
		SELECT 	i18.val_i18n
          FROM  ape_tipo_caja_embal tce,
       			gen_i18n_sicc_pais i18
         WHERE  tce.oid_tipo_caja_emba = #oidTipoCajaEmbalaje#
	       AND 	i18.attr_enti = #nombreTablaTipoCajaEmbalaje#
   		   AND  i18.attr_num_atri = 1
    	   AND 	i18.idio_oid_idio = #oidIdiomaIso#
    	   AND  tce.oid_tipo_caja_emba = i18.val_oid
    </select>
    
        <resultMap id="AlarmasValoresCubicajeResult"  class="java.util.HashMap"  >
        <result property="descripcion" column="DESCRIPCION"/>
    	<result property="registro"	   column="REGISTRO"/>
    	<result property="texto"	   column="TEXTO"/>
  	</resultMap>
    
    <select id="getAlarmasValoresCubicajeList" parameterClass="java.util.Map" resultMap="AlarmasValoresCubicajeResult">
    <![CDATA[
       SELECT b.val_i18n DESCRIPCION, 
     (
      CASE WHEN ( NVL(D.val_alto ,0)  = 0 OR
                  NVL(D.val_larg  ,0) = 0 OR
                  NVL(D.val_anch,0)   = 0 )
       THEN 
        'dimensiones incompletas - '
      END
     )
     ||    
     (
      CASE WHEN  NVL(D.num_nive_apli,0) >= NVL(D.NUM_CAPA_MINI,0)  THEN 
        'El nivel de aplicacin es mayor  igual a la capacidad mnima de la caja - '
      END
     )
     ||       
     ( 
      CASE WHEN D.NUM_CAPA_MINI >
          NVL(( SELECT MAX(DD.NUM_CAPA)         
           FROM ape_linea_tipo_caja_embal AA,
                gen_i18n_sicc_pais BB,gen_i18n_sicc_pais CC,
                ape_tipo_caja_embal Dd
         WHERE 
                aA.liar_oid_line_arma =#oidLinea#         AND
                bB.attr_enti = 'APE_LINEA_ARMAD'          AND
                aA.liar_oid_line_arma = bb.val_oid        AND
                cC.attr_enti = 'APE_TIPO_CAJA_EMBAL'      AND
                cC.val_oid   = AA.tcem_oid_tipo_caja_emba AND
                Dd.oid_tipo_caja_emba = AA.tcem_oid_tipo_caja_emba 
                 AND
                DD.NUM_CAPA < D.NUM_CAPA) ,0)                      
       THEN ' '                  
  		      ELSE
                'La capacidad mnima de la '||C.val_i18n||' '||
                'es menor o igual a la capacidad de la '||
                (
           SELECT  cc.val_i18n
           FROM ape_linea_tipo_caja_embal AA,
                gen_i18n_sicc_pais BB,gen_i18n_sicc_pais CC,
                ape_tipo_caja_embal Dd
         WHERE 
                aA.liar_oid_line_arma =#oidLinea#         AND
                bB.attr_enti = 'APE_LINEA_ARMAD'          AND
                aA.liar_oid_line_arma = bb.val_oid        AND
                cC.attr_enti = 'APE_TIPO_CAJA_EMBAL'      AND
                cC.val_oid   = AA.tcem_oid_tipo_caja_emba AND
                Dd.oid_tipo_caja_emba = AA.tcem_oid_tipo_caja_emba AND
                DD.NUM_CAPA =
               (
        SELECT MAX(DDD.NUM_CAPA)         
           FROM ape_linea_tipo_caja_embal AAA,ape_tipo_caja_embal ddd
         WHERE 
                AAA.liar_oid_line_arma = #oidLinea#                  AND
                DDD.oid_tipo_caja_emba = AAA.tcem_oid_tipo_caja_emba AND
                DDD.NUM_CAPA < D.NUM_CAPA
                )
               )
                           
            END
      )    REGISTRO,       
        C.val_i18n TEXTO 
   FROM ape_linea_tipo_caja_embal A,gen_i18n_sicc_pais B,gen_i18n_sicc_pais C,ape_tipo_caja_embal d
WHERE 
       a.liar_oid_line_arma =  #oidLinea#                AND
       b.attr_enti          =  'APE_LINEA_ARMAD'         AND
       a.liar_oid_line_arma =  b.val_oid                 AND
       c.attr_enti          =  'APE_TIPO_CAJA_EMBAL'     AND
       c.val_oid            =  A.tcem_oid_tipo_caja_emba AND
       d.oid_tipo_caja_emba =  A.tcem_oid_tipo_caja_emba 
ORDER BY D.NUM_CAPA DESC
    ]]>    
    </select>

    <resultMap id="TipoCajaEmbalajeResult"  class="java.util.HashMap"  >
        <result property="oidTipoCaja" 		column="OID_TIPOCAJA"/>
    	<result property="descTipoCaja"	  	column="DESC_TIPOCAJA"/>
    	<result property="unidadMedida"	 	column="UNIDADMEDIDA"/>
    	<result property="capacidad"	 	column="CAPACIDAD"/>
    	<result property="indCubicaje"	 	column="INDCUBICAJE"/>
  	</resultMap>
    
    <select id="getTipoCajaEmbalajeList" parameterClass="java.util.Map" resultMap="TipoCajaEmbalajeResult">
		SELECT tc.oid_tipo_caja_emba OID_TIPOCAJA,
		       s.val_i18n            DESC_TIPOCAJA,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('MAE_UNIDA_MEDID',tc.unmd_oid_unid_medi_capa ,'P') UNIDADMEDIDA,
		       tc.num_capa           CAPACIDAD,
		       CASE WHEN tc.ind_cubi='1' THEN 'SI' ELSE 'NO' END as INDCUBICAJE
		FROM   APE_TIPO_CAJA_EMBAL tc,
		       GEN_I18N_SICC_PAIS s
		WHERE  tc.oid_tipo_caja_emba = s.val_oid
		AND    s.attr_enti='APE_TIPO_CAJA_EMBAL'
		AND    tc.pais_oid_pais = #oidPais#

		 <isNotEmpty property="oidTipoCaja">
		 	AND    tc.oid_tipo_caja_emba = #oidTipoCaja#
		 </isNotEmpty>
		
		 <isNotEmpty property="descripcionTipoCaja">
		 	AND UPPER(s.val_i18n) LIKE '%'||UPPER(#descripcionTipoCaja#)||'%'
		 </isNotEmpty>
		
    </select>
    
    <resultMap id="etiquetayListadoPicadoByCodBarrayOidPaisResult"  class="etiquetayListadoPicado">                                                                      
    	<result property="oidPais" 			column="OID_PAIS"/>
    	<result property="oidConsolidado" 	column="OID_CONSOLIDADO"/>
    	<result property="oidSoli" 			column="OID_SOLI"/>
    	<result property="codListaPicado" 	column="COD_LISTA_PICADO"/>
    	<result property="numCaja" 			column="NUM_CAJA"/>
    	<result property="usuario" 			column="USUARIO"/>
  	</resultMap>   
    <select id="getEtiquetayListadoPicadoByCodBarrayOidPaisObject" parameterClass="java.util.Map" resultMap="etiquetayListadoPicadoByCodBarrayOidPaisResult">
		SELECT	eti.pais_oid_pais       OID_PAIS,
       			sol.oid_soli_cabe       OID_CONSOLIDADO,
       			sol.oid_soli_cabe       OID_SOLI,
       			pic.cod_list_pica       COD_LISTA_PICADO,
       			eti.num_caja            NUM_CAJA,
            	#usuario#               USUARIO
   		  FROM	ape_etiqu eti,
       			ped_solic_cabec sol,
       			ape_lista_picad_cabec pic
		 WHERE	eti.pais_oid_pais = gen_pkg_gener.gen_fn_devuelve_id_pais(#codPais#)
   		   AND 	sol.val_nume_soli = SUBSTR(SUBSTR(to_char(sysdate,'YYYY'),3)||#codBarra#,1, LENGTH(SUBSTR(to_char(sysdate,'YYYY'),3)||#codBarra#)-3 )
   		   AND 	eti.num_caja = TO_NUMBER(SUBSTR(SUBSTR(to_char(sysdate,'YYYY'),3)||#codBarra#,LENGTH(SUBSTR(to_char(sysdate,'YYYY'),3)||#codBarra#)-2,3))
   		   AND 	eti.soca_oid_soli_cabe = sol.oid_soli_cabe
   		   AND 	sol.oid_soli_cabe = pic.soca_oid_soli_cabe
    </select>

	<update id="updateEtiqueta" parameterClass="java.util.Map">
    	UPDATE	ape_etiqu 
           SET 	estp_oid_esta_pedi = DECODE( (SELECT ind_orig_cheq 
                                       		    FROM ape_lista_picad_cabec 
                                               WHERE soca_oid_soli_cabe = #oidConsolidado# ) ,NULL,7,2)
         WHERE  pais_oid_pais      = #oidPais# 
   		   AND 	soca_oid_soli_cabe = #oidConsolidado# 
   		   AND 	num_caja           = #numCaja#          
	</update>

    <update id="updateListadoPicado" parameterClass="java.util.Map">
		UPDATE	ape_lista_picad_cabec 
	       SET	val_nomb_fact = DECODE( val_nomb_fact, NULL, #usuario#, val_nomb_fact ),
       			fec_hora_fina_emba = DECODE( fec_hora_fina_emba, NULL, SYSDATE, fec_hora_fina_emba)
         WHERE 	soca_oid_soli_cabe  =  #oidConsolidado#           
	</update>	
	
	<select id="getNroCajasDelPedidoNoRecibidas" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT	COUNT(1)
  		  FROM 	ped_solic_cabec A, 
  		  		ape_etiqu B, 
  		  		ape_lista_picad_cabec C
 		 WHERE 	A.PAIS_OID_PAIS = #oidPais#
   		   AND 	A.PAIS_OID_PAIS = B.PAIS_OID_PAIS
   		   AND 	A.SOCA_OID_SOLI_CABE = B.SOCA_OID_SOLI_CABE
   		   AND 	A.SOCA_OID_SOLI_CABE = C.SOCA_OID_SOLI_CABE
   		   AND 	A.OID_SOLI_CABE = #oidSoli#  
    	   AND 	B.ESTP_OID_ESTA_PEDI != 2
	</select>

	<parameterMap id="paramExecuteActualizarSeguimientoPedidos" class="java.util.Map">
		<parameter property="oidSoli"    				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidConsolidado"    		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="nroHito"    				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codListaPicado"    		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="indicadorTerminado"    	jdbcType="NUMBER" javaType="java.lang.Integer"  mode="IN"/>	
	</parameterMap>	
	<procedure id="executeActualizarSeguimientoPedidos" parameterMap="paramExecuteActualizarSeguimientoPedidos">
		{call APE_PKG_PROCE.PED_ACTUA_SEGUI_PEDID(?,?,?,null,?,?) }
	</procedure>
    
    <insert id="insertTipoCajaEmbalaje" parameterClass="java.util.Map">
		INSERT INTO APE_TIPO_CAJA_EMBAL
		       (oid_tipo_caja_emba              ,    val_tipo_caja                ,         num_capa                 ,                num_capa_mini,
		        ind_cubi                        ,    num_porc_segu                ,         num_nive_apli            ,                num_etiq     ,    
		        val_alto                        ,    val_larg                     ,         val_anch                 ,                pais_oid_pais,
		        unmd_oid_unid_medi_capa         ,    unmd_oid_unid_medi_exte      ,         ind_caja_prod_term       ,                ticp_oid_tipo_caja_prod)          
		VALUES
		      (#oidTipoCajaEmb#  			    ,    #codigoTipoCaja#                      ,TO_NUMBER(#capacidad#,'99999999.99')  ,TO_NUMBER(#capacidadMinima#,'99999999.99'),
		       #indicadorCubicaje#              ,TO_NUMBER(#porcentajeSeguridad#,'999.99') ,TO_NUMBER(#nivelAplicacion#,'9999.99'),                #numEtiquetasCaja#        ,
		       TO_NUMBER(#alto#,'9999.99')      ,TO_NUMBER(#largo#,'9999.99')              ,TO_NUMBER(#ancho#,'9999.99')          ,                #oidPais#                 ,
		       #oidUnidMedidaCapa#              ,    #oidUnidMedidaExte#                   ,         #indicadorCajaMaestra#       ,                #oidTipoCajaProd# 
		      )
    </insert>

	<parameterMap id="paramDeleteTipoCajaEmbalaje" class="java.util.Map">
		<parameter property="oidTipoCajaEmb"       	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="valError"     		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>			
		<parameter property="nomTabla"      		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
	</parameterMap>	
	<procedure id="deleteTipoCajaEmbalaje" parameterMap="paramDeleteTipoCajaEmbalaje">
		{call APE_PKG_PROCE.APE_PR_ELIMI_TIPO_CAEMB(?,?,?) }
	</procedure>
    
    <update id="updateTipoCajaEmbalaje" parameterClass="java.util.Map">
		UPDATE APE_TIPO_CAJA_EMBAL
		SET    val_tipo_caja               = #codigoTipoCaja#,
		       num_capa                    = TO_NUMBER(#capacidad#,'99999999.99'),
		       num_capa_mini               = TO_NUMBER(#capacidadMinima#,'99999999.99'),
		       ind_cubi                    = #indicadorCubicaje#,    
		       num_porc_segu               = TO_NUMBER(#porcentajeSeguridad#,'999.99'),         
		       num_nive_apli               = TO_NUMBER(#nivelAplicacion#,'9999.99'),              
		       num_etiq                    = #numEtiquetasCaja#,    
		       val_alto                    = TO_NUMBER(#alto#,'9999.99'),    
		       val_larg                    = TO_NUMBER(#largo#,'9999.99'),         
		       val_anch                    = TO_NUMBER(#ancho#,'9999.99'),                
		       unmd_oid_unid_medi_capa     = #oidUnidMedidaCapa#,    
		       unmd_oid_unid_medi_exte     = #oidUnidMedidaExte#,         
		       ind_caja_prod_term          = #indicadorCajaMaestra#,                
		       ticp_oid_tipo_caja_prod     = #oidTipoCajaProd#
		WHERE  oid_tipo_caja_emba          = #oidTipoCajaEmb#
    </update>
    
    <select id="getNextOidTipoCajaEmbalaje" parameterClass="java.util.Map" resultClass="string">
    	SELECT ape_tcem_seq.nextval FROM DUAL
    </select>

	<resultMap id="tipoCajaEmbalajeObjectResult" class="tipoCajaEmbalaje">
  			<result property="oidTipoCaja"  		    		column="OID_TIPOCAJA"/>
  			<result property="codigoTipoCajaEmbalaje"			column="TIPO_CAJA"/>
	 		<result property="descripcionTipoCaja"  			column="DESC_TIPOCAJA"/>
	 		<result property="capacidad"          				column="CAPACIDAD"/>
	 		<result property="capacidadMinima"  				column="CAPACIDAD_MIN"/>
	 		<result property="codigoUnidMedidaCapa"  			column="COD_UNID1"/> 
	 		<result property="indicadorCubicaje"  				column="INDCUBICAJE"/>
	 		<result property="porcentajeSeguridad"  			column="NUMPORCENTAJE"/>
	 		<result property="nivelAplicacion"  				column="NUMNIVELAPLICA"/>
	 		<result property="numEtiquetasCaja"  				column="NUMETIQUETA"/>
	 		<result property="indicadorCajaMaestra"         	column="INDCAJAMAESTRA"/>
	 		<result property="codigoTipoCajaProducto"  			column="COD_TIPOPROD"/>
	 		<result property="codigoUnidMedidaExte"  			column="COD_UNID2"/>
	 		<result property="alto"  							column="ALTO"/>
	 		<result property="largo"  							column="LARGO"/>
	 		<result property="ancho"  							column="ANCHO"/>
    </resultMap>
  
    <select id="getTipoCajaEmbalajeObject" parameterClass="java.util.Map" resultMap="tipoCajaEmbalajeObjectResult">
		SELECT 	tc.oid_tipo_caja_emba OID_TIPOCAJA,
           	 	tc.val_tipo_caja      TIPO_CAJA,
		   		s.val_i18n            DESC_TIPOCAJA,
           		tc.num_capa           CAPACIDAD,
           		tc.num_capa_mini      CAPACIDAD_MIN,
          		(SELECT cod_unid_medi 
           		FROM MAE_UNIDA_MEDID
           		WHERE oid_unid_medi = tc.unmd_oid_unid_medi_capa 
           		AND   pais_oid_pais = tc.pais_oid_pais) as COD_UNID1,
           		tc.ind_cubi           INDCUBICAJE,
           		tc.num_porc_segu      NUMPORCENTAJE,
           		tc.num_nive_apli      NUMNIVELAPLICA,
           		tc.num_etiq           NUMETIQUETA,
           		tc.ind_caja_prod_term INDCAJAMAESTRA,
          		(SELECT cod_caja 
           		FROM   app_tipo_caja_produ 
           		WHERE  oid_tipo_caja_prod = tc.ticp_oid_tipo_caja_prod
           		AND    pais_oid_pais      = tc.pais_oid_pais) as COD_TIPOPROD,
          		(SELECT cod_unid_medi 
           		FROM   MAE_UNIDA_MEDID
           		WHERE  oid_unid_medi = tc.unmd_oid_unid_medi_exte
           		AND    pais_oid_pais = tc.pais_oid_pais) as COD_UNID2,
           		tc.val_alto          ALTO,
           		tc.val_larg          LARGO,
           		tc.val_anch          ANCHO
		FROM    APE_TIPO_CAJA_EMBAL tc,
		        GEN_I18N_SICC_PAIS s
		WHERE   tc.oid_tipo_caja_emba = s.val_oid
		AND     s.attr_enti='APE_TIPO_CAJA_EMBAL'
		AND     tc.pais_oid_pais = #oidPais#
		AND     tc.oid_tipo_caja_emba = #oidTipoCajaEmb#
    </select>
    
    <select id="getObtenerCodigoTipoCaja" parameterClass="java.util.Map" resultClass="string">
		SELECT val_tipo_caja as CODIGO
		FROM   APE_TIPO_CAJA_EMBAL
		WHERE  oid_tipo_caja_emba = #oidTipoCajaEmb#
    </select>
    
    <delete id="deleteOrdenAnaquelDetbyMapaCent" parameterClass="java.util.Map">
		DELETE FROM ape_orden_anaqu_detal 
         WHERE oaca_oid_anaq_cabe = #oidMapaOrdenCab#
           AND mcdd_oid_mapa_cent_dist_deta = #oidMapaCentroDet#
	</delete>
	
	<select id="validaExisteMapaAnaquelDefault" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)
  	      FROM ape_orden_anaqu_cabec oac
         WHERE oac.mzca_oid_mapa_zona_cabe = #oidMapaZona#
           AND oac.val_defe = 1
	</select>
	
	<update id="updateMapaOrdenAnaquelDefault" parameterClass="java.util.Map">
		UPDATE ape_orden_anaqu_cabec 
           SET val_defe = #valorDefault#
         WHERE oid_anaq_cabe = #oidMapaOrden#
	</update>
	
	<select id="validaExisteOrdenAnaquelDefault" parameterClass="java.util.Map" resultClass="string">
		SELECT oac.oid_anaq_cabe
  	      FROM ape_orden_anaqu_cabec oac
         WHERE oac.mzca_oid_mapa_zona_cabe = #oidMapaZona#
           AND oac.val_defe = 1
	</select>
	
	<select id="getOidPeriodoSiguiente" parameterClass="java.util.Map" resultClass="string">
		SELECT EVI_PKG_EJECU_VIRTU.EVI_FN_DEVUE_ID_PERIO_NSGTE(#codPeriodo#,
															   #oidPais#,
															   GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
															   GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#),
															   #numPeriodo#
															   ) 
		  FROM DUAL
	</select>
	
	<resultMap id="EmitirAlarmaProductoResult"  class="java.util.HashMap"  >                                                                       
    	<result property="oidSAP"				column="OID_SAP"/>
    	<result property="codSAP"				column="COD_SAP"/>
    	<result property="desSAP"				column="DES_SAP"/>
    	<result property="valAlto"				column="VAL_ALTO"/>
    	<result property="valLargo"				column="VAL_LARGO"/>
    	<result property="valAncho"				column="VAL_ANCHO"/>
    	<result property="umdDimension"			column="UMD_DIMENSION"/>
    	<result property="valVolumen"			column="VAL_VOLUMEN"/>
    	<result property="umdVolumen"			column="UMD_VOLUMEN"/>
    	<result property="valPeso"				column="VAL_PESO"/>
    	<result property="umdPeso"				column="UMD_PESO"/>
    	<result property="indAFP"				column="IND_AFP"/>
    	<result property="uniCaja"				column="UNI_CAJA"/>
  	</resultMap>
    <select id="getEmitirAlarmaProductoList" parameterClass="java.util.Map" resultMap="EmitirAlarmaProductoResult">
     	SELECT  DISTINCT
        		prod.oid_prod                         							  	OID_SAP,
        		prod.cod_sap                          							  	COD_SAP,
        		NVL(i18.val_i18n,'NULO')  		     	                          	DES_SAP,
     			DECODE(prod.val_dime_alto,NULL,'NULO',prod.val_dime_alto)  			VAL_ALTO,
        		DECODE(prod.val_dime_larg,NULL,'NULO',prod.val_dime_larg)  			VAL_LARGO,
        		DECODE(prod.val_dime_anch,NULL,'NULO',prod.val_dime_anch)  			VAL_ANCHO,
        		NVL(umd1.cod_unid_medi,'NULO')     			                      	UMD_DIMENSION,
        		DECODE(prod.val_volu,NULL,'NULO',prod.val_volu)            			VAL_VOLUMEN,
        		NVL(umd2.cod_unid_medi,'NULO')      		                      	UMD_VOLUMEN,
        		DECODE(prod.val_peso,NULL,'NULO',prod.val_peso)            			VAL_PESO,
        		NVL(umd3.cod_unid_medi,'NULO')     				                    UMD_PESO,
        		NVL(prod.cod_ind_dent_caja,'NULO')                		    	  	IND_AFP,
        		DECODE(prod.num_unid_caja,NULL,'NULO',prod.num_unid_caja)  			UNI_CAJA
  		  FROM  pre_matri_factu_cabec matricab,
        		pre_ofert ofer,
        		pre_ofert_detal oferdet,
        		mae_produ prod,
        		gen_i18n_sicc_pais i18,
        		mae_unida_medid umd1,
        		mae_unida_medid umd2,
        		mae_unida_medid umd3
 		 WHERE  prod.oid_prod = oferdet.prod_oid_prod
   		   AND  oferdet.ofer_oid_ofer = ofer.oid_ofer
   		   AND  ofer.mfca_oid_cabe = matricab.oid_cabe
   		   AND  matricab.perd_oid_peri IN (#oidPeriodo# , #oidPeriodoNext#)
   		   AND  prod.pais_oid_pais = #oidPais#
   		   AND( prod.val_dime_alto IS NULL OR prod.val_dime_alto = 0 OR 
        		prod.val_dime_larg IS NULL OR prod.val_dime_larg = 0 OR 
        		prod.val_dime_anch IS NULL OR prod.val_dime_anch = 0 OR 
        		prod.val_volu IS NULL OR 
        		prod.val_volu = 0 OR prod.unmd_oid_unid_medi IS NULL OR 
        		prod.unmd_oid_unid_medi = 0 OR prod.val_peso IS NULL OR 
        		prod.val_peso = 0 OR prod.unmd_oid_unid_medi_peso IS NULL OR 
        		prod.unmd_oid_unid_medi_peso = 0)
   		   AND  i18.attr_enti = #nombreTablaMaeProducto#
   		   AND  i18.attr_num_atri = 1
   		   AND  i18.idio_oid_idio = #oidIdiomaISO#
   		   AND  i18.val_oid = prod.oid_prod
   		   AND  umd1.oid_unid_medi(+) = prod.unmd_oid_unid_medi_dime
   		   AND  umd1.pais_oid_pais(+) = #oidPais#
   	       AND  umd2.oid_unid_medi(+) = prod.unmd_oid_unid_medi
   		   AND  umd2.pais_oid_pais(+) = #oidPais#
   	       AND  umd3.oid_unid_medi(+) = prod.unmd_oid_unid_medi_peso
   		   AND  umd3.pais_oid_pais(+) = #oidPais#
	 UNION
     	SELECT 	DISTINCT
       			prod2.oid_prod                         						 	    OID_SAP,
       			prod2.cod_sap                          						 	    COD_SAP,
      			NVL(i18.val_i18n,'NULO')  		     	                          	DES_SAP,
    			DECODE(prod2.val_dime_alto,NULL,'NULO',prod2.val_dime_alto)  		VAL_ALTO,
        		DECODE(prod2.val_dime_larg,NULL,'NULO',prod2.val_dime_larg)  		VAL_LARGO,
        		DECODE(prod2.val_dime_anch,NULL,'NULO',prod2.val_dime_anch)  		VAL_ANCHO,
       			NVL(umd1.cod_unid_medi,'NULO')     			                      	UMD_DIMENSION,
       			DECODE(prod2.val_volu,NULL,'NULO',prod2.val_volu)            		VAL_VOLUMEN,
       			NVL(umd2.cod_unid_medi,'NULO')      		                      	UMD_VOLUMEN,
       			DECODE(prod2.val_peso,NULL,'NULO',prod2.val_peso)            		VAL_PESO,
       			NVL(umd3.cod_unid_medi,'NULO')     				                    UMD_PESO,
       			NVL(prod2.cod_ind_dent_caja,'NULO')                		       		IND_AFP,
        		DECODE(prod2.num_unid_caja,NULL,'NULO',prod2.num_unid_caja)  		UNI_CAJA
  		  FROM 	pre_matri_factu_cabec matricab,
       			pre_ofert ofer,
       			pre_ofert_detal oferdet,
       			pre_ofert_detal oferdet2,
       			mae_produ prod,
       			mae_produ prod2,
       			pre_matri_factu mf1,
       			pre_matri_factu mf2,
       			pre_matri_reemp mree,
        		gen_i18n_sicc_pais i18,
        		mae_unida_medid umd1,
        		mae_unida_medid umd2,
        		mae_unida_medid umd3
 	     WHERE  prod.oid_prod = oferdet.prod_oid_prod
   		   AND 	oferdet.ofer_oid_ofer = ofer.oid_ofer
   		   AND 	ofer.mfca_oid_cabe = matricab.oid_cabe
   		   AND 	matricab.perd_oid_peri IN (#oidPeriodo# , #oidPeriodoNext#)
   		   AND 	ofer.mfca_oid_cabe = mf1.mfca_oid_cabe
   		   AND 	oferdet.oid_deta_ofer = mf1.ofde_oid_deta_ofer
   		   AND 	mree.mafa_oid_cod_ppal = mf1.oid_matr_fact
   		   AND 	mree.mafa_oid_cod_reem = mf2.oid_matr_fact
   		   AND 	mf2.ofde_oid_deta_ofer = oferdet2.oid_deta_ofer
   		   AND 	oferdet2.prod_oid_prod = prod2.oid_prod
   		   AND 	prod.pais_oid_pais = #oidPais#
   		   AND (prod2.val_dime_alto IS NULL OR prod2.val_dime_alto = 0 OR
        		prod2.val_dime_larg IS NULL OR prod2.val_dime_larg = 0 OR
        		prod2.val_dime_anch IS NULL OR prod2.val_dime_anch = 0 OR
        		prod2.val_volu IS NULL OR
        		prod2.val_volu = 0 OR prod2.unmd_oid_unid_medi IS NULL OR
        		prod2.unmd_oid_unid_medi = 0 OR prod2.val_peso IS NULL OR
        		prod2.val_peso = 0 OR prod2.unmd_oid_unid_medi_peso IS NULL OR
        		prod2.unmd_oid_unid_medi_peso = 0)
   		   AND  i18.attr_enti = #nombreTablaMaeProducto#
   		   AND  i18.attr_num_atri = 1
   		   AND  i18.idio_oid_idio = #oidIdiomaISO#
   		   AND  i18.val_oid = prod2.oid_prod
   		   AND  umd1.oid_unid_medi(+) = prod.unmd_oid_unid_medi_dime
   		   AND  umd1.pais_oid_pais(+) = #oidPais#
   		   AND  umd2.oid_unid_medi(+) = prod.unmd_oid_unid_medi
   		   AND  umd2.pais_oid_pais(+) = #oidPais#
   		   AND  umd3.oid_unid_medi(+) = prod.unmd_oid_unid_medi_peso
   	       AND  umd3.pais_oid_pais(+) = #oidPais#    
    </select>
	
	<resultMap id="usuarioAlarmaProductoResult"  class="java.util.HashMap"  >
		<result property="usuarioAlarma"		column="VAL_MAIL"/>
	</resultMap>
	<select id="getMailAlarmaProductoList" parameterClass="java.util.Map"  resultMap="usuarioAlarmaProductoResult">
		SELECT 	DISTINCT usulin.val_mail VAL_MAIL
           FROM ape_usuar_alarm_linea usulin, 
       			ape_linea_armad lin
          WHERE usulin.liar_oid_line_arma = lin.oid_line_arma
            AND lin.ccdi_oid_conf_cent_dist = #oidCentro# 
	</select>
	
    <resultMap id="consultaFacturasCajasResult" class="java.util.HashMap">
    		<result property="fechaFactura"  		    		column="FECHA_FACTURA"/>
  			<result property="numUnicoCaja"  		    		column="NUM_UNICOCAJA"/>
  			<result property="numConsolidado"					column="NUM_CONSOLIDADO"/>
	 		<result property="numCaja"	  						column="NUM_CAJA"/>
	 		<result property="numOla"  							column="NUM_OLA"/>
	 		<result property="regionZona"          				column="RRZZZZ"/>
	 		<result property="consultora"  						column="CONSULTORA"/> 
	 		<result property="chequeo"  						column="CHEQUEO"/>
	 		<result property="ms"  						        column="MS"/>
	 		<result property="oidListaPicado" 					column="OID_LIST_PICAD"/>
    </resultMap>
	
    <select id="getConsultaFacturasCajasList" parameterClass="java.util.Map" resultMap="consultaFacturasCajasResult">
		SELECT TO_CHAR(picad.fec_factu,'DD/MM/YYYY')                                       FECHA_FACTURA,
	           etqu.num_secu                                                               NUM_UNICOCAJA,
		       ped.val_nume_soli                                                           NUM_CONSOLIDADO,
		       etqu.num_caja                                                               NUM_CAJA,
		       picad.num_ola                                                               NUM_OLA,
	          (SELECT reg.cod_regi 
	           FROM   ZON_ZONA  zon,
	           ZON_REGIO reg
	           WHERE  zon.zorg_oid_regi = reg.oid_regi
	           AND    zon.oid_zona = etqu.zzon_oid_zona)||
	          (SELECT zon1.cod_zona
	           FROM   ZON_ZONA zon1 
	           WHERE  zon1.oid_zona= etqu.zzon_oid_zona)                                   RRZZZZ,
	           RTRIM(mcli.val_ape1)||' '||RTRIM(mcli.val_ape2)||', '||RTRIM(mcli.val_nom1) CONSULTORA,
	           CASE WHEN etqu.val_text_cheq IS NOT NULL 
	           THEN 'SI' ELSE 'NO' END                                                     CHEQUEO,
	           CASE WHEN tcem.ind_caja_prod_term = 0
	           THEN 'NO' ELSE 'SI' END                                                     MS,
	           picad.oid_list_pica_cabe                                                    OID_LIST_PICAD
	    FROM   APE_ETIQU                  etqu,
	           APE_LISTA_PICAD_CABEC      picad,
	           PED_SOLIC_CABEC            ped,
	           MAE_CLIEN                  mcli,
	           APE_TIPO_CAJA_EMBAL        tcem
	    WHERE  etqu.soca_oid_soli_cabe      = picad.soca_oid_soli_cabe
	    AND    etqu.soca_oid_soli_cabe      = ped.oid_soli_cabe
	    AND    picad.clie_oid_clie          = mcli.oid_clie
	    AND    etqu.tcem_oid_tipo_caja_emba = tcem.oid_tipo_caja_emba (+)          
	    AND    TRUNC(picad.fec_factu)       = TO_DATE(#fechaFactura#,'DD/MM/YYYY')
	            
        <isNotEmpty property="nroEtiqueta">
		 AND    etqu.num_secu		= #nroEtiqueta#
		</isNotEmpty>

        <isNotEmpty property="nroConsolidado">
		 AND    ped.val_nume_soli   = #nroConsolidado#
		</isNotEmpty>
		
		ORDER BY etqu.num_etiq ASC	
    </select>

    <resultMap id="productosFacturasCajasResult" class="java.util.HashMap">
  			<result property="numAnaquel"	  		    		column="NUM_ANAQUEL"/>
  			<result property="codigoSAP"						column="CODIGO_SAP"/>
	 		<result property="descripcionProducto"				column="DESCR_PROD"/>
	 		<result property="numUnidadPicado"     				column="NUM_UNIDPICAD"/>
    </resultMap>
    
    <select id="getProductosFacturasCajasList" parameterClass="java.util.Map" resultMap="productosFacturasCajasResult">
		SELECT DISTINCT
		       mpcd.num_anaq                           NUM_ANAQUEL,
              (SELECT prod.cod_sap
               FROM MAE_PRODU prod
               WHERE prod.oid_prod=lpdt.prod_oid_prod) CODIGO_SAP,
              (SELECT s.val_i18n
               FROM GEN_I18N_SICC_PAIS s
               WHERE s.attr_enti='MAE_PRODU'
               AND   s.val_oid  = lpdt.prod_oid_prod)  DESCR_PROD,
		       LPDT.NUM_UNID_PROD                      NUM_UNIDPICAD
		FROM   APE_LISTA_PICAD_CABEC              lpca,
               PED_SOLIC_CABEC                    soca,
               APE_LISTA_PICAD_DETAL              lpdt,
		       APE_MAPA_CENTR_DISTR_DETAL         mpcd,
               APE_ETIQU                          etiq,
               APE_TIPO_CAJA_EMBAL                tcem
		WHERE  lpca.soca_oid_soli_cabe          = soca.oid_soli_cabe 
        AND    lpca.oid_list_pica_cabe          = lpdt.lpca_oid_list_pica_cabe
        AND    lpdt.mcdd_oid_mapa_cent_dist_deta= mpcd.oid_mapa_cent_dist_deta
        AND    lpca.oid_list_pica_cabe          = etiq.lpca_oid_list_pica_cabe
        AND    etiq.tcem_oid_tipo_caja_emba     =  tcem.oid_tipo_caja_emba 
        AND    lpca.oid_list_pica_cabe          = #oidListaPicado#
        AND    lpdt.num_caja                    = #nroCaja#
		ORDER BY mpcd.num_anaq    
    </select>

	<resultMap id="productosFacturasCajasObjectResult" class="consultaFacturasCajas">
  			<result property="numeroUnicoCaja"		    		column="NUM_UNICOCAJA"/>
  			<result property="numeroConsolidado"  				column="NUM_CONSOLIDADO"/>
	 		<result property="numeroCaja"  						column="NUM_CAJA"/>
	 		<result property="tipoCaja"   					  	column="TIPO_CAJA"/>
	 		<result property="numeroOla"  						column="NUM_OLA"/>
	 		<result property="numeroSecuencia"		  			column="NUM_SECU"/> 
	 		<result property="fechaFactura" 		  			column="FECHA_FACTURA"/>
	 		<result property="regionZona" 	     	  			column="RRZZZZ"/>
	 		<result property="consultora" 	     	  			column="CONSULTORA"/>
	 		<result property="chequeo" 	     	  	    		column="CHEQUEO"/>
    </resultMap>
    
    <select id="getProductosFacturasCajasObject" parameterClass="java.util.Map" resultMap="productosFacturasCajasObjectResult">
		SELECT etqu.num_secu                          NUM_UNICOCAJA,
		       ped.val_nume_soli                      NUM_CONSOLIDADO,
		       etqu.num_caja                          NUM_CAJA,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_TIPO_CAJA_EMBAL',etqu.tcem_oid_tipo_caja_emba,'P') TIPO_CAJA,
		       picad.num_ola                          NUM_OLA,
		       etqu.num_secu                          NUM_SECU,
               TO_CHAR(picad.fec_factu,'DD/MM/YYYY')  FECHA_FACTURA,
              (SELECT reg.cod_regi 
               FROM   ZON_ZONA  zon,
           	          ZON_REGIO reg
               WHERE  zon.zorg_oid_regi = reg.oid_regi
               AND    zon.oid_zona = etqu.zzon_oid_zona)||'-'||
              (SELECT zon1.cod_zona
               FROM   ZON_ZONA zon1 
               WHERE  zon1.oid_zona= etqu.zzon_oid_zona) RRZZZZ,
               RTRIM(mcli.val_ape1)||' '||RTRIM(mcli.val_ape2)||', '||RTRIM(mcli.val_nom1) CONSULTORA,
               CASE WHEN etqu.val_text_cheq IS NOT NULL 
               THEN 'SI' ELSE 'NO' END                CHEQUEO
		FROM   APE_ETIQU                              etqu,
		       APE_LISTA_PICAD_CABEC                  picad,
		       PED_SOLIC_CABEC                        ped,
               MAE_CLIEN                              mcli
		WHERE  etqu.soca_oid_soli_cabe = picad.soca_oid_soli_cabe
		AND    etqu.soca_oid_soli_cabe = ped.oid_soli_cabe
        AND    picad.clie_oid_clie     = mcli.oid_clie
        AND    picad.oid_list_pica_cabe= #oidListaPicado#
        AND	   etqu.num_caja 	       = #nroCaja#
    </select>

  	<select id="getTipoClienteList" resultMap="baseResult">
		select a.oid_tipo_clie as CODIGO,b.val_i18n as DESCRIPCION
		from mae_tipo_clien a,gen_i18n_sicc_comun b
		where a.oid_tipo_clie=b.val_oid
		and b.attr_enti='MAE_TIPO_CLIEN'
	</select>

	<select id="getSubTiClienteList" parameterClass="java.util.Map"  resultMap="baseResult">
		select c.oid_subt_clie as CODIGO,b.val_i18n as DESCRIPCION
		from mae_subti_clien c,gen_i18n_sicc_comun b
		where c.oid_subt_clie=b.val_oid
		and b.attr_enti='MAE_SUBTI_CLIEN'
		and ( c.ticl_oid_tipo_clie = #oid# OR #oid# IS NULL )
	</select>

	<select id="getTipoClasificacionByOidSubTipoClienteList" parameterClass="java.util.Map"  resultMap="baseResult">
		select d.oid_tipo_clas as CODIGO,b.val_i18n as DESCRIPCION
		from mae_tipo_clasi_clien d,gen_i18n_sicc_comun b
		where d.oid_tipo_clas = b.val_oid
		and b.attr_enti = 'MAE_TIPO_CLASI_CLIEN'
		and ( d.sbti_oid_subt_clie = #oid# OR #oid# IS NULL )
	</select>
  
	<select id="getClasificacionByOidTipoClasificacionList" parameterClass="java.util.Map"  resultMap="baseResult">
		select e.oid_clas as CODIGO,b.val_i18n as DESCRIPCION
		from mae_clasi e,gen_i18n_sicc_comun b
		where e.oid_clas = b.val_oid
		and b.attr_enti = 'MAE_CLASI'
		and ( e.tccl_oid_tipo_clas = #oid# OR #oid# IS NULL )
	</select>

    <resultMap id="ConfiTextoVariaResult"  class="java.util.HashMap"  >
        <result property="oidConfTextVari"       column="OID_CONF_TEXT_VARI"/>
        <result property="desTipoCliente"        column="DESTIPOCLIENTE"/>
        <result property="desSubTipoCliente"	 column="DESSUBTIPOCLIENTE"/>
        <result property="desTipoClasificacion"	 column="DESTIPOCLASIFICACION"/>
        <result property="desClasificacion"	     column="DESCLASIFICACION"/>
    	<result property="valTextVari"	         column="VAL_TEXT_VARI"/>
    	<result property="codigoTipoCliente"     column="OID_TIPO_CLIE"/>
    	<result property="codigoSubTipoCliente"	 column="OID_SUBT_CLIE"/>
    	<result property="codigoTipoClasificacion"	column="OID_TIPO_CLAS"/>
    	<result property="codigoClasificacion"	    column="OID_CLAS"/>
  	</resultMap>
    
    <select id="getConfiTextoVariaList" parameterClass="java.util.Map" resultMap="ConfiTextoVariaResult">
    SELECT AA.oid_conf_text_vari  OID_CONF_TEXT_VARI,
   ( SELECT b.val_i18n as DESCRIPCION
  		 FROM mae_tipo_clien a,gen_i18n_sicc_comun b
	  WHERE a.oid_tipo_clie=b.val_oid
  	 	AND b.attr_enti='MAE_TIPO_CLIEN'
      AND a.oid_tipo_clie=AA.TICL_OID_TIPO_CLIE
    ) DESTIPOCLIENTE ,
   ( SELECT b.val_i18n as DESCRIPCION
		 FROM mae_subti_clien c,gen_i18n_sicc_comun b
		WHERE c.oid_subt_clie=b.val_oid
  		AND b.attr_enti='MAE_SUBTI_CLIEN'
	  	AND c.ticl_oid_tipo_clie = AA.TICL_OID_TIPO_CLIE
      AND C.Oid_Subt_Clie      = AA.SBTI_OID_SUBT_CLIE
   ) DESSUBTIPOCLIENTE
   ,
   ( SELECT b.val_i18n as DESCRIPCION
		  FROM mae_tipo_clasi_clien d,gen_i18n_sicc_comun b
		WHERE d.oid_tipo_clas      = b.val_oid
  		AND b.attr_enti          = 'MAE_TIPO_CLASI_CLIEN'
	  	AND d.sbti_oid_subt_clie = AA.SBTI_OID_SUBT_CLIE
      AND d.oid_Tipo_Clas      = AA.TCCL_OID_TIPO_CLAS
   ) DESTIPOCLASIFICACION
   ,
	( SELECT b.val_i18n as DESCRIPCION
  	FROM mae_clasi e,gen_i18n_sicc_comun b
	WHERE e.oid_clas = b.val_oid
		AND b.attr_enti = 'MAE_CLASI'
    AND e.tccl_oid_tipo_clas = AA.TCCL_OID_TIPO_CLAS
    AND e.oid_clas           = AA.CLAS_OID_CLAS
   ) DESCLASIFICACION ,    
     AA.VAL_TEXT_VARI ,
     AA.TICL_OID_TIPO_CLIE OID_TIPO_CLIE ,
     AA.SBTI_OID_SUBT_CLIE OID_SUBT_CLIE ,
     AA.TCCL_OID_TIPO_CLAS OID_TIPO_CLAS ,
     AA.CLAS_OID_CLAS      OID_CLAS    
   FROM ape_confi_texto_varia AA 
   WHERE	 
    AA.PAIS_OID_PAIS      =  #oidPais#      AND
    ( AA.TICL_OID_TIPO_CLIE =  #oidTipoClie# OR #oidTipoClie# IS NULL ) AND
    ( AA.SBTI_OID_SUBT_CLIE =  #oidSubtClie# OR #oidSubtClie# IS NULL ) AND
    ( AA.TCCL_OID_TIPO_CLAS =  #oidTipoClas# OR #oidTipoClas# IS NULL ) AND
    ( AA.CLAS_OID_CLAS      =  #oidClas#     OR #oidClas#     IS NULL ) 
    </select>

   	<select id="getNextOidConfiguracionTextosVariables" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT APE_CTVA_SEQ.NEXTVAL FROM  dual
	</select>
		
	<insert id="insertConfiguracionTextosVariables" parameterClass="java.util.Map">
		INSERT INTO ape_confi_texto_varia 
		( oid_conf_text_vari, val_text_vari     , pais_oid_pais      ,
		  ticl_oid_tipo_clie, sbti_oid_subt_clie, tccl_oid_tipo_clas ,    
          clas_oid_clas	)
		VALUES 
		( #oidSec#          , #valTextVari#     , #oidPais#         ,
		  #oidTipoClie#     , #oidSubtClie#     , #oidTipoClas#     ,   
          #oidClas# 		)
	</insert>
		
	<update id="updateConfiguracionTextosVariables" parameterClass="java.util.Map">
		UPDATE 	ape_confi_texto_varia
           SET 	val_text_vari = #valTextVari#
		WHERE  oid_conf_text_vari = #oidConfTextVari# AND
		       pais_oid_pais      = #oidPais#  
	</update>	

	<delete id="deleteConfiguracionTextosVariables" parameterClass="java.util.Map">
		DELETE FROM ape_confi_texto_varia
		WHERE  oid_conf_text_vari = #oidConfTextVari# AND
		       pais_oid_pais      = #oidPais#  
	</delete>

                  
	<select id="getExisteConfiguracionTextosVariablesCD" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
          FROM ape_confi_texto_varia 
       WHERE	 
         PAIS_OID_PAIS      =  #oidPais#      AND
         TICL_OID_TIPO_CLIE =  #oidTipoClie#  AND
         SBTI_OID_SUBT_CLIE =  #oidSubtClie#  AND
         TCCL_OID_TIPO_CLAS =  #oidTipoClas#  AND
         CLAS_OID_CLAS      =  #oidClas# 
	</select>	
		
	<resultMap id="tipoAnaquelProductoResult"  class="java.util.HashMap"  >
		<result property="oidProdAnaq"		    column="OID_PROD_ANAQ"/>
		<result property="numPrioridad"			column="NUM_PRIORIDAD"/>
		<result property="codTipoAnaquel"		column="COD_TIPO_ANAQUEL"/>
		<result property="desTipoAnaquel"		column="DES_TIPO_ANAQUEL"/>
	</resultMap>
	<select id="getTipoAnaquelProductoList" parameterClass="java.util.Map"  resultMap="tipoAnaquelProductoResult">
		SELECT 	pa.oid_prod_anaq  				OID_PROD_ANAQ,
       			to_char(PA.NUM_NUME_PRIO) 		NUM_PRIORIDAD,
       			ta.cod_tipo_anaq  				COD_TIPO_ANAQUEL,
       		   (SELECT b.val_i18n
          		  FROM gen_i18n_sicc_comun b
                 WHERE ta.oid_tipo_anaq = b.val_oid
           	       AND b.attr_enti = #nombreTablaTipoAnaquel#
           		   AND b.attr_num_atri = 1
                   AND b.idio_oid_idio = 1) 	DES_TIPO_ANAQUEL	
          FROM	ape_produ_anaqu pa,
       			ape_tipo_anaqu ta
         WHERE pa.prod_oid_prod = #oidSAP#
           AND pa.tian_oid_tipo_anaq = ta.oid_tipo_anaq
      ORDER BY PA.NUM_NUME_PRIO
	</select>
	
	<insert id="insertTipoAnaquelProducto" parameterClass="java.util.Map">
		INSERT INTO ape_produ_anaqu(
   			oid_prod_anaq,
  			prod_oid_prod,
  			num_nume_prio,
  			tian_oid_tipo_anaq
		)
		VALUES(
  			APE_PRAN_SEQ.NEXTVAL,
  			#oidSAP#,
  			to_number(#numPrioridad#),
  			#oidTipoAnaquel#
		)
	</insert>
	
	<delete id="deleteTipoAnaquelProducto" parameterClass="java.util.Map">
		DELETE FROM ape_produ_anaqu a
         WHERE a.oid_prod_anaq = #oidProdAnaq#
	</delete>
	
	<delete id="deleteTipoAnaquelbyOidProducto"  parameterClass="string" >
		DELETE FROM ape_produ_anaqu a
         WHERE a.prod_oid_prod = #value# 
	</delete>
	
	<update id="updateTipoAnaquelProducto" parameterClass="java.util.Map">
		UPDATE 	ape_produ_anaqu
           SET 	num_nume_prio = to_number(#numPrioridad#)
         WHERE 	oid_prod_anaq = #oidProdAnaq#
	</update>
	
	<select id="getExisteTipoAnaquelProducto" parameterClass="java.util.Map" resultClass="string">
		SELECT 	COUNT(1)
          FROM 	ape_produ_anaqu pa
         WHERE 	pa.prod_oid_prod = #oidSAP#
           AND 	pa.tian_oid_tipo_anaq = #oidTipoAnaquel#
	</select>
	
	<select id="getMaxNumeroPrioridad" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT 	nvl(MAX(pa.num_nume_prio),0)
          FROM 	ape_produ_anaqu pa
         WHERE 	pa.prod_oid_prod = #oidSAP#
	</select>
	
	<select id="getOidProductoAsignacionDetalle" parameterClass="java.util.Map" resultClass="string">
		SELECT	a.prod_oid_prod
		  FROM  ape_asign_produ_anaqu_detal a
		 WHERE  a.oid_asig_prod_anaq = #oidAsigOrdenDet#	
	</select>
	
	<select id="getExisteOidPeriodoCanalMarca" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT 	COUNT(1)
          FROM 	seg_perio_corpo a,
       			cra_perio b
         WHERE 	a.cod_peri = #codPeriodo#
   		   AND 	b.Marc_Oid_Marc = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#)
   		   AND 	b.cana_oid_cana = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#)
           AND 	a.oid_peri = b.peri_oid_peri
	</select>
	
	<select id="validaExisteFacturadosAlarma" parameterClass="java.util.Map" resultClass="string">
		SELECT 	COUNT(1)
		  FROM  ape_asign_produ_anaqu_cabec x1
		 WHERE  x1.mcdc_oid_mapa_cent_dist_cabe = #oidMapCentrDist#
   		   AND 	x1.perd_oid_peri = #oidPeriodo#
   		   AND 	x1.ind_acti_fact = 'S'	
	</select>
	
	<select id="getDescCentroDistribucion" parameterClass="java.util.Map" resultClass="string">
		SELECT 	APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APP_CONFI_CENTR_DISTR',#oidCentro#,'P') FROM  dual
	</select>
	
	<select id="getDescLineaArmado" parameterClass="java.util.Map" resultClass="string">
		SELECT 	APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_LINEA_ARMAD',#oidLinea#,'P') FROM  dual
	</select>
	
	<select id="getDescMapaCentroCabec" parameterClass="java.util.Map" resultClass="string">
		SELECT 	APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_MAPA_CENTR_DISTR_CABEC',#oidMapCentrDist#,'P') FROM  dual
	</select>
	
    <resultMap id="controlEnvioInterfacesWCSResult" class="java.util.HashMap">
  			<result property="oidOlaDia"	  		    	column="OIDOLADIA"/>
  			<result property="fecha"						column="FECHA"/>
	 		<result property="descripcionCD"				column="DESC_CD"/>
	 		<result property="descripcionLineaArmado" 		column="DESC_LINEAARMADO"/>
	 		<result property="numOla"     					column="NUMOLA"/>
	 		<result property="numPedidos"     				column="NUMPEDIDOS"/>
	 		<result property="estado"     					column="ESTADO"/>
	 		<result property="horaEnvio"     				column="HORAENVIO"/>
    </resultMap>
        
    <select id="getControlEnvioInterfacesList" parameterClass="java.util.Map" resultMap="controlEnvioInterfacesWCSResult">
		SELECT aol.oid_olas_xdia                                                                       OIDOLADIA,
		       TO_CHAR(aol.fec_fact,'dd/MM/yyyy')                                                      FECHA,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APP_CONFI_CENTR_DISTR',liar.ccdi_oid_conf_cent_dist,'P') DESC_CD, 
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_LINEA_ARMAD',aol.liar_oid_line_arma,'P') DESC_LINEAARMADO,
		       aol.num_ola                                                                             NUMOLA,
		       aol.num_pedi                                                                            NUMPEDIDOS,
		       CASE WHEN aol.val_esta_ola = 0 THEN 'Pendiente' ELSE 'Enviada' END AS                   ESTADO,
		       TO_CHAR(aol.fec_hora_libe,'dd/MM/yyyy HH:MM:SS')                                        HORAENVIO
		FROM   ape_olas_xdia aol,
		       ape_linea_armad liar,
		       gen_i18n_sicc_pais s
		WHERE  aol.liar_oid_line_arma = liar.oid_line_arma
		AND    s.val_oid              = aol.liar_oid_line_arma
		AND    s.attr_enti            = 'APE_LINEA_ARMAD'    
		
		<isNotEmpty property="fechaFact">
		 AND    TO_CHAR(aol.fec_fact,'dd/MM/yyyy')=#fechaFact#
		</isNotEmpty>
		
		<isNotEmpty property="oidCentro">
		 AND    liar.ccdi_oid_conf_cent_dist      = #oidCentro#
		</isNotEmpty>
		
		<isNotEmpty property="oidLinArmado">
		 AND    aol.liar_oid_line_arma            = #oidLinArmado#
		</isNotEmpty>
		
    </select>

	<resultMap id="controEnvioWCSObjectResult" class="controlEnvioWCS">
  			<result property="oidOlaDia"	  		    		column="OIDOLADIA"/>
  			<result property="fecha"							column="FECHA"/>
	 		<result property="oidCentro"			  			column="OIDCENTRO"/>
	 		<result property="codigoCentro"        				column="CODCENTRO"/>
	 		<result property="descripcionCentro"  				column="DESC_CD"/>
	 		<result property="oidLineaArmado"		  			column="OIDLINARMADO"/> 
	 		<result property="codigoLineaArmado"  				column="CODLINEAARMADO"/>
	 		<result property="descripcionLineaArmado"  			column="DESC_LINEAARMADO"/>
	 		<result property="numeroOla"  						column="NUM_OLA"/>
    </resultMap>
  
    <select id="getControlEnvioWCSObject" parameterClass="java.util.Map" resultMap="controEnvioWCSObjectResult">
		SELECT aol.oid_olas_xdia                                                                                   OIDOLADIA,
		       TO_CHAR(aol.fec_fact,'dd/MM/yyyy')                                                                  FECHA,
	           liar.ccdi_oid_conf_cent_dist                                                                        OIDCENTRO,
	           cd.cod_cent_dist                                                                                    CODCENTRO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APP_CONFI_CENTR_DISTR',liar.ccdi_oid_conf_cent_dist,'P') DESC_CD,
	           aol.liar_oid_line_arma                                                                              OIDLINARMADO,
	           liar.num_codi_line                                                                                  CODLINEAARMADO,
		       APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_LINEA_ARMAD',aol.liar_oid_line_arma,'P')             DESC_LINEAARMADO,
		       aol.NUM_OLA																			                                                   NUM_OLA
		FROM   ape_olas_xdia aol,
		       ape_linea_armad liar,
	           app_confi_centr_distr cd
		WHERE  aol.liar_oid_line_arma       = liar.oid_line_arma
	    AND    liar.ccdi_oid_conf_cent_dist = cd.oid_conf_cent_dist
	    AND    aol.oid_olas_xdia      	    = #oidOlasxDia#  
    </select>

	<resultMap id="estadoOlaResult" class="estadoOla">
  			<result property="estado"  		    		column="ESTADO"/>
  			<result property="numeroOla"  				column="NUMERO_OLA"/>
    </resultMap>
    	
	<select id="getValEstadoOla" parameterClass="java.util.Map" resultMap="estadoOlaResult">
		SELECT val_esta_ola 	ESTADO, 
			   num_ola			NUMERO_OLA
		FROM   ape_olas_xdia
		WHERE  oid_olas_xdia = #oidOlasxDia#
	</select>

	<update id="updateEstadoOlasxDia" parameterClass="java.util.Map">
		UPDATE ape_olas_xdia
		SET    val_esta_ola  = 0,
		       fec_hora_libe = null
		WHERE  oid_olas_xdia = #oidOlasxDia#	
	</update>
	
	<select id="getPeriodoActual" parameterClass="java.util.Map" resultClass="string">
		SELECT 	gen_pkg_gener.gen_fn_devuelve_perio_actu(#oidPais#, #codigoMarca#,gen_pkg_gener.gen_fn_devuelve_id_canal(#codigoCanal#))
		  FROM  dual
	</select>
	
	<select id="getPeriodoAnterior" parameterClass="java.util.Map" resultClass="string">
		SELECT 	gen_pkg_gener.gen_fn_devuelve_id_nante_campa(#oidPeriodo#, 1) FROM  dual
	</select>
	
	<select id="getDescCanal" parameterClass="java.util.Map" resultClass="string">
		SELECT 	APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('SEG_CANAL',gen_pkg_gener.gen_fn_devuelve_id_canal(#codigoCanal#),'C') 
		  FROM  dual
	</select>
	
	<select id="getDescMarca" parameterClass="java.util.Map" resultClass="string">
		SELECT 	m.des_marc
		  FROM  seg_marca m
		 WHERE 	m.cod_marc = #codigoMarca#
	</select>
	
	<resultMap id="totalesMovimientoResult"  class="java.util.HashMap"  >
		<result property="entran"		    column="ENTRAN"/>
		<result property="salen"			column="SALEN"/>
		<result property="cambian"			column="CAMBIAN"/>
		<result property="quedan"			column="QUEDAN"/>
	</resultMap>
	<select id="getTotalesMovimientoList" parameterClass="java.util.Map"  resultMap="totalesMovimientoResult">
		SELECT 
       			to_char(COUNT( CASE WHEN  MOVIMIENTO ='ENTRA' THEN 1   END ))     ENTRAN,
       			to_char(COUNT( CASE WHEN  MOVIMIENTO ='SALE' THEN 1   END ))      SALEN,
       			to_char(COUNT( CASE WHEN  MOVIMIENTO ='CAMBIA' THEN 1   END ))    CAMBIAN,
       			to_char(COUNT( CASE WHEN  MOVIMIENTO ='QUEDA' THEN 1   END ))     QUEDAN
  		  FROM (  
         			SELECT 	DISTINCT 
	              			product.cod_sap,
                			(CASE WHEN anaquelanterior.num_anaq IS NULL THEN 'ENTRA'
                      			  WHEN anaquel.num_anaq IS NULL THEN 'SALE'
                      			  WHEN anaquel.num_anaq != anaquelanterior.num_anaq THEN 'CAMBIA'
                      			  WHEN anaquel.num_anaq = anaquelanterior.num_anaq THEN 'QUEDA'
                 			 END)                                                                     MOVIMIENTO
           			  FROM  ape_lista_picad_cabec  listacab,
                			ape_lista_picad_detal  listadet,
                			mae_produ product,
                		   	( SELECT mapadet.num_anaq,
                         			 asignaciondet.prod_oid_prod      producto,
                         			 mapadet.oid_mapa_cent_dist_deta  oidmapa,
	  	                   			 mapacab.ccdi_oid_conf_cent_dist  centro
                    		   FROM  ape_asign_produ_anaqu_cabec asignacioncab,
                         			 ape_asign_produ_anaqu_detal asignaciondet,
                         			 ape_mapa_centr_distr_detal mapadet,
			                   		 ape_mapa_centr_distr_cabec mapacab
                              WHERE  asignacioncab.oid_asig_prod_anaq_cabe = asignaciondet.apac_oid_asig_prod_anaq_cabe
	                   		    AND  mapacab.oid_mapa_cent_dist_cabe = mapadet.mcdc_oid_mapa_cent_dist_cabe
	                   		    AND  asignacioncab.mcdc_oid_mapa_cent_dist_cabe = mapacab.oid_mapa_cent_dist_cabe
                     			AND  asignacioncab.perd_oid_peri = #oidPeriodo#
                     			AND  ind_acti_fact = 'S') anaquel,
                			( SELECT mapadet.num_anaq,
                         			 asignaciondet.prod_oid_prod      producto,
                         			 mapadet.oid_mapa_cent_dist_deta  oidmapa,
			                   		 mapacab.ccdi_oid_conf_cent_dist  centro
                                FROM ape_asign_produ_anaqu_cabec asignacioncab,
                         		     ape_asign_produ_anaqu_detal asignaciondet,
                         		     ape_mapa_centr_distr_detal mapadet,
			                   		 ape_mapa_centr_distr_cabec mapacab
                               WHERE asignacioncab.oid_asig_prod_anaq_cabe = asignaciondet.apac_oid_asig_prod_anaq_cabe
	                             AND asignacioncab.mcdc_oid_mapa_cent_dist_cabe= mapacab.oid_mapa_cent_dist_cabe
	                   		     AND mapacab.oid_mapa_cent_dist_cabe = mapadet.mcdc_oid_mapa_cent_dist_cabe
                     		     AND asignacioncab.perd_oid_peri =#oidPeriodoAnterior#
                     		     AND ind_acti_fact = 'S') anaquelanterior
                       WHERE listacab.perd_oid_peri = #oidPeriodo#
            			 AND listacab.ccdi_oid_conf_cent_dist = #oidCentro#
            			 AND listacab.liar_oid_line_arma = #oidLinea#
            			 AND listacab.oid_list_pica_cabe = listadet.lpca_oid_list_pica_cabe
            			 AND listadet.prod_oid_prod = product.oid_prod
            			 AND listadet.mcdd_oid_mapa_cent_dist_deta = anaquel.oidmapa
            			 AND listacab.ccdi_oid_conf_cent_dist = anaquel.centro
            			 AND anaquelanterior.producto(+) = anaquel.producto
            			 AND anaquelanterior.oidmapa(+) = anaquel.oidmapa
                ) tabla
	</select>
	
	<select id="validaExistePeriodobyMarcaCanal" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT 	COUNT(1)
		  FROM  CRA_PERIO,
	   	 		SEG_MARCA,
	     		SEG_CANAL,
	     		SEG_PAIS,
	     		SEG_PERIO_CORPO
		 WHERE  SEG_PAIS.COD_PAIS  = #codigoPais#
	 	   AND SEG_MARCA.COD_MARC = #codigoMarca#
   		   AND SEG_CANAL.COD_CANA = #codigoCanal#
   		   AND SEG_PAIS.OID_PAIS = CRA_PERIO.PAIS_OID_PAIS
	 	   AND SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC
   		   AND SEG_CANAL.OID_CANA = CRA_PERIO.CANA_OID_CANA
   		   AND SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI
   		   AND SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI	
	</select>
	
	<resultMap id="controlBalanceoResult"  class="java.util.HashMap"  >
	    <result property="oidMapaCD"			column="OID_MAPA_CD"/>
    	<result property="oidLinea"	    		column="OID_LINEA"/>
    	<result property="oidPeriodo"			column="OID_PERIODO"/>
    	<result property="codVersion"			column="COD_VERSION"/>
	    <result property="oidSubLinea"			column="OID_SUBLINEA"/>
    	<result property="codSubLinea"			column="COD_SUBLINEA"/>
    	<result property="desSubLinea"			column="DES_SUBLINEA"/>
    	<result property="funBalanceo"			column="FUN_BALANCEO"/>
    	<result property="numOrden"				column="NUM_ORDEN"/>
    	<result property="manual"				column="MANUAL"/>
    	<result property="preasignacion"		column="PREASIGNACION"/>
    	<result property="balanceo"				column="BALANCEO"/>
	</resultMap>
	<select id="getControlBalanceoList" parameterClass="java.util.Map" resultMap="controlBalanceoResult">
	    SELECT	#oidMapaCentro#								  OID_MAPA_CD,
	    		#oidLinea#									  OID_LINEA,
	    		#oidPeriodo#								  OID_PERIODO,
	    		#codigoVersion#							      COD_VERSION,
	    		sla.oid_subl_arma                             OID_SUBLINEA,
       			sla.cod_subl_arma                             COD_SUBLINEA,
       			(SELECT i18n.val_i18n 
          		   FROM gen_i18n_sicc_pais i18n
         		  WHERE i18n.val_oid = sla.oid_subl_arma
           			AND i18n.attr_enti = #nombreTablaSubLinea#
           			AND i18n.attr_num_atri = 1
           			AND i18n.idio_oid_idio = #oidIdiomaIso#)  DES_SUBLINEA,
       			fnd.val_prog                                  FUN_BALANCEO,
       			sla.num_orde_bala                             NUM_ORDEN,
       			(SELECT DECODE(COUNT(apad.prce_oid_proc),0,' ', 'M' )
          		   FROM ape_mapa_centr_distr_cabec  mcdc,
               			ape_mapa_centr_distr_detal  mcdd,
               			ape_asign_produ_anaqu_cabec apac,
               			ape_asign_produ_anaqu_detal apad,
               			ape_proce                   app
                  WHERE apac.val_vers = #codigoVersion#
           		    AND apac.perd_oid_peri = #oidPeriodo#
           			AND mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
           			AND app.cod_proc = 'M'
           			AND apad.prod_oid_prod IS NOT NULL
           			AND mcdd.sbar_oid_subl_arma =  sla.oid_subl_arma 
           			AND apac.oid_asig_prod_anaq_cabe = apad.apac_oid_asig_prod_anaq_cabe
           			AND app.oid_proc = apad.prce_oid_proc
           			AND mcdc.oid_mapa_cent_dist_cabe = mcdd.mcdc_oid_mapa_cent_dist_cabe
           			AND mcdc.oid_mapa_cent_dist_cabe = apac.mcdc_oid_mapa_cent_dist_cabe
           			AND mcdd.oid_mapa_cent_dist_deta = apad.mcdd_oid_mapa_cent_dist_deta) MANUAL,
       			(SELECT DECODE(COUNT(apad.prce_oid_proc),0,' ', 'P' )
          		   FROM ape_mapa_centr_distr_cabec  mcdc,
               			ape_mapa_centr_distr_detal  mcdd,
               			ape_asign_produ_anaqu_cabec apac,
               			ape_asign_produ_anaqu_detal apad,
               			ape_proce                   app
                  WHERE apac.val_vers = #codigoVersion#
           			AND apac.perd_oid_peri = #oidPeriodo#
           			AND mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
           			AND app.cod_proc = 'P'
           			AND apad.prod_oid_prod IS NOT NULL
           			AND mcdd.sbar_oid_subl_arma =  sla.oid_subl_arma 
           			AND apac.oid_asig_prod_anaq_cabe = apad.apac_oid_asig_prod_anaq_cabe
           			AND app.oid_proc = apad.prce_oid_proc
           			AND mcdc.oid_mapa_cent_dist_cabe = mcdd.mcdc_oid_mapa_cent_dist_cabe
           			AND mcdc.oid_mapa_cent_dist_cabe = apac.mcdc_oid_mapa_cent_dist_cabe
           			AND mcdd.oid_mapa_cent_dist_deta = apad.mcdd_oid_mapa_cent_dist_deta) PREASIGNACION,
       			(SELECT DECODE(COUNT(apad.prce_oid_proc),0,' ', 'B' )
          		   FROM ape_mapa_centr_distr_cabec  mcdc,
               			ape_mapa_centr_distr_detal  mcdd,
               			ape_asign_produ_anaqu_cabec apac,
               			ape_asign_produ_anaqu_detal apad,
               			ape_proce                   app
                  WHERE apac.val_vers = #codigoVersion#
           			AND apac.perd_oid_peri = #oidPeriodo#
           			AND mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
           			AND app.cod_proc = 'B'
           			AND apad.prod_oid_prod IS NOT NULL
           			AND mcdd.sbar_oid_subl_arma =  sla.oid_subl_arma 
           			AND apac.oid_asig_prod_anaq_cabe = apad.apac_oid_asig_prod_anaq_cabe
           			AND app.oid_proc = apad.prce_oid_proc
           			AND mcdc.oid_mapa_cent_dist_cabe = mcdd.mcdc_oid_mapa_cent_dist_cabe
           			AND mcdc.oid_mapa_cent_dist_cabe = apac.mcdc_oid_mapa_cent_dist_cabe
           			AND mcdd.oid_mapa_cent_dist_deta = apad.mcdd_oid_mapa_cent_dist_deta) BALANCEO
	      FROM  ape_linea_armad lia,
       			ape_subli_armad sla,
       			ape_funci_distr fnd 
	     WHERE	lia.oid_line_arma = #oidLinea#
   		   AND 	lia.oid_line_arma = sla.liar_oid_line_arma
   		   AND 	fnd.oid_func_dist = sla.fndi_oid_func_dist
      ORDER BY 	sla.num_orde_bala
	</select>
	
	<select id="getMapaCentroDistbyLineaList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT 	DISTINCT
       			a.num_codi_mapa AS CODIGO,
  	   			s.val_i18n      AS DESCRIPCION
  		  FROM 	ape_mapa_centr_distr_cabec a,
       			ape_mapa_centr_distr_detal b,
       			ape_linea_armad c,
       			ape_subli_armad d,
    	 		gen_i18n_sicc_pais s
         WHERE	a.ccdi_oid_conf_cent_dist = #oidCentro#
   		   AND 	c.oid_line_arma = #oidLinea#
           AND 	a.oid_mapa_cent_dist_cabe = b.mcdc_oid_mapa_cent_dist_cabe
           AND 	c.oid_line_arma = d.liar_oid_line_arma
   		   AND 	d.oid_subl_arma = b.sbar_oid_subl_arma
   		   AND 	a.oid_mapa_cent_dist_cabe = s.val_oid
	       AND 	s.attr_enti =  #nombreTablaMapaCentroDistribucionCabec#
   		   AND 	s.attr_num_atri = 1
   		   AND 	s.idio_oid_idio = 1
      ORDER BY 1
	</select>
	
	<select id="getVersionActiva" parameterClass="java.util.Map" resultClass="string">
       SELECT DISTINCT ascab.val_vers 
       FROM APE_ASIGN_PRODU_ANAQU_CABEC         ascab,
            APE_MAPA_ZONA_CABEC                 mpzona,
            APE_MAPA_ZONA_DETAL                 mpzond,
            APE_SUBLI_ARMAD                     sublin
       WHERE ascab.mzca_oid_mapa_zona_cabe      = mpzona.oid_mapa_zona_cabe
       AND   mpzona.oid_mapa_zona_cabe          = mpzond.mzca_oid_mapa_zona_cabe
       AND   mpzond.sbar_oid_subl_arma          = sublin.oid_subl_arma
       AND   sublin.liar_oid_line_arma          = #oidLinArmado#
       AND   ascab.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCD#
       AND   ascab.perd_oid_peri                = #oidPeriodo#
       AND   ascab.ind_acti_fact                = 'S'
	</select>	
	
	<select id="getMapaZonaCabecera" parameterClass="java.util.Map" resultClass="string">
		SELECT 	apac.mzca_oid_mapa_zona_cabe
		  FROM  ape_asign_produ_anaqu_cabec apac
		 WHERE 	apac.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
           AND 	apac.perd_oid_peri = #oidPeriodo#
   		   AND 	apac.val_vers = #codVersion#
	</select>
	
	<select id="getNumeroZonaSubLinea" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT 	COUNT(DISTINCT mapazonadetalle.num_idzo)
          FROM 	ape_mapa_zona_cabec  mapazonacabecera,
       			ape_mapa_zona_detal  mapazonadetalle,
       			ape_subli_armad      sublinea
         WHERE 	mapazonacabecera.oid_mapa_zona_cabe = #oidMapaZonaCabec#
   		   AND 	sublinea.oid_subl_arma = #oidSubLinea#
   		   AND 	mapazonacabecera.oid_mapa_zona_cabe =  mapazonadetalle.mzca_oid_mapa_zona_cabe
   		   AND 	mapazonadetalle.sbar_oid_subl_arma = sublinea.oid_subl_arma
	</select>
	
	<select id="getAsignacionProductoAnaquelCabecera" parameterClass="java.util.Map" resultClass="string">
		SELECT 	apac.oid_asig_prod_anaq_cabe
		  FROM  ape_asign_produ_anaqu_cabec apac
		 WHERE 	apac.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
           AND 	apac.perd_oid_peri = #oidPeriodo#
   		   AND 	apac.val_vers = #codVersion#
	</select>
	
	<select id="getTotalEstimadoSubLinea" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT SUM(NVL(ESTIMADO.NUM_UNID_ESTI,0))
          FROM 	ape_asign_produ_anaqu_detal asignaciondetalle,
       			ape_mapa_centr_distr_detal  mapacddetalle,
       			ape_subli_armad             sublinea,
        		ape_estim_produ             estimado
         WHERE 	sublinea.oid_subl_arma = #oidSubLinea#
   		   AND 	asignaciondetalle.apac_oid_asig_prod_anaq_cabe (+) = #oidAsginacionCabec#
   		   AND 	asignaciondetalle.mcdd_oid_mapa_cent_dist_deta (+) = mapacddetalle.oid_mapa_cent_dist_deta
   		   AND 	mapacddetalle.sbar_oid_subl_arma = sublinea.oid_subl_arma
   		   AND  asignaciondetalle.prod_oid_prod = estimado.prod_oid_prod
   		   AND  sublinea.liar_oid_line_arma = estimado.liar_oid_line_arma
   		   AND  estimado.perd_oid_peri = #oidPeriodo#
	</select>
	
	<resultMap id="evaluarCargaResult"  class="java.util.HashMap"  >
	    <result property="oidZona"				column="OID_ZONA"/>
    	<result property="uniAsignada"   		column="UNI_ASIGNADAS"/>
    	<result property="valPorcentaje"		column="VAL_PORCENTAJE"/>
	</resultMap>
	<select id="getEvaluarCargaList" parameterClass="java.util.Map" resultMap="evaluarCargaResult">
		SELECT productos.oid_zona                        OID_ZONA,
       		   SUM(NVL(ESTIMADO.NUM_UNID_ESTI,0))        UNI_ASIGNADAS,
       		   decode(  #numEstimados#, 0 ,0 ,
      		       ROUND( (SUM(NVL(estimado.num_unid_esti,0)) /  #numEstimados#) * 100 , 2) )VAL_PORCENTAJE
          FROM (  SELECT 	mapazonadetalle.num_idzo                       OID_ZONA,
                  			asignaciondetalle.prod_oid_prod                PRODUCTO,
                  			cab.perd_oid_peri                              PERIODO,
                  			sublinea.liar_oid_line_arma                    LINEA
            	    FROM 	ape_asign_produ_anaqu_cabec  cab,
                  			ape_asign_produ_anaqu_detal  asignaciondetalle,
                  			ape_mapa_zona_detal          mapazonadetalle,
       	          			ape_mapa_centr_distr_detal   mapacddetalle,
       	          			ape_subli_armad              sublinea
                    WHERE 	sublinea.oid_subl_arma = #oidSubLinea#
             		  AND 	mapacddetalle.mcdc_oid_mapa_cent_dist_cabe (+) = #oidMapaCentro#
             		  AND 	asignaciondetalle.apac_oid_asig_prod_anaq_cabe (+) = #oidAsginacionCabec#
             		  AND 	mapazonadetalle.mzca_oid_mapa_zona_cabe = #oidMapaZonaCabec#
             		  AND 	mapazonadetalle.sbar_oid_subl_arma = sublinea.oid_subl_arma
             		  AND 	asignaciondetalle.mcdd_oid_mapa_cent_dist_deta (+) = mapacddetalle.oid_mapa_cent_dist_deta
             		  AND 	mapacddetalle.sbar_oid_subl_arma = sublinea.oid_subl_arma (+)
             		  AND 	to_number(substr(mapacddetalle.num_anaq (+), 2, 2)) >= mapazonadetalle.num_bahi_desd
             		   
             		  AND  to_number(substr(mapacddetalle.num_anaq (+), 2, 2)) 
             		  <![CDATA[
             		  	<=  mapazonadetalle.num_bahi_hast
             		   ]]>
             		  AND  cab.oid_asig_prod_anaq_cabe = asignaciondetalle.apac_oid_asig_prod_anaq_cabe
                 GROUP BY 	mapazonadetalle.num_idzo, 
                 			asignaciondetalle.prod_oid_prod, 
                 			cab.perd_oid_peri, 
                 			sublinea.liar_oid_line_arma
                 ) productos,
        		ape_estim_produ              estimado
 	      WHERE estimado.liar_oid_line_arma(+) = productos.linea
   		    AND estimado.perd_oid_peri(+) = productos.periodo
   			AND estimado.prod_oid_prod (+)= productos.producto
	   GROUP BY productos.oid_zona
	   ORDER BY productos.oid_zona
	</select>
	
	<resultMap id="copiarAsignacionProductosResult"  class="java.util.HashMap">
	    <result property="oidAsigProdAnaq"				column="OIDASIGPRODANQUCAB"/>
    	<result property="descMapaCD"	   			    column="DESC_MAPACD"/>
    	<result property="versionOrigen"			    column="VERSIONORIGEN"/>
    	<result property="descMapaZona"				    column="DESC_MAPAZONA"/>
    	<result property="activoFacturacion"    	    column="ACTIVOFACTURACION"/>
	</resultMap>
		
	<select id="getCopiarAsignacionProductosList" parameterClass="java.util.Map" resultMap="copiarAsignacionProductosResult">
	   SELECT ascab.oid_asig_prod_anaq_cabe     OIDASIGPRODANQUCAB,
	  	      APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_MAPA_CENTR_DISTR_CABEC',ascab.mcdc_oid_mapa_cent_dist_cabe,'P') DESC_MAPACD,
	          ascab.val_vers                    VERSIONORIGEN,
	          APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_MAPA_ZONA_CABEC',ascab.mcdc_oid_mapa_cent_dist_cabe,'P') DESC_MAPAZONA,
	          ascab.ind_acti_fact               ACTIVOFACTURACION                                                                     
	   FROM   APE_ASIGN_PRODU_ANAQU_CABEC ascab,
	          APE_MAPA_CENTR_DISTR_CABEC  mapacd
	   WHERE  ascab.mcdc_oid_mapa_cent_dist_cabe = mapacd.oid_mapa_cent_dist_cabe
	   AND    mapacd.ccdi_oid_conf_cent_dist     = #oidCentro#	
	   
	   	<isNotEmpty property="oidPeriodo">
			AND ascab.perd_oid_peri = #oidPeriodo#
		</isNotEmpty>
	   
	</select>
	
	<select id="getValidaVersionByCDyPeriodo" parameterClass="java.util.Map" resultClass="string">
	   SELECT COUNT(1)
	   FROM   APE_ASIGN_PRODU_ANAQU_CABEC ascab,
	          APE_MAPA_CENTR_DISTR_CABEC  apcd
	   WHERE  ascab.mcdc_oid_mapa_cent_dist_cabe = apcd.oid_mapa_cent_dist_cabe
	   AND    apcd.ccdi_oid_conf_cent_dist       = #oidCentro#
	   AND    ascab.perd_oid_peri 				 = #oidPeriodo#
	   AND    ascab.val_vers 					 = #valVersion#
	</select>

	<parameterMap id="paramExecuteGeneraCopiaAsignarProducAnaquel" class="java.util.Map">
		<parameter property="oidAsigprodAnaq"    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="valVersionDestino"    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
	</parameterMap>
	
	<procedure id="executeGeneraCopiaAsignarProductosAnaquel" parameterMap="paramExecuteGeneraCopiaAsignarProducAnaquel">
		{call APE_PKG_PROCE.APE_PR_GENER_ASIGN_PRANQ_NVERS(?,?) }
	</procedure>

	<resultMap id="copiarAsigProdAnaquelObjectResult" class="copiarAsignarProductos">
  			<result property="codigoCentroDistribucion"	  		column="CODIGO_CD"/>
  			<result property="descripcionCentro"				column="DESC_CD"/>
	 		<result property="codigoMarca"	   	  			    column="CODIGO_MARCA"/>
	 		<result property="descripcionMarca"   				column="DESC_MARCA"/>
	 		<result property="codigoCanal"    				    column="CODIGO_CANAL"/>
	 		<result property="descripcionCanal"		  			column="DESC_CANAL"/> 
	 		<result property="codigoPeriodo"  					column="CODIGO_PERIODO"/>
    </resultMap>
  
	<select id="getCopiarAsigProdAnaquelObject" parameterClass="java.util.Map" resultMap="copiarAsigProdAnaquelObjectResult">
	   SELECT apcd.cod_cent_dist                                                                             CODIGO_CD,
	          APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APP_CONFI_CENTR_DISTR',apcd.oid_conf_cent_dist,'P') DESC_CD,
	          marc.cod_marc                                                                                  CODIGO_MARCA,
	          marc.des_marc                                                                                  DESC_MARCA,
	         (SELECT cn.cod_cana
	          FROM  SEG_CANAL cn 
	          WHERE cn.oid_cana = peri.cana_oid_cana)                                                        CODIGO_CANAL,
	          APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('SEG_CANAL',peri.cana_oid_cana,'C')                  DESC_CANAL,
	          cper.cod_peri                                                                                  CODIGO_PERIODO
	   FROM   APE_ASIGN_PRODU_ANAQU_CABEC ascab,
	          APE_MAPA_CENTR_DISTR_CABEC  apmpcd,
	          APP_CONFI_CENTR_DISTR       apcd,
	          CRA_PERIO                   peri,
	          SEG_PERIO_CORPO             cper,
	          SEG_MARCA                   marc
	   WHERE  ascab.mcdc_oid_mapa_cent_dist_cabe = apmpcd.oid_mapa_cent_dist_cabe
	   AND    apmpcd.ccdi_oid_conf_cent_dist     = apcd.oid_conf_cent_dist
	   AND    ascab.perd_oid_peri                = peri.oid_peri
	   AND    peri.peri_oid_peri                 = cper.oid_peri
	   AND    peri.marc_oid_marc                 = marc.oid_marc   
	   AND    ascab.oid_asig_prod_anaq_cabe      = #oidAsigProdAnaq#
	</select>
	
	<select id="getOidAsignacionProductoAnaquel" parameterClass="java.util.Map" resultClass="string">
		SELECT 	apac.oid_asig_prod_anaq_cabe
          FROM	ape_asign_produ_anaqu_cabec apac
         WHERE 	apac.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
           AND apac.val_vers = #codVersion#
   		   AND apac.perd_oid_peri = #oidPeriodo#
	</select>
	
	<select id="getDescMapaZonaCabec" parameterClass="java.util.Map" resultClass="string">
		SELECT 	APE_PKG_GENER.APE_FN_OBTEN_DESCRIP_IDIOMA('APE_MAPA_ZONA_CABEC',#oidMapaZona#,'P') FROM  dual
	</select>
	
	<select id="validaBalanceoLinea" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT	COUNT(1)
	   	  FROM  ape_mapa_centr_distr_cabec  mcdc,
       			ape_mapa_centr_distr_detal  mcdd,
       			ape_asign_produ_anaqu_cabec apac,
       			ape_asign_produ_anaqu_detal apad,
       			ape_proce                   app
         WHERE 	apac.val_vers =  #codVersion#
   		   AND 	apac.perd_oid_peri = #oidPeriodo#
   		   AND 	mcdc.oid_mapa_cent_dist_cabe = #oidMapaCentro#
   		   AND 	app.cod_proc = 'B'
   		   AND 	mcdd.sbar_oid_subl_arma =  #oidSubLinea#
   		   AND 	apac.oid_asig_prod_anaq_cabe = apad.apac_oid_asig_prod_anaq_cabe
   		   AND 	app.oid_proc = apad.prce_oid_proc
   		   AND 	mcdc.oid_mapa_cent_dist_cabe = mcdd.mcdc_oid_mapa_cent_dist_cabe
   		   AND 	mcdc.oid_mapa_cent_dist_cabe = apac.mcdc_oid_mapa_cent_dist_cabe
   		   AND 	mcdd.oid_mapa_cent_dist_deta = apad.mcdd_oid_mapa_cent_dist_deta
	</select>
	
	<parameterMap id="paramExecuteBalanceoLinea" class="java.util.Map">
		<parameter property="oidMapaCentro"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidPeriodo"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codVersion"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidLinea"    				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidSubLinea"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoOrdenAnaquel"    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoOrigenDato"    		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoOrdenProducto"    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="numeroAnaqueles"    		jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />	
	</parameterMap>
	<procedure id="executeBalanceoLinea" parameterMap="paramExecuteBalanceoLinea">
		{call APE_PKG_PROCE.APE_PR_GENER_BALAN_LINEA(?, ?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<select id="getZonasList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	z.cod_zona AS CODIGO,
       			z.des_zona AS DESCRIPCION
  		  FROM 	zon_zona z 
         WHERE 	z.pais_oid_pais = #oidPais#
   		   AND 	z.ind_acti = 1
      ORDER BY 	1 
	</select>
	
	<select id="getTipoSolicitudList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT	sol.cod_tipo_soli 	AS CODIGO,
       			i18.val_i18n 		AS DESCRIPCION
  		  FROM 	ped_tipo_solic_pais pais,
       			ped_tipo_solic sol,
       			gen_i18n_sicc i18 
         WHERE 	sol.oid_tipo_soli = pais.tsol_oid_tipo_soli
           AND 	sol.ind_cons = 0
   		   AND 	pais.pais_oid_pais =  #oidPais#
   		   AND 	i18.attr_enti = 'PED_TIPO_SOLIC'
           AND 	i18.attr_num_atri = 1
   		   AND 	i18.idio_oid_idio = 1
           AND 	sol.oid_tipo_soli = i18.val_oid
      ORDER BY 	2 
	</select>
	
	<resultMap id="anaquelesSinProductosAsignadosListResult"  class="java.util.HashMap" > 
  		<result property="oidAsignacionProductoAnaquel"	  		column="OID_ASIG_ORDEN_DET"/>
  		<result property="numAnaquel"	  						column="NUM_ANAQUEL"/>
    </resultMap>
	<select id="getAnaquelesSinProductosAsignadosList" parameterClass="java.util.Map"  resultMap="anaquelesSinProductosAsignadosListResult">
	 	SELECT	detalle.oid_asig_prod_anaq          	  	OID_ASIG_ORDEN_DET,
        		mapa_centr_det.num_anaq						NUM_ANAQUEL
  		  FROM  ape_asign_produ_anaqu_cabec cabecera,
        		ape_asign_produ_anaqu_detal detalle,
        		ape_mapa_centr_distr_detal mapa_centr_det,
        		ape_subli_armad sa
 	     WHERE  cabecera.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentroDistribucion#
   		   AND  cabecera.val_vers = #codigoVersion#
   		   AND  cabecera.perd_oid_peri = #oidPeriodo#
   		   AND  sa.oid_subl_arma = #oidSubLinea#
   		   AND  detalle.prod_oid_prod IS  NULL
   		   AND  cabecera.oid_asig_prod_anaq_cabe = detalle.apac_oid_asig_prod_anaq_cabe
   		   AND  detalle.mcdd_oid_mapa_cent_dist_deta = mapa_centr_det.oid_mapa_cent_dist_deta   
   		   AND  sa.oid_subl_arma =mapa_centr_det.sbar_oid_subl_arma
   		   
   		   	<isNotEmpty property="oidTipoAnaquel">
			AND mapa_centr_det.TIAN_OID_TIPO_ANAQ = #oidTipoAnaquel#
			</isNotEmpty>   
      ORDER BY mapa_centr_det.num_anaq ASC	 	
	</select>

	<resultMap id="erroresCubicajeListResult"  class="java.util.HashMap" > 
		<result property="fechaFactura"			  		column="FECHA_FACT"/>
		<result property="oidProducto"	  				column="OID_PROD"/>
		<result property="codigoSAP"	  				column="COD_SAP"/>
		<result property="descProducto"	  				column="DESC_PRODUCTO"/>
		<result property="volumen"	  					column="VOLUMEN"/>
		<result property="unidadMedida"	  				column="UNID_MEDI"/>
		<result property="altoAnchoLargo" 				column="ALTOANCHOLARGO"/>
    </resultMap>

	<select id="getConsultaErroresCubicajeList" parameterClass="java.util.Map" resultMap="erroresCubicajeListResult">
		SELECT TO_CHAR(ercb.fec_fact,'dd/MM/yyyy')                      FECHA_FACT, 
		       ercb.prod_oid_prod                                       OID_PROD, 
		       mprod.cod_sap                                            COD_SAP, 
		       s.val_i18n		                                        DESC_PRODUCTO,
		       TO_CHAR(mprod.val_volu) || ' ' ||                                          
		       md.des_abre 		                                        VOLUMEN,
               munid.des_abre                                           UNID_MEDI,
		       TO_CHAR(mprod.val_dime_alto) || '-' ||
		       TO_CHAR(mprod.val_dime_anch) || '-' ||
		       TO_CHAR(mprod.val_dime_larg)                             ALTOANCHOLARGO
		FROM   APE_ERROR_CUBIC    ercb,
		       MAE_PRODU          mprod,
           	   GEN_I18N_SICC_PAIS s,
           	   MAE_UNIDA_MEDID    md,
               MAE_UNIDA_MEDID    munid,
               MAE_MAGNI          mmg
		WHERE  ercb.prod_oid_prod   = mprod.oid_prod
        AND    s.val_oid (+)        = ercb.prod_oid_prod
        AND    s.attr_enti          = 'MAE_PRODU'
        AND    md.oid_unid_medi(+)  = mprod.unmd_oid_unid_medi
        AND    md.pais_oid_pais(+)  = #oidPais#
        AND   (munid.magn_oid_magn  = mmg.oid_magn
        AND    mmg.cod_magn         = #codMagn#
        AND    munid.ind_um_stnd    = #indUndStnd#)
	    AND    TRUNC(ercb.fec_fact) = TO_DATE(#fechaFactura#,'dd/MM/yyyy')
		ORDER BY 3	
	</select>	

	<update id="updateEstadoEliminaErrorCubicaje" parameterClass="java.util.Map">
		UPDATE APE_ERROR_CUBIC
		SET    ind_elim = 1,
		       usu_modi = #codUsu#,
		       fec_modi = SYSDATE
		WHERE  TRUNC(fec_fact) = TO_DATE(#fechaFactura#,'dd/MM/yyyy')
		AND    prod_oid_prod   = #oidProducto#
	</update>
	
	<delete id="deleteErrorCubicaje" parameterClass="java.util.Map">
		DELETE FROM APE_ERROR_CUBIC
		WHERE  TRUNC(fec_fact) = TO_DATE(#fechaFactura#,'dd/MM/yyyy')
		AND    prod_oid_prod   = #oidProducto#
	</delete>
	
	<select id="getValidaValoresProducto" parameterClass="java.util.Map" resultClass="string">
 		SELECT COUNT(1)
		FROM   MAE_PRODU mp
		WHERE  NVL(mp.val_volu,0) = 0 
		AND    mp.oid_prod             = #oidProducto#
	</select>
	
	<select id="getValidaValorUndMedVolProducto" parameterClass="java.util.Map" resultClass="string">
 		SELECT COUNT(1)
		FROM   MAE_PRODU mp
		WHERE  mp.unmd_oid_unid_medi IS NULL
		AND    mp.oid_prod             = #oidProducto#
	</select>
	
	<select id="getValidaValorAltoProducto" parameterClass="java.util.Map" resultClass="string">
 		SELECT COUNT(1)
		FROM   MAE_PRODU mp
		WHERE  NVL(mp.val_dime_alto,0) = 0
		AND    mp.oid_prod             = #oidProducto#
	</select>
	
	<select id="getValidaValorLargoProducto" parameterClass="java.util.Map" resultClass="string">
 		SELECT COUNT(1)
		FROM   MAE_PRODU mp
		WHERE  NVL(mp.val_dime_larg,0) = 0
		AND    mp.oid_prod             = #oidProducto#
	</select>

	<select id="getValidaValorAnchoProducto" parameterClass="java.util.Map" resultClass="string">
 		SELECT COUNT(1)
		FROM   MAE_PRODU mp
		WHERE  NVL(mp.val_dime_anch,0) = 0
		AND    mp.oid_prod             = #oidProducto#
	</select>
	
	<select id="getMapaCentroSubLineaList" parameterClass="java.util.Map" resultClass="string">
		SELECT  mcdd.oid_mapa_cent_dist_deta    OID_MAPA_CENTRO_DET
	      FROM  ape_mapa_centr_distr_detal mcdd   
	     WHERE	mcdd.num_anaq = #numeroAnaquel#
   		   AND 	mcdd.mcdc_oid_mapa_cent_dist_cabe = #oidMapaCentro#
	</select>	
	
	<update id="actualizaNumeroOrden" parameterClass="java.util.Map">
		UPDATE 	ape_orden_anaqu_detal
   		   SET 	num_orde = #1#,
       			num_orde_list_pica = #2#
 		 WHERE 	mcdd_oid_mapa_cent_dist_deta = #oidMapaCentroDet#
   		   AND 	oaca_oid_anaq_cabe = #oidMapaOrdenCab# 
	</update>
	
	<select id="getOidAsignacionProdAnaDet" parameterClass="java.util.Map" resultClass="string">
		SELECT 	pad.oid_asig_prod_anaq
	      FROM	ape_asign_produ_anaqu_detal pad,
       			ape_mapa_centr_distr_detal  mcd
	     WHERE	pad.apac_oid_asig_prod_anaq_cabe = #oidAsigOrdenCab#
           AND 	mcd.num_anaq = #numeroAnaquel#
   		   AND 	mcd.sbar_oid_subl_arma = #oidSubLinea#
   		   AND 	mcd.oid_mapa_cent_dist_deta = #oidMapaCDDet#
   		   AND 	pad.mcdd_oid_mapa_cent_dist_deta = mcd.oid_mapa_cent_dist_deta 
   		   AND 	ROWNUM = 1
	</select>
	
	<parameterMap id="paramValidaProductos" class="java.util.Map">
		<parameter property="oidPais"            		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="codSAP"              		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="codigoTipoDispensacion"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="codigoTipoAnaquel"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="codigoTipoCaja"          	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 		<parameter property="valError"     		    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	</parameterMap>
	<procedure id="validaProductos" parameterMap="paramValidaProductos">
		{call APE_PKG_PROCE.APE_PR_VALID_VISTA_PRODU(?, ?, ?, ?, ?, ?) }
	</procedure>
	
		
	<resultMap id="bahiaResultList"  class="java.util.HashMap" > 
		<result property="bahia"		column="BAHIA"/>
    </resultMap>	
	
	<select id="getObtenerBahiasxSubLineaList" parameterClass="java.util.Map" resultMap="bahiaResultList">
		SELECT DISTINCT substr(a.NUM_ANAQ,2,2) BAHIA
		  FROM APE_MAPA_CENTR_DISTR_DETAL a
		 WHERE a.sbar_oid_subl_arma = #oidSubLinArmado#
		 ORDER BY SUBSTR(a.NUM_ANAQ,2,2)
	</select>
	
	<select id="getObtenerCantidadBahiasxSubLinea" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1) as BAHIAMAYOR
		  FROM (SELECT SUBSTR(apmd.num_anaq, 2, 2)
		          FROM APE_MAPA_CENTR_DISTR_DETAL apmd
		         WHERE apmd.sbar_oid_subl_arma = #oidSubLinArmado#
		         GROUP BY SUBSTR(apmd.num_anaq, 2, 2)) bahias
	</select>	
	
	<select id="getDescripconProductoAPE" parameterClass="java.util.Map" resultClass="string">
		SELECT 	i18.val_i18n
	      FROM	mae_produ mp,
       			gen_i18n_sicc_pais i18
	     WHERE	mp.oid_prod = #oidProducto#
   		   AND 	i18.attr_enti = 'MAE_PRODU'
   		   AND 	mp.oid_prod = i18.val_oid
   		   AND 	i18.attr_num_atri = 1
   		   AND 	i18.idio_oid_idio = 1
	</select>
	
	<select id="getOidFuncionDistribucionPorOidSublinea" parameterClass="string" resultClass="string">
		SELECT sl.fndi_oid_func_dist
  		  FROM ape_subli_armad sl
 		 WHERE sl.oid_subl_arma = #oidSublinea#
	</select>
	
	<parameterMap id="paramActulizaNumeroPrioridad" class="java.util.Map">
		<parameter property="oidSAP"               	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidTipoAnaquel"       	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	</parameterMap>
	<procedure id="executeActulizaNumeroPrioridad" parameterMap="paramActulizaNumeroPrioridad">
		{call APE_PKG_PROCE.APE_PR_REGIS_TIPO_ANAQU(?, ?) }
	</procedure>
	
	<parameterMap id="paramGenerarOlas" class="java.util.Map">
		<parameter property="oidPais"               	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	</parameterMap>
	<procedure id="executeGenerarOlas" parameterMap="paramGenerarOlas">
		{call APE_PKG_PROCE.APE_PR_GENER_OLAS(?) }
	</procedure>
	
	<select id="getDesUnidadMedidaAPE" parameterClass="java.util.Map" resultClass="string">
		SELECT 	des_abre
       	  FROM	mae_unida_medid M
 		 WHERE ind_um_stnd = 1
   		   AND magn_oid_magn = 2001
   		   AND rownum = 1
	</select>
	
	<parameterMap id="paramExecuteGeneraValidaTipoAnaqueles" class="java.util.Map">
		<parameter property="codigoPais"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="NumeroError"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>		
	</parameterMap>
	
	<procedure id="executeGeneraValidaTipoAnaqueles" parameterMap="paramExecuteGeneraValidaTipoAnaqueles">
		{call APE_PKG_PROCE.APE_PR_APE_GENER_VALID_ANAQU(?,?) }
	</procedure>

	<parameterMap id="paramExecuteRegistraTipoAnaquelesMapaCDDet" class="java.util.Map">
		<parameter property="oidSistPicad"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
	</parameterMap>
	
	<procedure id="executeRegistraTipoAnaquelesMapaCDDet" parameterMap="paramExecuteRegistraTipoAnaquelesMapaCDDet">
		{call APE_PKG_PROCE.APE_PR_REGIS_ANAQ_MAPACDDET(?) }
	</procedure>
	
	<resultMap id="numeroAnaquelesErroresListResult"  class="java.util.HashMap" > 
  		<result property="numAnaquel"	  						column="NUMERO_ANAQUEL"/>
    </resultMap>
    
	<select id="getNumeroAnaquelesErroresList" parameterClass="java.util.Map"  resultMap="numeroAnaquelesErroresListResult">
		SELECT NUM_ANAQ NUMERO_ANAQUEL
		FROM APE_GTT_LISTA_ANAQU	
	</select>
	
	<insert id="insertTipoAnaqueles" parameterClass="java.util.Map">
		INSERT INTO APE_GTT_TIPO_ANAQU(OID_MAPA_CENT_DIST_DETA  ,   OID_TIPO_ANAQ                 ,   VAL_SIDE                  ,
		                               NUM_AFRA_FRAM_NUMB	    ,   NUM_AFRA_CHAN_ADDR            ,   NUM_AFRA_MACH_ADDR        ,
		                               NUM_AFRA_LEVE_NUMB	    ,   NUM_AFRA_HEIG                 ,   NUM_AFRA_WIDT               )
		                        VALUES(      #oidMapaCDDet#     ,#oidTipoAnaquel#                 ,  #val_Side#                 ,
		                                     #frame_numb#       ,#chann_addr#                     ,  #mach_addr#                ,
		                                     #level_numb#       ,TO_NUMBER(#alto#,'99999.99')     ,  TO_NUMBER(#ancho#,'99999.99'))
	</insert>	

	<select id="getIndProductoCajaDentroList" parameterClass="java.util.Map"  resultMap="baseResult">
		SELECT VAL_INDI_CAJA      AS CODIGO,
		       VAL_DESC_INDI_CAJA AS DESCRIPCION
		FROM APE_PRODU_INDIC_CAJA
	</select>

	<select id="getOidIndProductoCajaDentro" parameterClass="java.util.Map"  resultClass="string">
		SELECT OID_INDI_CAJA
		FROM APE_PRODU_INDIC_CAJA
		WHERE VAL_INDI_CAJA = #valIndiCaja# 
	</select>  

	<resultMap id="prodIndicadorDentroCajaResult"  class="java.util.HashMap">
	    <result property="codigoProducto"		column="COD_SAP"/>
		<result property="descProducto"    		column="DESCRIPCION"/>
    	<result property="descIndicador"   		column="DESC_INDI"/>
	</resultMap>
	
	<select id="getProductoIndicadorDentroCajaList" parameterClass="java.util.Map" resultMap="prodIndicadorDentroCajaResult">
			SELECT mp.cod_sap  COD_SAP,
			       s.val_i18n  DESCRIPCION,
			       (SELECT p.val_desc_indi_caja
			          FROM APE_PRODU_INDIC_CAJA p
			         WHERE p.val_indi_caja = mp.cod_ind_dent_caja) DESC_INDI
			 FROM MAE_PRODU mp,
			      GEN_I18N_SICC_PAIS s
			WHERE mp.oid_prod = s.val_oid
			  AND s.attr_enti = #tablaMaestroProductos#
			  AND s.idio_oid_idio = #oidIdioma#
			  
   		   	<isNotEmpty property="codigoProducto">
			AND mp.cod_sap = #codigoProducto#
			</isNotEmpty>
			
   		   	<isNotEmpty property="descripcionProducto">
			AND s.val_i18n LIKE #descripcionProducto#
			</isNotEmpty>

   		   	<isNotEmpty property="codigoIndicador">
			AND mp.cod_ind_dent_caja = #codigoIndicador#
			</isNotEmpty>
			
	</select>
	
	<resultMap id="indProdDentroCajaResult"  class="java.util.HashMap">
	    <result property="codigoProducto"		column="COD_SAP"/>
		<result property="descProducto"    		column="DESCRIPCION"/>
    	<result property="codigoIndProducto"   	column="COD_IND_DENT"/>
		<result property="oidProducto"   		column="OID_PROD"/>
	</resultMap>
	
	<select id="getIndProdDentroCajaObject" parameterClass="java.util.Map" resultMap="indProdDentroCajaResult">
		   SELECT mp.cod_sap 			COD_SAP,
		          s.val_i18n 			DESCRIPCION,
				  mp.cod_ind_dent_caja 	COD_IND_DENT,
				  mp.oid_prod 			OID_PROD
		     FROM MAE_PRODU mp,
		          GEN_I18N_SICC_PAIS s
		    WHERE mp.oid_prod = s.val_oid
		      AND s.attr_enti = #tablaMaestroProductos#
		      AND mp.pais_oid_pais = #oidPais#
		      AND mp.cod_sap = #codigoSAP#
	</select>
	
	<update id="updateIndicadorProducto" parameterClass="java.util.Map">
		UPDATE MAE_PRODU
   		   SET cod_ind_dent_caja = #codIndicadorCaja#
	     WHERE oid_prod = #oidProducto#
	</update>
	
	<select id="getValidaExisteIndicadorCaja" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)
		  FROM APE_PRODU_INDIC_CAJA ap
     	 WHERE NVL(ap.val_indi_caja,' ') = #codigoIndicador# 
	</select>	
	
	<update id="updateIndProductoDFCaja" parameterClass="java.util.Map">
	     UPDATE MAE_PRODU
	        SET cod_ind_dent_caja = #codigoIndicador#
	      WHERE cod_sap = #codigoProducto#
	</update>
		
	<select id="getEmpresasExternas" resultMap="baseResult">
		SELECT COD_COMP_TRAN CODIGO, 
          	   NOM_COMP_TRAN DESCRIPCION
		  FROM sto_centr_acopi
		 WHERE ind_como = 'A'
	</select>

	<resultMap id="listaProductosMapResult" class="java.util.HashMap">
		<result property="codigo"		    column="CODIGO"/>
		<result property="codigoSAP"		column="CODIGOSAP"/>
    	<result property="descripcion"	    column="DESCRIPCION"/>
    	<result property="empresaExterna"   column="EMPRESA"/>
    	<result property="indicadorImprime" column="IMPRIME"/>
	</resultMap>
		
	<select id="getProductosNoalmPlantaPrincipalByCriteria" parameterClass="java.util.Map" resultMap="listaProductosMapResult">
		SELECT 	a.oid_prod			CODIGO,
				a.cod_Sap           CODIGOSAP,
         	   	i18prod.val_i18n	DESCRIPCION,
         	   	b.nom_comp_tran   	EMPRESA,
         	   	a.VAL_ATRI_2        IMPRIME
		  FROM mae_produ a, sto_centr_acopi b,
		         (SELECT v.val_oid, 
		         		 v.val_i18n
		            FROM v_gen_i18n_sicc v
		           WHERE v.attr_enti = 'MAE_PRODU' 
		             AND v.idio_oid_idio = 1
		         ) i18prod         
		 WHERE a.VAL_ATRI_3 = b. COD_COMP_TRAN(+)
		   AND a.oid_prod =  i18prod.val_oid(+) 
		 <isNotEmpty property="codigoProducto"> 
		   AND a.cod_sap = #codigoProducto#
		 </isNotEmpty>
		 <isNotEmpty property="descripcionProducto">
		   AND i18prod.val_i18n like #descripcionProducto#
		 </isNotEmpty>
		 <isNotEmpty property="codigoEmpresaExterna">
		   AND b.cod_comp_tran  = #codigoEmpresaExterna#
		 </isNotEmpty>
		 <isNotEmpty property="indicadorImprime">
		   AND a.VAL_ATRI_2   = #indicadorImprime#
		 </isNotEmpty>
	</select>
	
	<resultMap id="mantenimientoAPEProductoNoalmPlantaPrincipalResult" class="mantenimientoAPEProductoNoalmPlantaPrincipal">
  		<result property="codigoProducto"		  column="CODIGO"/>
		<result property="codigoSAP"			  column="CODIGOSAP"/>
    	<result property="descripcionProducto"	  column="DESCRIPCION"/>
    	<result property="codigoEmpresaExterna"   column="EMPRESA"/>
    	<result property="indicadorImprime" 	  column="IMPRIME"/>
    </resultMap>
    <select id="getProductoNoalmPlantaPrincipal" parameterClass="string" resultMap="mantenimientoAPEProductoNoalmPlantaPrincipalResult">
    	SELECT 	a.oid_prod			CODIGO,
				a.cod_Sap           CODIGOSAP,
         	   	i18prod.val_i18n	DESCRIPCION,
         	   	b.COD_COMP_TRAN   	EMPRESA,
         	   	a.VAL_ATRI_2        IMPRIME
		  FROM mae_produ a, sto_centr_acopi b,
		         (SELECT v.val_oid, 
		         		 v.val_i18n
		            FROM v_gen_i18n_sicc v
		           WHERE v.attr_enti = 'MAE_PRODU' 
		             AND v.idio_oid_idio = 1
		         ) i18prod         
		 WHERE a.VAL_ATRI_3 = b. COD_COMP_TRAN(+)
		   AND a.oid_prod =  i18prod.val_oid(+) 
		   AND a.oid_prod =  #value#
    </select>
    
    <update id="updateProductoNoalmPlantaPrincipal" parameterClass="mantenimientoAPEProductoNoalmPlantaPrincipal">
		UPDATE MAE_PRODU
		SET 
		VAL_ATRI_3 = #codigoEmpresaExterna#,
		VAL_ATRI_2 = #indicadorImprime#
		WHERE oid_prod = #codigoProducto#
    </update>
</sqlMap>