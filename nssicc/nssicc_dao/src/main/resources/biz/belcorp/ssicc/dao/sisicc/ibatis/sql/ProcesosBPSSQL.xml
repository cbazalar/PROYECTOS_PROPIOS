<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="sisicc.ProcesosBPSSQL">
<!--  ==============================    Alias   ==============================  -->
	<typeAlias alias="fuenteVentas" 		    type="biz.belcorp.ssicc.dao.sisicc.model.FuenteVentas"/>
	<typeAlias alias="fuenteVentasZona" 		type="biz.belcorp.ssicc.dao.sisicc.model.FuenteVentasZona"/>
	<typeAlias alias="fuenteVentasRegion" 		type="biz.belcorp.ssicc.dao.sisicc.model.FuenteVentasRegion"/>
	<typeAlias alias="fuenteVentasPais" 		type="biz.belcorp.ssicc.dao.sisicc.model.FuenteVentasPais"/>
	<typeAlias alias="consultaFuenteVentas"     type="biz.belcorp.ssicc.dao.sisicc.model.ConsultaFuenteVentas"/>
	<typeAlias alias="estructuraCargaFuenteVentaPrevista"  type="biz.belcorp.ssicc.dao.sisicc.model.EstructuraFuenteVentaPrevista" />

    <!--  ==============================    resultMap   ==============================  -->
  	<resultMap id="fuenteVentasResult"           class="fuenteVentas">
    	<result property="codigoFuenteVentas"     column="COR_VEPR"/>
    	<result property="codigoPais" 			  column="PAIS_COD_PAIS"/> 
    	<result property="codigoSociedad" 	      column="COD_SOCI"/>
	    <result property="codigoAlmacen" 		  column="COD_ALMA"/>
	    <result property="codigoRegion" 		  column="COD_REGI"/>
		<result property="codigoMarca" 			  column="COD_MARC"/>	    
	    <result property="codigoCanal" 			  column="COD_CANA"/>
	    <result property="codigoZona" 			  column="COD_ZONA"/>
	    <result property="codigoPeriodo" 		  column="COD_PERI"/>
	    <result property="actividadesIniciales"   column="NUM_ACIN" javaType="long" nullValue="0"/>
	    <result property="ingresos" 			  column="NUM_INGR" javaType="long" nullValue="0"/>
	    <result property="reingresos" 			  column="NUM_REIN" javaType="long" nullValue="0"/>
	    <result property="egresos" 				  column="NUM_EGPU" javaType="long" nullValue="0"/>
	    <result property="porcentajeActividad" 	  column="POR_ACTI" javaType="double" nullValue="0"/>
	    <result property="ppu" 					  column="VAL_PPU"  javaType="double" nullValue="0"/>
	    <result property="pup" 					  column="VAL_PUP"  javaType="double" nullValue="0"/>
	    <result property="numeroClientes" 		  column="NUM_CLIE" javaType="long" nullValue="0"/>
	    <result property="estado" 			      column="EST_VEPR"/>
	    <result property="codigoAnio"       	  column="COD_ANIO"/>
	    <result property="codigoRangoPeriodo" 	  column="COD_RANGO"/>
	    <result property="codigoPeriodoAnio"	  column="COD_PERIO_ANIO"/>
	    <result property="secuencia" 			  column="SECUENCIA" javaType="int" nullValue="0"/>
	    <result property="fechaFinPeriodo" 		  column="FEC_FIN"/>
	    <result property="estadoAbierto" 		  column="EST_ABI"/>
	    <!-- Ini efernandezo -->
		<result property="actividadLider"				column="VAL_ACTI_LIDE"      javaType="double" nullValue="0"/>
		<result property="numeroConsultoraCliPrivilege" column="NUM_CONS_CLIE_PRIV" javaType="long" nullValue="0"/>
		<result property="numeroClientesInsPrivilege"   column="NUM_CLIE_INSC_PRIV" javaType="long" nullValue="0"/>
		<result property="numeroClientesTrsPrivelege"   column="NUM_CLIE_TRAN_PRIV" javaType="long" nullValue="0"/>
		<result property="retencionSdoPeriodo"          column="VAL_RETE_2PED"		javaType="long" nullValue="0"/>
		<result property="retencionTerPeriodo"          column="VAL_RETE_3PED"		javaType="long" nullValue="0"/>
		<result property="retencionCuaPeriodo"          column="VAL_RETE_4PED"		javaType="long" nullValue="0"/>
		<result property="retencionActivas"             column="VAL_RETE_ACTI"		javaType="long" nullValue="0"/>
		<result property="porcentajeRotacion"           column="VAL_PORC_ROTA"		javaType="double" nullValue="0"/>
		<result property="posiblesEgresos"              column="VAL_POSI_EGRE"		javaType="long" nullValue="0"/>
		<result property="retencionPosEgresos"          column="VAL_RETE_POSI_EGRE" javaType="long" nullValue="0"/>
		<!-- Fin efernandezo -->
	    <result property="auditInfo.createdBy" 	  column="USU_DIGI"/>
        <result property="auditInfo.created" 	  column="FEC_DIGI"/>
        <result property="auditInfo.updatedBy" 	  column="USU_MODI"/>
        <result property="auditInfo.lastUpdated"  column="FEC_MODI"/>    	    	
	</resultMap>

  	<resultMap id="fuenteVentasZonaResult"        class="fuenteVentasZona">
    	<result property="codigoFuenteVentasZona" column="COR_VPZO"/>
    	<result property="codigoPais" 			  column="PAIS_COD_PAIS"/> 
    	<result property="codigoSociedad" 	      column="COD_SOCI"/>
	    <result property="codigoAlmacen" 		  column="COD_ALMA"/>
		<result property="codigoMarca" 			  column="COD_MARC"/>	    	    
	    <result property="codigoCanal" 			  column="COD_CANA"/>
	    <result property="codigoPeriodo" 		  column="COD_PERI"/>
	    <result property="codigoRegion" 		  column="COD_REGI"/>
	    <result property="codigoZona" 			  column="COD_ZONA"/>
	    <result property="actividadesIniciales"   column="NUM_ACIN" javaType="double" nullValue="0"/>
	    <result property="ingresos" 			  column="NUM_INGR" javaType="double" nullValue="0"/>
	    <result property="reingresos" 			  column="NUM_REIN" javaType="double" nullValue="0"/>
	    <result property="egresosNetos"  		  column="NUM_EGNE" javaType="double" nullValue="0"/>
	    <result property="porcentajeEgresosNetos" column="POR_EGNE" javaType="double" nullValue="0"/>
	    <result property="egresos" 				  column="NUM_EGPU" javaType="double" nullValue="0"/>
	    <result property="porcentajeEgresos" 	  column="POR_EGPU" javaType="double" nullValue="0"/>
	    <result property="capitalizacion"    	  column="VAL_CAPI" javaType="double" nullValue="0"/>
	    <result property="actividadesFinales" 	  column="NUM_ACFI" javaType="double" nullValue="0"/>
	    <result property="porcentajeActividad" 	  column="POR_ACTI" javaType="double" nullValue="0"/>
	    <result property="numeroPedidos"    	  column="NUM_PEDI" javaType="double" nullValue="0"/>
	    <result property="numeroUnidades"    	  column="NUM_UNID" javaType="double" nullValue="0"/>
	    <result property="numeroClientes" 		  column="NUM_CLIE" javaType="double" nullValue="0"/>
	    <result property="promedioSope" 		  column="PRO_SOPE" javaType="double" nullValue="0"/>
	    <result property="vene"         		  column="VAL_VENE" javaType="double" nullValue="0"/>
	    <result property="ppu" 					  column="VAL_PPU"  javaType="double" nullValue="0"/>
	    <result property="pup" 					  column="VAL_PUP"  javaType="double" nullValue="0"/>
   	    <result property="estado" 			      column="EST_VPZO"/>
		<result property="actividadLider"				column="VAL_ACTI_LIDE"      javaType="double" nullValue="0"/>
		<result property="numeroConsultoraCliPrivilege" column="NUM_CONS_CLIE_PRIV" javaType="long" nullValue="0"/>
		<result property="numeroClientesInsPrivilege"   column="NUM_CLIE_INSC_PRIV" javaType="long" nullValue="0"/>
		<result property="numeroClientesTrsPrivelege"   column="NUM_CLIE_TRAN_PRIV" javaType="long" nullValue="0"/>
		<result property="retencionSdoPeriodo"          column="VAL_RETE_2PED"		javaType="long" nullValue="0"/>
		<result property="retencionTerPeriodo"          column="VAL_RETE_3PED"		javaType="long" nullValue="0"/>
		<result property="retencionCuaPeriodo"          column="VAL_RETE_4PED"		javaType="long" nullValue="0"/>
		<result property="retencionActivas"             column="VAL_RETE_ACTI"		javaType="long" nullValue="0"/>
		<result property="porcentajeRotacion"           column="VAL_PORC_ROTA"		javaType="double" nullValue="0"/>
		<result property="posiblesEgresos"              column="VAL_POSI_EGRE"		javaType="long" nullValue="0"/>
		<result property="retencionPosEgresos"          column="VAL_RETE_POSI_EGRE" javaType="long" nullValue="0"/>
		
	 </resultMap>

  	<resultMap id="fuenteVentasRegionResult"      class="fuenteVentasRegion">
    	<result property="codigoFuenteVentasRegion" column="COR_VPRE"/>
    	<result property="codigoPais" 			  column="PAIS_COD_PAIS"/> 
    	<result property="codigoSociedad" 	      column="COD_SOCI"/>
	    <result property="codigoAlmacen" 		  column="COD_ALMA"/>
		<result property="codigoMarca" 			  column="COD_MARC"/>	    	    
	    <result property="codigoCanal" 			  column="COD_CANA"/>
	    <result property="codigoPeriodo" 		  column="COD_PERI"/>
	    <result property="codigoRegion" 		  column="COD_REGI"/>
	    <result property="actividadesIniciales"   column="NUM_ACIN"/>
	    <result property="ingresos" 			  column="NUM_INGR"/>
	    <result property="reingresos" 			  column="NUM_REIN"/>
	    <result property="egresosNetos"  		  column="NUM_EGNE"/>
	    <result property="porcentajeEgresosNetos" column="POR_EGNE"/>
	    <result property="egresos" 				  column="NUM_EGPU"/>
	    <result property="porcentajeEgresos" 	  column="POR_EGPU"/>
	    <result property="capitalizacion"    	  column="VAL_CAPI"/>
	    <result property="actividadesFinales" 	  column="NUM_ACFI"/>
	    <result property="porcentajeActividad" 	  column="POR_ACTI"/>
	    <result property="numeroPedidos"    	  column="NUM_PEDI"/>
	    <result property="numeroUnidades"    	  column="NUM_UNID"/>
	    <result property="numeroClientes" 		  column="NUM_CLIE"/>
	    <result property="promedioSope" 		  column="PRO_SOPE"/>
	    <result property="vene"         		  column="VAL_VENE"/>
	    <result property="ppu" 					  column="VAL_PPU"/>
	    <result property="pup" 					  column="VAL_PUP"/>
   	    <result property="estado" 			      column="EST_VPRE"/>	    
	 </resultMap>


  	<resultMap id="fuenteVentasPaisResult"       class="fuenteVentasPais">
    	<result property="codigoFuenteVentasPais" column="COR_VPPA"/>
    	<result property="codigoPais" 			  column="PAIS_COD_PAIS"/> 
    	<result property="codigoSociedad" 	      column="COD_SOCI"/>
	    <result property="codigoAlmacen" 		  column="COD_ALMA"/>
		<result property="codigoMarca" 			  column="COD_MARC"/>	    	    
	    <result property="codigoCanal" 			  column="COD_CANA"/>
	    <result property="codigoPeriodo" 		  column="COD_PERI"/>
	    <result property="actividadesIniciales"   column="NUM_ACIN" javaType="double" nullValue="0"/>
	    <result property="ingresos" 			  column="NUM_INGR" javaType="double" nullValue="0"/>
	    <result property="reingresos" 			  column="NUM_REIN" javaType="double" nullValue="0"/>
	    <result property="egresosNetos"  		  column="NUM_EGNE" javaType="double" nullValue="0"/>
	    <result property="porcentajeEgresosNetos" column="POR_EGNE" javaType="double" nullValue="0"/>
	    <result property="egresos" 				  column="NUM_EGPU" javaType="double" nullValue="0"/>
	    <result property="porcentajeEgresos" 	  column="POR_EGPU" javaType="double" nullValue="0"/>
	    <result property="capitalizacion"    	  column="VAL_CAPI" javaType="double" nullValue="0"/>
	    <result property="actividadesFinales" 	  column="NUM_ACFI" javaType="double" nullValue="0"/>
	    <result property="porcentajeActividad" 	  column="POR_ACTI" javaType="double" nullValue="0"/>
	    <result property="numeroPedidos"    	  column="NUM_PEDI" javaType="double" nullValue="0"/>
	    <result property="numeroUnidades"    	  column="NUM_UNID" javaType="double" nullValue="0"/>
	    <result property="numeroClientes" 		  column="NUM_CLIE" javaType="double" nullValue="0"/>
	    <result property="promedioSope" 		  column="PRO_SOPE" javaType="double" nullValue="0"/>
	    <result property="vene"         		  column="VAL_VENE" javaType="double" nullValue="0"/>
	    <result property="ppu" 					  column="VAL_PPU"  javaType="double" nullValue="0"/>
	    <result property="pup" 					  column="VAL_PUP"  javaType="double" nullValue="0"/>
   	    <result property="estado" 			      column="EST_VPPA"/>	    	    
	 </resultMap>

	<resultMap id="consultaFuenteVentasResult"    	class="consultaFuenteVentas">
    	<result property="periodo"   			    column="PERIODO"/> 
    	<result property="activasIniciales"         column="ACTIVASINICIALES"       javaType="double" nullValue="0"/>
	    <result property="ingresos" 			    column="INGRESOS"               javaType="double" nullValue="0"/>
	    <result property="reingresos" 			    column="REINGRESOS"             javaType="double" nullValue="0"/>
	    <result property="egresosNetos" 			column="EGRESOSNETOS"           javaType="double" nullValue="0"/>
	    <result property="porcentajeEgresosNetos" 	column="PORCENTAJEEGRESOSNETOS" javaType="double" nullValue="0"/>
	    <result property="egresosPuros" 			column="EGRESOSPUROS"           javaType="double" nullValue="0"/>
	    <result property="porcentajeEgresosPuros"	column="PORCENTAJEEGRESOSPUROS" javaType="double" nullValue="0"/>
    	<result property="capitalizacion"           column="CAPITALIZACION"         javaType="double" nullValue="0"/>
	    <result property="porcentajeActividad" 	    column="PORCENTAJEACTIVIDAD"    javaType="double" nullValue="0"/>
	    <result property="promedioVenta"        	column="PROMEDIOVENTA"          javaType="double" nullValue="0"/>
	    <result property="venta"                	column="VENTA"                  javaType="double" nullValue="0"/>
	    <result property="ppu" 					    column="PPU"                    javaType="double" nullValue="0"/>
	    <result property="pup" 					    column="PUP"                    javaType="double" nullValue="0"/>
    	<result property="unidades"                 column="UNIDADES"               javaType="double" nullValue="0"/>
    	<result property="pedidos"                  column="PEDIDOS"                javaType="double" nullValue="0"/>
    	<result property="clientes"                 column="CLIENTES"               javaType="double" nullValue="0"/>
	    <result property="activasFinales"           column="ACTIVASFINALES"         javaType="double" nullValue="0"/>

		<result property="actividadLider"				column="VAL_ACTI_LIDE"      javaType="double" nullValue="0"/>
		<result property="numeroConsultoraCliPrivilege" column="NUM_CONS_CLIE_PRIV" javaType="long" nullValue="0"/>
		<result property="numeroClientesInsPrivilege"   column="NUM_CLIE_INSC_PRIV" javaType="long" nullValue="0"/>
		<result property="numeroClientesTrsPrivelege"   column="NUM_CLIE_TRAN_PRIV" javaType="long" nullValue="0"/>
		<result property="retencionSdoPeriodo"          column="VAL_RETE_2PED"		javaType="long" nullValue="0"/>
		<result property="retencionTerPeriodo"          column="VAL_RETE_3PED"		javaType="long" nullValue="0"/>
		<result property="retencionCuaPeriodo"          column="VAL_RETE_4PED"		javaType="long" nullValue="0"/>
		<result property="retencionActivas"             column="VAL_RETE_ACTI"		javaType="long" nullValue="0"/>
		<result property="porcentajeRotacion"           column="VAL_PORC_ROTA"		javaType="double" nullValue="0"/>
		<result property="posiblesEgresos"              column="VAL_POSI_EGRE"		javaType="long" nullValue="0"/>
		<result property="retencionPosEgresos"          column="VAL_RETE_POSI_EGRE" javaType="long" nullValue="0"/>	    
	    
   	</resultMap>

	<resultMap id="ErrorCargaFuenteVentaPrevista" class="java.util.HashMap">      
		<result property="fila" column="VAL_FILA" />              
		<result property="codigoError" column="COD_ERRO" />       
		<result property="descripcionError" column="DES_ERRO" />  
   </resultMap>
   
   	<resultMap id="FechaCalcCargaFuenteVentaPrevista" class="java.util.HashMap">      
		<result property="fecCalc" column="FEC_CALC"/>
   </resultMap> 
	
	<resultMap id="CalcularCargaFuenteVentaPrevista" class="java.util.HashMap">      
						<result property="fila" column="FILA"					/>        
						<result property="codPais" column="COD_PAIS"					/>
						<result property="codSoci" column="COD_SOCI"          />
						<result property="codMarca" column="COD_MARC"	      />
						<result property="codAlma" column="COD_ALMA"          />
						<result property="codCanal" column="COD_CANA"        />
						<result property="codPerio" column="COD_PERI"        />
						<result property="codRegi" column="COD_REGI"		      />
						<result property="codZona" column="COD_ZONA"		      />
						<result property="venNetaCata" column="VEN_NETA_CATA" />
						<result property="valPedi" column="VAL_PEDI"          />
						<result property="valActiInic" column="VAL_ACTI_INIC" />
						<result property="valIngre" column="VAL_INGR"        />
						<result property="valReing" column="VAL_REIN"		    />
						<result property="valEgre" column="VAL_EGRE"		      />
						<result property="valConsPriv" column="VAL_CONS_PRIV" />
						<result property="valCliePriv" column="VAL_CLIE_PRIV" />
						<result property="valTranPriv" column="VAL_TRAN_PRIV" />
						<result property="valRentSegp" column="VAL_RENT_SEGP" />
						<result property="valRentTerp" column="VAL_RENT_TERP" />
						<result property="valRentCuap" column="VAL_RENT_CUAP" />
						<result property="valUnid" column="VAL_UNID"          />
						<result property="valPorcRent" column="VAL_PORC_RENT" />
						<result property="fecCalc" column="FEC_CALC"          />
						<result property="fecEnvio" column="FEC_ENVI"			  />
						<result property="actFina" column="ACT_FINA"		      />
						<result property="pup" column="VAL_PUP"		                />
						<result property="ppu" column="VAL_PPU"					          />
						<result property="porcActi" column="POR_ACTI"        />
						<result property="rentActi" column="REN_ACTI"		    />
						<result property="numClie" column="NUM_CLIE"		      />
						<result property="porRota" column="POR_ROTA"		      />
						<result property="porEgre" column="POR_EGRE"		      />
						<result property="rezReci" column="REZ_RECI"		      />
						<result property="rezEntr" column="REZ_ENTR"		      />
						<result property="posEgre" column="POS_EGRE"		      />
						<result property="actLide" column="ACT_LIDE"		      />
						<result property="porSolePed" column="PRO_SOLE_PEDI"   />		
   </resultMap> 

    <!--  ==============================   Lista de Objetos por Criteria   ==============================  -->
    
    <!--  MANTENIMIENTO - BPS - FUENTE VENTAS BUSCAR -->
    <select id="getFuenteVentas" parameterClass="java.util.Map" resultMap="fuenteVentasResult">
		SELECT    
          INT_SAB_VENTA_PREVI.COR_VEPR         AS COR_VEPR,
     	  INT_SAB_VENTA_PREVI.PAIS_COD_PAIS    AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI.COD_SOCI         AS COD_SOCI,
          INT_SAB_VENTA_PREVI.COD_ALMA         AS COD_ALMA, 
          INT_SAB_VENTA_PREVI.COD_REGI	       AS COD_REGI, 
          INT_SAB_VENTA_PREVI.COD_MARC         AS COD_MARC, 
          INT_SAB_VENTA_PREVI.COD_CANA         AS COD_CANA, 
          INT_SAB_VENTA_PREVI.COD_ZONA	       AS COD_ZONA, 
          INT_SAB_VENTA_PREVI.COD_PERI	       AS COD_PERI, 
          INT_SAB_VENTA_PREVI.NUM_ACIN         AS NUM_ACIN, 
          INT_SAB_VENTA_PREVI.NUM_INGR	       AS NUM_INGR, 
          INT_SAB_VENTA_PREVI.NUM_REIN         AS NUM_REIN, 
          INT_SAB_VENTA_PREVI.NUM_EGPU         AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI.POR_ACTI	       AS POR_ACTI, 
          INT_SAB_VENTA_PREVI.VAL_PPU	       AS VAL_PPU, 
          INT_SAB_VENTA_PREVI.VAL_PUP          AS VAL_PUP, 
          INT_SAB_VENTA_PREVI.NUM_CLIE         AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI.EST_VEPR	       AS EST_VEPR, 
          SUBSTR(INT_SAB_VENTA_PREVI.COD_PERI,0,4)    AS COD_ANIO, 
          #codigoRangoPeriodo#                    AS COD_RANGO, 
          SUBSTR(INT_SAB_VENTA_PREVI.COD_PERI,5,2)    AS COD_PERIO_ANIO,
		  '1'                               	  AS SECUENCIA, 
          CRA_PERIO.FEC_FINA	                  AS FEC_FIN,
          'N' AS EST_ABI, 
          <!-- ini efernandezo -->
		  INT_SAB_VENTA_PREVI.VAL_ACTI_LIDE 		AS VAL_ACTI_LIDE,
		  INT_SAB_VENTA_PREVI.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
		  INT_SAB_VENTA_PREVI.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
		  INT_SAB_VENTA_PREVI.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
		  INT_SAB_VENTA_PREVI.VAL_RETE_2PED			AS VAL_RETE_2PED,
		  INT_SAB_VENTA_PREVI.VAL_RETE_3PED			AS VAL_RETE_3PED,
		  INT_SAB_VENTA_PREVI.VAL_RETE_4PED			AS VAL_RETE_4PED,
		  INT_SAB_VENTA_PREVI.VAL_RETE_ACTI			AS VAL_RETE_ACTI,
		  INT_SAB_VENTA_PREVI.VAL_PORC_ROTA			AS VAL_PORC_ROTA,
		  INT_SAB_VENTA_PREVI.VAL_POSI_EGRE			AS VAL_POSI_EGRE,
		  INT_SAB_VENTA_PREVI.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE,
		  <!-- fin efernandezo -->
          INT_SAB_VENTA_PREVI.USU_DIGI	    	                      AS USU_DIGI, 
          INT_SAB_VENTA_PREVI.FEC_DIGI                                AS FEC_DIGI, 
          INT_SAB_VENTA_PREVI.USU_MODI      	                      AS USU_MODI, 
          INT_SAB_VENTA_PREVI.FEC_MODI                                AS FEC_MODI 	

        FROM
          INT_SAB_VENTA_PREVI,
	      SEG_PERIO_CORPO,
	      CRA_PERIO
        WHERE     (      (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
    		        AND  (INT_SAB_VENTA_PREVI.PAIS_COD_PAIS = #codigoPais#)  
    			    AND  (INT_SAB_VENTA_PREVI.COD_SOCI      = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI.COD_ALMA      = #codigoAlmacen#)        
       	    	    AND  (INT_SAB_VENTA_PREVI.COD_REGI	    = #codigoRegion#)        
        	  	    AND  (INT_SAB_VENTA_PREVI.COD_MARC      = #codigoMarca#)
        	  	    AND  (INT_SAB_VENTA_PREVI.COD_CANA      = #codigoCanal#)         
        	 	    AND  (INT_SAB_VENTA_PREVI.COD_ZONA	    = #codigoZona#)      
          	        AND  (INT_SAB_VENTA_PREVI.COD_PERI	    =  SEG_PERIO_CORPO.COD_PERI)       
                    <![CDATA[
           	        AND  (SEG_PERIO_CORPO.COD_PERI      <= #periodoMayor#)
				    AND  (SEG_PERIO_CORPO.COD_PERI      >= #periodoMenor#)
                    ]]>
		         )	       
      	ORDER BY COD_PERI,19,1		
	</select>

    <!--  MANTENIMIENTO - BPS - FUENTE VENTAS ZONA BUSCAR -->
	<select id="getFuenteVentasZona" parameterClass="java.util.Map" resultMap="fuenteVentasZonaResult">
		<![CDATA[
		SELECT DISTINCT
          INT_SAB_VENTA_PREVI_ZONA.COR_VPZO          AS COR_VPZO,
     	  INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS     AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI_ZONA.COD_SOCI          AS COD_SOCI,
          INT_SAB_VENTA_PREVI_ZONA.COD_ALMA          AS COD_ALMA, 
          INT_SAB_VENTA_PREVI_ZONA.COD_MARC          AS COD_MARC,           
          INT_SAB_VENTA_PREVI_ZONA.COD_CANA          AS COD_CANA, 
          INT_SAB_VENTA_PREVI_ZONA.COD_PERI	         AS COD_PERI, 
          INT_SAB_VENTA_PREVI_ZONA.COD_REGI	         AS COD_REGI, 
          INT_SAB_VENTA_PREVI_ZONA.COD_ZONA	         AS COD_ZONA, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_ACIN          AS NUM_ACIN,
          INT_SAB_VENTA_PREVI_ZONA.NUM_INGR	         AS NUM_INGR, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_REIN          AS NUM_REIN, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_EGNE          AS NUM_EGNE, 
          INT_SAB_VENTA_PREVI_ZONA.POR_EGNE          AS POR_EGNE, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_EGPU          AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI_ZONA.POR_EGPU          AS POR_EGPU, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_CAPI          AS VAL_CAPI, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_ACFI          AS NUM_ACFI, 
          INT_SAB_VENTA_PREVI_ZONA.POR_ACTI	         AS POR_ACTI, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_PEDI          AS NUM_PEDI, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_UNID          AS NUM_UNID, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE          AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI_ZONA.PRO_SOPE	         AS PRO_SOPE, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_VENE          AS VAL_VENE, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_PPU	         AS VAL_PPU, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_PUP           AS VAL_PUP, 
          INT_SAB_VENTA_PREVI_ZONA.EST_VPZO          AS EST_VPZO,           
		  INT_SAB_VENTA_PREVI_ZONA.VAL_ACTI_LIDE 		AS VAL_ACTI_LIDE,
		  INT_SAB_VENTA_PREVI_ZONA.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
		  INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
		  INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_2PED			AS VAL_RETE_2PED,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_3PED			AS VAL_RETE_3PED,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_4PED			AS VAL_RETE_4PED,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_ACTI			AS VAL_RETE_ACTI,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_PORC_ROTA			AS VAL_PORC_ROTA,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_POSI_EGRE			AS VAL_POSI_EGRE,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE,
          USU_DIGI	    	                      AS USU_DIGI, 
          FEC_DIGI                                AS FEC_DIGI, 
          USU_MODI      	                      AS USU_MODI, 
          FEC_MODI                                AS FEC_MODI 
        FROM
          INT_SAB_VENTA_PREVI_ZONA,
	      SEG_PERIO_CORPO,
	      CRA_PERIO
        WHERE     (      (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
    		        AND  (INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS = #codigoPais#)  
    			    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_SOCI      = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ALMA      = #codigoAlmacen#)        
       	    	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_REGI	     = #codigoRegion#)        
        	  	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_MARC      = #codigoMarca#)                	    	    
        	  	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_CANA      = #codigoCanal#)         
        	 	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ZONA	     = #codigoZona#)      
          	        AND  (INT_SAB_VENTA_PREVI_ZONA.COD_PERI	     =  SEG_PERIO_CORPO.COD_PERI)       
           	        AND  (SEG_PERIO_CORPO.COD_PERI      <= #periodoMayor#)
				    AND  (SEG_PERIO_CORPO.COD_PERI           >= #periodoMenor#)
		         )	       
      	ORDER BY 1		
		  ]]>
	</select>
	
    <!--  MANTENIMIENTO - BPS - FUENTE VENTAS REGION BUSCAR -->
	<select id="getFuenteVentasRegion" parameterClass="java.util.Map" resultMap="fuenteVentasRegionResult">
		<![CDATA[
		SELECT DISTINCT
          INT_SAB_VENTA_PREVI_REGIO.COR_VPRE          AS COR_VPRE,
     	  INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS     AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI_REGIO.COD_SOCI          AS COD_SOCI,
          INT_SAB_VENTA_PREVI_REGIO.COD_ALMA          AS COD_ALMA, 
          INT_SAB_VENTA_PREVI_REGIO.COD_MARC          AS COD_MARC,           
          INT_SAB_VENTA_PREVI_REGIO.COD_CANA          AS COD_CANA, 
          INT_SAB_VENTA_PREVI_REGIO.COD_PERI          AS COD_PERI, 
          INT_SAB_VENTA_PREVI_REGIO.COD_REGI          AS COD_REGI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_ACIN          AS NUM_ACIN,
          INT_SAB_VENTA_PREVI_REGIO.NUM_INGR          AS NUM_INGR, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_REIN          AS NUM_REIN, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_EGNE          AS NUM_EGNE, 
          INT_SAB_VENTA_PREVI_REGIO.POR_EGNE          AS POR_EGNE, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_EGPU          AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI_REGIO.POR_EGPU          AS POR_EGPU, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_CAPI          AS VAL_CAPI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_ACFI          AS NUM_ACFI, 
          INT_SAB_VENTA_PREVI_REGIO.POR_ACTI          AS POR_ACTI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_PEDI          AS NUM_PEDI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_UNID          AS NUM_UNID, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_CLIE          AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI_REGIO.PRO_SOPE          AS PRO_SOPE, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_VENE          AS VAL_VENE, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_PPU	          AS VAL_PPU, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_PUP           AS VAL_PUP,
          INT_SAB_VENTA_PREVI_REGIO.EST_VPRE          AS EST_VPRE,
          USU_DIGI	    	                      AS USU_DIGI, 
          FEC_DIGI                                AS FEC_DIGI, 
          USU_MODI      	                      AS USU_MODI, 
          FEC_MODI                                AS FEC_MODI 
        FROM
          INT_SAB_VENTA_PREVI_REGIO,
	      SEG_PERIO_CORPO,
	      CRA_PERIO
        WHERE     (      (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
    		        AND  (INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS = #codigoPais#)  
    			    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_SOCI      = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI_REGIO.COD_ALMA      = #codigoAlmacen#)        
       	    	    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_REGI	  = #codigoRegion#)        
        	  	    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_MARC      = #codigoMarca#)                	    	    
        	  	    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_CANA      = #codigoCanal#)         
          	        AND  (INT_SAB_VENTA_PREVI_REGIO.COD_PERI	  =  SEG_PERIO_CORPO.COD_PERI)       
           	        AND  (SEG_PERIO_CORPO.COD_PERI      <= #periodoMayor#)
				    AND  (SEG_PERIO_CORPO.COD_PERI           >= #periodoMenor#)
		         )	       
      	ORDER BY 1		
		  ]]>
	</select>	
	
	<!--  MANTENIMIENTO - BPS - FUENTE VENTAS PAIS BUSCAR -->
	<select id="getFuenteVentasPais" parameterClass="java.util.Map" resultMap="fuenteVentasPaisResult">
		<![CDATA[
		SELECT DISTINCT
          INT_SAB_VENTA_PREVI_PAIS.COR_VPPA          AS COR_VPPA,
     	  INT_SAB_VENTA_PREVI_PAIS.PAIS_COD_PAIS     AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI_PAIS.COD_SOCI          AS COD_SOCI,
          INT_SAB_VENTA_PREVI_PAIS.COD_ALMA          AS COD_ALMA, 
          INT_SAB_VENTA_PREVI_PAIS.COD_MARC          AS COD_MARC,           
          INT_SAB_VENTA_PREVI_PAIS.COD_CANA          AS COD_CANA, 
          INT_SAB_VENTA_PREVI_PAIS.COD_PERI          AS COD_PERI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_ACIN          AS NUM_ACIN,
          INT_SAB_VENTA_PREVI_PAIS.NUM_INGR          AS NUM_INGR, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_REIN          AS NUM_REIN, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_EGNE          AS NUM_EGNE, 
          INT_SAB_VENTA_PREVI_PAIS.POR_EGNE          AS POR_EGNE, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_EGPU          AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI_PAIS.POR_EGPU          AS POR_EGPU, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_CAPI          AS VAL_CAPI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_ACFI          AS NUM_ACFI, 
          INT_SAB_VENTA_PREVI_PAIS.POR_ACTI          AS POR_ACTI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_PEDI          AS NUM_PEDI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_UNID          AS NUM_UNID, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_CLIE          AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI_PAIS.PRO_SOPE          AS PRO_SOPE, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_VENE          AS VAL_VENE, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_PPU	         AS VAL_PPU, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_PUP           AS VAL_PUP,
          INT_SAB_VENTA_PREVI_PAIS.EST_VPPA          AS EST_VPPA,
          USU_DIGI	    	                      AS USU_DIGI, 
          FEC_DIGI                                AS FEC_DIGI, 
          USU_MODI      	                      AS USU_MODI, 
          FEC_MODI                                AS FEC_MODI 
        FROM
          INT_SAB_VENTA_PREVI_PAIS,
	      SEG_PERIO_CORPO,
	      CRA_PERIO
        WHERE     (      (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
    		        AND  (INT_SAB_VENTA_PREVI_PAIS.PAIS_COD_PAIS = #codigoPais#)  
    			    AND  (INT_SAB_VENTA_PREVI_PAIS.COD_SOCI      = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI_PAIS.COD_ALMA      = #codigoAlmacen#)        
       	    	    AND  (INT_SAB_VENTA_PREVI_PAIS.COD_MARC      = #codigoMarca#)                   		  	
       	    	    AND  (INT_SAB_VENTA_PREVI_PAIS.COD_CANA      = #codigoCanal#)         
          	        AND  (INT_SAB_VENTA_PREVI_PAIS.COD_PERI	  =  SEG_PERIO_CORPO.COD_PERI)       
           	        AND  (SEG_PERIO_CORPO.COD_PERI      <= #periodoMayor#)
				    AND  (SEG_PERIO_CORPO.COD_PERI      >= #periodoMenor#)
		         )	       
      	ORDER BY 1		
		  ]]>
	</select>	

	<!-- ====================== Obtener si la campaña esta bloqueada o no... ============= -->
   <select id="getPeriodoAbierto" parameterClass="string"  resultClass="string">
		SELECT
		DECODE((CRA_PERIO.FEC_FINA - SYSDATE) - ABS((CRA_PERIO.FEC_FINA - SYSDATE)), 0, 'N','S') AS EST_ABI
		FROM SEG_PERIO_CORPO, CRA_PERIO
		WHERE ((SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
		AND ( #value# = SEG_PERIO_CORPO.COD_PERI))
	</select>

	
    <!--  ==============================   Objeto por PK   ==============================  -->

   <!--  MANTENIMIENTO - BPS - FUENTE VENTAS MODIFICAR -->
   <select id="getFuenteVenta" parameterClass="string"  resultMap="fuenteVentasResult">
		SELECT    INT_SAB_VENTA_PREVI.COR_VEPR         AS COR_VEPR,
     			  INT_SAB_VENTA_PREVI.PAIS_COD_PAIS    AS PAIS_COD_PAIS, 
		    	  INT_SAB_VENTA_PREVI.COD_SOCI         AS COD_SOCI,
		          INT_SAB_VENTA_PREVI.COD_ALMA         AS COD_ALMA, 
		          INT_SAB_VENTA_PREVI.COD_REGI	       AS COD_REGI, 
		          INT_SAB_VENTA_PREVI.COD_MARC         AS COD_MARC, 		          
		          INT_SAB_VENTA_PREVI.COD_CANA         AS COD_CANA, 
		          INT_SAB_VENTA_PREVI.COD_ZONA	       AS COD_ZONA, 
		          INT_SAB_VENTA_PREVI.COD_PERI	       AS COD_PERI, 
		          INT_SAB_VENTA_PREVI.NUM_ACIN         AS NUM_ACIN, 
		          INT_SAB_VENTA_PREVI.NUM_INGR	       AS NUM_INGR, 
	    	      INT_SAB_VENTA_PREVI.NUM_REIN         AS NUM_REIN, 
    	   	      INT_SAB_VENTA_PREVI.NUM_EGPU         AS NUM_EGPU, 
		          INT_SAB_VENTA_PREVI.POR_ACTI	       AS POR_ACTI, 
		          INT_SAB_VENTA_PREVI.VAL_PPU	       AS VAL_PPU, 
		          INT_SAB_VENTA_PREVI.VAL_PUP          AS VAL_PUP, 
		          INT_SAB_VENTA_PREVI.NUM_CLIE         AS NUM_CLIE, 
		          INT_SAB_VENTA_PREVI.EST_VEPR	       AS EST_VEPR, 
		          SUBSTR(INT_SAB_VENTA_PREVI.COD_PERI,0,4)    AS COD_ANIO, 
		          '01'                                    AS COD_RANGO, 
		          SUBSTR(INT_SAB_VENTA_PREVI.COD_PERI,5,2)    AS COD_PERIO_ANIO,
				  '1'                               	  AS SECUENCIA, 
		          CRA_PERIO.FEC_FINA	                  AS FEC_FIN,
                  <!-- A Eliminar Comentado momentaneamente a perido de Doris Martinich (CHR 07/03/2007)
		          DECODE((CRA_PERIO.FEC_FINA - SYSDATE) - ABS(CRA_PERIO.FEC_FINA - SYSDATE), 0, 'N','S') AS EST_ABI, 
                  -->
                  'N' AS EST_ABI, 
                  <!-- ini efernadezo --> 
				  INT_SAB_VENTA_PREVI.VAL_ACTI_LIDE 		AS VAL_ACTI_LIDE,
				  INT_SAB_VENTA_PREVI.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
				  INT_SAB_VENTA_PREVI.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
				  INT_SAB_VENTA_PREVI.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
				  INT_SAB_VENTA_PREVI.VAL_RETE_2PED			AS VAL_RETE_2PED,
				  INT_SAB_VENTA_PREVI.VAL_RETE_3PED			AS VAL_RETE_3PED,
				  INT_SAB_VENTA_PREVI.VAL_RETE_4PED			AS VAL_RETE_4PED,
				  INT_SAB_VENTA_PREVI.VAL_RETE_ACTI			AS VAL_RETE_ACTI,
				  INT_SAB_VENTA_PREVI.VAL_PORC_ROTA			AS VAL_PORC_ROTA,
				  INT_SAB_VENTA_PREVI.VAL_POSI_EGRE			AS VAL_POSI_EGRE,
				  INT_SAB_VENTA_PREVI.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE,
				  <!-- fin efernadezo -->                  
		          USU_DIGI	    	                      AS USU_DIGI, 
		          FEC_DIGI                                AS FEC_DIGI, 
		          USU_MODI      	                      AS USU_MODI, 
		          FEC_MODI                                AS FEC_MODI 
		FROM      INT_SAB_VENTA_PREVI,
	  	 	      SEG_PERIO_CORPO,
			      CRA_PERIO
		WHERE     (      (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
        		    AND  (INT_SAB_VENTA_PREVI.COD_PERI	    =  SEG_PERIO_CORPO.COD_PERI)       
           			AND  (INT_SAB_VENTA_PREVI.COR_VEPR =#value#)
		  		  )	       
	</select>
  
   <!--  MANTENIMIENTO - BPS - FUENTE VENTAS ZONA MODIFICAR -->
   <select id="getFuenteVentaZona" parameterClass="string" resultMap="fuenteVentasZonaResult">
		<![CDATA[
		SELECT    
          INT_SAB_VENTA_PREVI_ZONA.COR_VPZO          AS COR_VPZO,
     	  INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS     AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI_ZONA.COD_SOCI          AS COD_SOCI,
          INT_SAB_VENTA_PREVI_ZONA.COD_ALMA          AS COD_ALMA, 
          INT_SAB_VENTA_PREVI_ZONA.COD_CANA          AS COD_CANA, 
          INT_SAB_VENTA_PREVI_ZONA.COD_MARC          AS COD_MARC,           
          INT_SAB_VENTA_PREVI_ZONA.COD_PERI	         AS COD_PERI, 
          INT_SAB_VENTA_PREVI_ZONA.COD_REGI	         AS COD_REGI, 
          INT_SAB_VENTA_PREVI_ZONA.COD_ZONA	         AS COD_ZONA, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_ACIN          AS NUM_ACIN,
          INT_SAB_VENTA_PREVI_ZONA.NUM_INGR	         AS NUM_INGR, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_REIN          AS NUM_REIN, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_EGNE          AS NUM_EGNE, 
          INT_SAB_VENTA_PREVI_ZONA.POR_EGNE          AS POR_EGNE, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_EGPU          AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI_ZONA.POR_EGPU          AS POR_EGPU, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_CAPI          AS VAL_CAPI, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_ACFI          AS NUM_ACFI, 
          INT_SAB_VENTA_PREVI_ZONA.POR_ACTI	         AS POR_ACTI, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_PEDI          AS NUM_PEDI, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_UNID          AS NUM_UNID, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE          AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI_ZONA.PRO_SOPE	         AS PRO_SOPE, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_VENE          AS VAL_VENE, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_PPU	         AS VAL_PPU, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_PUP           AS VAL_PUP, 
          INT_SAB_VENTA_PREVI_ZONA.EST_VPZO          AS EST_VPZO 
        FROM
          INT_SAB_VENTA_PREVI_ZONA
	    WHERE    INT_SAB_VENTA_PREVI_ZONA.COR_VPZO = #value# 
        ORDER BY 1		
		  ]]>
	</select>

    <!--  MANTENIMIENTO - BPS - FUENTE VENTAS REGION MODIFICAR -->
    <select id="getFuenteVentaRegion" parameterClass="string" resultMap="fuenteVentasRegionResult">
		<![CDATA[
		SELECT    
          INT_SAB_VENTA_PREVI_REGIO.COR_VPRE          AS COR_VPRE,
     	  INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS     AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI_REGIO.COD_SOCI          AS COD_SOCI,
          INT_SAB_VENTA_PREVI_REGIO.COD_ALMA          AS COD_ALMA, 
          INT_SAB_VENTA_PREVI_REGIO.COD_CANA          AS COD_CANA, 
          INT_SAB_VENTA_PREVI_REGIO.COD_MARC          AS COD_MARC,           
          INT_SAB_VENTA_PREVI_REGIO.COD_PERI	      AS COD_PERI, 
          INT_SAB_VENTA_PREVI_REGIO.COD_REGI	      AS COD_REGI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_ACIN          AS NUM_ACIN,
          INT_SAB_VENTA_PREVI_REGIO.NUM_INGR	      AS NUM_INGR, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_REIN          AS NUM_REIN, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_EGNE          AS NUM_EGNE, 
          INT_SAB_VENTA_PREVI_REGIO.POR_EGNE          AS POR_EGNE, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_EGPU          AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI_REGIO.POR_EGPU          AS POR_EGPU, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_CAPI          AS VAL_CAPI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_ACFI          AS NUM_ACFI, 
          INT_SAB_VENTA_PREVI_REGIO.POR_ACTI	      AS POR_ACTI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_PEDI          AS NUM_PEDI, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_UNID          AS NUM_UNID, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_CLIE          AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI_REGIO.PRO_SOPE	      AS PRO_SOPE, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_VENE          AS VAL_VENE, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_PPU	          AS VAL_PPU, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_PUP           AS VAL_PUP,
          INT_SAB_VENTA_PREVI_REGIO.EST_VPRE          AS EST_VPRE 
        FROM
          INT_SAB_VENTA_PREVI_REGIO
	     wHERE    INT_SAB_VENTA_PREVI_REGIO.COR_VPRE = #value# 
        ORDER BY 1		
		  ]]>
	</select>

    <!--  MANTENIMIENTO - BPS - FUENTE VENTAS PAIS MODIFICAR -->
    <select id="getFuenteVentaPais" parameterClass="string" resultMap="fuenteVentasPaisResult">
		<![CDATA[
		SELECT    
          INT_SAB_VENTA_PREVI_PAIS.COR_VPPA          AS COR_VPPA,
     	  INT_SAB_VENTA_PREVI_PAIS.PAIS_COD_PAIS     AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI_PAIS.COD_SOCI          AS COD_SOCI,
          INT_SAB_VENTA_PREVI_PAIS.COD_ALMA          AS COD_ALMA, 
          INT_SAB_VENTA_PREVI_PAIS.COD_CANA          AS COD_CANA, 
          INT_SAB_VENTA_PREVI_PAIS.COD_MARC          AS COD_MARC,           
          INT_SAB_VENTA_PREVI_PAIS.COD_PERI	         AS COD_PERI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_ACIN          AS NUM_ACIN,
          INT_SAB_VENTA_PREVI_PAIS.NUM_INGR	         AS NUM_INGR, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_REIN          AS NUM_REIN, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_EGNE          AS NUM_EGNE, 
          INT_SAB_VENTA_PREVI_PAIS.POR_EGNE          AS POR_EGNE, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_EGPU          AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI_PAIS.POR_EGPU          AS POR_EGPU, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_CAPI          AS VAL_CAPI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_ACFI          AS NUM_ACFI, 
          INT_SAB_VENTA_PREVI_PAIS.POR_ACTI	         AS POR_ACTI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_PEDI          AS NUM_PEDI, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_UNID          AS NUM_UNID, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_CLIE          AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI_PAIS.PRO_SOPE	         AS PRO_SOPE, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_VENE          AS VAL_VENE, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_PPU	         AS VAL_PPU, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_PUP           AS VAL_PUP,
          INT_SAB_VENTA_PREVI_PAIS.EST_VPPA          AS EST_VPPA 
        FROM
          INT_SAB_VENTA_PREVI_PAIS
        WHERE    INT_SAB_VENTA_PREVI_PAIS.COR_VPPA = #value# 
        ORDER BY 1		
		  ]]>
	</select>
	
  
    <!--  ==============================   Inserts   ==============================  -->
  
    <!--  MANTENIMIENTO INSERCION - BPS - FUENTE VENTAS -->
    <!-- efernandezo -->
    <insert id="insertFuenteVenta" parameterClass="fuenteVentas">
    	<![CDATA[
	    INSERT INTO INT_SAB_VENTA_PREVI 
	    (
		COR_VEPR, 
		PAIS_COD_PAIS,
		COD_SOCI,
		COD_ALMA,
		COD_MARC,
		COD_CANA,
		COD_PERI,
		COD_REGI,
		COD_ZONA,
		NUM_ACIN,
		NUM_INGR,
		NUM_REIN,
		NUM_EGPU,
		POR_ACTI,
		VAL_PPU, 
		VAL_PUP,
		NUM_CLIE,
		EST_VEPR,
		USU_DIGI, 
		FEC_DIGI,
	    VAL_ACTI_LIDE,
	    NUM_CONS_CLIE_PRIV, 
	    NUM_CLIE_INSC_PRIV, 
	    NUM_CLIE_TRAN_PRIV, 
	    VAL_RETE_2PED,
	    VAL_RETE_3PED,
	    VAL_RETE_4PED,
	    VAL_RETE_ACTI,
	    VAL_PORC_ROTA,
	    VAL_POSI_EGRE,
	    VAL_RETE_POSI_EGRE
		) 
	    VALUES 
	    (
	  	#codigoFuenteVentas#,
	  	#codigoPais#,
		#codigoSociedad#,
		#codigoAlmacen#,
		#codigoMarca#,
		#codigoCanal#,
		#codigoPeriodo#,
		#codigoRegion#,
		#codigoZona#,
		#actividadesIniciales#,
		#ingresos#,
		#reingresos#,
		#egresos#,
		#porcentajeActividad#,
		#ppu#,
		#pup#,
		#numeroClientes#,
		#estado#,
		#auditInfo.createdBy#,
	    #auditInfo.created#,
	    #actividadLider#,
	    #numeroConsultoraCliPrivilege#,
	    #numeroClientesInsPrivilege#,
	    #numeroClientesTrsPrivelege#,
	    #retencionSdoPeriodo#,
	    #retencionTerPeriodo#,
	    #retencionCuaPeriodo#,
	    #retencionActivas#,
	    #porcentajeRotacion#,
	    #posiblesEgresos#,
	    #retencionPosEgresos#      
	    )
	    ]]>
	</insert>

    <!--  MANTENIMIENTO INSERCION - BPS - FUENTE VENTAS ZONA -->
    <!-- Modificado efernandezo  -->
	<insert id="insertFuenteVentaZona" parameterClass="fuenteVentasZona">
    	<![CDATA[
	    INSERT INTO INT_SAB_VENTA_PREVI_ZONA 
	    (
		COR_VPZO, 
		PAIS_COD_PAIS,
		COD_SOCI,
		COD_ALMA,
		COD_MARC,		
		COD_CANA,
		COD_PERI,
		COD_REGI,
		COD_ZONA,
		NUM_ACIN,
		NUM_INGR,
		NUM_REIN,
		NUM_EGNE,
		POR_EGNE,
		NUM_EGPU,
		POR_EGPU,
		VAL_CAPI,
		NUM_ACFI,
		POR_ACTI,
        NUM_PEDI,
        NUM_UNID,
		NUM_CLIE,
        PRO_SOPE,
 		VAL_VENE,
 		VAL_PPU, 
		VAL_PUP,
		EST_VPZO,
		USU_DIGI, 
		FEC_DIGI,
		VAL_ACTI_LIDE,
		NUM_CONS_CLIE_PRIV, 
		NUM_CLIE_INSC_PRIV, 
		NUM_CLIE_TRAN_PRIV, 
		VAL_RETE_2PED,      
		VAL_RETE_3PED,      
		VAL_RETE_4PED,      
		VAL_RETE_ACTI,      
		VAL_PORC_ROTA,      
		VAL_POSI_EGRE,      
		VAL_RETE_POSI_EGRE
		) 
	    VALUES 
	    (
	  	#codigoFuenteVentasZona#,
	  	#codigoPais#,
		#codigoSociedad#,
		#codigoAlmacen#,
		#codigoMarca#,
		#codigoCanal#,
		#codigoPeriodo#,
		#codigoRegion#,
		#codigoZona#,
		#actividadesIniciales#,
		#ingresos#,
		#reingresos#,
		#egresosNetos#,
		#porcentajeEgresosNetos#,
		#egresos#,
		#porcentajeEgresos#,
		#capitalizacion#,
		#actividadesFinales#,
		#porcentajeActividad#,
		#numeroPedidos#,
		#numeroUnidades#,
		#numeroClientes#,
		#promedioSope#,
		#vene#,
		#ppu#,
		#pup#,
		#estado#,
		#auditInfo.createdBy#,
	    #auditInfo.created#,
		#actividadLider#,
		#numeroConsultoraCliPrivilege#,
		#numeroClientesInsPrivilege#,   
		#numeroClientesTrsPrivelege#,   
		#retencionSdoPeriodo#,          
		#retencionTerPeriodo#,          
		#retencionCuaPeriodo#,          
		#retencionActivas#,             
		#porcentajeRotacion#,
		#posiblesEgresos#,              
		#retencionPosEgresos#
	    )
	    ]]>
	</insert>

    <!--  MANTENIMIENTO INSERCION - BPS - FUENTE VENTAS REGION -->
	<insert id="insertFuenteVentaRegion" parameterClass="fuenteVentasRegion">
    	<![CDATA[
	    INSERT INTO INT_SAB_VENTA_PREVI_REGIO 
	    (
		COR_VPRE, 
		PAIS_COD_PAIS,
		COD_SOCI,
		COD_ALMA,
		COD_MARC,
		COD_CANA,
		COD_PERI,
		COD_REGI,
		NUM_ACIN,
		NUM_INGR,
		NUM_REIN,
		NUM_EGNE,
		POR_EGNE,
		NUM_EGPU,
		POR_EGPU,
		VAL_CAPI,
		NUM_ACFI,
		POR_ACTI,
        NUM_PEDI,
        NUM_UNID,
		NUM_CLIE,
        PRO_SOPE,
 		VAL_VENE,
 		VAL_PPU, 
		VAL_PUP,
		EST_VPRE,
		USU_DIGI, 
		FEC_DIGI
		) 
	    VALUES 
	    (
	  	#codigoFuenteVentasRegion#,
	  	#codigoPais#,
		#codigoSociedad#,
		#codigoAlmacen#,
		#codigoMarca#,
		#codigoCanal#,
		#codigoPeriodo#,
		#codigoRegion#,
		#actividadesIniciales#,
		#ingresos#,
		#reingresos#,
		#egresosNetos#,
		#porcentajeEgresosNetos#,
		#egresos#,
		#porcentajeEgresos#,
		#capitalizacion#,
		#actividadesFinales#,
		#porcentajeActividad#,
		#numeroPedidos#,
		#numeroUnidades#,
		#numeroClientes#,
		#promedioSope#,
		#vene#,
		#ppu#,
		#pup#,
		#estado#,
		#auditInfo.createdBy#,
	    #auditInfo.created#
	    )
	    ]]>
	</insert>

    <!--  MANTENIMIENTO INSERCION - BPS - FUENTE VENTAS PAIS -->
    <insert id="insertFuenteVentaPais" parameterClass="fuenteVentasPais">
    	<![CDATA[
	    INSERT INTO INT_SAB_VENTA_PREVI_PAIS 
	    (
		COR_VPPA, 
		PAIS_COD_PAIS,
		COD_SOCI,
		COD_ALMA,
		COD_MARC,
		COD_CANA,
		COD_PERI,
		NUM_ACIN,
		NUM_INGR,
		NUM_REIN,
		NUM_EGNE,
		POR_EGNE,
		NUM_EGPU,
		POR_EGPU,
		VAL_CAPI,
		NUM_ACFI,
		POR_ACTI,
        NUM_PEDI,
        NUM_UNID,
		NUM_CLIE,
        PRO_SOPE,
 		VAL_VENE,
 		VAL_PPU, 
		VAL_PUP,
		EST_VPPA,
		USU_DIGI, 
		FEC_DIGI
		) 
	    VALUES 
	    (
	  	#codigoFuenteVentasPais#,
	  	#codigoPais#,
		#codigoSociedad#,
		#codigoAlmacen#,
		#codigoMarca#,		
		#codigoCanal#,
		#codigoPeriodo#,
		#actividadesIniciales#,
		#ingresos#,
		#reingresos#,
		#egresosNetos#,
		#porcentajeEgresosNetos#,
		#egresos#,
		#porcentajeEgresos#,
		#capitalizacion#,
		#actividadesFinales#,
		#porcentajeActividad#,
		#numeroPedidos#,
		#numeroUnidades#,
		#numeroClientes#,
		#promedioSope#,
		#vene#,
		#ppu#,
		#pup#,
		#estado#,
		#auditInfo.createdBy#,
	    #auditInfo.created#
	    )
	    ]]>
	</insert>

    <!--  ==============================   Updates    ==============================  -->

    <!--  MANTENIMIENTO ACTUALIZACION - BPS - FUENTE VENTAS -->
    <!-- Modificado x efernandezo -->
	<update id="updateFuenteVenta"       parameterClass="fuenteVentas">
    	<![CDATA[
	    UPDATE INT_SAB_VENTA_PREVI SET
		NUM_ACIN = #actividadesIniciales#,
		NUM_INGR = #ingresos#,
		NUM_REIN = #reingresos#,
		NUM_EGPU = #egresos#,
		POR_ACTI = #porcentajeActividad#,
		VAL_PPU  = #ppu#,
		VAL_PUP  = #pup#,
		NUM_CLIE = #numeroClientes#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#,
		VAL_ACTI_LIDE      = #actividadLider#,
		NUM_CONS_CLIE_PRIV = #numeroConsultoraCliPrivilege#,
		NUM_CLIE_INSC_PRIV = #numeroClientesInsPrivilege#,
		NUM_CLIE_TRAN_PRIV = #numeroClientesTrsPrivelege#,
		VAL_RETE_2PED      = #retencionSdoPeriodo#,
		VAL_RETE_3PED      = #retencionTerPeriodo#,
		VAL_RETE_4PED      = #retencionCuaPeriodo#,
		VAL_RETE_ACTI      = #retencionActivas#,
		VAL_PORC_ROTA      = #porcentajeRotacion#,
		VAL_POSI_EGRE      = #posiblesEgresos#,
		VAL_RETE_POSI_EGRE = #retencionPosEgresos#
	    WHERE COR_VEPR = #codigoFuenteVentas#
	    ]]>
	</update>

    <!--  MANTENIMIENTO ACTUALIZACION - BPS - FUENTE VENTAS ZONA -->
	<update id="updateFuenteVentaZona"       parameterClass="fuenteVentasZona">
    	<![CDATA[
	    UPDATE INT_SAB_VENTA_PREVI_ZONA SET
	    PAIS_COD_PAIS = #codigoPais#,
	    COD_SOCI = #codigoSociedad#,
	    COD_ALMA = #codigoAlmacen#,
	    COD_MARC = #codigoMarca#,	    
	    COD_CANA = #codigoCanal#,
	    COD_PERI = #codigoPeriodo#,
	    COD_REGI = #codigoRegion#,
	    COD_ZONA = #codigoZona#,
	    NUM_ACIN = #actividadesIniciales#,
		NUM_INGR = #ingresos#,
		NUM_REIN = #reingresos#,
		NUM_EGNE = #egresosNetos#,
		POR_EGNE = #porcentajeEgresosNetos#,
		NUM_EGPU = #egresos#,
		POR_EGPU = #porcentajeEgresos#,
		VAL_CAPI = #capitalizacion#,
		NUM_ACFI = #actividadesFinales#,
		POR_ACTI = #porcentajeActividad#,
		NUM_PEDI = #numeroPedidos#,
		NUM_UNID = #numeroUnidades#,
		NUM_CLIE = #numeroClientes#,
		PRO_SOPE = #promedioSope#,
		VAL_VENE = #vene#,
		VAL_PPU  = #ppu#,
		VAL_PUP  = #pup#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#
	    WHERE COR_VPZO = #codigoFuenteVentasZona#
	    ]]>
	</update>

    <!--  MANTENIMIENTO ACTUALIZACION - BPS - FUENTE VENTAS REGION -->
	<update id="updateFuenteVentaRegion"       parameterClass="fuenteVentasRegion">
    	<![CDATA[
	    UPDATE INT_SAB_VENTA_PREVI_REGIO SET
	    PAIS_COD_PAIS = #codigoPais#,
	    COD_SOCI = #codigoSociedad#,
	    COD_ALMA = #codigoAlmacen#,
	    COD_MARC = #codigoMarca#,	    
	    COD_CANA = #codigoCanal#,
	    COD_PERI = #codigoPeriodo#,
	    COD_REGI = #codigoRegion#,
	    NUM_ACIN = #actividadesIniciales#,
		NUM_INGR = #ingresos#,
		NUM_REIN = #reingresos#,
		NUM_EGNE = #egresosNetos#,
		POR_EGNE = #porcentajeEgresosNetos#,
		NUM_EGPU = #egresos#,
		POR_EGPU = #porcentajeEgresos#,
		VAL_CAPI = #capitalizacion#,
		NUM_ACFI = #actividadesFinales#,
		POR_ACTI = #porcentajeActividad#,
		NUM_PEDI = #numeroPedidos#,
		NUM_UNID = #numeroUnidades#,
		NUM_CLIE = #numeroClientes#,
		PRO_SOPE = #promedioSope#,
		VAL_VENE = #vene#,
		VAL_PPU  = #ppu#,
		VAL_PUP  = #pup#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#
	    WHERE COR_VPRE = #codigoFuenteVentasRegion#
	    ]]>
	</update>

    <!--  MANTENIMIENTO ACTUALIZACION - BPS - FUENTE VENTAS PAIS -->
	<update id="updateFuenteVentaPais"       parameterClass="fuenteVentasPais">
    	<![CDATA[
	    UPDATE INT_SAB_VENTA_PREVI_PAIS SET
	    PAIS_COD_PAIS = #codigoPais#,
	    COD_SOCI = #codigoSociedad#,
	    COD_ALMA = #codigoAlmacen#,
	    COD_MARC = #codigoMarca#,	    
	    COD_CANA = #codigoCanal#,
	    COD_PERI = #codigoPeriodo#,
	    NUM_ACIN = #actividadesIniciales#,
		NUM_INGR = #ingresos#,
		NUM_REIN = #reingresos#,
		NUM_EGNE = #egresosNetos#,
		POR_EGNE = #porcentajeEgresosNetos#,
		NUM_EGPU = #egresos#,
		POR_EGPU = #porcentajeEgresos#,
		VAL_CAPI = #capitalizacion#,
		NUM_ACFI = #actividadesFinales#,
		POR_ACTI = #porcentajeActividad#,
		NUM_PEDI = #numeroPedidos#,
		NUM_UNID = #numeroUnidades#,
		NUM_CLIE = #numeroClientes#,
		PRO_SOPE = #promedioSope#,
		VAL_VENE = #vene#,
		VAL_PPU  = #ppu#,
		VAL_PUP  = #pup#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#
	    WHERE COR_VPPA = #codigoFuenteVentasPais#
	    ]]>
	</update>


    <!--  ==============================   Removes    ==============================  -->

    <!--  MANTENIMIENTO ELIMINAR - BPS - FUENTE VENTAS REGION -->
	<delete id="removeFuenteVenta" parameterClass="string">
        DELETE FROM INT_SAB_VENTA_PREVI
	    WHERE COR_VEPR = #value#
	</delete>
	
	<delete id="removeFuenteVentaZonas" parameterClass="java.util.Map">
		<![CDATA[
        DELETE FROM INT_SAB_VENTA_PREVI_ZONA
	    WHERE    ((PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (COD_SOCI = #codigoSociedad#)        
        		 AND  (COD_ALMA = #codigoAlmacen#)        
       	    	 AND  (COD_MARC = #codigoMarca#)                 		 
       	    	 AND  (COD_CANA = #codigoCanal#)         
          	     AND  (COD_PERI >= #codigoPeriodoInicial#)
          	     AND  (COD_PERI <= #periodoFinalRango#)
          	   )	  
		]]>
	</delete>

    <!--  MANTENIMIENTO ELIMINAR - BPS - FUENTE VENTAS REGION ZONA -->
	<delete id="removeFuenteVentaZona" parameterClass="string">
        DELETE FROM INT_SAB_VENTA_PREVI_ZONA
	    WHERE COR_VPZO = #value#
	</delete>
	
	<delete id="removeFuenteVentaRegiones" parameterClass="java.util.Map">
		<![CDATA[
        DELETE FROM INT_SAB_VENTA_PREVI_REGIO
	    WHERE    ((PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (COD_SOCI = #codigoSociedad#)        
        		 AND  (COD_ALMA = #codigoAlmacen#)        
       	    	 AND  (COD_MARC = #codigoMarca#)         
       	    	 AND  (COD_CANA = #codigoCanal#)         
          	     AND  (COD_PERI >= #codigoPeriodoInicial#)
          	     AND  (COD_PERI <= #periodoFinalRango#)
          	   )	  
		]]>
	</delete>

    <!--  MANTENIMIENTO ELIMINAR - BPS - FUENTE VENTAS REGION REGION -->
	<delete id="removeFuenteVentaRegion" parameterClass="string">
        DELETE FROM INT_SAB_VENTA_PREVI_REGIO
	    WHERE COR_VPRE = #value#
	</delete>
	
	<delete id="removeFuenteVentaPaises" parameterClass="java.util.Map">
		<![CDATA[
        DELETE FROM INT_SAB_VENTA_PREVI_PAIS
	    WHERE    ((PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (COD_SOCI = #codigoSociedad#)        
        		 AND  (COD_ALMA = #codigoAlmacen#)        
        		 AND  (COD_MARC = #codigoMarca#)
       	    	 AND  (COD_CANA = #codigoCanal#)         
          	     AND  (COD_PERI >= #codigoPeriodoInicial#)
          	     AND  (COD_PERI <= #periodoFinalRango#)
          	   )	  
		]]>
	</delete>
	
    <!--  MANTENIMIENTO ELIMINAR - BPS - FUENTE VENTAS REGION PAIS -->
	<delete id="removeFuenteVentaPais" parameterClass="string">
        DELETE FROM INT_SAB_VENTA_PREVI_PAIS
	    WHERE COR_VPPA = #value#
	</delete>
	

    <!--  ==============================   PKs    ==============================  -->

    <select id="getNextPK" resultClass="string">
		SELECT  
		DECODE(COUNT(COR_VEPR), 0, '1',
        		MAX(COR_VEPR)+1) 
		FROM INT_SAB_VENTA_PREVI 
    </select>
	
	<select id="getNextPKZona" resultClass="string">
		SELECT  
		DECODE(COUNT(COR_VPZO), 0, '1',
        		MAX(COR_VPZO)+1) 
		FROM INT_SAB_VENTA_PREVI_ZONA 
    </select>
    
    <select id="getNextPKRegion" resultClass="string">
		SELECT  
		DECODE(COUNT(COR_VPRE), 0, '1',
        		 MAX(COR_VPRE)+1) 
		FROM INT_SAB_VENTA_PREVI_REGIO 
    </select>
    <select id="getNextPKPais" resultClass="string">
		SELECT  
		DECODE(COUNT(COR_VPPA), 0, '1',
        		 MAX(COR_VPPA)+1) 
		FROM INT_SAB_VENTA_PREVI_PAIS 
    </select>
    
    <!--  ==============================   Para el cálculo   ==============================  -->
    <!-- add modi de campos efernandezo -->
	<select id="getListaFuenteVentasForCalculo" parameterClass="java.util.Map" resultMap="fuenteVentasResult">
		<![CDATA[
		SELECT    
          INT_SAB_VENTA_PREVI.COR_VEPR         AS COR_VEPR,
     	  INT_SAB_VENTA_PREVI.PAIS_COD_PAIS    AS PAIS_COD_PAIS, 
    	  INT_SAB_VENTA_PREVI.COD_SOCI         AS COD_SOCI,
          INT_SAB_VENTA_PREVI.COD_ALMA         AS COD_ALMA, 
          INT_SAB_VENTA_PREVI.COD_REGI	       AS COD_REGI, 
          INT_SAB_VENTA_PREVI.COD_MARC         AS COD_MARC,           
          INT_SAB_VENTA_PREVI.COD_CANA         AS COD_CANA, 
          INT_SAB_VENTA_PREVI.COD_ZONA	       AS COD_ZONA, 
          INT_SAB_VENTA_PREVI.COD_PERI	       AS COD_PERI, 
          INT_SAB_VENTA_PREVI.NUM_ACIN         AS NUM_ACIN, 
          INT_SAB_VENTA_PREVI.NUM_INGR	       AS NUM_INGR, 
          INT_SAB_VENTA_PREVI.NUM_REIN         AS NUM_REIN, 
          INT_SAB_VENTA_PREVI.NUM_EGPU         AS NUM_EGPU, 
          INT_SAB_VENTA_PREVI.POR_ACTI	       AS POR_ACTI, 
          INT_SAB_VENTA_PREVI.VAL_PPU	       AS VAL_PPU, 
          INT_SAB_VENTA_PREVI.VAL_PUP          AS VAL_PUP, 
          INT_SAB_VENTA_PREVI.NUM_CLIE         AS NUM_CLIE, 
          INT_SAB_VENTA_PREVI.EST_VEPR	       AS EST_VEPR, 
          
          SUBSTR(INT_SAB_VENTA_PREVI.COD_PERI,0,4)    AS COD_ANIO, 
          SUBSTR(INT_SAB_VENTA_PREVI.COD_PERI,5,2)    AS COD_PERIO_ANIO,
          '0' AS  COD_RANGO,
          '0' AS  SECUENCIA,
    	  '1' AS  EST_ABI,
    	  SYSDATE AS FEC_FIN,

		  INT_SAB_VENTA_PREVI.VAL_ACTI_LIDE 		AS VAL_ACTI_LIDE,
		  INT_SAB_VENTA_PREVI.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
		  INT_SAB_VENTA_PREVI.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
		  INT_SAB_VENTA_PREVI.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
		  INT_SAB_VENTA_PREVI.VAL_RETE_2PED			AS VAL_RETE_2PED,
		  INT_SAB_VENTA_PREVI.VAL_RETE_3PED			AS VAL_RETE_3PED,
		  INT_SAB_VENTA_PREVI.VAL_RETE_4PED			AS VAL_RETE_4PED,
		  INT_SAB_VENTA_PREVI.VAL_RETE_ACTI			AS VAL_RETE_ACTI,
		  INT_SAB_VENTA_PREVI.VAL_PORC_ROTA			AS VAL_PORC_ROTA,
		  INT_SAB_VENTA_PREVI.VAL_POSI_EGRE			AS VAL_POSI_EGRE,
		  INT_SAB_VENTA_PREVI.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE,
   	  
          'ADMIN' AS USU_DIGI,
          SYSDATE AS FEC_DIGI,
          'ADMIN' AS USU_MODI,
          SYSDATE AS FEC_MODI
        
        FROM
          INT_SAB_VENTA_PREVI
	    WHERE     (      (INT_SAB_VENTA_PREVI.PAIS_COD_PAIS = #codigoPais#)  

    			    AND  (INT_SAB_VENTA_PREVI.COD_SOCI      = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI.COD_ALMA      = #codigoAlmacen#)        
       	    	    AND  (INT_SAB_VENTA_PREVI.COD_CANA      = #codigoCanal#)         
       	    	    AND  (INT_SAB_VENTA_PREVI.COD_MARC      = #codigoMarca#)                	    	    
          	        AND  (INT_SAB_VENTA_PREVI.COD_PERI	    >=#codigoPeriodoInicial# )
          	        AND  (INT_SAB_VENTA_PREVI.COD_PERI	    <=#periodoFinalRango# )
        	      )	       
      	ORDER BY 1		
		  ]]>
	</select>

	<select id="getListaFuenteVentasRegionForCalculo" parameterClass="java.util.Map" resultMap="fuenteVentasRegionResult">
		<![CDATA[
	SELECT  
	    INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS AS PAIS_COD_PAIS,
		INT_SAB_VENTA_PREVI_ZONA.COD_SOCI AS COD_SOCI,
		INT_SAB_VENTA_PREVI_ZONA.COD_ALMA AS COD_ALMA,
		INT_SAB_VENTA_PREVI_ZONA.COD_MARC AS COD_MARC,		
		INT_SAB_VENTA_PREVI_ZONA.COD_CANA AS COD_CANA, 
		INT_SAB_VENTA_PREVI_ZONA.COD_PERI AS COD_PERI,
		INT_SAB_VENTA_PREVI_ZONA.COD_REGI AS COD_REGI,
        
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_ACIN)  AS NUM_ACIN,
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_INGR)  AS NUM_INGR,
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_REIN)  AS NUM_REIN,
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_EGNE)  AS NUM_EGNE,
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_EGPU)  AS NUM_EGPU,
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_PEDI)  AS NUM_PEDI, 
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_UNID)  AS NUM_UNID, 
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE)  AS NUM_CLIE,
		SUM(INT_SAB_VENTA_PREVI_ZONA.NUM_ACFI)  AS NUM_ACFI,
		SUM(INT_SAB_VENTA_PREVI_ZONA.VAL_VENE)  AS VAL_VENE,
		
		'0' AS COR_VPRE,
		'0' AS POR_EGNE,
		'0' AS POR_EGPU,
		'0' AS VAL_CAPI,
		'0' AS POR_ACTI,
		'0' AS PRO_SOPE,
		'0' AS VAL_PPU,
		'0' AS VAL_PUP,
		'1' AS EST_VPRE
		
		FROM    INT_SAB_VENTA_PREVI_ZONA
		WHERE
        INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS= #codigoPais#  AND
		INT_SAB_VENTA_PREVI_ZONA.COD_SOCI =#codigoSociedad# AND
		INT_SAB_VENTA_PREVI_ZONA.COD_ALMA =#codigoAlmacen# AND
		INT_SAB_VENTA_PREVI_ZONA.COD_MARC =#codigoMarca# AND		
		INT_SAB_VENTA_PREVI_ZONA.COD_CANA =#codigoCanal# AND
		INT_SAB_VENTA_PREVI_ZONA.COD_PERI >= #codigoPeriodoInicial# AND
		INT_SAB_VENTA_PREVI_ZONA.COD_PERI <= #periodoFinalRango# 
		
		GROUP BY   INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS,
           INT_SAB_VENTA_PREVI_ZONA.COD_SOCI,
		   INT_SAB_VENTA_PREVI_ZONA.COD_ALMA,
		   INT_SAB_VENTA_PREVI_ZONA.COD_MARC,		   		   
		   INT_SAB_VENTA_PREVI_ZONA.COD_CANA,
		   INT_SAB_VENTA_PREVI_ZONA.COD_PERI,
	       INT_SAB_VENTA_PREVI_ZONA.COD_REGI
	    ORDER BY 1
		  ]]>
	</select>
  

	<select id="getListaFuenteVentasPaisForCalculo" parameterClass="java.util.Map" resultMap="fuenteVentasPaisResult">
	SELECT  
	    INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS AS PAIS_COD_PAIS,
		INT_SAB_VENTA_PREVI_REGIO.COD_SOCI AS COD_SOCI,
		INT_SAB_VENTA_PREVI_REGIO.COD_ALMA AS COD_ALMA,
		INT_SAB_VENTA_PREVI_REGIO.COD_MARC AS COD_MARC,		
		INT_SAB_VENTA_PREVI_REGIO.COD_CANA AS COD_CANA, 
		INT_SAB_VENTA_PREVI_REGIO.COD_PERI AS COD_PERI,
        
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_ACIN)  AS NUM_ACIN,
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_INGR)  AS NUM_INGR,
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_REIN)  AS NUM_REIN,
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_EGNE)  AS NUM_EGNE,
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_EGPU)  AS NUM_EGPU,
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_PEDI)  AS NUM_PEDI, 
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_UNID)  AS NUM_UNID, 
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_CLIE)  AS NUM_CLIE,
		SUM(INT_SAB_VENTA_PREVI_REGIO.NUM_ACFI)  AS NUM_ACFI,
		SUM(INT_SAB_VENTA_PREVI_REGIO.VAL_VENE)  AS VAL_VENE, 
		
	    '0' AS COR_VPPA,
		'0' AS POR_EGNE,
		'0' AS POR_EGPU,
		'0' AS VAL_CAPI,
		'0' AS POR_ACTI,
		'0' AS PRO_SOPE,
		'0' AS VAL_PPU,
		'0' AS VAL_PUP,
	    '1' AS EST_VPPA		
		<![CDATA[
		FROM    INT_SAB_VENTA_PREVI_REGIO
		WHERE
        INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS= #codigoPais#  AND
		INT_SAB_VENTA_PREVI_REGIO.COD_SOCI =#codigoSociedad# AND
		INT_SAB_VENTA_PREVI_REGIO.COD_ALMA =#codigoAlmacen# AND
		INT_SAB_VENTA_PREVI_REGIO.COD_CANA =#codigoCanal# AND
		INT_SAB_VENTA_PREVI_REGIO.COD_PERI >= #codigoPeriodoInicial# AND
		INT_SAB_VENTA_PREVI_REGIO.COD_PERI <= #periodoFinalRango# 
		  ]]>
		GROUP BY   INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS,
                   INT_SAB_VENTA_PREVI_REGIO.COD_SOCI,
		           INT_SAB_VENTA_PREVI_REGIO.COD_ALMA,
				   INT_SAB_VENTA_PREVI_REGIO.COD_MARC,
		           INT_SAB_VENTA_PREVI_REGIO.COD_CANA,
		           INT_SAB_VENTA_PREVI_REGIO.COD_PERI
	    ORDER BY 1
	</select>  
      
	<select id="verificaZona"  parameterClass="java.util.Map"  resultClass="string">
      SELECT   COUNT(INT_SAB_VENTA_PREVI_ZONA.COR_VPZO)
      FROM     INT_SAB_VENTA_PREVI_ZONA
      WHERE    (      (INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (INT_SAB_VENTA_PREVI_ZONA.COD_SOCI      = #codigoSociedad#)        
        		 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ALMA      = #codigoAlmacen#)        
       	    	 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_MARC      = #codigoMarca#)                 		 
       	    	 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_CANA      = #codigoCanal#)         
          	     AND  (INT_SAB_VENTA_PREVI_ZONA.COD_PERI	  = #codigoPeriodo#)
          	   	 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ZONA      = #codigoZona#)
		  	     AND  (INT_SAB_VENTA_PREVI_ZONA.COD_REGI      = #codigoRegion#)
          	   )	       
    </select>

	<select id="getPKZona"  parameterClass="java.util.Map"  resultClass="string">
      SELECT   INT_SAB_VENTA_PREVI_ZONA.COR_VPZO
      FROM     INT_SAB_VENTA_PREVI_ZONA
      WHERE    (      (INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (INT_SAB_VENTA_PREVI_ZONA.COD_SOCI      = #codigoSociedad#)        
        		 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ALMA      = #codigoAlmacen#)        
       	    	 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_MARC      = #codigoMarca#)                 		 
       	    	 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_CANA      = #codigoCanal#)         
          	     AND  (INT_SAB_VENTA_PREVI_ZONA.COD_PERI      = #codigoPeriodo#)
          	   	 AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ZONA      = #codigoZona#)
		  	     AND  (INT_SAB_VENTA_PREVI_ZONA.COD_REGI      = #codigoRegion#)
          	   )	       
    </select>


	<select id="verificaRegion"  parameterClass="java.util.Map"  resultClass="string">
      SELECT   COUNT(INT_SAB_VENTA_PREVI_REGIO.COR_VPRE)
      FROM     INT_SAB_VENTA_PREVI_REGIO
      WHERE    (      (INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (INT_SAB_VENTA_PREVI_REGIO.COD_SOCI      = #codigoSociedad#)        
        		 AND  (INT_SAB_VENTA_PREVI_REGIO.COD_ALMA      = #codigoAlmacen#)        
       	    	 AND  (INT_SAB_VENTA_PREVI_REGIO.COD_MARC      = #codigoMarca#)                 		         		 
       	    	 AND  (INT_SAB_VENTA_PREVI_REGIO.COD_CANA      = #codigoCanal#)         
          	     AND  (INT_SAB_VENTA_PREVI_REGIO.COD_PERI      = #codigoPeriodo#)
    	  	     AND  (INT_SAB_VENTA_PREVI_REGIO.COD_REGI      = #codigoRegion#)
          	   )	       
    </select>

	<select id="getPKRegion"  parameterClass="java.util.Map"  resultClass="string">
      SELECT   INT_SAB_VENTA_PREVI_REGIO.COR_VPRE
      FROM     INT_SAB_VENTA_PREVI_REGIO
      WHERE    (      (INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (INT_SAB_VENTA_PREVI_REGIO.COD_SOCI      = #codigoSociedad#)        
        		 AND  (INT_SAB_VENTA_PREVI_REGIO.COD_ALMA      = #codigoAlmacen#)        
       	    	 AND  (INT_SAB_VENTA_PREVI_REGIO.COD_MARC      = #codigoMarca#)                 		         		 
       	    	 AND  (INT_SAB_VENTA_PREVI_REGIO.COD_CANA      = #codigoCanal#)         
          	     AND  (INT_SAB_VENTA_PREVI_REGIO.COD_PERI      = #codigoPeriodo#)
    	  	     AND  (INT_SAB_VENTA_PREVI_REGIO.COD_REGI      = #codigoRegion#)
          	   )	       
    </select>


	<select id="verificaPais"  parameterClass="java.util.Map"  resultClass="string">
      SELECT   COUNT(INT_SAB_VENTA_PREVI_PAIS.COR_VPPA)
      FROM     INT_SAB_VENTA_PREVI_PAIS
      WHERE    (      (INT_SAB_VENTA_PREVI_PAIS.PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (INT_SAB_VENTA_PREVI_PAIS.COD_SOCI      = #codigoSociedad#)        
        		 AND  (INT_SAB_VENTA_PREVI_PAIS.COD_ALMA      = #codigoAlmacen#)        
       	    	 AND  (INT_SAB_VENTA_PREVI_PAIS.COD_MARC      = #codigoMarca#)                 		         		 
       	    	 AND  (INT_SAB_VENTA_PREVI_PAIS.COD_CANA      = #codigoCanal#)         
          	     AND  (INT_SAB_VENTA_PREVI_PAIS.COD_PERI      = #codigoPeriodo#)
          	   )	       
    </select>

	<select id="getPKPais"  parameterClass="java.util.Map"  resultClass="string">
      SELECT   INT_SAB_VENTA_PREVI_PAIS.COR_VPPA
      FROM     INT_SAB_VENTA_PREVI_PAIS
      WHERE    (      (INT_SAB_VENTA_PREVI_PAIS.PAIS_COD_PAIS = #codigoPais#)  
    		     AND  (INT_SAB_VENTA_PREVI_PAIS.COD_SOCI      = #codigoSociedad#)        
        		 AND  (INT_SAB_VENTA_PREVI_PAIS.COD_ALMA      = #codigoAlmacen#)        
       	    	 AND  (INT_SAB_VENTA_PREVI_PAIS.COD_MARC      = #codigoMarca#)                 		         		 
       	    	 AND  (INT_SAB_VENTA_PREVI_PAIS.COD_CANA      = #codigoCanal#)         
          	     AND  (INT_SAB_VENTA_PREVI_PAIS.COD_PERI      = #codigoPeriodo#)
          	   )	       
    </select>

 <!--  ==============================   Para las Consultas de Fuente Venta Prevista   ==============================  -->
	<!-- Modificacado x efernandezo-->
	<select id="getConsultaFuenteVentasPais" parameterClass="java.util.Map" resultMap="consultaFuenteVentasResult">
		<![CDATA[
		SELECT    
          SUBSTR(INT_SAB_VENTA_PREVI_PAIS.COD_PERI,5,2)         AS PERIODO,
     	  INT_SAB_VENTA_PREVI_PAIS.NUM_ACIN         AS ACTIVASINICIALES, 
    	  INT_SAB_VENTA_PREVI_PAIS.NUM_INGR         AS INGRESOS,
          INT_SAB_VENTA_PREVI_PAIS.NUM_REIN         AS REINGRESOS, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_EGNE	        AS EGRESOSNETOS, 
          INT_SAB_VENTA_PREVI_PAIS.POR_EGNE         AS PORCENTAJEEGRESOSNETOS, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_EGPU	        AS EGRESOSPUROS, 
          INT_SAB_VENTA_PREVI_PAIS.POR_EGPU	        AS PORCENTAJEEGRESOSPUROS, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_CAPI         AS CAPITALIZACION, 
          INT_SAB_VENTA_PREVI_PAIS.POR_ACTI	        AS PORCENTAJEACTIVIDAD, 
          INT_SAB_VENTA_PREVI_PAIS.PRO_SOPE         AS PROMEDIOVENTA, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_VENE         AS VENTA, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_PPU	        AS PPU, 
          INT_SAB_VENTA_PREVI_PAIS.VAL_PUP	        AS PUP, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_UNID         AS UNIDADES, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_PEDI         AS PEDIDOS, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_CLIE	        AS CLIENTES, 
          INT_SAB_VENTA_PREVI_PAIS.NUM_ACFI	        AS ACTIVASFINALES,
          INT_SAB_VENTA_PREVI_PAIS.VAL_ACTI_LIDE 		AS VAL_ACTI_LIDE,
		  INT_SAB_VENTA_PREVI_PAIS.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
		  INT_SAB_VENTA_PREVI_PAIS.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
		  INT_SAB_VENTA_PREVI_PAIS.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
		  INT_SAB_VENTA_PREVI_PAIS.VAL_RETE_2PED			AS VAL_RETE_2PED,
		  INT_SAB_VENTA_PREVI_PAIS.VAL_RETE_3PED			AS VAL_RETE_3PED,
		  INT_SAB_VENTA_PREVI_PAIS.VAL_RETE_4PED			AS VAL_RETE_4PED,
		  INT_SAB_VENTA_PREVI_PAIS.VAL_RETE_ACTI			AS VAL_RETE_ACTI,
		  INT_SAB_VENTA_PREVI_PAIS.VAL_PORC_ROTA			AS VAL_PORC_ROTA,
		  INT_SAB_VENTA_PREVI_PAIS.VAL_POSI_EGRE			AS VAL_POSI_EGRE,
		  INT_SAB_VENTA_PREVI_PAIS.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE  
        FROM
         INT_SAB_VENTA_PREVI_PAIS
        WHERE     (      
    		             (INT_SAB_VENTA_PREVI_PAIS.PAIS_COD_PAIS  = #codigoPais#)  
    			    AND  (INT_SAB_VENTA_PREVI_PAIS.COD_SOCI       = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI_PAIS.COD_ALMA       = #codigoAlmacen#)
          		  	AND  (INT_SAB_VENTA_PREVI_PAIS.COD_MARC       = #codigoMarca#)                 		           		  	 
       	    	    AND  (INT_SAB_VENTA_PREVI_PAIS.COD_CANA       = #codigoCanal#)         
        	 	    AND  (  (INT_SAB_VENTA_PREVI_PAIS.COD_PERI	 >= #periodoMenor#) AND
        	 	            (INT_SAB_VENTA_PREVI_PAIS.COD_PERI	 <= #periodoMayor#)
        	 	         )   
        	 	  )  
       	ORDER BY 1		
		  ]]>
	</select>
	<!-- Modificacado x efernandezo-->
	<select id="getConsultaFuenteVentasRegion" parameterClass="java.util.Map" resultMap="consultaFuenteVentasResult">
		<![CDATA[
		SELECT    
          SUBSTR(INT_SAB_VENTA_PREVI_REGIO.COD_PERI,5,2)         AS PERIODO,
     	  INT_SAB_VENTA_PREVI_REGIO.NUM_ACIN                     AS ACTIVASINICIALES, 
    	  INT_SAB_VENTA_PREVI_REGIO.NUM_INGR                     AS INGRESOS,
          INT_SAB_VENTA_PREVI_REGIO.NUM_REIN                     AS REINGRESOS, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_EGNE	                 AS EGRESOSNETOS, 
          INT_SAB_VENTA_PREVI_REGIO.POR_EGNE                     AS PORCENTAJEEGRESOSNETOS, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_EGPU	                 AS EGRESOSPUROS, 
          INT_SAB_VENTA_PREVI_REGIO.POR_EGPU	                 AS PORCENTAJEEGRESOSPUROS, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_CAPI                     AS CAPITALIZACION, 
          INT_SAB_VENTA_PREVI_REGIO.POR_ACTI	                 AS PORCENTAJEACTIVIDAD, 
          INT_SAB_VENTA_PREVI_REGIO.PRO_SOPE                     AS PROMEDIOVENTA, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_VENE                     AS VENTA, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_PPU	                     AS PPU, 
          INT_SAB_VENTA_PREVI_REGIO.VAL_PUP	                     AS PUP, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_UNID                     AS UNIDADES, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_PEDI                     AS PEDIDOS, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_CLIE	                 AS CLIENTES, 
          INT_SAB_VENTA_PREVI_REGIO.NUM_ACFI	                 AS ACTIVASFINALES,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_ACTI_LIDE 		AS VAL_ACTI_LIDE,
		  INT_SAB_VENTA_PREVI_REGIO.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
		  INT_SAB_VENTA_PREVI_REGIO.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
		  INT_SAB_VENTA_PREVI_REGIO.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_RETE_2PED			AS VAL_RETE_2PED,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_RETE_3PED			AS VAL_RETE_3PED,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_RETE_4PED			AS VAL_RETE_4PED,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_RETE_ACTI			AS VAL_RETE_ACTI,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_PORC_ROTA			AS VAL_PORC_ROTA,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_POSI_EGRE			AS VAL_POSI_EGRE,
		  INT_SAB_VENTA_PREVI_REGIO.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE          
        FROM
         INT_SAB_VENTA_PREVI_REGIO
        WHERE     (      
    		             (INT_SAB_VENTA_PREVI_REGIO.PAIS_COD_PAIS  = #codigoPais#)  
    			    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_SOCI       = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI_REGIO.COD_ALMA       = #codigoAlmacen#)        
       	    	    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_MARC       = #codigoMarca#)          		  	
       	    	    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_CANA       = #codigoCanal#)
       	    	    AND  (INT_SAB_VENTA_PREVI_REGIO.COD_REGI       = #codigoRegion#)
        	 	    AND  (  (INT_SAB_VENTA_PREVI_REGIO.COD_PERI	 >= #periodoMenor#) AND
        	 	            (INT_SAB_VENTA_PREVI_REGIO.COD_PERI	 <= #periodoMayor#)
        	 	         )   
        	 	  )  
       	ORDER BY 1		
		  ]]>
	</select>
	<!-- Modificacado x efernandezo-->
	<select id="getConsultaFuenteVentasZona" parameterClass="java.util.Map" resultMap="consultaFuenteVentasResult">
		<![CDATA[
		SELECT    
          SUBSTR(INT_SAB_VENTA_PREVI_ZONA.COD_PERI,5,2)         AS PERIODO,
     	  INT_SAB_VENTA_PREVI_ZONA.NUM_ACIN                     AS ACTIVASINICIALES, 
    	  INT_SAB_VENTA_PREVI_ZONA.NUM_INGR                     AS INGRESOS,
          INT_SAB_VENTA_PREVI_ZONA.NUM_REIN                     AS REINGRESOS, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_EGNE	                    AS EGRESOSNETOS, 
          INT_SAB_VENTA_PREVI_ZONA.POR_EGNE                     AS PORCENTAJEEGRESOSNETOS, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_EGPU	                    AS EGRESOSPUROS, 
          INT_SAB_VENTA_PREVI_ZONA.POR_EGPU	                    AS PORCENTAJEEGRESOSPUROS, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_CAPI                     AS CAPITALIZACION, 
          INT_SAB_VENTA_PREVI_ZONA.POR_ACTI	                    AS PORCENTAJEACTIVIDAD, 
          INT_SAB_VENTA_PREVI_ZONA.PRO_SOPE                     AS PROMEDIOVENTA, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_VENE                     AS VENTA, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_PPU	                    AS PPU, 
          INT_SAB_VENTA_PREVI_ZONA.VAL_PUP	                    AS PUP, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_UNID                     AS UNIDADES, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_PEDI                     AS PEDIDOS, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE	                    AS CLIENTES, 
          INT_SAB_VENTA_PREVI_ZONA.NUM_ACFI	                    AS ACTIVASFINALES,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_ACTI_LIDE 		AS VAL_ACTI_LIDE,
		  INT_SAB_VENTA_PREVI_ZONA.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
		  INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
		  INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_2PED			AS VAL_RETE_2PED,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_3PED			AS VAL_RETE_3PED,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_4PED			AS VAL_RETE_4PED,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_ACTI			AS VAL_RETE_ACTI,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_PORC_ROTA			AS VAL_PORC_ROTA,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_POSI_EGRE			AS VAL_POSI_EGRE,
		  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE
        FROM
         INT_SAB_VENTA_PREVI_ZONA
        WHERE     (      
    		             (INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS  = #codigoPais#)  
    			    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_SOCI       = #codigoSociedad#)        
          		  	AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ALMA       = #codigoAlmacen#)        
       	    	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_MARC       = #codigoMarca#)          		  	
       	    	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_CANA       = #codigoCanal#)
       	    	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_REGI       = #codigoRegion#)
       	    	    AND  (INT_SAB_VENTA_PREVI_ZONA.COD_ZONA       = #codigoZona#)
       	    	    AND  (  (INT_SAB_VENTA_PREVI_ZONA.COD_PERI	 >= #periodoMenor#) AND
        	 	            (INT_SAB_VENTA_PREVI_ZONA.COD_PERI	 <= #periodoMayor#)
        	 	         )   
        	 	  )  
       	ORDER BY 1		
		  ]]>
	</select>

	<!-- OBTIENE EL DIRECTORIO DEL SERVIDOR -->
	<select id="getPathUpload" parameterClass="string" resultClass="string">
		SELECT val_ruta_zoni FROM bas_pais WHERE cod_pais = #value#
	</select>
	
	<!-- BORRA TABLA TEMPORAL -->
	<procedure id="deleteTablasCargaFuenteVentaPrevista">
		{call BPS_PKG_PROCE.BPS_PR_ELIMI_TABLA_VENTA_PREVI }
	</procedure>
	
	<!-- INSERTA EN TABLA TEMPORAL -->
	<insert id="insertEstructuraCargaFuenteVentaPrevista" parameterClass="estructuraCargaFuenteVentaPrevista">
		<![CDATA[
	      	INSERT INTO BPS_CARGA_VENTA_PREVI (
	        VAL_FILA,     
			COD_PAIS,			
			COD_SOCI,			
			COD_MARC,		
			COD_ALMA,			
			COD_CANA,		
			COD_PERI,		
			COD_REGI,			
			COD_ZONA,			
			VEN_NETA_CATA,
			VAL_PEDI,			
			VAL_ACTI_INIC,
			VAL_INGR,		
			VAL_REIN,		
			VAL_EGRE,			
			VAL_CONS_PRIV,
			VAL_CLIE_PRIV,
			VAL_TRAN_PRIV,
			VAL_RENT_SEGP,
			VAL_RENT_TERP,
			VAL_RENT_CUAP,
			VAL_UNID,			
			VAL_PORC_RENT,
			COD_SECC,
			VAL_POSI_EGRE_CAM_ANT) 
	     VALUES ( 
			#fila#,
			#codigoPais#,
			#codigoSociedad#,
			#codigoMarca#,
			#codigoAlmacen#,
			#canal#,
			#periodo#,
			#codigoRegion#,
			#codigoZona#,
			#ventaNetaCatalogo#,
			#pedidos#,
			#activasIniciales#,
			#ingresos#,
			#reingresos#,
			#egresos#,
			#consultorasPrivilege#,
			#clientePrivilege#,
			#transaccionesPrivilege#,
			#retencionSegPedido#,
			#retencionTerPedido#,
			#retencionCuarPedido#,
			#unidades#,
			#porcentajeRetencion#,
			#codigoSeccion#,
			#posibleEgresoCampaniaAnterior#
	        )
	    ]]>
	</insert>
	
	<parameterMap id="paramEstructurasFuenteVentaPrevista" class="java.util.Map">
		<parameter property="oidCodPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codPeriIni" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codPeriFin" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="indTipoFvp" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="error"      jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<!-- VALIDA LA ESTRUCUTRA Y DATA DEL ARCHIVO -->
	<procedure id="executeValidarCargaFuenteVentaPrevista" parameterMap="paramEstructurasFuenteVentaPrevista">
		{call BPS_PKG_PROCE.BPS_PR_VALID_ESTRU_VENTA_PREVI(?,?,?,?,?) }
	</procedure>
	
	<!-- OBTIENE EL LISTADO DE ERRORES -->
	<select id="getErroresCargaFuenteVentaPrevista" resultMap="ErrorCargaFuenteVentaPrevista">		   
	SELECT VAL_FILA as "VAL_FILA",
          COD_ERRO as "COD_ERRO",
          DES_ERRO as "DES_ERRO"
     FROM BPS_ERROR_VENTA_PREVI
	</select>
	
	<parameterMap id="paramCalcularCargaFuenteVentaPrevista" class="java.util.Map">
		<parameter property="indTipoFvp" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
	
	<!-- CALCULA LA ESTRUCUTRA Y DATA DEL ARCHIVO -->
	<procedure id="executeCalcularCargaFuenteVentaPrevista" parameterMap="paramCalcularCargaFuenteVentaPrevista">
		{call BPS_PKG_PROCE.BPS_PR_CALCU_ESTRU_VENTA_PREVI(?) }
	</procedure>
	
		<!-- OBTIENE EL LISTADO DE CALCULO -->
	<select id="getCalcularCargaFuenteVentaPrevista" resultMap="CalcularCargaFuenteVentaPrevista">		   
	SELECT 
		VAL_FILA      as "FILA",          
		COD_PAIS			as "COD_PAIS",			
		COD_SOCI			as "COD_SOCI",
		COD_MARC			as "COD_MARC",			
		COD_ALMA			as "COD_ALMA",			
		COD_CANA			as "COD_CANA",			
		COD_PERI			as "COD_PERI",			
		COD_REGI			as "COD_REGI",			
		COD_ZONA			as "COD_ZONA",			
		VEN_NETA_CATA	as "VEN_NETA_CATA",	
		VAL_PEDI			as "VAL_PEDI",			
		VAL_ACTI_INIC	as "VAL_ACTI_INIC",	
		VAL_INGR			as "VAL_INGR",			
		VAL_REIN			as "VAL_REIN",			
		VAL_EGRE			as "VAL_EGRE",			
		VAL_CONS_PRIV	as "VAL_CONS_PRIV",	
		VAL_CLIE_PRIV	as "VAL_CLIE_PRIV",	
		VAL_TRAN_PRIV	as "VAL_TRAN_PRIV",	
		VAL_RENT_SEGP	as "VAL_RENT_SEGP",	
		VAL_RENT_TERP	as "VAL_RENT_TERP",	
		VAL_RENT_CUAP	as "VAL_RENT_CUAP",	
		VAL_UNID			as "VAL_UNID",			
		VAL_PORC_RENT	as "VAL_PORC_RENT",	
		TO_CHAR(FEC_CALC,'DD/MM/YYYY')			as "FEC_CALC",			
		TO_CHAR(FEC_ENVI,'DD/MM/YYYY')			as "FEC_ENVI",			
		ACT_FINA			as "ACT_FINA",			
		VAL_PUP						as "VAL_PUP",						
		VAL_PPU						as "VAL_PPU",						
		POR_ACTI			as "POR_ACTI",			
		REN_ACTI			as "REN_ACTI",			
		NUM_CLIE			as "NUM_CLIE",			
		POR_ROTA			as "POR_ROTA",			
		POR_EGRE			as "POR_EGRE",			
		REZ_RECI			as "REZ_RECI",			
		REZ_ENTR			as "REZ_ENTR",			
		POS_EGRE			as "POS_EGRE",			
		ACT_LIDE			as "ACT_LIDE",			
		PRO_SOLE_PEDI	as "PRO_SOLE_PEDI"
     FROM BPS_ZONA_VENTA_PREVI
	 ORDER BY COD_PERI,COD_REGI,COD_ZONA
	</select>
	
	<parameterMap id="paramUsuarioFuenteVentaPrevista" class="java.util.Map">
		<parameter property="oidPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="usuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="indTipoFvp" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
	
	<!-- ACTUALIZA LA ESTRUCUTRA Y DATA DEL ARCHIVO -->
	<procedure id="actualizarCargaFuenteVentaPrevista" parameterMap="paramUsuarioFuenteVentaPrevista" >
		{call BPS_PKG_PROCE.BPS_PR_ACTUA_ESTRU_VENTA_PREVI(?, ?, ?) }
	</procedure>	
	
	<!-- OBTIENE EL LISTADO DE FECHA DE CALCULO -->
	<select id="getFechaCalculo" resultMap="FechaCalcCargaFuenteVentaPrevista">		   
	SELECT C.FEC_CALC  as "FEC_CALC"
	FROM BPS_VALID_VENTA_PREVI C  
	WHERE C.FEC_CALC IS NOT NULL
	</select>	
	
	<!-- VALIDA CAMPAÑA CERRADA -->
	<select id="verificaCampCerrada" parameterClass="java.util.Map" resultClass="string">		   
		select BPS_PKG_PROCE.BPS_FN_CAMPA_CERRA_VENTA_PREVI(#codigoPais#,
															#codigoPeriodoInicio#,
															#codigoPeriodoFin#,
															#codigoMarca#,
															#codigoCanal#) from dual
	</select>
	
	<resultMap id="PeriodosYaCargados" class="java.util.HashMap">      
		<result property="codPeri" column="COD_PERI"/>
    </resultMap> 
   
	<!-- OBTIENE LISTADO DE PERIODOS YA CARGADOS -->
	<select id="getPeriodosYaCargados" parameterClass="java.util.Map"  resultMap="PeriodosYaCargados">
		SELECT DISTINCT (COD_PERI) as "COD_PERI"
		FROM INT_SAB_VENTA_PREVI_ZONA
		WHERE COD_PERI 
		<iterate prepend="IN" property="lista" open="(" close=")" conjunction=",">
				#lista[]#
		</iterate>
	</select>
	
	<resultMap id="PeriodosYaCargadosSeccion" class="java.util.HashMap">      
		<result property="codPeri" column="COD_PERI"/>
    </resultMap> 
   
	<!-- OBTIENE LISTADO DE PERIODOS YA CARGADOS POR SECCION -->
	<select id="getPeriodosYaCargadosSeccion" parameterClass="java.util.Map"  resultMap="PeriodosYaCargadosSeccion">
		SELECT DISTINCT (COD_PERI) as "COD_PERI"
		FROM INT_SAB_VENTA_PREVI_SECCI
		WHERE COD_PERI 
		<iterate prepend="IN" property="lista" open="(" close=")" conjunction=",">
				#lista[]#
		</iterate>
	</select>
</sqlMap>