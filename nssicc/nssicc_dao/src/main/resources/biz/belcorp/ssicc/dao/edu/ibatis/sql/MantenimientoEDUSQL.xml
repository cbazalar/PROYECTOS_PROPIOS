<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="edu.MantenimientoEDUSQL">

	<typeAlias alias="baseComboEdu" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
    <typeAlias alias="cursoCapacitacion" type="biz.belcorp.ssicc.dao.edu.model.CursoCapacitacion"/>
    <typeAlias alias="despachoProductoCurso" type="biz.belcorp.ssicc.dao.edu.model.DespachoProductoCurso"/>
    <typeAlias alias="regionCursoCapacitacion" type="biz.belcorp.ssicc.dao.edu.model.RegionCursoCapacitacion"/>				
    <typeAlias alias="zonaCursoCapacitacion" type="biz.belcorp.ssicc.dao.edu.model.ZonaCursoCapacitacion"/>					
    <typeAlias alias="cursoCapacitacionAmbito" type="biz.belcorp.ssicc.dao.edu.model.CursoCapacitacionAmbito"/>						
    <typeAlias alias="historicoAptas" type="biz.belcorp.ssicc.dao.edu.model.HistoricoAptas"/>						
    <typeAlias alias="historicoCapacitadas" type="biz.belcorp.ssicc.dao.edu.model.HistoricoCapacitadas"/>						
    <typeAlias alias="historicoCapacitadasDetalle" type="biz.belcorp.ssicc.dao.edu.model.HistoricoCapacitadasDetalle"/>						
    <typeAlias alias="historicoCursoDictado" type="biz.belcorp.ssicc.dao.edu.model.HistoricoCursoDictado"/>						
    <typeAlias alias="historicoCursoDictadoDetalle" type="biz.belcorp.ssicc.dao.edu.model.HistoricoCursoDictadoDetalle"/>						
    <typeAlias alias="planillaProgramacionCurso" type="biz.belcorp.ssicc.dao.edu.model.PlanillaProgramacionCurso"/>						
    <typeAlias alias="detallePlanilla" type="biz.belcorp.ssicc.dao.edu.model.DetallePlanilla"/>						
    <typeAlias alias="historicoPedido" type="biz.belcorp.ssicc.dao.edu.model.HistoricoPedido"/>						
    <typeAlias alias="consultaCursoCapacitacion" type="biz.belcorp.ssicc.dao.edu.model.ConsultaCursoCapacitacion"/>						
    <typeAlias alias="historicoPlanillaInstructora" type="biz.belcorp.ssicc.dao.edu.model.HistoricoPlanillaInstructora"/>						
    <typeAlias alias="equivalenciaMatrizServicio" type="biz.belcorp.ssicc.dao.edu.model.EquivalenciaMatrizServicio"/>						

	<resultMap id="historicoPlanillaInstructoraResult" class="historicoPlanillaInstructora">
		<result property="codigoPais"				column="PAIS_COD_PAIS"/>        
		<result property="codigoRegion"             column="REGI_COD_REGI"/>             
		<result property="estadoRegistro"           column="EST_REGI"/>             
		<result property="codigoEmpresa"            column="EMCO_COD_EMPR_COME"/>   
		<result property="codigoCurso"	          	column="CCAP_COD_CURS_CAPA"/>        
		<result property="codigoInstructora"        column="INST_COD_INST"/>             
	  	<result property="codigoPlanilla"           column="COD_PLAN_PROG"/>        
		<result property="codigoCursoDictado"       column="CDIC_COD_CURS_DICT"/>        
		<result property="situacionPlanilla"      	column="SIT_PLAN_PROG"/>        
    </resultMap>

   <resultMap id="baseResult" class="baseComboEdu">
      <result property="codigo" 		column="CODIGO" 	/>
      <result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>

	<resultMap id="historicoPedidoResult" class="historicoPedido">
		<result property="codigoPais"                column="PAIS_COD_PAIS"/>           
		<result property="codigoEmpresa"             column="EMCO_COD_EMPR_COME"/>      
		<result property="nombreEmpresa"             column="DES_EMPR_COME"/>
		<result property="codigoCliente"             column="COD_CLIE"/>      
		<result property="campanhaInicioPedido"      column="CAM_INIC_PEDI"/>                   
		<result property="campanhaUltimoPedido"      column="CAM_ULTI_PEDI"/>                   
		<result property="campanhaProceso"			 column="CAM_PROC"/>       
		<result property="codigoUltimoNivel"		 column="COD_ULTI_NIVE"/>  
		<result property="numeroPedidosFacturados"	 column="NUM_PEDI_FACT"/>  
		<result property="indicadorPedido"			 column="IND_PEDI"/>       
		<result property="indicadorFacturado"		 column="IND_FACT"/>       
		<result property="indicadorNuevo"			 column="IND_NUEV"/>       
		<result property="indicadorConstante"		 column="IND_CONS"/>       
		<result property="indicadorPrimerPedido"	 column="IND_PRIM_PEDI"/>  
	</resultMap>

	<resultMap id="detallePlanillaResult" class="detallePlanilla">
		<result property="codigoPais"                column="COD_PAIS"/>           
		<result property="codigoEmpresa"             column="COD_EMPR_COME"/>      
		<result property="nombreEmpresa"             column="DES_EMPR_COME"/>
		<result property="codigoCurso"               column="COD_CURS_CAPA"/>      
		<result property="nombreCurso"               column="NOM_CURS_CAPA"/>                   
		<result property="codigoCursoDictado"        column="COD_CURS_DICT"/>      
		<result property="codigoInstructora"         column="COD_INST"/>           
		<result property="campanhaInicio"            column="CAM_INIC_CURS"/>     
		<result property="fechaInicio"               column="FEC_INIC_CURS"/>      
		<result property="numeroSesiones"            column="NUM_REAL_DURA_SESI"/> 
		<result property="codigoRegion"              column="COD_REGI"/>           
		<result property="codigoZona"                column="COD_ZONA"/>           
		<result property="lugarCapacitacion"         column="LUG_CAPA"/>           
		<result property="categoriaLugarCapacitacion" column="CAT_LUGA_CAPA"/>      
		<result property="indicadorEvaluacionCurso"  column="IND_EVAL_CURS"/>      
		<result property="calificacionEvaluacionCurso"     column="CAL_PROM_CURS_DICT"/> 
		<result property="estadoCursoDictado"        column="EST_CURS_DICT"/>      
		<result property="estadoRegistro"            column="EST_REGI"/>           
		<result property="codigoPlanilla"            column="COD_PLAN_PROG"/>                         
		<result property="codigoCliente"             column="COD_CLIE"/>           
		<result property="indicadorAsistencia"       column="IND_ASIS"/>           
		<result property="apellidoPaterno"       	 column="APE_PATE"/>           
		<result property="apellidoMaterno"       	 column="APE_MATE"/>           
		<result property="primerNombre"       		 column="PRI_NOMB"/>           
		<result property="segundoNombre"       		 column="SEG_NOMB"/>           
		<result property="descripcionCliente"        column="DES_CLIENTE"/>           
		<result property="numeroTelefono"       	 column="NUM_TELE_PART"/>           
		<result property="campanhaIngreso"       	 column="CAM_INGR"/>           
		<result property="egresada"       	 		 column="STA_CLIE"/>
	</resultMap>

 	<resultMap id="planillaProgramacionCursoResult" class="planillaProgramacionCurso">
		<result property="codigoPais"				column="PAIS_COD_PAIS"/>      
		<result property="codigoEmpresa"            column="EMCO_COD_EMPR_COME"/> 
		<result property="nombreEmpresa"            column="DES_EMPR_COME"/>
		<result property="codigoCurso"              column="CCAP_COD_CURS_CAPA"/> 
		<result property="nombreCurso"              column="NOM_CURS_CAPA"/>
		<result property="codigoCliente"            column="CLIE_COD_CLIE"/>      
		<result property="codigoPlanilla"           column="COD_PLAN_PROG"/>      
		<result property="tipoCalificacion"         column="TIP_CALI_APTA"/>      
		<result property="indicadorCursoCosto"      column="IND_CURS_COST"/>      
		<result property="indicadorCursoFacturado"  column="IND_CURS_FACT"/>      
		<result property="estadoRegistro"           column="EST_REGI"/>           
  </resultMap>                                    
                                             
	<resultMap id="historicoCursoDictadoDetalleResult" class="historicoCursoDictadoDetalle">
		<result property="codigoPais"						column="PAIS_COD_PAIS"/>      
		<result property="codigoEmpresa"                    column="EMCO_COD_EMPR_COME"/> 
		<result property="nombreEmpresa"                    column="DES_EMPR_COME"/>
		<result property="codigoCurso"                      column="CCAP_COD_CURS_CAPA"/> 
		<result property="nombreCurso"                      column="NOM_CURS_CAPA"/>
		<result property="codigoCursoDictado"               column="CDIC_COD_CURS_DICT"/> 
		<result property="codigoCliente"                    column="CLIE_COD_CLIE"/>      
		<result property="codigoPlanillaProgramacion"       column="COD_PLAN_PROG"/>      
		<result property="calificacionInstructora"          column="CAL_INST"/>           
		<result property="estadoRegistro"                   column="EST_REGI"/>    
		<result property="apellidoPaterno"       	 		column="APE_PATE"/>           
		<result property="apellidoMaterno"       	 		column="APE_MATE"/>           
		<result property="primerNombre"       		 		column="PRI_NOMB"/>           
		<result property="segundoNombre"       		 		column="SEG_NOMB"/>           
		<result property="descripcionCliente"        		column="DES_CLIENTE"/>           
		<result property="indicadorAsistencia" 		 		column="IND_ASIS"/>           
		<result property="calificacionConsultora" 			column="CAL_CONS"/>           
		<result property="numeroTelefono" 	 				column="NUM_TELE_PART"/>
		<result property="campanhaIngreso"       	 		column="CAM_INGR"/>                      
		<result property="egresada"       	 		        column="STA_CLIE"/>                 
  </resultMap>                                    

  <resultMap id="planillaCursoDictadoResult" class="historicoCursoDictadoDetalle">
		<result property="codigoPlanillaProgramacion"       column="COD_PLAN_PROG"/>      
  </resultMap>                                    

  
  <resultMap id="historicoCursoDictadoResult" class="historicoCursoDictado">
		<result property="codigoPais"				  column="PAIS_COD_PAIS"/>      
		<result property="codigoEmpresa"              column="EMCO_COD_EMPR_COME"/> 
		<result property="nombreEmpresa"              column="DES_EMPR_COME"/>
		<result property="codigoCurso"                column="CCAP_COD_CURS_CAPA"/> 
		<result property="nombreCurso"                column="NOM_CURS_CAPA"/>
		<result property="codigoCursoDictado"         column="COD_CURS_DICT"/>      
		<result property="codigoInstructora"          column="INST_COD_INST"/>      
		<result property="campanhaInicio"             column="CAM_INIC_CURS"/>      
		<result property="fechaInicio"                column="FEC_INIC_CURS"/>      
		<result property="numeroSesiones"             column="NUM_REAL_DURA_SESI"/> 
		<result property="codigoRegion"				  column="COD_REGI"/>           
		<result property="descripcionRegion"          column="DES_REGI"/>
		<result property="codigoZona"                 column="COD_ZONA"/>           
		<result property="descripcionZona"            column="DES_ZONA"/>
		<result property="lugarCapacitacion"          column="LUG_CAPA"/>          
		<result property="categoriaLugar"         	  column="CAT_LUGA_CAPA"/>          
		<result property="indicadorEvaluacionCurso"   column="IND_EVAL_CURS"/>      
		<result property="calificacionPromedio"       column="CAL_PROM_CURS_DICT"/> 
		<result property="estadoRegistro"             column="EST_REGI"/>           
		<result property="estadoCursoDictado"         column="EST_CURS_DICT"/>    
		<result property="codigoLocal" 		          column="LOCA_COD_LOCA"/>    
		<result property="codigoSala" 		          column="SALA_COD_SALA"/>    
  </resultMap>                                    
  
	<resultMap id="historicoCapacitadasDetalleResult" class="historicoCapacitadasDetalle">
		<result property="codigoPais"							column="PAIS_COD_PAIS"/>           
		<result property="codigoEmpresa"                        column="EMCO_COD_EMPR_COME"/>      
		<result property="nombreEmpresa"                        column="DES_EMPR_COME"/>
		<result property="codigoCliente"                        column="CLIE_COD_CLIE"/>           
		<result property="codigoCurso"                          column="CCAP_COD_CURS_CAPA"/>      
		<result property="nombreCurso"                          column="NOM_CURS_CAPA"/>
		<result property="codigoTipoAsistencia"                 column="TASI_COD_TIPO_ASIS_CURS"/> 
		<result property="descripcionTipoAsistencia"            column="DES_TIPO_ASIS_CURS"/>
		<result property="codigoTipoAsistente"                  column="ASTT_COD_TIPO_ASTT_CURS"/> 
		<result property="descripcionTipoAsistente"             column="DES_TIPO_ASTT_CURS"/>
		<result property="numeroInvitaciones"                   column="NUM_INVI"/>                
		<result property="indicadorPagoCurso"                   column="IND_PAGO_CURS"/>           
		<result property="codigoCursoDictado"                   column="COD_CURS_DICT"/>           
		<result property="codigoInstructora"                    column="INST_COD_INST"/>                
		<result property="campanhaCapacitacion"                 column="CAM_CAPA"/>                
		<result property="campanhaRegistroAsistencia"           column="CAM_REGI_ASIS"/>           
		<result property="indicadorEvaluacionCurso"             column="IND_EVAL_CURS"/>           
		<result property="calificacionEvaluacionCurso"          column="CAL_EVAL_CURS"/>           
		<result property="indicadorEvaluacionInstructora"       column="IND_EVAL_INST"/>           
		<result property="calificacionEvaluacionInstructora"    column="CAL_EVAL_INST"/>           
		<result property="estadoRegistro"                       column="EST_REGI"/>  
		<result property="campanhaPrimeraCalificacionApta"      column="CAM_PRIM_CALI_APTA"/>  
		<result property="campanhaUltimaCalificacionApta"       column="CAM_ULTI_CALI_APTA"/>  
		<result property="codigoPlanilla"       				column="COD_PLAN_PROG"/>  
		<result property="apellidoPaterno"       	 			column="APE_PATE"/>           
		<result property="apellidoMaterno"       	 			column="APE_MATE"/>           
		<result property="primerNombre"       		 			column="PRI_NOMB"/>           
		<result property="segundoNombre"       		 			column="SEG_NOMB"/>           
		<result property="descripcionCliente"        			column="DES_CLIENTE"/>           
		<result property="numeroTelefono"       	 			column="NUM_TELE_PART"/>           
		<result property="campanhaIngreso"       	 			column="CAM_INGR"/>           
 </resultMap>                                                        
                                                          
 	<resultMap id="historicoCapacitadasResult" class="historicoCapacitadas">
	   <result property="codigoPais"			column = "PAIS_COD_PAIS"/>      
	   <result property="codigoEmpresa"       	column = "EMCO_COD_EMPR_COME"/> 
	   <result property="nombreEmpresa"         column = "DES_EMPR_COME"/>
	   <result property="codigoCliente"         column = "CLIE_COD_CLIE"/>    													      
	   <result property="nivelCapacitacion"     column = "NIV_CAPA_ALCA"/>      
	   <result property="campanhaIngreso"     	column = "CAM_INGR"/>           
	   <result property="ultimaCampanha"      	column = "ULT_CAMP_CAPA"/>      
	   <result property="estadoRegistro"      	column = "EST_REGI"/>         
 	</resultMap>                                                        
 	
 	<resultMap id="historicoAptasResult" class="historicoAptas">
		<result property="codigoPais"						  column = "PAIS_COD_PAIS"/>      
		<result property="codigoEmpresa"                      column = "EMCO_COD_EMPR_COME"/> 
		<result property="nombreEmpresa"                      column = "DES_EMPR_COME"/>
		<result property="codigoCurso"                        column = "CCAP_COD_CURS_CAPA"/> 
		<result property="nombreCurso"                        column = "NOM_CURS_CAPA"/>
		<result property="codigoCliente"                      column = "CLIE_COD_CLIE"/>      
		<result property="codigoCursoDictado"                 column = "COD_CURS_DICT"/>      
		<result property="codigoPlanillaProgramacion"         column = "COD_PLAN_PROG"/>      
		<result property="campanhaPrimeraCalificacionApta"    column = "CAM_PRIM_CALI_APTA"/> 
		<result property="campanhaUltimaCalificacionApta"     column = "CAM_ULTI_CALI_APTA"/> 
		<result property="tipoCalificacionApta"               column = "TIP_CALI_APTA"/>      
		<result property="numeroInvitacion"                   column = "NUM_INVI"/>           
		<result property="indicadorInicialCalificacionApta"   column = "IND_INIC_CALI_APTA"/> 
		<result property="indicadorFinalCalificacionApta"     column = "IND_FINA_CALI_APTA"/> 
		<result property="indicadorCursoCosto"                column = "IND_CURS_COST"/>      
		<result property="indicadorCursoFacturado"            column = "IND_CURS_FACT"/>      
		<result property="campanhaFacturacionCurso"           column = "CAM_FACT_CURS"/>      
		<result property="ultimaCampanhaProgramacionDictado"  column = "ULT_CAMP_PROG_DICT"/> 
		<result property="campanhaAceptacion"  				  column = "CAM_ACEP"/> 
		<result property="estadoCapacitacion"                 column = "EST_CAPA"/>           
		<result property="estadoRegistro"                     column = "EST_REGI"/>   
		<result property="apellidoPaterno"       	 		  column="APE_PATE"/>           
		<result property="apellidoMaterno"       	 		  column="APE_MATE"/>           
		<result property="primerNombre"       		 		  column="PRI_NOMB"/>           
		<result property="segundoNombre"       		 		  column="SEG_NOMB"/>           
		<result property="descripcionCliente"  		 		  column="DES_CLIENTE"/>           
		<result property="asistencia"       				  column="ASISTENCIA"/>	
	</resultMap>                                                        

 	<resultMap id="situacionHistoricoAptasResult" class="historicoAptas">
		<result property="codigoPais"						  column = "PAIS_COD_PAIS"/>      
		<result property="codigoEmpresa"                      column = "EMCO_COD_EMPR_COME"/> 
		<result property="nombreEmpresa"                      column = "DES_EMPR_COME"/>
		<result property="codigoCurso"                        column = "CCAP_COD_CURS_CAPA"/> 
		<result property="nombreCurso"                        column = "NOM_CURS_CAPA"/>
		<result property="codigoCliente"                      column = "CLIE_COD_CLIE"/>      
		<result property="codigoCursoDictado"                 column = "COD_CURS_DICT"/>      
		<result property="codigoPlanillaProgramacion"         column = "COD_PLAN_PROG"/>      
		<result property="campanhaPrimeraCalificacionApta"    column = "CAM_PRIM_CALI_APTA"/> 
		<result property="campanhaUltimaCalificacionApta"     column = "CAM_ULTI_CALI_APTA"/> 
		<result property="tipoCalificacionApta"               column = "TIP_CALI_APTA"/>      
		<result property="numeroInvitacion"                   column = "NUM_INVI"/>           
		<result property="indicadorInicialCalificacionApta"   column = "IND_INIC_CALI_APTA"/> 
		<result property="indicadorFinalCalificacionApta"     column = "IND_FINA_CALI_APTA"/> 
		<result property="indicadorCursoCosto"                column = "IND_CURS_COST"/>      
		<result property="indicadorCursoFacturado"            column = "IND_CURS_FACT"/>      
		<result property="campanhaFacturacionCurso"           column = "CAM_FACT_CURS"/>      
		<result property="ultimaCampanhaProgramacionDictado"  column = "ULT_CAMP_PROG_DICT"/> 
		<result property="campanhaAceptacion"  				  column = "CAM_ACEP"/> 
		<result property="estadoCapacitacion"                 column = "EST_CAPA"/>   
   		<result property="campanhaCapacitacion"               column = "CAM_CAPA"/>   
		<result property="estadoRegistro"                     column = "EST_REGI"/>   
		<result property="apellidoPaterno"       	 		  column="APE_PATE"/>           
		<result property="apellidoMaterno"       	 		  column="APE_MATE"/>           
		<result property="primerNombre"       		 		  column="PRI_NOMB"/>           
		<result property="segundoNombre"       		 		  column="SEG_NOMB"/>           
		<result property="descripcionCliente"  		 		  column="DES_CLIENTE"/>           
		<result property="asistencia"       				  column="ASISTENCIA"/>	
		<result property="codigoRegion"       				  column="COD_REGI"/>	
		<result property="codigoZona"						  column ="COD_ZONA"/>
		<result property="campanhaIngreso"					  column ="CAM_INGR_COME"/>
		<result property="prerequisito"					  	  column ="PRE_REQU_CAPA"/>
		<result property="siglaCurso"				  		  column ="SIG_CURS_CAPA"/>
		<result property="campanhaRegularizacion"			  column ="CAM_REGU"/>
		<result property="status"			  				  column ="STA_CLIE"/>
		<result property="situacionDescripcion"			  	  column ="EST_CAPA_DESC"/>
	</resultMap>                                                        

	<resultMap id="situacionHistoricoAptasExoneracionResult" class="historicoAptas">
		<result property="codigoPais"                         column = "PAIS_COD_PAIS"/> 
		<result property="codigoEmpresa"                      column = "EMCO_COD_EMPR_COME"/> 
        <result property="codigoCurso"                        column = "COD_CURS_CAPA"/> 
		<result property="nombreCurso"                        column = "NOM_CURS_CAPA"/>
		<result property="prerequisito"					  	  column ="PRE_REQU_CAPA"/>
		<result property="siglaCurso"				  		  column ="SIG_CURS_CAPA"/>
		<result property="primerPedido"				  		  column ="PRI_PEDI"/>
		<result property="secuenciaPedido"				  	  column ="SEC_PEDI"/>
        <result property="estadoCapacitacion"				  column ="EST_CAPA"/>
        <result property="codigoCliente"				  	  column ="CLIE_COD_CLIE"/>
		<result property="indicadorExoneracion"				  column ="IND_EXON_ASIS"/>
                                                                           
	</resultMap>       

 	<resultMap id="regionResult" class="regionCursoCapacitacion">
		<result property="codigoPais"						column ="PAIS_COD_PAIS"/>		                     			
		<result property="codigoRegion"						column ="COD_REGI"/>		                     					
		<result property="codigoRegionAnterior"				column ="COD_REGI_ANTE"/>		                     							
		<result property="descripcionRegion"                column ="DES_REGI"/>
		<result property="estadoRegistro"                   column ="EST_REGI"/>
		<result property="codigoEmpresa"                    column ="EMCO_COD_EMPR_COME"/>
		<result property="nombreEmpresa"                    column ="DES_EMPR_COME"/>
		<result property="codigoInstructora"                column ="INST_COD_INST"/>			
		<result property="correoInstructora"                column ="EMA_INST"/>			
		<result property="descripcionInstructora"           column ="DESC_COD_INST"/>	
		<result property="nombreGerenteRegional"            column ="NOM_GERE_REGI"/>	
		<result property="emailGerenteRegional"             column ="EMA_GERE_REGI"/>	
		<result property="codigoGerenteRegional"            column ="COD_GERE_REGI"/>	
	</resultMap>

 	<resultMap id="regionCursoCapacitacionResult" class="regionCursoCapacitacion">
		<result property="codigoPais"						column ="PAIS_COD_PAIS"/>		                     			
		<result property="codigoRegion"						column ="COD_REGI"/>		                     					
		<result property="codigoRegionAnterior"				column ="COD_REGI_ANTE"/>		                     							
		<result property="descripcionRegion"                column ="DES_REGI"/>
		<result property="estadoRegistro"                   column ="EST_REGI"/>
		<result property="codigoEmpresa"                    column ="EMCO_COD_EMPR_COME"/>
		<result property="codigoCurso"                      column ="CCAP_COD_CURS_CAPA"/>		
		<result property="codigoAmbito"                     column ="AMDI_COD_AMBI_DICT"/>			
		<result property="codigoInstructora"                column ="INST_COD_INST"/>			
	</resultMap>

 	<resultMap id="zonaResult" class="zonaCursoCapacitacion">
		<result property="codigoPais"						column ="PAIS_COD_PAIS"/>		                     			
		<result property="codigoRegion"						column ="COD_REGI"/>		                     					
		<result property="codigoZona"						column ="COD_ZONA"/>		
		<result property="codigoEmpresa"                    column ="EMCO_COD_EMPR_COME"/>                       							
		<result property="codigoZonaAnterior"				column ="COD_ZONA_ANTE"/>		                     							
		<result property="descripcionZona"                  column ="DES_ZONA"/>
		<result property="estadoRegistro"                   column ="EST_REGI"/>
		<result property="descripcionRegion"                column ="DES_REGI"/>
		<result property="descripcionEmpresa"               column ="DES_EMPR_COME"/>
        <result property="correoGerenteZona"                column ="EMA_GERE_ZONA"/>
	</resultMap>

 	<resultMap id="zonaCursoCapacitacionResult" class="zonaCursoCapacitacion">
		<result property="codigoPais"						column ="PAIS_COD_PAIS"/>		                     			
		<result property="codigoRegion"						column ="COD_REGI"/>		                     					
		<result property="codigoZona"						column ="COD_ZONA"/>		                     							
		<result property="codigoZonaAnterior"				column ="COD_ZONA_ANTE"/>		                     							
		<result property="descripcionZona"                  column ="DES_ZONA"/>
		<result property="estadoRegistro"                   column ="EST_REGI"/>
		<result property="codigoEmpresa"                    column ="EMCO_COD_EMPR_COME"/>
		<result property="codigoCurso"                      column ="CCAP_COD_CURS_CAPA"/>		
		<result property="codigoAmbito"                     column ="AMDI_COD_AMBI_DICT"/>
		<result property="correoGerenteZona"                column ="EMA_GERE_ZONA"/>						
	</resultMap>

 	<resultMap id="cursoCapacitacionAmbitoResult" class="cursoCapacitacionAmbito">
		<result property="codigoPais"					column="PAIS_COD_PAIS"/>       
		<result property="codigoEmpresa"                column="EMCO_COD_EMPR_COME"/>  
		<result property="codigoCurso"                	column="CCAP_COD_CURS_CAPA"/>  
		<result property="correlativo"					column="COR_PARAM_CURS_AMBI"/> 
		<result property="codigoAmbito" 				column="AMDI_COD_AMBI_DICT"/>    
		<result property="codigoRegion"                 column="COD_REGI"/>     
		<result property="descripcionRegion"            column="DES_REGI"/>     		
		<result property="codigoZona"             		column="COD_ZONA"/>            
		<result property="descripcionZona"             	column="DES_ZONA"/>            
		<result property="codigoClasificacion" 	        column="COD_CLAS"/>            
		<result property="auditInfo.createdBy" 			column ="USU_DIGI"/>
		<result property="auditInfo.created" 			column ="FEC_DIGI"/>
		<result property="auditInfo.updatedBy" 			column ="USU_MODI"/>
		<result property="auditInfo.lastUpdated" 		column ="FEC_MODI"/>    	    	
		<result property="estadoRegistro"      			column="EST_REGI"/>            
	</resultMap>
	
 	<resultMap id="cursoCapacitacionResult" class="cursoCapacitacion">
		<result property="codigoPais"						column ="PAIS_COD_PAIS"/>		                     			
		<result property="codigoEmpresa"                    column ="EMCO_COD_EMPR_COME"/>
		<result property="nombreEmpresa"					column ="DES_EMPR_COME"/>
		<result property="codigoCurso"                      column ="COD_CURS_CAPA"/>
		<result property="nombreCurso"                      column ="NOM_CURS_CAPA"/>
		<result property="siglasCurso"                      column ="SIG_CURS_CAPA"/>
		<result property="objetivoCurso"                    column ="OBJ_CURS_CAPA"/>
		<result property="estadoRegistro"                   column ="EST_REGI"/>
		<result property="codigoFrecuenciaCalificacion"     column ="FRCA_COD_FREC_CALI"/>
		<result property="descripcionFrecuenciaCalificacion"  column ="DES_FREC_CALI"/>
		<result property="campanhaInicial"                  column ="CAM_INIC"/>
		<result property="numeroCampanhas"                  column ="NUM_CAMP"/>
		<result property="numeroCampanhasPreviaDictado"     column ="NUM_CAMP_PREV_CALI"/>		
		<result property="codigoAmbitoDictado"              column ="AMDI_COD_AMBI_DICT"/>
		<result property="descripcionAmbitoDictado"         column ="DES_AMBI_DICT"/>		
		<result property="duracionCurso"                    column ="DUR_CURS_SESI"/>
		<result property="prerequisitoCapacitacion"         column ="PRE_REQU_CAPA"/>
		<result property="codigoSecuenciaPedido"            column ="SEPE_COD_SECU_PEDI"/>
		<result property="descripcionSecuenciaPedido"       column ="DES_SECU_PEDI"/>		
		<result property="numeroCampanhasPrerequisito"      column ="NUM_CAMP_CUMP_PREQ"/>
		<result property="numeroCampanhasEvaluar"           column ="NUM_CAMP_EVAL"/>
		<result property="numeroPedidosRequeridos"          column ="NUM_PEDI_REQU"/>
		<result property="indicadorMorosidad"               column ="IND_CTRL_MORO"/>
		<result property="codigoNivelVenta"                 column ="NIVE_COD_NIVE_VENT"/>
		<result property="descripcionNivelVenta"            column ="DES_NIVE_VENT"/>
		<result property="indicadorExoneracionAsistencia"   column ="IND_EXON_ASIS"/>
		<result property="indicadorPrimerPedido"            column ="STA_CLIE"/>
		<result property="indicadorCostoCurso"              column ="IND_COST_CURS"/>
		<result property="numeroCampanhasMaximaAsistencia"  column ="NUM_CAMP_MAXI_ASRE"/>
		<result property="indicadorInvitacionCurso"         column ="IND_INVI_CURS"/>
		<result property="indicadorDictadoExtemporaneo"     column ="IND_DICT_EXMA"/>
		<result property="estadoCurso"                      column ="EST_CURS_CAPA"/>
		<result property="indicadorRegaloAsistencia"        column ="IND_REGA_ASIS_CURS"/>
		<result property="indicadorEvaluacionCapacitada"    column ="IND_CALI_CTDA"/>
		<result property="indicadorEvaluacionCapacitadora"   column ="IND_CALI_CDRA"/>
		<result property="numeroCampanhaInvitacion"   		column ="NUM_INVI"/>
		<result property="codigoDocumentoImprimir"          column ="COD_DOCU_IMPR"/>   
        <result property="codigoProductoInvitacion"         column ="COD_PROD_INVI"/>
		<result property="indicadorReporteGerenteZona"      column ="IND_INVI_GERE_ZONA"/>     	
		<result property="indicadorPaqueteDocumentario"     column ="IND_INVI_PAQU_DOCU"/>   
		<result property="numeroCuotasPagar"                column = "NUM_CUOT_PAGA_CURS"/>
	    <result property="codigoProductoCurso"              column = "COD_PROD_CURS"/>
		<result property="costoCurso"                       column = "VAL_CURS"/> 
		<result property="tipoCostoCurso"                   column = "TICC_COD_TIPO_COST_CURS"/> 
		<result property="codigoClasificacion"              column = "COD_CLAS"/> 
		<result property="indicadorCalificacionAmbito"      column = "IND_CALI_AMBI"/> 
		<result property="indicadorCalificacionAmbitoRegion"  column = "IND_CALI_AMBI_REGI"/> 
		<result property="indicadorCalificacionAmbitoZona"    column = "IND_CALI_AMBI_ZONA"/> 
  	    <result property="auditInfo.createdBy" 				column ="USU_DIGI"/>
        <result property="auditInfo.created" 				column ="FEC_DIGI"/>
        <result property="auditInfo.updatedBy" 				column ="USU_MODI"/>
        <result property="auditInfo.lastUpdated" 			column ="FEC_MODI"/>    	    	
	</resultMap>
	
 	<resultMap id="consultaCursoCapacitacionResult" class="consultaCursoCapacitacion">
		<result property="codigoPais"                     		column="PAIS_COD_PAIS"/>      		
		<result property="codigoEmpresa"                  		column="EMCO_COD_EMPR_COME"/>   	
		<result property="nombreEmpresa"                  		column="DES_EMPR_COME"/>        	
		<result property="codigoCurso"                    		column="COD_CURS_CAPA"/>        	
		<result property="nombreCurso"                    		column="NOM_CURS_CAPA"/>        	
		<result property="siglasCurso"                    		column="SIG_CURS_CAPA"/>        	
		<result property="codigoCliente"                  		column="COD_CLIE"/>             	             
		<result property="apellidoPaternoCliente"         		column="APE_PATE_CLIE"/>	                                
		<result property="apellidoMaternoCliente"         		column="APE_MATE_CLIE"/>	                                
		<result property="primerNombreCliente"            		column="PRI_NOMB_CLIE"/>  			                          
		<result property="segundoNombreCliente"           		column="SEG_NOMB_CLIE"/>			                            
		<result property="descripcionCliente"           		column="DES_CLIENTE"/>			                            
		<result property="codigoInstructora"              		column="COD_INST"/>             	                 
		<result property="apellidoPaternoInstructora"     		column="APE_PATE_INST"/>                                     
		<result property="apellidoMaternoInstructora"     		column="APE_MATE_INST"/>                                     
		<result property="primerNombreInstructora"        		column="PRI_NOMB_INST"/>	    	                              
		<result property="segundoNombreInstructora"       		column="SEG_NOMB_INST"/>                                     
		<result property="codigoPlanillaProgramacion"     		column="COD_PLAN_PROG"/>				  
		<result property="campanhaPrimeraCalificacionApta"		column="CAM_PRIM_CALI_APTA"/> 		
		<result property="campanhaUltimaCalificacionApta" 		column="CAM_ULTI_CALI_APTA"/> 		
		<result property="ultimaCampanhaProgramacion" 		    column="ULT_CAMP_PROG_DICT"/> 		
		<result property="numeroInvitacion"               		column="NUM_INVI"/>			     		
		<result property="indicadorCursoCosto"            		column="IND_COST_CURS"/>      		
		<result property="indicadorCursoFacturado"        		column="IND_CURS_FACT"/>		   		
		<result property="campanhaFacturacionCurso"       		column="CAM_FACT_CURS"/>		   		
		<result property="campanhaAceptacion"                   column="CAM_ACEP"/>			     	  
		<result property="campanhaCapacitacion"                 column="CAM_CAPA"/>			     	  
		<result property="cursoDictado"                 		column="COD_CURS_DICT"/>			     	  
		<result property="codigoRegion"                 		column="COD_REGI"/>		
		<result property="codigoZona"	                 		column="COD_ZONA"/>		
		<result property="estadoCapacitacion"	               	column="EST_CAPA"/>		
			<result property="telefonoFijo"	               	column="NUM_TELE_PART"/>
			<result property="telefonoCelular"	               	column="NUM_CELU"/>
		<result property="campanhaIngreso"	               	column="CAM_INGR_COME"/>
		<result property="status"	               			column="STA_CLIE"/>
		<result property="tipo"	               					column="TIP_CALI_APTA"/>
	</resultMap>

 	<resultMap id="despachoProductoResult" class="despachoProductoCurso">
		<result property="codigoPais"                  column = "PAIS_COD_PAIS"/>           		
		<result property="codigoEmpresa"               column = "EMCO_COD_EMPR_COME"/>        	
		<result property="codigoCurso"                 column = "CCAP_COD_CURS_CAPA"/>        	
		<result property="correlativoDespachoCurso"    column = "COR_DESP_PROD"/>             	
		<result property="codigoTipoDespacho"          column = "TDES_COD_TIPO_DESP"/>        	
		<result property="descripcionTipoDespacho"     column = "DES_TIPO_DESP"/>        	
		<result property="codigoProducto"              column = "COD_PROD_SERV"/>                  	
		<result property="codigoTipoIndicadorDespacho" column = "TIDE_COD_TIPO_INDI_DESP"/>   	
		<result property="descripcionTipoIndicadorDespacho" column = "DES_TIPO_INDI_DESP"/>   	
		                 	
		      	
		<result property="estadoRegistro"              column = "EST_REGI"/>                  	
        <result property="auditInfo.createdBy" 		   column ="USU_DIGI"/>
        <result property="auditInfo.created" 		   column ="FEC_DIGI"/>
        <result property="auditInfo.updatedBy" 		   column ="USU_MODI"/>
        <result property="auditInfo.lastUpdated" 	   column ="FEC_MODI"/>    	    	
	</resultMap>
	
  <resultMap id="equivalenciaMatrizServicioResult" class="equivalenciaMatrizServicio">       
    <result property="id"					column="ID"												/> 
    <result property="codigoPais"              	column="COD_PAIS" />         
    <result property="codigoPeriodo"           	column="COD_PERI" />         
    <result property="codigoVenta"             	column="COD_VENTA" />         
    <result property="codigoEmpresa"             	column="COD_EMP" />         
    <result property="codigoCurso"             	column="COD_CURSO" />         
    <result property="valorUnitario"           	column="VAL_PREC" />         
    <result property="descripcionProducto"     	column="DES_PROD"  />        
    <result property="codigoProducto"          	column="COD_PROD" />         
    <result property="estadoRegistro"          	column="STA_REG"	   />
    <result property="estadoCuv"          	column="EST_CUV"	   />
    <result property="auditInfo.createdBy" 	column="USU_DIGI"		/>       
    <result property="auditInfo.created" 	column="FEC_DIGI"	/>       
    <result property="auditInfo.updatedBy" 	column="USU_MODI"	/>       
    <result property="auditInfo.lastUpdated" 	column="FEC_MODI"	/>   
    <result property="codigoClasificacion"          	column="CBEC_COD_CLAS"	   />

  </resultMap>                
                
	<select id="getConsultaCursoCapacitacionCapacitadas" parameterClass="java.util.Map" resultMap="consultaCursoCapacitacionResult">
		SELECT
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
			A.DES_EMPR_COME      ,
			B.COD_CURS_CAPA      ,    
			B.NOM_CURS_CAPA      ,    
			B.SIG_CURS_CAPA      ,
			J.COD_CLIE			 ,
			NVL(J.APE_PATE,'') AS APE_PATE_CLIE,           
			NVL(J.APE_MATE,'') AS APE_MATE_CLIE,           
			NVL(J.PRI_NOMB,'') AS PRI_NOMB_CLIE,           
			NVL(J.SEG_NOMB,'') AS SEG_NOMB_CLIE,   
      		CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           		NVL(J.PRI_NOMB,'') || ' ' || NVL(J.SEG_NOMB,'') ||' '|| NVL(J.APE_PATE,' ')||' '||NVL(J.APE_MATE,' ' )
      		ELSE
          		NVL(J.APE_NOMB_COMP,'')     
      		END AS DES_CLIENTE ,    
			G.COD_INST			,	
			NVL(G.APE_PATE,'') AS APE_PATE_INST,           
			NVL(G.APE_MATE,'') AS APE_MATE_INST,           
			NVL(G.PRI_NOMB,'') AS PRI_NOMB_INST,           
			NVL(G.SEG_NOMB,'') AS SEG_NOMB_INST,     
			L.COD_PLAN_PROG		 ,      
			L.CAM_PRIM_CALI_APTA ,    
			L.CAM_ULTI_CALI_APTA ,
			L.NUM_INVI			 ,
			L.IND_PAGO_CURS AS IND_COST_CURS , 
			L.IND_PAGO_CURS AS IND_CURS_FACT ,
			'' AS CAM_FACT_CURS		 ,
			'' AS CAM_ACEP			 ,
			'' AS ULT_CAMP_PROG_DICT ,
			L.CAM_CAPA			 ,
			L.COD_CURS_DICT	,
			J.COD_REGI,
			J.COD_ZONA,
            'CP' AS EST_CAPA,
			J.NUM_TELE_PART,
			J.NUM_CELU,
			J.CAM_INGR_COME,
			J.STA_CLIE,
			L.TASI_COD_TIPO_ASIS_CURS AS TIP_CALI_APTA
		FROM EDU_EMPRE_COMER A,
			 EDU_PARAM_CURSO_CAPAC B,
			 EDU_MAEST_INSTR G,
			 EDU_HISTO_CURSO_DICTA_CABEC H,
			 EDU_MAEST_CLIEN J,
			 EDU_HISTO_CAPAC_DETAL L,
		     EDU_PARAM_PROGR_CAPAC PPC
		WHERE B.PAIS_COD_PAIS       = #codigoPais#

		AND   A.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND   A.COD_EMPR_COME	  = B.EMCO_COD_EMPR_COME

   		AND   PPC.PAIS_COD_PAIS   = B.PAIS_COD_PAIS
    	AND   PPC.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
    	AND   PPC.COD_PROG_CAPA   = '01'

		AND	  H.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND	  H.EMCO_COD_EMPR_COME= B.EMCO_COD_EMPR_COME
		AND	  H.CCAP_COD_CURS_CAPA= B.COD_CURS_CAPA

		AND	  G.PAIS_COD_PAIS	  = H.PAIS_COD_PAIS
		AND	  G.EMCO_COD_EMPR_COME= H.EMCO_COD_EMPR_COME
		AND	  G.COD_INST		  = H.INST_COD_INST	  

		AND	  L.PAIS_COD_PAIS	  = H.PAIS_COD_PAIS
		AND	  L.EMCO_COD_EMPR_COME= H.EMCO_COD_EMPR_COME
		AND	  L.CCAP_COD_CURS_CAPA= H.CCAP_COD_CURS_CAPA
		AND	  L.COD_CURS_DICT	  = H.COD_CURS_DICT
		AND	  L.EST_REGI		 !='9'

		AND	  J.PAIS_COD_PAIS	  = L.PAIS_COD_PAIS
		AND	  J.EMCO_COD_EMPR_COME= L.EMCO_COD_EMPR_COME
		AND	  J.COD_CLIE		  = L.CLIE_COD_CLIE


		<isNotEmpty prepend="AND" property="dictadoCurso">
			H.COD_CURS_DICT  = #dictadoCurso#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoEmpresa">
			B.EMCO_COD_EMPR_COME  = #codigoEmpresa#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCurso">
		    B.COD_CURS_CAPA	= #codigoCurso# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCliente">
		    L.CLIE_COD_CLIE	    = #codigoCliente# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoInstructora">
		    H.INST_COD_INST	   = #codigoInstructora# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoPlanillaProgramacion">
		    L.COD_PLAN_PROG  = #codigoPlanillaProgramacion# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaInicial">
			<![CDATA[
			    L.CAM_CAPA >= #campanhaInicial# 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaFinal">
			<![CDATA[
			    L.CAM_CAPA <= #campanhaFinal# 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="tipo">
		    L.TASI_COD_TIPO_ASIS_CURS  = #tipo# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaIngreso">
		    J.CAM_INGR_COME  = #campanhaIngreso# 
		</isNotEmpty>

		<isNotEmpty  property="codigoRegion">
	   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
			(J.COD_REGI =  #codigoRegion[]#)      	 		
       </iterate>		
		</isNotEmpty>	
		<isNotEmpty  property="codigoZona">
	   <iterate prepend="AND" property="codigoZona" open="(" close=")" conjunction="OR">
			(J.COD_REGI||J.COD_ZONA =  #codigoZona[]#)      	 		
       </iterate>		
		</isNotEmpty>	
	   <isNotEmpty prepend="AND" property="status">
		    J.STA_CLIE  = #status# 
		</isNotEmpty>
		ORDER BY
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
		    B.COD_CURS_CAPA      ,
			DES_CLIENTE
	</select>

	<select id="getConsultaCursoCapacitacionAptas" parameterClass="java.util.Map" resultMap="consultaCursoCapacitacionResult">
		SELECT
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
			A.DES_EMPR_COME      ,
			B.COD_CURS_CAPA      ,    
			B.NOM_CURS_CAPA      ,    
			B.SIG_CURS_CAPA      ,
			J.COD_CLIE			 ,
			NVL(J.APE_PATE,'') AS APE_PATE_CLIE,           
			NVL(J.APE_MATE,'') AS APE_MATE_CLIE,           
			NVL(J.PRI_NOMB,'') AS PRI_NOMB_CLIE,           
			NVL(J.SEG_NOMB,'') AS SEG_NOMB_CLIE,           
      		CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           		NVL(J.PRI_NOMB,'') || ' ' || NVL(J.SEG_NOMB,'') ||' '|| NVL(J.APE_PATE,' ')||' '||NVL(J.APE_MATE,' ' )
      		ELSE
          		NVL(J.APE_NOMB_COMP,'')     
      		END AS DES_CLIENTE ,    
			'' AS COD_INST			,	
			'' AS APE_PATE_INST,           
			'' AS APE_MATE_INST,           
			'' AS PRI_NOMB_INST,           
			'' AS SEG_NOMB_INST,     
			'' AS COD_PLAN_PROG	,      
			L.CAM_PRIM_CALI_APTA ,    
			L.CAM_ULTI_CALI_APTA ,
			L.NUM_INVI			 ,
			L.IND_CURS_COST AS IND_COST_CURS      , 
			L.IND_CURS_FACT		 ,
			L.CAM_FACT_CURS		 ,
			L.CAM_ACEP			 ,
			L.ULT_CAMP_PROG_DICT ,
			'' AS CAM_CAPA,
			'' AS COD_CURS_DICT,
			J.COD_REGI,
			J.COD_ZONA,
            'PC' AS EST_CAPA,
			J.NUM_TELE_PART,
			J.NUM_CELU,
			J.CAM_INGR_COME,
			J.STA_CLIE,
			L.TIP_CALI_APTA
		FROM EDU_EMPRE_COMER A,
			 EDU_PARAM_CURSO_CAPAC B,
			 EDU_MAEST_CLIEN J,
			 EDU_HISTO_CALIF_APTAS L,
       		 EDU_PARAM_PROGR_CAPAC PPC
		WHERE B.PAIS_COD_PAIS       = #codigoPais#
		AND   A.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND   A.COD_EMPR_COME	  = B.EMCO_COD_EMPR_COME
    	AND   PPC.PAIS_COD_PAIS 	 = B.PAIS_COD_PAIS
    	AND   PPC.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
    	AND   PPC.COD_PROG_CAPA 	 = '01'
		AND	  L.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND	  L.EMCO_COD_EMPR_COME= B.EMCO_COD_EMPR_COME
		AND	  L.CCAP_COD_CURS_CAPA= B.COD_CURS_CAPA
		AND	  L.EST_REGI		 !='9'
		AND	  J.PAIS_COD_PAIS	  = L.PAIS_COD_PAIS
		AND	  J.EMCO_COD_EMPR_COME= L.EMCO_COD_EMPR_COME
		AND	  J.COD_CLIE		  = L.CLIE_COD_CLIE
		<![CDATA[
	    AND L.NUM_INVI > 0
		]]>
		<isNotEmpty prepend="AND" property="estadoCapacitacion">
			L.EST_CAPA 		  = #estadoCapacitacion#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="codigoEmpresa">
			B.EMCO_COD_EMPR_COME  = #codigoEmpresa#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCurso">
		    B.COD_CURS_CAPA	= #codigoCurso# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCliente">
		    L.CLIE_COD_CLIE	    = #codigoCliente# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaInicial">
			<![CDATA[
			    TO_NUMBER(L.CAM_PROC) >= TO_NUMBER(#campanhaInicial#)
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaFinal">
			<![CDATA[
			    TO_NUMBER(L.CAM_PROC)<= TO_NUMBER(#campanhaFinal#)
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaIngreso">
		    J.CAM_INGR_COME  = #campanhaIngreso# 
		</isNotEmpty>	
		<isNotEmpty prepend="AND" property="tipo">
		    L.TIP_CALI_APTA  = #tipo# 
		</isNotEmpty>
		<isNotEmpty  property="codigoRegion">
	   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
			(J.COD_REGI =  #codigoRegion[]#)      	 		
       </iterate>		
		</isNotEmpty>	
		<isNotEmpty  property="codigoZona">
	   <iterate prepend="AND" property="codigoZona" open="(" close=")" conjunction="OR">
			(J.COD_REGI||J.COD_ZONA =  #codigoZona[]#)      	 		
       </iterate>		
		</isNotEmpty>	
	   <isNotEmpty prepend="AND" property="status">
		    J.STA_CLIE  = #status# 
		</isNotEmpty>
		ORDER BY
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
		    B.COD_CURS_CAPA      ,
			DES_CLIENTE
	</select>

	<select id="getConsultaCursoCapacitacionProgramadas" parameterClass="java.util.Map" resultMap="consultaCursoCapacitacionResult">
		SELECT
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
			A.DES_EMPR_COME      ,
			B.COD_CURS_CAPA      ,    
			B.NOM_CURS_CAPA      ,    
			B.SIG_CURS_CAPA      ,
			J.COD_CLIE			 ,
			NVL(J.APE_PATE,'') AS APE_PATE_CLIE,           
			NVL(J.APE_MATE,'') AS APE_MATE_CLIE,           
			NVL(J.PRI_NOMB,'') AS PRI_NOMB_CLIE,           
			NVL(J.SEG_NOMB,'') AS SEG_NOMB_CLIE,    
      		CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           		NVL(J.PRI_NOMB,'') || ' ' || NVL(J.SEG_NOMB,'') ||' '|| NVL(J.APE_PATE,' ')||' '||NVL(J.APE_MATE,' ' )
      		ELSE
          		NVL(J.APE_NOMB_COMP,'')     
      		END AS DES_CLIENTE ,    
			'' AS COD_INST			,	
			'' AS APE_PATE_INST,           
			'' AS APE_MATE_INST,           
			'' AS PRI_NOMB_INST,           
			'' AS SEG_NOMB_INST,     
			L.COD_PLAN_PROG	,      
			L.CAM_PRIM_CALI_APTA ,    
			L.CAM_ULTI_CALI_APTA ,
			M.NUM_INVI			 ,
			L.IND_CURS_COST AS IND_COST_CURS      , 
			L.IND_CURS_FACT		 ,
			L.CAM_FACT_CURS		 ,
			L.CAM_ACEP			 ,
			M.CAM_PROC AS ULT_CAMP_PROG_DICT,
			'' AS CAM_CAPA,
			'' AS COD_CURS_DICT,
			J.COD_REGI,
			J.COD_ZONA,
            'PR' AS EST_CAPA,
			J.NUM_TELE_PART,
			J.NUM_CELU,
			J.CAM_INGR_COME,
			J.STA_CLIE,
			M.TIP_CALI_APTA	
		FROM EDU_EMPRE_COMER A,
			 EDU_PARAM_CURSO_CAPAC B,
			 EDU_MAEST_CLIEN J,
			 EDU_HISTO_APTAS L,
       		 EDU_PARAM_PROGR_CAPAC PPC,
			 EDU_PLANI_PROGR_CURSO M

		WHERE B.PAIS_COD_PAIS       = #codigoPais#
		AND   L.COD_PLAN_PROG 	  IS NOT NULL
		AND   A.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND   A.COD_EMPR_COME	  = B.EMCO_COD_EMPR_COME

    	AND   PPC.PAIS_COD_PAIS   = B.PAIS_COD_PAIS
    	AND   PPC.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
    	AND   PPC.COD_PROG_CAPA   = '01'

		AND	  L.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND	  L.EMCO_COD_EMPR_COME= B.EMCO_COD_EMPR_COME
		AND	  L.CCAP_COD_CURS_CAPA= B.COD_CURS_CAPA
		AND	  L.EST_REGI		 !='9'

		AND	  J.PAIS_COD_PAIS	  = L.PAIS_COD_PAIS
		AND	  J.EMCO_COD_EMPR_COME= L.EMCO_COD_EMPR_COME
		AND	  J.COD_CLIE		  = L.CLIE_COD_CLIE
	    
		AND M.PAIS_COD_PAIS = L.PAIS_COD_PAIS
		AND M.EMCO_COD_EMPR_COME = L.EMCO_COD_EMPR_COME
	    AND M.CCAP_COD_CURS_CAPA= L.CCAP_COD_CURS_CAPA
  	    AND M.CLIE_COD_CLIE = L.CLIE_COD_CLIE
	    
		<isNotEmpty prepend="AND" property="estadoCapacitacion">
			L.EST_CAPA 		  = #estadoCapacitacion#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="codigoPlanillaProgramacion">
			L.COD_PLAN_PROG	  = #codigoPlanillaProgramacion#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="codigoEmpresa">
			B.EMCO_COD_EMPR_COME  = #codigoEmpresa#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCurso">
		    B.COD_CURS_CAPA	= #codigoCurso# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCliente">
		    L.CLIE_COD_CLIE	    = #codigoCliente# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaInicial">
			<![CDATA[
			    M.CAM_PROC >= #campanhaInicial# 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaFinal">
			<![CDATA[
			    M.CAM_PROC <= #campanhaFinal# 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="tipo">
			M.TIP_CALI_APTA  = #tipo# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaIngreso">
		    J.CAM_INGR_COME  = #campanhaIngreso# 
		</isNotEmpty>	
		<isNotEmpty  property="codigoRegion">
	   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
			(J.COD_REGI =  #codigoRegion[]#)      	 		
       </iterate>		
		</isNotEmpty>	
		<isNotEmpty  property="codigoZona">
	   <iterate prepend="AND" property="codigoZona" open="(" close=")" conjunction="OR">
			(J.COD_REGI||J.COD_ZONA =  #codigoZona[]#)      	 		
       </iterate>		
		</isNotEmpty>	
	   <isNotEmpty prepend="AND" property="status">
		    J.STA_CLIE  = #status# 
		</isNotEmpty>
		ORDER BY
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
		    B.COD_CURS_CAPA      ,
			DES_CLIENTE
	</select>

	<select id="getHistoricoPedido" parameterClass="historicoPedido" resultMap="historicoPedidoResult">
     SELECT
    	  A.PAIS_COD_PAIS      ,
    	  A.EMCO_COD_EMPR_COME ,
          B.DES_EMPR_COME      ,
    	  A.COD_CLIE           ,
    	  A.CAM_INIC_PEDI      ,
    	  A.CAM_ULTI_PEDI      ,
    	  A.CAM_PROC           ,
    	  A.COD_ULTI_NIVE      ,
    	  A.NUM_PEDI_FACT      ,
    	  A.IND_PEDI           ,
    	  A.IND_FACT           ,
    	  A.IND_NUEV           ,
    	  A.IND_CONS           ,
    	  A.IND_PRIM_PEDI      
    	FROM EDU_HISTO_PEDID_CONSU A,
    	     EDU_EMPRE_COMER B
      WHERE B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
      AND   B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME
	  <isNotEmpty prepend="AND" property="codigoPais">
		    A.PAIS_COD_PAIS = #codigoPais#
	  </isNotEmpty>		
	  <isNotEmpty prepend="AND" property="codigoEmpresa">
		    A.EMCO_COD_EMPR_COME = #codigoEmpresa#
	  </isNotEmpty>		
	  <isNotEmpty prepend="AND" property="codigoCliente">
		    A.COD_CLIE = #codigoCliente#
	  </isNotEmpty>		
	</select>

	<select id="getMaxCursoCapacitacion" parameterClass="cursoCapacitacion" resultClass="string">
		SELECT MAX(TO_NUMBER(NVL(COD_CURS_CAPA,'0')))
		FROM EDU_PARAM_CURSO_CAPAC
		WHERE PAIS_COD_PAIS 		= #codigoPais#
		AND	  EMCO_COD_EMPR_COME	= #codigoEmpresa#
	</select>

	<select id="getCursoCapacitacion" parameterClass="cursoCapacitacion" resultMap="cursoCapacitacionResult">
		SELECT
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
			A.DES_EMPR_COME      ,
			B.COD_CURS_CAPA      ,    
			B.NOM_CURS_CAPA      ,    
			B.SIG_CURS_CAPA      ,    
			B.OBJ_CURS_CAPA      ,    
			B.EST_REGI           ,    
			B.FRCA_COD_FREC_CALI ,    
			D.DES_FREC_CALI      ,
			B.CAM_INIC           ,    
			B.NUM_CAMP           ,    
			B.NUM_CAMP_PREV_CALI ,
			B.AMDI_COD_AMBI_DICT ,    
			C.DES_AMBI_DICT      ,
			B.DUR_CURS_SESI      ,    
			B.PRE_REQU_CAPA      ,    
			B.SEPE_COD_SECU_PEDI ,    
			E.DES_SECU_PEDI      ,
			B.NUM_CAMP_CUMP_PREQ ,    
			B.NUM_CAMP_EVAL      ,    
			B.NUM_PEDI_REQU      ,    
			B.IND_CTRL_MORO      ,    
			B.NIVE_COD_NIVE_VENT ,    
			F.DES_NIVE_VENT      ,
			B.IND_EXON_ASIS      ,    
			B.STA_CLIE      ,    
			B.IND_COST_CURS      ,    
			B.NUM_CAMP_MAXI_ASRE ,    
			B.IND_INVI_CURS      ,    
			B.IND_DICT_EXMA      ,    
			B.EST_CURS_CAPA      ,
			B.IND_REGA_ASIS_CURS ,
			B.IND_CALI_CTDA      ,
			B.IND_CALI_CDRA      ,
 			B.NUM_INVI			 ,
			B.COD_DOCU_IMPR		 ,
			B.COD_PROD_INVI		 ,
			B.IND_INVI_GERE_ZONA ,
			B.IND_INVI_PAQU_DOCU ,
			B.NUM_CUOT_PAGA_CURS ,
			B.VAL_CURS			,
			B.COD_PROD_CURS		,
			B.TICC_COD_TIPO_COST_CURS,
			B.COD_CLAS         ,
			B.IND_CALI_AMBI	   ,
			DECODE(B.AMDI_COD_AMBI_DICT,'02',B.IND_CALI_AMBI,'1') IND_CALI_AMBI_REGI,
			DECODE(B.AMDI_COD_AMBI_DICT,'03',B.IND_CALI_AMBI,'1') IND_CALI_AMBI_ZONA,
			B.USU_DIGI		   ,
			B.FEC_DIGI		   ,
			B.USU_MODI		   ,
			B.FEC_MODI                                                                                                                                     
		FROM EDU_PARAM_CURSO_CAPAC B,
			 EDU_EMPRE_COMER A,
			 EDU_AMBIT_DICTA C,
			 EDU_FRECU_CALIF D,
			 EDU_SECUE_PEDID E,
			 EDU_NIVEL_VENTA F
		WHERE B.PAIS_COD_PAIS 		= #codigoPais#
		AND	  B.EMCO_COD_EMPR_COME	= #codigoEmpresa#
		AND	  B.COD_CURS_CAPA		= #codigoCurso# 
		AND   A.COD_EMPR_COME	    = B.EMCO_COD_EMPR_COME
		AND   C.COD_AMBI_DICT       = B.AMDI_COD_AMBI_DICT
		AND   A.PAIS_COD_PAIS		= B.PAIS_COD_PAIS
		AND   A.COD_EMPR_COME		= B.EMCO_COD_EMPR_COME
		AND   D.COD_FREC_CALI       = B.FRCA_COD_FREC_CALI
		AND   E.COD_SECU_PEDI       = B.SEPE_COD_SECU_PEDI
		AND   F.COD_NIVE_VENT       = B.NIVE_COD_NIVE_VENT
	</select>

	<select id="getCursosCapacitacionByCriteria" parameterClass="java.util.Map" resultMap="cursoCapacitacionResult">
		SELECT
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
			A.DES_EMPR_COME      ,
			B.COD_CURS_CAPA      ,    
			B.NOM_CURS_CAPA      ,    
			B.SIG_CURS_CAPA      ,    
			B.OBJ_CURS_CAPA      ,    
			B.EST_REGI           ,    
			B.FRCA_COD_FREC_CALI ,    
			D.DES_FREC_CALI      ,
			B.CAM_INIC           ,    
			B.NUM_CAMP           ,    
			B.NUM_CAMP_PREV_CALI ,
			B.AMDI_COD_AMBI_DICT ,    
			C.DES_AMBI_DICT      ,
			B.DUR_CURS_SESI      ,    
			B.PRE_REQU_CAPA      ,    
			B.SEPE_COD_SECU_PEDI ,    
			E.DES_SECU_PEDI      ,			
			B.NUM_CAMP_CUMP_PREQ ,    
			B.NUM_CAMP_EVAL      ,    
			B.NUM_PEDI_REQU      ,    
			B.IND_CTRL_MORO      ,    
			B.NIVE_COD_NIVE_VENT ,    
			F.DES_NIVE_VENT      ,			
			B.IND_EXON_ASIS      ,    
			B.STA_CLIE      ,    
			B.IND_COST_CURS      ,    
			B.NUM_CAMP_MAXI_ASRE ,    
			B.IND_INVI_CURS      ,    
			B.IND_DICT_EXMA      ,    
			B.EST_CURS_CAPA      ,
			B.IND_REGA_ASIS_CURS ,
			B.IND_CALI_CTDA      ,
			B.IND_CALI_CDRA      ,
			B.NUM_INVI,
			B.COD_DOCU_IMPR		 ,
			B.COD_PROD_INVI		 ,
			B.IND_INVI_GERE_ZONA ,
			B.IND_INVI_PAQU_DOCU ,
			B.NUM_CUOT_PAGA_CURS ,
			B.VAL_CURS			,
			B.COD_PROD_CURS		,
			B.TICC_COD_TIPO_COST_CURS,
            B.COD_CLAS         ,
            B.IND_CALI_AMBI    ,
            DECODE(B.AMDI_COD_AMBI_DICT,'02',B.IND_CALI_AMBI,'1') IND_CALI_AMBI_REGI,
			DECODE(B.AMDI_COD_AMBI_DICT,'03',B.IND_CALI_AMBI,'1') IND_CALI_AMBI_ZONA,
			B.USU_DIGI		   ,
			B.FEC_DIGI		   ,
			B.USU_MODI		   ,
			B.FEC_MODI                                                                                                                                     
		FROM EDU_PARAM_CURSO_CAPAC B,
			 EDU_EMPRE_COMER A,
			 EDU_AMBIT_DICTA C,
			 EDU_FRECU_CALIF D,
			 EDU_SECUE_PEDID E,
		     EDU_NIVEL_VENTA F
		WHERE B.PAIS_COD_PAIS     = #codigoPais#
		AND   A.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND   A.COD_EMPR_COME	  = B.EMCO_COD_EMPR_COME
		AND   C.COD_AMBI_DICT     = B.AMDI_COD_AMBI_DICT
		AND   D.COD_FREC_CALI     = B.FRCA_COD_FREC_CALI		
		AND   E.COD_SECU_PEDI       = B.SEPE_COD_SECU_PEDI		
		AND   F.COD_NIVE_VENT       = B.NIVE_COD_NIVE_VENT		
		<isNotEmpty prepend="AND" property="estadoCurso">
			B.EST_CURS_CAPA=#estadoCurso#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="estadoRegistro">
			B.EST_REGI=#estadoRegistro#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
	   	 	B.EMCO_COD_EMPR_COME	= #codigoEmpresa#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCurso">
		    B.COD_CURS_CAPA	    = #codigoCurso# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="nombreCurso">
		    B.NOM_CURS_CAPA = #nombreCurso# 
		</isNotEmpty>
		ORDER BY
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
		    TO_NUMBER(B.COD_CURS_CAPA) ASC
	</select>

	<select id="getProductoxCurso" parameterClass="despachoProductoCurso" resultMap="despachoProductoResult">
		SELECT
			A.PAIS_COD_PAIS		,           		
			A.EMCO_COD_EMPR_COME	,        	
			A.CCAP_COD_CURS_CAPA	,        	
			A.COR_DESP_PROD		,             	
			A.TDES_COD_TIPO_DESP,
			B.DES_TIPO_DESP     ,        	
			A.COD_PROD_SERV			,                  	
			A.TIDE_COD_TIPO_INDI_DESP,   	
			C.DES_TIPO_INDI_DESP,
			A.EST_REGI			,                  	
			A.USU_DIGI		    ,
			A.FEC_DIGI		    ,
			A.USU_MODI		    ,
			A.FEC_MODI
		FROM EDU_DESPA_PRODU A,
		     EDU_TIPO_DESPA B,
			 EDU_TIPO_INDIC_DESPA C
		WHERE PAIS_COD_PAIS		= #codigoPais#       		
		AND	EMCO_COD_EMPR_COME	= #codigoEmpresa#       	
		AND	CCAP_COD_CURS_CAPA	= #codigoCurso#       	
		AND	COR_DESP_PROD		= #correlativoDespachoCurso#            	
		AND B.COD_TIPO_DESP     = A.TDES_COD_TIPO_DESP    
		AND A.TDES_COD_TIPO_DESP = C.TDES_COD_TIPO_DESP
		AND A.TIDE_COD_TIPO_INDI_DESP = C.COD_TIPO_INDI_DESP
		ORDER BY 
			A.PAIS_COD_PAIS,           		
			A.EMCO_COD_EMPR_COME,        	
			A.CCAP_COD_CURS_CAPA,        			
			A.COR_DESP_PROD
	</select>

	<select id="getProductosxCurso" parameterClass="despachoProductoCurso" resultMap="despachoProductoResult">
		SELECT
			A.PAIS_COD_PAIS		,           		
			A.EMCO_COD_EMPR_COME	,        	
			A.CCAP_COD_CURS_CAPA	,        	
			A.COR_DESP_PROD		,             	
			A.TDES_COD_TIPO_DESP,
			B.DES_TIPO_DESP     ,        	
			A.COD_PROD_SERV			,                  	
			A.TIDE_COD_TIPO_INDI_DESP,   	
			C.DES_TIPO_INDI_DESP,
			A.EST_REGI			,                  	
			A.USU_DIGI		    ,
			A.FEC_DIGI		    ,
			A.USU_MODI		    ,
			A.FEC_MODI
		FROM EDU_DESPA_PRODU A,
		     EDU_TIPO_DESPA B,
			 EDU_TIPO_INDIC_DESPA C
		WHERE A.PAIS_COD_PAIS		= #codigoPais#       		
		AND	A.EMCO_COD_EMPR_COME	= #codigoEmpresa#       	
		AND	A.CCAP_COD_CURS_CAPA	= #codigoCurso#      
		AND B.COD_TIPO_DESP     = A.TDES_COD_TIPO_DESP    
		AND A.TDES_COD_TIPO_DESP = C.TDES_COD_TIPO_DESP
		AND A.TIDE_COD_TIPO_INDI_DESP = C.COD_TIPO_INDI_DESP
		<isNotEmpty prepend="AND" property="estadoRegistro">
			A.EST_REGI=#estadoRegistro#
		</isNotEmpty>		
		ORDER BY 
			A.PAIS_COD_PAIS,           		
			A.EMCO_COD_EMPR_COME,        	
			A.CCAP_COD_CURS_CAPA,        			
			A.COR_DESP_PROD
		
	</select>
	
	<select id="getRegion" parameterClass="regionCursoCapacitacion" resultMap="regionResult">
		SELECT 
			A.PAIS_COD_PAIS,
			A.EMCO_COD_EMPR_COME,
			C.DES_EMPR_COME,
			A.COD_REGI,
			A.DES_REGI,
			A.COD_REGI_ANTE,
			A.EST_REGI,
			A.INST_COD_INST,
			B.EMA_INST,
			NVL(B.APE_PATE,' ') || ' ' || NVL(B.APE_MATE,' ') || ' ' || NVL(B.PRI_NOMB,'')|| ' ' ||NVL(B.SEG_NOMB,'') AS DESC_COD_INST,
			A.NOM_GERE_REGI,
			A.EMA_GERE_REGI,
			A.COD_GERE_REGI											      
		FROM EDU_EMPRE_COMER C,
			 EDU_REGIO A
		LEFT JOIN EDU_MAEST_INSTR B ON B.PAIS_COD_PAIS = A.PAIS_COD_PAIS AND B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME AND B.COD_INST = A.INST_COD_INST
		WHERE A.PAIS_COD_PAIS = #codigoPais#
	    AND   A.EST_REGI !='9'							
		AND	  C.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND	  C.COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		<isNotEmpty prepend="AND" property="codigoEmpresa">
			A.EMCO_COD_EMPR_COME =#codigoEmpresa#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoRegion">
			A.COD_REGI =#codigoRegion#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoInstructora">
			A.INST_COD_INST =#codigoInstructora#
		</isNotEmpty>		
		AND (A.IND_ACTI != '0' OR A.IND_ACTI IS NULL)
		ORDER BY A.COD_REGI,A.DES_REGI
	</select>		
	
	<select id="getRegionByInstructora" parameterClass="regionCursoCapacitacion" resultMap="regionResult">
		SELECT 
			A.PAIS_COD_PAIS,
			A.EMCO_COD_EMPR_COME,
			C.DES_EMPR_COME,
			A.COD_REGI,
			A.DES_REGI DES_REGI,
			A.COD_REGI_ANTE,
			A.EST_REGI,
			A.INST_COD_INST,
			B.EMA_INST,
			NVL(B.APE_PATE,' ') || ' ' || NVL(B.APE_MATE,' ') || ' ' || NVL(B.PRI_NOMB,'')|| ' ' ||NVL(B.SEG_NOMB,'') AS DESC_COD_INST,
			A.NOM_GERE_REGI,
			A.EMA_GERE_REGI,
			A.COD_GERE_REGI											      
		FROM EDU_EMPRE_COMER C,
			 EDU_REGIO A,
			  EDU_MAEST_INSTR B 
		WHERE A.PAIS_COD_PAIS = #codigoPais#
	    AND   A.EST_REGI !='9'							
		AND	  C.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND	  C.COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND   B.PAIS_COD_PAIS = A.PAIS_COD_PAIS 
	    AND   B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME 
		AND   B.COD_INST = A.INST_COD_INST
		<isNotEmpty prepend="AND" property="codigoEmpresa">
			A.EMCO_COD_EMPR_COME =#codigoEmpresa#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoRegion">
			A.COD_REGI =#codigoRegion#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoInstructora">
			B.COD_INST =#codigoInstructora#
		</isNotEmpty>		
        AND (A.IND_ACTI != '0' OR A.IND_ACTI IS NULL)
		ORDER BY A.COD_REGI,A.DES_REGI
	</select>		

	<select id="getRegionCursoCapacitacion" parameterClass="regionCursoCapacitacion" resultMap="regionCursoCapacitacionResult">
		SELECT DISTINCT
			A.PAIS_COD_PAIS,
			A.COD_REGI,
			A.DES_REGI,
			A.COD_REGI_ANTE,
			A.EST_REGI,
			B.EMCO_COD_EMPR_COME,
			B.CCAP_COD_CURS_CAPA,
			B.AMDI_COD_AMBI_DICT,
			A.INST_COD_INST
		FROM EDU_REGIO A,
		     EDU_PARAM_CURSO_CAPAC_AMBIT B
		WHERE B.PAIS_COD_PAIS = #codigoPais#
		AND   B.EMCO_COD_EMPR_COME = #codigoEmpresa# 		
	    AND   B.CCAP_COD_CURS_CAPA = #codigoCurso# 		
		AND   A.PAIS_COD_PAIS = B.PAIS_COD_PAIS 		
	    AND   A.COD_REGI = B.COD_REGI 		
	    AND   A.EST_REGI !='9'			
		ORDER BY A.DES_REGI	
	</select>		
	
	<select id="getZona" parameterClass="zonaCursoCapacitacion"  resultMap="zonaResult">
	 SELECT 
			A.PAIS_COD_PAIS,
			A.REGI_COD_REGI AS COD_REGI,
		    B.DES_REGI,
			A.EMCO_COD_EMPR_COME,
		    C.DES_EMPR_COME,
			A.COD_ZONA,
			A.DES_ZONA,
			A.COD_ZONA_ANTE,
			A.EST_REGI,
			A.EMA_GERE_ZONA
		FROM EDU_ZONA A, EDU_REGIO B,
         EDU_EMPRE_COMER C
		WHERE 
            A.PAIS_COD_PAIS=B.PAIS_COD_PAIS 
    	AND A.EMCO_COD_EMPR_COME=B.EMCO_COD_EMPR_COME
	    AND A.REGI_COD_REGI=B.COD_REGI
    	AND A.PAIS_COD_PAIS=C.PAIS_COD_PAIS
	    AND A.EMCO_COD_EMPR_COME=C.COD_EMPR_COME
      	AND A.PAIS_COD_PAIS = #codigoPais#
      	AND A.EST_REGI !='9'		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
			A.EMCO_COD_EMPR_COME =  #codigoEmpresa#
       </isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoRegion">
			A.REGI_COD_REGI =  #codigoRegion#
       </isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoZona">
			A.COD_ZONA =#codigoZona#
		</isNotEmpty>		
		AND (A.EST_ZONA != '9' OR A.EST_ZONA IS NULL)
	   ORDER BY A.REGI_COD_REGI, A.COD_ZONA
	</select>

	<select id="getZonaByRegionSelected" parameterClass="java.util.Map"  resultMap="zonaResult">
	 SELECT 
			A.PAIS_COD_PAIS,
			A.REGI_COD_REGI AS COD_REGI,
		    B.DES_REGI,
			A.EMCO_COD_EMPR_COME,
		    C.DES_EMPR_COME,
			A.COD_ZONA,
			A.DES_ZONA,
			A.COD_ZONA_ANTE,
			A.EST_REGI,
			A.EMA_GERE_ZONA
		FROM EDU_ZONA A, EDU_REGIO B,
         EDU_EMPRE_COMER C
		WHERE 
            A.PAIS_COD_PAIS=B.PAIS_COD_PAIS 
    	AND A.EMCO_COD_EMPR_COME=B.EMCO_COD_EMPR_COME
	    AND A.REGI_COD_REGI=B.COD_REGI
    	AND A.PAIS_COD_PAIS=C.PAIS_COD_PAIS
	    AND A.EMCO_COD_EMPR_COME=C.COD_EMPR_COME
      	AND A.PAIS_COD_PAIS = #codigoPais#
      	AND A.EST_REGI !='9'		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
			A.EMCO_COD_EMPR_COME =#codigoEmpresa#
		</isNotEmpty>	
		<isNotEmpty  property="codigoRegion">
	   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
			(A.REGI_COD_REGI =  #codigoRegion[]#)      	 		
       </iterate>		
		</isNotEmpty>	
		<isNotEmpty prepend="AND" property="codigoZona">
			A.COD_ZONA =#codigoZona#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="descripcionZona">
			A.DES_ZONA =#descripcionZona#
		</isNotEmpty>		
		AND (A.EST_ZONA != '9' OR A.EST_ZONA IS NULL)
	   ORDER BY A.REGI_COD_REGI, A.COD_ZONA
	</select>
	
	<select id="getZonaCursoCapacitacion" parameterClass="zonaCursoCapacitacion"  resultMap="zonaCursoCapacitacionResult">
		SELECT 
			A.PAIS_COD_PAIS,
			A.REGI_COD_REGI AS COD_REGI,
			A.COD_ZONA,
			A.DES_ZONA,
			A.COD_ZONA_ANTE,
			A.EST_REGI,
			B.EMCO_COD_EMPR_COME,
			B.CCAP_COD_CURS_CAPA,
			B.AMDI_COD_AMBI_DICT,
			A.EMA_GERE_ZONA
		FROM EDU_ZONA A,
			 EDU_PARAM_CURSO_CAPAC_AMBIT B 
		WHERE B.PAIS_COD_PAIS = #codigoPais#
		 AND  B.EMCO_COD_EMPR_COME = #codigoEmpresa# 		
		 AND  B.CCAP_COD_CURS_CAPA = #codigoCurso# 		
		 AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS 		 		 
		 AND A.REGI_COD_REGI = B.COD_REGI 
		 AND A.COD_ZONA = B.COD_ZONA
		 AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
		 AND A.EST_REGI !='9'		
	</select>

	<select id="getCursoCapacitacionAmbito" parameterClass="cursoCapacitacionAmbito" resultMap="cursoCapacitacionAmbitoResult">
		SELECT
			  A.PAIS_COD_PAIS       ,
			  A.EMCO_COD_EMPR_COME  ,
			  A.CCAP_COD_CURS_CAPA  ,
			  A.COR_PARAM_CURS_AMBI ,
			  A.AMDI_COD_AMBI_DICT       ,
			  A.COD_REGI            ,
			  B.DES_REGI            ,
			  A.COD_ZONA            ,
			  C.DES_ZONA            ,
			  A.COD_CLAS            ,
			  A.USU_DIGI            ,
			  A.FEC_DIGI            ,
			  A.USU_MODI            ,
			  A.FEC_MODI            ,
			  A.EST_REGI            
		FROM  EDU_PARAM_CURSO_CAPAC_AMBIT A
			  LEFT JOIN EDU_REGIO B ON B.PAIS_COD_PAIS = A.PAIS_COD_PAIS AND B.COD_REGI = A.COD_REGI
			  LEFT JOIN EDU_ZONA C ON C.PAIS_COD_PAIS = A.PAIS_COD_PAIS AND C.REGI_COD_REGI = A.COD_REGI AND C.COD_ZONA = A.COD_ZONA 		
		WHERE PAIS_COD_PAIS = #codigoPais#
		<isNotEmpty prepend="AND" property="codigoEmpresa">
			A.EMCO_COD_EMPR_COME =#codigoEmpresa#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
			A.CCAP_COD_CURS_CAPA =#codigoCurso#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="estadoRegistro">
			A.EST_REGI =#estadoRegistro#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="correlativo">
			A.COR_PARAM_CURS_AMBI =#correlativo#
		</isNotEmpty>		
	</select>

    <insert id="insertCursoCapacitacion" parameterClass="cursoCapacitacion">
	    INSERT INTO EDU_PARAM_CURSO_CAPAC
	    (
			PAIS_COD_PAIS      ,		
			EMCO_COD_EMPR_COME ,    
			COD_CURS_CAPA      ,    
			NOM_CURS_CAPA      ,    
			SIG_CURS_CAPA      ,    
			OBJ_CURS_CAPA      ,    
			EST_REGI           ,    
			FRCA_COD_FREC_CALI ,    
			CAM_INIC           ,    
			NUM_CAMP           ,    
			NUM_CAMP_PREV_CALI ,
			AMDI_COD_AMBI_DICT ,    
			DUR_CURS_SESI      ,    
			PRE_REQU_CAPA      ,    
			SEPE_COD_SECU_PEDI ,    
			NUM_CAMP_CUMP_PREQ ,    
			NUM_CAMP_EVAL      ,    
			NUM_PEDI_REQU      ,    
			IND_CTRL_MORO      ,    
			NIVE_COD_NIVE_VENT ,    
			IND_EXON_ASIS      ,    
			STA_CLIE      ,    
			IND_COST_CURS      ,    
			NUM_CAMP_MAXI_ASRE ,    
			IND_INVI_CURS      ,    
			IND_DICT_EXMA      ,    
			EST_CURS_CAPA      ,
			IND_REGA_ASIS_CURS ,
			IND_CALI_CTDA      ,
			IND_CALI_CDRA      ,
			NUM_INVI,
			IND_INVI_GERE_ZONA , 
			IND_INVI_PAQU_DOCU ,
			COD_PROD_INVI	   ,
			COD_DOCU_IMPR	   ,
			VAL_CURS		   ,
			COD_PROD_CURS		,
			NUM_CUOT_PAGA_CURS ,	
			TICC_COD_TIPO_COST_CURS,
			COD_CLAS           ,
			IND_CALI_AMBI	   ,
        	USU_DIGI		   , 
        	FEC_DIGI 
		) 
	    VALUES 
	    (
		 #codigoPais#,                     
	 	 #codigoEmpresa#,                  
	 	 #codigoCurso#,                    
	 	 #nombreCurso#,                    
	 	 #siglasCurso#,                    
	 	 #objetivoCurso#,                  
	 	 '1',                 
	 	 #codigoFrecuenciaCalificacion#,   
	 	 #campanhaInicial#,     
	 	 #numeroCampanhas#,                
		 #numeroCampanhasPreviaDictado#,                		 
	 	 #codigoAmbitoDictado#,            
	 	 #duracionCurso#,                  
	 	 #prerequisitoCapacitacion#,       
	 	 #codigoSecuenciaPedido#,          
	 	 #numeroCampanhasPrerequisito#,    
	 	 #numeroCampanhasEvaluar#,         
	 	 #numeroPedidosRequeridos#,        
	 	 #indicadorMorosidad#,             
	 	 #codigoNivelVenta#,               
	 	 #indicadorExoneracionAsistencia#, 
	 	 #indicadorPrimerPedido#,        
	 	 #indicadorCostoCurso#,            
	 	 #numeroCampanhasMaximaAsistencia#,
	 	 #indicadorInvitacionCurso#,       
	 	 #indicadorDictadoExtemporaneo#,   
	 	 #estadoCurso#,                    
	 	 #indicadorRegaloAsistencia#,      
	 	 #indicadorEvaluacionCapacitada#,
	     #indicadorEvaluacionCapacitadora#,  
		 #numeroCampanhaInvitacion#,
		 #indicadorReporteGerenteZona#,
		 #indicadorPaqueteDocumentario#,
		 #codigoProductoInvitacion#,
		 #codigoDocumentoImprimir#,
		 #costoCurso#,	
	     #codigoProductoCurso#,
		 #numeroCuotasPagar#,
		 #tipoCostoCurso#,
		 #codigoClasificacion#,	
		 #indicadorCalificacionAmbito#,
         #auditInfo.createdBy#, 
         #auditInfo.created#
		)
	</insert>
	
    <insert id="insertDespachoProducto" parameterClass="despachoProductoCurso">
		INSERT INTO EDU_DESPA_PRODU
		 (
		  PAIS_COD_PAIS           ,
		  EMCO_COD_EMPR_COME      ,
		  CCAP_COD_CURS_CAPA      ,
		  COR_DESP_PROD           ,
		  TDES_COD_TIPO_DESP      ,
		  COD_PROD_SERV           ,
		  TIDE_COD_TIPO_INDI_DESP ,
		  EST_REGI                ,
		  USU_DIGI                ,
		  FEC_DIGI                ,
		  USU_MODI                ,
		  FEC_MODI                
		  )
		VALUES
		 (
		#codigoPais#,                  
		#codigoEmpresa#,               
		#codigoCurso#,                 
		#correlativoDespachoCurso#,    
		#codigoTipoDespacho#,          
		#codigoProducto#,              
		#codigoTipoIndicadorDespacho#, 
		'1',              
        #auditInfo.createdBy#, 
        #auditInfo.created#,
		#auditInfo.createdBy#, 
        #auditInfo.created#
	    )
	</insert>
	
	<insert id="insertCursoCapacitacionAmbito" parameterClass="cursoCapacitacionAmbito">
		INSERT INTO EDU_PARAM_CURSO_CAPAC_AMBIT
		(
			PAIS_COD_PAIS,      
			EMCO_COD_EMPR_COME, 
			CCAP_COD_CURS_CAPA, 
			COR_PARAM_CURS_AMBI,
			AMDI_COD_AMBI_DICT,      
			COD_REGI,           
			COD_ZONA,           
			COD_CLAS,           
			USU_DIGI,           
			FEC_DIGI,           
			USU_MODI,           
			FEC_MODI,   	    	
			EST_REGI           
		)
		VALUES(
			#codigoPais#,							
			#codigoEmpresa#,          
			#codigoCurso#,            
			#correlativo#,						
			#codigoAmbito#, 					
			#codigoRegion#,           
			#codigoZona#,             
			#codigoClasificacion#, 	  
			#auditInfo.createdBy#, 		
			#auditInfo.created#, 			
			#auditInfo.createdBy#, 		
			#auditInfo.created#, 				
			#estadoRegistro#      		
		)
	</insert>

	<select id="getCapacitadasTemporal" parameterClass="detallePlanilla" resultMap="detallePlanillaResult">
		SELECT
			A.COD_PAIS,           
			A.COD_EMPR_COME,      
			B.DES_EMPR_COME,      
			A.COD_CURS_CAPA,      
			E.NOM_CURS_CAPA,      
			A.COD_CURS_DICT,      
			A.COD_INST,           
			A.CAM_INIC_CURS,      
			A.FEC_INIC_CURS,      
			A.NUM_REAL_DURA_SESI, 
			A.COD_REGI,           
			A.COD_ZONA,           
			A.LUG_CAPA,           
			A.CAT_LUGA_CAPA,      
			A.IND_EVAL_CURS,      
			NVL(A.CAL_PROM_CURS_DICT,0) AS CAL_PROM_CURS_DICT, 
			A.EST_CURS_DICT,      
			A.EST_REGI,           
			A.COD_PLAN_PROG,      
			A.COD_CLIE,           
			A.IND_ASIS,
			F.APE_PATE,
			F.APE_MATE,
			F.PRI_NOMB,
			F.SEG_NOMB,
      		CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           		NVL(F.PRI_NOMB,'') || ' ' || NVL(F.SEG_NOMB,'') ||' '|| NVL(F.APE_PATE,' ')||' '||NVL(F.APE_MATE,' ' )
      		ELSE
          		NVL(F.APE_NOMB_COMP,'')     
      		END AS DES_CLIENTE,    
			DECODE(TRIM(F.NUM_TELE_PART),'0','',F.NUM_TELE_PART) as NUM_TELE_PART,
			F.CAM_INGR,
			F.STA_CLIE
		FROM EDU_TMP_HISTO_CURSO_DICTA A,
			 EDU_EMPRE_COMER B,
    		 EDU_PARAM_CURSO_CAPAC E,
			 EDU_MAEST_CLIEN F,
			 EDU_PARAM_PROGR_CAPAC PPC
		WHERE  A.COD_PAIS = #codigoPais#
		AND	   A.COD_EMPR_COME = #codigoEmpresa#
		AND	   A.COD_PAIS = B.PAIS_COD_PAIS
    	AND    A.COD_EMPR_COME = B.COD_EMPR_COME

    	AND   PPC.PAIS_COD_PAIS = B.PAIS_COD_PAIS
    	AND   PPC.EMCO_COD_EMPR_COME = B.COD_EMPR_COME
    	AND   PPC.COD_PROG_CAPA = '01'

		AND	   F.PAIS_COD_PAIS  	 = A.COD_PAIS
		AND	   F.EMCO_COD_EMPR_COME	 = A.COD_EMPR_COME
		AND	   F.COD_CLIE			 = A.COD_CLIE

	    AND    E.PAIS_COD_PAIS = A.COD_PAIS
    	AND    E.EMCO_COD_EMPR_COME = A.COD_EMPR_COME
	    AND    E.COD_CURS_CAPA = A.COD_CURS_CAPA
		AND	   A.EST_REGI != '9'

		<isNotEmpty prepend="AND" property="codigoCurso">
			A.COD_CURS_CAPA =#codigoCurso#
		</isNotEmpty>		

		<isNotEmpty prepend="AND" property="codigoInstructora">
			A.COD_INST   =#codigoInstructora#
		</isNotEmpty>		

		<isNotEmpty prepend="AND" property="codigoCursoDictado">
			A.COD_CURS_DICT =#codigoCursoDictado#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="indicadorAsistencia">
			A.IND_ASIS =#indicadorAsistencia#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanilla">
			A.COD_PLAN_PROG =#codigoPlanilla#
		</isNotEmpty>		
		ORDER BY 
			TO_NUMBER(A.COD_CURS_DICT),   
			DES_CLIENTE   

	</select>

	<insert id="insertCapacitadasTemporal" parameterClass="detallePlanilla">
		INSERT INTO EDU_TMP_HISTO_CURSO_DICTA
		(
			COD_PAIS,           
			COD_EMPR_COME,      
			COD_CURS_CAPA,      
			COD_CURS_DICT,      
			COD_INST,           
			CAM_INIC_CURS,      
			FEC_INIC_CURS,      
			NUM_REAL_DURA_SESI, 
			COD_REGI,           
			COD_ZONA,           
			LUG_CAPA,           
			CAT_LUGA_CAPA,      
			IND_EVAL_CURS,      
			CAL_PROM_CURS_DICT, 
			EST_CURS_DICT,      
			EST_REGI,           
			COD_PLAN_PROG,      
			COD_CLIE,           
			IND_ASIS,           
			USU_DIGI,           
			FEC_DIGI
		)
		VALUES
		(
			#codigoPais#                ,
			#codigoEmpresa#             ,
			#codigoCurso#               ,
			#codigoCursoDictado#        ,
			#codigoInstructora#         ,
			#campanhaInicio#            ,
			#fechaInicio#               ,
			#numeroSesiones#            ,
			#codigoRegion#              ,
			#codigoZona#                ,
			#lugarCapacitacion#         ,
			#categoriaLugarCapacitacion# ,
			#indicadorEvaluacionCurso#  ,
			#calificacionEvaluacionCurso#,
			#estadoCursoDictado#        ,
			'1'				            ,
			#codigoPlanilla#            ,                   
			#codigoCliente#             ,
			#indicadorAsistencia#       ,
			#auditInfo.createdBy#		, 		
			#auditInfo.created#
		)
	</insert>

	<update id="updateCapacitadasTemporal" parameterClass="detallePlanilla">
		UPDATE EDU_TMP_HISTO_CURSO_DICTA SET 
			COD_INST                  =   			#codigoInstructora#         ,                   
			CAM_INIC_CURS             =   			#campanhaInicio#            ,                   
			FEC_INIC_CURS             =   			#fechaInicio#               ,                   
			NUM_REAL_DURA_SESI        =   			#numeroSesiones#            ,                   
			COD_REGI                  =   			#codigoRegion#              ,                   
			COD_ZONA                  =   			#codigoZona#                ,                   
			LUG_CAPA                  =   			#lugarCapacitacion#         ,                   
			CAT_LUGA_CAPA             =   			#categoriaLugarCapacitacion# ,                   
			IND_EVAL_CURS             =   			#indicadorEvaluacionCurso#  ,                   
			CAL_PROM_CURS_DICT        =   			#calificacionPromedio#      ,                   
			EST_CURS_DICT             =   			#estadoCursoDictado#        ,                   
			COD_PLAN_PROG             =   			#codigoPlanilla#            ,                   
			IND_ASIS                  =   			#indicadorAsistencia#       ,                   
     		USU_MODI		       	  =    	 		#auditInfo.updatedBy#		,          
     		FEC_MODI                  =    	 		#auditInfo.lastUpdated#             
		WHERE COD_PAIS           	  =			    #codigoPais#                                   
		AND	COD_EMPR_COME             =   			#codigoEmpresa#                                
		AND	COD_CURS_CAPA             =   			#codigoCurso#                                  
		AND	COD_CURS_DICT             =   			#codigoCursoDictado#
		AND	COD_CLIE				  =	            #codigoCliente#               
	</update>

	<update id="removeCapacitadasTemporal" parameterClass="detallePlanilla">
		DELETE FROM EDU_TMP_HISTO_CURSO_DICTA 
		WHERE COD_PAIS           	  =			    #codigoPais#                                   
		AND	COD_EMPR_COME             =   			#codigoEmpresa#                                
		AND	COD_CURS_CAPA             =   			#codigoCurso#                                  
		AND	COD_INST			      =   			#codigoInstructora#	                         
		<isNotEmpty prepend="AND" property="codigoPlanilla">
			COD_PLAN_PROG			  =#codigoPlanilla#
		</isNotEmpty>		

	</update>	

	<update id="updateCursoCapacitacion" parameterClass="cursoCapacitacion">
		UPDATE EDU_PARAM_CURSO_CAPAC 
        SET
			NOM_CURS_CAPA          =	 	 #nombreCurso#,                       
			SIG_CURS_CAPA          =	 	 #siglasCurso#,                       
			OBJ_CURS_CAPA          =	 	 #objetivoCurso#,                     
			EST_REGI               =	 	 #estadoRegistro#,                    
			FRCA_COD_FREC_CALI     =	 	 #codigoFrecuenciaCalificacion#,      
			CAM_INIC               =	 	 #campanhaInicial#,                   
			NUM_CAMP               =	 	 #numeroCampanhas#,           
		    NUM_CAMP_PREV_CALI     =	 	 #numeroCampanhasPreviaDictado#,           			        
			AMDI_COD_AMBI_DICT     =	 	 #codigoAmbitoDictado#,               
			DUR_CURS_SESI          =	 	 #duracionCurso#,                     
			PRE_REQU_CAPA          =	 	 #prerequisitoCapacitacion#,          
			SEPE_COD_SECU_PEDI     =	 	 #codigoSecuenciaPedido#,             
			NUM_CAMP_CUMP_PREQ     =	 	 #numeroCampanhasPrerequisito#,       
			NUM_CAMP_EVAL          =	 	 #numeroCampanhasEvaluar#,            
			NUM_PEDI_REQU          =	 	 #numeroPedidosRequeridos#,           
			IND_CTRL_MORO          =	 	 #indicadorMorosidad#,                
			NIVE_COD_NIVE_VENT     =	 	 #codigoNivelVenta#,                  
			IND_EXON_ASIS          =	 	 #indicadorExoneracionAsistencia#,    
			STA_CLIE 			   =	 	 #indicadorPrimerPedido#,           
			IND_COST_CURS          =	 	 #indicadorCostoCurso#,               
			NUM_CAMP_MAXI_ASRE     =	 	 #numeroCampanhasMaximaAsistencia#,   
			IND_INVI_CURS          =	 	 #indicadorInvitacionCurso#,          
			IND_DICT_EXMA          =	 	 #indicadorDictadoExtemporaneo#,      
			EST_CURS_CAPA          =	 	 #estadoCurso#,                       
			IND_REGA_ASIS_CURS     =	 	 #indicadorRegaloAsistencia#,         
			IND_CALI_CTDA          =	 	 #indicadorEvaluacionCapacitada#,     
			IND_CALI_CDRA          =    	 #indicadorEvaluacionCapacitadora#,  
			NUM_INVI  			   =         #numeroCampanhaInvitacion#,
			IND_INVI_GERE_ZONA	   =  		 #indicadorReporteGerenteZona#,
			IND_INVI_PAQU_DOCU	   =  		 #indicadorPaqueteDocumentario#,	
			COD_PROD_INVI		   =		 #codigoProductoInvitacion#,
			COD_DOCU_IMPR		   =		 #codigoDocumentoImprimir#,		
			VAL_CURS			   =		 #costoCurso#,
			COD_PROD_CURS		   = 		 #codigoProductoCurso#,
			NUM_CUOT_PAGA_CURS	   =		 #numeroCuotasPagar#,
            TICC_COD_TIPO_COST_CURS = 		 #tipoCostoCurso#,
			COD_CLAS			   =  		 #codigoClasificacion#,	
			IND_CALI_AMBI		   =         #indicadorCalificacionAmbito#,
     		USU_MODI		       =    	 #auditInfo.updatedBy#,          
     		FEC_MODI               =    	 #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS        =		 #codigoPais#                        
		AND	EMCO_COD_EMPR_COME     =	 	 #codigoEmpresa#                     
		AND	COD_CURS_CAPA          =	 	 #codigoCurso#
	</update>

	<update id="updateRemoveCursoCapacitacion" parameterClass="cursoCapacitacion">
		UPDATE EDU_PARAM_CURSO_CAPAC SET
			EST_REGI               =	 	 '9',                    
     		USU_MODI		       =    	 #auditInfo.updatedBy#,          
     		FEC_MODI               =    	 #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS        =		 #codigoPais#                        
		AND	EMCO_COD_EMPR_COME     =	 	 #codigoEmpresa#                     
		AND	COD_CURS_CAPA          =	 	 #codigoCurso#                       
	</update>

	<update id="updateDespachoProducto" parameterClass="despachoProductoCurso">
		UPDATE EDU_DESPA_PRODU SET
		  TDES_COD_TIPO_DESP      =		#codigoTipoDespacho#,          
		  COD_PROD_SERV           =		#codigoProducto#,              
		  TIDE_COD_TIPO_INDI_DESP =		#codigoTipoIndicadorDespacho#, 
		  EST_REGI                =		#estadoRegistro#,              
		  USU_MODI                =   	#auditInfo.updatedBy#,     
		  FEC_MODI                =     #auditInfo.lastUpdated#        
		WHERE PAIS_COD_PAIS       =		#codigoPais#                  
		AND   EMCO_COD_EMPR_COME  =		#codigoEmpresa#               
		AND   CCAP_COD_CURS_CAPA  =		#codigoCurso#                
		AND   COR_DESP_PROD       =		#correlativoDespachoCurso#
	</update>

	<update id="removeDespachoProducto" parameterClass="despachoProductoCurso">
		DELETE FROM EDU_DESPA_PRODU  
		WHERE PAIS_COD_PAIS       =		#codigoPais#                  
		AND   EMCO_COD_EMPR_COME  =		#codigoEmpresa#               
		AND   CCAP_COD_CURS_CAPA  =		#codigoCurso#                
	</update>
	
	<update id="removeLogicoDespachoProducto" parameterClass="despachoProductoCurso">
		UPDATE EDU_DESPA_PRODU  SET
			EST_REGI              =	 	 '9',                    
     		USU_MODI		       =    #auditInfo.updatedBy#,          
     		FEC_MODI               =    #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS       =		#codigoPais#                  
		AND   EMCO_COD_EMPR_COME  =		#codigoEmpresa#               
		AND   CCAP_COD_CURS_CAPA  =		#codigoCurso#                
	</update>

	<update id="removeCursoCapacitacionAmbito" parameterClass="cursoCapacitacionAmbito">
		DELETE EDU_PARAM_CURSO_CAPAC_AMBIT
		WHERE PAIS_COD_PAIS       =		#codigoPais#                  
		AND   EMCO_COD_EMPR_COME  =		#codigoEmpresa#               
		AND   CCAP_COD_CURS_CAPA  =		#codigoCurso#                
	</update>
	<select id="getPlanillaProgramacionCurso" parameterClass="planillaProgramacionCurso" resultMap="planillaProgramacionCursoResult">
		SELECT
			A.PAIS_COD_PAIS,      
			A.EMCO_COD_EMPR_COME, 
			B.DES_EMPR_COME,      
			A.CCAP_COD_CURS_CAPA, 
			C.NOM_CURS_CAPA,      
			A.CLIE_COD_CLIE,      
			A.COD_PLAN_PROG,      
			A.TIP_CALI_APTA,      
			A.IND_CURS_COST,      
			A.IND_CURS_FACT,      
			A.EST_REGI
		FROM EDU_PLANI_PROGR_CURSO A,			
				 EDU_EMPRE_COMER B,
				 EDU_PARAM_CURSO_CAPAC C
		WHERE B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND		A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
		AND	    A.EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME		
		AND		A.CCAP_COD_CURS_CAPA = C.COD_CURS_CAPA
		AND		A.EST_REGI !='9'
		<isNotEmpty prepend="AND" property="codigoPlanilla">
			A.COD_PLAN_PROG = #codigoPlanilla#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
					A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		</isNotEmpty>		
  </select>                                                        

  <select id="getPlanillaCursoDictadoDetalle" parameterClass="historicoCursoDictadoDetalle" resultMap="planillaCursoDictadoResult">
	  SELECT	DISTINCT (A.COD_PLAN_PROG) AS COD_PLAN_PROG
		FROM 	 EDU_HISTO_CURSO_DICTA_DETAL A
		WHERE   A.EST_REGI !='9'
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
					A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCursoDictado">
					A.CDIC_COD_CURS_DICT = #codigoCursoDictado#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanillaProgramacion">
					A.COD_PLAN_PROG = #codigoPlanillaProgramacion#       	
		</isNotEmpty>		
		ORDER BY TO_NUMBER(A.COD_PLAN_PROG) ASC
  </select>
  <select id="getHistoricoCursoDictadoDetalle" parameterClass="historicoCursoDictadoDetalle" resultMap="historicoCursoDictadoDetalleResult">
	  SELECT
				A.PAIS_COD_PAIS,      
				A.EMCO_COD_EMPR_COME, 
				B.DES_EMPR_COME,      
				A.CCAP_COD_CURS_CAPA, 
				C.NOM_CURS_CAPA,      
				A.CDIC_COD_CURS_DICT, 
				A.CLIE_COD_CLIE,      
				A.COD_PLAN_PROG,      
				A.CAL_INST,           
				A.EST_REGI,
				A.IND_ASIS,
				A.CAL_CONS,
				D.APE_PATE,
				D.APE_MATE,
				D.PRI_NOMB,
				D.SEG_NOMB,
		        CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           			NVL(D.PRI_NOMB,'') || ' ' || NVL(D.SEG_NOMB,'') ||' '|| NVL(D.APE_PATE,' ')||' '||NVL(D.APE_MATE,' ' )
      			ELSE
          			NVL(D.APE_NOMB_COMP,'')     
      			END AS DES_CLIENTE ,    
				DECODE(TRIM(D.NUM_TELE_PART),'0','',D.NUM_TELE_PART) as NUM_TELE_PART,
				D.CAM_INGR,
				D.STA_CLIE          
		FROM 	 EDU_EMPRE_COMER B,
				 EDU_PARAM_CURSO_CAPAC C,
				 EDU_MAEST_CLIEN D,
				 EDU_HISTO_CURSO_DICTA_DETAL A,
				 EDU_PARAM_PROGR_CAPAC PPC
		WHERE   B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME

    	AND     PPC.PAIS_COD_PAIS = B.PAIS_COD_PAIS
    	AND     PPC.EMCO_COD_EMPR_COME = B.COD_EMPR_COME
    	AND     PPC.COD_PROG_CAPA = '01'

		AND		A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
		AND	    A.EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME		
		AND		A.CCAP_COD_CURS_CAPA = C.COD_CURS_CAPA
		AND		A.EST_REGI !='9'
		AND		D.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		D.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND		D.COD_CLIE = A.CLIE_COD_CLIE
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
					A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCursoDictado">
					A.CDIC_COD_CURS_DICT = #codigoCursoDictado#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanillaProgramacion">
					A.COD_PLAN_PROG= #codigoPlanillaProgramacion#       	
		</isNotEmpty>		
	  <isNotEmpty prepend="AND" property="codigoCliente">
					A.CLIE_COD_CLIE= #codigoCliente#       	
		</isNotEmpty>		
	ORDER BY DES_CLIENTE
  </select>                                                          	
  
  <select id="getHistoricoCursoDictado" parameterClass="historicoCursoDictado" resultMap="historicoCursoDictadoResult">
		SELECT
		    A.PAIS_COD_PAIS,      
		    A.EMCO_COD_EMPR_COME, 
		    B.DES_EMPR_COME,      
		    A.CCAP_COD_CURS_CAPA, 
		    C.NOM_CURS_CAPA,      
		    A.COD_CURS_DICT,      
		    A.INST_COD_INST,      
		    A.CAM_INIC_CURS,      
		    A.FEC_INIC_CURS,      
		    A.NUM_REAL_DURA_SESI, 
		    A.COD_REGI,           
		    D.DES_REGI,           
		    A.COD_ZONA,           
		    E.DES_ZONA,           
		    A.LUG_CAPA,          
		    A.IND_EVAL_CURS,      
		    A.CAL_PROM_CURS_DICT, 
			A.CAT_LUGA_CAPA,
		    A.EST_REGI,           
		    A.EST_CURS_DICT,
			A.LOCA_COD_LOCA,
			A.SALA_COD_SALA      
			FROM EDU_HISTO_CURSO_DICTA_CABEC A,
					 EDU_EMPRE_COMER B,
					 EDU_PARAM_CURSO_CAPAC C,
					 EDU_REGIO D,
					 EDU_ZONA E,
					 EDU_MAEST_INSTR F
			WHERE B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
			AND	  B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME
			AND	  A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
			AND	  A.EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME		
			AND	  A.CCAP_COD_CURS_CAPA = C.COD_CURS_CAPA
			AND   D.PAIS_COD_PAIS = A.PAIS_COD_PAIS
			AND   D.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
			AND   D.COD_REGI 		  = A.COD_REGI
			AND   E.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			AND   E.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			AND   E.REGI_COD_REGI			= D.COD_REGI
			AND   E.COD_ZONA			= A.COD_ZONA
			AND	  A.EST_REGI !='9'
			AND	  F.PAIS_COD_PAIS  = A.PAIS_COD_PAIS
			AND	  F.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
			AND	  F.COD_INST		= A.INST_COD_INST
			<isNotEmpty prepend="AND" property="codigoPais">
						A.PAIS_COD_PAIS = #codigoPais#       	
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoEmpresa">
						A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoCurso">
						A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoCursoDictado">
						A.COD_CURS_DICT = #codigoCursoDictado#       	
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="campanhaInicio">
						A.CAM_INIC_CURS = #campanhaInicio#       	
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="login">
						F.USE_USUA = #login#       	
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoInstructora">
						F.COD_INST = #codigoInstructora#       	
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="estadoCursoDictado">
						A.EST_CURS_DICT = #estadoCursoDictado#       	
			</isNotEmpty>		
			ORDER BY A.PAIS_COD_PAIS,      
				     A.EMCO_COD_EMPR_COME, 
		 		     A.CCAP_COD_CURS_CAPA, 
				     TO_NUMBER(A.COD_CURS_DICT)

	</select>                                                          	    

	<select id="getHistoricoCapacitadasDetalle" parameterClass="historicoCapacitadasDetalle" resultMap="historicoCapacitadasDetalleResult">
		SELECT
			A.PAIS_COD_PAIS,           
			A.EMCO_COD_EMPR_COME,      
			B.DES_EMPR_COME,           
			A.CLIE_COD_CLIE,           
			A.CCAP_COD_CURS_CAPA,      
			C.NOM_CURS_CAPA,           
			A.TASI_COD_TIPO_ASIS_CURS, 
			D.DES_TIPO_ASIS_CURS,      
			A.ASTT_COD_TIPO_ASTT_CURS, 
			E.DES_TIPO_ASTT_CURS,      
			A.NUM_INVI,                
			A.IND_PAGO_CURS,           
			A.COD_CURS_DICT,           
			A.INST_COD_INST,                
			A.CAM_CAPA,                
			A.CAM_REGI_ASIS,           
			A.IND_EVAL_CURS,           
			NVL(A.CAL_EVAL_CURS,0) AS CAL_EVAL_CURS,           
			A.IND_EVAL_INST,           
			NVL(A.CAL_EVAL_INST,0) AS CAL_EVAL_INST,           
			A.EST_REGI,
      		A.CAM_PRIM_CALI_APTA,
      		A.CAM_ULTI_CALI_APTA,
	        A.COD_PLAN_PROG,
			F.APE_PATE,
			F.APE_MATE,
			F.PRI_NOMB,
			F.SEG_NOMB,
      		CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           		NVL(F.PRI_NOMB,'') || ' ' || NVL(F.SEG_NOMB,'') ||' '|| NVL(F.APE_PATE,' ')||' '||NVL(F.APE_MATE,' ' )
      		ELSE
          		NVL(F.APE_NOMB_COMP,'')     
      		END AS DES_CLIENTE ,    
			DECODE(TRIM(F.NUM_TELE_PART),'0','',F.NUM_TELE_PART) as NUM_TELE_PART,
			F.CAM_INGR
		FROM 	EDU_HISTO_CAPAC_DETAL A,
				EDU_EMPRE_COMER B,
				EDU_PARAM_CURSO_CAPAC C,
				EDU_TIPO_ASIST_CURSO D,
				EDU_TIPO_ASITT_CURSO E,
				EDU_MAEST_CLIEN F,
		        EDU_PARAM_PROGR_CAPAC PPC				
		WHERE B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND	  B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME

    	AND   PPC.PAIS_COD_PAIS = A.PAIS_COD_PAIS
    	AND   PPC.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
    	AND   PPC.COD_PROG_CAPA = '01'

		AND	  A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
		AND	  A.EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME		
		AND	  A.CCAP_COD_CURS_CAPA = C.COD_CURS_CAPA
		AND   D.COD_TIPO_ASIS_CURS = A.TASI_COD_TIPO_ASIS_CURS
		AND   E.COD_TIPO_ASTT_CURS = A.ASTT_COD_TIPO_ASTT_CURS
		AND   F.PAIS_COD_PAIS	= A.PAIS_COD_PAIS
		AND	  F.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND	  F.COD_CLIE = A.CLIE_COD_CLIE
		AND	  A.EST_REGI !='9'
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
					A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCursoDictado">
					A.COD_CURS_DICT = #codigoCursoDictado#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCliente">
					A.CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanilla">
					A.COD_PLAN_PROG = #codigoPlanilla#       	
		</isNotEmpty>	
		ORDER BY DES_CLIENTE,A.CCAP_COD_CURS_CAPA

	</select>                                                          	    	  	

	<select id="getHistoricoCapacitadas" parameterClass="historicoCapacitadas" resultMap="historicoCapacitadasResult">
		SELECT
			A.PAIS_COD_PAIS,      
			A.EMCO_COD_EMPR_COME, 
			B.DES_EMPR_COME,      
			A.CLIE_COD_CLIE,    	
			A.NIV_CAPA_ALCA,      
			A.CAM_INGR,           
			A.ULT_CAMP_CAPA,      
			A.EST_REGI           
		FROM 	EDU_HISTO_CAPAC_CABEC A,
				 EDU_EMPRE_COMER B
		WHERE B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND		A.EST_REGI !='9'
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCliente">
					A.CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>		
  </select>                                                          	    	
	
	<select id="getHistoricoAptas" parameterClass="historicoAptas" resultMap="historicoAptasResult">
	  SELECT 
				A.PAIS_COD_PAIS,      
				A.EMCO_COD_EMPR_COME, 
				B.DES_EMPR_COME,      
				A.CCAP_COD_CURS_CAPA, 
				C.NOM_CURS_CAPA,      
				A.CLIE_COD_CLIE,      
				A.COD_CURS_DICT,      
				A.COD_PLAN_PROG,      
				A.CAM_PRIM_CALI_APTA, 
				A.CAM_ULTI_CALI_APTA, 
				A.TIP_CALI_APTA,      
				A.NUM_INVI,           
				A.IND_INIC_CALI_APTA, 
				A.IND_FINA_CALI_APTA, 
				A.IND_CURS_COST,      
				A.IND_CURS_FACT,      
				A.CAM_FACT_CURS,      
				A.ULT_CAMP_PROG_DICT, 
				A.EST_CAPA,           
				A.EST_REGI,
		        A.CAM_ACEP,
      			CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           			 NVL(D.PRI_NOMB,'') || ' ' || NVL(D.SEG_NOMB,'') ||' '|| NVL(D.APE_PATE,' ')||' '||NVL(D.APE_MATE,' ' )
      			ELSE
          			 NVL(D.APE_NOMB_COMP,'')     
      			END AS DES_CLIENTE ,    
				D.APE_PATE,
				D.APE_MATE,
				D.PRI_NOMB,
				D.SEG_NOMB,
				DECODE(A.EST_REGI,'CP','SI','NO') AS ASISTENCIA
		FROM 	EDU_HISTO_APTAS A,
				EDU_EMPRE_COMER B,
				EDU_PARAM_CURSO_CAPAC C,
				EDU_MAEST_CLIEN	D,
		        EDU_PARAM_PROGR_CAPAC PPC								 
		WHERE   B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME

    	AND   	PPC.PAIS_COD_PAIS = A.PAIS_COD_PAIS
    	AND   	PPC.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
    	AND   	PPC.COD_PROG_CAPA = '01'

		AND		A.EST_REGI !='9'
		AND		A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
		AND	    A.EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME		
		AND		A.CCAP_COD_CURS_CAPA = C.COD_CURS_CAPA
		AND		D.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		D.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND		D.COD_CLIE		= A.CLIE_COD_CLIE
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
					A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCliente">
					A.CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanillaProgramacion">
					A.COD_PLAN_PROG = #codigoPlanillaProgramacion#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="estadoCapacitacion">
					A.EST_CAPA = #estadoCapacitacion#       	
		</isNotEmpty>		
		ORDER BY DES_CLIENTE
		
  </select>                                                          	    		    		

	<select id="getHistoricoAptasPlanilla" parameterClass="detallePlanilla" resultMap="detallePlanillaResult">
	  SELECT 
				A.PAIS_COD_PAIS as COD_PAIS,      
				A.EMCO_COD_EMPR_COME as COD_EMPR_COME, 
				B.DES_EMPR_COME,      
				A.CCAP_COD_CURS_CAPA AS COD_CURS_CAPA, 
				C.NOM_CURS_CAPA,      
				A.CLIE_COD_CLIE AS COD_CLIE,      
				A.COD_CURS_DICT,      
				'' AS COD_INST,
				'' AS CAM_INIC_CURS,
				SYSDATE AS FEC_INIC_CURS,
				0 AS NUM_REAL_DURA_SESI,
				A.COD_PLAN_PROG,      
				'' AS COD_REGI,
				'' AS COD_ZONA,
				'' AS LUG_CAPA,
				'' AS CAT_LUGA_CAPA,
				'N' AS IND_EVAL_CURS,
				0 AS CAL_PROM_CURS_DICT,
				'A' AS EST_CURS_DICT,
				A.EST_REGI,
				'N' AS IND_ASIS,
				D.APE_PATE,
				D.APE_MATE,
				D.PRI_NOMB,
				D.SEG_NOMB,
      			CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           			NVL(D.PRI_NOMB,'') || ' ' || NVL(D.SEG_NOMB,'') ||' '|| NVL(D.APE_PATE,' ')||' '||NVL(D.APE_MATE,' ' )
      			ELSE
          			NVL(D.APE_NOMB_COMP,'')     
      			END AS DES_CLIENTE ,    
				DECODE(TRIM(D.NUM_TELE_PART),'0','',D.NUM_TELE_PART) as NUM_TELE_PART,
				D.CAM_INGR,
				D.STA_CLIE
		FROM 	EDU_HISTO_APTAS A,
				EDU_EMPRE_COMER B,
				EDU_PARAM_CURSO_CAPAC C,
				EDU_MAEST_CLIEN	D,
       			EDU_PARAM_PROGR_CAPAC PPC								 
		WHERE   B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME

    	AND   	PPC.PAIS_COD_PAIS 	   = A.PAIS_COD_PAIS
    	AND   	PPC.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
    	AND   	PPC.COD_PROG_CAPA 	   = '01'

		AND		A.EST_REGI !='9'
		AND		A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
		AND	    A.EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME		
		AND		A.CCAP_COD_CURS_CAPA = C.COD_CURS_CAPA
		AND		D.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		D.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND		D.COD_CLIE		= A.CLIE_COD_CLIE
		<isNotEmpty prepend="AND" property="estadoCapacitacion">
					A.EST_CAPA = #estadoCapacitacion#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
					A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanilla">
					A.COD_PLAN_PROG = #codigoPlanilla#     
		</isNotEmpty>		
		ORDER BY A.NUM_INVI,DES_CLIENTE

  </select>                              
                            	    		    		
  <select id="existClienteCursoDictadoDetalle" parameterClass="historicoCursoDictadoDetalle" resultClass="string">
	  SELECT	A.CLIE_COD_CLIE
		FROM 	 EDU_HISTO_CURSO_DICTA_DETAL A
		WHERE   A.PAIS_COD_PAIS 	 = #codigoPais#
		AND		A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		AND		A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		AND		A.CDIC_COD_CURS_DICT = #codigoCursoDictado#       	
		AND	    A.CLIE_COD_CLIE      = #codigoCliente#       	
  </select>

  <select id="existClienteCursoCapacitadaDetalle" parameterClass="historicoCursoDictadoDetalle" resultClass="string">
	  SELECT	A.CLIE_COD_CLIE
		FROM 	 EDU_HISTO_CAPAC_DETAL A
		WHERE   A.PAIS_COD_PAIS 	 = #codigoPais#
		AND		A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		AND		A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		AND	    A.CLIE_COD_CLIE      = #codigoCliente#       	
  </select>

  <insert id="insertPlanillaProgramacionCurso" parameterClass="planillaProgramacionCurso">
   INSERT INTO EDU_PLANI_PROGR_CURSO
   (
			PAIS_COD_PAIS,      
			EMCO_COD_EMPR_COME, 
			CCAP_COD_CURS_CAPA, 
			CLIE_COD_CLIE,      
			COD_PLAN_PROG,      
			TIP_CALI_APTA,      
			IND_CURS_COST,      
			IND_CURS_FACT,      
			EST_REGI		 ,
     	USU_DIGI		 , 
     	FEC_DIGI 
		)
		VALUES
		(
		#codigoPais#,								
		#codigoEmpresa#,           
		#codigoCurso#,             
		#codigoCliente#,           
		#codigoPlanilla#,          
		#tipoCalificacion#,        
		#indicadorCursoCosto#,     
		#indicadorCursoFacturado#, 
		#estadoRegistro#,
    #auditInfo.createdBy#, 
    #auditInfo.created#
		)
  </insert>		
  <update id="updatePlanillaProgramacionCurso" parameterClass="planillaProgramacionCurso">  
		UPDATE EDU_PLANI_PROGR_CURSO SET
			COD_PLAN_PROG      				=  #codigoPlanilla#,          
			TIP_CALI_APTA      				=  #tipoCalificacion#,        
			IND_CURS_COST      				=  #indicadorCursoCosto#,     
			IND_CURS_FACT      				=  #indicadorCursoFacturado#, 
   			USU_MODI		       			=	 #auditInfo.updatedBy#,          
   			FEC_MODI           				=  #auditInfo.lastUpdated#             
		WHERE   PAIS_COD_PAIS      	  =		#codigoPais#								
			AND EMCO_COD_EMPR_COME    =		#codigoEmpresa#
			AND CCAP_COD_CURS_CAPA    =		#codigoCurso#              
			AND CLIE_COD_CLIE         =		#codigoCliente#
  </update>

	<delete id="removeFisicoPlanillaProgramacionCurso" parameterClass="planillaProgramacionCurso">
		DELETE FROM EDU_PLANI_PROGR_CURSO 
		WHERE   PAIS_COD_PAIS      	  =		#codigoPais#								
			AND EMCO_COD_EMPR_COME    =		#codigoEmpresa#
			AND CCAP_COD_CURS_CAPA    =		#codigoCurso#              
			AND CLIE_COD_CLIE         =		#codigoCliente#
	</delete>

  <update id="removePlanillaProgramacionCurso" parameterClass="planillaProgramacionCurso">  
		UPDATE EDU_PLANI_PROGR_CURSO SET
			EST_REGI		      	=  '9',          
   			USU_MODI		       	=	 #auditInfo.updatedBy#,          
   			FEC_MODI           		=  #auditInfo.lastUpdated#             
		WHERE   PAIS_COD_PAIS      	  =		#codigoPais#								
			AND EMCO_COD_EMPR_COME    =		#codigoEmpresa#
			AND CCAP_COD_CURS_CAPA    =		#codigoCurso#              
			AND CLIE_COD_CLIE         =		#codigoCliente#
  </update>

  <insert id="insertHistoricoCursoDictadoDetalle" parameterClass="historicoCursoDictadoDetalle">
		INSERT INTO EDU_HISTO_CURSO_DICTA_DETAL
		(
			PAIS_COD_PAIS,      
			EMCO_COD_EMPR_COME, 
			CCAP_COD_CURS_CAPA, 
			CDIC_COD_CURS_DICT, 
			CLIE_COD_CLIE,      
			COD_PLAN_PROG,      
			CAL_INST,          
			IND_ASIS, 
			CAL_CONS,
			EST_REGI,           
     		USU_DIGI, 
     		FEC_DIGI 
		)
	 VALUES
	 (
			#codigoPais#,											
			#codigoEmpresa#,                 
			#codigoCurso#,                   
			#codigoCursoDictado#,            
			#codigoCliente#,                 
			#codigoPlanillaProgramacion#,    
			#calificacionInstructora#,       
			#indicadorAsistencia#,       
			#calificacionConsultora#,       
			'1',                
	    	#auditInfo.createdBy#, 
	    	#auditInfo.created#
	 )
  </insert>
	 
  <update id="updateHistoricoCursoDictadoDetalle" parameterClass="historicoCursoDictadoDetalle">
  	UPDATE  EDU_HISTO_CURSO_DICTA_DETAL SET 
			COD_PLAN_PROG        = #codigoPlanillaProgramacion#,
			CAL_INST             = #calificacionInstructora#,   
			IND_ASIS			 = #indicadorAsistencia#,   
			CAL_CONS			 = #calificacionConsultora#,   
   			USU_MODI		     = #auditInfo.updatedBy#,          
   			FEC_MODI           	 = #auditInfo.lastUpdated#             
  	WHERE 	PAIS_COD_PAIS      =#codigoPais#											
		AND	EMCO_COD_EMPR_COME =#codigoEmpresa#                  
		AND	CCAP_COD_CURS_CAPA =#codigoCurso#                    
		AND	CDIC_COD_CURS_DICT =#codigoCursoDictado#             
		AND CLIE_COD_CLIE     = #codigoCliente#
  </update>	

  <update id="updateDetalleDictadoCalificacionEjecutiva" parameterClass="historicoCursoDictadoDetalle">
  	UPDATE  EDU_HISTO_CURSO_DICTA_DETAL SET 
			CAL_INST             = #calificacionInstructora#,   
   			USU_MODI		     = #auditInfo.updatedBy#,          
   			FEC_MODI           	 = #auditInfo.lastUpdated#             
  	WHERE 	PAIS_COD_PAIS      =#codigoPais#											
		AND	EMCO_COD_EMPR_COME =#codigoEmpresa#                  
		AND	CCAP_COD_CURS_CAPA =#codigoCurso#                    
		AND	CDIC_COD_CURS_DICT =#codigoCursoDictado#             
		AND	CLIE_COD_CLIE      =#codigoCliente# 
  </update>	

  <delete id="removeFisicoHistoricoCursoDictadoDetalle" parameterClass="historicoCursoDictadoDetalle">
  	DELETE  FROM EDU_HISTO_CURSO_DICTA_DETAL 
  	WHERE	PAIS_COD_PAIS      =#codigoPais#											
		AND	EMCO_COD_EMPR_COME =#codigoEmpresa#                  
		AND	CCAP_COD_CURS_CAPA =#codigoCurso#                    
		AND	CDIC_COD_CURS_DICT =#codigoCursoDictado#             
	</delete>	

  <update id="removeHistoricoCursoDictadoDetalle" parameterClass="historicoCursoDictadoDetalle">
  	UPDATE  EDU_HISTO_CURSO_DICTA_DETAL SET 
			EST_REGI             = '9',            
   			USU_MODI		     = #auditInfo.updatedBy#,          
   			FEC_MODI           	 = #auditInfo.lastUpdated#             
  	WHERE	PAIS_COD_PAIS      =#codigoPais#											
		AND	EMCO_COD_EMPR_COME =#codigoEmpresa#                  
		AND	CCAP_COD_CURS_CAPA =#codigoCurso#                    
		AND	CDIC_COD_CURS_DICT =#codigoCursoDictado#             
  </update>	
  
	<insert id="insertHistoricoCapacitadas" parameterClass="historicoCapacitadas">
			INSERT INTO EDU_HISTO_CAPAC_CABEC
			(
			PAIS_COD_PAIS,      
			EMCO_COD_EMPR_COME, 
			CLIE_COD_CLIE,    	
			NIV_CAPA_ALCA,      
			CAM_INGR,           
			ULT_CAMP_CAPA,      
			EST_REGI,
	     	USU_DIGI, 
	     	FEC_DIGI 
			)
			VALUES
			(
			#codigoPais#,				
			#codigoEmpresa#,    
			#codigoCliente#,    
			#nivelCapacitacion#,
			#campanhaIngreso#,  
			#ultimaCampanha#,   
			'1',
	    	#auditInfo.createdBy#, 
	    	#auditInfo.created#
			)
	</insert>
	
	<update id="updateHistoricoCapacitadas" parameterClass="historicoCapacitadas">
		UPDATE EDU_HISTO_CAPAC_CABEC SET 
				NIV_CAPA_ALCA       = #nivelCapacitacion#,
				CAM_INGR            = #campanhaIngreso#,  
				ULT_CAMP_CAPA       = #ultimaCampanha#,   
		   		USU_MODI	   	    = #auditInfo.updatedBy#,          
		   		FEC_MODI            = #auditInfo.lastUpdated#             
		WHERE	PAIS_COD_PAIS     	 = #codigoPais#
		AND	EMCO_COD_EMPR_COME   = #codigoEmpresa#
		<isNotEmpty prepend="AND" property="codigoCliente">
					CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>		
	</update>

	<delete id="deleteConsultoraPlanillaNoRegistrada" parameterClass="historicoCapacitadas">
		DELETE FROM EDU_PLANI_PROGR_CONSU_NOREG 
		WHERE PAIS_COD_PAIS = #codigoPais#
		  AND EMCO_COD_EMPR_COME = #codigoEmpresa#
		  AND CAM_PROC = #ultimaCampanha#
		  AND CCAP_COD_CURS_CAPA = #nivelCapacitacion#
		  AND CLIE_COD_CLIE = #codigoCliente#       	
	</delete>

	<delete id="removeFisicoHistoricoCapacitadas" parameterClass="historicoCapacitadas">
		DELETE FROM EDU_HISTO_CAPAC_CABEC 
		WHERE  PAIS_COD_PAIS     	 = #codigoPais#
		AND	EMCO_COD_EMPR_COME   = #codigoEmpresa#
		<isNotEmpty prepend="AND" property="codigoCliente">
					CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>		
	</delete>

	<update id="removeHistoricoCapacitadas" parameterClass="historicoCapacitadas">
		UPDATE EDU_HISTO_CAPAC_CABEC SET 
			EST_REGI			 = #estadoRegistro#,
	   		USU_MODI		     = #auditInfo.updatedBy#,          
	   		FEC_MODI           	 = #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS     	 = #codigoPais#
		AND	EMCO_COD_EMPR_COME   = #codigoEmpresa#
		<isNotEmpty prepend="AND" property="codigoCliente">
					CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>		
	</update>

	<insert id="insertHistoricoAptas" parameterClass="historicoAptas">
		INSERT INTO EDU_HISTO_APTAS
		(
			PAIS_COD_PAIS,      
			EMCO_COD_EMPR_COME, 
			CCAP_COD_CURS_CAPA, 
			CLIE_COD_CLIE,      
			COD_CURS_DICT,      
			COD_PLAN_PROG,      
			CAM_PRIM_CALI_APTA, 
			CAM_ULTI_CALI_APTA, 
			TIP_CALI_APTA,      
			NUM_INVI,           
			IND_INIC_CALI_APTA, 
			IND_FINA_CALI_APTA, 
			IND_CURS_COST,      
			IND_CURS_FACT,      
			CAM_FACT_CURS,      
			ULT_CAMP_PROG_DICT, 
			CAM_ACEP,
			EST_CAPA,           
			EST_REGI,
		   	USU_DIGI, 
		   	FEC_DIGI 
		)
		VALUES
		(
		#codigoPais#,												 
		#codigoEmpresa#,                     
		#codigoCurso#,                       
		#codigoCliente#,                     
		#codigoCursoDictado#,                
		#codigoPlanillaProgramacion#,        
		#campanhaPrimeraCalificacionApta#,   
		#campanhaUltimaCalificacionApta#,    
		#tipoCalificacionApta#,              
		#numeroInvitacion#,                  
		#indicadorInicialCalificacionApta#,  
		#indicadorFinalCalificacionApta#,    
		#indicadorCursoCosto#,               
		#indicadorCursoFacturado#,           
		#campanhaFacturacionCurso#,          
		#ultimaCampanhaProgramacionDictado#, 
		#campanhaAceptacion#,
		#estadoCapacitacion#,                
		#estadoRegistro#,
	  	#auditInfo.createdBy#, 
	  	#auditInfo.created#
		)
	</insert>
	<update id="updateHistoricoAptas" parameterClass="historicoAptas">
			UPDATE EDU_HISTO_APTAS SET
					COD_CURS_DICT      	 = #codigoCursoDictado#,               
					COD_PLAN_PROG        = #codigoPlanillaProgramacion#,       
					CAM_PRIM_CALI_APTA   = #campanhaPrimeraCalificacionApta#,  
					CAM_ULTI_CALI_APTA   = #campanhaUltimaCalificacionApta#,   
					CAM_CAPA			 = #campanhaCapacitacion#,   	
					TIP_CALI_APTA        = #tipoCalificacionApta#,             
					NUM_INVI             = #numeroInvitacion#,                 
					IND_INIC_CALI_APTA   = #indicadorInicialCalificacionApta#, 
					IND_FINA_CALI_APTA   = #indicadorFinalCalificacionApta#,   
					IND_CURS_COST        = #indicadorCursoCosto#,              
					IND_CURS_FACT        = #indicadorCursoFacturado#,          
					CAM_FACT_CURS        = #campanhaFacturacionCurso#,         
					ULT_CAMP_PROG_DICT   = #ultimaCampanhaProgramacionDictado#,
					CAM_ACEP			 = #campanhaAceptacion#,	
					EST_CAPA             = #estadoCapacitacion#,               
	   				USU_MODI		     = #auditInfo.updatedBy#,          
		   			FEC_MODI           	 = #auditInfo.lastUpdated#             
			WHERE	PAIS_COD_PAIS      	 = #codigoPais#												 
			AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#                     
			AND	CCAP_COD_CURS_CAPA    = #codigoCurso#                       
			AND	CLIE_COD_CLIE         = #codigoCliente#                     
  </update>
	<update id="removeHistoricoAptas" parameterClass="historicoAptas">
			UPDATE EDU_HISTO_APTAS SET
				EST_REGI             = '9',                   
		   		USU_MODI		     = #auditInfo.updatedBy#,          
		   		FEC_MODI           	 = #auditInfo.lastUpdated#             
			WHERE PAIS_COD_PAIS      	  = #codigoPais#												 
			AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#                     
			AND	CCAP_COD_CURS_CAPA    = #codigoCurso#                       
			AND	CLIE_COD_CLIE         = #codigoCliente#                     
  </update>
	<delete id="removeFisicoHistoricoAptas" parameterClass="historicoAptas">
			DELETE FROM EDU_HISTO_APTAS
			WHERE  PAIS_COD_PAIS      		= #codigoPais#												 
			AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#                     
			AND	CCAP_COD_CURS_CAPA    = #codigoCurso#                       
			<isNotEmpty prepend="AND" property="codigoCliente">
					CLIE_COD_CLIE = #codigoCliente#       	
			</isNotEmpty>		
  </delete>
	<insert id="insertHistoricoCursoDictado" parameterClass="historicoCursoDictado">
		INSERT INTO EDU_HISTO_CURSO_DICTA_CABEC
		(
			PAIS_COD_PAIS,      
			EMCO_COD_EMPR_COME, 
			CCAP_COD_CURS_CAPA, 
			COD_CURS_DICT,      
			INST_COD_INST,      
			CAM_INIC_CURS,      
			FEC_INIC_CURS,      
			NUM_REAL_DURA_SESI, 
			COD_REGI,           
			COD_ZONA,           
			<isNotEmpty property="categoriaLugar">
			CAT_LUGA_CAPA,
			</isNotEmpty>
			<isNotEmpty property="lugarCapacitacion">
			LUG_CAPA,          
			</isNotEmpty>
			IND_EVAL_CURS,      
			<isNotEmpty property="calificacionPromedio">      
			CAL_PROM_CURS_DICT, 
			</isNotEmpty>
			EST_REGI,           
			EST_CURS_DICT,
			LOCA_COD_LOCA,
			<isNotEmpty property="codigoSala">
			SALA_COD_SALA,
			</isNotEmpty>
	   		USU_DIGI, 
	   		FEC_DIGI,
			SIST_COD_SIST 
		)
		VALUES
		(
		#codigoPais#,								
		#codigoEmpresa#,            
		#codigoCurso#,              
		#codigoCursoDictado#,       
		#codigoInstructora#,        
		#campanhaInicio#,           
		#fechaInicio#,              
		#numeroSesiones#,           
		#codigoRegion#,							
		#codigoZona#,     
		<isNotEmpty property="categoriaLugar">
		#categoriaLugar#,               
		</isNotEmpty>               
		<isNotEmpty property="lugarCapacitacion">
		#lugarCapacitacion#,        
		</isNotEmpty>               
		#indicadorEvaluacionCurso#, 
		<isNotEmpty property="calificacionPromedio"> 
		#calificacionPromedio#,     
		</isNotEmpty>
		#estadoRegistro#,           
		#estadoCursoDictado#,
		#codigoLocal#,
		<isNotEmpty property="codigoSala">
		#codigoSala#,
		</isNotEmpty>
	  	#auditInfo.createdBy#, 
	  	#auditInfo.created#,
	    #codigoSistema#
		)
	</insert>
	<update id="updateHistoricoCursoDictado" parameterClass="historicoCursoDictado">
		UPDATE EDU_HISTO_CURSO_DICTA_CABEC 
        SET 
			INST_COD_INST      		= #codigoInstructora#,        
			CAM_INIC_CURS           = #campanhaInicio#,           
			FEC_INIC_CURS           = #fechaInicio#,              
			NUM_REAL_DURA_SESI      = #numeroSesiones#,           
			COD_REGI                = #codigoRegion#,							
			COD_ZONA                = #codigoZona#,               
			<isNotEmpty property="lugarCapacitacion">
			LUG_CAPA                = #lugarCapacitacion#,        
			</isNotEmpty>		
			<isEmpty property="lugarCapacitacion">
				LUG_CAPA                = NULL,        
			</isEmpty>		
			<isNotEmpty property="categoriaLugar">
			CAT_LUGA_CAPA           = #categoriaLugar#,        
			</isNotEmpty>		
			<isEmpty property="categoriaLugar">
				CAT_LUGA_CAPA           = NULL,  
			</isEmpty>		
			IND_EVAL_CURS           = #indicadorEvaluacionCurso#, 
			<isNotEmpty property="calificacionPromedio">
			CAL_PROM_CURS_DICT      = #calificacionPromedio#,     
			</isNotEmpty>		
			<isEmpty property="calificacionPromedio">
				CAL_PROM_CURS_DICT      = NULL,     
			</isEmpty>		
			EST_CURS_DICT           = #estadoCursoDictado#,       
   			USU_MODI		       	= #auditInfo.updatedBy#,          
   			FEC_MODI           	 	= #auditInfo.lastUpdated#,
			LOCA_COD_LOCA			= #codigoLocal#,
			<isNotEmpty property="codigoSala">
				SALA_COD_SALA			= #codigoSala#,     
			</isNotEmpty>		
			<isEmpty property="codigoSala">
				SALA_COD_SALA			= NULL,         
			</isEmpty>		
            SIST_COD_SIST=#codigoSistema#
		WHERE PAIS_COD_PAIS       = #codigoPais#								
		AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#            
		AND	CCAP_COD_CURS_CAPA    = #codigoCurso#             
		AND	COD_CURS_DICT         = #codigoCursoDictado#
	</update>  

	<update id="updateHistoricoCursoDictadoWs" parameterClass="historicoCursoDictado">
		UPDATE EDU_HISTO_CURSO_DICTA_CABEC 
        SET 
			INST_COD_INST      		= #codigoInstructora#,        
			CAM_INIC_CURS           = #campanhaInicio#,           
			FEC_INIC_CURS           = #fechaInicio#,              
			NUM_REAL_DURA_SESI      = #numeroSesiones#,           
			COD_REGI                = #codigoRegion#,							
			COD_ZONA                = #codigoZona#,               
			<isNotEmpty property="lugarCapacitacion">
			LUG_CAPA                = #lugarCapacitacion#,        
			</isNotEmpty>		
			<isEmpty property="lugarCapacitacion">
				LUG_CAPA                = NULL,        
			</isEmpty>		
			<isNotEmpty property="categoriaLugar">
			CAT_LUGA_CAPA           = #categoriaLugar#,  
			</isNotEmpty>		
			<isEmpty property="categoriaLugar">
				CAT_LUGA_CAPA           = NULL,  
			</isEmpty>		
			LOCA_COD_LOCA			= #codigoLocal#,
    		SALA_COD_SALA			= #codigoSala#,      
   			USU_MODI		       	= #auditInfo.updatedBy#,          
   			FEC_MODI           	 	= #auditInfo.lastUpdated#,  
			SIST_COD_SIST=#codigoSistema#           
		WHERE PAIS_COD_PAIS       = #codigoPais#								
		AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#            
		AND	CCAP_COD_CURS_CAPA    = #codigoCurso#             
		AND	COD_CURS_DICT         = #codigoCursoDictado#
	</update>  

	<update id="updateDictadoCalificacionEjecutiva" parameterClass="historicoCursoDictado">
		UPDATE EDU_HISTO_CURSO_DICTA_CABEC 
        SET 
			CAL_PROM_CURS_DICT      = #calificacionPromedio#,     
   			USU_MODI		       	= #auditInfo.updatedBy#,          
   			FEC_MODI           	 	= #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS       = #codigoPais#								
		AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#            
		AND	CCAP_COD_CURS_CAPA    = #codigoCurso#             
		AND	COD_CURS_DICT         = #codigoCursoDictado#
	</update>  

	<update id="removeHistoricoCursoDictado" parameterClass="historicoCursoDictado">
		UPDATE EDU_HISTO_CURSO_DICTA_CABEC SET 
			EST_REGI                = '9',           
			EST_CURS_DICT           = #estadoCursoDictado#,       
   		USU_MODI		       	 	= #auditInfo.updatedBy#,          
   		FEC_MODI           	 		= #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS      		= #codigoPais#								
		AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#            
		AND	CCAP_COD_CURS_CAPA    = #codigoCurso#             
		AND	COD_CURS_DICT         = #codigoCursoDictado#
	</update>  
	
	<update id="removeFisicoHistoricoCursoDictado" parameterClass="historicoCursoDictado">
		DELETE FROM EDU_HISTO_CURSO_DICTA_CABEC 
		WHERE PAIS_COD_PAIS      		= #codigoPais#								
		AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#            
		<isNotEmpty prepend="AND" property="codigoCurso">
					CCAP_COD_CURS_CAPA    = #codigoCurso#             
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCursoDictado">
				COD_CURS_DICT = #codigoCursoDictado#       	
		</isNotEmpty>		
	</update>  

	<insert id="insertHistoricoCapacitadasDetalle" parameterClass="historicoCapacitadasDetalle" >
			INSERT INTO EDU_HISTO_CAPAC_DETAL
			(
			PAIS_COD_PAIS,           
			EMCO_COD_EMPR_COME,      
			CLIE_COD_CLIE,           
			CCAP_COD_CURS_CAPA,      
			TASI_COD_TIPO_ASIS_CURS, 
			ASTT_COD_TIPO_ASTT_CURS, 
			NUM_INVI,                
			IND_PAGO_CURS,           
			COD_CURS_DICT,           
			COD_PLAN_PROG,
			INST_COD_INST,                
  			CAM_PRIM_CALI_APTA,      
  			CAM_ULTI_CALI_APTA,      
			CAM_CAPA,                
			CAM_REGI_ASIS,           
			IND_EVAL_CURS,           
			CAL_EVAL_CURS,           
			IND_EVAL_INST,           
			CAL_EVAL_INST,           
			EST_REGI,
	   		USU_DIGI, 
	   		FEC_DIGI 
			)
			VALUES
			(
			#codigoPais#,														
			#codigoEmpresa#,                        
			#codigoCliente#,                        
			#codigoCurso#,                          
			#codigoTipoAsistencia#,                 
			#codigoTipoAsistente#,                  
			#numeroInvitaciones#,                   
			#indicadorPagoCurso#,                   
			#codigoCursoDictado#,                   
			#codigoPlanilla#,                    
			#codigoInstructora#,       
		    #campanhaPrimeraCalificacionApta#,
	        #campanhaUltimaCalificacionApta#,
			#campanhaCapacitacion#,                 
			#campanhaRegistroAsistencia#,           
			#indicadorEvaluacionCurso#,             
			#calificacionEvaluacionCurso#,          
			#indicadorEvaluacionInstructora#,      
			#calificacionEvaluacionInstructora#,   
			'1',
		    #auditInfo.createdBy#, 
		    #auditInfo.created#
			)
	</insert>

	<update id="updateHistoricoCapacitadasDetalle" parameterClass="historicoCapacitadasDetalle" >
			UPDATE EDU_HISTO_CAPAC_DETAL SET
				TASI_COD_TIPO_ASIS_CURS =  #codigoTipoAsistencia#,              
				ASTT_COD_TIPO_ASTT_CURS =  #codigoTipoAsistente#,               
				NUM_INVI                =  #numeroInvitaciones#,                
				IND_PAGO_CURS           =  #indicadorPagoCurso#,                
				COD_CURS_DICT           =  #codigoCursoDictado#,                
				INST_COD_INST    		=  #codigoInstructora#,                    
				COD_PLAN_PROG      		=  #codigoPlanilla#,                       
  				CAM_PRIM_CALI_APTA      =  #campanhaPrimeraCalificacionApta#,     
  				CAM_ULTI_CALI_APTA     	=  #campanhaUltimaCalificacionApta#,    
				CAM_CAPA                =  #campanhaCapacitacion#,              
				CAM_REGI_ASIS           =  #campanhaRegistroAsistencia#,        
				IND_EVAL_CURS           =  #indicadorEvaluacionCurso#,          
				CAL_EVAL_CURS           =  #calificacionEvaluacionCurso#,       
				IND_EVAL_INST    		=  #indicadorEvaluacionInstructora#,       
				CAL_EVAL_INST           =  #calificacionEvaluacionInstructora#,   
   		  		USU_MODI		       	=  #auditInfo.updatedBy#,          
   		  		FEC_MODI           	 	=  #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS         =  #codigoPais#										
		AND	EMCO_COD_EMPR_COME    	=  #codigoEmpresa#            
		AND	CLIE_COD_CLIE         	=  #codigoCliente#                
		AND	CCAP_COD_CURS_CAPA      =  #codigoCurso#
	</update>
	
	<update id="updateEvaluacionInstructoraCapacitadas" parameterClass="historicoCapacitadasDetalle" >
			UPDATE EDU_HISTO_CAPAC_DETAL SET
				IND_EVAL_INST    		=  #indicadorEvaluacionInstructora#,       
				CAL_EVAL_INST           =  #calificacionEvaluacionInstructora#,   
   		  		USU_MODI		       	=  #auditInfo.updatedBy#,          
   		  		FEC_MODI           	 	=  #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS       =  #codigoPais#										
		AND	EMCO_COD_EMPR_COME    =  #codigoEmpresa#                
		AND	CLIE_COD_CLIE         =  #codigoCliente#      
		AND	CCAP_COD_CURS_CAPA    =  #codigoCurso#      	          
	</update>

	<update id="removeHistoricoCapacitadasDetalle" parameterClass="historicoCapacitadasDetalle" >
		UPDATE EDU_HISTO_CAPAC_DETAL SET
		   EST_REGI                 =  '9',                    
   		  USU_MODI      	 		=  #auditInfo.updatedBy#,          
   		  FEC_MODI         	 		=  #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS         =  #codigoPais#										
		AND	EMCO_COD_EMPR_COME      =  #codigoEmpresa#      
		AND CCAP_COD_CURS_CAPA	    =  #codigoCurso#               
		<isNotEmpty prepend="AND" property="codigoCliente">
				CLIE_COD_CLIE         =  #codigoCliente#                
		</isNotEmpty>		
	</update>	

	<delete id="removeFisicoHistoricoCapacitadasDetalle" parameterClass="historicoCapacitadasDetalle" >
		DELETE FROM  EDU_HISTO_CAPAC_DETAL 
		WHERE PAIS_COD_PAIS         =  #codigoPais#										
		AND	  EMCO_COD_EMPR_COME    =  #codigoEmpresa#        
		AND	  CCAP_COD_CURS_CAPA	=  #codigoCurso#             
		<isNotEmpty prepend="AND" property="codigoCliente">
				CLIE_COD_CLIE         =  #codigoCliente#                
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanilla">
				COD_PLAN_PROG         =  #codigoPlanilla#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCursoDictado">
				COD_CURS_DICT         =  #codigoCursoDictado#
		</isNotEmpty>		

	</delete>	
	
	<select id="getMaxHistoricoCursoDictado" parameterClass="historicoCursoDictado" resultClass="string">
		SELECT MAX(TO_NUMBER(NVL(COD_CURS_DICT,'0')))
		FROM EDU_HISTO_CURSO_DICTA_CABEC
		WHERE PAIS_COD_PAIS       = #codigoPais#								
		AND	EMCO_COD_EMPR_COME    = #codigoEmpresa#            
		AND	CCAP_COD_CURS_CAPA    = #codigoCurso#             
	</select>

	<select id="getMaxCursoCapacitacionDetalle" parameterClass="historicoCapacitadasDetalle" resultClass="string">
		SELECT MAX(CCAP_COD_CURS_CAPA)
		FROM EDU_HISTO_CAPAC_DETAL
		WHERE PAIS_COD_PAIS      =  #codigoPais#										
		AND	EMCO_COD_EMPR_COME   =  #codigoEmpresa#                
		AND	CLIE_COD_CLIE    	 =  #codigoCliente#                
	</select>

	<update id="updateRegion" parameterClass="regionCursoCapacitacion" >
			UPDATE EDU_REGIO SET
				INST_COD_INST	  =  #codigoInstructora#,		
  		  		USU_MODI		  =  #auditInfo.updatedBy#,          
   		  		FEC_MODI          =  #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS       =  #codigoPais#										
		AND	EMCO_COD_EMPR_COME    =  #codigoEmpresa#                
		AND	COD_REGI		      =  #codigoRegion#                
	</update>

	<select id="getServicioCapacitacion" parameterClass="java.util.Map" resultClass="string">
		SELECT COD_SERV_CAPA 
		FROM edu_servi_capac
		WHERE 
				PAIS_COD_PAIS		      =  #codigoPais#										
			AND	EMCO_COD_EMPR_COME	      =  #codigoEmpresa#                
			AND	CCAP_COD_CURS_CAPA		  =  #codigoCurso#                

	</select>

	<select id="getEquivalenciaMatrizServiciosByCriteria" parameterClass="java.util.Map" resultMap="equivalenciaMatrizServicioResult">
		SELECT 
       			pais_cod_pais || '-' ||  emco_cod_empr_come || '-' || ccap_cod_curs_capa || '-' || cam_fact || '-' || cod_vent_cuv AS ID ,
       			pais_cod_pais 		AS      COD_PAIS         ,                                                                              
       			emco_cod_empr_come       AS      COD_EMP         	,	                                                                
       			ccap_cod_curs_capa       AS      COD_CURSO        ,                                                                             
				cod_prod				 AS		 COD_PROD	,	
       			cam_fact                 AS      COD_PERI         ,                                                                             
       			cod_vent_cuv             AS      COD_VENTA        ,                                                                             
       			des_prod                 AS      DES_PROD         ,                                                                             
       			val_prec                 AS      VAL_PREC         ,                                                                             
				EST_CUV					 AS 	 EST_CUV   ,		
       			usu_digi                 AS      USU_DIGI		,                                                                       
       			fec_digi                 AS      FEC_DIGI	 ,                                                                              
       			usu_modi                 AS      USU_MODI	 ,                                                                              
       			fec_modi                 AS      FEC_MODI	 ,                                                                              
       			est_regi                 AS      STA_REG ,
				CBEC_COD_CLAS			 AS 	CBEC_COD_CLAS
		FROM edu_equiv_codig_venta
		WHERE 
				PAIS_COD_PAIS		      =  #codigoPais#										
		<isNotEmpty prepend="AND" property="codigoEmpresa">           
			EMCO_COD_EMPR_COME	      =  #codigoEmpresa#                
		</isNotEmpty>           
		<isNotEmpty prepend="AND" property="codigoCurso">           
			CCAP_COD_CURS_CAPA		  =  #codigoCurso#                
		</isNotEmpty>           
		<isNotEmpty prepend="AND" property="codigoPeriodo">        
			CAM_FACT = #codigoPeriodo#                          
    	</isNotEmpty>                                            
		<isNotEmpty prepend="AND" property="codigoVenta">        
			COD_VENT_CUV = #codigoVenta#                          
    	</isNotEmpty>                                            

	</select>

    <insert id="insertEquivalenciaMatrizServicio" parameterClass="equivalenciaMatrizServicio">
                insert into edu_equiv_codig_venta
                  (pais_cod_pais, 
                   emco_cod_empr_come, 
                   ccap_cod_curs_capa, 
				   tip_curs,	
				   cbec_cod_clas,	
                   cam_fact, 
                   cod_vent_cuv, 
                   des_prod, 
                   val_prec, 
				   cod_prod ,	
				   est_cuv	, 
                   usu_digi, 
                   fec_digi, 
                   usu_modi, 
                   fec_modi, 
                   est_regi)
		VALUES(
			#codigoPais#     	,
			#codigoEmpresa#     ,	
			#codigoCurso#     ,	
			#tipoCurso#     ,	
			#codigoClasificacion#,
			#codigoPeriodo#     	,
			#codigoVenta#     	,
			#descripcionProducto# ,
		   (select to_number(#valorUnitario#, '999999999.99') from dual) ,
			#codigoProducto#     ,	
			#estadoCuv#			,
      		#auditInfo.createdBy# 	, 
      		#auditInfo.created# 		, 
      		#auditInfo.updatedBy# 	, 
      		#auditInfo.lastUpdated# ,
			#estadoRegistro#     
    	)
	</insert>

   <select id="getValidaRangoCodigoServicio" parameterClass="java.util.Map" resultClass="integer">
		SELECT EDU_PKG_PROCE_GENER.EDU_FN_VALID_RANGO_CODIG_SERVI(
 			#codigoPais#, #codigoEmpresa#, #codigoCurso#, #codigoPrograma#, #codigoServicio#)
		FROM DUAL
	</select>


   <select id="getHistoricoPlanillaProgramadas" parameterClass="java.util.Map" resultMap="baseResult">
	    SELECT DISTINCT 
			A.COD_PLAN_PROG AS CODIGO,
			A.COD_PLAN_PROG AS DESCRIPCION
		FROM  EDU_HISTO_APTAS A,
			  EDU_MAEST_CLIEN B
		WHERE   A.PAIS_COD_PAIS = #codigoPais#       	
		  AND	A.EMCO_COD_EMPR_COME = #codigoEmpresa#     
		  AND	A.CCAP_COD_CURS_CAPA = #codigoCurso#  
		  AND   A.EST_CAPA = #estadoCapacitacion#	
		  AND   B.COD_CLIE  = A.CLIE_COD_CLIE
		  AND   B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		  AND   B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		  AND	A.EST_REGI != '9'  	
		  AND   A.COD_PLAN_PROG IS NOT NULL
		  AND   A.ULT_CAMP_PROG_DICT >= #campanhaInicial#       	
		<isNotEmpty prepend="AND" property="campanhaFinal">
	<![CDATA[
				A.ULT_CAMP_PROG_DICT <= #campanhaFinal#       	
	 ]]>
		</isNotEmpty>	
		<isNotEmpty prepend="AND" property="codigoCliente">
				A.CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>	
		<isNotEmpty  property="codigoRegion">
		   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
				(B.COD_REGI =  #codigoRegion[]#)      	 		
    	   </iterate>		
		</isNotEmpty>
 	   ORDER BY
			TO_NUMBER(A.COD_PLAN_PROG)
  </select>                                                          	

   <select id="getHistoricoPlanillaCapacitadas" parameterClass="java.util.Map" resultMap="baseResult">
	    SELECT DISTINCT 
			A.COD_PLAN_PROG AS CODIGO,
			A.COD_PLAN_PROG AS DESCRIPCION
		FROM  EDU_HISTO_CAPAC_DETAL A,
				EDU_MAEST_CLIEN B
		WHERE   A.PAIS_COD_PAIS = #codigoPais#       	
		  AND	A.EMCO_COD_EMPR_COME = #codigoEmpresa#     
		  AND	A.CCAP_COD_CURS_CAPA = #codigoCurso#  
		  AND   A.COD_CURS_DICT = #codigoDictado#  	
		  AND	A.EST_REGI != '9'  	
		  AND   B.COD_CLIE  = A.CLIE_COD_CLIE
		  AND   B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		  AND   B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		  AND   A.COD_PLAN_PROG IS NOT NULL
		  AND   A.CAM_CAPA >= #campanhaInicial#       	
		<isNotEmpty prepend="AND" property="campanhaFinal">
	<![CDATA[
				A.CAM_CAPA <= #campanhaFinal#       	
	 ]]>
		</isNotEmpty>	
		<isNotEmpty prepend="AND" property="codigoCliente">
				A.CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>	
		<isNotEmpty prepend="AND" property="codigoInstructora">
				A.INST_COD_INST = #codigoInstructora#       	
		</isNotEmpty>	
		<isNotEmpty  property="codigoRegion">
		   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
				(B.COD_REGI =  #codigoRegion[]#)      	 		
    	   </iterate>		
		</isNotEmpty>
 	   ORDER BY
			TO_NUMBER(A.COD_PLAN_PROG)
  </select>                                                          	

   <select id="getHistoricoCursoDictadoCapacitadas" parameterClass="java.util.Map" resultMap="baseResult">
	    SELECT DISTINCT 
			A.COD_CURS_DICT AS CODIGO,
			A.COD_CURS_DICT || ' - ' || TO_CHAR(B.FEC_INIC_CURS, 'DD/MM/YYYY') AS DESCRIPCION
		FROM  EDU_HISTO_CAPAC_DETAL A,
			  EDU_HISTO_CURSO_DICTA_CABEC B,
			  EDU_MAEST_CLIEN C
		WHERE   A.PAIS_COD_PAIS = #codigoPais#       	
		  AND	A.EMCO_COD_EMPR_COME = #codigoEmpresa#     
		  AND	A.CCAP_COD_CURS_CAPA = #codigoCurso#  
		  AND	A.EST_REGI != '9'  	
		  AND   A.COD_PLAN_PROG IS NOT NULL
		  AND   B.PAIS_COD_PAIS	= A.PAIS_COD_PAIS
		  AND   B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		  AND   B.CCAP_COD_CURS_CAPA = A.CCAP_COD_CURS_CAPA
		  AND   B.COD_CURS_DICT = A.COD_CURS_DICT
		  AND   C.COD_CLIE  = A.CLIE_COD_CLIE
		  AND   C.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		  AND   C.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		<isNotEmpty prepend="AND" property="campanhaFinal">
	<![CDATA[
				A.CAM_CAPA <= #campanhaFinal#       	
	 ]]>
		</isNotEmpty>	

		<isNotEmpty prepend="AND" property="campanhaFinal">
		<![CDATA[		
			B.CAM_INIC_CURS <= #campanhaFinal#       	
        ]]> 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaInicial">
				B.CAM_INIC_CURS >= #campanhaInicial#       	
		</isNotEmpty>		

		<isNotEmpty prepend="AND" property="codigoCliente">
				A.CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>	
		<isNotEmpty prepend="AND" property="codigoInstructora">
				A.INST_COD_INST = #codigoInstructora#       	
		</isNotEmpty>	
		<isNotEmpty  property="codigoRegion">
		   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
				(C.COD_REGI =  #codigoRegion[]#)      	 		
    	   </iterate>		
		</isNotEmpty>

 	   ORDER BY
			TO_NUMBER(A.COD_CURS_DICT)
  </select>                                                          	

	<update id="updateHistoricoPlanillaInstructora" parameterClass="historicoPlanillaInstructora" >
		UPDATE EDU_HISTO_PLANI_INSTR SET
				INST_COD_INST  	  =  #codigoInstructora#,		
				CDIC_COD_CURS_DICT=  #codigoCursoDictado#,		
				SIT_PLAN_PROG	  =  #situacionPlanilla#,			
  		  		USU_MODI		  =  #auditInfo.updatedBy#,          
   		  		FEC_MODI          =  #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS       =  #codigoPais#										
		AND	  EMCO_COD_EMPR_COME  =  #codigoEmpresa#                
		AND	  EST_REGI 			  != '9'
		<isNotEmpty prepend="AND" property="codigoCurso">
			CCAP_COD_CURS_CAPA	  =#codigoCurso#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanilla">
			COD_PLAN_PROG		  =#codigoPlanilla#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoInstructora">
			INST_COD_INST		  =#codigoInstructora#
		</isNotEmpty>		
	</update>

	<update id="updatePlanillaInstructoraByRegion" parameterClass="historicoPlanillaInstructora" >
		UPDATE EDU_HISTO_PLANI_INSTR SET
				INST_COD_INST  	  =  #codigoInstructora#,		
  		  		USU_MODI		  =  #auditInfo.updatedBy#,          
   		  		FEC_MODI          =  #auditInfo.lastUpdated#             
		WHERE PAIS_COD_PAIS       =  #codigoPais#										
		AND	  EMCO_COD_EMPR_COME  =  #codigoEmpresa#                
		AND   REGI_COD_REGI		  =  #codigoRegion#
		AND	  EST_REGI 			  != '9'
		AND   SIT_PLAN_PROG		   = 'A'
	</update>

	<select id="getHistoricoPlanillaInstructora" parameterClass="historicoPlanillaInstructora" resultMap="historicoPlanillaInstructoraResult">
	
		SELECT 
  			A.PAIS_COD_PAIS      ,
			A.EMCO_COD_EMPR_COME ,
  			A.CCAP_COD_CURS_CAPA ,
  			A.COD_PLAN_PROG      ,
  			A.REGI_COD_REGI      ,
  			A.INST_COD_INST      ,
  			A.CDIC_COD_CURS_DICT ,
  			A.SIT_PLAN_PROG      ,
  			A.EST_REGI           
		FROM EDU_HISTO_PLANI_INSTR A , EDU_CONTR_GENER_PLANI B 
		WHERE 
		  A.PAIS_COD_PAIS=B.PAIS_COD_PAIS
		  AND A.EMCO_COD_EMPR_COME=B.EMCO_COD_EMPR_COME
		  AND A.CCAP_COD_CURS_CAPA=B.CCAP_COD_CURS_CAPA
		  AND A.REGI_COD_REGI=B.REGI_COD_REGI
		  AND A.PAIS_COD_PAIS       =  #codigoPais#										
		  AND A.EMCO_COD_EMPR_COME  =  #codigoEmpresa#                
 		  AND A.EST_REGI  != '9'
		<isNotEmpty prepend="AND" property="situacionPlanilla">
			A.SIT_PLAN_PROG		  =#situacionPlanilla#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
			A.CCAP_COD_CURS_CAPA	  =#codigoCurso#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanilla">
			A.COD_PLAN_PROG		  =#codigoPlanilla#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoRegion">
			A.REGI_COD_REGI		  =#codigoRegion#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoInstructora">
			A.INST_COD_INST		  =#codigoInstructora#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCursoDictado">
			A.CDIC_COD_CURS_DICT	  =#codigoCursoDictado#
		</isNotEmpty>		
    	<isNotEmpty prepend="AND" property="campanhaInicio">
			B.PERI_COD_PERI	  =#campanhaInicio#
		</isNotEmpty>		
		<![CDATA[
		AND TO_NUMBER(B.COD_PLAN_PROG_INIC)<=TO_NUMBER(A.COD_PLAN_PROG)
		]]>
		<![CDATA[
		AND TO_NUMBER(B.COD_PLAN_PROG_FINA)>=TO_NUMBER(A.COD_PLAN_PROG)
		]]>
		ORDER BY TO_NUMBER(COD_PLAN_PROG) ASC
	</select>


	<select id="verificarCampannaRegistroAsistencia" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1)
		  FROM EDU_HISTO_APTAS
		WHERE PAIS_COD_PAIS       =  #codigoPais#										
		AND	  EMCO_COD_EMPR_COME  =  #codigoEmpresa#                
		AND	  CCAP_COD_CURS_CAPA  =  #codigoCurso#
		AND	  CLIE_COD_CLIE		  =  #codigoCliente#
		<![CDATA[
		AND   ULT_CAMP_PROG_DICT  >=  #codigoCampanha#
		]]>
	
	</select>


	<select id="getSituacionActualHistoricoAptas" parameterClass="historicoAptas" resultMap="situacionHistoricoAptasResult">
	  SELECT 
				A.PAIS_COD_PAIS,      
				A.EMCO_COD_EMPR_COME, 
				B.DES_EMPR_COME,      
				A.CCAP_COD_CURS_CAPA, 
				C.NOM_CURS_CAPA,      
				A.CLIE_COD_CLIE,      
				A.COD_CURS_DICT,      
				A.COD_PLAN_PROG,      
				A.CAM_PRIM_CALI_APTA, 
				A.CAM_ULTI_CALI_APTA, 
				A.TIP_CALI_APTA,      
				A.NUM_INVI,           
				A.IND_INIC_CALI_APTA, 
				A.IND_FINA_CALI_APTA, 
				A.IND_CURS_COST,      
				A.IND_CURS_FACT,      
				A.CAM_FACT_CURS,      
				A.ULT_CAMP_PROG_DICT, 
				A.EST_CAPA,           
				A.CAM_CAPA,       
				A.EST_REGI,
		        A.CAM_ACEP,
      			CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           			 NVL(D.PRI_NOMB,'') || ' ' || NVL(D.SEG_NOMB,'') ||' '|| NVL(D.APE_PATE,' ')||' '||NVL(D.APE_MATE,' ' )
      			ELSE
          			 NVL(D.APE_NOMB_COMP,'')     
      			END AS DES_CLIENTE ,    
				D.APE_PATE,
				D.APE_MATE,
				D.PRI_NOMB,
				D.SEG_NOMB,
				DECODE(A.EST_CAPA,'CP','SI','NO') AS ASISTENCIA,
                D.COD_REGI,
				D.COD_ZONA,
				D.CAM_INGR_COME,
				C.PRE_REQU_CAPA,
				NVL((SELECT X.SIG_CURS_CAPA
	  	     	 FROM EDU_PARAM_CURSO_CAPAC x
			     WHERE X.PAIS_COD_PAIS =  #codigoPais#  
			 	   AND X.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
				   AND X.COD_CURS_CAPA = c.PRE_REQU_CAPA),'') AS SIG_CURS_CAPA,
				A.CAM_REGU,
				D.STA_CLIE,
				NVL((SELECT E.DES_ESTA_CAPA
					FROM EDU_ESTAD_CAPAC E
					WHERE E.COD_ESTA_CAPA=A.EST_CAPA
 					AND E.EST_REGI='1'),'') AS EST_CAPA_DESC
		FROM 	EDU_HISTO_APTAS A,
				EDU_EMPRE_COMER B,
				EDU_PARAM_CURSO_CAPAC C,
				EDU_MAEST_CLIEN	D,
		        EDU_PARAM_PROGR_CAPAC PPC								 
		WHERE   B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		B.COD_EMPR_COME = A.EMCO_COD_EMPR_COME

    	AND   	PPC.PAIS_COD_PAIS = A.PAIS_COD_PAIS
    	AND   	PPC.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
    	AND   	PPC.COD_PROG_CAPA = '01'

		AND		A.EST_REGI !='9'
		AND		A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
		AND	    A.EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME		
		AND		A.CCAP_COD_CURS_CAPA = C.COD_CURS_CAPA
		AND		D.PAIS_COD_PAIS = A.PAIS_COD_PAIS
		AND		D.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
		AND		D.COD_CLIE		= A.CLIE_COD_CLIE
		<isNotEmpty prepend="AND" property="codigoPais">
					A.PAIS_COD_PAIS = #codigoPais#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoEmpresa">
					A.EMCO_COD_EMPR_COME = #codigoEmpresa#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
					A.CCAP_COD_CURS_CAPA = #codigoCurso#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCliente">
					A.CLIE_COD_CLIE = #codigoCliente#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanillaProgramacion">
					A.COD_PLAN_PROG = #codigoPlanillaProgramacion#       	
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="estadoCapacitacion">
					A.EST_CAPA = #estadoCapacitacion#       	
		</isNotEmpty>		
			
		ORDER BY A.CCAP_COD_CURS_CAPA DESC
		
  </select>                                                          	    		    		

	<resultMap id="statusAptaConsultoraResult" class="java.util.HashMap">
		<result property="codigoCliente"					  column ="CLIE_COD_CLIE"/>		                     			
		<result property="codigoCurso"						  column ="CCAP_COD_CURS_CAPA"/>		                     			
		<result property="nombreCurso"						  column ="NOM_CURS_CAPA"/>		                     			
		<result property="campanhaPrimeraCalificacionApta"    column = "CAM_PRIM_CALI_APTA"/> 
		<result property="campanhaUltimaCalificacionApta"     column = "CAM_ULTI_CALI_APTA"/> 
		<result property="numInvitacion"					  column ="NUM_INVI"/>		                     			
		<result property="tipoCalificacion"					  column ="TIP_CALI_APTA"/>		                     			
		<result property="tipoCurso"					  column ="IND_CURS_COST"/>		                     			               			
	</resultMap>

  <select id="getListStatusAptaConsultora" parameterClass="java.util.Map" resultMap="statusAptaConsultoraResult">
			       SELECT A.CLIE_COD_CLIE,
				        A.CCAP_COD_CURS_CAPA,
						B.NOM_CURS_CAPA,
						A.CAM_PRIM_CALI_APTA,
						A.CAM_ULTI_CALI_APTA,
				        A.NUM_INVI,
						A.TIP_CALI_APTA,
						A.IND_CURS_COST
				    FROM EDU_HISTO_CALIF_APTAS A,EDU_PARAM_CURSO_CAPAC B 
				    WHERE A.PAIS_COD_PAIS = #codigoPais#    
				    AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
				    AND A.EST_CAPA = 'PC'
					<isNotEmpty prepend="AND" property="codigoCliente">
					   A.CLIE_COD_CLIE=#codigoCliente#
					</isNotEmpty>							
				      AND A.EST_REGI = '1'
					  AND B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
					  AND B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
					  AND B.COD_CURS_CAPA = A.CCAP_COD_CURS_CAPA
				 ORDER BY A.CCAP_COD_CURS_CAPA,A.CAM_ULTI_CALI_APTA ASC  
  </select>                                                          	    		    		  


 	<resultMap id="statusProgrConsultoraResult" class="java.util.HashMap">
		<result property="codigoCliente"					  column ="CLIE_COD_CLIE"/>		                     			
		<result property="codigoCurso"						  column ="CCAP_COD_CURS_CAPA"/>		                     			
		<result property="nombreCurso"						  column ="NOM_CURS_CAPA"/>		                     			
		<result property="codigoPeriodo"					  column ="CAM_PROC"/>		                   
		<result property="codigoPlanilla"					  column ="COD_PLAN_PROG"/>		                     			  			
		<result property="nombreInstructora"				  column ="NOM_INST"/>		           
	</resultMap>

 <select id="getListStatusProgrConsultora" parameterClass="java.util.Map" resultMap="statusProgrConsultoraResult">
				 SELECT A.CLIE_COD_CLIE,
				        A.CCAP_COD_CURS_CAPA,
						B.NOM_CURS_CAPA,
						A.CAM_PROC,
						A.COD_PLAN_PROG,
						(SELECT C.INST_COD_INST || ' - ' || EDU_PKG_PROCE_GENER.EDU_FN_DEVUE_NOMBR_INSTR(A.PAIS_COD_PAIS,A.EMCO_COD_EMPR_COME,C.INST_COD_INST)
						  FROM EDU_HISTO_PLANI_INSTR C
						  WHERE C.PAIS_COD_PAIS = #codigoPais#
						  		AND C.EMCO_COD_EMPR_COME = #codigoEmpresa#
								AND C.COD_PLAN_PROG = A.COD_PLAN_PROG
								AND C.CCAP_COD_CURS_CAPA = A.CCAP_COD_CURS_CAPA) AS NOM_INST	
					FROM EDU_PLANI_PROGR_CURSO A,EDU_PARAM_CURSO_CAPAC B
				    WHERE A.PAIS_COD_PAIS = #codigoPais#
				    AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
				      AND A.EST_REGI = '1'
					<isNotEmpty prepend="AND" property="codigoCliente">
					   A.CLIE_COD_CLIE=#codigoCliente#
					</isNotEmpty>	
					  AND B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
					  AND B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
					  AND B.COD_CURS_CAPA = A.CCAP_COD_CURS_CAPA
				ORDER BY A.CCAP_COD_CURS_CAPA,A.CAM_PROC ASC
  </select>          


 	<resultMap id="statusCapacConsultoraResult" class="java.util.HashMap">
		<result property="codigoCliente"					  column ="CLIE_COD_CLIE"/>		                     			
		<result property="codigoCurso"						  column ="CCAP_COD_CURS_CAPA"/>		                     			
		<result property="nombreCurso"						  column ="NOM_CURS_CAPA"/>		                     			
		<result property="codigoPeriodo"					  column ="CAM_CAPA"/>		                   
		<result property="fechaInicioCurso"					  column ="FEC_INIC_CURS"/>		                     			  			
		<result property="cursoDictado"					 	  column ="COD_CURS_DICT"/>		
		<result property="asistenciaCurso"					  column ="TASI_COD_TIPO_ASIS_CURS"/>		                     			  			
		<result property="descripcionLocal"					  column ="DES_LOCA"/>		           
   		<result property="campanhaRegularizacion"			  column ="CAM_REGU"/>		   
   		<result property="asistenciaCursoDescripcion"		  column ="TIPO_ASIS_CURS_DESC"/>
	</resultMap>

 <select id="getListStatusCapacConsultora" parameterClass="java.util.Map" resultMap="statusCapacConsultoraResult">
			   SELECT 
			        A.CLIE_COD_CLIE,
			        A.CCAP_COD_CURS_CAPA,
					B.NOM_CURS_CAPA,
					A.CAM_CAPA,
					TO_CHAR(C.FEC_INIC_CURS,'dd/MM/yyyy') AS FEC_INIC_CURS,
					A.COD_CURS_DICT,
					A.TASI_COD_TIPO_ASIS_CURS,
					EDU_PKG_PROCE_GENER.EDU_FN_DEVUE_DESCR_LOCAL(A.PAIS_COD_PAIS,A.EMCO_COD_EMPR_COME,C.LOCA_COD_LOCA) AS DES_LOCA,
					A.CAM_REGU,
					NVL(( SELECT X.DES_TIPO_ASIS_CURS
 						  FROM EDU_TIPO_ASIST_CURSO X
 						  WHERE X.COD_TIPO_ASIS_CURS=A.TASI_COD_TIPO_ASIS_CURS
  						  AND X.EST_REGI='1'),'') AS TIPO_ASIS_CURS_DESC		 
			    FROM EDU_HISTO_CAPAC_DETAL A,EDU_PARAM_CURSO_CAPAC B, 
					 EDU_HISTO_CURSO_DICTA_CABEC C		          
			    WHERE A.PAIS_COD_PAIS =  #codigoPais#
			      AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			      AND A.EST_REGI = '1'
				<isNotEmpty prepend="AND" property="codigoCliente">
					   A.CLIE_COD_CLIE=#codigoCliente#
				</isNotEmpty>	
				  AND B.PAIS_COD_PAIS = A.PAIS_COD_PAIS
				  AND B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
				  AND B.COD_CURS_CAPA = A.CCAP_COD_CURS_CAPA
				  AND C.PAIS_COD_PAIS = A.PAIS_COD_PAIS
				  AND C.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
				  AND C.CCAP_COD_CURS_CAPA = A.CCAP_COD_CURS_CAPA
				  AND C.CAM_INIC_CURS = A.CAM_CAPA
				  AND A.COD_CURS_DICT = C.COD_CURS_DICT
			   ORDER BY A.CCAP_COD_CURS_CAPA,A.CAM_CAPA ASC

 </select>          


 	<resultMap id="statusBenefConsultoraResult" class="java.util.HashMap">
		<result property="codigoCliente"					   column ="CLIE_COD_CLIE"/>		                     			
		<result property="codigoCurso"						   column ="NIV_CAPA_ALCA"/>		                     			                   			
		<result property="nombreCurso"						   column ="NOM_CURS_CAPA"/>		
		<result property="codigoPeriodo"					   column ="CAM_PROC"/>		                   
		<result property="codigoClasificacion"				   column ="COD_CLAS"/>		                     			  			
		<result property="nombreClasificacion"				   column ="NOM_CLAS"/>		           
		<result property="indicadorDespacho"				   column ="IND_DESP_CLAS"/>		           
        <result property="indicadorEnvio"				       column ="IND_ENVI"/>	
		<result property="numeroDespacho"				   	   column ="NUM_DESP"/>	
		<result property="tipoEnvio"				   	   	   column ="TIP_ENVI_CLAS"/>	
	</resultMap>

 <select id="getListStatusBenefConsultora" parameterClass="java.util.Map" resultMap="statusBenefConsultoraResult">
		    SELECT 
			  BD.CLIE_COD_CLIE,
			  DP.NIV_CAPA_ALCA  ,
			  B.NOM_CURS_CAPA,
			  CA.CAM_PROC,
	          DP.COD_CLAS  ,
	          DP.NOM_CLAS  ,
			  NVL(BD.IND_DESP_CLAS,'0') AS IND_DESP_CLAS,
			  BD.IND_ENVI,	
			  BD.NUM_DESP,
			  BD.TIP_ENVI_CLAS
	        FROM EDU_PARAM_CLASI_BENEF_CAPAC DP,EDU_HISTO_CLASI_BENEF_CABEC CA,
				 EDU_HISTO_CLASI_BENEF_DETAL BD, EDU_PARAM_CURSO_CAPAC B 
	        WHERE DP.PAIS_COD_PAIS = #codigoPais# 
				AND DP.EMCO_COD_EMPR_COME = #codigoEmpresa# 
	            AND DP.TIP_CLAS = 'B' 
				<isNotEmpty prepend="AND" property="codigoCliente">
					   BD.CLIE_COD_CLIE=#codigoCliente#
				</isNotEmpty>	
	            AND CA.PAIS_COD_PAIS = DP.PAIS_COD_PAIS 
	            AND CA.EMCO_COD_EMPR_COME = DP.EMCO_COD_EMPR_COME 
	            AND CA.CLAS_COD_CLAS = DP.COD_CLAS 
				AND DP.PAIS_COD_PAIS =BD.PAIS_COD_PAIS 
				AND DP.EMCO_COD_EMPR_COME = BD.EMCO_COD_EMPR_COME
				AND DP.NIV_CAPA_ALCA = BD.NIV_CAPA_ALCA 
				AND DP.COD_CLAS = BD.CLAS_COD_CLAS 
				AND CA.CAM_PROC = BD.HBEC_CAM_PROC 
			    AND B.PAIS_COD_PAIS =DP.PAIS_COD_PAIS
				AND B.EMCO_COD_EMPR_COME =DP.EMCO_COD_EMPR_COME
				AND B.COD_CURS_CAPA =DP.NIV_CAPA_ALCA
		   ORDER BY DP.NIV_CAPA_ALCA,CA.CAM_PROC ASC		  
 </select>          

 <select id="getNivelesxAlcanzar" parameterClass="java.util.Map" resultClass="java.lang.String">
		   	 	SELECT  A.COD_CURS_CAPA|| ' - ' ||A.NOM_CURS_CAPA AS NIVEL
				FROM EDU_PARAM_CURSO_CAPAC A
				WHERE A.PAIS_COD_PAIS = #codigoPais# 
					 AND A.EMCO_COD_EMPR_COME =  #codigoEmpresa# 
					 AND A.PRE_REQU_CAPA =  #codigoCurso# 
 </select>      

 	<select id="getConsultaCursoCapacitacionNoAptas" parameterClass="java.util.Map" resultMap="consultaCursoCapacitacionResult">
		SELECT
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
			A.DES_EMPR_COME      ,
			B.COD_CURS_CAPA      ,    
			B.NOM_CURS_CAPA      ,    
			B.SIG_CURS_CAPA      ,
			J.COD_CLIE			 ,
			NVL(J.APE_PATE,'') AS APE_PATE_CLIE,           
			NVL(J.APE_MATE,'') AS APE_MATE_CLIE,           
			NVL(J.PRI_NOMB,'') AS PRI_NOMB_CLIE,           
			NVL(J.SEG_NOMB,'') AS SEG_NOMB_CLIE,           
      		CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           		NVL(J.PRI_NOMB,'') || ' ' || NVL(J.SEG_NOMB,'') ||' '|| NVL(J.APE_PATE,' ')||' '||NVL(J.APE_MATE,' ' )
      		ELSE
          		NVL(J.APE_NOMB_COMP,'')     
      		END AS DES_CLIENTE ,    
			'' AS COD_INST			,	
			'' AS APE_PATE_INST,           
			'' AS APE_MATE_INST,           
			'' AS PRI_NOMB_INST,           
			'' AS SEG_NOMB_INST,     
			'' AS COD_PLAN_PROG	,      
			L.CAM_PRIM_CALI_APTA ,    
			L.CAM_ULTI_CALI_APTA ,
			L.NUM_INVI			 ,
			L.IND_CURS_COST AS IND_COST_CURS      , 
			L.IND_CURS_FACT		 ,
			L.CAM_FACT_CURS		 ,
			L.CAM_ACEP			 ,
			L.ULT_CAMP_PROG_DICT ,
			'' AS CAM_CAPA,
			'' AS COD_CURS_DICT,
			J.COD_REGI,
			J.COD_ZONA,
            'PC' AS EST_CAPA,
			J.NUM_TELE_PART,
			J.NUM_CELU,
			J.CAM_INGR_COME,
			J.STA_CLIE,
			L.TIP_CALI_APTA
		FROM EDU_EMPRE_COMER A,
			 EDU_PARAM_CURSO_CAPAC B,
			 EDU_MAEST_CLIEN J,
			 EDU_HISTO_CALIF_APTAS L,
       		 EDU_PARAM_PROGR_CAPAC PPC
		WHERE B.PAIS_COD_PAIS       = #codigoPais#
		AND   A.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND   A.COD_EMPR_COME	  = B.EMCO_COD_EMPR_COME

    	AND   PPC.PAIS_COD_PAIS 	 = B.PAIS_COD_PAIS
    	AND   PPC.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
    	AND   PPC.COD_PROG_CAPA 	 = '01'

		AND	  L.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND	  L.EMCO_COD_EMPR_COME= B.EMCO_COD_EMPR_COME
		AND	  L.CCAP_COD_CURS_CAPA= B.COD_CURS_CAPA
		AND	  L.EST_REGI		 !='9'

		AND	  J.PAIS_COD_PAIS	  = L.PAIS_COD_PAIS
		AND	  J.EMCO_COD_EMPR_COME= L.EMCO_COD_EMPR_COME
		AND	  J.COD_CLIE		  = L.CLIE_COD_CLIE
		<![CDATA[
	    AND L.NUM_INVI = 0
		]]>
		<isNotEmpty prepend="AND" property="estadoCapacitacion">
			L.EST_CAPA 		  = #estadoCapacitacion#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="codigoEmpresa">
			B.EMCO_COD_EMPR_COME  = #codigoEmpresa#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="codigoCliente">
		    L.CLIE_COD_CLIE	    = #codigoCliente# 
		</isNotEmpty>
		
		<isNotEmpty prepend="AND" property="codigoCurso">
		    B.COD_CURS_CAPA	= #codigoCurso# 
		</isNotEmpty>
		
		<isNotEmpty prepend="AND" property="campanhaInicial">
			<![CDATA[
			    L.CAM_PRIM_CALI_APTA >= #campanhaInicial# 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaFinal">
			<![CDATA[
			    L.CAM_ULTI_CALI_APTA <= #campanhaFinal# 
			]]>
		</isNotEmpty>
		<isNotEmpty  property="codigoRegion">
	   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
			(J.COD_REGI =  #codigoRegion[]#)      	 		
       </iterate>		
		</isNotEmpty>	
		<isNotEmpty  property="codigoZona">
	   <iterate prepend="AND" property="codigoZona" open="(" close=")" conjunction="OR">
			(J.COD_REGI||J.COD_ZONA =  #codigoZona[]#)      	 		
       </iterate>		
		</isNotEmpty>	
	   <isNotEmpty prepend="AND" property="status">
		    J.STA_CLIE  = #status# 
		</isNotEmpty>
		ORDER BY
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
		    B.COD_CURS_CAPA      ,
			DES_CLIENTE
	</select>

	<select id="getSituaciones" parameterClass="java.util.Map" resultMap="baseResult">
	      select cod_esta_capa AS CODIGO,
		  		 des_esta_capa AS DESCRIPCION 
		  from  EDU_ESTAD_CAPAC
		  where est_regi = 1
		    and ind_esta_capa = 1
  	</select>

	<select id="getConsultaCursoCapacitacionPendientes" parameterClass="java.util.Map" resultMap="consultaCursoCapacitacionResult">
		SELECT
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
			A.DES_EMPR_COME      ,
			B.COD_CURS_CAPA      ,    
			B.NOM_CURS_CAPA      ,    
			B.SIG_CURS_CAPA      ,
			J.COD_CLIE			 ,
			NVL(J.APE_PATE,'') AS APE_PATE_CLIE,           
			NVL(J.APE_MATE,'') AS APE_MATE_CLIE,           
			NVL(J.PRI_NOMB,'') AS PRI_NOMB_CLIE,           
			NVL(J.SEG_NOMB,'') AS SEG_NOMB_CLIE,           
      		CASE WHEN PPC.IND_NOMB_COMP = 'N' THEN
           		NVL(J.PRI_NOMB,'') || ' ' || NVL(J.SEG_NOMB,'') ||' '|| NVL(J.APE_PATE,' ')||' '||NVL(J.APE_MATE,' ' )
      		ELSE
          		NVL(J.APE_NOMB_COMP,'')     
      		END AS DES_CLIENTE ,    
			'' AS COD_INST			,	
			'' AS APE_PATE_INST,           
			'' AS APE_MATE_INST,           
			'' AS PRI_NOMB_INST,           
			'' AS SEG_NOMB_INST,     
			'' AS COD_PLAN_PROG	,      
			L.CAM_PRIM_CALI_APTA ,    
			L.CAM_ULTI_CALI_APTA ,
			L.NUM_INVI			 ,
			L.IND_CURS_COST AS IND_COST_CURS      , 
			L.IND_CURS_FACT		 ,
			L.CAM_FACT_CURS		 ,
			L.CAM_ACEP			 ,
			L.ULT_CAMP_PROG_DICT ,
			'' AS CAM_CAPA,
			'' AS COD_CURS_DICT,
			J.COD_REGI,
			J.COD_ZONA,
            #estadoCapacitacion# AS EST_CAPA,
			J.NUM_TELE_PART,
			J.NUM_CELU,
			J.CAM_INGR_COME,
			J.STA_CLIE,
			L.TIP_CALI_APTA
		FROM EDU_EMPRE_COMER A,
			 EDU_PARAM_CURSO_CAPAC B,
			 EDU_MAEST_CLIEN J,
			 EDU_HISTO_APTAS L,
       		 EDU_PARAM_PROGR_CAPAC PPC
		WHERE B.PAIS_COD_PAIS       = #codigoPais#
		AND   A.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND   A.COD_EMPR_COME	  = B.EMCO_COD_EMPR_COME

    	AND   PPC.PAIS_COD_PAIS 	 = B.PAIS_COD_PAIS
    	AND   PPC.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
    	AND   PPC.COD_PROG_CAPA 	 = '01'

		AND	  L.PAIS_COD_PAIS	  = B.PAIS_COD_PAIS
		AND	  L.EMCO_COD_EMPR_COME= B.EMCO_COD_EMPR_COME
		AND	  L.CCAP_COD_CURS_CAPA= B.COD_CURS_CAPA
		AND	  L.EST_REGI		 !='9'

		AND	  J.PAIS_COD_PAIS	  = L.PAIS_COD_PAIS
		AND	  J.EMCO_COD_EMPR_COME= L.EMCO_COD_EMPR_COME
		AND	  J.COD_CLIE		  = L.CLIE_COD_CLIE
		<![CDATA[
	    AND L.NUM_INVI > 0
		]]>
		<isNotEmpty prepend="AND" property="estadoCapacitacion">
			L.EST_CAPA 		  = #estadoCapacitacion#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="codigoEmpresa">
			B.EMCO_COD_EMPR_COME  = #codigoEmpresa#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCurso">
		    B.COD_CURS_CAPA	= #codigoCurso# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoCliente">
		    L.CLIE_COD_CLIE	    = #codigoCliente# 
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaInicial">
			<![CDATA[
			    L.CAM_PRIM_CALI_APTA >= #campanhaInicial# 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaFinal">
			<![CDATA[
			    L.CAM_ULTI_CALI_APTA <= #campanhaFinal# 
			]]>
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="campanhaIngreso">
		    J.CAM_INGR_COME  = #campanhaIngreso# 
		</isNotEmpty>	
		<isNotEmpty prepend="AND" property="tipo">
			L.TIP_CALI_APTA  = #tipo# 
		</isNotEmpty>	
		<isNotEmpty  property="codigoRegion">
	   <iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
			(J.COD_REGI =  #codigoRegion[]#)      	 		
       </iterate>		
		</isNotEmpty>	
		<isNotEmpty  property="codigoZona">
	   <iterate prepend="AND" property="codigoZona" open="(" close=")" conjunction="OR">
			(J.COD_REGI||J.COD_ZONA =  #codigoZona[]#)      	 		
       </iterate>		
		</isNotEmpty>	
	   <isNotEmpty prepend="AND" property="status">
		    J.STA_CLIE  = #status# 
		</isNotEmpty>
		ORDER BY
			B.PAIS_COD_PAIS      ,		
			B.EMCO_COD_EMPR_COME ,    
		    B.COD_CURS_CAPA      ,
			DES_CLIENTE
	</select>


<select id="getSituacionActualExoneradoHistoricoAptas" parameterClass="historicoAptas" resultMap="situacionHistoricoAptasExoneracionResult">
 		select  A.PAIS_COD_PAIS,
		        A.EMCO_COD_EMPR_COME,
		     	A.COD_CURS_CAPA,
	            A.NOM_CURS_CAPA,
    	        A.PRE_REQU_CAPA,                                                                                                                       
        		 NVL ((SELECT x.sig_curs_capa                                                                                                            
                 FROM edu_param_curso_capac x                                                                                                        
                WHERE x.pais_cod_pais = A.PAIS_COD_PAIS                                                                                              
                  AND x.emco_cod_empr_come = A.EMCO_COD_EMPR_COME                                                                                    
                  AND x.cod_curs_capa = a.pre_requ_capa),'') AS sig_curs_capa,                                                                       
		        DECODE(A.STA_CLIE, 'S', 'SI', 'N', 'NO') as PRI_PEDI,                                                                     
		       (SELECT DES_SECU_PEDI
        		  FROM EDU_SECUE_PEDID
		         WHERE COD_SECU_PEDI = (SELECT SEPE_COD_SECU_PEDI
        		                          FROM EDU_PARAM_CURSO_CAPAC
                		                 WHERE PAIS_COD_PAIS = A.PAIS_COD_PAIS
                        		           AND EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME
                                		   AND COD_CURS_CAPA = A.COD_CURS_CAPA)) AS SEC_PEDI,
        	    B.EST_CAPA,
            	B.CLIE_COD_CLIE, 
             	A.IND_EXON_ASIS
		 FROM EDU_PARAM_CURSO_CAPAC A,
          EDU_HISTO_APTAS B
         where	A.PAIS_COD_PAIS = #codigoPais#    AND
         				A.EMCO_COD_EMPR_COME = #codigoEmpresa#  AND
                B.PAIS_COD_PAIS = A.PAIS_COD_PAIS AND
                B.EMCO_COD_EMPR_COME = A.EMCO_COD_EMPR_COME AND
                B.CCAP_COD_CURS_CAPA = COD_CURS_CAPA AND
                B.CLIE_COD_CLIE = #codigoCliente# 
				<isNotEmpty  property="cursos">
				   <iterate prepend="AND NOT" property="cursos" open="(" close=")" conjunction="OR">
						A.COD_CURS_CAPA = #cursos[]#      	 		
	    		   </iterate>		
				</isNotEmpty>   
    union
    
    SELECT C.PAIS_COD_PAIS,
           C.EMCO_COD_EMPR_COME,
           C.COD_CURS_CAPA AS COD_CURSO,
           C.NOM_CURS_CAPA,
           C.Pre_Requ_Capa,                                                                                                                          
            NVL ((SELECT x.sig_curs_capa                                                                                                             
                 FROM edu_param_curso_capac x                                                                                                        
                WHERE x.pais_cod_pais = C.PAIS_COD_PAIS                                                                                              
                  AND x.emco_cod_empr_come = C.EMCO_COD_EMPR_COME                                                                                    
                  AND x.cod_curs_capa = c.pre_requ_capa),'') AS sig_curs_capa,                                                                       
           DECODE(C.STA_CLIE, 'S', 'SI', 'N', 'NO') as PRI_PEDI,                                                                      
		       (SELECT DES_SECU_PEDI
        		  FROM EDU_SECUE_PEDID
		         WHERE COD_SECU_PEDI = (SELECT SEPE_COD_SECU_PEDI
        		                          FROM EDU_PARAM_CURSO_CAPAC
                		                 WHERE PAIS_COD_PAIS = C.PAIS_COD_PAIS
                        		           AND EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME
                                		   AND COD_CURS_CAPA = C.COD_CURS_CAPA)) AS SEC_PEDI,
           '*' AS EST_CAPA,
          #codigoCliente# AS CLIE_COD_CLIE,
           	C.IND_EXON_ASIS
    FROM EDU_PARAM_CURSO_CAPAC C
    WHERE C.PAIS_COD_PAIS = #codigoPais#
     AND C.EMCO_COD_EMPR_COME = #codigoEmpresa# 
     AND C.COD_CURS_CAPA NOT IN (
    			 select A.CCAP_COD_CURS_CAPA
    	 		 from edu_histo_aptas a
    			 	 where a.PAIS_COD_PAIS = #codigoPais#
    				 	  AND A.EMCO_COD_EMPR_COME = #codigoEmpresa# 
 					  	  AND A.CLIE_COD_CLIE = #codigoCliente#
                )
    
    ORDER BY COD_CURS_CAPA
		
  </select>                  


<select id="getCursosExoneracionMasiva" parameterClass="historicoAptas" resultMap="situacionHistoricoAptasExoneracionResult">
    
    SELECT C.PAIS_COD_PAIS,
           C.EMCO_COD_EMPR_COME,
           C.COD_CURS_CAPA,
           C.NOM_CURS_CAPA,
           C.PRE_REQU_CAPA Pre_Requ_Capa,
           '' AS sig_curs_capa,
           DECODE(C.STA_CLIE, 'N', 'SI', 'R', 'NO','NO') as PRI_PEDI,
		       (SELECT DES_SECU_PEDI
        		  FROM EDU_SECUE_PEDID
		         WHERE COD_SECU_PEDI = (SELECT SEPE_COD_SECU_PEDI
        		                          FROM EDU_PARAM_CURSO_CAPAC
                		                 WHERE PAIS_COD_PAIS = C.PAIS_COD_PAIS
                        		           AND EMCO_COD_EMPR_COME = C.EMCO_COD_EMPR_COME
                                		   AND COD_CURS_CAPA = C.COD_CURS_CAPA)) AS SEC_PEDI,
           '*' AS EST_CAPA,
           '' AS CLIE_COD_CLIE,
           C.IND_EXON_ASIS
    FROM EDU_PARAM_CURSO_CAPAC C
    WHERE C.PAIS_COD_PAIS = #codigoPais#
     AND C.EMCO_COD_EMPR_COME = #codigoEmpresa# 
     AND C.IND_EXON_ASIS ='S'
    ORDER BY COD_CURS_CAPA
		
  </select>

	<resultMap id="historicoPlanillaInstructoraZonaResult" class="historicoPlanillaInstructora">
		<result property="codigoPais"				column="PAIS_COD_PAIS"/>        
		<result property="codigoRegion"             column="REGI_COD_REGI"/>             
		<result property="estadoRegistro"           column="EST_REGI"/>             
		<result property="codigoEmpresa"            column="EMCO_COD_EMPR_COME"/>   
		<result property="codigoCurso"	          	column="CCAP_COD_CURS_CAPA"/>        
		<result property="codigoInstructora"        column="INST_COD_INST"/>             
	  	<result property="codigoPlanilla"           column="COD_PLAN_PROG"/>        
		<result property="codigoCursoDictado"       column="CDIC_COD_CURS_DICT"/>        
		<result property="situacionPlanilla"      	column="SIT_PLAN_PROG"/>        
		<result property="codigoZona"      			column="ZONA_COD_ZONA"/>       
    </resultMap>

	<select id="getHistoricoPlanillaInstructoraZona" parameterClass="historicoPlanillaInstructora" resultMap="historicoPlanillaInstructoraZonaResult">
	
	SELECT 
  			A.PAIS_COD_PAIS      ,
			A.EMCO_COD_EMPR_COME ,
  			A.CCAP_COD_CURS_CAPA ,
  			A.COD_PLAN_PROG      ,
  			A.REGI_COD_REGI      ,
  			A.INST_COD_INST      ,
  			A.CDIC_COD_CURS_DICT ,
  			A.SIT_PLAN_PROG      ,
  			A.EST_REGI          ,
			(SELECT X.COD_ZONA || ' - '||X.DES_ZONA
			 FROM EDU_ZONA X
			 WHERE X.PAIS_COD_PAIS=#codigoPais#	
				 AND X.EMCO_COD_EMPR_COME = #codigoEmpresa#
				 AND (#codigoRegion# IS NULL OR X.REGI_COD_REGI = #codigoRegion#) 
				 AND X.COD_ZONA = A.ZONA_COD_ZONA)AS ZONA_COD_ZONA 
		FROM EDU_HISTO_PLANI_INSTR A , EDU_CONTR_GENER_PLANI B 
		WHERE 
		  A.PAIS_COD_PAIS=B.PAIS_COD_PAIS
		  AND A.EMCO_COD_EMPR_COME=B.EMCO_COD_EMPR_COME
		  AND A.CCAP_COD_CURS_CAPA=B.CCAP_COD_CURS_CAPA
		  AND A.REGI_COD_REGI=B.REGI_COD_REGI
		  AND A.PAIS_COD_PAIS       =  #codigoPais#										
		  AND A.EMCO_COD_EMPR_COME  =  #codigoEmpresa#                
 		  AND A.EST_REGI  != '9'
		<isNotEmpty prepend="AND" property="situacionPlanilla">
			A.SIT_PLAN_PROG		  =#situacionPlanilla#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCurso">
			A.CCAP_COD_CURS_CAPA	  =#codigoCurso#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoPlanilla">
			A.COD_PLAN_PROG		  =#codigoPlanilla#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoRegion">
			A.REGI_COD_REGI		  =#codigoRegion#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoInstructora">
			A.INST_COD_INST		  =#codigoInstructora#
		</isNotEmpty>		
		<isNotEmpty prepend="AND" property="codigoCursoDictado">
			A.CDIC_COD_CURS_DICT	  =#codigoCursoDictado#
		</isNotEmpty>		
    	<isNotEmpty prepend="AND" property="campanhaInicio">
			B.PERI_COD_PERI	  =#campanhaInicio#
		</isNotEmpty>	
		<![CDATA[
		AND TO_NUMBER(B.COD_PLAN_PROG_INIC)<=TO_NUMBER(A.COD_PLAN_PROG)
		]]>
		<![CDATA[
		AND TO_NUMBER(B.COD_PLAN_PROG_FINA)>=TO_NUMBER(A.COD_PLAN_PROG)
		]]>
		ORDER BY TO_NUMBER(COD_PLAN_PROG) ASC
	</select>


     <resultMap id="cursoParaPrereqResult" class="java.util.HashMap">
	      <result property="codigoCurso" 		  column="COD_CURS_CAPA" />
	      <result property="descripcion" 	      column="NOM_CURS_CAPA" />
	   </resultMap>
	       
     <select id="getCursosParaPrereq" parameterClass="java.util.Map" resultMap="cursoParaPrereqResult">
        SELECT X.COD_CURS_CAPA,
               X.NOM_CURS_CAPA
       FROM EDU_PARAM_CURSO_CAPAC X
       WHERE X.PAIS_COD_PAIS=#codigoPais#
        AND X.EMCO_COD_EMPR_COME =#codigoEmpresa#
        AND X.COD_CURS_CAPA != #codigoCurso#	        
       ORDER BY 1        
    </select>
    
    <insert id="insertCursoCapacitacionPrerequisito" parameterClass="java.util.Map">
                
        INSERT INTO EDU_PARAM_CURSO_CAPAC_REQUI(
   					PAIS_COD_PAIS, 
   					EMCO_COD_EMPR_COME, 
   					CCAP_COD_CURS_CAPA, 
   					COD_CURS_PRE_REQU, 
   					CON_UNIO, 
   					EST_PRE_REQU, 
   					USU_DIGI, 
   					FEC_DIGI, 
   					EST_REGI) 
				VALUES ( 				        
					#codigoPais# ,
					#codigoEmpresa#,	
					#codigoCursoPadre# ,	
					#codigoCurso#,
					#condicionCurso#,
					'A',
					#usuario#,
					SYSDATE,	
					'1')
	</insert>
	
	<delete id="deleteCursoCapacitacionPrerequisito" parameterClass="java.util.Map">                
        DELETE FROM EDU_PARAM_CURSO_CAPAC_REQUI 
        WHERE  	PAIS_COD_PAIS= #codigoPais# 
   			AND EMCO_COD_EMPR_COME = #codigoEmpresa#
   			AND CCAP_COD_CURS_CAPA =#codigoCursoPadre# 
	</delete>
	
	    <resultMap id="cursoPrereqResult" class="java.util.HashMap">
	      <result property="codigoCurso" 		  column="COD_CURS_PRE_REQU" />
	      <result property="descripcion" 	      column="NOM_CURS_CAPA" />
	      <result property="condicionCurso" 	   column="CON_UNIO" />	      
	   </resultMap>
	       
     <select id="getPreRequsitos" parameterClass="java.util.Map" resultMap="cursoPrereqResult">
        SELECT X.COD_CURS_PRE_REQU,
        	   ( SELECT  A.NOM_CURS_CAPA
       			FROM EDU_PARAM_CURSO_CAPAC A
       			WHERE A.PAIS_COD_PAIS=#codigoPais#
        			AND A.EMCO_COD_EMPR_COME =#codigoEmpresa#
        			AND A.COD_CURS_CAPA = X.COD_CURS_PRE_REQU ) NOM_CURS_CAPA,	
               DECODE(X.CON_UNIO,'0','OR','AND') CON_UNIO
       FROM EDU_PARAM_CURSO_CAPAC_REQUI X
       WHERE X.PAIS_COD_PAIS=#codigoPais#
        AND X.EMCO_COD_EMPR_COME =#codigoEmpresa#
        AND X.CCAP_COD_CURS_CAPA = #codigoCurso#
        AND X.EST_PRE_REQU='A'
        AND X.EST_REGI='1'	        
       ORDER BY 1        
    </select>
    
</sqlMap>