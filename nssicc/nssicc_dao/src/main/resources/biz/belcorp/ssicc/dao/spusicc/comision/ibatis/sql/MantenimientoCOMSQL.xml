<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.comision.mantenimientoCOMSQL">

	<typeAlias alias="calificacionComisionCabecera" type="biz.belcorp.ssicc.dao.spusicc.comision.model.CalificacionComisionCabecera"/>
	<typeAlias alias="porcentajeComisionCabecera" type="biz.belcorp.ssicc.dao.spusicc.comision.model.CalificacionComisionCabecera"/>
	<typeAlias alias="comisionCabecera" type="biz.belcorp.ssicc.dao.spusicc.comision.model.CalificacionComisionCabecera"/>
	<typeAlias alias="ordenEstadisticoPorZona" 		type="biz.belcorp.ssicc.dao.spusicc.comision.model.OrdenEstadisticoPorZona"/>
	<typeAlias alias="calificacionComisionDetalle" type="biz.belcorp.ssicc.dao.spusicc.comision.model.CalificacionComisionDetalle"/>
	<typeAlias alias="porcentajeComisionDetalle" type="biz.belcorp.ssicc.dao.spusicc.comision.model.CalificacionComisionDetalle"/>
	<typeAlias alias="comisionDetalle" type="biz.belcorp.ssicc.dao.spusicc.comision.model.CalificacionComisionDetalle"/>
	<typeAlias alias="bonos"				 		type="biz.belcorp.ssicc.dao.spusicc.comision.model.Bonos"/>
	<typeAlias alias="detalleBonos"				 	type="biz.belcorp.ssicc.dao.spusicc.comision.model.DetalleBonos"/>
	<typeAlias alias="zonaDemandaAnticipada"		type="biz.belcorp.ssicc.dao.spusicc.cobranzas.model.ZonaDemandaAnticipada"/>
	<typeAlias alias="datosComisiones"				 	type="biz.belcorp.ssicc.dao.spusicc.cobranzas.model.DatosComisiones"/>
	<typeAlias alias="comisionRegionesSubGerencia"		type="biz.belcorp.ssicc.dao.spusicc.cobranzas.model.DatosRegionesSubGerencia"/>
	<typeAlias alias="comisionCalculados"		type="biz.belcorp.ssicc.dao.spusicc.cobranzas.model.DatosComisionCalculo"/>
	<typeAlias alias="comisionEscalonada"		type="biz.belcorp.ssicc.dao.spusicc.cobranzas.model.DatosComisionEscalonada"/>
	<typeAlias alias="minimoNuevas"		type="biz.belcorp.ssicc.dao.spusicc.cobranzas.model.MinimoNuevas"/>
	<typeAlias alias="baseGenericoCom"         type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
	<typeAlias alias="datosClasificacion"         type="biz.belcorp.ssicc.dao.spusicc.cobranzas.model.DatosComisionClasificacion"/>
	
	
	<resultMap id="paramTipoComiList"     class="java.util.HashMap">    	
    	<result property="codigo"			column="cod_tipo_comi"/>
    	<result property="descripcion"		column="des_comi"/>
  	</resultMap>
	
	<select id="getTipoComiList" resultMap="paramTipoComiList" parameterClass="map">
		select cod_tipo_comi, des_comi 
	  	from com_tipos_comis	
	</select>
  	
 	<resultMap id="calificacionComisionCabeceraResult" 		class="calificacionComisionCabecera">
	
		<result property="codigoPais"			 	column ="COD_PAIS"/>		                     			
		<result property="codigoCalificacion"		column ="COD_CALI"/>
		<result property="descripcion"		 		column ="DES_CALI"/>
		<result property="codigoTipoComisionista"	column ="COD_TIPO_COMI"/>
		<result property="desTipoComisionista"		column ="DES_COMI"/>	
		<result property="campaniaDesde"			column ="CAM_VIGE_DESD"/>	
		<result property="campaniaHasta"		 	column ="CAM_VIGE_HAST"/>
		<result property="comodin"		 			column ="NUM_COMO"/>
		<result property="comodinRecuperacion"		column ="NUM_COMO_RECU"/>
		<result property="codigoMarca"		 		column ="COD_MARC"/>
		<result property="codigoCanal"		 		column ="COD_CANA"/>
		<result property="indicadorPasePedido"      column ="IND_PEDI"/>	                     			                     			
		<result property="comodinRecuperacionAspirantes" column="NUM_COMO_RECU_ASPI"/>	                     			                     			
	</resultMap>

	<resultMap id="porcentajeComisionCabeceraResult" 		class="porcentajeComisionCabecera">
	
		<result property="codigoPais"			 	column ="COD_PAIS"/>		                     			
		<result property="codigoPorcentaje"		    column ="COD_PORC"/>
		<result property="codigoTipoComisionista"	column ="COD_TIPO_COMI"/>
		<result property="desTipoComisionista"		column ="DES_COMI"/>	
		<result property="campaniaDesde"			column ="CAM_DESD"/>	
		<result property="campaniaHasta"		 	column ="CAM_HAST"/>
		<result property="codigoMarca"		 		column ="COD_MARC"/>
		<result property="codigoCanal"		 		column ="COD_CANA"/>
			                     			                     			
	</resultMap>
		
	<resultMap id="comisionCabeceraResult" 		class="comisionCabecera">
	
		<result property="codigoPais"			 	column ="COD_PAIS"/>		                     			
		<result property="codigoComision"		    column ="COD_COMI"/>
		<result property="descripcion"		        column ="DESC1"/>
		<result property="codigoTipoComisionista"	column ="COD_TIPO_COMI"/>
		<result property="desTipoComisionista"		column ="DES_COMI"/>	
		<result property="codigoMarca"		 		column ="COD_MARC"/>
		<result property="codigoCanal"		 		column ="COD_CANA"/>
		<result property="numDiasRecuAspi"			column ="NUM_DIAS_RECU_ASPI"/>	
		<result property="valPorcRecuAspi"		 	column ="VAL_PORC_RECU_ASPI"/>
		<result property="valPorcComiAspi"		 	column ="VAL_PORC_COMI_ASPI"/>
		<result property="numDiasRecuEjec"		 	column ="NUM_DIAS_RECU_EJEC"/>
		<result property="valPorcRecuEjec"		 	column ="VAL_PORC_RECU_EJEC"/>
		<result property="valToleRecu"		 	    column ="VAL_TOLE_RECU"/>
			                     			                     			
	</resultMap>
		
	<resultMap id="enviosSAPResult" class="java.util.HashMap">
		<result property="codigoLider"              column="CODIGO"/>  
		<result property="nombreLider"              column="NOMBRE"/>
		<result property="indicadorEnvio"           column="IND_ENVI"/>
	</resultMap>

	<resultMap id="ordenEstadisticoPorZonaResult" 		class="ordenEstadisticoPorZona">	
		<result property="codigoPais"			 	column ="COD_PAIS"/>
		<result property="codigoRegion"			 	column ="DES_REGI"/>				                     		
		<result property="codigoZona"				column ="COD_ZONA"/>
		<result property="ordenEstadistico"		 	column ="ORD_ESTA"/>
		<result property="estatusRegistro"			column ="EST_REGI"/>			                     			                     			
	</resultMap>

	<select id="getCalificacionesComisionesList" parameterClass="calificacionComisionCabecera" resultMap="calificacionComisionCabeceraResult">
			SELECT A.COD_PAIS,
			       A.COD_CALI,
			       A.DES_CALI,
			       A.COD_TIPO_COMI,
			       B.DES_COMI,
			       A.CAM_VIGE_DESD,
			       A.CAM_VIGE_HAST,
			       A.NUM_COMO,
			       A.NUM_COMO_RECU,
            	   A.COD_MARC,
                   A.COD_CANA,
                   A.IND_PEDI,
                   A.NUM_COMO_RECU_ASPI
			FROM COM_COMIS_CALIF_CABEC A,
			     COM_TIPOS_COMIS B
			WHERE A.COD_TIPO_COMI = B.COD_TIPO_COMI
		  
			<isNotEmpty prepend="AND" property="codigoPais">
				  A.COD_PAIS = #codigoPais#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoCalificacion">
			      A.COD_CALI = #codigoCalificacion#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="codigoTipoComisionista">
			      A.COD_TIPO_COMI =#codigoTipoComisionista#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="descripcion">
			      UPPER(A.DES_CALI) LIKE '%'||UPPER(#descripcion#)||'%'
			</isNotEmpty>		
	</select>	
				
	
	<delete id="deleteCalificacionComisionCabecera" parameterClass="calificacionComisionCabecera">
		DELETE COM_COMIS_CALIF_CABEC
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_CALI = #codigoCalificacion#
	</delete>	
	<delete id="deleteCalificacionComisionDetalle" parameterClass="calificacionComisionCabecera">
		DELETE COM_COMIS_CALIF_DETAL
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_CALI = #codigoCalificacion#
	</delete>
	
	
	<delete id="deletePorcentajeComisionCabecera" parameterClass="porcentajeComisionCabecera">
		DELETE COM_PORCE_COMIS
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_PORC = #codigoPorcentaje#
	</delete>	
	<delete id="deletePorcentajeComisionDetalle" parameterClass="porcentajeComisionCabecera">
		DELETE COM_PORCE_COMIS_DETAL
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_PORC = #codigoPorcentaje#
	</delete>
	
	<delete id="deleteComisionCabecera" parameterClass="comisionCabecera">
		DELETE COM_DATOS_COMIS
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_COMI = #codigoComision#
	</delete>
	
	<delete id="deleteComisionDetalle" parameterClass="comisionCabecera">
		DELETE COM_DATOS_COMIS_CLIEN
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_COMI = #codigoComision#
	</delete>
	
	
	<delete id="deleteCalificacionComisionDetal" parameterClass="calificacionComisionDetalle">
		DELETE COM_COMIS_CALIF_DETAL
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_CALI = #codigoCalificacion#
		   AND COD_NIVE = #codigoNivel#

	   <isEmpty prepend="AND" property="codigoRegion">
           COD_REGI IS NULL
       </isEmpty>             
	   <isNotEmpty prepend="AND" property="codigoRegion">
           COD_REGI =  #codigoRegion#
       </isNotEmpty>             

	   <isEmpty prepend="AND" property="codigoZona">
           COD_ZONA IS NULL
       </isEmpty>             
	   <isNotEmpty prepend="AND" property="codigoZona">
           COD_ZONA =  #codigoZona#
       </isNotEmpty>                    
		   
	</delete>	
	
	
	<delete id="deletePorcentajeComisionDetal" parameterClass="porcentajeComisionDetalle">
		DELETE COM_PORCE_COMIS_DETAL
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_PORC = #codigoPorcentaje#
		   AND COD_NIVE = #codigoNivel#
		   AND NUM_ITEM = #numeroItem#
	</delete>	
    
    <delete id="deleteComisionDetal" parameterClass="comisionDetalle">
		DELETE com_datos_comis_clien
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_COMI = #codigoComision#
		    AND COD_SUBG = #codigoSubGerencia#
		     AND COD_REGI = #codigoRegion#
	 </delete>	
	
	<select id="getPorcentajesComisionesList" parameterClass="porcentajeComisionCabecera" resultMap="porcentajeComisionCabeceraResult">
			SELECT C.COD_PAIS,
			       C.COD_PORC,
			       C.COD_TIPO_COMI,
			       B.DES_COMI,
			       C.CAM_DESD,
			       C.CAM_HAST,
			       C.COD_MARC,
                   C.COD_CANA
			FROM COM_TIPOS_COMIS B,
				 COM_PORCE_COMIS C
			WHERE C.COD_PAIS = B.COD_PAIS
		  	AND B.COD_TIPO_COMI = C.COD_TIPO_COMI
			<isNotEmpty prepend="AND" property="codigoPais">
				  C.COD_PAIS = #codigoPais#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoPorcentaje">
			      C.COD_PORC = #codigoPorcentaje#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="codigoTipoComisionista">
			      C.COD_TIPO_COMI =#codigoTipoComisionista#
			</isNotEmpty>	
	</select>	
	
			
	<select id="getComisionesList" parameterClass="comisionCabecera" resultMap="comisionCabeceraResult">
			SELECT C.COD_PAIS,
			       C.COD_COMI,
			       C.DES_COMI AS DESC1,
				   C.COD_TIPO_COMI,
			       B.DES_COMI,
			       C.COD_MARC,
                   C.COD_CANA,
				   C.NUM_DIAS_RECU_ASPI,
			       C.VAL_PORC_RECU_ASPI,
				   C.VAL_PORC_COMI_ASPI,
				   C.NUM_DIAS_RECU_EJEC,
				   C.VAL_PORC_RECU_EJEC,
				   C.VAL_TOLE_RECU
			FROM COM_TIPOS_COMIS B,
				 COM_DATOS_COMIS C
			WHERE B.COD_TIPO_COMI = C.COD_TIPO_COMI
		  	AND B.COD_PAIS = C.COD_PAIS
			<isNotEmpty prepend="AND" property="codigoPais">
				  C.COD_PAIS = #codigoPais#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoComision">
			      C.COD_COMI = #codigoComision#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="codigoTipoComisionista">
			      C.COD_TIPO_COMI = #codigoTipoComisionista#
			</isNotEmpty>	
			<isNotEmpty prepend="AND" property="descripcion">
			      UPPER(C.DES_COMI) LIKE '%'||UPPER(#descripcion#)||'%'
			</isNotEmpty>		
	</select>
	
	
	
	
	<typeAlias alias="nivel" type="biz.belcorp.ssicc.dao.spusicc.comision.model.Nivel"/>
	<resultMap id="nivelListResult" 		class="nivel">
		<result property="codigoPais"			 	column ="COD_PAIS"/>		                     			
		<result property="codigoNivel"				column ="COD_NIVE"/>
		<result property="descripcion"		 		column ="DES_NIVE"/>
	</resultMap>
	
	<select id="getNivelList" parameterClass="string"	resultMap="nivelListResult">
			 SELECT COD_PAIS, 
			 	COD_NIVE, 
			 	DES_NIVE 
			 FROM COM_NIVEL 
			 WHERE COD_PAIS = #codigoPais#
	</select>	
	 <select id="getSecuenciaNextValue" resultClass="string">
          SELECT LPAD(COM_SEQ_CALIF_COMIS.NEXTVAL,5,'0') FROM DUAL
    </select>
    
    <insert id="insertCalificacionComisionCabecera" parameterClass="calificacionComisionCabecera">
		   INSERT INTO COM_COMIS_CALIF_CABEC
		     (COD_PAIS,
		      COD_MARC,
		      COD_CANA,
		      COD_CALI,
		      DES_CALI,
		      COD_TIPO_COMI,
		      CAM_VIGE_DESD,
		      CAM_VIGE_HAST,
		      NUM_COMO,
		      NUM_COMO_RECU,
		      IND_PEDI,
		      NUM_COMO_RECU_ASPI)
		   VALUES
		     (#codigoPais#,
		      #codigoMarca#,
		      #codigoCanal#,
		      #codigoCalificacion#,
		      #descripcion#,
		      #codigoTipoComisionista#,
		      #campaniaDesde#,
		      #campaniaHasta#,
		      #comodin#,
		      #comodinRecuperacion#,
		      #indicadorPasePedido#,
		      #comodinRecuperacionAspirantes#)
		      
	
    </insert>
    
    
	<insert id="insertPorcentajeComisionCabecera" parameterClass="porcentajeComisionCabecera">
		   INSERT INTO COM_PORCE_COMIS   
		     (COD_PAIS,
		      COD_PORC,
		      COD_MARC,
		      COD_CANA,
		      COD_TIPO_COMI,
		      CAM_DESD,
		      CAM_HAST)
		   VALUES
		     (#codigoPais#,
		      #codigoPorcentaje#,
		      #codigoMarca#,
		      #codigoCanal#,
		      #codigoTipoComisionista#,
		      #campaniaDesde#,
		      #campaniaHasta#)
	</insert>
				
	 <insert id="insertComisionCabecera" parameterClass="comisionCabecera">
		   INSERT INTO COM_DATOS_COMIS   
		     (COD_PAIS,
		      COD_COMI,
		      COD_TIPO_COMI,
		      COD_MARC,
		      COD_CANA,
		      DES_COMI,
		      NUM_DIAS_RECU_ASPI,
		      VAL_PORC_RECU_ASPI,
		      VAL_PORC_COMI_ASPI,
			  NUM_DIAS_RECU_EJEC,
		      VAL_PORC_RECU_EJEC,
		      VAL_TOLE_RECU)
		   VALUES
		     (#codigoPais#,
		      #codigoComision#,
		      #codigoTipoComisionista#,
		      #codigoMarca#,
		      #codigoCanal#,
		      #descripcion#,
		      #numDiasRecuAspi#,
		      TO_NUMBER(#valPorcRecuAspi#,'99999.99'),
		      TO_NUMBER(#valPorcComiAspi#,'999999.99'),
		      #numDiasRecuEjec#,
		      TO_NUMBER(#valPorcRecuEjec#,'99999.99'),
		      TO_NUMBER(#valToleRecu#,'9999.99'))
	</insert>
   
    
    
   <insert id="insertCalificacionComisionDetalle" parameterClass="calificacionComisionDetalle"> 
    INSERT INTO COM_COMIS_CALIF_DETAL
        (COD_PAIS,
         COD_NIVE,
         COD_CALI,
         NUM_PEDI_DESD,
         NUM_PEDI_HAST,
         NUM_INGR_DESD,
         NUM_INGR_HAST,
         COD_REGI,
         COD_ZONA)
      VALUES
        (#codigoPais#,
         #codigoNivel#,
         #codigoCalificacion#,
         #numeroPedidosDesde#,
         #numeroPedidosHasta#,
         #numeroIngresosDesde#,
         #numeroIngresosHasta#,
         #codigoRegion#,
         #codigoZona#)
    </insert>    
   
    <insert id="insertPorcentajeComisionDetalle" parameterClass="porcentajeComisionDetalle"> 
    INSERT INTO COM_PORCE_COMIS_DETAL
        (COD_PAIS,
         COD_PORC,
         COD_NIVE,
         NUM_ITEM,
         IMP_MONT_DESD,
         IMP_MONT_HAST,
         VAL_PORC_COMI)
      VALUES
        (#codigoPais#,
         #codigoPorcentaje#,
         #codigoNivel#,
         #numeroItem#,
         TO_NUMBER(#montoDesde#,'99999999999.99'),
         TO_NUMBER(#montoHasta#,'99999999999.99'),
         TO_NUMBER(#valorPorc#,'999999.99'))
    </insert>  
    
    <insert id="insertComisionDetalle" parameterClass="comisionDetalle"> 
     INSERT INTO COM_DATOS_COMIS_CLIEN 
		     (COD_PAIS,
		      COD_COMI,
		      COD_SUBG,
		      COD_REGI)
		   VALUES
		     (#codigoPais#,
		      #codigoComision#,
		      #codigoSubGerencia#,
		      #codigoRegion#)
    </insert>  
    
    
    <resultMap id="calificacionComisionDetalleListResult" 		class="calificacionComisionDetalle">
	
		<result property="codigoPais"			 	column ="COD_PAIS"/>		                     			
		<result property="codigoNivel"				column ="COD_NIVE"/>
		<result property="codigoRegion"				column ="COD_REGI"/>
		<result property="descripcionRegion"		column ="DES_REGI"/>		
		<result property="codigoZona"				column ="COD_ZONA"/>				
		<result property="codigoCalificacion"		column ="COD_CALI"/>
		<result property="numeroPedidosDesde"		column ="NUM_PEDI_DESD"/>	
		<result property="numeroPedidosHasta"		column ="NUM_PEDI_HAST"/>	
		<result property="numeroIngresosDesde"		column ="NUM_INGR_DESD"/>
		<result property="numeroIngresosHasta"		column ="NUM_INGR_HAST"/>
		<result property="descripcionNivel"		 	column ="DES_NIVE"/>
			                     			                     			
	</resultMap>
    
     <select id="getCalificacionComisionDetalleList" parameterClass="calificacionComisionCabecera" resultMap="calificacionComisionDetalleListResult">
		  SELECT A.COD_PAIS,
		       A.COD_NIVE,
		       A.COD_REGI,
		       (SELECT DES_REGI FROM ZON_REGIO WHERE COD_REGI = A.COD_REGI) DES_REGI,
		       A.COD_ZONA,
		       A.COD_CALI,
		       A.NUM_PEDI_DESD,
		       A.NUM_PEDI_HAST,
		       A.NUM_INGR_DESD,
		       A.NUM_INGR_HAST,
		       B.DES_NIVE
		  FROM COM_COMIS_CALIF_DETAL A
		     , COM_NIVEL B
		  WHERE A.COD_PAIS = B.COD_PAIS
		       AND A.COD_NIVE = B.COD_NIVE
			<isNotEmpty prepend="AND" property="codigoPais">
				  A.COD_PAIS = #codigoPais#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoCalificacion">
			      A.COD_CALI = #codigoCalificacion#
			</isNotEmpty>
          ORDER BY DES_REGI, COD_ZONA			
				
	</select>	    
	
	<resultMap id="porcentajeComisionDetalleListResult" 		class="porcentajeComisionDetalle">
	
		<result property="codigoPais"			 	column ="COD_PAIS"/>	
		<result property="codigoPorcentaje"		    column ="COD_PORC"/>
		<result property="codigoNivel"				column ="COD_NIVE"/>
		<result property="numeroItem"		        column ="NUM_ITEM"/>	
		<result property="montoDesde"		        column ="IMP_MONT_DESD"/>	
		<result property="montoHasta"		        column ="IMP_MONT_HAST"/>
		<result property="valorPorc"		        column ="VAL_PORC_COMI"/>
		<result property="descripcionNivel"		 	column ="DES_NIVE"/>
			                     			                     			
	</resultMap>
	
	<select id="getPorcentajeComisionDetalleList" parameterClass="porcentajeComisionCabecera" resultMap="porcentajeComisionDetalleListResult">
		  SELECT C.COD_PAIS,
		  		C.COD_PORC,
				C.COD_NIVE,
		        C.NUM_ITEM,
		        C.IMP_MONT_DESD,
		        C.IMP_MONT_HAST,
		        C.VAL_PORC_COMI,
		        B.DES_NIVE
		   FROM COM_NIVEL B
		     , COM_PORCE_COMIS_DETAL C
		  WHERE C.COD_PAIS = B.COD_PAIS
		       AND C.COD_NIVE = B.COD_NIVE
			<isNotEmpty prepend="AND" property="codigoPais">
				  C.COD_PAIS = #codigoPais#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoPorcentaje">
			      C.COD_PORC = #codigoPorcentaje#
			</isNotEmpty>
          ORDER BY COD_NIVE, IMP_MONT_DESD					
	</select>	
	<resultMap id="comisionDetalleListResult" 		class="comisionDetalle">
	
		<result property="codigoPais"			 	column ="COD_PAIS"/>		                     			
		<result property="codigoRegion"				column ="COD_REGI"/>
		<result property="descripcionRegion"		column ="DES_REGI"/>		
		<result property="codigoComision"			column ="COD_COMI"/>
		<result property="descripcionComision"		column ="DES_COMI"/>
		<result property="codigoSubGerencia"		column ="COD_SUBG"/>
		<result property="descripcionSubGerencia"	column ="DES_SUBG"/>
			                     			                     			
	</resultMap>
	
	
	<select id="getComisionDetalleList" parameterClass="comisionCabecera" resultMap="comisionDetalleListResult">
		 SELECT D.COD_PAIS,
				D.COD_REGI,
				(SELECT DES_REGI FROM ZON_REGIO WHERE COD_REGI = D.COD_REGI) DES_REGI,
				C.COD_COMI,
				C.DES_COMI,
				D.COD_SUBG,
				(select des_subg_vent from ZON_SUB_GEREN_VENTA where cod_subg_vent = d.cod_subg) DES_SUBG 
		     FROM COM_DATOS_COMIS C
				, COM_DATOS_COMIS_CLIEN D
		   WHERE D.COD_COMI = C.COD_COMI
			<isNotEmpty prepend="AND" property="codigoPais">
				  D.COD_PAIS = #codigoPais#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoComision">
			      D.COD_COMI = #codigoComision#
			</isNotEmpty>
         	 ORDER BY DES_REGI		
	</select>
	
	<resultMap id="comisionDetalleList" 		class="comisionDetalle">
	
		<result property="codigoPais"			 	column ="COD_PAIS"/>		                     			
		<result property="codigoRegion"				column ="COD_REGI"/>
		<result property="descripcionRegion"		column ="DES_REGI"/>
		<result property="codigoComision"			column ="COD_COMI"/>
		<result property="codigoSubGerencia"		column ="COD_SUBG"/>
		<result property="descripcionSubGerencia"	column ="DES_SUBG"/>
	</resultMap>	
	
	<select id="getComisionDetalleLista" parameterClass="comisionDetalle" resultMap="comisionDetalleList">
		 SELECT D.COD_PAIS,
				D.COD_REGI,
				(SELECT DES_REGI FROM ZON_REGIO WHERE COD_REGI = D.COD_REGI) DES_REGI,
				D.COD_COMI,
				D.COD_SUBG,
				(select des_subg_vent from ZON_SUB_GEREN_VENTA where cod_subg_vent = d.cod_subg) DES_SUBG 
			FROM COM_DATOS_COMIS C
				,COM_DATOS_COMIS_CLIEN D
		   WHERE D.COD_COMI = C.COD_COMI
			<isNotEmpty prepend="AND" property="codigoPais">
				  D.COD_PAIS = #codigoPais#
			</isNotEmpty>		
			<isNotEmpty prepend="AND" property="codigoComision">
			      D.COD_COMI = #codigoComision#
			</isNotEmpty>
         	 ORDER BY COD_COMI		
	</select>	
	
	
	
	<update id="updateCalificacionComisionDetalle" parameterClass="calificacionComisionDetalle">
       UPDATE COM_COMIS_CALIF_DETAL
       SET NUM_PEDI_DESD = #numeroPedidosDesde#,
           NUM_PEDI_HAST = #numeroPedidosHasta#,
           NUM_INGR_DESD = #numeroIngresosDesde#,
           NUM_INGR_HAST = #numeroIngresosHasta#
     WHERE COD_PAIS = #codigoPais#
       AND COD_CALI = #codigoCalificacion#
       AND COD_NIVE = #codigoNivel#
		    
	   <isEmpty prepend="AND" property="codigoRegion">
           COD_REGI IS NULL
       </isEmpty>             
	   <isNotEmpty prepend="AND" property="codigoRegion">
           COD_REGI =  #codigoRegion#
       </isNotEmpty>             

	   <isEmpty prepend="AND" property="codigoZona">
           COD_ZONA IS NULL
       </isEmpty>             
	   <isNotEmpty prepend="AND" property="codigoZona">
           COD_ZONA =  #codigoZona#
       </isNotEmpty>                    
	</update>	
	
	
	<update id="updatePorcentajeComisionDetalle" parameterClass="porcentajeComisionDetalle">
       UPDATE COM_PORCE_COMIS_DETAL
       SET IMP_MONT_DESD = TO_NUMBER(#montoDesde#,'99999999999.99'),
           IMP_MONT_HAST = TO_NUMBER(#montoHasta#,'99999999999.99'),
           VAL_PORC_COMI = TO_NUMBER(#valorPorc#,'999999.99')
       WHERE COD_PAIS = #codigoPais#
          AND COD_PORC = #codigoPorcentaje#
          AND COD_NIVE = #codigoNivel#
          AND NUM_ITEM = #numeroItem#
  	</update>	
  	
  	<update id="updateComisionDetalle" parameterClass="comisionDetalle">
      UPDATE COM_DATOS_COMIS_CLIEN
      SET COD_SUBG = #codigoSubGerencia#,
          COD_REGI = #codigoRegion#
      WHERE COD_PAIS = #codigoPais#
      AND COD_COMI = #codigoComision#
      and COD_SUBG = #codigoSubGerencia#
      and COD_REGI = #codigoRegion#
     </update>
	
	
	<update id="updateCalificacionComisionCabeceraAndDetalle" parameterClass="calificacionComisionCabecera">
      UPDATE COM_COMIS_CALIF_CABEC
      SET COD_MARC = #codigoMarca#,
          COD_CANA = #codigoCanal#,
          DES_CALI = #descripcion#,
          COD_TIPO_COMI = #codigoTipoComisionista#,
          CAM_VIGE_DESD = #campaniaDesde#,
          CAM_VIGE_HAST = #campaniaHasta#,
          NUM_COMO = #comodin#,
          NUM_COMO_RECU = #comodinRecuperacion#,
          IND_PEDI = #indicadorPasePedido#,
          NUM_COMO_RECU_ASPI = #comodinRecuperacionAspirantes#
    WHERE COD_PAIS = #codigoPais#
      AND COD_CALI = #codigoCalificacion#
     	    
	</update>
	
	<update id="updatePorcentajeComisionCabeceraAndDetalle" parameterClass="porcentajeComisionCabecera">
      UPDATE COM_PORCE_COMIS
       SET CAM_DESD = #campaniaDesde#,
           CAM_HAST = #campaniaHasta#
       WHERE COD_PAIS = #codigoPais#
          AND COD_PORC = #codigoPorcentaje#
          AND COD_MARC = #codigoMarca#
          AND COD_CANA = #codigoCanal#
          AND COD_TIPO_COMI = #codigoTipoComisionista#
	</update>
	
	<update id="updateComisionCabeceraAndDetalle" parameterClass="comisionCabecera">
      UPDATE COM_DATOS_COMIS
      SET COD_MARC = #codigoMarca#,
          COD_CANA = #codigoCanal#,
          COD_TIPO_COMI = #codigoTipoComisionista#,
          DES_COMI = #descripcion#,
          NUM_DIAS_RECU_ASPI = #numDiasRecuAspi#,
          VAL_PORC_RECU_ASPI = TO_NUMBER(#valPorcRecuAspi#,'99999.99'),
          VAL_PORC_COMI_ASPI = TO_NUMBER(#valPorcComiAspi#,'999999.99'),
          NUM_DIAS_RECU_EJEC = #numDiasRecuEjec#,
          VAL_PORC_RECU_EJEC = TO_NUMBER(#valPorcRecuEjec#,'99999.99'),
          VAL_TOLE_RECU = TO_NUMBER(#valToleRecu#,'9999.99')
      WHERE COD_PAIS = #codigoPais#
      AND COD_COMI = #codigoComision#
     	    
	</update>
	
	
	
	<!--OBTIENE LA LISTA DE ENVIOS SAP-->
	<select id="getEnviosSAP" parameterClass="java.util.Map" resultMap="enviosSAPResult">
			SELECT ML.COD_CLID CODIGO,
				TRIM(C.VAL_NOM1) || ' ' || TRIM(C.VAL_NOM2) || ' ' || TRIM(C.VAL_APE1) || ' ' || 
				TRIM(C.VAL_APE2) NOMBRE,
				ML.IND_ENVI
			FROM MAE_CLIEN_LIDER ML, MAE_CLIEN C
			WHERE ML.COD_CLID = C.COD_CLIE
				AND ML.PAIS_COD_PAIS=#codigoPais#
				AND ML.IND_ENVI = '1'		  
				<isNotEmpty prepend="AND" property="codigoLider">
				   ML.COD_CLID = #codigoLider#
				</isNotEmpty>
	</select>
	
	<!--DESMARCA EL ENVIO SAP-->
	<update id="desmarcarEnvio" parameterClass="java.util.Map">
      UPDATE MAE_CLIEN_LIDER L
	  SET L.IND_ENVI = null, L.USU_ENVI = #usuarioEnvio#, L.FEC_ENVI = SYSDATE
      WHERE L.COD_CLID = #codigoLider#
		
	</update>			
	
	<!--OBTIENE LISTADO DE ORDEN ESTADISTICO POR ZONA-->
	<select id="getOrdenEstadisticoPorZona" parameterClass="ordenEstadisticoPorZona" resultMap="ordenEstadisticoPorZonaResult">
		SELECT O.COD_PAIS, R.DES_REGI, O.COD_ZONA, O.ORD_ESTA, O.EST_REGI
		  FROM COM_ORDEN_ESTAD_ZONA O, ZON_REGIO R, ZON_ZONA Z
		 WHERE R.OID_REGI = Z.ZORG_OID_REGI
		   AND R.PAIS_OID_PAIS = Z.PAIS_OID_PAIS
		   AND O.COD_ZONA = Z.COD_ZONA
		   AND O.COD_PAIS = #codigoPais#
		 	<isNotEmpty prepend="AND" property="codigoZona">
		 		O.COD_ZONA = #codigoZona#
		 	</isNotEmpty>
		 ORDER BY O.COD_ZONA		  
	</select>	
	
	<!--INSERTA ORDEN ESTADISTICO POR ZONA-->
	<insert id="insertOrdenEstadisticoPorZona" parameterClass="ordenEstadisticoPorZona">
		   INSERT INTO COM_ORDEN_ESTAD_ZONA
		         (COD_PAIS,
			       COD_ZONA,
			       ORD_ESTA,
			       EST_REGI,
			       USU_DIGI,
			       FEC_DIGI,
			       USU_MODI,
			       FEC_MODI)
		   VALUES
		     (#codigoPais#,
		      #codigoZona#,
		      #ordenEstadistico#,
		      #estatusRegistro#,
		      #auditInfo.createdBy#, 
      		  #auditInfo.created#, 
      		  #auditInfo.updatedBy#, 
      		  #auditInfo.lastUpdated#)
    </insert>	
    
    <!--ACTUALIZA ORDEN ESTADISTICO POR ZONA-->
    <update id="updateOrdenEstadisticoPorZona" parameterClass="ordenEstadisticoPorZona">
    	UPDATE COM_ORDEN_ESTAD_ZONA
    	SET 
          ORD_ESTA  = #ordenEstadistico#,
		  EST_REGI  = #estatusRegistro#,         
		  USU_DIGI	= #auditInfo.createdBy#,
		  FEC_DIGI	= #auditInfo.created#,
		  USU_MODI	= #auditInfo.updatedBy#,
		  FEC_MODI	= #auditInfo.lastUpdated#		  
    	WHERE
		      COD_PAIS = #codigoPais# AND 
          	  COD_ZONA = #codigoZona# 

	</update>
	
	<update id="deleteOrdenEstadisticoPorZona" parameterClass="ordenEstadisticoPorZona">
		UPDATE COM_ORDEN_ESTAD_ZONA
		SET 
			EST_REGI  = #estatusRegistro#,  
			USU_MODI	= #auditInfo.updatedBy#,
		    FEC_MODI	= #auditInfo.lastUpdated#
		WHERE COD_PAIS = #codigoPais# AND 
          	  COD_ZONA = #codigoZona# 
	</update>

	<typeAlias alias="parametroZonaNueva"     type="biz.belcorp.ssicc.dao.spusicc.comision.model.ParametroZonaNueva"/>

    <resultMap id="parametroZonaNuevaResult"      class="parametroZonaNueva">
		<result property="codigoPais"              column="COD_PAIS"/>
		<result property="importeNeto"             column="IMP_VENT_NETA"/>
		<result property="porcentajeRecuperacion"  column="POR_RECU"/>
		<result property="porcentajeActividad"     column="POR_ACTI"/>
		<result property="importeBono"             column="IMP_BONO"/>
    </resultMap>

    <select id="getParametroZonaNueva" parameterClass="parametroZonaNueva" resultMap="parametroZonaNuevaResult">
			SELECT
				A.COD_PAIS,	   
				A.IMP_VENT_NETA,	       
				A.POR_RECU,	   
				A.POR_ACTI,	  
				A.IMP_BONO
			FROM COM_PARAM_ZONAS_NUEVA A
			WHERE  A.COD_PAIS = #codigoPais#
    </select>
    
    <select id="getParametroZonaNuevaByCriteria" parameterClass="java.util.Map" resultMap="parametroZonaNuevaResult">
			SELECT
				A.COD_PAIS,	   
				A.IMP_VENT_NETA,	       
				A.POR_RECU,	   
				A.POR_ACTI,	  
				A.IMP_BONO
			FROM COM_PARAM_ZONAS_NUEVA A
			WHERE  A.COD_PAIS = #codigoPais#
     </select>
     
     <update id="updateParametroZonaNueva" parameterClass="parametroZonaNueva">
		UPDATE COM_PARAM_ZONAS_NUEVA A
		SET USU_MODI = #auditInfo.updatedBy#,
        	FEC_MODI = #auditInfo.lastUpdated#,
			IMP_VENT_NETA = #importeNeto#,
			POR_RECU = #porcentajeRecuperacion#,
			POR_ACTI = #porcentajeActividad#,
			IMP_BONO = #importeBono#
		WHERE  A.COD_PAIS = #codigoPais#
     </update>
     
    <insert id="insertParametroZonaNueva" parameterClass="parametroZonaNueva">
		INSERT INTO COM_PARAM_ZONAS_NUEVA (
		   COD_PAIS, IMP_VENT_NETA, POR_RECU, 
		   POR_ACTI, IMP_BONO, USU_DIGI, 
		   FEC_DIGI) 
		VALUES ( #codigoPais#, #importeNeto# , #porcentajeRecuperacion# ,
		    #porcentajeActividad#, #importeBono#,
		    #auditInfo.createdBy#,SYSDATE)
     </insert>
          
	<!-- BONOS -->
	<resultMap id="bonosResult"	class="bonos">
		<result property="codigoPais"			 		column ="COD_PAIS"/>		                     			
		<result property="codigoConcepto"				column ="COD_CONC"/>
		<result property="descripcionConcepto"		 	column ="DES_CONC"/>
		<result property="campanhaInicial"		 		column ="CAM_INIC"/>
		<result property="campanhaFinal"		 		column ="CAM_FINA"/>
	</resultMap>
	
	<select id="getBonosEjecutivas" parameterClass="java.util.Map"	resultMap="bonosResult">
			 SELECT A.* 
			 FROM COM_BONOS_CABEC A
			 WHERE COD_PAIS = #codigoPais#
			 <isNotEmpty prepend="AND" property="codigoConcepto">
		 		A.COD_CONC = #codigoConcepto#
		 	</isNotEmpty>
			 <isNotEmpty prepend="AND" property="descripcionConcepto">
		 		A.DES_CONC = #descripcionConcepto#
		 	</isNotEmpty>
		    <isNotEmpty prepend="AND" property="campanhaInicial">
		 		A.CAM_INIC = #campanhaInicial#
		 	</isNotEmpty>
		    <isNotEmpty prepend="AND" property="campanhaFinal">
		 		A.CAM_FINA = #campanhaFinal#
		 	</isNotEmpty>
		 	ORDER BY A.COD_PAIS, A.COD_CONC		 			 	
	</select>	

   <select id="getSiguienteCodigoConcepto" parameterClass="bonos" resultClass="int" >
		 SELECT NVL(TO_NUMBER(MAX(COD_CONC)),0) 
		 FROM COM_BONOS_CABEC
		 WHERE COD_PAIS=#codigoPais#
   </select>	     

	<resultMap id="detalleBonosResult"	class="detalleBonos">
		<result property="codigoPais"			column ="COD_PAIS"/>		                     			
		<result property="codigoConcepto"		column ="COD_CONC"/>
		<result property="codigoRegion"		 	column ="COD_REGI"/>
		<result property="codigoZona"		 	column ="COD_ZONA"/>
		<result property="codigoSeccion"		column ="COD_SECC"/>
		<result property="monto"				column ="MON_BONO"/>
		<result property="indicadorActivo"		column ="IND_ACTI"/>
		<result property="descripcionRegion"	column ="DES_REGI"/>
		<result property="descripcionZona"		column ="DES_ZONA"/>
	</resultMap>
	   
   	<select id="getListDetalleBonos" parameterClass="detalleBonos"	resultMap="detalleBonosResult">
			 SELECT A.* ,
			 	(SELECT ZR.DES_REGI
				 FROM ZON_REGIO ZR 
				 WHERE ZR.COD_REGI =A.COD_REGI) AS DES_REGI, 
			 	(SELECT ZZ.DES_ZONA
				 FROM ZON_REGIO ZR ,ZON_ZONA ZZ		 
				   WHERE ZR.OID_REGI = ZZ.ZORG_OID_REGI
		  			AND ZR.COD_REGI =A.COD_REGI
		  			AND ZZ.COD_ZONA = A.COD_ZONA) AS DES_ZONA
			 FROM COM_BONOS_DETAL A
			 WHERE COD_PAIS = #codigoPais#
		 		AND A.COD_CONC = #codigoConcepto#
			 <isNotEmpty prepend="AND" property="codigoRegion">
		 		A.COD_REGI = #codigoRegion#
		 	</isNotEmpty>
		    <isNotEmpty prepend="AND" property="codigoZona">
		 		A.COD_ZONA = #codigoZona#
		 	</isNotEmpty>
		    <isNotEmpty prepend="AND" property="codigoSeccion">
		 		A.COD_SECC = #codigoSeccion#
		 	</isNotEmpty>
		    <isNotEmpty prepend="AND" property="indicadorActivo">
		 		A.IND_ACTI = #indicadorActivo#
		 	</isNotEmpty>
		 	 ORDER BY A.COD_PAIS, A.COD_CONC, A.COD_REGI,A.COD_ZONA,A.COD_SECC		 			 			 	
	</select>

	<insert id="insertBonos" parameterClass="bonos">
		   INSERT INTO COM_BONOS_CABEC
		         (COD_PAIS,
			       COD_CONC,
			       DES_CONC,
			       CAM_INIC,
			       CAM_FINA)
		   VALUES
		     (#codigoPais#,
		      #codigoConcepto#,
		      #descripcionConcepto#,
		      #campanhaInicial#,
		      #campanhaFinal#)
    </insert>
      
     <update id="updateBonos" parameterClass="bonos">
		UPDATE COM_BONOS_CABEC A
		SET CAM_FINA = #campanhaFinal#,
			DES_CONC=#descripcionConcepto#
		WHERE  A.COD_PAIS = #codigoPais#
		 AND COD_CONC =#codigoConcepto#
     </update>

	<insert id="insertDetalleBonos" parameterClass="detalleBonos">
		   INSERT INTO COM_BONOS_DETAL
		         (COD_PAIS,
			       COD_CONC,
			       COD_REGI,
			       COD_ZONA,
			       COD_SECC,
			       MON_BONO,
			       IND_ACTI)
		   VALUES
		     (#codigoPais#,
		      #codigoConcepto#,
		      #codigoRegion#,
		      #codigoZona#,
		      #codigoSeccion#,
		      TO_NUMBER(#monto#,'9999999.99'),
		      '1')
    </insert>
    
     <update id="updateDetalleBonos" parameterClass="detalleBonos">
		UPDATE COM_BONOS_DETAL A
		SET IND_ACTI = #indicadorActivo#,
			MON_BONO = TO_NUMBER(#monto#,'9999999.99')
		WHERE  A.COD_PAIS = #codigoPais#
		 AND COD_CONC =#codigoConcepto#
		 AND COD_REGI =#codigoRegion#
		 AND COD_ZONA =#codigoZona#
		 AND COD_SECC =#codigoSeccion#
     </update>     
     
	<delete id="deleteDetalleBonos" parameterClass="detalleBonos">
		DELETE COM_BONOS_DETAL
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_CONC =#codigoConcepto#
	</delete>     

		<insert id="insertListDetalleBonos" parameterClass="java.util.Map">
		   INSERT INTO COM_BONOS_DETAL
		         (COD_PAIS,
			       COD_CONC,
			       COD_REGI,
			       COD_ZONA,
			       COD_SECC,
			       MON_BONO,
			       IND_ACTI)
		   VALUES
		     (#codigoPais#,
		      #0#,
		      #1#,
		      #2#,
		      #3#,
		      TO_NUMBER(#4#,'9999999.99'),
		      '1')
    </insert>

    <!-- MANTENIMIENTO - COM - Responsables UA -->                                                                                 
    <resultMap id="listaResponsablesUAResult"  class="java.util.HashMap"  >                                                                       
    	<result property="idHistGere"		column="ID_HIST_GERE" javaType="Integer"/>
    	<result property="codPeriDesde"		column="COD_PERI_DESD"/>
    	<result property="codPeriHasta"		column="COD_PERI_HAST"/>                                                                 
    	<result property="fecDesde" 		column="FEC_DESDE"/>                                                             
    	<result property="fecHasta" 		column="FEC_HASTA"/>                                                                        
    	<result property="codGerencia" 		column="COD_GERENCIA"/>                                                                      
	    <result property="nombre" 		 	column="NOMBRE"/>                                                                      
	    <result property="ua" 		 	    column="ua"/>
	    <result property="codigoMarca" 		column="COD_MARCA"/>
	    <result property="codigoCanal" 		column="COD_CANAL"/>
	    <result property="codigoPais" 		column="COD_PAIS"/>                                                                      
	</resultMap>                                                                                                                         
                                                                                                                                       
    <select id="getListaResponsablesUA" parameterClass="java.util.Map" resultMap="listaResponsablesUAResult">                    
       SELECT 	Z.OID_HIST_GERE AS ID_HIST_GERE,
       			DECODE(PERD_OID_PERI_DESD,NULL,NULL,GEN_PKG_GENER.gen_fn_devuelve_des_perio(PERD_OID_PERI_DESD)) AS COD_PERI_DESD,
       			DECODE(PERD_OID_PERI_HAST,NULL,NULL,GEN_PKG_GENER.gen_fn_devuelve_des_perio(PERD_OID_PERI_HAST)) AS COD_PERI_HAST,
       			TO_CHAR(Z.FEC_DESD,'DD/MM/YYYY') AS FEC_DESDE,
       			TO_CHAR(Z.FEC_HAST,'DD/MM/YYYY') AS FEC_HASTA,
       			Z.GERE AS COD_GERENCIA,
       			TRIM(M.VAL_NOM1) || ' ' || TRIM(M.VAL_NOM2) || ' ' || TRIM(M.VAL_APE1) || ' ' || TRIM(M.VAL_APE2) AS NOMBRE,
       			Z.UA AS UA,
                #codigoMarca# AS COD_MARCA,
                #codigoCanal# AS COD_CANAL,
                #codigoPais# AS COD_PAIS
         FROM 	ZON_HISTO_GEREN Z, MAE_CLIEN M
 		WHERE 	Z.GERE = M.COD_CLIE
 				<isNotEmpty prepend="AND" property="codigoMarca">
				  z.marc_oid_marc = gen_pkg_gener.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#)
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="codigoCanal">
				  z.cana_oid_cana = gen_pkg_gener.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#)
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="codigoZona">
				  SUBSTR(Z.UA, 5, 4) = #codigoZona#
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="codigoSeccion">
				  SUBSTR(Z.UA, 9, 1) = #codigoSeccion#
				</isNotEmpty>
		  AND   length(z.ua)= decode(#tipoUnidad#,'3', 8,9)
      ORDER BY 	Z.PERD_OID_PERI_DESD ,Z.FEC_DESD, Z.OID_HIST_GERE
    </select>        
    
    <update id="updateResponsablesUA" parameterClass="java.util.Map">
       UPDATE ZON_HISTO_GEREN
          SET FEC_DESD 	         = (select FEC_INIC from cra_perio where OID_PERI = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodoDesde#)),
           	  FEC_HAST 	         = DECODE(#codigoPeriodoHasta#,NULL,NULL,(select FEC_FINA from cra_perio where OID_PERI = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodoHasta#))),
              GERE 		         = TRIM(#codigoResponsable#),
              PERD_OID_PERI_DESD = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodoDesde#),
       		  PERD_OID_PERI_HAST = DECODE(#codigoPeriodoHasta#,NULL,NULL,GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodoHasta#)),
              USU_MODI 			 = #usuario#,
              FEC_MODI 			 = SYSDATE
        WHERE OID_HIST_GERE = #oidHistGere#
	</update> 
	
    <select id="getMaximoNumeroItem" parameterClass="java.util.Map" resultClass="int" >
		select nvl(max(num_item),0)+1
		from com_porce_comis_detal 
		WHERE COD_PAIS = #codigoPais# 
           AND COD_PORC = #codigoPorcentaje# 
           AND COD_NIVE = #codigoNivel# 
   </select>   
    
   <select id="getMaximoOidDesde" parameterClass="java.util.Map" resultClass="int" >
		SELECT MAX(c.oid_peri)
  		  FROM cra_perio c
 		 WHERE to_date(#fechaDesde#, 'dd/mm/yyyy')>= c.fec_inic
 		 <![CDATA[  
		   AND to_date(#fechaDesde#, 'dd/mm/yyyy')<= c.fec_fina
		 ]]>
   </select>
   
   <select id="getMaximoOidHasta" parameterClass="java.util.Map" resultClass="int" >
		SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_NANTE_CAMPA( MAX(c.oid_peri),1)
  		  FROM cra_perio c
 		 WHERE to_date(#fechaHasta#, 'dd/mm/yyyy')>= c.fec_inic
 		 <![CDATA[  
		   AND to_date(#fechaHasta#, 'dd/mm/yyyy')<= c.fec_fina
		 ]]>
   </select>
   
   
   	<select id="getNivelActualEjecutiva" parameterClass="java.util.Map" resultClass="string" >
 		SELECT A.COD_NIVE || ' - ' || (
             SELECT X.DES_NIVE
 		     FROM COM_NIVEL X                          
 		     WHERE X.COD_NIVE=A.COD_NIVE )
        FROM COM_HISTO_VARIA_EJETR_CABEC A 
        WHERE A.COD_PAIS=#codigoPais#
         AND A.COD_MARC=#codigoMarca#
         AND A.COD_CANA=#codigoCanal#
         AND A.COD_TIPO_COMI=#tipoComisionista#
         AND A.COD_EJEC=#codigoClienteBuscar#
         AND A.NUM_ANIO_INIC=#anioInicTramo#
         AND A.COD_RANG=#codTramo#
   </select>   
   
   <select id="getValidaResponsable" parameterClass="java.util.Map" resultClass="string">
   		SELECT COM_PKG_REPOR.COM_FN_VALID_RESPO(#codigoPais#,#codigoMarca#,#codigoCanal#,#codigoResponsable#,#codigoPeriodoDesde#,#codigoPeriodoHasta#) from dual
   </select>
   
   <resultMap id="getCodigosSubGerenciaRegionByCodigoZonaResult" class="java.util.HashMap">
   	    <result property="codigoSubGerenciaVenta" column="COD_SUBG_VENT"/>
   	    <result property="codigoRegion" column="COD_REGI"/>
   </resultMap>
   
   <select id="getCodigosSubGerenciaRegionByCodigoZona" parameterClass="string" resultMap="getCodigosSubGerenciaRegionByCodigoZonaResult">
   		select a.COD_SUBG_VENT,b.COD_REGI
		from zon_sub_geren_venta a, zon_regio b,zon_zona c
		where a.oid_subg_vent = b.zsgv_oid_subg_vent
		and b.oid_regi = c.zorg_oid_regi
		and c.cod_zona = #value#
   </select>
   
   <insert id="insertResponsableUA" parameterClass="java.util.Map">
   		INSERT INTO ZON_HISTO_GEREN (
		  OID_HIST_GERE,
		  MARC_OID_MARC,
		  CANA_OID_CANA,
		  UA,
		  GERE,
		  FEC_DESD,
		  FEC_HAST,
		  PAIS_OID_PAIS,
		  PERD_OID_PERI_DESD,
		  PERD_OID_PERI_HAST,
		  USU_MODI,
		  FEC_MODI
		) VALUES (
		  ZON_HGER_SEQ.NEXTVAL,
		  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
		  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#),
		  #ua#,
		  #codigoResponsable#,
		  (select FEC_INIC from cra_perio where OID_PERI = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodoDesde#)),
		  DECODE(#codigoPeriodoHasta#,NULL,NULL,(select FEC_FINA from cra_perio where OID_PERI = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodoHasta#))),
		  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#),
		  gen_pkg_gener.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
		  DECODE(#codigoPeriodoHasta#,NULL,NULL,gen_pkg_gener.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#)),
		  #codigoUsuario#,
		  sysdate  
		)
   </insert>
   
   <delete id="deleteResponsableUA" parameterClass="integer">
   		 DELETE FROM ZON_HISTO_GEREN WHERE OID_HIST_GERE = #value#
   </delete>
   
    <select id="getValidaEjecutiva" parameterClass="string" resultClass="string">
        SELECT COUNT(1)
          FROM MAE_CLIEN_LIDER
         WHERE COD_CLID = #codigoCliente#  							     
    </select>
   
	<insert id="updateCuentaDetraccion" parameterClass="java.util.Map">
		UPDATE MAE_CLIEN_LIDER
		   SET VAL_CUEN_DETR = #cuentaDetraccion#
		 WHERE COD_CLID = #codigoCliente#
    </insert>
    
    <resultMap id="zonasDemandaAnticipadaDetalleList" class="java.util.HashMap">
    	<result property="codigoPais"         		   column="COD_PAIS"/>
		<result property="codigoZona"              	   column="COD_ZONA"/>  
		<result property="codigoDescripcion"           column="DES_ZONA"/>
	</resultMap>
    
    <select id="getZonasDemandaAnticipadaDetalle" parameterClass="java.util.Map" resultMap="zonasDemandaAnticipadaDetalleList" >
		SELECT COM.COD_PAIS COD_PAIS, COM.COD_ZONA COD_ZONA, 
		Z.DES_ZONA DES_ZONA FROM COM_ZONA_DEMAN_ANTIC
		COM, ZON_ZONA Z WHERE COM.COD_ZONA = Z.COD_ZONA AND Z.IND_ACTI = 1 AND COM.EST_REGI = 1 AND
		COM.COD_PAIS = #codigoPais#
		   <isNotEmpty prepend="AND" property="codigoZona">
	                  com.cod_zona = #codigoZona#
		   </isNotEmpty>
		    <isNotEmpty prepend="AND" property="descripcionZona">
	                  z.des_zona = #descripcionZona#
		   </isNotEmpty>
    </select>
  
    <insert id="insertZonasDemandaAnticipada" parameterClass="java.util.Map">
    	INSERT INTO COM_ZONA_DEMAN_ANTIC(
    	COD_PAIS, 
    	COD_ZONA, 
    	USU_DIGI, 
    	FEC_DIGI, 
    	EST_REGI
    	)VALUES(
    	#codigoPais#,
    	#codigoZona#,
    	#usuario#,
    	SYSDATE,
    	1
    	)
    </insert>
    
    <resultMap id="zonaDemandaAnticipadaResult" class="zonaDemandaAnticipada">
		<result property="codigoPais"        column="COD_PAIS"/>  
		<result property="codigoZona"        column="COD_ZONA"/>
		<result property="numDiasTra1"       column="NUM_DIAS_TRA1"/>
		<result property="numDiasTra2"       column="NUM_DIAS_TRA2"/>
		<result property="numDiasCome"       column="NUM_DIAS_COME"/>
		<result property="numDiasTra1Gzon"   column="NUM_DIAS_TRA1_GZON"/>
		<result property="numDiasTra2Gzon"   column="NUM_DIAS_TRA2_GZON"/>
		<result property="numDiasTra1Greg"   column="NUM_DIAS_TRA1_GREG"/>
		<result property="numDiasTra2Greg"   column="NUM_DIAS_TRA2_GREG"/>
		<result property="estRegi"           column="EST_REGI"/>
	</resultMap>
    
    <select id="getZonaDemandaAnticipada" parameterClass="java.util.Map" resultMap="zonaDemandaAnticipadaResult">
	    SELECT COD_PAIS , 
	    COD_ZONA, 
	    NVL(NUM_DIAS_TRA1,0) NUM_DIAS_TRA1, 
	    NVL(NUM_DIAS_TRA2,0) NUM_DIAS_TRA2, 
	    NVL(NUM_DIAS_COME,0) NUM_DIAS_COME, 
		NVL(NUM_DIAS_TRA1_GZON,0) NUM_DIAS_TRA1_GZON,
		NVL(NUM_DIAS_TRA2_GZON,0) NUM_DIAS_TRA2_GZON, 
		NVL(NUM_DIAS_TRA1_GREG,0) NUM_DIAS_TRA1_GREG, 
		NVL(NUM_DIAS_TRA2_GREG,0) NUM_DIAS_TRA2_GREG,
		EST_REGI 
		FROM COM_ZONA_DEMAN_ANTIC 
		WHERE COD_PAIS = #codigoPais# AND COD_ZONA = #codigoZona#
    </select>
    
    <update id="updateZonasDemandaAnticipada" parameterClass="java.util.Map">
    	UPDATE COM_ZONA_DEMAN_ANTIC
		SET COD_ZONA = #codigoZona#,
		USU_MODI = #usuario#,
		FEC_MODI = SYSDATE
		WHERE COD_PAIS = #codigoPais# AND COD_ZONA = #codigoZonaAntiguo#
    </update>
    
    <update id="deleteZonasDemandaAnticipada" parameterClass="java.util.Map">
		UPDATE COM_ZONA_DEMAN_ANTIC
		SET EST_REGI = 9,
		USU_MODI = #usuario#,
		FEC_MODI = SYSDATE
		WHERE COD_ZONA = #codigoZona#
    </update>
    
    <select id="getValidarZonasDemanta" resultClass="integer" parameterClass="java.util.Map">
	SELECT COUNT(1) FROM COM_ZONA_DEMAN_ANTIC 
	WHERE COD_PAIS = #codigoPais#  AND COD_ZONA = #codigoZona#
    </select>
    
    <select id="getValidaExisteZona" resultClass="integer" parameterClass="java.util.Map">
    	SELECT COUNT(1) FROM ZON_ZONA WHERE COD_ZONA = #codigoZona# 
    	AND IND_ACTI = 1 AND 
    	PAIS_OID_PAIS = gen_pkg_gener.gen_fn_devuelve_id_pais(#codigoPais#)
    </select>
    
     <resultMap id="comisionesRecuperacionDetalleList" class="java.util.HashMap">
    	<result property="oidComision"         		   column="OID_COMI"/>
		<result property="codigoComision"              column="COD_COMI"/>  
		<result property="descripcionComision"         column="VAL_CONC"/>
		<result property="estadoComision"              column="COD_ESTA_COMI"/>
	</resultMap>
    
    <select id="getComisionesRecuperacionDetalle" parameterClass="java.util.Map" resultMap="comisionesRecuperacionDetalleList">
		SELECT c.OID_COMI, c.COD_COMI , c.VAL_CONC ,ce.COD_ESTA_COMI
	   FROM COM_COMIS c , COM_ESTAD_COMIS ce 
	   WHERE c.IND_COMP = 0 
	   		AND c.CECO_OID_ESTA_COMI = ce.OID_ESTA_COMI
	   <isNotEmpty prepend="AND" property="codigoComision">
                  c.COD_COMI = #codigoComision#
	   </isNotEmpty>
	    <isNotEmpty prepend="AND" property="descripcionComision">
                  c.VAL_CONC = #descripcionComision#
	   </isNotEmpty>
	   ORDER BY c.OID_COMI
    </select>
    
    <select id="getCodigoComisionSiguiente" resultClass="string">
    	SELECT LPAD(MAX(TO_NUMBER(COD_COMI)+1), 5, '0')  FROM COM_COMIS
    </select>

    <insert id="insertComisiones" parameterClass="datosComisiones">
	   	INSERT into COM_COMIS(	
	   	OID_COMI,
	   	COD_COMI, 
	   	NUM_VERS, 
	   	VAL_CONC,
	   	IND_COMP,
	   	IND_TRAT_DIFE,
		TPLA_OID_TIPO_PLAN,
		CECO_OID_ESTA_COMI,
		IND_VENT_COBR,
		IND_CONS_SABA_DOMI_FERI,
		IND_DESC_IMPO_VENT_PAGO,
		IND_COMI_ESCA,
		TICO_TIPO_COMI,
		COBA_COD_BASE,
		USU_DIGI,
		FEC_DIGI,
		EST_REGI,
		IND_DESC_RECL_FACT,
		IND_CRON,
		MON_FIJO_COMI,
        POR_COMI_RETI,
        POR_VENT_CONS,
        POR_COMI_RETL)
		Values	
		(COM_COMI_SEQ.NEXTVAL,
		#codigoComision#, 
		1, 
		#descripcion#, 
		0, 
		1, 
		2,
		2, 
		'C', 
		#indicadorConsideraSD#,
		#indicadorDctoImpuesto#,
		#indicadorComisionEscalonada#,
		#codigoTipoComisionista#,
		#codigoBaseComision#,
		#nombreUsuario#,
		SYSDATE,
		2,
		#indicadorDsctoReclamoFacturacion#,
		#indicadorConsiderarCronograma#,
		#montoFijoComision#,
		#comisionRetirada#,
		#porcentajeVentaConsultoras#,
		#porcentajeComisionRetail#)
    </insert>
    
    <insert id="insertDetalleComisiones" parameterClass="comisionRegionesSubGerencia">
    	INSERT INTO COM_COMIS_CLIEN(
    	OID_COMI_CLIE, 
    	FEC_ANTI_DESD,
    	FEC_ANTI_HAST,
    	COMI_OID_COMI, 
    	ZSGV_OID_SUBG_VENT, 
    	ZORG_OID_REGI, 
    	COD_ORDE)
 		Values
   		(COM_COCL_SEQ.NEXTVAL,
   		#fechaAntiguedadDesde#,
   		#fechaAntiguedadHasta#,
   		#oidComision#, 
   		GEN_PKG_GENER.gen_fn_devuelve_id_sub_geren(#codigoSubGerencia#), 
   		GEN_PKG_GENER.gen_fn_devuelve_id_region(#codigoPais#,#codigoMarca#,#codigoCanal#,#codigoRegion#), 
   		#orden#)
    
    </insert>
    
    <insert id="insertDetalleComisionesZona" parameterClass="comisionRegionesSubGerencia">
    	INSERT INTO COM_COMIS_CLIEN(
    	OID_COMI_CLIE, 
    	FEC_ANTI_DESD,
    	FEC_ANTI_HAST,
    	COMI_OID_COMI, 
    	ZSGV_OID_SUBG_VENT, 
    	ZORG_OID_REGI, 
    	ZZON_OID_ZONA,
    	COD_ORDE)
 		Values
   		(COM_COCL_SEQ.NEXTVAL,
   		#fechaAntiguedadDesde#,
   		#fechaAntiguedadHasta#,
   		#oidComision#, 
   		GEN_PKG_GENER.gen_fn_devuelve_id_sub_geren(#codigoSubGerencia#), 
   		GEN_PKG_GENER.gen_fn_devuelve_id_region(#codigoPais#,#codigoMarca#,#codigoCanal#,#codigoRegion#), 
   		GEN_PKG_GENER.gen_fn_devuelve_id_zona(#codigoPais#,#codigoMarca#,#codigoCanal#,#codigoRegion#, #codigoZona#), 
   		#orden#)
    
    </insert>
    
    <select  id="getOidComisiones" parameterClass="java.util.Map" resultClass="integer">
    	SELECT OID_COMI FROM COM_COMIS WHERE COD_COMI = #codigoComision#
    </select>
    
	<insert id="insertComisionCalculada" parameterClass="comisionCalculados">
	    INSERT INTO COM_COMIS_COBRA_TIPO_PARTI(
		OID_COMI_COBR_TIPO_PART, 
		VAL_NIVE_TRAM, 
		NUM_DIAS_COMI, 
		VAL_PORC_RECU, 
		COCO_OID_COMI_COBR, 
		VAL_PORC_COMI, 
		VAL_PORC_ACTI, 
		VAL_PORC_COMI_ACTI  
		)VALUES(	
	 	COM_CCTP_SEQ.NEXTVAL, 
	 	#nroTramo#,
	 	#nroDiasComision#, 
	 	#valPorcRecuperacion#, 
	 	#oidCobranza#,
		#valPorcComision#,
		#valPorcActividad#,
		#valPorcComisionActividad#)
    </insert>
    
    <insert id="insertComisionEscalonada" parameterClass="comisionEscalonada">
    INSERT INTO COM_COMIS_ESCAL(
    OID_COMI_ESCA, 
    OID_COMI_COBR, 
    NUM_DIAS_RECU, 
    NUM_DIAS_COMI, 
    POR_RECU_INIC, 
    POR_RECU_FINA, 
    POR_COMI, 
    VAL_BONO, 
    NUM_NIVE, 
    COMI_ADI,
    POR_OBJE_INIC, 
    POR_OBJE_FINA
    )VALUES(
    COM_COCE_SEQ.NEXTVAL,
    #codigoCobranza#,
    #nroDiasRecuperacion#,
    #nroDiasRecuperacion#,
    #valPorcRecuperacionInicial#,
    #valPorcRecuperacionFinal#,
    #valPorcComision#,
    #bono#,
    #nroTramo#,
    #valPorcComisionAdicional#,
    #valPorcInicialVenta#,
    #valPorcFinalVenta#
    )
    </insert>
    
    <insert id="insertComisionCobranza" parameterClass="java.util.Map">
	INSERT INTO COM_COMIS_COBRA(
	OID_COMI_COBR, 
	NUM_DIAS_TRAS_FACT, 
	COMI_OID_COMI, 
	TPAR_OID_TIPO_PART
	)VALUES(
	COM_COCO_SEQ.NEXTVAL, 
	0, 
	#oidComision#, 
	3)
    </insert>

    <select id="getOidCobranzaComisiones" resultClass="integer" parameterClass="java.util.Map">
    SELECT OID_COMI_COBR FROM COM_COMIS_COBRA WHERE COMI_OID_COMI = #oidComision#
    </select>
    
     <resultMap id="datosComisionRecuperacionResult" class="datosComisiones">
		<result property="oidComision"        				  column="OID_COMI"/>  
		<result property="codigoComision"        			  column="COD_COMI"/>
		<result property="descripcion"       				  column="VAL_CONC"/>
		<result property="indicadorConsideraSD"       		  column="IND_CONS_SABA_DOMI_FERI"/>
		<result property="indicadorDsctoReclamoFacturacion"   column="IND_DESC_RECL_FACT"/>
		<result property="indicadorDctoImpuesto" 			  column="IND_DESC_IMPO_VENT_PAGO"/>
		<result property="indicadorComisionEscalonada"  	  column="IND_COMI_ESCA"/>
		<result property="codigoTipoComisionista"   		  column="TIP_COMI"/>
		<result property="codigoBaseComision"   			  column="BAS_COMI"/>
		<result property="codigoEstado"   					  column="EST_REGI"/>
		<result property="estadoComision"   				  column="EST_COMI"/>
		<result property="indicadorConsiderarCronograma"   	  column="IND_CRON"/>
		<result property="montoFijoComision"   				  column="MON_FIJO_COMI"/>
		<result property="comisionRetirada"    				  column="POR_COMI_RETI"/>
		<result property="porcentajeVentaConsultoras"    	  column="POR_VENT_CONS"/>
		<result property="porcentajeComisionRetail"    	      column="POR_COMI_RETL"/>
	</resultMap>
    
    <select id="getDatosComisionRecuperacion" resultMap="datosComisionRecuperacionResult" parameterClass="java.util.Map">
	SELECT 
		COM.OID_COMI, 
		COM.COD_COMI,
		COM.VAL_CONC,   
		NVL(COM.IND_CONS_SABA_DOMI_FERI,0) IND_CONS_SABA_DOMI_FERI, 
		NVL(COM.IND_DESC_IMPO_VENT_PAGO,0) IND_DESC_IMPO_VENT_PAGO,
		NVL(COM.IND_COMI_ESCA,0) IND_COMI_ESCA,
		NVL(COM.TICO_TIPO_COMI,'') TIP_COMI,
		NVL(COM.COBA_COD_BASE,'') BAS_COMI,
		NVL(COM.EST_REGI,2) EST_REGI,
		NVL(COM.IND_DESC_RECL_FACT,0) IND_DESC_RECL_FACT,
		(SELECT CEC.COD_ESTA_COMI FROM COM_ESTAD_COMIS CEC WHERE CEC.OID_ESTA_COMI = COM.CECO_OID_ESTA_COMI) EST_COMI,
		NVL(COM.IND_CRON,0) IND_CRON,
		NVL(MON_FIJO_COMI,0) MON_FIJO_COMI ,
        NVL(POR_COMI_RETI,0) POR_COMI_RETI,
        NVL(POR_VENT_CONS,'') POR_VENT_CONS,
        NVL(POR_COMI_RETL,'') POR_COMI_RETL
        
		FROM 
		COM_COMIS COM
		WHERE 1=1
		<isNotEmpty prepend="AND" property="oidComision">
			COM.OID_COMI = #oidComision#
		</isNotEmpty>
		
		<isNotEmpty prepend="AND" property="codigoComision">
			COM.COD_COMI = #codigoComision#
		</isNotEmpty>
    </select>
    
     <resultMap id="datosComisionesZonasSubGerenciaResult" class="comisionRegionesSubGerencia">
     	<result property="oidComisionCliente"       column="OID_COMI_CLIE"/>
		<result property="strfechaAntiguedadDesde"     column="FEC_ANTI_DESD"/>  
		<result property="strfechaAntiguedadHasta"     column="FEC_ANTI_HAST"/>
		<result property="codigoSubGerencia"		column="COD_SUB_GEREN"/>
		<result property="descripcionSubGerencia"   column="DES_SUB_GEREN"/>
		<result property="codigoRegion"       		column="COD_REGI"/>
		<result property="descripcionRegion"  		column="DES_REGI"/>
		<result property="oidComision"   			column="COMI_OID_COMI"/>
		<result property="orden"   					column="COD_ORDE"/>
		<result property="codigoZona"       		column="COD_ZONA"/>
		<result property="descripcionZona"  		column="DES_ZONA"/>
	</resultMap>
	
    <select id="getDatosComisionesZonasSubGerencia" 
    		resultMap="datosComisionesZonasSubGerenciaResult" parameterClass="java.util.Map">
	    SELECT 
	    	COM.OID_COMI_CLIE OID_COMI_CLIE,
			<![CDATA[TO_CHAR(COM.FEC_ANTI_DESD,'DD/MM/YYYY')]]> FEC_ANTI_DESD, 
			<![CDATA[TO_CHAR(COM.FEC_ANTI_HAST,'DD/MM/YYYY')]]> FEC_ANTI_HAST,
			GEN_PKG_GENER.gen_fn_devuelve_cod_sub_geren(ZSGV_OID_SUBG_VENT) COD_SUB_GEREN,
			(SELECT DES_SUBG_VENT FROM ZON_SUB_GEREN_VENTA WHERE OID_SUBG_VENT = COM.ZSGV_OID_SUBG_VENT) DES_SUB_GEREN,
			(SELECT Z.COD_REGI FROM ZON_REGIO Z WHERE Z.OID_REGI = COM.ZORG_OID_REGI) COD_REGI,
			(SELECT Z.DES_REGI FROM ZON_REGIO Z WHERE Z.OID_REGI = COM.ZORG_OID_REGI) DES_REGI,
			COM.COMI_OID_COMI COMI_OID_COMI, 
			COM.COD_ORDE,
			(SELECT Z.COD_ZONA FROM ZON_ZONA Z WHERE Z.OID_ZONA = COM.ZZON_OID_ZONA) COD_ZONA,
			(SELECT Z.DES_ZONA FROM ZON_ZONA Z WHERE Z.OID_ZONA = COM.ZZON_OID_ZONA) DES_ZONA
			FROM COM_COMIS_CLIEN COM
			WHERE COM.COMI_OID_COMI = #oidComision#
			ORDER BY COD_REGI ASC
    </select>
    
    <resultMap id="datosComisionesResult" class="comisionCalculados">
		<result property="nroTramo"     	   		column="VAL_NIVE_TRAM"/>  
		<result property="nroDiasComision"     		column="NUM_DIAS_COMI"/>
		<result property="valPorcRecuperacion"		column="VAL_PORC_RECU"/>
		<result property="valPorcComision"   		column="VAL_PORC_COMI"/>
		<result property="valPorcActividad"       	column="VAL_PORC_ACTI"/>
		<result property="valPorcComisionActividad" column="VAL_PORC_COMI_ACTI"/>
	</resultMap>
	
    <select id="getDatosComisiones" resultMap="datosComisionesResult" parameterClass="java.util.Map">
    SELECT 
		cctp.VAL_NIVE_TRAM,
		cctp.NUM_DIAS_COMI,
		cctp.VAL_PORC_RECU,
		cctp.VAL_PORC_COMI,
		NVL(cctp.VAL_PORC_ACTI,0) VAL_PORC_ACTI,
		NVL(cctp.VAL_PORC_COMI_ACTI,0) VAL_PORC_COMI_ACTI
		FROM COM_COMIS_COBRA_TIPO_PARTI cctp, COM_COMIS_COBRA coco 
		WHERE cctp.COCO_OID_COMI_COBR = coco.OID_COMI_COBR
		AND coco.COMI_OID_COMI = #oidComision#
		order by cctp.VAL_NIVE_TRAM
    </select>
    
    <resultMap id="datosComisionEscalonadaResult" class="comisionEscalonada">
		<result property="oidComisionEscalonada"     	column="OID_COMI_COBR"/>  
		<result property="nroDiasRecuperacion"     		column="NUM_DIAS_RECU"/>
		<result property="nroDiasComision"				column="NUM_DIAS_COMI"/>
		<result property="valPorcRecuperacionInicial"   column="POR_RECU_INIC"/>
		<result property="valPorcRecuperacionFinal"     column="POR_RECU_FINA"/>
		<result property="valPorcComision" 				column="POR_COMI"/>
		<result property="bono" 						column="VAL_BONO"/>
		<result property="nroTramo" 					column="NUM_NIVE"/>
		<result property="valPorcComisionAdicional" 	column="COMI_ADI"/>
		<result property="valPorcInicialVenta" 			column="POR_OBJE_INIC"/>
		<result property="valPorcFinalVenta" 			column="POR_OBJE_FINA"/>
	</resultMap>
	
    <select id="getComisionEscalonada" resultMap="datosComisionEscalonadaResult" parameterClass="java.util.Map">
	    SELECT 
	    cce.OID_COMI_COBR, 
	    cce.NUM_DIAS_RECU, 
	    cce.NUM_DIAS_COMI, 
	    cce.POR_RECU_INIC, 
	    cce.POR_RECU_FINA, 
	    cce.POR_COMI, 
	    NVL(cce.VAL_BONO,0) VAL_BONO, 
	    NVL(cce.NUM_NIVE,0) NUM_NIVE,
	    cce.COMI_ADI ,
	    NVL(POR_OBJE_INIC,0) POR_OBJE_INIC, 
	    NVL(POR_OBJE_FINA,0) POR_OBJE_FINA
	    FROM COM_COMIS_ESCAL cce, COM_COMIS_COBRA coco
	    where cce.OID_COMI_COBR = coco.OID_COMI_COBR 
	    AND coco.COMI_OID_COMI = #oidComision#
	    order by cce.NUM_NIVE
    </select>
    
    <update id="updateComisiones" parameterClass="datosComisiones">
    UPDATE COM_COMIS
    SET VAL_CONC = #descripcion#,
		PLCP_OID_PLAN_COMI_PAIS = GEN_PKG_GENER.gen_fn_devuelve_id_pais(#codigoPais#),
		PERD_OID_PERI = GEN_PKG_GENER.gen_fn_devuelve_id_perio(GEN_PKG_GENER.gen_fn_devuelve_perio_actu(
							GEN_PKG_GENER.gen_fn_devuelve_id_pais(#codigoPais#),#codigoMarca#,
							GEN_PKG_GENER.gen_fn_devuelve_id_canal(#codigoCanal#))),
		IND_CONS_SABA_DOMI_FERI = #indicadorConsideraSD#,
		IND_DESC_IMPO_VENT_PAGO = #indicadorDctoImpuesto#,
		IND_DESC_RECL_FACT = #indicadorDsctoReclamoFacturacion#,
		IND_COMI_ESCA = #indicadorComisionEscalonada#,
		IND_CRON = #indicadorConsiderarCronograma#,
		TICO_TIPO_COMI = #codigoTipoComisionista#,
		COBA_COD_BASE = #codigoBaseComision#,
		MON_FIJO_COMI = #montoFijoComision#,
		POR_COMI_RETI = #comisionRetirada#,
		USU_MODI = #nombreUsuario#,
		FEC_MODI = SYSDATE,
		POR_VENT_CONS = #porcentajeVentaConsultoras#,
		POR_COMI_RETL = #porcentajeComisionRetail#
 		WHERE OID_COMI =#oidComision# 
    </update>
    
    <select id="getCantCobranza"  parameterClass="java.util.Map" resultClass="integer">
    	SELECT COUNT(1) FROM COM_COMIS_COBRA WHERE COMI_OID_COMI = #oidComision#
    </select>
    
    <delete id="deleteZonasSubGerencia" parameterClass="java.util.Map">
    	DELETE COM_COMIS_CLIEN
		WHERE COMI_OID_COMI = #oidComision#
    </delete>
    
    <delete id="deleteDatosComisiones" parameterClass="java.util.Map">
    	DELETE COM_COMIS_COBRA_TIPO_PARTI
    	WHERE COCO_OID_COMI_COBR = #oidCobranza#
    </delete>
    
    <delete id="deleteDatosEscalonada" parameterClass="java.util.Map">
    	DELETE COM_COMIS_ESCAL
    	WHERE OID_COMI_COBR = #oidCobranza#
    </delete>
    
    <delete id="deleteDatosCobranza" parameterClass="java.util.Map">
    	DELETE COM_COMIS_COBRA
    	WHERE OID_COMI_COBR = #oidCobranza#
    </delete>
    
    <delete id="deleteComisionRecuperacion" parameterClass="java.util.Map">
    	DELETE COM_COMIS
    	WHERE OID_COMI = #oidComision#
    </delete>
    
    <select id="getCantComisionesCalculadasXRegion" resultClass="integer">
		SELECT COUNT(1) FROM COM_COMIS_PERIO_CALCU_REGIO WHERE COD_COMI = #codigoComision# 
	</select>
    
    <select id="getCantComisionesCalculadasxZona" resultClass="integer">
    	SELECT COUNT(1) FROM COM_COMIS_PERIO_CALCU_ZONA WHERE COD_COMI = #codigoComision#
    </select>
    
    <select id="getCantComisionesCalculadas" resultClass="integer">
    	SELECT COUNT(1) FROM COM_COMIS_PERIO_CALCU WHERE COD_COMI = #codigoComision#
    </select>
    
    <resultMap id="getMinimoNuevasListResult" class="java.util.HashMap">
		<result property="codigoRegion"             column="COD_REGI"/>  
		<result property="descripcionRegion"        column="DES_REGI"/>
		<result property="codigoZona"				column="COD_ZONA"/>
		<result property="cantidadMinimaNueva"      column="CAN_MINI_NUEV"/>
	</resultMap>
    
    <select id="getMinimoNuevasList" parameterClass="java.util.Map" resultMap="getMinimoNuevasListResult">
    	SELECT
    	zr.COD_REGI, 
    	zr.DES_REGI, 
    	(SELECT zz.COD_ZONA FROM ZON_ZONA zz WHERE zz.COD_ZONA = cmm.COD_ZONA) COD_ZONA, 
    	cmm.CAN_MINI_NUEV 
		FROM COM_MINIM_NUEVA cmm, ZON_REGIO zr 
		WHERE cmm.COD_REGI = zr.COD_REGI
		<isNotEmpty prepend="AND" property="codigoRegion">
			zr.COD_REGI = #codigoRegion#
		</isNotEmpty>
    </select>
    
    <select id="getMinimoNuevas" parameterClass="java.util.Map" resultClass="minimoNuevas">
    	SELECT COD_REGI codigoRegion, 
		       COD_ZONA codigoZona, 
		       CAN_MINI_NUEV cantidadMinima
				FROM COM_MINIM_NUEVA
				WHERE COD_REGI = #codigoRegion#
				<isEmpty prepend="AND" property="codigoZona">
					1 = 1
					AND COD_ZONA IS NULL
				</isEmpty>
				
				<isNotEmpty prepend="AND" property="codigoZona">
					COD_ZONA = #codigoZona#
				</isNotEmpty>
    </select>
    
    <insert id="insertMinimoNuevas" parameterClass="java.util.Map">
    	INSERT INTO COM_MINIM_NUEVA ( 
	    	COD_REGI, 
	    	COD_ZONA, 
	    	CAN_MINI_NUEV, 
	    	USU_MODI, 
	    	FEC_MODI
	    	)VALUES(
	    	#codigoRegion#,
	    	#codigoZona#,
	    	#cantidadMinima#,
	    	#usuarioLogin#,
	    	SYSDATE
	    	)
    </insert>
    
    <update id="updateMinimoNuevas" parameterClass="java.util.Map">
    	UPDATE COM_MINIM_NUEVA
		  SET 
		  CAN_MINI_NUEV = #cantidadMinima#, 
		  USU_MODI = #usuarioLogin#,
		  FEC_MODI = SYSDATE
		  WHERE COD_REGI = #codigoRegion#
			<isEmpty prepend="AND" property="codigoZona">
				1 = 1
				AND COD_ZONA IS NULL
			</isEmpty>
				
			<isNotEmpty prepend="AND" property="codigoZona">
				COD_ZONA = #codigoZona#
			</isNotEmpty>
    </update>
    
    <delete id="deleteMinimoNuevas" parameterClass="java.util.Map">
    	DELETE FROM COM_MINIM_NUEVA
  			WHERE COD_REGI = #codigoRegion#
			<isEmpty prepend="AND" property="codigoZona">
				1 = 1
				AND COD_ZONA IS NULL
			</isEmpty>
				
			<isNotEmpty prepend="AND" property="codigoZona">
				COD_ZONA = #codigoZona#
			</isNotEmpty>
    </delete>
    
    <resultMap id="getMinimoNuevasValidationResult" class="minimoNuevas">
		<result property="codigoRegion"             column="COD_REGI"/>  
		<result property="codigoZona"				column="COD_ZONA"/>
		<result property="cantidadMinima"      		column="CAN_MINI_NUEV"/>
		<result property="descripcionRegion"      	column="DES_REGI"/>
	</resultMap>

    <select id="getMinimoNuevasDuplicada" parameterClass="java.util.Map" resultMap="getMinimoNuevasValidationResult">
    	SELECT CMI.COD_REGI, CMI.COD_ZONA, CMI.CAN_MINI_NUEV, (SELECT zr.DES_REGI FROM ZON_REGIO zr WHERE zr.COD_REGI= CMI.COD_REGI) DES_REGI
             FROM COM_MINIM_NUEVA CMI
             WHERE CMI.COD_REGI =  #codigoRegion#
             AND CMI.COD_ZONA IS NULL
    </select>
    
    <select id="getValidarMinimoNuevasRegion" parameterClass="java.util.Map" resultMap="getMinimoNuevasValidationResult">
		SELECT CMI.COD_REGI, CMI.COD_ZONA, CMI.CAN_MINI_NUEV, (SELECT zr.DES_REGI FROM ZON_REGIO zr WHERE zr.COD_REGI= CMI.COD_REGI) DES_REGI
             FROM COM_MINIM_NUEVA CMI
             WHERE CMI.COD_REGI = #codigoRegion#
             AND CMI.COD_ZONA IS NOT NULL
    </select>
    
      <select id="getValidarMinimoNuevasZonas" parameterClass="java.util.Map" resultMap="getMinimoNuevasValidationResult">
		SELECT CMI.COD_REGI, CMI.COD_ZONA, CMI.CAN_MINI_NUEV, (SELECT zr.DES_REGI FROM ZON_REGIO zr WHERE zr.COD_REGI= CMI.COD_REGI) DES_REGI
             FROM COM_MINIM_NUEVA CMI
             WHERE CMI.COD_REGI = #codigoRegion#
             AND CMI.COD_ZONA = #codigoZona#
    </select>

  <resultMap id="baseResultCom" class="baseGenericoCom">
    	<result property="codigo" 		column="CODIGO" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>

 <select id="getBasesComision" parameterClass="java.util.Map" resultMap="baseResultCom">
		SELECT cb.cod_base AS codigo, cb.des_base AS descripcion
		  FROM com_tipos_comis_base ct, com_base_comi cb
		 WHERE ct.baco_cod_base = cb.cod_base
		   AND ct.tico_cod_tipo_comi = #codigoTipoComisionista#
		   AND ct.est_regi = 1		    			 
	</select>
	
	
   <resultMap id="paramComisionRegionList"     class="java.util.HashMap">    	
    	<result property="codPeriodo"			column="COD_PERI"/>
    	<result property="codRegion"		column="COD_REGI"/>
    	<result property="codEmpleado"			column="COD_EMPL"/>
    	<result property="montoEstimado"		column="MON_CATA_ESTI"/>
    	<result property="montoReal"			column="MON_CATA_REAL"/>
    	<result property="porcentajeVenta"		column="POR_MON_CATA"/>
    	<result property="porcentajeComision"			column="POR_COMI_TRA1"/>
    	<result property="valorComi"		column="IMP_MONT_COM1"/>
  </resultMap>
  
  <select id="getComisionRegionList" resultMap="paramComisionRegionList" parameterClass="java.util.Map">
  <![CDATA[	   
  		select r.COD_PERI, 
  			   R.COD_REGI, 
  			   a.COD_EMPL, 
  			   r.MON_CATA_ESTI, 
  			   r.MON_CATA_REAL, 
  			   r.POR_MON_CATA, 
  			   r.POR_COMI_TRA1, 
  			   r.IMP_MONT_COM1
          from com_comis_perio_calcu_regio r, 
               mae_clien m, 
               mae_clien_datos_adici a
         where m.OID_CLIE = a.CLIE_OID_CLIE
           and r.COD_LIDE_REGI = m.COD_CLIE
           and r.cod_peri >= #codigoPeriodoIni#
           and r.cod_peri < #codigoPeriodoFin#
           ]]>
           <isNotEmpty property="codigoComision">        
			<iterate prepend="AND" property="codigoComision" open="(" close=")" conjunction="OR">
            	r.cod_comi = #codigoComision[]#
			</iterate>  
    	  </isNotEmpty>   
  </select>
  
  <select id="getComisionCalcuRegionList" resultMap="paramComisionRegionList" parameterClass="java.util.Map">
  <![CDATA[	   
  		select r.COD_PERI, 
  			   R.COD_REGI, 
  			   NULL COD_EMPL,
  			   r.MON_CATA_ESTI, 
  			   r.MON_CATA_REAL, 
  			   r.POR_MON_CATA, 
  			   r.POR_COMI_TRA1, 
  			   r.IMP_MONT_COM1
          from com_comis_perio_calcu_regio r
          where 1=1
           ]]>
           <isNotEmpty property="codigoComision" prepend="and" >        
            	r.cod_comi = #codigoComision#
    	  </isNotEmpty>
    	  <isNotEmpty property="codigoComision" prepend="and">        
            	r.cod_peri = #codigoPeriodo#
    	  </isNotEmpty>      
  </select>
  
  <select id="getComisionVentaNetaEfectivaList" resultMap="baseResultCom" parameterClass="map">
		select DISTINCT 
		COD_COMI CODIGO,
		TIP_COMI DESCRIPCION
  		from COM_COMIS_PERIO_CALCU_ZONA 
	  	where 1=1
	    <isNotEmpty property="codigoComision" prepend="and" >        
	    	cod_comi = #codigoComision#
	    </isNotEmpty>
	    <isNotEmpty property="codigoComision" prepend="and">        
	    	peri_cod_peri = #codigoPeriodo#
	    </isNotEmpty>      
  </select>
  
  <select id="getComComisList" resultMap="baseResultCom" parameterClass="map">
		select DISTINCT 
		COD_COMI CODIGO,
		TIP_COMI DESCRIPCION
  		from COM_COMIS_ 
	  	where 1=1
	    <isNotEmpty property="codigoComision" prepend="and" >        
	    	cod_comi = #codigoComision#
	    </isNotEmpty>
	    <isNotEmpty property="codigoComision" prepend="and">        
	    	peri_cod_peri = #codigoPeriodo#
	    </isNotEmpty>      
  </select> 
	
	  <resultMap id="paramComArchivoNominaList"     class="java.util.HashMap">    	
   	<result property="codigoCompania"	column="codigoCompania"/>
   	<result property="codigoEmpleado"	column="cod_empl"/>
   	<result property="nombreEmpleado"	column="VAL_NOMBRE"/>
   	<result property="codigoIncRecup"	column="codigoIncRecup"/>
   	<result property="variable1"		column="variable1"/>
   	<result property="montoComision"	column="IMP_MONT_PAGO_COMI"/>
   	<result property="codigoCampana"	column="codCampana"/>
   	<result property="variable4"		column="variable4"/>
   	<result property="referencia1"		column="referencia1"/>
   	<result property="referencia2"		column="referencia2"/>
  </resultMap>


  <select id="getComArchivoNominaList" resultMap="paramComArchivoNominaList" parameterClass="java.util.Map">

  <isEqual compareValue="01" property="tipoComision">
 
  select #codigoCompania# codigoCompania, 
         b.cod_empl, 
         TRIM(A.VAL_APE1) ||' '||TRIM(A.VAL_APE2)||', '||TRIM(A.VAL_NOM1)||' '||TRIM(A.VAL_NOM2) VAL_NOMBRE,
         #codigoIncRecupRegion# codigoIncRecup , 
         '' variable1, 
         round(SUM(c.IMP_MONT_COM1),0) IMP_MONT_PAGO_COMI, 
         c.cod_peri codCampana, 
         '' variable4, 
         '' referencia1, 
         '' referencia2
	  from MAE_CLIEN a, MAE_CLIEN_DATOS_ADICI b, COM_COMIS_PERIO_CALCU_REGIO c
	where a.OID_CLIE = b.CLIE_OID_CLIE
	  and c.COD_LIDE_REGI = a.COD_CLIE
	  and c.COD_LIDE_REGI IS NOT NULL
	   <![CDATA[	
	  and c.cod_peri >= #codigoPeriodoInicial#
	  and c.cod_peri <= #codigoPeriodoFinal#
	  and c.IMP_MONT_COM1 > 0
	    ]]> 
	  <isNotEmpty property="codigoComision">        
		<iterate prepend="AND" property="codigoComision" open="(" close=")" conjunction="OR">
           	c.cod_comi = #codigoComision[]#
		</iterate>  
     </isNotEmpty>   
    GROUP BY  b.cod_empl, c.cod_peri, A.VAL_APE1 , A.VAL_APE2, A.VAL_NOM1, A.VAL_NOM2
	ORDER BY  b.cod_empl, c.cod_peri
	
  </isEqual>
  
  <isEqual compareValue="02" property="tipoComision">
 
   select #codigoCompania# codigoCompania, 
      b.cod_empl, 
      TRIM(A.VAL_APE1) ||' '||TRIM(A.VAL_APE2)||', '||TRIM(A.VAL_NOM1)||' '||TRIM(A.VAL_NOM2) VAL_NOMBRE,
      #codigoIncRecup# codigoIncRecup , 
      '' variable1, 
      round(SUM(c.IMP_COMI_TRA1),0) IMP_MONT_PAGO_COMI , 
      c.peri_cod_peri codCampana, 
      '' variable4, 
      '' referencia1, '' referencia2
	  from  MAE_CLIEN a, MAE_CLIEN_DATOS_ADICI b, COM_COMIS_PERIO_CALCU_ZONA c
	  where a.OID_CLIE = b.CLIE_OID_CLIE
	  and 	c.COD_LIDE_ZONA = a.COD_CLIE
	   <![CDATA[
	  and   c.peri_cod_peri >= #codigoPeriodoInicial#
	  and   c.peri_cod_peri <= #codigoPeriodoFinal#
	  and   c.IMP_COMI_TRA1 > 0
	    ]]>
	  <isNotEmpty property="codigoComision">        
		<iterate prepend="AND" property="codigoComision" open="(" close=")" conjunction="OR">
           	c.cod_comi = #codigoComision[]#
		</iterate>  
     </isNotEmpty>   
      GROUP BY  b.cod_empl, c.peri_cod_peri, A.VAL_APE1 , A.VAL_APE2, A.VAL_NOM1, A.VAL_NOM2
	  ORDER BY  b.cod_empl, c.peri_cod_peri
	
   </isEqual>
 
  
  
  </select>
  
  
  <resultMap id="paramComDatosAdam"     class="java.util.HashMap">    	
   	<result property="codigoPais"			column="COD_PAIS"/>
   	<result property="codigoCompania"		column="COD_COMP"/>
   	<result property="codigoIncRecup"		column="COD_INCI_RECU"/>
   	<result property="codigoIncRecupRegion"	column="COD_INCI_RECU_REGI"/>
   	<result property="codigoIncComer"		column="COD_INCI_COME"/>
  </resultMap>
  
  <select id="getComDatosAdam" resultMap="paramComDatosAdam" parameterClass="java.util.Map">
	  select COD_PAIS,
	  		 COD_COMP,
	  		 COD_INCI_RECU,
	  		 COD_INCI_COME,
	  		 COD_INCI_RECU_REGI
	  from COM_DATOS_ADAM 
	 where cod_pais = #codigoPais# 
  </select>
  
  <select id="getTipoClasificacionList" resultMap="baseResultCom">
		select TO_CHAR(mtc.OID_TIPO_CLAS) codigo, mtc.cod_tipo_clas || ' - ' ||nn.val_i18n descripcion
		from mae_tipo_clien mt, mae_subti_clien st, Mae_Tipo_Clasi_Clien mtc, GEN_I18N_SICC_COMUN  nn
		where mt.cod_tipo_clie = '02'
		and mt.oid_tipo_clie = st.ticl_oid_tipo_clie and st.cod_subt_clie = '04'
		and mtc.sbti_oid_subt_clie = st.oid_subt_clie
		and mtc.oid_tipo_clas = nn.val_oid
		and nn.attr_enti = 'MAE_TIPO_CLASI_CLIEN'
		ORDER BY mtc.cod_tipo_clas
  </select>
  
  <select id="getClasificacionComisionList" resultMap="baseResultCom" parameterClass="java.util.Map">
		select cla.cod_clas codigo , cla.cod_clas || ' - ' || nn.val_i18n descripcion
		from mae_tipo_clien mt, mae_subti_clien st, Mae_Tipo_Clasi_Clien mtc, mae_clasi cla, GEN_I18N_SICC_COMUN  nn
		where mt.cod_tipo_clie = '02'
		and mt.oid_tipo_clie = st.ticl_oid_tipo_clie and st.cod_subt_clie = '04'
		and mtc.sbti_oid_subt_clie = st.oid_subt_clie
		and cla.tccl_oid_tipo_clas = mtc.oid_tipo_clas
		and cla.oid_clas = nn.val_oid
		and nn.attr_enti = 'MAE_CLASI'
		and cla.tccl_oid_tipo_clas = #oidTipoClasificacion#
  </select>
  
  <resultMap id="paramgetClasificacionByCodigoComisionList" class="datosClasificacion">
	<result property="codigoComision" 			column="COD_COMI" />
	<result property="codigoTipoClasificacion" 	column="COD_TIPO_CLAS" />
	<result property="codigoClasificacion" 		column="COD_CLAS" />
	<result property="descripcionTipoClasificacion" 	column="DES_TIPO_CLAS" />
	<result property="descripcionClasificacion" 		column="DES_CLAS" />
	<result property="oidTipoClasificacion" 			column="OID_TIPO_CLAS" />
	<result property="oidListaClasificacion" 			column="OID_IDENT_CLASI" />
  </resultMap>
  
  <select id="getClasificacionByCodigoComisionList" resultMap="paramgetClasificacionByCodigoComisionList" 
  				parameterClass="java.util.Map" >
  				
	  	SELECT tcc.OID_TIPO_CLAS||'_'||clca.COD_CLAS OID_IDENT_CLASI, clca.COD_COMI, tcc.DES_TIPO_CLAS DES_TIPO_CLAS, tcap.descripcion DES_CLAS,
	           tcc.OID_TIPO_CLAS, clca.COD_TIPO_CLAS, clca.COD_CLAS FROM COM_CLASI_CLIEN clca,
	    (select TO_CHAR(mtc.OID_TIPO_CLAS) OID_TIPO_CLAS, mtc.cod_tipo_clas,  mtc.cod_tipo_clas || ' - ' ||nn.val_i18n DES_TIPO_CLAS
	        from mae_tipo_clien mt, mae_subti_clien st, Mae_Tipo_Clasi_Clien mtc, GEN_I18N_SICC_COMUN  nn
	        where mt.cod_tipo_clie = '02'
	        and mt.oid_tipo_clie = st.ticl_oid_tipo_clie and st.cod_subt_clie = '04'
	        and mtc.sbti_oid_subt_clie = st.oid_subt_clie
	        and mtc.oid_tipo_clas = nn.val_oid
	        and nn.attr_enti = 'MAE_TIPO_CLASI_CLIEN'
	        ORDER BY mtc.cod_tipo_clas) tcc,
	        (select clac.cod_clas codigo, clac.cod_clas || ' - ' || nnc.val_i18n descripcion, clac.tccl_oid_tipo_clas
			from mae_tipo_clien mtc, mae_subti_clien stc, Mae_Tipo_Clasi_Clien mtcc, mae_clasi clac, GEN_I18N_SICC_COMUN  nnc
			where mtc.cod_tipo_clie = '02'
			and mtc.oid_tipo_clie = stc.ticl_oid_tipo_clie and stc.cod_subt_clie = '04'
			and mtcc.sbti_oid_subt_clie = stc.oid_subt_clie
			and clac.tccl_oid_tipo_clas = mtcc.oid_tipo_clas
			and clac.oid_clas = nnc.val_oid
			and nnc.attr_enti = 'MAE_CLASI') tcap
		WHERE COD_COMI = #codigoComision#
	    AND tcc.OID_TIPO_CLAS = tcap.tccl_oid_tipo_clas
	    AND tcc.cod_tipo_clas = clca.COD_TIPO_CLAS
	    AND tcap.codigo = clca.COD_CLAS
  		
  </select>
  
  <delete id="deleteClasificacion" parameterClass="java.util.Map">
  	DELETE FROM COM_CLASI_CLIEN WHERE COD_COMI = #codigoComision#
  </delete>
  
  <insert id="insertClasificacion" parameterClass="datosClasificacion">
  	INSERT INTO COM_CLASI_CLIEN(
  	COD_COMI, 
  	COD_TIPO_CLAS, 
  	COD_CLAS, 
  	USU_CREA, 
  	FEC_CREA, 
  	EST_REGI 
  	)VALUES(
  	#codigoComision#,
  	#codigoTipoClasificacion#,
  	#codigoClasificacion#,
  	#codigoUsuario#,
  	SYSDATE,
  	#estado#
  	)
  </insert>
  
  <select id="getCodigoBaseComision" parameterClass="java.util.Map" resultClass="string"  >
	  SELECT C.COBA_COD_BASE
	      FROM com_comis c
	     WHERE C.COD_COMI = #codigoComision#
   </select>
   
  <resultMap id="getListaMostrarGerentesRetiradasResult" class="java.util.HashMap">
        <result property="nroRegistro"             column="NRO_REGI"/>
		<result property="codigoPais"              column="PAIS_COD_PAIS"/>  
		<result property="codigoRegion"            column="COD_REGI"/>
		<result property="codigoZona"              column="COD_ZONA"/>
		<result property="codigoCliente"           column="COD_CLIE"/>
		<result property="nombreCliente"           column="VAL_NOMB"/>
		<result property="fechaRegistro"           column="FEC_REGI"/>
		<result property="estado"                  column="VAL_ESTA"/>
	</resultMap>
  
  <select id="getListaMostrarGerentesRetiradas" parameterClass="java.util.Map" resultMap="getListaMostrarGerentesRetiradasResult"  >
	  SELECT TO_CHAR(ROWNUM - 1) NRO_REGI,
	       Y.PAIS_COD_PAIS, 
	       Y.COD_REGI, 
	       Y.COD_ZONA, 
	       Y.COD_CLIE, 
	       TRIM(M.VAL_NOM1) || ' ' || TRIM(M.VAL_APE1) || ' ' || TRIM(M.VAL_APE2) VAL_NOMB,
	       TO_CHAR(X.FEC_REGI, 'DD/MM/YYYY') FEC_REGI, 
	       COM_PKG_REPOR.COM_FN_DEVUE_REGIS_CALCU_BAS07(X.CAM_PROC, #codigoTipoCargo#, #codigoComision#, Y.COD_CLIE) VAL_ESTA
		FROM
		  ZON_DIREC_VENTA_CABEC X,
		  ZON_DIREC_VENTA_DETAL Y,
		  MAE_CLIEN M
		WHERE X.PAIS_COD_PAIS = #codigoPais#
		  AND X.CAM_PROC = #codigoPeriodo#
		  AND X.TIOP_COD_TIPO_OPER = 'RE'
		  AND X.TICA_COD_TIPO_CARG = #codigoTipoCargo#
		  AND X.IND_ESTA  = 'A'
		  AND X.EST_REGI = '1'
		  
		  AND Y.PAIS_COD_PAIS = X.PAIS_COD_PAIS
		  AND Y.TIOP_COD_TIPO_OPER = X.TIOP_COD_TIPO_OPER
		  AND Y.TICA_COD_TIPO_CARG = X.TICA_COD_TIPO_CARG
		  AND Y.COD_CLIE = X.COD_CLIE
		  AND Y.DICA_FEC_REGI = X.FEC_REGI
		  AND Y.DICA_CAM_PROC = X.CAM_PROC
		  AND Y.DICA_COR_DIRE_VENT = Y.DICA_COR_DIRE_VENT
		  AND Y.EST_REGI = '1'
		  
		  AND M.COD_CLIE = Y.COD_CLIE
   </select> 
  
</sqlMap>