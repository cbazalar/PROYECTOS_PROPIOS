<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.incentivos.MantenimientoINCSQL">
 
   <typeAlias alias="baseEstadoInc" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
   <typeAlias alias="cargaPuntaje" type="biz.belcorp.ssicc.dao.spusicc.inc.model.CargaPuntaje"/>		
   <typeAlias alias="bonoPremioPago" type="biz.belcorp.ssicc.dao.spusicc.inc.model.BonoPremioPago"/>		
 	
   <typeAlias alias="concursoParametrosGenerales" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoParametrosGenerales"/>	
   <typeAlias alias="concursoVersion" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoVersion"/>   
   <typeAlias alias="concursoObtencionPuntos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoObtencionPuntos"/>   
   <typeAlias alias="concursoDespachoPremios" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoDespachoPremios"/>   
   <typeAlias alias="concursoAmbitoGeografico" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoAmbitoGeografico"/>   
   <typeAlias alias="concursoParametrosConsultoras" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoParametrosConsultoras"/>
   <typeAlias alias="concursoMontoVentas" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoMontoVentas"/>   
   <typeAlias alias="concursoEstatusVenta" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoEstatusVenta"/>
   <typeAlias alias="concursoClasificacionParticipante" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoClasificacionParticipante"/>
   <typeAlias alias="concursoRequisitoPremiacion" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoRequisitoPremiacion"/>
   <typeAlias alias="concursoParametrosPremiacion" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoParametrosPremiacion"/>
   <typeAlias alias="concursoNivelPremiacion" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoNivelPremiacion"/>
   <typeAlias alias="concursoPremioArticulo" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoPremioArticulo"/>
   <typeAlias alias="concursoLotePremioArticulo" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoLotePremioArticulo"/>
   <typeAlias alias="concursoArticuloLote" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoArticuloLote"/>
   <typeAlias alias="concursoProductos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoProductos"/>
   <typeAlias alias="concursoProductosValidos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoProductosValidos"/>
   <typeAlias alias="concursoProductosBonificados" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoProductosBonificados"/>
   <typeAlias alias="concursoProductosExcluidos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoProductosExcluidos"/>
   <typeAlias alias="concursoProductosExigidos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoProductosExigidos"/>
   <typeAlias alias="concursoRecomendadaPeriodo" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoRecomendadaPeriodo"/>
   <typeAlias alias="concursoBonificacionPeriodo" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoBonificacionPeriodo"/>
   <typeAlias alias="concursoPeriodoDespacho" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoPeriodoDespacho"/>  
   <typeAlias alias="concursoPuntajeExigido" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoPuntajeExigido"/>   
   <typeAlias alias="procesarINCConfiguracionConcursoCuponElectronico" type="biz.belcorp.ssicc.dao.model.ProcesarINCConfiguracionConcursoCuponElectronico"/>
   <typeAlias alias="constanciaProgramaPuntos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConstanciaProgramaPuntos"/>      
   <typeAlias alias="rangoConstanciaProgramaPuntos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.RangoConstanciaProgramaPuntos"/> 
   <typeAlias alias="clasificacionParaINC" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ClasificacionParaINC"/>
   <typeAlias alias="clasificacionParaINCDetalle" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ClasificacionParaINCDetalle"/>
   <typeAlias alias="baseOidIncentivo" type="biz.belcorp.ssicc.dao.sisicc.model.BaseOID"/>
   <typeAlias alias="nuevaConstanciaProgramaPuntos" type="biz.belcorp.ssicc.dao.spusicc.inc.model.NuevaConstanciaProgramaPuntos"/>
        
    <typeAlias alias="concursoArticuloLoteDescuento" type="biz.belcorp.ssicc.dao.spusicc.inc.model.ConcursoArticuloLoteDescuento"/>	  	
   
   <resultMap id="baseResult" class="baseEstadoInc">
      <result property="codigo" 		column="CODIGO" 	/>
      <result property="descripcion" 	column="DESCRIPCION"/>
   </resultMap>
   
   <resultMap id="baseOidIncentivoResult" class="baseOidIncentivo">
      <result property="oid" 		column="OID" 	/>
      <result property="descripcion" 	column="DESCRIPCION"/>
   </resultMap>
 
	<resultMap id="baseResultOid" class="java.util.HashMap">
	    <result property="oid" 					column="OID"  javaType="java.lang.String"/>
	    <result property="codigo" 		  		column="CODIGO"/>
	    <result property="descripcion"		    column="DESCRIPCION"/>
    </resultMap>   

	<resultMap id="constanciaProgramaPuntosMapResult" class="constanciaProgramaPuntos">
		<result property="codigoPais" column="PAIS_COD_PAIS"/> 
		<result property="codigo" column="COD_PROG_CONS"/> 
		<result property="campanyaInicio" column="CAM_INIC"/>
		<result property="campanyaFin" column="CAM_FINA"/>
		<result property="codigoMultiPunto" column="COD_PROG_PUNT"/> 
		<result property="montoMinimo" column="VAL_MONT_MINI"/>
		<result property="indicadorActivo" column="IND_ACTI"/>
		<result property="evaluacionPrograma" column="COD_TIPO_EVAL"/>
		<result property="campanyaMaxima" column="IND_INIC_MAXC"/>		
    </resultMap>

	<resultMap id="rangoConstanciaProgramaPuntosMapResult" class="rangoConstanciaProgramaPuntos">
		<result property="codigoPais" column="PAIS_COD_PAIS"/> 
		<result property="codigoProgramaConstancia" column="COD_PROG_CONS"/> 
		<result property="rangoFinal" column="VAL_RANG_FINA"/>
		<result property="puntosAbono" column="NUM_PUNT_ABON"/>
		<result property="puntosAbono" column="NUM_PUNT_ABON"/>
		<result property="factorMultiplicador" column="FAC_MULT"/>
    </resultMap>
    
    <resultMap id="nuevaConstanciaProgramaPuntosMapResult" class="nuevaConstanciaProgramaPuntos">
		<result property="codigoPais" column="PAIS_COD_PAIS"/> 
		<result property="codigoProgramaConstancia" column="COD_PROG_CONS"/> 
		<result property="periodosExigidos" column="NUM_CAMP_EXIG"/>
		<result property="pedidosExigidos" column="NUM_PEDI_EXIG"/>
		<result property="puntosAbonar" column="NUM_PUNT_ABON"/>
    </resultMap>
    
    
    <resultMap id="clasificacionParaINCResult" class="clasificacionParaINC">
		<result property="oidPais" column="PAIS_OID_PAIS"/> 
		<result property="secuencial" column="OID_PART_CONC_CABE"/> 
		<result property="valorGrupoCliente" column="VAL_GRUP_CLIE"/>
		<result property="descripcion" column="DES_DESC"/>
		<result property="oidDestinatario" column="DIRI_OID_DIRI"/> 
    </resultMap>
    
    <resultMap id="clasificacionParaINCDetalleResult" class="clasificacionParaINCDetalle">
		<result property="secuencialDetalle" column="OID_PART_CONC_DETA"/> 
		<result property="secuencialCabecera" column="PACI_OID_PART_CONC_CABE"/> 
		<result property="oidSubtipocliente" column="SBTI_OID_SUBT_CLIE"/>
		<result property="oidTipocliente" column="TICL_OID_TIPO_CLIE"/>
		<result property="oidTipoClasificacion" column="TCCL_OID_TIPO_CLAS"/> 
		<result property="oidClasificacion" column="CLAS_OID_CLAS"/> 
		<result property="codigoSubtipocliente" column="COD_SUBT_CLIE"/> 
		<result property="codigoTipocliente" column="COD_TIPO_CLIE"/> 
		<result property="codigoTipoClasificacion" column="COD_TIPO_CLAS"/> 
		<result property="codigoClasificacion" column="COD_CLAS"/> 
		<result property="descripcionSubtipocliente" column="DES_SUBT_CLIE"/> 
		<result property="descripcionTipocliente" column="DES_TIPO_CLIE"/> 
		<result property="descripcionTipoClasificacion" column="DES_TIPO_CLAS"/> 
		<result property="descripcionClasificacion" column="DES_CLAS"/> 
		<result property="descripcion" column="DES_DESC"/> 
    </resultMap>

    <select id="getListParametrosConcursosActivos" resultMap="baseResult">
			SELECT DISTINCT X.OID_PARA_GRAL CODIGO,
				 X.NUM_CONC ||' - ' || X.VAL_NOMB DESCRIPCION,
				 X.NUM_CONC
			FROM INC_CONCU_PARAM_GENER X
			WHERE  X.IND_ACTI = '1'
				AND X.OID_PARA_GRAL NOT IN (
  	  					SELECT Y.COPA_OID_PARA_GRAL
	  					FROM INC_CONCU_CARGA_PUNTA Y )
			ORDER BY 3	
	</select>

    
    <select id="getListConcursoHabilitado" resultMap="baseResult">
            SELECT X.NUM_CONC CODIGO, 
                    X.NUM_CONC ||' - ' || X.VAL_NOMB DESCRIPCION
            FROM INC_CONCU_PARAM_GENER X
            WHERE X.IND_ACTI = '1'
            ORDER BY 1    
	</select>
	
	 <select id="getListConcursoCyzo" resultMap="baseResult">
			SELECT DISTINCT X.NUM_CONC CODIGO, 
					X.NUM_CONC ||' - ' || X.VAL_NOMB DESCRIPCION
			FROM INC_CONCU_PARAM_GENER X
			WHERE X.IND_DUPL_CYZO = '1'
			ORDER BY 2
	</select>
	
	<select id="getListConcursoReconocido" resultMap="baseResult">
			SELECT DISTINCT X.NUM_CONC CODIGO, 
					X.NUM_CONC ||' - ' || X.VAL_NOMB DESCRIPCION
			FROM INC_CONCU_PARAM_GENER X
			WHERE X.CCON_OID_CLAS_CONC = '6'
			ORDER BY 2
	</select>
	
   
    <delete id="deleteCargaPuntaje" parameterClass="string">
					DELETE FROM INC_CONCU_CARGA_PUNTA
					WHERE  COPA_OID_PARA_GRAL      = #value#															
	</delete>   
   
     <insert id="insertCargaPuntaje" parameterClass="cargaPuntaje">
    	insert into INC_CONCU_CARGA_PUNTA(COPA_OID_PARA_GRAL, 							
									FEC_HABI ,
									COD_USUR 
								   )
							VALUES (#oid#,
							        SYSDATE,
									#codigoUsuario#									
								   )
    </insert>
    
    
     <select id="getListMotivoConcursos" resultMap="baseResult">
			SELECT  COD_MOTI_CARG_PUNT CODIGO, 
					DES_MOTI_CARG_PUNT DESCRIPCION
			FROM INC_MOTIV_CARGA_PUNTA 
			WHERE IND_ACTI='1'
			ORDER BY 2	
	</select>
	
	   
    <delete id="deleteConcursoHabilitado" parameterClass="string">
					DELETE FROM INC_CONCU_CARGA_PUNTA												
	</delete>  
    
       <select id="getListParametrosConcursosElectivos" resultMap="baseResult">
				SELECT DISTINCT A.OID_PARA_GRAL CODIGO,
					A.NUM_CONC ||' - ' || A.VAL_NOMB DESCRIPCION,
				 	A.NUM_CONC
				FROM INC_CONCU_PARAM_GENER A,INC_VERSI_CONCU B,INC_PARAM_GENER_PREMI C
				WHERE A.OID_PARA_GRAL = B.COPA_OID_PARA_GRAL
				 AND C.COPA_OID_PARA_GRAL = A.OID_PARA_GRAL 
				 AND A.IND_ACTI='1'
				 AND C.IND_PREM_ELEC = '1'	  					
				ORDER BY 3	
	</select>
	
	  <parameterMap id="executeValidacionesPremiosElectivosParams" class="java.util.Map">														
    	<parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="oidConcurso"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
	  	<parameter property="codigoConsultora"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	  	<parameter property="tipo"      			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>  	
	  	<parameter property="mensajeError"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	  	<parameter property="mensajeResultado"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	 </parameterMap>
  														
  	<procedure id="executeValidacionesPremiosElectivos" parameterMap="executeValidacionesPremiosElectivosParams">														
			{call INC_PKG_PROCE_INCEN.INC_PR_VALID_PREMI_ELECT(?,?,?,?,?,?)}											
	</procedure>
	
    <delete id="deletePremiosElectivos" parameterClass="java.util.Map">
			DELETE FROM INC_PREMI_ELEGI A
			WHERE A.CLIE_OID_CLIE =#oidCliente#
 			AND A.COPA_OID_PARA_GRAL =#oidConcurso#		
 			AND A.IND_PEND='1'													
	</delete> 
	
    <insert id="insertPremioElectivo" parameterClass="java.util.Map">
    	INSERT INTO INC_PREMI_ELEGI(
		   OID_PREM_ELEG, NUM_PREM, CLIE_OID_CLIE, 
		   COPA_OID_PARA_GRAL, PANP_OID_PARA_NIVE_PREM, FEC_SIST, 
		   IND_PEND,USU_CREA, PERD_OID_PERI, TIP_RECE) 
		VALUES (INC_PREL_SEQ.NEXTVAL,#numPremio#,#oidCliente#,
    			#oidConcurso#,#oidNivel#,SYSDATE ,'1',
    			#codigoUsuario#, GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#), #tipoRecepcion#)
    </insert>	
    
   <resultMap id="premioElectivosResult" class="java.util.HashMap">
      <result property="oidConcurso" 			column="OID_PARA_GRAL" 	/>
      <result property="numNivel" 				column="NUM_NIVE"/>
      <result property="numPremio" 				column="NUM_PREM" 	/>
      <result property="codigoVentaFicticio" 	column="COD_VENT_FICT"/>
      <result property="oidProducto" 			column="OID_PROD" 	/>
      <result property="descripcionProducto" 	column="DES_PROD"/>
      <result property="costoPuntos" 			column="VAL_COST_PUNT" 	/>
      <result property="numUnidades" 			column="NUM_UNID"/>
      <result property="indicadorPendiente" 	column="IND_PEND" 	/>
      <result property="tipoPremio" 			column="OID_TIPO_PION"/>
      <result property="indicadorPremioAcum" 	column="IND_PREM_ACUM" 	/>
      <result property="oidCliente" 			column="OID_CLIE"/>      
      <result property="oidNivel" 				column="OID_PARA_NIVE_PREM"/>
      <result property="indicadorElegido" 		column="IND_ELEG"/> 
      <result property="oidLotePremioArticulo"  column="OID_LOTE_PREM_ARTI"/>
      <result property="indicadorElegido" 		column="IND_ELEG"/> 
      <result property="indicadorAnulado" 		column="IND_ANUL"/>
      <result property="menorCodVenta" 		    column="COD_VENT_AUXI"/>
      <result property="indicadorNivelDiferido" column="IND_NIVE_DIFE"/>
      <result property="indicadorValido" 		column="IND_VALI"/>
   </resultMap>
 
   <select id="getPremiosElectivos" resultMap="premioElectivosResult">
   		SELECT A.*, 
			   '0' IND_VALI
   		FROM INC_GTT_PREMI_ELECT A
   		ORDER BY A.NUM_NIVE,A.NUM_PREM
   </select>

    <select id="getListConcursosActivosObs" parameterClass="string" resultMap="baseResult">
			SELECT DISTINCT c.NUM_CONC CODIGO,
			       c.NUM_CONC||' - '||c.VAL_NOMB DESCRIPCION,
			       c.NUM_CONC
			FROM inc_concu_param_gener c, 
			     inc_versi_concu v
			WHERE UPPER(c.val_obse) = UPPER(#value#)
			AND c.num_conc = v.num_conc
			AND (c.ind_acti = 1 OR (c.ind_acti = 0 AND v.vico_oid_vige_conc = 6))
			ORDER BY 3	
	</select>           
	
	<select id="getListConcursosVigentesCerrados" resultMap="baseResult">
			SELECT DISTINCT
			  CPG.OID_PARA_GRAL CODIGO,
			  CPG.NUM_CONC ||' - ' || CPG.VAL_NOMB DESCRIPCION,
			  CPG.NUM_CONC
			FROM
			    INC_CONCU_PARAM_GENER CPG
			    ,INC_VERSI_CONCU VC
			WHERE CPG.OID_PARA_GRAL =VC.COPA_OID_PARA_GRAL
				 AND ((IND_ACTI =1 AND VC.VICO_OID_VIGE_CONC =1)
			      OR(IND_ACTI =0 AND VC.VICO_OID_VIGE_CONC =6))  
			ORDER BY 3	
	</select>
	
<select id="getListConcursosVigentesCerradosGanadoras" resultMap="baseResult">
			SELECT DISTINCT 
			       CPG.OID_PARA_GRAL CODIGO,
			       CPG.NUM_CONC || ' - ' || CPG.VAL_NOMB DESCRIPCION,
			       CPG.NUM_CONC
			FROM 
			    INC_CONCU_PARAM_GENER CPG, 
			    INC_VERSI_CONCU VC
			WHERE CPG.OID_PARA_GRAL = VC.COPA_OID_PARA_GRAL
			   AND (IND_ACTI = 1  OR (IND_ACTI = 0 AND VC.VICO_OID_VIGE_CONC = 6))
			ORDER BY 3
	</select>
	

   <resultMap id="codigoVentasFicticioResult" class="java.util.HashMap">
	  <result property="oidProducto" 			column="OID_PROD"/>
	  <result property="descripcionProducto" 	column="DES_PROD"/>
	  <result property="numUnidades" 			column="NUM_UNID"/>
      <result property="codigoVentaFicticio" 	column="COD_VENT_FICT"/>
   </resultMap>
 
   <select id="getListCodigoVentas" resultMap="codigoVentasFicticioResult">
	  	  SELECT (select a.COD_SAP
				  from MAE_PRODU a
				  where  a.OID_PROD = X.PROD_OID_PROD) OID_PROD,
                 PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,X.PROD_OID_PROD, 'MAE_PRODU') DES_PROD,
                 X.NUM_UNID,
                 X.COD_VENT_FICT
            FROM INC_ARTIC_LOTE X
            WHERE X.LOPA_OID_LOTE_PREM_ARTI = #oidLotePremioArticulo#
   			ORDER BY 2
   </select>
	
	
	<select id="getLongitudCodVentaFicticio" resultClass="string" parameterClass="string" >
		SELECT LENGTH(NUM_RANGO_DESDE)
		FROM INC_CONTA_PREMI_ARTIC
		WHERE PAIS_OID_PAIS = gen_pkg_gener.gen_fn_devuelve_id_pais(#value#)
   </select>
	
	 <insert id="insertPremioElectivoInvalido" parameterClass="java.util.Map">
    	INSERT INTO INC_PREMI_DIGIT_INVAL(
		   COD_CLIE,
		   COD_CONC,
		   COD_VENT_FICT,
		   FEC_DIGI,
		   NUM_UNID,
		   NUM_PUNT_DISP,
		   NUM_PUNT_PREM,
		   COD_MOTI_INVA,
		   COD_USUA,
		   CLIE_OID_CLIE,
		   COPA_OID_PARA_GRAL,
		   PANP_OID_PARA_NIVE_PREM,
		   NUM_PREM,
		   COD_PERI ) 
		VALUES (
			#codigoCliente#,
			(SELECT A.NUM_CONC FROM INC_CONCU_PARAM_GENER A WHERE A.OID_PARA_GRAL=#oidConcurso#),
			#codigoVentaFicticio#,
			SYSDATE,
			#numUnidades#,
			#puntajeDisponible#,
			#costoPuntos#,
			'8',
			#codigoUsuario#,
			#oidCliente#,
    		#oidConcurso#,
			#oidNivel#,
			#numPremio#,
			#codigoPeriodo#)
    </insert>
	
	<select id="getListConcursoDespachoDiferido" resultMap="baseResult">
		SELECT c.num_conc CODIGO, c.num_conc || ' ' || c.val_nomb DESCRIPCION
		  FROM inc_concu_param_gener c, inc_param_gener_premi p
		 WHERE c.oid_para_gral = p.copa_oid_para_gral
		   AND p.tprm_oid_tipo_pion = 2
		   AND p.ind_prem_elec = 1
		   AND p.ind_nive_rota = 0
		   <![CDATA[  AND p.num_nive > 1   ]]>
		   AND p.perd_oid_peri IS NOT NULL
		   AND p.oid_para_gene_prem IN (
		          SELECT n.pagp_oid_para_gene_prem
		            FROM inc_param_nivel_premi n
		           WHERE n.pagp_oid_para_gene_prem = p.oid_para_gene_prem
		             AND n.val_nive_sele = 1)
		ORDER BY 2
	</select>

	<select id="getNivelesConcurso" resultMap="baseResult">
		SELECT n.num_nive CODIGO, 'Nivel ' || n.num_nive DESCRIPCION
		  FROM inc_concu_param_gener c,
		       inc_param_gener_premi p,
		       inc_param_nivel_premi n
		 WHERE c.num_conc = #numeroConcurso#
		   AND c.oid_para_gral = p.copa_oid_para_gral
		   AND n.pagp_oid_para_gene_prem = p.oid_para_gene_prem
		   AND n.val_nive_sele = 1
		 ORDER BY n.num_nive ASC
 	</select>
	
	 <insert id="insertNivelDespachoDiferido" parameterClass="java.util.Map">
    	INSERT INTO INC_NIVEL_DESPA_DIFER(
		   COD_PAIS,
		   NUM_CONC,
		   NUM_NIVE,
		   COD_PERI_INIC,
		   FEC_ULTI_ACTU) 
		VALUES (
			#codigoPais#,
			#numeroConcurso#,
			#nivel#,
			#codigoPeriodo#,
			SYSDATE)
    </insert>

	 <update id="updateNivelDespachoDiferido" parameterClass="java.util.Map">
    	UPDATE INC_NIVEL_DESPA_DIFER
 	       SET COD_PERI_INIC = #codigoPeriodo#,
		       FEC_ULTI_ACTU = SYSDATE 
		 WHERE COD_PAIS = #codigoPais#
		   AND NUM_CONC = #numeroConcurso#
		   AND NUM_NIVE = #nivel#
    </update>

	<delete id="deleteNivelDespachoDiferido" parameterClass="java.util.Map">
    	DELETE FROM INC_NIVEL_DESPA_DIFER
		 WHERE COD_PAIS = #codigoPais#
		   AND NUM_CONC = #numeroConcurso#
		   AND NUM_NIVE = #nivel#
    </delete>
	
	<resultMap id="periodoNivelDespachoDiferidoResult" class="java.util.HashMap">
	    <result property="periodoInicial" 				column="COD_PERI_INIC"/>
	    <result property="indicadorHabilitado"   		column="IND_HABI"/>
	    <result property="periodoDespacho"			    column="COD_PERI_DESP"/>
	    <result property="periodoDespachoSiguiente"		column="COD_PERI_SIGU"/>
    </resultMap>
	
	<select id="getPeriodoNivelDespachoDiferido" parameterClass="java.util.Map" resultMap="periodoNivelDespachoDiferidoResult">
		SELECT (SELECT COD_PERI_INIC
		          FROM INC_NIVEL_DESPA_DIFER
		         WHERE COD_PAIS = #codigoPais#
		           AND NUM_CONC = #numeroConcurso#
		           AND NUM_NIVE = #nivel#
		       ) COD_PERI_INIC,
		       (CASE WHEN TRUNC(SYSDATE) >= TRUNC(C.FEC_INIC) THEN 0
		             ELSE 1
		        END) IND_HABI,
		       P.COD_PERI COD_PERI_DESP,
		       (SELECT MIN(D.COD_PERI)
		  		  FROM cra_perio A, cra_perio B, SEG_PERIO_CORPO D
		   		 WHERE A.oid_peri = C.OID_PERI
		          AND B.pais_oid_pais = A.pais_oid_pais
		          AND B.marc_oid_marc = A.marc_oid_marc
		          AND B.cana_oid_cana = A.cana_oid_cana
		          AND B.fec_inic > A.fec_inic
		          AND D.OID_PERI = B.PERI_OID_PERI
		          ) COD_PERI_SIGU
		  FROM (SELECT p.PERD_OID_PERI
		          FROM INC_CONCU_PARAM_GENER g, INC_PARAM_GENER_PREMI p 
		         WHERE g.OID_PARA_GRAL = p.COPA_OID_PARA_GRAL
		           AND g.NUM_CONC = #numeroConcurso#
		       ) X,
		       CRA_PERIO C,
		       SEG_PERIO_CORPO P
		WHERE X.PERD_OID_PERI = C.OID_PERI
		  AND C.PERI_OID_PERI = P.OID_PERI           
 	</select>

	<select id="getExistePeriodoNivelDespachoDiferido" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)
          FROM INC_NIVEL_DESPA_DIFER
         WHERE COD_PAIS = #codigoPais#
           AND NUM_CONC = #numeroConcurso#
           AND NUM_NIVE = #nivel#
 	</select>
 		
    <select id="getListParametrosConcursosElectivosDiferido" resultMap="baseResult">
		SELECT DISTINCT A.OID_PARA_GRAL CODIGO,
			A.NUM_CONC ||' - ' || A.VAL_NOMB DESCRIPCION,
		 	A.NUM_CONC
		FROM INC_CONCU_PARAM_GENER A,INC_VERSI_CONCU B,INC_PARAM_GENER_PREMI C
		WHERE A.OID_PARA_GRAL = B.COPA_OID_PARA_GRAL
		 AND C.COPA_OID_PARA_GRAL = A.OID_PARA_GRAL 
		 AND A.IND_ACTI='1'
		 AND C.IND_PREM_ELEC = '1'	  					
         
        UNION 
        
		SELECT DISTINCT D.OID_PARA_GRAL CODIGO,
				D.NUM_CONC ||' - ' || D.VAL_NOMB DESCRIPCION,
			 	D.NUM_CONC
		FROM INC_CONCU_PARAM_GENER D, INC_NIVEL_DESPA_DIFER F
		WHERE D.NUM_CONC = F.NUM_CONC
          AND F.COD_PERI_INIC = (SELECT COD_PERI
                                   FROM (SELECT S.COD_PERI
                                           FROM CRA_PERIO G, SEG_PERIO_CORPO S
 								                                            
                                <![CDATA[ WHERE G.FEC_FINA >= TRUNC(SYSDATE)  
                                            AND G.FEC_INIC <= TRUNC(SYSDATE)  ]]>
 								                                             
                                            AND G.PERI_OID_PERI = S.OID_PERI
                                          ORDER BY S.COD_PERI        
                                        )
                                 WHERE ROWNUM=1  )

		ORDER BY 3	
	</select>
 		
    <delete id="deleteCargaPremiosElectivos" parameterClass="java.util.Map">
		DELETE FROM INC_TMP_PREMI_ELECT
	</delete>   
   
    <insert id="insertCargaPremiosElectivos" parameterClass="java.util.Map">
	   INSERT INTO INC_TMP_PREMI_ELECT
         (NUM_FILA,
		  COD_CLIE,
		  NUM_CONC,
 		  COD_VENT,
		  NUM_UNID,
		  COD_USUA,
		  FEC_ULTI_ACTU)
	   VALUES
	     (#fila#,
	      #0#,
	      #numeroConcurso#,
	      #1#,
	      #2#,
	      #codigoUsuario#,
	      SYSDATE)
   </insert>
    
    <parameterMap id="executeCargaPremiosElectivosParams" class="map">
    	<parameter property="codigoPais" 			jdbcType="VARCHAR" mode="IN"/>
        <parameter property="numeroConcurso" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoUsuario" 		jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeCargaPremiosElectivos" parameterMap="executeCargaPremiosElectivosParams">
        {call INC_PKG_PROCE_INCEN.INC_PR_CARGA_PREMI_ELECT(?, ?, ?)}
    </procedure>    
 	
 	<select id="getIndicadorProdExig" parameterClass="java.lang.Integer" resultClass="java.lang.Integer">
 		select ind_prod_exig
		from inc_concu_param_gener, 
		     inc_plant_concu
		where plc2_oid_plan_conc = oid_plan_conc
		and oid_para_gral = #value# 
		and  ind_prod_exig = 1 		
 	</select>
 	
    <select id="getConcursosBloqueoPremios" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT COPA.NUM_CONC CODIGO, COPA.NUM_CONC || ' - ' || COPA.VAL_NOMB DESCRIPCION
		  FROM INC_CONCU_PARAM_GENER COPA,
		       INC_VERSI_CONCU       VECO,
		       INC_PARAM_GENER_PREMI PAGP,
		       SEG_PERIO_CORPO COR,
		       CRA_PERIO PER
		 WHERE COPA.OID_PARA_GRAL = PAGP.COPA_OID_PARA_GRAL
		   AND COPA.IND_ACTI = 1
		   AND COPA.OID_PARA_GRAL = VECO.COPA_OID_PARA_GRAL
		   AND VECO.VICO_OID_VIGE_CONC = 1
		   AND COR.COD_PERI = #codigoPeriodo#
		   AND PER.PERI_OID_PERI = COR.OID_PERI
		   AND (CASE WHEN PAGP.PERD_OID_PERI_INIC IS NULL THEN PAGP.PERD_OID_PERI ELSE
		        PAGP.PERD_OID_PERI_INIC END) >= PER.OID_PERI
		        
	   	<![CDATA[		        
		   AND PAGP.PERD_OID_PERI <= PER.OID_PERI
	    ]]>		   
	    		   
	   <isNotEmpty property="regiones">
	    	AND INC_PKG_PROCE_INCEN.INC_FN_VALID_AMBIT_GEOGR_BLOQU(COPA.OID_PARA_GRAL, #regiones#) = 1
	   </isNotEmpty>
	    		   
		 ORDER BY CODIGO	
	</select>
	 	
	<select id="getPremiosxConcurso" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT MPR.COD_SAP || '__' || ALO.COD_VENT_FICT || '__' ||
		       (SELECT COUNT(1)
		          FROM INC_REEMP_ARTIC_LOTE REE
		         WHERE REE.ARLO_OID_ARTI_LOTE = ALO.OID_ARTI_LOTE) CODIGO,
		       MPR.COD_SAP || ' - ' || GPR.VAL_I18N DESCRIPCION
		  FROM INC_CONCU_PARAM_GENER CPG,
		       INC_VERSI_CONCU VCO,
		       INC_PARAM_GENER_PREMI PGP,
		       INC_PARAM_NIVEL_PREMI PNP,
		       INC_PREMI_ARTIC PAR,
		       INC_LOTE_PREMI_ARTIC LPA,
		       INC_ARTIC_LOTE ALO,
		       MAE_PRODU MPR,
		       (SELECT *
		          FROM GEN_I18N_SICC_PAIS
		         WHERE ATTR_ENTI = 'MAE_PRODU') GPR
		 WHERE PGP.COPA_OID_PARA_GRAL = CPG.OID_PARA_GRAL
		   AND CPG.NUM_CONC = #codigoConcurso#
		   AND CPG.IND_ACTI = 1  
		   AND VCO.VICO_OID_VIGE_CONC IN (1, 2, 6) 
		   AND VCO.COPA_OID_PARA_GRAL_ORIG(+) = CPG.OID_PARA_GRAL
		   AND PNP.PAGP_OID_PARA_GENE_PREM(+) = PGP.OID_PARA_GENE_PREM
		   AND PAR.PANP_OID_PARA_NIVE_PREM(+) = PNP.OID_PARA_NIVE_PREM
		   AND LPA.PRAR_OID_PREM_ARTI(+) = PAR.OID_PREM_ARTI
		   AND ALO.LOPA_OID_LOTE_PREM_ARTI(+) = LPA.OID_LOTE_PREM_ARTI
		   AND MPR.OID_PROD(+) = ALO.PROD_OID_PROD
		   AND GPR.VAL_OID(+) = ALO.PROD_OID_PROD
		 ORDER BY MPR.COD_SAP	
	</select>
	
	<select id="getRegionesBloqueoPremios" resultMap="baseResult">
		SELECT COD_REGI CODIGO, DES_REGI DESCRIPCION
		  FROM ZON_REGIO
		 WHERE IND_ACTI = 1
		   AND IND_BLOQ_PREM = '1'
		 ORDER BY DES_REGI
	</select>
	
	<resultMap id="listBloqueoPremiosResult" class="java.util.HashMap">
	    <result property="identificador" 				column="COR_PREM_BLOQ"/>
	    <result property="codigoPeriodo" 		  		column="CAM_BLOQ"/>
	    <result property="codigoConcurso"			    column="COD_CONC"/>
	    <result property="codigoRegion"					column="COD_REGI"/>
	    <result property="descripcionRegion"			column="DES_REGI"/>
	    <result property="codigoSAP"					column="COD_SAP"/>
	    <result property="descripcionPremio"			column="DES_PREM"/>
	    <result property="codigoVenta"					column="COD_VENT_FICT"/>
	    <result property="indicadorReemplazo"		column="IND_REEM"/>
    </resultMap>
	
	<select id="getBloqueoPremios" parameterClass="java.util.Map" resultMap="listBloqueoPremiosResult">
		SELECT blo.COR_PREM_BLOQ,
		       blo.CAM_BLOQ,
		       blo.COD_CONC,
		       blo.COD_REGI,
		       reg.DES_REGI,
		       blo.COD_SAP,
		       PQ_APL_AUX.Valor_Gen_I18n_Sicc(1, pro.Oid_Prod, 'MAE_PRODU') DES_PREM,
		       blo.COD_VENT_FICT,
		       blo.IND_REEM
		  FROM INC_PREMI_BLOQU blo, ZON_REGIO reg, MAE_PRODU pro
		 WHERE blo.COD_REGI = reg.COD_REGI
		   AND blo.COD_SAP = pro.COD_SAP
		   AND blo.Cam_Bloq = #codigoPeriodo#
		   
		   <isNotEmpty property="codigoConcurso">
		    	AND blo.Cod_Conc = #codigoConcurso#
		   </isNotEmpty>
		  
		   <isNotEmpty property="codigoRegion">	
				    <iterate prepend="AND" property="codigoRegion" open=" blo.Cod_Regi IN (" close=")" conjunction=",">
        			 	#codigoRegion[]#
		        	</iterate>    
 		   </isNotEmpty>	

		   <isNotEmpty property="codigoSAP">
		    	AND blo.Cod_Sap = #codigoSAP#
		   </isNotEmpty>
	</select>
	
	<select id="getExisteBloqueoPremios" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
		  FROM INC_PREMI_BLOQU blo
		 WHERE blo.Cam_Bloq = #codigoPeriodo#
		   AND blo.Cod_Conc = #codigoConcurso#
		   AND blo.Cod_Regi = #codigoRegion#		   
		   AND blo.Cod_Sap = #codigoSAP#
		   
		<isNotEmpty property="identificador">
		    AND blo.COR_PREM_BLOQ != #identificador#
		</isNotEmpty>
	</select>
		 
    <insert id="insertBloqueoPremios" parameterClass="java.util.Map">
		INSERT INTO INC_PREMI_BLOQU
           (COR_PREM_BLOQ,
			COD_PAIS,
			CAM_BLOQ,
			COD_CONC,
			COD_REGI,
			COD_SAP,
			COD_VENT_FICT,
			IND_REEM,
			USU_CREA,
			FEC_CREA,
			USU_MODI,
			FEC_MODI)
		VALUES
	     (INC_PBLO_SEQ.NEXTVAL,
	      #codigoPais#,
	      #codigoPeriodo#,
	      #codigoConcurso#,
	      #codigoRegion#,
	      #codigoSAP#,
	      #codigoVenta#,
	      #indicadorReemplazo#,
	      #codigoUsuario#,
	      SYSDATE,
	      #codigoUsuario#,
	      SYSDATE)
	</insert>

    <update id="updateBloqueoPremios" parameterClass="java.util.Map">
		UPDATE INC_PREMI_BLOQU
           SET COD_CONC = #codigoConcurso#,
               COD_REGI = #codigoRegion#,
			   COD_SAP = #codigoSAP#,
			   COD_VENT_FICT = #codigoVenta#,
			   IND_REEM = #indicadorReemplazo#,
			   USU_MODI = #codigoUsuario#,
			   FEC_MODI = SYSDATE
		WHERE COR_PREM_BLOQ = #identificador#
    </update>
   		 	
    <delete id="deleteBloqueoPremios" parameterClass="java.util.Map">
		DELETE INC_PREMI_BLOQU
 		 WHERE COR_PREM_BLOQ = #identificador#
    </delete>

	<select id="getClasificacionesConcurso" resultMap="baseResultOid">
		SELECT D.OID_CLAS_CONC OID,
		       D.COD_CLAS_CONC CODIGO,
		       D.DES_CLAS_CONC DESCRIPCION
		  FROM INC_PARAM_TIPO_CLASI_CONCU A,
		       INC_CLASI_CONCU D
		 WHERE A.IND_ACTI = '1'
		   AND A.EST_REGI = '1'
		   AND A.CCON_OID_CLAS_CONC = D.OID_CLAS_CONC
		 ORDER BY 3	
	</select>
	       	
	<resultMap id="listConcursosByCriteriaResult" class="java.util.HashMap">
	    <result property="oidConcurso" 					column="OID_PARA_GRAL"/>
	    <result property="numeroConcurso" 		  		column="NUM_CONC"/>
	    <result property="nombreConcurso"			    column="VAL_NOMB"/>
	    <result property="codigoPeriodoInicio"			column="COD_PERI_INIC"/>
	    <result property="codigoPeriodoFin"				column="COD_PERI_FIN"/>
	    <result property="tipoConcurso"					column="DES_CLAS_CONC"/>
	    <result property="codigoPeriodoDespacho"		column="COD_PERI_DESP"/>
	    <result property="codigoPeriodoFinDespacho"		column="COD_PERI_FIN_DESP"/>
	    <result property="observaciones"				column="VAL_OBSE"/>
	    <result property="estadoCerrado"				column="VAL_ESTA_CERR"/>
	    <result property="indicadorActivo"				column="IND_ACTI"/>
	    <result property="estado"						column="DES_ESTA_CONC"/>
	    <result property="vigencia"						column="DES_VIGE_CONC"/>
	    <result property="programaPuntos"				column="DES_PPTO"/>
	    <result property="indicadorProgramaPuntos"		column="IND_PROG_PUNT"/>
    </resultMap>
	
	<select id="getConcursosByCriteria" parameterClass="java.util.Map" resultMap="listConcursosByCriteriaResult">
		SELECT gen.OID_PARA_GRAL,
		       gen.NUM_CONC,
		       gen.VAL_NOMB,
		       cord.COD_PERI COD_PERI_INIC,
		       corh.COD_PERI COD_PERI_FIN,
		       cla.DES_CLAS_CONC,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(pre.PERD_OID_PERI_INIC) COD_PERI_DESP,
		       corp.COD_PERI COD_PERI_FIN_DESP,
		       gen.VAL_OBSE,
		       (CASE when (gen.IND_ACTI = '0' AND ver.VICO_OID_VIGE_CONC = 6) then 'S'
		       		 when (gen.IND_ACTI = '0' AND ver.VICO_OID_VIGE_CONC = 4) then 'A'
		             else 'N'
		        END) VAL_ESTA_CERR,
		        gen.IND_ACTI,
		        DECODE(gen.IND_ACTI, 1, 'Activo', 'Inactivo') DES_ESTA_CONC,
		        pq_apl_aux.Valor_Gen_I18n_Sicc(1, ver.VICO_OID_VIGE_CONC, 'INC_VIGEN_CONCU') DES_VIGE_CONC,		        
                (CASE 
                    WHEN GEN.IND_PROG_PUNT=1 THEN 'SI'
                    ELSE
                        CASE WHEN GEN.COPA_CONC_PROG_PUNT IS NOT NULL THEN 
                            (SELECT GNT.NUM_CONC FROM INC_CONCU_PARAM_GENER GNT WHERE GNT.OID_PARA_GRAL = GEN.COPA_CONC_PROG_PUNT AND GNT.IND_PROG_PUNT = 1) 
                        END 
                END) DES_PPTO,
                GEN.IND_PROG_PUNT                        
		  FROM INC_CONCU_PARAM_GENER gen,
		       INC_VERSI_CONCU ver, 
		       INC_PARAM_GENER_PREMI pre, 
		       INC_CLASI_CONCU cla,
		       INC_PARAM_TIPO_CLASI_CONCU par,
		       CRA_PERIO perd, 
		       CRA_PERIO perh, 
		       CRA_PERIO perp,
		       SEG_PERIO_CORPO cord, 
		       SEG_PERIO_CORPO corh, 
		       SEG_PERIO_CORPO corp
		 WHERE gen.OID_PARA_GRAL = pre.COPA_OID_PARA_GRAL(+)
		   AND gen.CCON_OID_CLAS_CONC = cla.OID_CLAS_CONC
		   AND cla.OID_CLAS_CONC = par.CCON_OID_CLAS_CONC
		   AND par.IND_ACTI = '1'
		   AND par.EST_REGI = '1'
		   AND gen.OID_PARA_GRAL = ver.COPA_OID_PARA_GRAL
		   AND gen.PERD_OID_PERI_DESD = perd.OID_PERI
		   AND gen.PERD_OID_PERI_HAST = perh.OID_PERI
		   AND pre.PERD_OID_PERI = perp.OID_PERI(+)
		   AND perd.PERI_OID_PERI = cord.OID_PERI
		   AND perh.PERI_OID_PERI = corh.OID_PERI
		   AND perp.PERI_OID_PERI = corp.OID_PERI(+)

		   <isNotEmpty property="oidClasificacionConcurso">
		    	AND cla.OID_CLAS_CONC = #oidClasificacionConcurso#
		   </isNotEmpty>
		   
		   <isNotEmpty property="numeroConcurso">
		    	AND gen.NUM_CONC = #numeroConcurso#
		   </isNotEmpty>

		   <isNotEmpty property="nombreConcurso">
		    	AND UPPER(gen.VAL_NOMB) LIKE UPPER(#nombreConcurso#)
		   </isNotEmpty>
		   
		   <isNotEmpty property="codigoPeriodoInicio">
		    	AND cord.COD_PERI = #codigoPeriodoInicio#
		   </isNotEmpty>

		   <isNotEmpty property="codigoPeriodoFin">
		    	AND corh.COD_PERI = #codigoPeriodoFin#
		   </isNotEmpty>
		   
		   <isNotEmpty property="codigoPeriodoDespacho">
		    	AND INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(pre.PERD_OID_PERI_INIC) = #codigoPeriodoDespacho#
		   </isNotEmpty>
		   
		   <isNotEmpty property="codigoPeriodoFinDespacho">
		    	AND corp.COD_PERI = #codigoPeriodoFinDespacho#
		   </isNotEmpty>
		   
		   <isNotEmpty property="oidEstado">
		    	AND gen.IND_ACTI = #oidEstado#
		   </isNotEmpty>
		   
		   <isNotEmpty property="oidVigencia">
		    	AND ver.VICO_OID_VIGE_CONC = #oidVigencia#
		   </isNotEmpty>
		   
		   <isNotEmpty property="indicadorProgramaPuntos">
		    	AND gen.IND_PROG_PUNT = #indicadorProgramaPuntos#
		   </isNotEmpty>
		   
		 ORDER BY 2 DESC
	</select>
	     
    <delete id="deleteConcurso" parameterClass="java.util.Map">
		UPDATE INC_CONCU_PARAM_GENER
 		   SET IND_ACTI = 0,
 		   	   USU_MODI = #codigoUsuario#,
 		   	   FEC_MODI = SYSDATE
 		 WHERE OID_PARA_GRAL = #oidConcurso#
    </delete>

    <delete id="deleteConcursoVersion" parameterClass="java.util.Map">
		UPDATE INC_VERSI_CONCU
 		   SET vico_oid_vige_conc = #oidVigencia#,
 		   	   USU_MODI = #codigoUsuario#,
 		   	   FEC_MODI = SYSDATE
 		 WHERE COPA_OID_PARA_GRAL = #oidConcurso#
    </delete>
    	 
	<select id="getTiposPrograma" resultMap="baseResultOid">
		SELECT OID_TIPO_PROG OID, COD_TIPO_PROG CODIGO, DES_TIPO_PROG DESCRIPCION
		  FROM INC_CONCU_TIPO_PROG
		 ORDER BY 3 	
	</select>

	<select id="getBaseCalculo" resultMap="baseResult">
		SELECT OID_BASE_CALC CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_BASE_CALC, 'INC_BASE_CALCU') DESCRIPCION
		  FROM INC_BASE_CALCU  
		 ORDER BY 2 	
	</select>

	<select id="getDirigidos" resultMap="baseResult">
		SELECT 1 CODIGO, 'Consultora' DESCRIPCION FROM DUAL
		 UNION
		SELECT 2, 'Gerente' FROM DUAL
	</select>

	<select id="getTipoVenta" resultMap="baseResult">
		SELECT OID_TIPO_VENT CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_TIPO_VENT, 'INC_TIPO_VENTA') DESCRIPCION
  		  FROM INC_TIPO_VENTA     
 		 ORDER BY 2   	
	</select>
	
	<select id="getTipoExigencia" resultMap="baseResult">
		SELECT OID_TIPO_EXIG CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_TIPO_EXIG, 'INC_TIPO_EXIGE') DESCRIPCION
  		  FROM INC_TIPO_EXIGE     
 		 ORDER BY 2   	
 	</select>

	<select id="getConcursosRecomendadas" resultMap="baseResult">
		SELECT OID_PARA_GRAL CODIGO, NUM_CONC DESCRIPCION
		  FROM INC_CONCU_PARAM_GENER
		 WHERE IND_ACTI = 1
		 ORDER BY 2
 	</select>

	<select id="getEstatusCliente" resultMap="baseResult">
		SELECT OID_ESTA_CLIE CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_ESTA_CLIE, 'MAE_ESTAT_CLIEN') DESCRIPCION
  		  FROM MAE_ESTAT_CLIEN     
 		 ORDER BY 2 
 	</select>

	<select id="getClasificacionesParticipante" resultMap="baseResult">
		SELECT OID_PART_CONC_CABE CODIGO, DES_DESC DESCRIPCION
  		  FROM INC_PARTI_CONCU_CABEC     
 		 ORDER BY 2 
 	</select>

	<select id="getTiposPremiacion" resultMap="baseResult">
		SELECT OID_TIPO_PION CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_TIPO_PION, 'INC_TIPO_PCION') DESCRIPCION
  		  FROM INC_TIPO_PCION
		<![CDATA[		          		       
  		 WHERE OID_TIPO_PION <> 3
	    ]]>
 		 ORDER BY 2  
 	</select>

	<select id="getTiposEleccion" resultMap="baseResult">
		SELECT OID_TIPO_ELEC CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_TIPO_ELEC, 'INC_TIPO_ELECC') DESCRIPCION
  		  FROM INC_TIPO_ELECC     
 		 ORDER BY 2  
 	</select>
		
	<select id="getCentrosServicio" resultMap="baseResult">
		SELECT OID_CENT_SERV CODIGO, DES_CENT_SERV DESCRIPCION
  		  FROM INC_CENTR_SERVI     
 		 ORDER BY 2  
 	</select>

	<select id="getTiposProducto" resultMap="baseResult">
		SELECT OID_TIPO_PROD CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_TIPO_PROD, 'INC_TIPO_PRODU') DESCRIPCION 
		  FROM INC_TIPO_PRODU
		 WHERE IND_PROD = 0
		 ORDER BY 2  
 	</select>

	<select id="getTiposOferta" resultMap="baseResult">
		SELECT OID_TIPO_OFER CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_TIPO_OFER, 'PRE_TIPO_OFERT') DESCRIPCION 
		  FROM PRE_TIPO_OFERT
		  WHERE CANA_OID_CANA = 2001
		 ORDER BY 2  
 	</select>

	<select id="getTiposAgrupacion" resultMap="baseResult">
		SELECT 'T' CODIGO, 'Obligatorio' DESCRIPCION FROM DUAL
		 UNION         
		SELECT 'U', 'Opcional' FROM DUAL  
 	</select>

	<select id="getUnidadesNegocio" resultMap="baseResult">
		SELECT OID_UNID_NEGO CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_UNID_NEGO, 'MAE_UNIDA_NEGOC') DESCRIPCION
  		  FROM MAE_UNIDA_NEGOC     
 		 ORDER BY 2             
 	</select>

	<select id="getSuperGenericosByCriteria" resultMap="baseResultOid">
		SELECT M.OID_SUPE_GENE OID, 
			   M.COD_SUPE_GENE CODIGO, 
			   G.VAL_I18N DESCRIPCION
		  FROM MAE_SUPER_GENER M, GEN_I18N_SICC_PAIS G
		 WHERE M.OID_SUPE_GENE = G.VAL_OID
		   AND G.ATTR_ENTI = 'MAE_SUPER_GENER'
		   
  		  <isNotEmpty prepend="AND" property="codigo">
          	M.COD_SUPE_GENE like UPPER(#codigo#||'%')
       	  </isNotEmpty>
       	  
       	  <isNotEmpty prepend="AND" property="descripcion">
          	UPPER(G.VAL_I18N) LIKE UPPER(#descripcion#||'%')
       	  </isNotEmpty>
		   
		 ORDER BY 3
 	</select>

	<select id="getGenericosByCriteria" resultMap="baseResultOid">
		SELECT M.OID_GENE OID, 
			   M.COD_GENE CODIGO, 
			   G.VAL_I18N DESCRIPCION
		  FROM MAE_GENER M, GEN_I18N_SICC_PAIS G
		 WHERE M.OID_GENE = G.VAL_OID
		   AND G.ATTR_ENTI = 'MAE_GENER'
   
   		  <isNotEmpty prepend="AND" property="codigo">
          	M.COD_SUPE_GENE like UPPER(#codigo#||'%')
       	  </isNotEmpty>
       	  
       	  <isNotEmpty prepend="AND" property="descripcion">
          	UPPER(G.VAL_I18N) LIKE UPPER(#descripcion#||'%')
       	  </isNotEmpty>
		   
		 ORDER BY 3
 	</select>

	<select id="getCiclosVida" resultMap="baseResult">
		SELECT OID_CICL_VIDA CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_CICL_VIDA, 'PRE_CICLO_VIDA') DESCRIPCION
  		  FROM PRE_CICLO_VIDA     
 		 ORDER BY 2             
 	</select>

	<select id="getNegocios" resultMap="baseResult">
		SELECT OID_NEGO CODIGO, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_NEGO, 'MAE_NEGOC') DESCRIPCION
  		  FROM MAE_NEGOC     
 		 ORDER BY 2             
 	</select>

	<select id="getMarcaProductos" resultMap="baseResult">
		SELECT OID_MARC_PROD CODIGO, DES_MARC_PROD DESCRIPCION
  		  FROM SEG_MARCA_PRODU     
 		 ORDER BY 2                  
 	</select>
 	 			    	 
	<select id="getSecuenciaConcursoParametrosGenerales" resultClass="long">
          SELECT INC_COPA_SEQ.NEXTVAL FROM DUAL
    </select>

	<select id="getSecuenciaConcursoParametrosPremiacion" resultClass="long">
          SELECT INC_PAGP_SEQ.NEXTVAL FROM DUAL
    </select>

	<select id="getSecuenciaConcursoNivelPremiacion" resultClass="long">
          SELECT INC_PANP_SEQ.NEXTVAL FROM DUAL
    </select>

	<select id="getSecuenciaConcursoPremioArticulo" resultClass="long">
          SELECT INC_PRAR_SEQ.NEXTVAL FROM DUAL
    </select>

	<select id="getSecuenciaConcursoLotePremioArticulo" resultClass="long">
          SELECT INC_LOPA_SEQ.NEXTVAL FROM DUAL
    </select>

	<select id="getSecuenciaConcursoProductos" resultClass="long">
          SELECT INC_PRDU_SEQ.NEXTVAL FROM DUAL
    </select>
    	 
    <insert id="insertConcursoParametrosGenerales" parameterClass="concursoParametrosGenerales">
		INSERT INTO INC_CONCU_PARAM_GENER
            (OID_PARA_GRAL,
			 NUM_CONC,
			 NUM_VERS,
			 PAIS_OID_PAIS,
			 VAL_NOMB,
			 IND_RANK,
			 IND_DEVO,
			 IND_ANUL,
			 VAL_FALT_NANU,
			 VAL_EXPR_PUNT,
			 IND_PRUE,
			 VAL_OBSE,
			 IND_ACTI,
			 VAL_ESTA_GENE_META,
			 IND_COMU,
			 COD_MENS,
			 PLC2_OID_PLAN_CONC,
			 COIV_OID_CONC_IVR,
			 PERD_OID_PERI_DESD,
			 PERD_OID_PERI_HAST,
			 TEXI_OID_TIPO_EXIG,
			 DIRI_OID_DIRI,
			 BCAL_OID_BASE_CALC,
			 MARC_OID_MARC,
			 CANA_OID_CANA,
			 IND_DUPL_CYZO,
			 ICTP_OID_TIPO_PROG,
			 IND_NO_GENE_PUNT,
			 CCON_OID_CLAS_CONC,
			 TIOC_OID_TIPO_OFER_CONC,
			 USU_CREA,
			 FEC_CREA,
			 IND_MULT_MARC,
			 NUM_PUNT_ABON,
			 IND_PROG_PUNT,
			 COPA_CONC_PROG_PUNT)
	     VALUES 
	     	(#oid#,
			 #numeroConcurso#,
			 #version#,
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#),
			 #nombreConcurso#,
			 #indicadorRanking#,
			 #indicadorDevoluciones#,
			 #indicadorAnulaciones#,
			 #faltantesNoAnunciados#,
			 #expresionPuntaje#,
			 #indicadorPruebas#,
			 #observaciones#,
			 #indicadorActivo#,
			 #estatusGeneracionMetas#,
			 #indicadorComunicacion#,
			 #codigoMensaje#,
			 #oidPlantilla#,
			 #oidTipoConcursoIVR#,
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
			 #oidTipoExigencia#,
			 #dirigidoA#,
			 #oidBaseCalculo#,
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#),
			 #indicadorDuplaCyzone#,
			 #oidTipoPrograma#,
			 #indicadorNoGeneraPuntaje#,
			 #oidClasificacionConcurso#,
			 #oidTipoOfertaConcurso#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#,
			 #indicadorMultiMarca#,
			 #puntosAbonar#,
			 #indicadorCPP#,
			 #oidCPP#)
    </insert>
    	 
    <insert id="insertConcursoVersion" parameterClass="concursoVersion">
		INSERT INTO INC_VERSI_CONCU
            (OID_VERS_CONC,
			 VAL_VERS_NUEV,
             NUM_CONC,
		 	 PERD_OID_PERI,
			 COPA_OID_PARA_GRAL,
			 COPA_OID_PARA_GRAL_ORIG,
			 ESC2_OID_ESTA_CONC,
			 VICO_OID_VIGE_CONC,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_VECO_SEQ.NEXTVAL,
			 #versionNueva#,
			 #numeroConcurso#,
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#),
			 #oidConcurso#,
			 #oidConcursoOrigen#,
			 #oidEstadoConcurso#,
			 #oidVigenciaConcurso#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
        
    <insert id="insertConcursoAcceso" parameterClass="concursoParametrosGenerales">
		INSERT INTO INC_ACCES_CONCU
            (OID_ACCE_CONC,
			 COPA_OID_PARA_GRAL,
			 ACCE_OID_ACCE)
	     VALUES 
	     	(INC_ACC2_SEQ.NEXTVAL,
			 #oid#,
			 (SELECT OID_ACCE FROM SEG_ACCES WHERE COD_ACCE = #codigoAcceso#)
			)
    </insert>
            
    <insert id="insertConcursoObtencionPuntos" parameterClass="concursoObtencionPuntos">
		INSERT INTO INC_OBTEN_PUNTO
            (OID_OBTE_PUNT,
			 VAL_FACT_CONV,
			 NUM_PUNT_ASIG,
			 IND_COMU_OBTE,
			 VAL_PUNT_ACUM,
			 IND_ACTI,
			 IND_CONS,
			 COPA_OID_PARA_GRAL,
			 MENS_OID_MENS,
			 NUM_CAMP_SINP_PERM,
			 USU_CREA,
			 FEC_CREA,
			 IND_EXIG_CAMP_ANTE, 
			 PUN_ABON_REFE_PROG_PUNT,
			 NUM_CAMP_SINP_CANC_PUNT,
			 IND_TIPO_CUAD
			 )
	     VALUES 
	     	(INC_OBPU_SEQ.NEXTVAL,
			 #factorConversion#,
			 #numeroPuntosAsignar#,
			 #indicadorComunicacion#,
			 #indicadorPuntajeAcumulativo#,
			 #indicadorActividad#,
			 #indicadorConstancia#,
			 #oidConcurso#,
			 (SELECT OID_MENS FROM MSG_MENSA WHERE COD_MENS = #codigoMensaje#),
			 #numeroPeriodosSinPedido#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#,
			 #indicadorExigePasarPedidoCampanyaAnteriorCPP#,
			 #puntosAbonarRecomendacionEfectivaCPP#,
			 #campanyasSinPedidoParaCancelacionPuntosCPP#,
			 #tipoCuadre#			 
			)
    </insert>
         
    <insert id="insertConcursoDespachoPremios" parameterClass="concursoDespachoPremios">
		INSERT INTO INC_DESPA_PREMI
            (OID_DESP_PREM,
			 IND_COMU_DESP_AUTO,
			 IND_COMU_DESP_MANU,
			 COPA_OID_PARA_GRAL,
			 MENS_OID_MENS_AUTO,
			 MENS_OID_MENS_MANU,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_DEPR_SEQ.NEXTVAL,
			 #indicadorComunicacionAutomatico#,
			 #indicadorComunicacionManual#,
			 #oidConcurso#,
			 (SELECT OID_MENS FROM MSG_MENSA WHERE COD_MENS = #codigoMensajeAutomatico#),
			 (SELECT OID_MENS FROM MSG_MENSA WHERE COD_MENS = #codigoMensajeManual#),
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoAmbitoGeografico" parameterClass="concursoAmbitoGeografico">
		INSERT INTO INC_AMBIT_GEOGR
            (OID_AMBITO_GEOGRAFICO,
			 ZSCC_OID_SECC,
			 ZORG_OID_REGI,
			 ZSGV_OID_SUBG_VENT,
			 TERR_OID_TERR,
 			 ZZON_OID_ZONA,
			 COPA_OID_PARA_GRAL,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_TERC_SEQ.NEXTVAL,
			 #oidSeccion#,
			 #oidRegion#,
			 #oidSubgerencia#,
			 #oidTerritorio#,
			 #oidZona#,
			 #oidConcurso#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoParametrosConsultoras" parameterClass="concursoParametrosConsultoras">
		INSERT INTO INC_CONCU_PARAM_CONSU
            (OID_CONC_PARA_CONS,
 		 	 IND_RECO_EFEC,
 			 VAL_PERI_EVAL,
			 IND_CONT_RECO,
			 NUM_MINI_PEDI,
			 NUM_MINI_PEDI_RECO,
			 IMP_MONT_MINI_PEDI,
			 NUM_UNID_MINI_PEDI,
			 IND_REIN_PIER_PUNT,
			 COPA_OID_PARA_GRAL,
			 PERD_OID_PERI_DESD,
			 
			 <isNotEmpty property="codigoPeriodoEvaluacion">
		    	PERD_OID_PERI_INIC_EVAL,
		     </isNotEmpty>
		     
			 PERD_OID_PERI_HAST,
			 TVEN_OID_TIPO_VENT,
			 IND_PREM_CAMP_EFEC,
			 IND_GENE_PUNT_A_RECO,
			 COPA_CONC_PUNT_RECO,
			 IND_TIPO_EVAL_MONT,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_COPC_SEQ.NEXTVAL,
			 #indicadorRecomendacionEfectiva#,
			 #periodosEvaluacion#,
			 #indicadorControlRecomendadas#,
			 #numeroMinimoPedidos#,
			 #numeroMinimoPedidosRecomendada#,
			 #montoMinimoPedido#,
			 #unidadesMinimasPedido#,
			 #indicadorReingresoPierdePuntaje#,
			 #oidConcurso#,
			 #oidPeriodoDesde#,
			 
			 <isNotEmpty property="codigoPeriodoEvaluacion">
			  	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoEvaluacion#),
			 </isNotEmpty>
			  	
			 #oidPeriodoHasta#,
			 #oidTipoVenta#,
			 #indicadorPremioCampEfect#,
			 #generarPuntajeARecomendadas#,
			 #oidConcursoPuntajeRecomendada#,
			 #tipoEvaluacion#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoMontoVentas" parameterClass="concursoMontoVentas">
		INSERT INTO INC_MONTO_VENTA_RECOM
            (OID_MONT_VENT_RECO,
			 VAL_CANT_MONT_VENT,
			 COPA_OID_PARA_GRAL,
			 TMVR_OID_TIPO_MONT_VENT_RECO,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_MOVR_SEQ.NEXTVAL,
			 #cantidadMontoVenta#,
			 #oidConcurso#,
			 #oidTipoMontoVenta#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoEstatusVenta" parameterClass="concursoEstatusVenta">
		INSERT INTO INC_ESTAT_VENTA_CONSU
            (OID_ESTA_VENT,
			 COPA_OID_PARA_GRAL,
			 ESTA_OID_ESTA_CLIE,
			 
			 <isNotEmpty property="codigoPeriodoHasta">
		    	PERD_OID_PERI_HAST,
		     </isNotEmpty>
			 
			 PERD_OID_PERI_DESD,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_ESVC_SEQ.NEXTVAL,
			 #oidConcurso#,
			 #oidEstatusCliente#,
			 
			 <isNotEmpty property="codigoPeriodoHasta">
			   GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
			 </isNotEmpty>
			 
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoClasificacionParticipante" parameterClass="concursoClasificacionParticipante">
		INSERT INTO INC_CLASI_PARTI_CONCU
            (OID_CLAS_PART_CONC,
			 COPA_OID_PARA_GRAL,
			 PACI_OID_PART_CONC_CABE,
			 IND_EXCL,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_CLPC_SEQ.NEXTVAL,
			 #oidConcurso#,
			 #oidClasificacion#,
			 #excluirClasificacion#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
    
    <insert id="insertConcursoRequisitoPremiacion" parameterClass="concursoRequisitoPremiacion">
		INSERT INTO INC_REQUI_PREMI
            (OID_REQU_PREM,
			 VAL_MONT_MINI_CONC,
			 NUM_PEDI,
			 VAL_CUOT_INGR,
			 IND_PEDI_PERI,
			 VAL_MONT_MINI_PEDI,
			 IND_PAGO_TIEM,
			 NUM_DIAS_GRAC,
			 IND_ASIS_CURS,
			 COPA_OID_PARA_GRAL,
			 PERD_OID_PERI,
			 PERD_OID_PERI_DESD,
			 NUM_PERI_ESPE_PAGO,
			 PERD_OID_PERI_MAXI,
			 VADE_OID_VALI_DEUD,
			 IND_DESP_CAMP_PUNT,
			 IND_PRIO_EWEB,
			 USU_CREA,
			 FEC_CREA
			)
	     VALUES 
	     	(INC_REPR_SEQ.NEXTVAL,
			 #montoMinimoConcurso#,
			 #numeroPedidos#,
			 #cuotaIngreso#,
			 #indicadorPedidoEnPeriodo#,
			 #montoMinimoPedido#,
			 #indicadorPagoATiempo#,
			 #diasGracia#,
			 #indicadorAsistenciaCurso#,
			 #oidConcurso#,
			 #oidPeriodoHasta#,
			 #oidPeriodoDesde#,
			 #periodosEsperaPago#,
			 #oidperiodoMaximo#,
			 #oidValidaDeuda#,
			 #indicadorDespacho#,
			 #indicadorPriorizaWeb#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoParametrosPremiacion" parameterClass="concursoParametrosPremiacion">
		INSERT INTO INC_PARAM_GENER_PREMI
            (OID_PARA_GENE_PREM,
			 NUM_NIVE,
			 IND_NIVE_ELEG,
			 IND_PREM_ACUM_NIVE,
			 VAL_HAST_NIVE,
			 IND_NIVE_ROTA,
			 NUM_ROTA,
			 IND_NOPR_DEFE,
			 IND_PREM_ELEC,
			 IND_PERI_DESP_EXIG,
			 NUM_PERI,
			 IND_COMU,
			 MENS_OID_MENS,
			 TELE_OID_TIPO_ELEC,
			 TPRM_OID_TIPO_PION,
			 
			 <isNotEmpty property="codigoPeriodoDespacho">
			 	PERD_OID_PERI,
			 </isNotEmpty>
			 
			 COPA_OID_PARA_GRAL,
			 
			 <isNotEmpty property="codigoPeriodoDespachoInicio">
			 PERD_OID_PERI_INIC,
			 </isNotEmpty>
			 VAL_PORC_MAXI_DSTO,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(#oid#,
			 #numeroNiveles#,
			 #indicadorNivelElegible#,
			 #premiosAcumulativosNiveles#,
			 #hastaNivel#,
			 #indicadorNivelesRotativos#,
			 #numeroRotaciones#,
			 #accesoNivelSuperior#,
			 #indicadorPremiosElectivos#,
			 #periodoDespachoExigido#,
			 #numeroPeriodos#,
			 #indicadorComunicacion#,
			 #oidMensaje#,
			 #oidTipoEleccion#,
			 #oidTipoPremiacion#,
			 
			 <isNotEmpty property="codigoPeriodoDespacho">
			 	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDespacho#),
			</isNotEmpty>
						 	
			 #oidConcurso#,
			 
			 <isNotEmpty property="codigoPeriodoDespachoInicio">
			 	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDespachoInicio#),
			 </isNotEmpty>
			 #porcentajeMaximoDescuentoCPP#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
    
    <insert id="insertConcursoNivelPremiacion" parameterClass="concursoNivelPremiacion">
		INSERT INTO INC_PARAM_NIVEL_PREMI
            (OID_PARA_NIVE_PREM,
			 NUM_NIVE,
			 NUM_CANT_FIJA_PUNT,
			 NUM_CANT_INIC_PUNT,
			 NUM_CANT_FINA_PUNT,
			 VAL_NIVE_SELE,
			 VAL_PUNT_SERV,
			 NUM_ASPI,
			 PAGP_OID_PARA_GENE_PREM,
			 TPRE_OID_TIPO_PREM,
			 NUM_PUNT_PROD_EXIG,
			 VAL_DESC,
			 VAL_PLAZ_ENTR,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(#oid#,
			 #numeroNivel#,
			 #cantidadFijaPuntos#,
			 #cantidadInicialPuntos#,
			 #cantidadFinalPuntos#,
			 #indicadorNivelSelectivo#,
			 #puntajeServicio#,
			 #numeroAspirantes#,
			 #oidPremiacion#,
			 #oidTipoPremio#,
			 #puntosProductosExigidos#,
			 #descripcionNivel#,
			 #plazoEntrega#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoPremioArticulo" parameterClass="concursoPremioArticulo">
		INSERT INTO INC_PREMI_ARTIC
            (OID_PREM_ARTI,
			 NUM_UNID,
			 PANP_OID_PARA_NIVE_PREM,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(#oid#,
			 #numeroUnidades#,
			 #oidNivelPremiacion#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
	
    <insert id="insertConcursoLotePremioArticulo" parameterClass="concursoLotePremioArticulo">
		INSERT INTO INC_LOTE_PREMI_ARTIC
            (OID_LOTE_PREM_ARTI,
			 NUM_LOTE,
			 NUM_PREM,
			 PRAR_OID_PREM_ARTI,
			 VAL_DESC_LOTE_PREM_ARTI,
			 USU_CREA,
			 FEC_CREA,
			 IND_PREMI_ELWEB)
	     VALUES 
	     	(#oid#,
			 #numeroLote#,
			 #numeroPremio#,
			 #oidPremioArticulo#,
			 #descripcionLote#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#,
			 #indicadorPremiosWeb#
			)
    </insert>

    <insert id="insertConcursoArticuloLote" parameterClass="concursoArticuloLote">
		INSERT INTO INC_ARTIC_LOTE
            (OID_ARTI_LOTE,
			 IND_DESP,
			 IMP_PREC_PUBL,
			 NUM_UNID,
			 COD_VENT_FICT,
			 PROD_OID_PROD,
			 LOPA_OID_LOTE_PREM_ARTI,
			 IND_CENT_DIST_GARA,
			 CESE_OID_CESE_GARA,
			 NUM_MESE_GARA,
			 OBS_CENT_DIST,
			 IND_TIPO_ENTR_PREM,
			 CESE_OID_CESE_ENTR,
			 IND_TIPO_PREM,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_ARLO_SEQ.NEXTVAL,
			 #indicadorDespacho#,
			 #precioPublico#,
			 #numeroUnidades#,
			 #codigoVentaFicticio#,
			 (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			 #oidLotePremioArticulo#,
			 #indicadorCentroServicio#,
			 #oidCentroServGarantia#,
			 #numeroMesesGarantia#,
			 #observaciones#,
			 #indicadorTipoEntrega#,
			 #oidCentroServEntrega#,
			 'A',
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoProductos" parameterClass="concursoProductos">
		INSERT INTO INC_PRODU
            (OID_PROD,
			 VAL_COMU_VALI,
			 VAL_MENS_VALI,
			 VAL_COMU_EXIG,
			 VAL_MENS_EXIG,
			 VAL_COMU_EXCL,
			 VAL_MENS_EXCL,
			 VAL_COMU_BONI,
			 COPA_OID_PARA_GRAL,
			 VAL_MENS_BONI,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(#oid#,
			 #comunicacionValidos#,
			 #mensajeValidos#,
			 #comunicacionExigidos#,
			 #mensajeExigidos#,
			 #comunicacionExcluidos#,
			 #mensajeExcluidos#,
			 #comunicacionBonificados#,
			 #oidConcurso#,
			 #mensajeBonificados#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
    
    <insert id="insertConcursoProductosValidos" parameterClass="concursoProductosValidos">
		INSERT INTO INC_PRODU_VALID
            (OID_PROD_VALI,
			 TOFE_OID_TIPO_OFER,
			 PRDU_OID_PROD,
			 UNEG_OID_UNID_NEGO,
			 SGEN_OID_SUPE_GENE,
			 CIVI_OID_CICL_VIDA,
			 NEGO_OID_NEGO,
			 GENE_OID_GENE,
			 PROD_OID_PROD,
			 MAPR_OID_MARC_PROD,
			 OFDE_OID_DETA_OFER,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_PRVA_SEQ.NEXTVAL,
			 #oidTipoOferta#,
			 #oidProductos#,
			 #oidUnidadNegocio#,
			 #oidSuperGenerico#,
			 #oidCicloVida#,
			 #oidNegocio#,
			 #oidGenerico#,
			 
			 <isNotEmpty property="oidDetalleOferta">
			 	NULL,
			 </isNotEmpty>
			 
			 <isEmpty property="oidDetalleOferta">
			 (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			 </isEmpty>
			 	
			 #oidMarcaProducto#,
			 #oidDetalleOferta#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
    
    <insert id="insertConcursoProductosBonificados" parameterClass="concursoProductosBonificados">
		INSERT INTO INC_PRODU_BONIF
            (OID_PROD_BONI,
			 NUM_PUNT_UNID,
			 VAL_FACT_MULT,
			 PRDU_OID_PROD,
			 CIVI_OID_CICL_VIDA,
			 NEGO_OID_NEGO,
			 PERD_OID_PERI_DESD,
			 SGEN_OID_SUPE_GENE,
			 TOFE_OID_TIPO_OFER,
			 GENE_OID_GENE,
			 
			 <isNotEmpty property="codigoPeriodoHasta">
			 	PERD_OID_PERI_HAST,
			 </isNotEmpty>
			 
			 UNEG_OID_UNID_NEGO,
			 PROD_OID_PROD,
			 MAPR_OID_MARC_PROD,
			 OFDE_OID_DETA_OFER,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_PRBO_SEQ.NEXTVAL,
			 #puntosUnidad#,
			 #factorMultiplicador#,
			 #oidProductos#,
			 #oidCicloVida#,
			 #oidNegocio#,
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			 (SELECT OID_SUPE_GENE FROM MAE_SUPER_GENER WHERE COD_SUPE_GENE = #codigoSuperGenerico#),
			 #oidTipoOferta#,
			 (SELECT OID_GENE FROM MAE_GENER WHERE COD_GENE = #codigoGenerico#),
			 
			 <isNotEmpty property="codigoPeriodoHasta">
		 	 	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
		 	 </isNotEmpty>
		 	 
			 #oidUnidadNegocio#,
			 
			 <isNotEmpty property="oidDetalleOferta">
			 	NULL,
			 </isNotEmpty>
			 
			 <isEmpty property="oidDetalleOferta">
			 (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			 </isEmpty>
			 
	 		 #oidMarcaProducto#,
	 		 #oidDetalleOferta#,
	 		 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoProductosExcluidos" parameterClass="concursoProductosExcluidos">
		INSERT INTO INC_PRODU_EXCLU
            (OID_PROD_EXCL,
			 CIVI_OID_CICL_VIDA,
			 
			 <isNotEmpty property="codigoPeriodoHasta">
			 	PERD_OID_PERI_HAST,
			 </isNotEmpty>
			 	
			 TOFE_OID_TIPO_OFER,
			 PERD_OID_PERI_DESD,
			 SGEN_OID_SUPE_GENE,
			 PRDU_OID_PROD,
			 GENE_OID_GENE,
			 NEGO_OID_NEGO,
			 UNEG_OID_UNID_NEGO,
			 PROD_OID_PROD,
			 MAPR_OID_MARC_PROD,
			 OFDE_OID_DETA_OFER,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_PREX_SEQ.NEXTVAL,
			 #oidCicloVida#,
			 
			 <isNotEmpty property="codigoPeriodoHasta">
		 	 	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
		 	 </isNotEmpty>
			 
			 #oidTipoOferta#,
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			 (SELECT OID_SUPE_GENE FROM MAE_SUPER_GENER WHERE COD_SUPE_GENE = #codigoSuperGenerico#),
			 #oidProductos#,
			 (SELECT OID_GENE FROM MAE_GENER WHERE COD_GENE = #codigoGenerico#),
			 #oidNegocio#,
			 #oidUnidadNegocio#,
			 
			 <isNotEmpty property="oidDetalleOferta">
			 	NULL,
			 </isNotEmpty>
			 
			 <isEmpty property="oidDetalleOferta">
			 (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			 </isEmpty>
			 
			 #oidMarcaProducto#,
			 #oidDetalleOferta#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>

    <insert id="insertConcursoProductosExigidos" parameterClass="concursoProductosExigidos">
		INSERT INTO INC_PRODU_EXIGI
            (OID_PROD_EXIG,
			 NUM_UNID_EXIG,
			 IMP_MONT_EXIG,
			 NUM_PUNT_EXIG,
			 SGEN_OID_SUPE_GENE,
			 GENE_OID_GENE,
			 TOFE_OID_TIPO_OFER,
			 
			 <isNotEmpty property="codigoPeriodoHasta">
			 	PERD_OID_PERI_HAST,
			 </isNotEmpty>
			 
			 UNEG_OID_UNID_NEGO,
			 PRDU_OID_PROD,
			 NEGO_OID_NEGO,
			 CIVI_OID_CICL_VIDA,
			 PERD_OID_PERI_DESD,
			 PROD_OID_PROD,
			 MAPR_OID_MARC_PROD,
			 PRE2_OID_PROD_EXIG,
			 IND_AGRUP,
			 OFDE_OID_DETA_OFER,
			 USU_CREA,
			 FEC_CREA)
	     VALUES 
	     	(INC_PREX_SEQ.NEXTVAL,
			 #unidadesExigidas#,
			 #montoExigido#,
			 #puntosExigidos#,
			 (SELECT OID_SUPE_GENE FROM MAE_SUPER_GENER WHERE COD_SUPE_GENE = #codigoSuperGenerico#),
			 (SELECT OID_GENE FROM MAE_GENER WHERE COD_GENE = #codigoGenerico#),
			 #oidTipoOferta#,
			 
			 <isNotEmpty property="codigoPeriodoHasta">
		 	 	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
		 	 </isNotEmpty>
			 
			 #oidUnidadNegocio#,
			 #oidProductos#,
			 #oidNegocio#,
			 #oidCicloVida#,
			 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			 
			 <isNotEmpty property="oidDetalleOferta">
			 	NULL,
			 </isNotEmpty>
			 
			 <isEmpty property="oidDetalleOferta">
			 (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			 </isEmpty>
			 
			 #oidMarcaProducto#,
			 #oidproductoExigidoOriginal#,
			 #indicadorAgrupacion#,
			 #oidDetalleOferta#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
        
	<resultMap id="concursoParametrosGeneralesResult"   class="concursoParametrosGenerales">
		<result property="oid"					  		  	column="OID_PARA_GRAL"/>					
		<result property="numeroConcurso"				  	column="NUM_CONC"/>
		<result property="version"							column="NUM_VERS"/>
		<result property="oidPais"							column="PAIS_OID_PAIS"/>
		<result property="nombreConcurso"					column="VAL_NOMB"/>
		<result property="indicadorRanking"					column="IND_RANK"/>
		<result property="indicadorDevoluciones"			column="IND_DEVO"/>
		<result property="indicadorAnulaciones"				column="IND_ANUL"/>
		<result property="faltantesNoAnunciados"			column="VAL_FALT_NANU"/>	
		<result property="expresionPuntaje"					column="VAL_EXPR_PUNT"/>
		<result property="indicadorPruebas"					column="IND_PRUE"/>
		<result property="observaciones"					column="VAL_OBSE"/>
		<result property="indicadorActivo"					column="IND_ACTI"/>
		<result property="estatusGeneracionMetas"			column="VAL_ESTA_GENE_META"/>
		<result property="indicadorComunicacion"			column="IND_COMU"/>
		<result property="codigoMensaje"					column="COD_MENS"/>
		<result property="oidPlantilla"						column="PLC2_OID_PLAN_CONC"/>
		<result property="oidTipoConcursoIVR"				column="COIV_OID_CONC_IVR"/>	
		<result property="oidPeriodoDesde"					column="PERD_OID_PERI_DESD"/>
		<result property="oidPeriodoHasta"					column="PERD_OID_PERI_HAST"/>
		<result property="oidTipoExigencia"					column="TEXI_OID_TIPO_EXIG"/>
		<result property="dirigidoA"						column="DIRI_OID_DIRI"/>
		<result property="oidBaseCalculo"					column="BCAL_OID_BASE_CALC"/>
		<result property="oidMarca"							column="MARC_OID_MARC"/>
		<result property="oidCanal"							column="CANA_OID_CANA"/>
		<result property="indicadorDuplaCyzone"				column="IND_DUPL_CYZO"/>
		<result property="oidTipoPrograma"					column="ICTP_OID_TIPO_PROG"/>
		<result property="indicadorNoGeneraPuntaje"			column="IND_NO_GENE_PUNT"/>
		<result property="oidClasificacionConcurso"			column="CCON_OID_CLAS_CONC"/>
		<result property="oidTipoOfertaConcurso"		    column="TIOC_OID_TIPO_OFER_CONC"/>				
		<result property="codigoUsuario"				    column="USU_MODI"/>
		<result property="indicadorMultiMarca"			    column="IND_MULT_MARC"/>
		<result property="puntosAbonar"					    column="NUM_PUNT_ABON"/>
		<result property="codigoPeriodoDesde"			    column="COD_PERI_DESD"/>
		<result property="codigoPeriodoHasta"			    column="COD_PERI_HAST"/>
		<result property="estadoConcurso"				    column="EST_CONC"/>
		<result property="indicadorCPP"				    	column="IND_PROG_PUNT"/>
		<result property="oidCPP"				    		column="COPA_CONC_PROG_PUNT"/>
    </resultMap>

	<select id="getConcursoParametrosGenerales" parameterClass="string" resultMap="concursoParametrosGeneralesResult">
		SELECT C.*,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_DESD) COD_PERI_DESD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_HAST) COD_PERI_HAST,
		       DECODE(C.IND_ACTI, '1', 'Activo', 'Inactivo') EST_CONC       
		  FROM INC_CONCU_PARAM_GENER C
		 WHERE C.OID_PARA_GRAL = #value#
 	</select>	

	<resultMap id="concursoVersionResult"   class="concursoVersion">
		<result property="oid"				  		  	column="OID_VERS_CONC"/>					
		<result property="versionNueva"				  	column="VAL_VERS_NUEV"/>
		<result property="numeroConcurso"				column="NUM_CONC"/>
		<result property="oidPeriodo"					column="PERD_OID_PERI"/>
		<result property="oidConcurso"					column="COPA_OID_PARA_GRAL"/>
		<result property="oidConcursoOrigen"			column="COPA_OID_PARA_GRAL_ORIG"/>
		<result property="oidEstadoConcurso"			column="ESC2_OID_ESTA_CONC"/>
		<result property="oidVigenciaConcurso"			column="VICO_OID_VIGE_CONC"/>
		<result property="vigenciaConcurso"	    		column="DES_VIGE"/>
    </resultMap>

	<select id="getConcursoVersion" parameterClass="string" resultMap="concursoVersionResult">
		SELECT C.*,
       		   pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.VICO_OID_VIGE_CONC, 'INC_VIGEN_CONCU') DES_VIGE
		  FROM INC_VERSI_CONCU C
		 WHERE C.COPA_OID_PARA_GRAL = #value#
 	</select>	

	<resultMap id="concursoObtencionPuntosResult"   class="concursoObtencionPuntos">
		<result property="oid"				  		  	column="OID_OBTE_PUNT"/>					
		<result property="factorConversion"			  	column="VAL_FACT_CONV"/>
		<result property="numeroPuntosAsignar"	    	column="NUM_PUNT_ASIG"/>
		<result property="indicadorComunicacion"		column="IND_COMU_OBTE"/>
		<result property="indicadorPuntajeAcumulativo"	column="VAL_PUNT_ACUM"/>
		<result property="indicadorActividad"			column="IND_ACTI"/>
		<result property="indicadorConstancia"			column="IND_CONS"/>
		<result property="oidConcurso"					column="COPA_OID_PARA_GRAL"/>
		<result property="oidMensaje"					column="MENS_OID_MENS"/>
		<result property="numeroPeriodosSinPedido"		column="NUM_CAMP_SINP_PERM"/>
		<result property="codigoMensaje"				column="COD_MENS"/>		
        <result property="descripcionMensaje"			column="DES_MENS"/>
		<result property="indicadorExigePasarPedidoCampanyaAnteriorCPP"			column="IND_EXIG_CAMP_ANTE"/>
		<result property="puntosAbonarRecomendacionEfectivaCPP"					column="PUN_ABON_REFE_PROG_PUNT"/>
		<result property="campanyasSinPedidoParaCancelacionPuntosCPP"			column="NUM_CAMP_SINP_CANC_PUNT"/>
		<result property="tipoCuadre"					column="IND_TIPO_CUAD"/>
    </resultMap>

	<select id="getConcursoObtencionPuntos" parameterClass="string" resultMap="concursoObtencionPuntosResult">
		SELECT C.*,
		       (SELECT COD_MENS FROM MSG_MENSA WHERE OID_MENS = C.MENS_OID_MENS) COD_MENS,
		       (SELECT DES_MENS FROM MSG_MENSA WHERE OID_MENS = C.MENS_OID_MENS) DES_MENS
		  FROM INC_OBTEN_PUNTO C
		 WHERE C.COPA_OID_PARA_GRAL = #value#
 	</select>	
         
	<resultMap id="concursoDespachoPremiosResult"   class="concursoDespachoPremios">
		<result property="oid"				  		  		column="OID_DESP_PREM"/>					
		<result property="indicadorComunicacionAutomatico"	column="IND_COMU_DESP_AUTO"/>
		<result property="indicadorComunicacionManual"		column="IND_COMU_DESP_MANU"/>
		<result property="oidConcurso"						column="COPA_OID_PARA_GRAL"/>
		<result property="oidMensajeAutomatico"				column="MENS_OID_MENS_AUTO"/>
		<result property="oidMensajeManual"					column="MENS_OID_MENS_MANU"/>
		<result property="codigoMensajeAutomatico"			column="COD_MENS_AUTO"/>
		<result property="codigoMensajeManual"				column="COD_MENS_MANU"/>		
    </resultMap>

	<select id="getConcursoDespachoPremios" parameterClass="string" resultMap="concursoDespachoPremiosResult">
		SELECT C.*,
		      (SELECT COD_MENS FROM MSG_MENSA WHERE OID_MENS = C.MENS_OID_MENS_AUTO) COD_MENS_AUTO,
		      (SELECT COD_MENS FROM MSG_MENSA WHERE OID_MENS = C.MENS_OID_MENS_MANU) COD_MENS_MANU       
		 FROM INC_DESPA_PREMI C
		WHERE C.COPA_OID_PARA_GRAL = #value#
 	</select>

	<resultMap id="concursoAmbitoGeograficoResult"   class="concursoAmbitoGeografico">
		<result property="oid"				  		  		column="OID_AMBITO_GEOGRAFICO"/>					
		<result property="oidSeccion"						column="ZSCC_OID_SECC"/>
		<result property="oidRegion"						column="ZORG_OID_REGI"/>
		<result property="oidSubgerencia"					column="ZSGV_OID_SUBG_VENT"/>
		<result property="oidTerritorio"					column="TERR_OID_TERR"/>
		<result property="oidZona"							column="ZZON_OID_ZONA"/>
		<result property="oidConcurso"						column="COPA_OID_PARA_GRAL"/>
		<result property="descripcionSubGerencia"			column="DES_SUBG_VENT"/>		
		<result property="descripcionRegion"				column="DES_REGI"/>
		<result property="descripcionZona"					column="DES_ZONA"/>
    </resultMap>

	<select id="getListConcursoAmbitoGeografico" parameterClass="string" resultMap="concursoAmbitoGeograficoResult">
		SELECT C.*, 
		      sub.DES_SUBG_VENT, 
		      reg.DES_REGI, 
		      zon.DES_ZONA       
		 FROM INC_AMBIT_GEOGR C, ZON_SUB_GEREN_VENTA sub, ZON_REGIO reg, ZON_ZONA zon
		WHERE COPA_OID_PARA_GRAL = #value#
		  AND sub.OID_SUBG_VENT = c.ZSGV_OID_SUBG_VENT
		  AND reg.OID_REGI = c.ZORG_OID_REGI
		  AND zon.OID_ZONA(+) = c.ZZON_OID_ZONA
		ORDER BY reg.DES_REGI, zon.COD_ZONA
 	</select>

	<resultMap id="concursoParametrosConsultorasResult"   class="concursoParametrosConsultoras">
		<result property="oid"					  		  	column="OID_CONC_PARA_CONS"/>					
		<result property="indicadorRecomendacionEfectiva"	column="IND_RECO_EFEC"/>
		<result property="periodosEvaluacion"				column="VAL_PERI_EVAL"/>
		<result property="indicadorControlRecomendadas"		column="IND_CONT_RECO"/>
		<result property="numeroMinimoPedidos"				column="NUM_MINI_PEDI"/>
		<result property="numeroMinimoPedidosRecomendada"	column="NUM_MINI_PEDI_RECO"/>
		<result property="montoMinimoPedido"				column="IMP_MONT_MINI_PEDI"/>
		<result property="unidadesMinimasPedido"			column="NUM_UNID_MINI_PEDI"/>
		<result property="indicadorReingresoPierdePuntaje"	column="IND_REIN_PIER_PUNT"/>
		<result property="oidConcurso"						column="COPA_OID_PARA_GRAL"/>
		<result property="oidPeriodoDesde"					column="PERD_OID_PERI_DESD"/>
		<result property="oidPeriodoInicialEvaluacion"		column="PERD_OID_PERI_INIC_EVAL"/>
		<result property="oidPeriodoHasta"					column="PERD_OID_PERI_HAST"/>
		<result property="oidTipoVenta"						column="TVEN_OID_TIPO_VENT"/>
		<result property="indicadorPremioCampEfect"			column="IND_PREM_CAMP_EFEC"/>
		<result property="generarPuntajeARecomendadas"		column="IND_GENE_PUNT_A_RECO"/>
		<result property="oidConcursoPuntajeRecomendada"	column="COPA_CONC_PUNT_RECO"/>
		<result property="tipoEvaluacion"					column="IND_TIPO_EVAL_MONT"/>
		<result property="codigoPeriodoEvaluacion"		    column="COD_PERI_EVAL"/>
		<result property="numeroConcursoPuntajeRecomendada"	column="NUM_CONC"/>
    </resultMap>

	<select id="getConcursoParametrosConsultoras" parameterClass="string" resultMap="concursoParametrosConsultorasResult">
		SELECT C.*,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_INIC_EVAL) COD_PERI_EVAL,
		       D.NUM_CONC
		  FROM INC_CONCU_PARAM_CONSU C, INC_CONCU_PARAM_GENER D
		 WHERE C.COPA_OID_PARA_GRAL = #value#	
		   AND C.COPA_CONC_PUNT_RECO = D.OID_PARA_GRAL(+)
 	</select>	

	<resultMap id="concursoMontoVentasResult"   class="concursoMontoVentas">
		<result property="oid"					  	column="OID_MONT_VENT_RECO"/>					
		<result property="cantidadMontoVenta"		column="VAL_CANT_MONT_VENT"/>
		<result property="oidConcurso"				column="COPA_OID_PARA_GRAL"/>
		<result property="oidTipoMontoVenta"		column="TMVR_OID_TIPO_MONT_VENT_RECO"/>
    </resultMap>

	<select id="getListConcursoMontoVentas" parameterClass="string" resultMap="concursoMontoVentasResult">
		SELECT C.*
		  FROM INC_MONTO_VENTA_RECOM C
		 WHERE C.COPA_OID_PARA_GRAL = #value#	
 	</select>	
	
	<resultMap id="concursoEstatusVentaResult"   class="concursoEstatusVenta">
		<result property="oid"					 	 	column="OID_ESTA_VENT"/>					
		<result property="oidConcurso"					column="COPA_OID_PARA_GRAL"/>
		<result property="oidEstatusCliente"			column="ESTA_OID_ESTA_CLIE"/>
		<result property="oidPeriodoDesde"				column="PERD_OID_PERI_DESD"/>
		<result property="oidPeriodoHasta"				column="PERD_OID_PERI_HAST"/>
		<result property="codigoPeriodoDesde"			column="COD_PERI_DESD"/>
		<result property="codigoPeriodoHasta"			column="COD_PERI_HAST"/>
		<result property="descripcionEstatusCliente"	column="DES_ESTA_CLIE"/>
    </resultMap>
     	     
 	<select id="getListConcursoEstatusVenta" parameterClass="string" resultMap="concursoEstatusVentaResult">
 		SELECT C.*,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_DESD) COD_PERI_DESD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_HAST) COD_PERI_HAST,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, c.ESTA_OID_ESTA_CLIE, 'MAE_ESTAT_CLIEN') DES_ESTA_CLIE
		  FROM INC_ESTAT_VENTA_CONSU C
		 WHERE C.COPA_OID_PARA_GRAL = #value#	
	     ORDER BY 1		 
 	</select>
 	
 	<resultMap id="concursoClasificacionParticipanteResult"   class="concursoClasificacionParticipante">
		<result property="oid"					  	column="OID_CLAS_PART_CONC"/>					
		<result property="oidConcurso"				column="COPA_OID_PARA_GRAL"/>
		<result property="oidClasificacion"			column="PACI_OID_PART_CONC_CABE"/>
		<result property="excluirClasificacion"		column="IND_EXCL"/>
		<result property="descripcionClasificacion"	column="DES_DESC"/>
    </resultMap>
	     	     
 	<select id="getListConcursoClasificacionParticipante" parameterClass="string" resultMap="concursoClasificacionParticipanteResult">
		SELECT C.*,
		       D.DES_DESC
		  FROM INC_CLASI_PARTI_CONCU C, INC_PARTI_CONCU_CABEC D
		 WHERE C.COPA_OID_PARA_GRAL = #value#	
		   AND C.PACI_OID_PART_CONC_CABE = D.OID_PART_CONC_CABE
 	</select>
 	
 	<resultMap id="concursoRequisitoPremiacionResult"   class="concursoRequisitoPremiacion">
		<result property="oid"					  		column="OID_REQU_PREM"/>					
		<result property="montoMinimoConcurso"			column="VAL_MONT_MINI_CONC"/>
		<result property="numeroPedidos"				column="NUM_PEDI"/>
		<result property="cuotaIngreso"					column="VAL_CUOT_INGR"/>
		<result property="indicadorPedidoEnPeriodo"		column="IND_PEDI_PERI"/>
		<result property="montoMinimoPedido"			column="VAL_MONT_MINI_PEDI"/>
		<result property="indicadorPagoATiempo"			column="IND_PAGO_TIEM"/>
		<result property="diasGracia"					column="NUM_DIAS_GRAC"/>
		<result property="indicadorAsistenciaCurso"		column="IND_ASIS_CURS"/>
		<result property="oidConcurso"					column="COPA_OID_PARA_GRAL"/>
		<result property="oidPeriodoHasta"				column="PERD_OID_PERI"/>
		<result property="oidPeriodoDesde"				column="PERD_OID_PERI_DESD"/>
		<result property="periodosEsperaPago"			column="NUM_PERI_ESPE_PAGO"/>
		<result property="oidperiodoMaximo"				column="PERD_OID_PERI_MAXI"/>
		<result property="oidValidaDeuda"				column="VADE_OID_VALI_DEUD"/>
		<result property="indicadorDespacho"			column="IND_DESP_CAMP_PUNT"/>	
		<result property="indicadorPriorizaWeb"			column="IND_PRIO_EWEB"/>			
    </resultMap>

	<select id="getConcursoRequisitoPremiacion" parameterClass="string" resultMap="concursoRequisitoPremiacionResult">
		SELECT C.*
		  FROM INC_REQUI_PREMI C
		 WHERE C.COPA_OID_PARA_GRAL = #value#	
 	</select>	

	<resultMap id="concursoParametrosPremiacionResult"   class="concursoParametrosPremiacion">
		<result property="oid"					  		  	column="OID_PARA_GENE_PREM"/>					
		<result property="numeroNiveles"					column="NUM_NIVE"/>
		<result property="indicadorNivelElegible"			column="IND_NIVE_ELEG"/>
		<result property="premiosAcumulativosNiveles"		column="IND_PREM_ACUM_NIVE"/>
		<result property="hastaNivel"						column="VAL_HAST_NIVE"/>
		<result property="indicadorNivelesRotativos"		column="IND_NIVE_ROTA"/>
		<result property="numeroRotaciones"					column="NUM_ROTA"/>
		<result property="accesoNivelSuperior"				column="IND_NOPR_DEFE"/>
		<result property="indicadorPremiosElectivos"		column="IND_PREM_ELEC"/>
		<result property="periodoDespachoExigido"			column="IND_PERI_DESP_EXIG"/>
		<result property="numeroPeriodos"					column="NUM_PERI"/>
		<result property="indicadorComunicacion"			column="IND_COMU"/>
		<result property="oidMensaje"						column="MENS_OID_MENS"/>
		<result property="oidTipoEleccion"					column="TELE_OID_TIPO_ELEC"/>
		<result property="oidTipoPremiacion"				column="TPRM_OID_TIPO_PION"/>
		<result property="oidPeriodoDespacho"				column="PERD_OID_PERI"/>
		<result property="oidConcurso"						column="COPA_OID_PARA_GRAL"/>
		<result property="oidPeriodoDespachoInicio"		    column="PERD_OID_PERI_INIC"/>
		<result property="codigoPeriodoDespacho"		    column="COD_PERI_DESP"/>		
    	<result property="codigoPeriodoDespachoInicio"		column="COD_PERI_DESP_INIC"/>
    	<result property="porcentajeMaximoDescuentoCPP"		column="VAL_PORC_MAXI_DSTO"/>
    </resultMap>

	<select id="getConcursoParametrosPremiacion" parameterClass="string" resultMap="concursoParametrosPremiacionResult">
		SELECT C.*,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI) COD_PERI_DESP,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_INIC) COD_PERI_DESP_INIC
		  FROM INC_PARAM_GENER_PREMI C
		 WHERE C.COPA_OID_PARA_GRAL = #value#	
 	</select>	

 	<resultMap id="concursoNivelPremiacionResult"   class="concursoNivelPremiacion">
		<result property="oid"					  	column="OID_PARA_NIVE_PREM"/>					
		<result property="numeroNivel"				column="NUM_NIVE"/>
		<result property="cantidadFijaPuntos"		column="NUM_CANT_FIJA_PUNT"/>
		<result property="cantidadInicialPuntos"	column="NUM_CANT_INIC_PUNT"/>
		<result property="cantidadFinalPuntos"		column="NUM_CANT_FINA_PUNT"/>					
		<result property="indicadorNivelSelectivo"	column="VAL_NIVE_SELE"/>
		<result property="puntajeServicio"			column="VAL_PUNT_SERV"/>
		<result property="numeroAspirantes"			column="NUM_ASPI"/>
		<result property="oidPremiacion"			column="PAGP_OID_PARA_GENE_PREM"/>					
		<result property="oidTipoPremio"			column="TPRE_OID_TIPO_PREM"/>
		<result property="puntosProductosExigidos"	column="NUM_PUNT_PROD_EXIG"/>
		<result property="descripcionNivel"			column="VAL_DESC"/>
    <result property="plazoEntrega"				column="VAL_PLAZ_ENTR"/>
    </resultMap>
    	     	     
 	<select id="getListConcursoNivelPremiacion" parameterClass="string" resultMap="concursoNivelPremiacionResult">
		SELECT C.*
		  FROM INC_PARAM_NIVEL_PREMI C
		 WHERE C.PAGP_OID_PARA_GENE_PREM = #value#
		 ORDER BY C.NUM_NIVE
 	</select> 	
 	     
 	<resultMap id="concursoPremioArticuloResult"   class="concursoPremioArticulo">
		<result property="oid"					  	column="OID_PREM_ARTI"/>					
		<result property="numeroUnidades"			column="NUM_UNID"/>
		<result property="oidNivelPremiacion"		column="PANP_OID_PARA_NIVE_PREM"/>
    </resultMap>
    
 	<select id="getConcursoPremioArticulo" parameterClass="string" resultMap="concursoPremioArticuloResult">
		SELECT C.*
		  FROM INC_PREMI_ARTIC C
		 WHERE C.PANP_OID_PARA_NIVE_PREM = #value#
 	</select> 
 	 	     
 	<resultMap id="concursoLotePremioArticuloResult"   class="concursoLotePremioArticulo">
		<result property="oid"					  	column="OID_LOTE_PREM_ARTI"/>					
		<result property="numeroLote"				column="NUM_LOTE"/>
		<result property="numeroPremio"				column="NUM_PREM"/>
		<result property="oidPremioArticulo"		column="PRAR_OID_PREM_ARTI"/>
		<result property="descripcionLote"			column="VAL_DESC_LOTE_PREM_ARTI"/>
		<result property="indicadorPremiosWeb"		column="IND_PREMI_ELWEB"/>
    </resultMap>
    
 	<select id="getListConcursoLotePremioArticulo" parameterClass="string" resultMap="concursoLotePremioArticuloResult">
		SELECT C.*
		  FROM INC_LOTE_PREMI_ARTIC C
		 WHERE C.PRAR_OID_PREM_ARTI = #value#
		 ORDER BY C.NUM_PREM
 	</select> 
	 	
 	<resultMap id="concursoArticuloLoteResult"   class="concursoArticuloLote">
		<result property="oid"					  		column="OID_ARTI_LOTE"/>					
		<result property="indicadorDespacho"			column="IND_DESP"/>
		<result property="precioPublico"				column="IMP_PREC_PUBL"/>
		<result property="numeroUnidades"				column="NUM_UNID"/>
		<result property="codigoVentaFicticio"			column="COD_VENT_FICT"/>
		<result property="oidProducto"					column="PROD_OID_PROD"/>					
		<result property="oidLotePremioArticulo"		column="LOPA_OID_LOTE_PREM_ARTI"/>
		<result property="indicadorCentroServicio"		column="IND_CENT_DIST_GARA"/>
		<result property="oidCentroServGarantia"		column="CESE_OID_CESE_GARA"/>
		<result property="numeroMesesGarantia"			column="NUM_MESE_GARA"/>
		<result property="observaciones"				column="OBS_CENT_DIST"/>
		<result property="indicadorTipoEntrega"			column="IND_TIPO_ENTR_PREM"/>
		<result property="oidCentroServEntrega"			column="CESE_OID_CESE_ENTR"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionProducto"			column="DES_PROD"/>
    </resultMap>
    
 	<select id="getListConcursoArticuloLote" parameterClass="string" resultMap="concursoArticuloLoteResult">
		SELECT C.*, D.COD_SAP,
			   pq_apl_aux.Valor_Gen_I18n_Sicc(1, D.OID_PROD, 'MAE_PRODU') DES_PROD
		  FROM INC_ARTIC_LOTE C, MAE_PRODU D
		 WHERE C.LOPA_OID_LOTE_PREM_ARTI = #value# AND (C.IND_TIPO_PREM = 'A' OR C.IND_TIPO_PREM IS NULL)
       	   AND C.PROD_OID_PROD = D.OID_PROD
       	 ORDER BY C.COD_VENT_FICT, D.COD_SAP 
 	</select> 	

 	<resultMap id="concursoProductosResult"   class="concursoProductos">
		<result property="oid"					  		column="OID_PROD"/>					
		<result property="comunicacionValidos"			column="VAL_COMU_VALI"/>
		<result property="mensajeValidos"				column="VAL_MENS_VALI"/>
		<result property="comunicacionExigidos"			column="VAL_COMU_EXIG"/>
		<result property="mensajeExigidos"				column="VAL_MENS_EXIG"/>					
		<result property="comunicacionExcluidos"		column="VAL_COMU_EXCL"/>
		<result property="mensajeExcluidos"				column="VAL_MENS_EXCL"/>
		<result property="comunicacionBonificados"		column="VAL_COMU_BONI"/>
		<result property="oidConcurso"					column="COPA_OID_PARA_GRAL"/>					
		<result property="mensajeBonificados"			column="VAL_MENS_BONI"/>
    </resultMap>
 	 	 	     
	<select id="getConcursoProductos" parameterClass="string" resultMap="concursoProductosResult">
		SELECT C.*
		  FROM INC_PRODU C
		 WHERE C.COPA_OID_PARA_GRAL = #value#
 	</select>

 	<resultMap id="concursoProductosValidosResult"   class="concursoProductosValidos">
		<result property="oid"					  		column="OID_PROD_VALI"/>					
		<result property="oidTipoOferta"				column="TOFE_OID_TIPO_OFER"/>
		<result property="oidProductos"					column="PRDU_OID_PROD"/>
		<result property="oidUnidadNegocio"				column="UNEG_OID_UNID_NEGO"/>
		<result property="oidSuperGenerico"				column="SGEN_OID_SUPE_GENE"/>					
		<result property="oidCicloVida"					column="CIVI_OID_CICL_VIDA"/>
		<result property="oidNegocio"					column="NEGO_OID_NEGO"/>
		<result property="oidGenerico"					column="GENE_OID_GENE"/>
		<result property="oidProducto"					column="PROD_OID_PROD"/>					
		<result property="oidMarcaProducto"				column="MAPR_OID_MARC_PROD"/>
		<result property="oidDetalleOferta"				column="OFDE_OID_DETA_OFER"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionTipoOferta"		column="DES_TIPO_OFER"/>
		<result property="descripcionUnidadNegocio"		column="DES_UNID_NEGO"/>
		<result property="descripcionSuperGenerico"		column="DES_SUPE_GENE"/>
		<result property="descripcionCicloVida"			column="DES_CICL_VIDA"/>
		<result property="descripcionNegocio"			column="DES_NEGO"/>
		<result property="descripcionGenerico"			column="DES_GENE"/>
		<result property="descripcionMarcaProducto"		column="DES_MARC_PROD"/>
		<result property="codigoSuperGenerico"			column="COD_SUPE_GENE"/>
		<result property="codigoGenerico"				column="COD_GENE"/>
    <result property="descripcionProducto"			column="DES_PROD"/>
		<result property="descripcionCUV"				column="DES_CUV"/>
    </resultMap>
 	 	 	     
	<select id="getListConcursoProductosValidos" parameterClass="string" resultMap="concursoProductosValidosResult">
		SELECT C.*,
			   P.COD_SAP,
   		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.TOFE_OID_TIPO_OFER, 'PRE_TIPO_OFERT') DES_TIPO_OFER,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.UNEG_OID_UNID_NEGO, 'MAE_UNIDA_NEGOC') DES_UNID_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.SGEN_OID_SUPE_GENE, 'MAE_SUPER_GENER') DES_SUPE_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.CIVI_OID_CICL_VIDA, 'PRE_CICLO_VIDA') DES_CICL_VIDA,		       		       
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.NEGO_OID_NEGO, 'MAE_NEGOC') DES_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.GENE_OID_GENE, 'MAE_GENER') DES_GENE,
		       M.DES_MARC_PROD,
		       S.COD_SUPE_GENE,
		       G.COD_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, P.OID_PROD, 'MAE_PRODU') DES_PROD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_DETAL_CUV(C.OFDE_OID_DETA_OFER) DES_CUV
		  FROM INC_PRODU_VALID C, 
		       MAE_PRODU P,
		       SEG_MARCA_PRODU M,
		       MAE_SUPER_GENER S,
		       MAE_GENER G
		 WHERE C.PRDU_OID_PROD = #value#
		   AND C.MAPR_OID_MARC_PROD = M.OID_MARC_PROD (+)
		   AND C.PROD_OID_PROD = P.OID_PROD (+)
		   AND C.SGEN_OID_SUPE_GENE = S.OID_SUPE_GENE (+)
		   AND C.GENE_OID_GENE = G.OID_GENE (+)
 	</select>
 	
 	<resultMap id="concursoProductosBonificadosResult"   class="concursoProductosBonificados">
		<result property="oid"					  		column="OID_PROD_BONI"/>					
		<result property="puntosUnidad"					column="NUM_PUNT_UNID"/>
		<result property="factorMultiplicador"			column="VAL_FACT_MULT"/>
		<result property="oidProductos"					column="PRDU_OID_PROD"/>
		<result property="oidCicloVida"					column="CIVI_OID_CICL_VIDA"/>					
		<result property="oidNegocio"					column="NEGO_OID_NEGO"/>
		<result property="oidPeriodoDesde"				column="PERD_OID_PERI_DESD"/>
		<result property="oidSuperGenerico"				column="SGEN_OID_SUPE_GENE"/>
		<result property="oidTipoOferta"				column="TOFE_OID_TIPO_OFER"/>					
		<result property="oidGenerico"					column="GENE_OID_GENE"/>
		<result property="oidPeriodoHasta"				column="PERD_OID_PERI_HAST"/>
		<result property="oidUnidadNegocio"				column="UNEG_OID_UNID_NEGO"/>
		<result property="oidProducto"					column="PROD_OID_PROD"/>
		<result property="oidMarcaProducto"				column="MAPR_OID_MARC_PROD"/>
		<result property="oidDetalleOferta"				column="OFDE_OID_DETA_OFER"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionTipoOferta"		column="DES_TIPO_OFER"/>
		<result property="descripcionUnidadNegocio"		column="DES_UNID_NEGO"/>
		<result property="descripcionSuperGenerico"		column="DES_SUPE_GENE"/>
		<result property="descripcionCicloVida"			column="DES_CICL_VIDA"/>
		<result property="descripcionNegocio"			column="DES_NEGO"/>
		<result property="descripcionGenerico"			column="DES_GENE"/>
		<result property="descripcionMarcaProducto"		column="DES_MARC_PROD"/>
		<result property="codigoPeriodoDesde"			column="COD_PERI_DESD"/>
		<result property="codigoPeriodoHasta"			column="COD_PERI_HAST"/>
		<result property="codigoSuperGenerico"			column="COD_SUPE_GENE"/>
		<result property="codigoGenerico"				column="COD_GENE"/>
    <result property="descripcionProducto"			column="DES_PROD"/>
		<result property="descripcionCUV"				column="DES_CUV"/>
    </resultMap>
 	 	 	     
	<select id="getListConcursoProductosBonificados" parameterClass="string" resultMap="concursoProductosBonificadosResult">
		SELECT C.*,
			   P.COD_SAP,
   		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.TOFE_OID_TIPO_OFER, 'PRE_TIPO_OFERT') DES_TIPO_OFER,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.UNEG_OID_UNID_NEGO, 'MAE_UNIDA_NEGOC') DES_UNID_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.SGEN_OID_SUPE_GENE, 'MAE_SUPER_GENER') DES_SUPE_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.CIVI_OID_CICL_VIDA, 'PRE_CICLO_VIDA') DES_CICL_VIDA,		       		       
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.NEGO_OID_NEGO, 'MAE_NEGOC') DES_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.GENE_OID_GENE, 'MAE_GENER') DES_GENE,
		       M.DES_MARC_PROD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_DESD) COD_PERI_DESD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_HAST) COD_PERI_HAST,
		       S.COD_SUPE_GENE,
		       G.COD_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, P.OID_PROD, 'MAE_PRODU') DES_PROD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_DETAL_CUV(C.OFDE_OID_DETA_OFER) DES_CUV
		  FROM INC_PRODU_BONIF C, 
		       MAE_PRODU P,
		       SEG_MARCA_PRODU M,
		       MAE_SUPER_GENER S,
		       MAE_GENER G
		 WHERE C.PRDU_OID_PROD = #value#
		   AND C.MAPR_OID_MARC_PROD = M.OID_MARC_PROD (+)
		   AND C.PROD_OID_PROD = P.OID_PROD (+)
		   AND C.SGEN_OID_SUPE_GENE = S.OID_SUPE_GENE (+)
		   AND C.GENE_OID_GENE = G.OID_GENE (+)
 	</select>
 	 	
	<resultMap id="concursoProductosExcluidosResult"   class="concursoProductosExcluidos">
		<result property="oid"					  		column="OID_PROD_EXCL"/>					
		<result property="oidCicloVida"					column="CIVI_OID_CICL_VIDA"/>
		<result property="oidPeriodoHasta"				column="PERD_OID_PERI_HAST"/>
		<result property="oidTipoOferta"				column="TOFE_OID_TIPO_OFER"/>
		<result property="oidPeriodoDesde"				column="PERD_OID_PERI_DESD"/>					
		<result property="oidSuperGenerico"				column="SGEN_OID_SUPE_GENE"/>
		<result property="oidProductos"					column="PRDU_OID_PROD"/>
		<result property="oidGenerico"					column="GENE_OID_GENE"/>
		<result property="oidNegocio"					column="NEGO_OID_NEGO"/>					
		<result property="oidUnidadNegocio"				column="UNEG_OID_UNID_NEGO"/>
		<result property="oidProducto"					column="PROD_OID_PROD"/>
		<result property="oidMarcaProducto"				column="MAPR_OID_MARC_PROD"/>
		<result property="oidDetalleOferta"				column="OFDE_OID_DETA_OFER"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionTipoOferta"		column="DES_TIPO_OFER"/>
		<result property="descripcionUnidadNegocio"		column="DES_UNID_NEGO"/>
		<result property="descripcionSuperGenerico"		column="DES_SUPE_GENE"/>
		<result property="descripcionCicloVida"			column="DES_CICL_VIDA"/>
		<result property="descripcionNegocio"			column="DES_NEGO"/>
		<result property="descripcionGenerico"			column="DES_GENE"/>
		<result property="descripcionMarcaProducto"		column="DES_MARC_PROD"/>
		<result property="codigoPeriodoDesde"			column="COD_PERI_DESD"/>
		<result property="codigoPeriodoHasta"			column="COD_PERI_HAST"/>
		<result property="codigoSuperGenerico"			column="COD_SUPE_GENE"/>
		<result property="codigoGenerico"				column="COD_GENE"/>
    <result property="descripcionProducto"			column="DES_PROD"/>
		<result property="descripcionCUV"				column="DES_CUV"/>
    </resultMap>
 	 	 	     
	<select id="getListConcursoProductosExcluidos" parameterClass="string" resultMap="concursoProductosExcluidosResult">
		SELECT C.*,
			   P.COD_SAP,
   		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.TOFE_OID_TIPO_OFER, 'PRE_TIPO_OFERT') DES_TIPO_OFER,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.UNEG_OID_UNID_NEGO, 'MAE_UNIDA_NEGOC') DES_UNID_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.SGEN_OID_SUPE_GENE, 'MAE_SUPER_GENER') DES_SUPE_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.CIVI_OID_CICL_VIDA, 'PRE_CICLO_VIDA') DES_CICL_VIDA,		       		       
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.NEGO_OID_NEGO, 'MAE_NEGOC') DES_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.GENE_OID_GENE, 'MAE_GENER') DES_GENE,
		       M.DES_MARC_PROD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_DESD) COD_PERI_DESD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_HAST) COD_PERI_HAST,
		       S.COD_SUPE_GENE,
		       G.COD_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, P.OID_PROD, 'MAE_PRODU') DES_PROD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_DETAL_CUV(C.OFDE_OID_DETA_OFER) DES_CUV
		  FROM INC_PRODU_EXCLU C, 
		       MAE_PRODU P,
		       SEG_MARCA_PRODU M,
		       MAE_SUPER_GENER S,
		       MAE_GENER G
		 WHERE C.PRDU_OID_PROD = #value#
		   AND C.MAPR_OID_MARC_PROD = M.OID_MARC_PROD (+)
		   AND C.PROD_OID_PROD = P.OID_PROD (+)
		   AND C.SGEN_OID_SUPE_GENE = S.OID_SUPE_GENE (+)
		   AND C.GENE_OID_GENE = G.OID_GENE (+)
 	</select>

	<resultMap id="concursoProductosExigidosResult"   class="concursoProductosExigidos">
		<result property="oid"					  		column="OID_PROD_EXIG"/>					
		<result property="unidadesExigidas"				column="NUM_UNID_EXIG"/>
		<result property="montoExigido"					column="IMP_MONT_EXIG"/>
		<result property="puntosExigidos"				column="NUM_PUNT_EXIG"/>
		<result property="oidSuperGenerico"				column="SGEN_OID_SUPE_GENE"/>					
		<result property="oidGenerico"					column="GENE_OID_GENE"/>
		<result property="oidTipoOferta"				column="TOFE_OID_TIPO_OFER"/>
		<result property="oidPeriodoHasta"				column="PERD_OID_PERI_HAST"/>
		<result property="oidUnidadNegocio"				column="UNEG_OID_UNID_NEGO"/>					
		<result property="oidProductos"					column="PRDU_OID_PROD"/>
		<result property="oidNegocio"					column="NEGO_OID_NEGO"/>
		<result property="oidCicloVida"					column="CIVI_OID_CICL_VIDA"/>
		<result property="oidPeriodoDesde"				column="PERD_OID_PERI_DESD"/>
		<result property="oidProducto"					column="PROD_OID_PROD"/>
		<result property="oidMarcaProducto"				column="MAPR_OID_MARC_PROD"/>
		<result property="oidproductoExigidoOriginal"	column="PRE2_OID_PROD_EXIG"/>
		<result property="indicadorAgrupacion"			column="IND_AGRUP"/>
		<result property="oidDetalleOferta"				column="OFDE_OID_DETA_OFER"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionTipoOferta"		column="DES_TIPO_OFER"/>
		<result property="descripcionUnidadNegocio"		column="DES_UNID_NEGO"/>
		<result property="descripcionSuperGenerico"		column="DES_SUPE_GENE"/>
		<result property="descripcionCicloVida"			column="DES_CICL_VIDA"/>
		<result property="descripcionNegocio"			column="DES_NEGO"/>
		<result property="descripcionGenerico"			column="DES_GENE"/>
		<result property="descripcionMarcaProducto"		column="DES_MARC_PROD"/>
		<result property="codigoPeriodoDesde"			column="COD_PERI_DESD"/>
		<result property="codigoPeriodoHasta"			column="COD_PERI_HAST"/>
		<result property="descripcionAgrupacion"		column="DES_AGRU"/>
		<result property="codigoSuperGenerico"			column="COD_SUPE_GENE"/>
		<result property="codigoGenerico"				column="COD_GENE"/>
    <result property="descripcionProducto"			column="DES_PROD"/>
		<result property="descripcionCUV"				column="DES_CUV"/>
    </resultMap>
 	 	 	     
	<select id="getListConcursoProductosExigidos" parameterClass="string" resultMap="concursoProductosExigidosResult">
		SELECT C.*,
			   P.COD_SAP,
   		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.TOFE_OID_TIPO_OFER, 'PRE_TIPO_OFERT') DES_TIPO_OFER,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.UNEG_OID_UNID_NEGO, 'MAE_UNIDA_NEGOC') DES_UNID_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.SGEN_OID_SUPE_GENE, 'MAE_SUPER_GENER') DES_SUPE_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.CIVI_OID_CICL_VIDA, 'PRE_CICLO_VIDA') DES_CICL_VIDA,		       		       
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.NEGO_OID_NEGO, 'MAE_NEGOC') DES_NEGO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, C.GENE_OID_GENE, 'MAE_GENER') DES_GENE,
		       M.DES_MARC_PROD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_DESD) COD_PERI_DESD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(C.PERD_OID_PERI_HAST) COD_PERI_HAST,
		       DECODE(C.IND_AGRUP, 'T', 'Obligatorio', 'U', 'Opcional', '') DES_AGRU,
		       S.COD_SUPE_GENE,
		       G.COD_GENE,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, P.OID_PROD, 'MAE_PRODU') DES_PROD,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_DETAL_CUV(C.OFDE_OID_DETA_OFER) DES_CUV
		  FROM INC_PRODU_EXIGI C, 
		       MAE_PRODU P,
		       SEG_MARCA_PRODU M,
		       MAE_SUPER_GENER S,
		       MAE_GENER G
		 WHERE C.PRDU_OID_PROD = #value#
		   AND C.MAPR_OID_MARC_PROD = M.OID_MARC_PROD (+)
		   AND C.PROD_OID_PROD = P.OID_PROD (+)
		   AND C.SGEN_OID_SUPE_GENE = S.OID_SUPE_GENE (+)
		   AND C.GENE_OID_GENE = G.OID_GENE (+)
 	</select>
 	 	 	 	 	 	     
	<update id="updateConcursoParametrosGenerales" parameterClass="concursoParametrosGenerales">
		UPDATE INC_CONCU_PARAM_GENER
		   SET NUM_CONC                  = #numeroConcurso#,
			   NUM_VERS                  = #version#,
			   PAIS_OID_PAIS             = #oidPais#,      
			   VAL_NOMB                  = #nombreConcurso#,      
			   IND_RANK                  = #indicadorRanking#,      
			   IND_DEVO                  = #indicadorDevoluciones#,     
			   IND_ANUL                  = #indicadorAnulaciones#,      
			   VAL_FALT_NANU             = #faltantesNoAnunciados#,      
			   VAL_EXPR_PUNT             = #expresionPuntaje#,      
			   IND_PRUE                  = #indicadorPruebas#,      
			   VAL_OBSE                  = #observaciones#,      
			   IND_ACTI                  = #indicadorActivo#,      
			   VAL_ESTA_GENE_META        = #estatusGeneracionMetas#,      
			   IND_COMU                  = #indicadorComunicacion#,      
			   COD_MENS                  = #codigoMensaje#,      
			   PLC2_OID_PLAN_CONC        = #oidPlantilla#,      
			   COIV_OID_CONC_IVR         = #oidTipoConcursoIVR#,      
			   PERD_OID_PERI_DESD        = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),      
			   PERD_OID_PERI_HAST        = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),      
			   TEXI_OID_TIPO_EXIG        = #oidTipoExigencia#,      
			   DIRI_OID_DIRI             = #dirigidoA#,      
			   BCAL_OID_BASE_CALC        = #oidBaseCalculo#,      
			   MARC_OID_MARC             = #oidMarca#,      
			   CANA_OID_CANA             = #oidCanal#,      
			   IND_DUPL_CYZO             = #indicadorDuplaCyzone#,      
			   ICTP_OID_TIPO_PROG        = #oidTipoPrograma#,      
			   IND_NO_GENE_PUNT          = #indicadorNoGeneraPuntaje#,      
			   CCON_OID_CLAS_CONC        = #oidClasificacionConcurso#,      
			   TIOC_OID_TIPO_OFER_CONC   = #oidTipoOfertaConcurso#,      
			   USU_MODI                  = #auditInfo.updatedBy#,      
			   FEC_MODI		             = #auditInfo.lastUpdated#,
			   IND_MULT_MARC		     = #indicadorMultiMarca#,
			   NUM_PUNT_ABON		     = #puntosAbonar#,
			   IND_PROG_PUNT			 = #indicadorCPP#,
			   COPA_CONC_PROG_PUNT		 = #oidCPP#
		 WHERE OID_PARA_GRAL = #oid#
	</update> 
    
    <update id="updateConcursoVersion" parameterClass="concursoVersion">
		UPDATE INC_VERSI_CONCU
		   SET VAL_VERS_NUEV               = #versionNueva#,
			   NUM_CONC          		   = #numeroConcurso#,		   
			   PERD_OID_PERI          	   = #oidPeriodo#,
			   COPA_OID_PARA_GRAL          = #oidConcurso#,
			   COPA_OID_PARA_GRAL_ORIG     = #oidConcursoOrigen#,
			   ESC2_OID_ESTA_CONC          = #oidEstadoConcurso#,
			   VICO_OID_VIGE_CONC          = #oidVigenciaConcurso#,
			   USU_MODI                    = #auditInfo.updatedBy#,   
			   FEC_MODI		               = #auditInfo.lastUpdated#
		 WHERE OID_VERS_CONC = #oid#
    </update>

    <update id="updateConcursoObtencionPuntos" parameterClass="concursoObtencionPuntos">
		UPDATE INC_OBTEN_PUNTO
		   SET VAL_FACT_CONV            = #factorConversion#,
			   NUM_PUNT_ASIG          	= #numeroPuntosAsignar#,		   
			   IND_COMU_OBTE          	= #indicadorComunicacion#,
			   VAL_PUNT_ACUM          	= #indicadorPuntajeAcumulativo#,
			   IND_ACTI     			= #indicadorActividad#,
			   IND_CONS          		= #indicadorConstancia#,
			   COPA_OID_PARA_GRAL   	= #oidConcurso#,
			   MENS_OID_MENS          	= (SELECT OID_MENS FROM MSG_MENSA WHERE COD_MENS = #codigoMensaje#),
			   NUM_CAMP_SINP_PERM      	= #numeroPeriodosSinPedido#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#,
			   IND_EXIG_CAMP_ANTE		= #indicadorExigePasarPedidoCampanyaAnteriorCPP#, 
			   PUN_ABON_REFE_PROG_PUNT	= #puntosAbonarRecomendacionEfectivaCPP#,
			   NUM_CAMP_SINP_CANC_PUNT	= #campanyasSinPedidoParaCancelacionPuntosCPP#,
			   IND_TIPO_CUAD			= #tipoCuadre#			   
		 WHERE OID_OBTE_PUNT = #oid#
    </update>

    <update id="updateConcursoDespachoPremios" parameterClass="concursoDespachoPremios">
    	UPDATE INC_DESPA_PREMI
		   SET IND_COMU_DESP_AUTO           = #indicadorComunicacionAutomatico#,
			   IND_COMU_DESP_MANU          	= #indicadorComunicacionManual#,		   
			   COPA_OID_PARA_GRAL          	= #oidConcurso#,
			   MENS_OID_MENS_AUTO          	= (SELECT OID_MENS FROM MSG_MENSA WHERE COD_MENS = #codigoMensajeAutomatico#),
			   MENS_OID_MENS_MANU     		= (SELECT OID_MENS FROM MSG_MENSA WHERE COD_MENS = #codigoMensajeManual#),
			   USU_MODI                     = #auditInfo.updatedBy#,      
			   FEC_MODI		                = #auditInfo.lastUpdated#
		 WHERE OID_DESP_PREM = #oid#
    </update>

    <update id="updateConcursoAmbitoGeografico" parameterClass="concursoAmbitoGeografico">
		UPDATE INC_AMBIT_GEOGR
		   SET ZSCC_OID_SECC            = #oidSeccion#,
			   ZORG_OID_REGI          	= #oidRegion#,		   
			   ZSGV_OID_SUBG_VENT      	= #oidSubgerencia#,
			   TERR_OID_TERR          	= #oidTerritorio#,
			   ZZON_OID_ZONA          	= #oidZona#,
			   COPA_OID_PARA_GRAL     	= #oidConcurso#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#
		 WHERE OID_AMBITO_GEOGRAFICO = #oid#
    </update>

	<update id="updateConcursoParametrosConsultoras" parameterClass="concursoParametrosConsultoras">
		UPDATE INC_CONCU_PARAM_CONSU
		   SET IND_RECO_EFEC                 = #indicadorRecomendacionEfectiva#,
			   VAL_PERI_EVAL                 = #periodosEvaluacion#,
			   IND_CONT_RECO                 = #indicadorControlRecomendadas#,      
			   NUM_MINI_PEDI                 = #numeroMinimoPedidos#,      
			   NUM_MINI_PEDI_RECO            = #numeroMinimoPedidosRecomendada#,
			   IMP_MONT_MINI_PEDI            = #montoMinimoPedido#,     
			   NUM_UNID_MINI_PEDI            = #unidadesMinimasPedido#,      
			   IND_REIN_PIER_PUNT            = #indicadorReingresoPierdePuntaje#,      
			   COPA_OID_PARA_GRAL            = #oidConcurso#,      
			   PERD_OID_PERI_DESD            = #oidPeriodoDesde#,     
			   
			   <isNotEmpty property="codigoPeriodoEvaluacion">
			   	PERD_OID_PERI_INIC_EVAL       = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoEvaluacion#),
			   </isNotEmpty>
			         
			   PERD_OID_PERI_HAST            = #oidPeriodoHasta#,      
			   TVEN_OID_TIPO_VENT        	 = #oidTipoVenta#,      
			   IND_PREM_CAMP_EFEC            = #indicadorPremioCampEfect#,      
			   IND_GENE_PUNT_A_RECO          = #generarPuntajeARecomendadas#,      
			   COPA_CONC_PUNT_RECO       	 = #oidConcursoPuntajeRecomendada#,
			   IND_TIPO_EVAL_MONT       	 = #tipoEvaluacion#,
			   USU_MODI                      = #auditInfo.updatedBy#,      
			   FEC_MODI		                 = #auditInfo.lastUpdated#      
		 WHERE OID_CONC_PARA_CONS = #oid#
	</update> 
	
    <update id="updateConcursoMontoVentas" parameterClass="concursoMontoVentas">
		UPDATE INC_MONTO_VENTA_RECOM
		   SET VAL_CANT_MONT_VENT       	= #cantidadMontoVenta#,
			   COPA_OID_PARA_GRAL          	= #oidConcurso#,		   
			   TMVR_OID_TIPO_MONT_VENT_RECO = #oidTipoMontoVenta#,
			   USU_MODI                     = #auditInfo.updatedBy#,      
			   FEC_MODI		                = #auditInfo.lastUpdated#
		 WHERE OID_MONT_VENT_RECO = #oid#
    </update>	

    <update id="updateConcursoEstatusVenta" parameterClass="concursoEstatusVenta">
		UPDATE INC_ESTAT_VENTA_CONSU
		   SET COPA_OID_PARA_GRAL       	= #oidConcurso#,
			   ESTA_OID_ESTA_CLIE          	= #oidEstatusCliente#,		   
			   PERD_OID_PERI_DESD 			= GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			   PERD_OID_PERI_HAST			= GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
			   USU_MODI                     = #auditInfo.updatedBy#,      
			   FEC_MODI		                = #auditInfo.lastUpdated#
		 WHERE OID_ESTA_VENT = #oid#
    </update>	

    <update id="updateConcursoClasificacionParticipante" parameterClass="concursoClasificacionParticipante">
		UPDATE INC_CLASI_PARTI_CONCU
		   SET COPA_OID_PARA_GRAL       	= #oidConcurso#,
			   PACI_OID_PART_CONC_CABE      = #oidClasificacion#,
			   IND_EXCL						= #excluirClasificacion#,
			   USU_MODI                     = #auditInfo.updatedBy#,      
			   FEC_MODI		                = #auditInfo.lastUpdated#
		 WHERE OID_CLAS_PART_CONC = #oid#
    </update>	
    
    <update id="updateConcursoRequisitoPremiacion" parameterClass="concursoRequisitoPremiacion">
		UPDATE INC_REQUI_PREMI
		   SET VAL_MONT_MINI_CONC   = #montoMinimoConcurso#,
			   NUM_PEDI         	= #numeroPedidos#,
			   VAL_CUOT_INGR    	= #cuotaIngreso#,
			   IND_PEDI_PERI 		= #indicadorPedidoEnPeriodo#,
			   VAL_MONT_MINI_PEDI 	= #montoMinimoPedido#,
			   IND_PAGO_TIEM 		= #indicadorPagoATiempo#,
			   NUM_DIAS_GRAC 	 	= #diasGracia#,
			   IND_ASIS_CURS 		= #indicadorAsistenciaCurso#,
			   COPA_OID_PARA_GRAL 	= #oidConcurso#,
			   PERD_OID_PERI 		= #oidPeriodoHasta#,
			   PERD_OID_PERI_DESD 	= #oidPeriodoDesde#,
			   NUM_PERI_ESPE_PAGO 	= #periodosEsperaPago#,
			   PERD_OID_PERI_MAXI 	= #oidperiodoMaximo#,
			   VADE_OID_VALI_DEUD 	= #oidValidaDeuda#,
			   IND_DESP_CAMP_PUNT	= #indicadorDespacho#,
			   IND_PRIO_EWEB     	= #indicadorPriorizaWeb#,	
			   USU_MODI             = #auditInfo.updatedBy#,      
			   FEC_MODI		        = #auditInfo.lastUpdated#
		 WHERE OID_REQU_PREM = #oid#
    </update>

    <update id="updateConcursoParametrosPremiacion" parameterClass="concursoParametrosPremiacion">
		UPDATE INC_PARAM_GENER_PREMI
		   SET NUM_NIVE       	     = #numeroNiveles#,
			   IND_NIVE_ELEG         = #indicadorNivelElegible#,
			   IND_PREM_ACUM_NIVE    = #premiosAcumulativosNiveles#,
			   VAL_HAST_NIVE 		 = #hastaNivel#,
			   IND_NIVE_ROTA 		 = #indicadorNivelesRotativos#,
			   NUM_ROTA 			 = #numeroRotaciones#,
			   IND_NOPR_DEFE 		 = #accesoNivelSuperior#,
			   IND_PREM_ELEC 		 = #indicadorPremiosElectivos#,
			   IND_PERI_DESP_EXIG 	 = #periodoDespachoExigido#,
			   NUM_PERI 			 = #numeroPeriodos#,
			   IND_COMU 			 = #indicadorComunicacion#,
			   MENS_OID_MENS 		 = #oidMensaje#,
			   TELE_OID_TIPO_ELEC 	 = #oidTipoEleccion#,
			   TPRM_OID_TIPO_PION 	 = #oidTipoPremiacion#,
			   
			   <isNotEmpty property="codigoPeriodoDespacho">
			   	PERD_OID_PERI 	  	 = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDespacho#),
			   </isNotEmpty>
			   <isEmpty property="codigoPeriodoDespacho">
			   PERD_OID_PERI 	  	 = NULL,
			   </isEmpty>
			   	
			   <isNotEmpty property="codigoPeriodoDespachoInicio">
			   	PERD_OID_PERI_INIC 	   = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDespachoInicio#),
			   </isNotEmpty>
			   <isEmpty property="codigoPeriodoDespachoInicio">
			   PERD_OID_PERI_INIC 	  	 = NULL,
			   </isEmpty>
			  
			   VAL_PORC_MAXI_DSTO	 = #porcentajeMaximoDescuentoCPP#,	
	   		   COPA_OID_PARA_GRAL 	 = #oidConcurso#,
	   		   USU_MODI              = #auditInfo.updatedBy#,      
			   FEC_MODI		         = #auditInfo.lastUpdated#
		 WHERE OID_PARA_GENE_PREM 	 = #oid#
    </update>

    <update id="updateConcursoNivelPremiacion" parameterClass="concursoNivelPremiacion">
		UPDATE INC_PARAM_NIVEL_PREMI
		   SET NUM_NIVE       	    	 = #numeroNivel#,
			   NUM_CANT_FIJA_PUNT        = #cantidadFijaPuntos#,
			   NUM_CANT_INIC_PUNT    	 = #cantidadInicialPuntos#,
			   NUM_CANT_FINA_PUNT 		 = #cantidadFinalPuntos#,
			   VAL_NIVE_SELE 			 = #indicadorNivelSelectivo#,
			   VAL_PUNT_SERV 			 = #puntajeServicio#,
			   NUM_ASPI 	 			 = #numeroAspirantes#,
			   PAGP_OID_PARA_GENE_PREM 	 = #oidPremiacion#,
			   TPRE_OID_TIPO_PREM 	 	 = #oidTipoPremio#,
			   NUM_PUNT_PROD_EXIG 		 = #puntosProductosExigidos#,
			   VAL_DESC 			 	 = #descripcionNivel#,
			   VAL_PLAZ_ENTR 			 = #plazoEntrega#,
			   USU_MODI                  = #auditInfo.updatedBy#,      
			   FEC_MODI		             = #auditInfo.lastUpdated#
		 WHERE OID_PARA_NIVE_PREM 	 	 = #oid#
    </update>
    
    <update id="updateConcursoPremioArticulo" parameterClass="concursoPremioArticulo">
		UPDATE INC_PREMI_ARTIC
		   SET NUM_UNID       	    	 = #numeroUnidades#,
			   PANP_OID_PARA_NIVE_PREM   = #oidNivelPremiacion#,
			   USU_MODI                  = #auditInfo.updatedBy#,      
			   FEC_MODI		             = #auditInfo.lastUpdated#
		 WHERE OID_PREM_ARTI 	 	 = #oid#
    </update>

    <update id="updateConcursoLotePremioArticulo" parameterClass="concursoLotePremioArticulo">
		UPDATE INC_LOTE_PREMI_ARTIC
		   SET NUM_LOTE       	    	= #numeroLote#,
			   NUM_PREM   				= #numeroPremio#,
			   PRAR_OID_PREM_ARTI       = #oidPremioArticulo#,
			   VAL_DESC_LOTE_PREM_ARTI  = #descripcionLote#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#,
			   IND_PREMI_ELWEB          = #indicadorPremiosWeb#
		 WHERE OID_LOTE_PREM_ARTI 	 	= #oid#
    </update>

    <update id="updateConcursoArticuloLote" parameterClass="concursoArticuloLote">
		UPDATE INC_ARTIC_LOTE
		   SET IND_DESP       	    	= #indicadorDespacho#,
			   IMP_PREC_PUBL   			= #precioPublico#,
			   NUM_UNID       			= #numeroUnidades#,
			   COD_VENT_FICT 			= #codigoVentaFicticio#,
			   PROD_OID_PROD       	    = (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			   LOPA_OID_LOTE_PREM_ARTI  = #oidLotePremioArticulo#,
			   IND_CENT_DIST_GARA       = #indicadorCentroServicio#,
			   CESE_OID_CESE_GARA  		= #oidCentroServGarantia#,
			   NUM_MESE_GARA  			= #numeroMesesGarantia#,
			   OBS_CENT_DIST       	    = #observaciones#,
			   IND_TIPO_ENTR_PREM   	= #indicadorTipoEntrega#,
			   CESE_OID_CESE_ENTR       = #oidCentroServEntrega#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#
		 WHERE OID_ARTI_LOTE 	 	= #oid#
    </update>

    <update id="updateConcursoProductos" parameterClass="concursoProductos">
		UPDATE INC_PRODU
		   SET VAL_COMU_VALI       	    = #comunicacionValidos#,
			   VAL_MENS_VALI   			= #mensajeValidos#,
			   VAL_COMU_EXIG       		= #comunicacionExigidos#,
			   VAL_MENS_EXIG 			= #mensajeExigidos#,
			   VAL_COMU_EXCL       	    = #comunicacionExcluidos#,
			   VAL_MENS_EXCL  			= #mensajeExcluidos#,
			   VAL_COMU_BONI       		= #comunicacionBonificados#,
			   COPA_OID_PARA_GRAL  		= #oidConcurso#,
			   VAL_MENS_BONI  			= #mensajeBonificados#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#
		 WHERE OID_PROD 	 	= #oid#
    </update>

    <update id="updateConcursoProductosValidos" parameterClass="concursoProductosValidos">
		UPDATE INC_PRODU_VALID
		   SET TOFE_OID_TIPO_OFER       = #oidTipoOferta#,
			   PRDU_OID_PROD   			= #oidProductos#,
			   UNEG_OID_UNID_NEGO       = #oidUnidadNegocio#,
			   SGEN_OID_SUPE_GENE 		= (SELECT OID_SUPE_GENE FROM MAE_SUPER_GENER WHERE COD_SUPE_GENE = #codigoSuperGenerico#),
			   CIVI_OID_CICL_VIDA       = #oidCicloVida#,
			   NEGO_OID_NEGO  			= #oidNegocio#,
			   GENE_OID_GENE       		= (SELECT OID_GENE FROM MAE_GENER WHERE COD_GENE = #codigoGenerico#),
			   
			   <isNotEmpty property="oidDetalleOferta">
			 		PROD_OID_PROD  		= NULL,
			   </isNotEmpty>
			   <isEmpty property="oidDetalleOferta">
			   PROD_OID_PROD  			= (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			   </isEmpty>	
			 
			   MAPR_OID_MARC_PROD  		= #oidMarcaProducto#,
			   OFDE_OID_DETA_OFER		= #oidDetalleOferta#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#
		 WHERE OID_PROD_VALI 	 	= #oid#
    </update>

    <update id="updateConcursoProductosBonificados" parameterClass="concursoProductosBonificados">
		UPDATE INC_PRODU_BONIF
		   SET NUM_PUNT_UNID    	    = #puntosUnidad#,
			   VAL_FACT_MULT   			= #factorMultiplicador#,
			   PRDU_OID_PROD       		= #oidProductos#,
			   CIVI_OID_CICL_VIDA 		= #oidCicloVida#,
			   NEGO_OID_NEGO       		= #oidNegocio#,
			   PERD_OID_PERI_DESD  		= GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			   SGEN_OID_SUPE_GENE       = (SELECT OID_SUPE_GENE FROM MAE_SUPER_GENER WHERE COD_SUPE_GENE = #codigoSuperGenerico#),
			   TOFE_OID_TIPO_OFER  		= #oidTipoOferta#,
			   GENE_OID_GENE  			= (SELECT OID_GENE FROM MAE_GENER WHERE COD_GENE = #codigoGenerico#),
			   
			   <isNotEmpty property="codigoPeriodoHasta">
			   		PERD_OID_PERI_HAST = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
			   </isNotEmpty>
			 
			   UNEG_OID_UNID_NEGO  		= #oidUnidadNegocio#,
			   
			   <isNotEmpty property="oidDetalleOferta">
			 		PROD_OID_PROD  		= NULL,
			   </isNotEmpty>
			   <isEmpty property="oidDetalleOferta">
			   PROD_OID_PROD  			= (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			   </isEmpty>
			   
			   MAPR_OID_MARC_PROD  		= #oidMarcaProducto#,
			   OFDE_OID_DETA_OFER		= #oidDetalleOferta#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#
		 WHERE OID_PROD_BONI 	 	= #oid#
    </update>

    <update id="updateConcursoProductosExcluidos" parameterClass="concursoProductosExcluidos">
		UPDATE INC_PRODU_EXCLU
		   SET CIVI_OID_CICL_VIDA       		= #oidCicloVida#,
		   
			   <isNotEmpty property="codigoPeriodoHasta">
			   		PERD_OID_PERI_HAST = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
			   </isNotEmpty>
		   
			   TOFE_OID_TIPO_OFER 		= #oidTipoOferta#,
			   PERD_OID_PERI_DESD  		= GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			   SGEN_OID_SUPE_GENE       = (SELECT OID_SUPE_GENE FROM MAE_SUPER_GENER WHERE COD_SUPE_GENE = #codigoSuperGenerico#),
			   PRDU_OID_PROD  			= #oidProductos#,
			   GENE_OID_GENE  			= (SELECT OID_GENE FROM MAE_GENER WHERE COD_GENE = #codigoGenerico#),
			   NEGO_OID_NEGO  			= #oidNegocio#,
			   UNEG_OID_UNID_NEGO  		= #oidUnidadNegocio#,
			   
			   <isNotEmpty property="oidDetalleOferta">
			 		PROD_OID_PROD  		= NULL,
			   </isNotEmpty>
			   <isEmpty property="oidDetalleOferta">
			   PROD_OID_PROD  			= (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			   </isEmpty>
			   
			   MAPR_OID_MARC_PROD  		= #oidMarcaProducto#,
			   OFDE_OID_DETA_OFER		= #oidDetalleOferta#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#
		 WHERE OID_PROD_EXCL 	 	= #oid#
    </update>

    <update id="updateConcursoProductosExigidos" parameterClass="concursoProductosExigidos">
		UPDATE INC_PRODU_EXIGI
		   SET NUM_UNID_EXIG       		= #unidadesExigidas#,
		   	   IMP_MONT_EXIG       		= #montoExigido#,
		   	   NUM_PUNT_EXIG       		= #puntosExigidos#,
			   SGEN_OID_SUPE_GENE       = (SELECT OID_SUPE_GENE FROM MAE_SUPER_GENER WHERE COD_SUPE_GENE = #codigoSuperGenerico#),
			   GENE_OID_GENE       		= (SELECT OID_GENE FROM MAE_GENER WHERE COD_GENE = #codigoGenerico#),
			   TOFE_OID_TIPO_OFER       = #oidTipoOferta#,
		   
			   <isNotEmpty property="codigoPeriodoHasta">
			   		PERD_OID_PERI_HAST = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoHasta#),
			   </isNotEmpty>
		   
			   UNEG_OID_UNID_NEGO 		= #oidUnidadNegocio#,
			   PRDU_OID_PROD 			= #oidProductos#,
			   NEGO_OID_NEGO 			= #oidNegocio#,
			   CIVI_OID_CICL_VIDA 		= #oidCicloVida#,
			   PERD_OID_PERI_DESD  		= GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoDesde#),
			   
			   <isNotEmpty property="oidDetalleOferta">
			 		PROD_OID_PROD  		= NULL,
			   </isNotEmpty>
			   <isEmpty property="oidDetalleOferta">
			   PROD_OID_PROD  			= (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			   </isEmpty>
			   
			   MAPR_OID_MARC_PROD  		= #oidMarcaProducto#,
			   PRE2_OID_PROD_EXIG  		= #oidproductoExigidoOriginal#,
			   IND_AGRUP  				= #indicadorAgrupacion#,
			   OFDE_OID_DETA_OFER		= #oidDetalleOferta#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#
		 WHERE OID_PROD_EXIG 	 	= #oid#
    </update>
        
    <delete id="deleteConcursoAmbitoGeografico" parameterClass="string">
		DELETE FROM INC_AMBIT_GEOGR
		 WHERE COPA_OID_PARA_GRAL = #value# 
    </delete>

    <delete id="deleteConcursoEstatusVenta" parameterClass="string">
		DELETE FROM INC_ESTAT_VENTA_CONSU
		 WHERE COPA_OID_PARA_GRAL = #value# 
    </delete>

    <delete id="deleteConcursoClasificacionParticipante" parameterClass="string">
		DELETE FROM INC_CLASI_PARTI_CONCU
		 WHERE COPA_OID_PARA_GRAL = #value# 
    </delete>
    
    <delete id="deleteConcursoProductosValidos" parameterClass="string">
		DELETE FROM INC_PRODU_VALID
		 WHERE PRDU_OID_PROD = #value# 
    </delete>

    <delete id="deleteConcursoProductosBonificados" parameterClass="string">
		DELETE FROM INC_PRODU_BONIF
		 WHERE PRDU_OID_PROD = #value# 
    </delete>

    <delete id="deleteConcursoProductosExcluidos" parameterClass="string">
		DELETE FROM INC_PRODU_EXCLU
		 WHERE PRDU_OID_PROD = #value# 
    </delete>

    <delete id="deleteConcursoProductosExigidos" parameterClass="string">
		DELETE FROM INC_PRODU_EXIGI
		 WHERE PRDU_OID_PROD = #value# 
    </delete>
 	     
	<select id="getRegionesByOidSubGerencia" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT OID_REGI || '__' || DES_REGI AS CODIGO, 
		       DES_REGI AS DESCRIPCION
		  FROM ZON_REGIO 
		 WHERE IND_ACTI = 1
		 
		 	<isNotEmpty property="oidSubGerencia">
		 		AND ZSGV_OID_SUBG_VENT = #oidSubGerencia#
		 	</isNotEmpty>	 
		 ORDER BY 2
 	</select>
 	     
	<select id="getZonasByMultipleOidRegiones" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT ZORG_OID_REGI || '__' || OID_ZONA || '__' || DES_ZONA AS CODIGO, 
			   DES_ZONA AS DESCRIPCION
		  FROM ZON_ZONA
		 WHERE IND_ACTI = 1
		 
			<iterate prepend="AND" property="oidRegion" open="(" close=")" conjunction="OR">
				(ZORG_OID_REGI = #oidRegion[]#)      	 		
            </iterate>
		 
		 ORDER BY 2 	
 	</select>
	 	 
	<select id="getUltimoNumeroConcurso" parameterClass="java.util.Map" resultClass="string">
		SELECT INC_PKG_PROCE_INCEN.INC_FN_OBTIE_NUMER_CONCU 
 		  FROM DUAL
    </select>	
   
    <parameterMap id="executeObtenerUltimoContadorArticuloParams" class="java.util.Map">							
    	<parameter property="ultimoContador"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>														
	</parameterMap>
  														
  	<procedure id="executeObtenerUltimoContadorArticulo" parameterMap="executeObtenerUltimoContadorArticuloParams">														
			{call INC_PKG_PROCE_INCEN.INC_PR_OBTEN_ULTIM_CONTA_ARTIC(?)}											
	</procedure>
	   
	<resultMap id="datosTipoConcursoResult" class="java.util.HashMap">
	    <result property="descripcionTipoConcurso" 		column="DES_CLAS_CONC"/>
	    <result property="oidTipoPrograma"			    column="OID_TIPO_PROG"/>
	    <result property="descripcionTipoPrograma"		column="DES_TIPO_PROG"/>
	    <result property="oidPlantilla"					column="OID_PLAN_CONC"/>
	    <result property="oidConcursoIVR"				column="COIV_OID_CONC_IVR"/>
	    <result property="oidBaseCalculo"				column="BCAL_OID_BASE_CALC"/>
    </resultMap>

	<select id="getDatosTipoConcurso" parameterClass="string" resultMap="datosTipoConcursoResult">
		SELECT D.DES_CLAS_CONC,
		       C.OID_TIPO_PROG,
		       C.DES_TIPO_PROG,
		       B.OID_PLAN_CONC,
		       B.COIV_OID_CONC_IVR,
		       B.BCAL_OID_BASE_CALC
		  FROM INC_PARAM_TIPO_CLASI_CONCU A,
		       INC_PLANT_CONCU B,
		       INC_CONCU_TIPO_PROG C,
		       INC_CLASI_CONCU D
		 WHERE A.IND_ACTI = '1'
		   AND A.EST_REGI = '1'
		   AND A.ICTP_OID_TIPO_PROG = C.OID_TIPO_PROG(+)
		   AND A.CCON_OID_CLAS_CONC = D.OID_CLAS_CONC
		   AND A.PLC2_OID_PLAN_CONC = B.OID_PLAN_CONC
		   AND D.OID_CLAS_CONC = #value#
 	</select>
	   
	<select id="getExisteDespachoPremios" parameterClass="string" resultClass="string">
		SELECT COUNT(1)
		  FROM INC_CONCU_PARAM_GENER cpg,
		       INC_PARAM_GENER_PREMI pgp,
		       INC_PARAM_NIVEL_PREMI pnp,
		       INC_GANAD cg
		 WHERE cpg.OID_PARA_GRAL = #value#
		   AND cpg.OID_PARA_GRAL = pgp.COPA_OID_PARA_GRAL
		   AND pgp.OID_PARA_GENE_PREM = pnp.PAGP_OID_PARA_GENE_PREM 
		   AND pnp.OID_PARA_NIVE_PREM = cg.PANP_OID_PARA_NIVE_PREM 
		   AND ROWNUM = 1
	</select>

	<select id="getExistePuntajeConcurso" parameterClass="string" resultClass="string">
		SELECT count(1)
		  FROM INC_CUENT_CORRI_PUNTO
		 WHERE COPA_OID_PARA_GRAL = #value#
		   AND rownum = 1
	</select>
	
	<select id="getCodigoSAPRecomendacion" resultClass="string">
		SELECT COD_SAP 
		  FROM MAE_PRODU
		 WHERE UPPER(DES_CORT) LIKE '%ABONO POR CDR%'    
	</select>
   	   
	<select id="getEstados" resultMap="baseResult">
		SELECT x.CODIGO, 
		       x.DESCRIPCION
		  FROM (SELECT 1 CODIGO, 'Activo' DESCRIPCION
				  FROM DUAL
				UNION  
				SELECT 0, 'Inactivo'
				  FROM DUAL) x  
		 ORDER BY 2 	
	</select>
	
	<select id="getVigencias" resultMap="baseResult">
		SELECT OID_VIGE_CONC CODIGO, 
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_VIGE_CONC, 'INC_VIGEN_CONCU') DESCRIPCION
		  FROM INC_VIGEN_CONCU  
		 ORDER BY 2 	
	</select>
	
	<select id="getIndicadoresTipoRecomendada" resultMap="baseResult">
		SELECT x.CODIGO, 
		       x.DESCRIPCION
		  FROM (SELECT '1' CODIGO, 'Recomendante' DESCRIPCION
				  FROM DUAL
				UNION  
				SELECT '2', 'Recomendada'
				  FROM DUAL) x  
		 ORDER BY 2 	
	</select>
	   	 
	<insert id="insertConcursoRecomendadaPeriodo" parameterClass="concursoRecomendadaPeriodo">
		INSERT INTO INC_CONCU_RECOM_CAMPA_MONTO
            (COD_PAIS,
			 NUM_CONC,
			 IND_TIPO,
			 SEC_CAMP,
			 VAL_MONT,
			 USU_MODI,
			 FEC_MODI)
	     VALUES 
	     	(#codigoPais#,
			 #numeroConcurso#,
			 #indicadorTipo#,
			 #secuencia#,
			 #monto#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
	   	 
	<resultMap id="concursoRecomendadaPeriodoResult"   class="concursoRecomendadaPeriodo">
		<result property="codigoPais"			  	column="COD_PAIS"/>					
		<result property="numeroConcurso"			column="NUM_CONC"/>
		<result property="indicadorTipo"			column="IND_TIPO"/>
		<result property="secuencia"				column="SEC_CAMP"/>
		<result property="monto"					column="VAL_MONT"/>
		<result property="descripcionIndicadorTipo"	column="DES_INDI_TIPO"/>
    </resultMap>
	     	     
 	<select id="getListConcursoRecomendadaPeriodo" parameterClass="string" resultMap="concursoRecomendadaPeriodoResult">
		SELECT C.*,
		       DECODE(C.IND_TIPO, '1', 'Recomendante', 'Recomendada') DES_INDI_TIPO
		  FROM INC_CONCU_RECOM_CAMPA_MONTO C
		 WHERE C.NUM_CONC = #value#
 	</select>
	   	 
	<update id="updateConcursoRecomendadaPeriodo" parameterClass="concursoRecomendadaPeriodo">
		UPDATE INC_CONCU_RECOM_CAMPA_MONTO
		   SET VAL_MONT       	= #monto#,
			   USU_MODI         = #auditInfo.updatedBy#,      
			   FEC_MODI	        = #auditInfo.lastUpdated#
		 WHERE COD_PAIS = #codigoPais#
		   AND NUM_CONC = #numeroConcurso#
		   AND IND_TIPO = #indicadorTipo#
		   AND SEC_CAMP = #secuencia#
    </update>

    <delete id="deleteConcursoRecomendadaPeriodo" parameterClass="string">
		DELETE FROM INC_CONCU_RECOM_CAMPA_MONTO
		 WHERE NUM_CONC = #value#
    </delete>

	<insert id="insertConcursoBonificacionPeriodo" parameterClass="concursoBonificacionPeriodo">
		INSERT INTO INC_BONIF_EFECT_CAMPA
            (COD_PAIS,
			 NUM_CONC,
			 COD_PERI,
			 VAL_BONR,
			 USU_MODI,
			 FEC_MODI)
	     VALUES 
	     	(#codigoPais#,
			 #numeroConcurso#,
			 #codigoPeriodo#,
			 #puntos#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			)
    </insert>
	   	 
	<resultMap id="concursoBonificacionPeriodoResult"   class="concursoBonificacionPeriodo">
		<result property="codigoPais"			  	column="COD_PAIS"/>					
		<result property="numeroConcurso"			column="NUM_CONC"/>
		<result property="codigoPeriodo"			column="COD_PERI"/>
		<result property="puntos"					column="VAL_BONR"/>
    </resultMap>
	     	     
 	<select id="getListConcursoBonificacionPeriodo" parameterClass="string" resultMap="concursoBonificacionPeriodoResult">
		SELECT C.*
		  FROM INC_BONIF_EFECT_CAMPA C
		 WHERE C.NUM_CONC = #value#
 	</select>
	   	 
	<update id="updateConcursoBonificacionPeriodo" parameterClass="concursoBonificacionPeriodo">
		UPDATE INC_BONIF_EFECT_CAMPA
		   SET VAL_BONR       	= #puntos#,
			   USU_MODI         = #auditInfo.updatedBy#,      
			   FEC_MODI	        = #auditInfo.lastUpdated#
		 WHERE COD_PAIS = #codigoPais#
		   AND NUM_CONC = #numeroConcurso#
		   AND COD_PERI = #codigoPeriodo#
    </update>
    
    <delete id="deleteConcursoBonificacionPeriodo" parameterClass="string">
		DELETE FROM INC_BONIF_EFECT_CAMPA
		 WHERE NUM_CONC = #value#
    </delete>
    
	<insert id="insertConcursoPeriodoDespacho" parameterClass="concursoPeriodoDespacho">
		INSERT INTO INC_CONCU_CAMPA_DESPA
            (COD_PAIS,
			 NUM_CONC,
			 COD_PERI,
			 USU_MODI,
			 FEC_MODI,
			 COD_PERI_FIN)
	     VALUES 
	     	(#codigoPais#,
			 #numeroConcurso#,
			 #codigoPeriodo#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#
			<isNotEmpty property="codigoPeriodoFin">
			 ,#codigoPeriodoFin#
			</isNotEmpty>
			<isEmpty property="codigoPeriodoFin">
			 ,''
			</isEmpty>
			)
    </insert>
    
    <delete id="deleteConcursoPuntajeExigido" parameterClass="concursoPuntajeExigido">
		DELETE FROM INC_PARAM_NIVEL_PREMI_PUNEX
		WHERE NUM_CONC = #numeroConcurso#
    </delete>
    
    <insert id="insertConcursoPuntajeExigido" parameterClass="concursoPuntajeExigido">
		INSERT INTO INC_PARAM_NIVEL_PREMI_PUNEX
            (PAIS_COD_PAIS, 
			NUM_CONC, 
			NUM_NIVE, 
			CAM_EXIG, 
			PUN_EXIG, 
			USU_CREA, 
			FEC_CREA, 
			EST_REGI)
	     VALUES 
	     	(#codigoPais#,
			 #numeroConcurso#,
			 #nivel#,
			 #codigoPeriodo#,
			 #puntajeExigido#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#,
			 '1'
			)
    </insert>
	   	 
	<resultMap id="concursoPuntajeExigidoResult"   class="concursoPuntajeExigido">
		<result property="codigoPais"			  	column="PAIS_COD_PAIS"/>					
		<result property="numeroConcurso"			column="NUM_CONC"/>
		<result property="codigoPeriodo"			column="CAM_EXIG"/>
		<result property="nivel"			        column="NUM_NIVE"/>
		<result property="puntajeExigido"			column="PUN_EXIG"/>
		
    </resultMap>
	     	     
 	<select id="getListConcursoPuntajeExigido" parameterClass="string" resultMap="concursoPuntajeExigidoResult">
		SELECT C.PAIS_COD_PAIS,
		       C.NUM_CONC,
		       C.CAM_EXIG,
		       C.NUM_NIVE,
		       C.PUN_EXIG
		  FROM INC_PARAM_NIVEL_PREMI_PUNEX C
		 WHERE NUM_CONC = #value#
 	</select>
	   	 
	<resultMap id="concursoPeriodoDespachoResult"   class="concursoPeriodoDespacho">
		<result property="codigoPais"			  	column="COD_PAIS"/>					
		<result property="numeroConcurso"			column="NUM_CONC"/>
		<result property="codigoPeriodo"			column="COD_PERI"/>
    <result property="codigoPeriodoFin"			column="COD_PERI_FIN"/>
    </resultMap>
	     	     
 	<select id="getListConcursoPeriodoDespacho" parameterClass="string" resultMap="concursoPeriodoDespachoResult">
		SELECT C.*
		  FROM INC_CONCU_CAMPA_DESPA C
		 WHERE C.NUM_CONC = #value#
 	</select>
	   	 
	<update id="updateConcursoPeriodoDespacho" parameterClass="concursoPeriodoDespacho">
		UPDATE INC_CONCU_CAMPA_DESPA
		   SET USU_MODI         = #auditInfo.updatedBy#,      
			   FEC_MODI	        = #auditInfo.lastUpdated#
		 WHERE COD_PAIS = #codigoPais#
		   AND NUM_CONC = #numeroConcurso#
		   AND COD_PERI = #codigoPeriodo#
    </update>
    
    <delete id="deleteConcursoPeriodoDespacho" parameterClass="string">
		DELETE FROM INC_CONCU_CAMPA_DESPA
		 WHERE NUM_CONC = #value#
    </delete>
        
	<select id="getConcursosFaltante" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT A.OID_PARA_GRAL CODIGO,
		       A.NUM_CONC || ' - ' || A.VAL_NOMB DESCRIPCION
		  FROM INC_CONCU_PARAM_GENER A
		 WHERE A.IND_ACTI = 1
		 ORDER BY 2
	</select>
	
	<select id="getPremiosFaltante" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT DISTINCT 
		       pos.PROD_OID_PROD || '__' || pos.VAL_CODI_VENT_FICT CODIGO,
		       con.NUM_CONC || ' - ' || pos.VAL_CODI_VENT_FICT || ' - ' || pro.COD_SAP || ' - ' || 
		       	 pq_apl_aux.Valor_Gen_I18n_Sicc(1, pro.OID_PROD, 'MAE_PRODU') DESCRIPCION
		  FROM INC_BOLSA_FALTA bol, 
		       PED_SOLIC_POSIC pos, 
		       PED_SOLIC_CABEC cab,
		       INC_CONCU_PARAM_GENER con,
		       MAE_PRODU pro
		  WHERE bol.SOPO_OID_SOLI_POSI = pos.OID_SOLI_POSI
		    AND pos.SOCA_OID_SOLI_CABE = cab.OID_SOLI_CABE    
		    AND cab.COPA_OID_PARA_GENE = con.OID_PARA_GRAL
		    AND pos.PROD_OID_PROD = pro.OID_PROD
		    
		    <isNotEmpty property="oidConcurso">	
			    <iterate prepend="AND" property="oidConcurso" open=" cab.COPA_OID_PARA_GENE IN (" close=")" conjunction=",">
        		 	#oidConcurso[]#
		       	</iterate>    
 		    </isNotEmpty>
 		    
 		    AND bol.PERD_OID_PERI = #oidPeriodo#
		    AND bol.COD_ORIG_FALT = 'FO'
		    AND bol.FEC_SOLU IS NULL
		  ORDER BY 1
	</select>
	
	<select id="getRegionesFaltante" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT DISTINCT 
		       reg.OID_REGI CODIGO,
		       reg.DES_REGI DESCRIPCION
		  FROM INC_BOLSA_FALTA bol, 
		       PED_SOLIC_POSIC pos, 
		       PED_SOLIC_CABEC cab,
		       ZON_ZONA zon,
		       ZON_REGIO reg
		  WHERE bol.SOPO_OID_SOLI_POSI = pos.OID_SOLI_POSI
		    AND pos.SOCA_OID_SOLI_CABE = cab.OID_SOLI_CABE    
		    AND cab.ZZON_OID_ZONA = zon.OID_ZONA
		    AND zon.ZORG_OID_REGI = reg.OID_REGI
		    AND bol.PERD_OID_PERI = #oidPeriodo#
		    AND bol.COD_ORIG_FALT = 'FO'
		    AND bol.FEC_SOLU IS NULL
		  ORDER BY 2
	</select>
	
	<select id="getZonasFaltante" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT DISTINCT 
		       zon.OID_ZONA CODIGO,
		       zon.DES_ZONA DESCRIPCION
		  FROM INC_BOLSA_FALTA bol, 
		       PED_SOLIC_POSIC pos, 
		       PED_SOLIC_CABEC cab,
		       ZON_ZONA zon,
		       ZON_REGIO reg
		  WHERE bol.SOPO_OID_SOLI_POSI = pos.OID_SOLI_POSI
		    AND pos.SOCA_OID_SOLI_CABE = cab.OID_SOLI_CABE    
		    AND cab.ZZON_OID_ZONA = zon.OID_ZONA
		    AND zon.ZORG_OID_REGI = reg.OID_REGI
		    AND bol.PERD_OID_PERI = #oidPeriodo#
		    AND bol.COD_ORIG_FALT = 'FO'
		    
		    <isNotEmpty property="oidRegion">	
			    <iterate prepend="AND" property="oidRegion" open=" reg.OID_REGI IN (" close=")" conjunction=",">
        		 	#oidRegion[]#
		       	</iterate>    
 		    </isNotEmpty>
 		   
		    AND bol.FEC_SOLU IS NULL
		  ORDER BY 2
	</select>
	
	<resultMap id="faltantesResult" class="java.util.HashMap">
	    <result property="oidFaltante"	 				column="OID_BOLS_FALT"/>
	    <result property="codigoPeriodo"		   		column="COD_PERI"/>
	    <result property="numeroConcurso"			    column="NUM_CONC"/>
	    <result property="nombreConcurso"				column="VAL_NOMB"/>
	    <result property="codigoVenta"					column="VAL_CODI_VENT_FICT"/>
	    <result property="codigoSAP"					column="COD_SAP"/>
	    <result property="descripcionProducto"			column="DES_PROD"/>
	    <result property="unidadesFaltantes"			column="NUM_UNID_FALT"/>
	    <result property="indicadorDespachoServicio"	column="IND_DESP_SERV"/>
	    <result property="descripcionDespachoServicio"	column="DES_DESP_SERV"/>
    </resultMap>
    
	<select id="getFaltantes" parameterClass="java.util.Map" resultMap="faltantesResult">
		SELECT bol.OID_BOLS_FALT,
			   FIN_PKG_GENER.FIN_FN_OBTIE_CODIG_PERIO(cab.PERD_OID_PERI) COD_PERI,
		       con.NUM_CONC,
		       con.VAL_NOMB,
		       pos.VAL_CODI_VENT_FICT,
		       pro.COD_SAP,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, pro.OID_PROD, 'MAE_PRODU') DES_PROD,
		       bol.NUM_UNID_FALT,
		       bol.IND_DESP_SERV,
		       DECODE(NVL(bol.IND_DESP_SERV,0),0,'Solo con pedido',1,'También para pedido de Servicio') DES_DESP_SERV 
		  FROM INC_BOLSA_FALTA bol, 
		       PED_SOLIC_POSIC pos, 
		       PED_SOLIC_CABEC cab,
		       ZON_ZONA zon,
		       ZON_REGIO reg,
		       INC_CONCU_PARAM_GENER con,
		       MAE_PRODU pro,
		       MAE_CLIEN cli
		  WHERE bol.SOPO_OID_SOLI_POSI = pos.OID_SOLI_POSI
		    AND pos.SOCA_OID_SOLI_CABE = cab.OID_SOLI_CABE    
		    AND cab.ZZON_OID_ZONA = zon.OID_ZONA
		    AND zon.ZORG_OID_REGI = reg.OID_REGI
		    AND cab.COPA_OID_PARA_GENE = con.OID_PARA_GRAL
		    AND cab.CLIE_OID_CLIE = cli.OID_CLIE
		    AND pos.PROD_OID_PROD = pro.OID_PROD
		    AND bol.PERD_OID_PERI = #oidPeriodo#
		    AND bol.COD_ORIG_FALT = 'FO'
		       
		    <isNotEmpty property="oidConcurso">	
			    <iterate prepend="AND" property="oidConcurso" open=" con.OID_PARA_GRAL IN (" close=")" conjunction=",">
        		 	#oidConcurso[]#
		       	</iterate>    
 		    </isNotEmpty>
 		    
			<isNotEmpty property="oidRegion">	
			    <iterate prepend="AND" property="oidRegion" open=" reg.OID_REGI IN (" close=")" conjunction=",">
        		 	#oidRegion[]#
		       	</iterate>    
 		    </isNotEmpty>
 		   
 		    <isNotEmpty property="oidZona">	
			    <iterate prepend="AND" property="oidZona" open=" zon.OID_ZONA IN (" close=")" conjunction=",">
        		 	#oidZona[]#
		       	</iterate>    
 		    </isNotEmpty>
 		    
		    <isNotEmpty property="codigoCliente">
		    	AND cli.COD_CLIE = #codigoCliente#
			</isNotEmpty>

		    <isNotEmpty property="oidProducto">
			    <iterate prepend="AND" property="oidProducto" open=" pro.OID_PROD IN (" close=")" conjunction=",">
        		 	#oidProducto[]#
		       	</iterate>    
			</isNotEmpty>
			<isNotEmpty property="oidCUV">
				<iterate prepend="AND" property="oidCUV" open=" pos.VAL_CODI_VENT_FICT IN (" close=")" conjunction=",">
        		 	#oidCUV[]#
		       	</iterate>
			</isNotEmpty>
	   		
		    AND bol.FEC_SOLU IS NULL
	</select>
	
	<update id="updateFaltante" parameterClass="java.util.Map">
    	UPDATE INC_BOLSA_FALTA
 	       SET IND_DESP_SERV = #indicadorDespachoServicio#,
		       USU_MODI = #codigoUsuario# 
		 WHERE OID_BOLS_FALT = #oidFaltante#
    </update>
        
	<resultMap id="getListaConcursosCEActivosByConcursoPeriodoResult" class="java.util.HashMap">
		<result property="codigoConcurso" 			column="CODIGOCONCURSO"/>
		<result property="descripcionConcurso" 		column="DESCRIPCIONCONCURSO"/>
		<result property="codigoPeriodoInicial" 	column="COD_PERI_PROC"/>
		<result property="codigoPeriodoFinal"	 	column="COD_PERI_PROC_FINA"/>
		<result property="ultimoCupon" 				column="ULTIMOCUPON"/>
		<result property="estado" 					column="ESTADO"/>
		<result property="numeroConcurso" 			column="NUM_CONC"/>
	</resultMap>
 
	<select id="getListaConcursosCEActivosByConcursoPeriodo" parameterClass="java.util.Map" resultMap="getListaConcursosCEActivosByConcursoPeriodoResult">
		SELECT CEL.VAL_ACTU_CUPO AS CODIGOCONCURSO,
		       GEN.NUM_CONC || ' - ' || GEN.VAL_NOMB AS DESCRIPCIONCONCURSO,
		       CEL.COD_PERI_PROC,
		       CEL.COD_PERI_PROC_FINA,
		       CEL.VAL_ACTU_CUPO ULTIMOCUPON,
		       DECODE(CEL.IND_ACTI, 1, 'ACTIVO', 'INACTIVO') ESTADO,
		       GEN.NUM_CONC
		  FROM INC_PARAM_CUPON_ELECT CEL,
		       INC_CONCU_PARAM_GENER GEN
		 WHERE CEL.NUM_CONC = GEN.NUM_CONC
		 AND CEL.PAIS_COD_PAIS = #codigoPais#
		   <isNotEmpty property="codigoConcurso">
		    	AND GEN.NUM_CONC = #codigoConcurso#
		   </isNotEmpty>
		   
		   <isNotEmpty property="codigoPeriodoProceso">
		   		<![CDATA[
			    	AND CEL.COD_PERI_PROC <= #codigoPeriodoProceso#
			    	AND CEL.COD_PERI_PROC_FINA >= #codigoPeriodoProceso#
			    ]]>	
		   </isNotEmpty>
	</select>
	
	<resultMap id="getDatosConcursoCuponElectronicoResult" class="java.util.HashMap">
		<result property="codigoConcurso" 			column="CODIGOCONCURSO"/>
		<result property="descripcionConcurso" 		column="DESCRIPCIONCONCURSO"/>
		<result property="codigoPeriodoInicial" 	column="COD_PERI_PROC"/>
		<result property="codigoPeriodoFinal"	 	column="COD_PERI_PROC_FINA"/>
		<result property="cuponInicial" 			column="CUPONINICIAL"/>
		<result property="ultimoCupon" 				column="ULTIMOCUPON"/>
		<result property="estado" 					column="ESTADO"/>
	</resultMap>

	<select id="getDatosConcursoCuponElectronico" parameterClass="map" resultMap="getDatosConcursoCuponElectronicoResult">
		SELECT GEN.NUM_CONC AS CODIGOCONCURSO,
		       GEN.NUM_CONC || ' - ' || GEN.VAL_NOMB AS DESCRIPCIONCONCURSO,
		       CEL.COD_PERI_PROC,
		       CEL.COD_PERI_PROC_FINA,
		       CEL.VAL_INIC_CUPO CUPONINICIAL,
		       CEL.VAL_ACTU_CUPO ULTIMOCUPON,
		       CEL.IND_ACTI ESTADO
		  FROM INC_PARAM_CUPON_ELECT CEL,
		       INC_CONCU_PARAM_GENER GEN
		 WHERE CEL.NUM_CONC = GEN.NUM_CONC
		 AND CEL.PAIS_COD_PAIS = #codigoPais#
		 AND GEN.NUM_CONC = #codigoConcurso#
 	</select>
	
    <select id="getValidarExisteConcursoCuponElectronico" parameterClass="java.util.Map"  resultClass="string">
		SELECT COUNT (VAL_ACTU_CUPO)
		FROM INC_PARAM_CUPON_ELECT
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND NUM_CONC = #codigoConcurso#
    </select>

    <insert id="insertMantenimientoINCConfiguracionConcursoCE" parameterClass="procesarINCConfiguracionConcursoCuponElectronico">
		INSERT INTO INC_PARAM_CUPON_ELECT
		            (PAIS_COD_PAIS, 
		             NUM_CONC, 
		             VAL_INIC_CUPO,
		             VAL_ACTU_CUPO, 
		             COD_PERI_PROC, 
		             COD_PERI_PROC_FINA,
		             USU_CREA, 
		             FEC_CREA, 
		             IND_ACTI, 
		             EST_REGI)
		     VALUES (#codigoPais#, 
		             #numeroConcurso#, 
		             #cuponInicial#, 
		             #cuponInicial#, 
		             #codigoPeriodoInicial#, 
		             #codigoPeriodoFinal#,
		             #codigoUsuario#, 
		             SYSDATE, 
		             #indicadorActivo#, 
		             #estado#)
	</insert>

 	<update id="updateMantenimientoINCConfiguracionConcursoCE" parameterClass="procesarINCConfiguracionConcursoCuponElectronico">
		UPDATE INC_PARAM_CUPON_ELECT 
		   SET COD_PERI_PROC = #codigoPeriodoInicial#,
		       COD_PERI_PROC_FINA = #codigoPeriodoFinal#,  
		       VAL_ACTU_CUPO = #ultimoCupon#, 
		       IND_ACTI = #estado#,
		       USU_MODI = #codigoUsuario#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		 AND NUM_CONC = #codigoConcurso#
	</update>
	
	<delete id="deleteUltimaActualizacionConcurso" parameterClass="java.util.Map">
		DELETE FROM inc_ultim_actua_concu															
	</delete>   
   
     <insert id="insertUltimaActualizacionConcurso" parameterClass="java.util.Map">
    	insert into inc_ultim_actua_concu(val_serv, fec_crea)
    	VALUES (#valorServidor#, SYSDATE)
    </insert>
	
    <delete id="deleteLotesPremioArticulo" parameterClass="java.util.Map">
    	DELETE FROM INC_LOTE_PREMI_ARTIC
		 WHERE PRAR_OID_PREM_ARTI = #oidPremioArticulo#
		   	    <iterate prepend="AND" property="oidLotePremio" open=" OID_LOTE_PREM_ARTI NOT IN (" close=")" conjunction=",">
        			 	#oidLotePremio[]#
		       	</iterate>    
	</delete>
	
	<delete id="deleteArticulosLoteEliminado" parameterClass="java.util.Map">
    	DELETE FROM INC_ARTIC_LOTE
		 WHERE LOPA_OID_LOTE_PREM_ARTI IN 
		 		(SELECT OID_LOTE_PREM_ARTI
		 		   FROM INC_LOTE_PREMI_ARTIC
		 		  WHERE PRAR_OID_PREM_ARTI = #oidPremioArticulo#
			 			<iterate prepend="AND" property="oidLotePremio" open=" OID_LOTE_PREM_ARTI NOT IN (" close=")" conjunction=",">
	        			 	#oidLotePremio[]#
			      	 	</iterate> 
				)	      	 	
	</delete>
	
    <delete id="deleteArticulosLote" parameterClass="java.util.Map">
    	DELETE FROM INC_ARTIC_LOTE
		 WHERE LOPA_OID_LOTE_PREM_ARTI = #oidLotePremio# AND IND_TIPO_PREM = 'A'
		   	    <iterate prepend="AND" property="oidArticuloLote" open=" OID_ARTI_LOTE NOT IN (" close=")" conjunction=",">
        			 	#oidArticuloLote[]#
		       	</iterate>    
	</delete>
	
	<resultMap id="getDetalleOfertaCUVResult" class="java.util.HashMap">
		<result property="oidPeriodo" 					column="PERD_OID_PERI"/>
		<result property="oidDetalleOferta"				column="OID_DETA_OFER"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionTipoOferta"		column="DES_TIPO_OFER"/>
		<result property="descripcionProducto"			column="DES_PROD"/>
	</resultMap>

	<select id="getDetalleOfertaCUV" parameterClass="map" resultMap="getDetalleOfertaCUVResult">
		SELECT c.PERD_OID_PERI,
		       a.OID_DETA_OFER,
		       p.COD_SAP,
           	   pq_apl_aux.Valor_Gen_I18n_Sicc(1, a.TOFE_OID_TIPO_OFER, 'PRE_TIPO_OFERT') DES_TIPO_OFER,
               pq_apl_aux.Valor_Gen_I18n_Sicc(1, P.OID_PROD, 'MAE_PRODU') DES_PROD
		  FROM PRE_OFERT_DETAL a, 
		       PRE_MATRI_FACTU b, 
		       PRE_MATRI_FACTU_CABEC c,
		       MAE_PRODU p
		 WHERE a.OID_DETA_OFER = b.OFDE_OID_DETA_OFER
		   AND b.MFCA_OID_CABE = c.OID_CABE
		   AND a.PROD_OID_PROD = p.OID_PROD
		   
		   <isNotEmpty property="CUV">
		   		AND c.PERD_OID_PERI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#)
		   		AND a.VAL_CODI_VENT = #CUV#
		   </isNotEmpty>
		   
		   <isNotEmpty property="oidDetalleOferta">
		   		AND a.OID_DETA_OFER = #oidDetalleOferta#
		   </isNotEmpty>
 	</select>
 	
 	<resultMap id="getFaltantesPendientesConcursoResult" class="java.util.HashMap">
		<result property="oid" 							column="OID_BOLS_FALT"/>
		<result property="codigoCliente"				column="COD_CLIE"/>
		<result property="nombre"						column="VAL_NOM1"/>
		<result property="apellido"						column="VAL_APE1"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionProducto"			column="DES_PROD"/>
		<result property="codigoPremio"					column="VAL_CODI_VENT_FICT"/>
		<result property="numeroPremio"					column="NUM_PREM"/>
		<result property="numeroUnidades"				column="NUM_UNID_FALT"/>
		<result property="observaciones"				column="VAL_OBSE"/>
		<result property="fechaModificacion"			column="FEC_MODI"/>
		<result property="transaccion"					column="DES_TIPO_SOLI"/>
	</resultMap>

	<select id="getFaltantesPendientesConcurso" parameterClass="map" resultMap="getFaltantesPendientesConcursoResult">
		SELECT bf.OID_BOLS_FALT,
		       mae.COD_CLIE,
		       mae.VAL_NOM1,
		       mae.VAL_APE1,
		       p.COD_SAP,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, p.OID_PROD, 'MAE_PRODU') DES_PROD,
		       sp.VAL_CODI_VENT_FICT,
		       sc.NUM_PREM,
		       bf.NUM_UNID_FALT,
		       bf.VAL_OBSE,
		       TO_CHAR(bf.FEC_ALTA, 'dd/MM/yyyy') as FEC_MODI,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, tsp.TSOL_OID_TIPO_SOLI, 'PED_TIPO_SOLIC') DES_TIPO_SOLI
		  FROM INC_BOLSA_FALTA       bf,
		       PED_SOLIC_POSIC       sp,
		       PED_SOLIC_CABEC       sc,
		       MAE_PRODU             p,
		       INC_CONCU_PARAM_GENER concu,
		       MAE_CLIEN             mae,
		       PED_TIPO_SOLIC_PAIS	 tsp
		 WHERE sc.COPA_OID_PARA_GENE = OID_PARA_GRAL
		   AND bf.SOPO_OID_SOLI_POSI = sp.OID_SOLI_POSI
		   AND sp.SOCA_OID_SOLI_CABE = sc.OID_SOLI_CABE
		   AND sc.TSPA_OID_TIPO_SOLI_PAIS = tsp.OID_TIPO_SOLI_PAIS
		   AND sp.PROD_OID_PROD = p.OID_PROD
		   AND bf.FEC_SOLU IS NULL
		   AND sc.CLIE_OID_CLIE = mae.OID_CLIE
		   AND concu.OID_PARA_GRAL = #oidConcurso#
		 ORDER BY p.COD_SAP, mae.COD_CLIE
 	</select>
 	
 	<resultMap id="getPremiosConcursoResult" class="java.util.HashMap">
		<result property="oid" 							column="OID_ARTI_LOTE"/>
		<result property="numeroNivel"  				column="NUM_NIVE"/>
		<result property="numeroPremio"					column="NUM_PREM"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionProducto"			column="DES_PROD"/>
		<result property="numeroUnidades"				column="NUM_UNID"/>
		<result property="codigoVenta"					column="COD_VENT_FICT"/>
	</resultMap>

	<select id="getPremiosConcurso" parameterClass="map" resultMap="getPremiosConcursoResult">
		SELECT INC_ARTIC_LOTE.OID_ARTI_LOTE,
		       INC_PARAM_NIVEL_PREMI.NUM_NIVE,
		       INC_LOTE_PREMI_ARTIC.NUM_PREM,
		       MAE_PRODU.COD_SAP,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, MAE_PRODU.OID_PROD, 'MAE_PRODU') DES_PROD,
		       INC_ARTIC_LOTE.NUM_UNID,
		       INC_ARTIC_LOTE.COD_VENT_FICT
		  FROM INC_PARAM_NIVEL_PREMI,
		       MAE_PRODU,
		       INC_LOTE_PREMI_ARTIC,
		       INC_ARTIC_LOTE,
		       INC_PREMI_ARTIC,
		       INC_PARAM_GENER_PREMI,
		       INC_CONCU_PARAM_GENER
		 WHERE INC_ARTIC_LOTE.LOPA_OID_LOTE_PREM_ARTI = INC_LOTE_PREMI_ARTIC.OID_LOTE_PREM_ARTI
		   AND INC_ARTIC_LOTE.PROD_OID_PROD = MAE_PRODU.OID_PROD
		   AND INC_LOTE_PREMI_ARTIC.PRAR_OID_PREM_ARTI = INC_PREMI_ARTIC.OID_PREM_ARTI
		   AND INC_PREMI_ARTIC.PANP_OID_PARA_NIVE_PREM = INC_PARAM_NIVEL_PREMI.OID_PARA_NIVE_PREM
		   AND INC_PARAM_NIVEL_PREMI.PAGP_OID_PARA_GENE_PREM = INC_PARAM_GENER_PREMI.OID_PARA_GENE_PREM
		   AND INC_PARAM_GENER_PREMI.COPA_OID_PARA_GRAL = INC_CONCU_PARAM_GENER.OID_PARA_GRAL
		   AND INC_CONCU_PARAM_GENER.OID_PARA_GRAL = #oidConcurso#
		 ORDER BY INC_PARAM_NIVEL_PREMI.NUM_NIVE,
		          INC_LOTE_PREMI_ARTIC.NUM_PREM,
		          MAE_PRODU.COD_SAP
 	</select>
 	
 	<resultMap id="getFaltantesConcursoResult" class="java.util.HashMap">
		<result property="oid" 							column="OID_REEM_ARTI_LOTE"/>
		<result property="codigoSAPReemplazado"			column="REEMPLAZADO"/>
		<result property="codigoVentaReemplazado"		column="CUV_REEMPLAZADO"/>
		<result property="oidProducto"					column="OID_PROD"/>
		<result property="codigoSAPReemplazo"			column="REEMPLAZO"/>
		<result property="descripcionProducto"			column="DES_PROD"/>
		<result property="numeroUnidades"				column="NUM_UNID"/>
		<result property="codigoVentaReemplazo"			column="COD_VENT_FICT"/>
		<result property="oidCriterio"					column="OID_CRIT_REEM"/>
		<result property="descripcionCriterio"			column="DES_CRIT_REEM"/>
		<result property="valorCriterio"				column="VAL_CRIT_REEM"/>
		<result property="numeroOrden"					column="NUM_ORDE"/>
		<result property="indicadorActivo"				column="IND_ACTI"/>
		<result property="descripcionActivo"			column="DES_INDI_ACTI"/>
		<result property="posicionReemplazo"			column="VAL_POSI_REEM"/>
		<result property="numeroPremio"					column="NUM_PREM"/>
		<result property="descripcionProductoReem"		column="DES_PROD_REEM"/>
		<result property="oidArticuloLote"				column="OID_ARTI_LOTE"/>
		<result property="precio"						column="IMP_PREC_PUBL"/>
		<result property="tipoAgrupacion"				column="COD_TIPO_AGRU"/>
		<result property="oidCompuesto"					column="COMP_OID_REEM_ARTI_LOTE"/>
		<result property="codigoVentaPrincipal"			column="CUV_PRINCIPAL"/>
		<result property="oidConcurso"					column="OID_PARA_GRAL"/>
	</resultMap>

	<select id="getFaltantesConcurso" parameterClass="map" resultMap="getFaltantesConcursoResult">
		SELECT INC_REEMP_ARTIC_LOTE.OID_REEM_ARTI_LOTE,
		       REEMPLAZADO.COD_SAP REEMPLAZADO,
		       INC_ARTIC_LOTE.COD_VENT_FICT CUV_REEMPLAZADO,
		       reemplazo.OID_PROD,
		       REEMPLAZO.COD_SAP REEMPLAZO,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, REEMPLAZO.OID_PROD, 'MAE_PRODU') DES_PROD,
		       INC_REEMP_ARTIC_LOTE.NUM_UNID,
		       INC_REEMP_ARTIC_LOTE.COD_VENT_FICT,
		       INC_CRITE_REEMP.OID_CRIT_REEM,
		       INC_CRITE_REEMP.DES_CRIT_REEM,
		       INC_REEMP_ARTIC_LOTE.VAL_CRIT_REEM,
		       INC_REEMP_ARTIC_LOTE.NUM_ORDE,
		       INC_REEMP_ARTIC_LOTE.IND_ACTI,
		       DECODE(inc_reemp_artic_lote.ind_acti, 1, 'SI', 0, 'NO') DES_INDI_ACTI,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_POSIC_REEMP(inc_concu_param_gener.oid_para_gral,
		                                INC_REEMP_ARTIC_LOTE.COD_VENT_FICT) VAL_POSI_REEM,
		       INC_LOTE_PREMI_ARTIC.NUM_PREM,
		       pq_apl_aux.Valor_Gen_I18n_Sicc(1, REEMPLAZADO.OID_PROD, 'MAE_PRODU') DES_PROD_REEM,
		       INC_ARTIC_LOTE.OID_ARTI_LOTE,
		       INC_REEMP_ARTIC_LOTE.IMP_PREC_PUBL,
		       NVL(INC_REEMP_ARTIC_LOTE.COD_TIPO_AGRU, 'I') COD_TIPO_AGRU,
		       INC_REEMP_ARTIC_LOTE.COMP_OID_REEM_ARTI_LOTE,
		       (CASE WHEN INC_REEMP_ARTIC_LOTE.COMP_OID_REEM_ARTI_LOTE IS NOT NULL THEN
		                  (SELECT AUX.COD_VENT_FICT 
		          		     FROM INC_REEMP_ARTIC_LOTE AUX 
		                    WHERE AUX.OID_REEM_ARTI_LOTE = INC_REEMP_ARTIC_LOTE.COMP_OID_REEM_ARTI_LOTE )
		             ELSE '' END) CUV_PRINCIPAL,
		       inc_concu_param_gener.OID_PARA_GRAL                            
		  FROM INC_REEMP_ARTIC_LOTE,
		       MAE_PRODU REEMPLAZADO,
		       MAE_PRODU REEMPLAZO,
		       INC_ARTIC_LOTE,
		       INC_CRITE_REEMP,
		       inc_param_nivel_premi,
		       inc_premi_artic,
		       inc_lote_premi_artic,
		       inc_param_gener_premi,
		       inc_concu_param_gener
		 WHERE INC_REEMP_ARTIC_LOTE.ARLO_OID_ARTI_LOTE = INC_ARTIC_LOTE.OID_ARTI_LOTE
		   AND INC_ARTIC_LOTE.PROD_OID_PROD = REEMPLAZADO.OID_PROD
		   AND inc_reemp_artic_lote.prod_oid_prod = reemplazo.oid_prod
		   AND INC_REEMP_ARTIC_LOTE.CTRE_OID_CRIT_REEM = INC_CRITE_REEMP.OID_CRIT_REEM
		   AND inc_artic_lote.lopa_oid_lote_prem_arti = inc_lote_premi_artic.oid_lote_prem_arti
		   AND inc_lote_premi_artic.prar_oid_prem_arti = inc_premi_artic.oid_prem_arti
		   AND inc_premi_artic.panp_oid_para_nive_prem = inc_param_nivel_premi.oid_para_nive_prem
		   AND inc_param_nivel_premi.pagp_oid_para_gene_prem = inc_param_gener_premi.oid_para_gene_prem
		   AND inc_param_gener_premi.copa_oid_para_gral = inc_concu_param_gener.oid_para_gral
		   AND inc_concu_param_gener.oid_para_gral = #oidConcurso#
		   
		   <isEmpty property="indicadorCompuestos">
		   		AND INC_REEMP_ARTIC_LOTE.COMP_OID_REEM_ARTI_LOTE IS NULL
		   </isEmpty>
		   <isNotEmpty property="indicadorCompuestos">
		   		AND INC_REEMP_ARTIC_LOTE.COMP_OID_REEM_ARTI_LOTE IS NOT NULL
		   </isNotEmpty>
		   <isNotEmpty property="oidCompuesto">
		   		AND INC_REEMP_ARTIC_LOTE.COMP_OID_REEM_ARTI_LOTE = #oidCompuesto#
		   </isNotEmpty>
		   
		   <isNotEmpty property="oidReemplazo">
		   		AND INC_REEMP_ARTIC_LOTE.OID_REEM_ARTI_LOTE = #oidReemplazo#
		   </isNotEmpty>

		   <isNotEmpty property="indActivo">
		   		AND INC_REEMP_ARTIC_LOTE.IND_ACTI = 1
		   </isNotEmpty>
		   
		 <isEmpty property="indicadorCompuestos">  
		 ORDER BY INC_ARTIC_LOTE.COD_VENT_FICT,
		          INC_REEMP_ARTIC_LOTE.NUM_ORDE
		 </isEmpty>   
		 <isNotEmpty property="indicadorCompuestos">
		 	ORDER BY CUV_PRINCIPAL, 
		 			 INC_REEMP_ARTIC_LOTE.COD_VENT_FICT
		 </isNotEmpty>    
 	</select>
 	
 	<select id="getSecuenciaReemplazoPremio" resultClass="long">
          SELECT INC_RARL_SEQ.NEXTVAL FROM DUAL
    </select>
    
    <insert id="insertReemplazoPremio" parameterClass="java.util.Map">
    	INSERT INTO INC_REEMP_ARTIC_LOTE
		 (OID_REEM_ARTI_LOTE,
		  IND_DESP,
		  IMP_PREC_PUBL,
		  NUM_UNID,
		  COD_VENT_FICT,
		  PROD_OID_PROD,
		  IND_CENT_DIST_GARA,
		  IND_TIPO_ENTR_PREM,
		  VAL_OBSE_CENT_DIST,
		  NUM_MESE_GARA,
		  CESE_OID_CESE_ENTR,
		  CESE_OID_CESE_GARA,
		  CTRE_OID_CRIT_REEM,
		  VAL_CRIT_REEM,
		  ARLO_OID_ARTI_LOTE,
		  NUM_ORDE,
		  IND_ACTI,
		  IND_COMU,
		  COD_TIPO_AGRU,
		  COMP_OID_REEM_ARTI_LOTE,
		  USU_CREA,
		  FEC_CREA)
		VALUES
		 (#oid#,
		  1,
		  #precio#,
		  #numeroUnidades#,
		  #codigoVenta#,
		  (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoProducto#),
		  0,
		  'B',
		  NULL,
		  NULL,
		  NULL,
		  NULL,
		  #oidCriterio#,
		  NULL,
		  #oidArticuloLote#,
		  
		  <isEmpty property="numeroOrden">
		  (SELECT nvl(max(num_orde),0)+1 FROM INC_REEMP_ARTIC_LOTE WHERE ARLO_OID_ARTI_LOTE = #oidArticuloLote#),
		  </isEmpty>
		  <isNotEmpty property="numeroOrden">
		  	#numeroOrden#,
		  </isNotEmpty>
		  
		  #indicadorActivo#,
		  1,
		  #tipoAgrupacion#,
		  #oidCompuesto#,
		  #codigoUsuario#,  
		  SYSDATE)
    </insert>	
 	
 	<update id="updateReemplazoPremio" parameterClass="java.util.Map">
	 	UPDATE INC_REEMP_ARTIC_LOTE    
		   SET NUM_UNID = #numeroUnidades#,
		       PROD_OID_PROD = (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoProducto#),
		       CTRE_OID_CRIT_REEM = #oidCriterio#,
		       NUM_ORDE = #numeroOrden#,
		       IND_ACTI = #indicadorActivo#,
		       COD_TIPO_AGRU = #tipoAgrupacion#,
		       IMP_PREC_PUBL = #precio#,
		       USU_MODI = #codigoUsuario#,
		       FEC_MODI = SYSDATE
		 WHERE OID_REEM_ARTI_LOTE = #oid#
 	</update>
 	
 	<update id="updateReemplazoPremioCompuesto" parameterClass="java.util.Map">
	 	UPDATE INC_REEMP_ARTIC_LOTE    
		   SET CTRE_OID_CRIT_REEM = #oidCriterio#,
		       NUM_ORDE = #numeroOrden#,
		       IND_ACTI = #indicadorActivo#,
		       USU_MODI = #codigoUsuario#,
		       FEC_MODI = SYSDATE
		 WHERE COMP_OID_REEM_ARTI_LOTE = #oid#
 	</update>
 	
 	<delete id="deleteReemplazoPremio" parameterClass="string">
	 	DELETE FROM INC_REEMP_ARTIC_LOTE    
		 WHERE OID_REEM_ARTI_LOTE = #value#
 	</delete>
 	
 	<delete id="deleteReemplazoPremioCompuesto" parameterClass="string">
	 	DELETE FROM INC_REEMP_ARTIC_LOTE    
		 WHERE COMP_OID_REEM_ARTI_LOTE = #value#
 	</delete>
 	
 	<insert id="insertReemplazoPremioAmbito" parameterClass="java.util.Map">
 		INSERT INTO INC_REEMP_REGIO_ZONA
		 (OID_REEM_REGI_ZONA,
		  RARL_OID_REEM_ARTI_LOTE,
		  ZORG_OID_REGI,
		  ZZON_OID_ZONA)
		VALUES
		 (INC_RRZO_SEQ.NEXTVAL,
		  #oidReemplazo#,
		  #oidRegion#,
		  #oidZona#)
 	</insert>
 	
 	<delete id="deleteReemplazoPremioAmbito" parameterClass="string">
	 	DELETE FROM INC_REEMP_REGIO_ZONA    
		 WHERE RARL_OID_REEM_ARTI_LOTE = #value#
 	</delete>
 	
    <select id="getListCriterioDeReemplazo" resultMap="baseResult">
		SELECT INC_CRITE_REEMP.OID_CRIT_REEM CODIGO,
		       INC_CRITE_REEMP.DES_CRIT_REEM DESCRIPCION
		  FROM INC_CRITE_REEMP
		  <![CDATA[
		 WHERE OID_CRIT_REEM <> 2
		 ]]>    
	</select>
	 	
	<select id="getValidaEjecucionProcesoBatch" parameterClass="java.util.Map"  resultClass="string">
		SELECT COUNT(1)
	      FROM GEN_PROCE_BATCH
		 WHERE COD_PROC LIKE #codigoProceso#
		   AND FEC_FIN IS NULL
    </select>
    
	<resultMap id="reemplazoPremioAmbitoResult"   class="java.util.HashMap">
		<result property="oid"				  		  		column="OID_REEM_REGI_ZONA" javaType="java.lang.Long"/>					
		<result property="oidRegion"						column="ZORG_OID_REGI" 	    javaType="java.lang.Long"/>
		<result property="oidZona"							column="ZZON_OID_ZONA"      javaType="java.lang.Long"/>
		<result property="descripcionRegion"				column="DES_REGI"/>
		<result property="descripcionZona"					column="DES_ZONA"/>
    </resultMap>
    
    <select id="getListReemplazoPremioAmbito" parameterClass="string" resultMap="reemplazoPremioAmbitoResult">
		SELECT C.OID_REEM_REGI_ZONA,
			   C.ZORG_OID_REGI, 
		       C.ZZON_OID_ZONA,
		       reg.DES_REGI, 
		       zon.DES_ZONA       
		  FROM INC_REEMP_REGIO_ZONA C, ZON_REGIO reg, ZON_ZONA zon
		 WHERE C.RARL_OID_REEM_ARTI_LOTE = #value#
		   AND reg.OID_REGI = c.ZORG_OID_REGI
		   AND zon.OID_ZONA(+) = c.ZZON_OID_ZONA
		 ORDER BY reg.DES_REGI, zon.COD_ZONA
 	</select>
 		 	
 	<select id="getValidaPremioAtendido" parameterClass="java.util.Map" resultClass="string">
 		SELECT INC_PKG_PROCE_INCEN.INC_FN_OBTIE_POSIC_REEMP(#oidConcurso#,
		                                #codigoVenta#) FROM DUAL
 	</select>
 	
 	<select id="getListConcursosVigentesPuntos" resultMap="baseResult">
		SELECT DISTINCT 
		       CPG.NUM_CONC CODIGO,
		       CPG.NUM_CONC || ' - ' || CPG.VAL_NOMB DESCRIPCION,
		       CPG.NUM_CONC
		 FROM INC_CONCU_PARAM_GENER CPG, 
		      INC_VERSI_CONCU VC
		WHERE CPG.OID_PARA_GRAL = VC.COPA_OID_PARA_GRAL
		<![CDATA[
		  AND VC.VICO_OID_VIGE_CONC<>4
		]]>		  
		ORDER BY 3 DESC
	</select>
 	
 	<resultMap id="listPagoConcursoResult" class="java.util.HashMap">
	    <result property="codigoPais" 					column="PAIS_COD_PAIS"/>
	    <result property="codigoPago" 	  				column="COD_PAGO"/>
	    <result property="numeroConcurso"			    column="COPA_NUM_CONC"/>
	    <result property="nombrePago"					column="DES_PAGO"/>
	    <result property="codigoPeriodoInicio"			column="CAM_INIC"/>
	    <result property="codigoPeriodoFin"				column="CAM_FINA"/>
	    <result property="codigoClasificacion"			column="TCCL_COD_TIPO_CLASI"/>
	    <result property="indicePeriodo"				column="VAL_INDI_CAMPA_PAGO"/>
	    <result property="estadoPago"					column="IND_ESTA_PAGO"/>
	    <result property="descripcionEstadoPago"		column="DES_ESTA_PAGO"/>
	    <result property="totalProcesado"				column="VAL_TOTA_PROC"/>
	    <result property="montoProcesado"				column="VAL_MONT_PROC"/>
    </resultMap>
	
	<select id="getListPagoConcurso" parameterClass="java.util.Map" resultMap="listPagoConcursoResult">
		SELECT PAIS_COD_PAIS,
		       COD_PAGO,
		       COPA_NUM_CONC,
		       DES_PAGO,
		       CAM_INIC,
		       CAM_FINA,
		       TCCL_COD_TIPO_CLASI,
		       VAL_INDI_CAMPA_PAGO,
		       IND_ESTA_PAGO,
		       DECODE(IND_ESTA_PAGO, 0,'CERRRADO','ABIERTO') DES_ESTA_PAGO,
		       (SELECT COUNT(1)
				  FROM INC_CONCU_PAGOS_DETAL cpd
				 WHERE cpd.PAIS_COD_PAIS = cpp.PAIS_COD_PAIS
				   AND cpd.PGPA_COD_PAGO = cpp.COD_PAGO
				   AND cpd.IND_ESTA_PAGO = '4'
				   AND cpd.EST_REGI = '1') VAL_TOTA_PROC,
		       (SELECT NVL(SUM(VAL_MONT_PROC),0)
				  FROM INC_CONCU_PAGOS_DETAL cpd
				 WHERE cpd.PAIS_COD_PAIS = cpp.PAIS_COD_PAIS
				   AND cpd.PGPA_COD_PAGO = cpp.COD_PAGO
				   AND cpd.IND_ESTA_PAGO = '4'
				   AND cpd.EST_REGI = '1') VAL_MONT_PROC
		  FROM INC_CONCU_PAGOS_PARAM cpp
		 WHERE cpp.EST_REGI = 1
		 	<isNotEmpty property="codigoPago">
		    	AND cpp.COD_PAGO = #codigoPago#
		   </isNotEmpty>
		   
		   <isNotEmpty property="numeroConcurso">
		    	AND cpp.COPA_NUM_CONC = #numeroConcurso#
		   </isNotEmpty>
		   
		   <isNotEmpty property="nombrePago">
		    	AND UPPER(cpp.DES_PAGO) LIKE UPPER(#nombrePago#)
		   </isNotEmpty>
		   
		   <isNotEmpty property="codigoPeriodoInicio">
		    	AND cpp.CAM_INIC = #codigoPeriodoInicio#
		   </isNotEmpty>

		   <isNotEmpty property="codigoPeriodoFin">
		    	AND cpp.CAM_FINA = #codigoPeriodoFin#
		   </isNotEmpty>
		   
		   <isNotEmpty property="estadoPago">
		    	AND cpp.IND_ESTA_PAGO = #estadoPago#
		   </isNotEmpty>
	</select>	
	   
	<select id="getMaxPagoConcurso" resultClass="string">
		SELECT LPAD(nvl(MAX(COD_PAGO),0)+1,3,'0') 
		  FROM INC_CONCU_PAGOS_PARAM  
	</select>
	    
    <insert id="insertPagoConcurso" parameterClass="java.util.Map">
		INSERT INTO INC_CONCU_PAGOS_PARAM
           (PAIS_COD_PAIS,
	        COD_PAGO,
	        COPA_NUM_CONC,
	        DES_PAGO,
	        CAM_INIC,
	        CAM_FINA,
	        TCCL_COD_TIPO_CLASI,
	        VAL_INDI_CAMPA_PAGO,
	        IND_ESTA_PAGO,
			EST_REGI,
			USU_CREA,
			FEC_CREA)
		VALUES
	       (#codigoPais#,
	        #codigoPago#,
	        #numeroConcurso#,
	        #nombrePago#,
	        #codigoPeriodoInicio#,
	        #codigoPeriodoFin#,
	        #codigoClasificacion#,
	        #indicePeriodo#,
	        '1',
	        1,
	        #codigoUsuario#,
	        SYSDATE)
	</insert>

    <update id="updatePagoConcurso" parameterClass="java.util.Map">
		UPDATE INC_CONCU_PAGOS_PARAM
           SET COPA_NUM_CONC = #numeroConcurso#,
           	   DES_PAGO = #nombrePago#,
               CAM_INIC = #codigoPeriodoInicio#,
			   CAM_FINA = #codigoPeriodoFin#,
			   TCCL_COD_TIPO_CLASI = #codigoClasificacion#,
			   VAL_INDI_CAMPA_PAGO = #indicePeriodo#,
			   USU_MODI = #codigoUsuario#,
			   FEC_MODI = SYSDATE
		WHERE COD_PAGO = #codigoPago#
    </update>
   		 	
    <delete id="deletePagoConcurso" parameterClass="java.util.Map">
		UPDATE INC_CONCU_PAGOS_PARAM
		   SET EST_REGI = 9,
		       USU_MODI = #codigoUsuario#,
			   FEC_MODI = SYSDATE
 		 WHERE COD_PAGO = #codigoPago#
    </delete>
    
    <update id="cerrarPagoConcurso" parameterClass="java.util.Map">
		UPDATE INC_CONCU_PAGOS_PARAM
		   SET IND_ESTA_PAGO = '0',
		   	   CAM_FINA = #codigoPeriodoProceso#,
		       USU_MODI = #codigoUsuario#,
			   FEC_MODI = SYSDATE
 		 WHERE COD_PAGO = #codigoPago#
    </update>
 	
 	<select id="getListClasificacionesPagoConcurso" parameterClass="java.util.Map" resultMap="baseResult">
 	  SELECT M.COD_TIPO_CLAS CODIGO,  
 	         M.COD_TIPO_CLAS || ' - ' || V.VAL_I18N DESCRIPCION
        FROM MAE_TIPO_CLASI_CLIEN M, V_GEN_I18N_SICC V 
       WHERE M.OID_TIPO_CLAS = V.VAL_OID 
         AND V.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN' 
         AND V.ATTR_NUM_ATRI = 1 
         AND V.IDIO_OID_IDIO = 1
         AND M.SBTI_OID_SUBT_CLIE = 1
	   ORDER BY 2
	</select>
	
	<select id="getPeriodosDespachoConcurso" parameterClass="java.util.Map" resultClass="java.util.HashMap">
	 	SELECT INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(pre.perd_oid_peri_inic) periodoInicio,
		       INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(pre.perd_oid_peri) periodoFin
		  FROM INC_CONCU_PARAM_GENER gen,
		       INC_PARAM_GENER_PREMI pre
		 WHERE gen.NUM_CONC = #numeroConcurso#
		   AND gen.OID_PARA_GRAL = pre.COPA_OID_PARA_GRAL
	</select>
	
	<select id="getOidPeriodoByCodigoPeriodo" parameterClass="string" resultClass="string">
		SELECT cra.oid_peri
		  FROM CRA_PERIO cra, SEG_PERIO_CORPO cor
		 WHERE cra.peri_oid_peri = cor.oid_peri
		   AND cor.cod_peri = #value#
	</select>
 	
	<insert id="insertPagoBonoPremio" parameterClass="bonoPremioPago">
		INSERT INTO INC_CONCU_PAGOS_BONO_PREMI
           (PAIS_COD_PAIS,
	        PGPA_COD_PAGO,
	        COPA_NUM_CONC,
	        NUM_NIVE,
	        NUM_PREM,
	        VAL_CODI_VENT,
	        PGTA_COD_TIPO_ABON,
			EST_REGI,
			USU_CREA,
			FEC_CREA)
		VALUES
	       (#codigoPais#,
	        #codigoPago#,
	        #numeroConcurso#,
	        #numeroNivel#,
	        #numeroPremio#,
	        #codigoVenta#,
	        #tipoAbono#,
	        '1',
	        #codigoUsuario#,
	        SYSDATE)
	</insert>
	
	<delete id="deletePagoBonoPremio" parameterClass="java.util.Map">
		DELETE FROM INC_CONCU_PAGOS_BONO_PREMI
		 WHERE PGPA_COD_PAGO = #codigoPago#
	</delete>
	
    <resultMap id="listPagoBonoPremioResult" class="bonoPremioPago">
	    <result property="numeroNivel" 					column="NUM_NIVE"/>
	    <result property="numeroPremio" 	  			column="NUM_PREM"/>
	    <result property="codigoVenta"			    	column="COD_VENT_FICT"/>
	    <result property="indicadorBonoCCC"				column="IND_BONO_CCC"/>
	    <result property="indicadorBonoBanco"			column="IND_BONO_BAN"/>
    </resultMap>
	
	<select id="getListPagoBonoPremio" parameterClass="java.util.Map" resultMap="listPagoBonoPremioResult">
		SELECT pnp.NUM_NIVE,
		       lpa.NUM_PREM, 
		       arl.COD_VENT_FICT,
		       (select count(1) 
		         from inc_concu_pagos_bono_premi bon
		        where bon.pgpa_cod_pago = #codigoPago#
		          and bon.num_nive = pnp.num_nive
		          and bon.num_prem = lpa.num_prem
		          and bon.val_codi_vent = arl.cod_vent_fict
		          and bon.pgta_cod_tipo_abon = '001') IND_BONO_CCC,
		       (select count(1) 
		         from inc_concu_pagos_bono_premi bon
		        where bon.pgpa_cod_pago = #codigoPago#
		          and bon.num_nive = pnp.num_nive
		          and bon.num_prem = lpa.num_prem
		          and bon.val_codi_vent = arl.cod_vent_fict
		          and bon.pgta_cod_tipo_abon = '002') IND_BONO_BAN  
		  FROM inc_concu_param_gener con,
		       inc_param_nivel_premi pnp,
		       inc_param_gener_premi pgp,
		       inc_premi_artic pra,
		       inc_lote_premi_artic lpa,
		       inc_artic_lote arl
		 WHERE pgp.copa_oid_para_gral = con.oid_para_gral
		   AND pnp.pagp_oid_para_gene_prem = pgp.oid_para_gene_prem
		   AND pnp.oid_para_nive_prem = pra.panp_oid_para_nive_prem
		   AND pra.oid_prem_arti = lpa.prar_oid_prem_arti
		   AND arl.lopa_oid_lote_prem_arti = lpa.oid_lote_prem_arti
		   AND con.num_conc = #numeroConcurso#
		 ORDER BY num_nive, num_prem
	</select>
	
	<select id="getListConcursosPago" resultMap="baseResult">
		SELECT CPG.NUM_CONC CODIGO,
		       CPG.NUM_CONC || ' - ' || CPG.VAL_NOMB DESCRIPCION
		 FROM INC_CONCU_PARAM_GENER CPG
		WHERE CPG.IND_ACTI = 1
		ORDER BY 2 DESC
	</select>
			       
	<select id="getDescripcionProgramaAdicionar" resultClass="string" parameterClass="string" >
		select ICTP.DES_TIPO_PROG
          from INC_PARAM_TIPO_CLASI_CONCU IPTCC, INC_CONCU_TIPO_PROG ICTP
         where IPTCC.ICTP_OID_TIPO_PROG = ICTP.OID_TIPO_PROG
           and IPTCC.CCON_OID_CLAS_CONC=#oidTipoConcurso#
   </select>
	
	<select id="getDescripcionProgramaEditar" resultClass="string" parameterClass="string" >
		select ICTP.DES_TIPO_PROG
		  from INC_CONCU_PARAM_GENER ICPG, INC_CONCU_TIPO_PROG ICTP
		 where ICPG.ICTP_OID_TIPO_PROG = ICTP.OID_TIPO_PROG
		   and ICPG.OID_PARA_GRAL = #value#
   </select>
			       
   	<select id="getProgramasConstanciaProgramaPuntosByCriteria" parameterClass="map" resultMap="constanciaProgramaPuntosMapResult">
		SELECT  
		PAIS_COD_PAIS, 
		COD_PROG_CONS, 
		CAM_INIC, 
		CAM_FINA, 
		COD_PROG_PUNT, 
		VAL_MONT_MINI, 
		COD_TIPO_EVAL,
    	IND_INIC_MAXC,
		IND_ACTI 
		FROM INC_PROGR_CONST
		WHERE PAIS_COD_PAIS = #codigoPais#
		
		<isNotEmpty property="codigo">
			AND COD_PROG_CONS = #codigo#
		</isNotEmpty>
		
		ORDER BY COD_PROG_CONS
   	</select>
   	
   	<select id="getConstanciaProgramaPuntos" parameterClass="constanciaProgramaPuntos" resultMap="constanciaProgramaPuntosMapResult">
		SELECT  
		PAIS_COD_PAIS, 
		COD_PROG_CONS, 
		CAM_INIC, 
		CAM_FINA, 
		COD_PROG_PUNT, 
		VAL_MONT_MINI, 
		COD_TIPO_EVAL,
    	IND_INIC_MAXC, 
		IND_ACTI 
		FROM INC_PROGR_CONST
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND COD_PROG_CONS = #codigo#
   	</select>
   	
   	<insert id="insertConstanciaProgramaPuntos" parameterClass="constanciaProgramaPuntos">
   		INSERT INTO INC_PROGR_CONST(
			PAIS_COD_PAIS, 
			COD_PROG_CONS, 
			CAM_INIC, 
			CAM_FINA, 
			COD_PROG_PUNT, 
			VAL_MONT_MINI, 
			COD_TIPO_EVAL,
    		IND_INIC_MAXC,
			IND_ACTI,
			USU_CREA,
			FEC_CREA)
   		VALUES(
			#codigoPais#,
			#codigo#,
			#campanyaInicio#,
			#campanyaFin#,
			#codigoMultiPunto#,
			#montoMinimo#,
			#evaluacionPrograma#,
			#campanyaMaxima#,
			#indicadorActivo#,
	        #auditInfo.createdBy#, 
	        #auditInfo.created#)
   	</insert>
   	
   	<update id="updateConstanciaProgramaPuntos" parameterClass="constanciaProgramaPuntos">
   		UPDATE INC_PROGR_CONST SET
			CAM_INIC = #campanyaInicio#, 
			CAM_FINA = #campanyaFin#, 
			COD_PROG_PUNT = #codigoMultiPunto#, 
			VAL_MONT_MINI = #montoMinimo#, 
			COD_TIPO_EVAL = #evaluacionPrograma#,
    		IND_INIC_MAXC = #campanyaMaxima#,
			IND_ACTI = #indicadorActivo#,
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated# 
   		WHERE PAIS_COD_PAIS = #codigoPais# 
		AND COD_PROG_CONS = #codigo#   		 
   	</update>
   	
   	<insert id="insertRangoConstanciaProgramaPuntos" parameterClass="rangoConstanciaProgramaPuntos">
		INSERT INTO INC_PROGR_CONST_RANGO(
		    PAIS_COD_PAIS, 
		    COD_PROG_CONS, 
		    VAL_RANG_FINA, 
		    NUM_PUNT_ABON, 
		    FAC_MULT,
		    USU_CREA, 
		    FEC_CREA)
		VALUES(
		    #codigoPais#,
		    #codigoProgramaConstancia#,
		    #rangoFinal#,
		    #puntosAbono#,
		    #factorMultiplicador#,
	        #auditInfo.createdBy#, 
	        #auditInfo.created#)
   	</insert>
   	   	
   	<select id="getRangoConstanciaProgramaPuntosList" parameterClass="map" resultMap="rangoConstanciaProgramaPuntosMapResult">
		SELECT 
		    PAIS_COD_PAIS, 
		    COD_PROG_CONS, 
		    VAL_RANG_FINA, 
		    NUM_PUNT_ABON,
		    FAC_MULT 
		FROM INC_PROGR_CONST_RANGO
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND COD_PROG_CONS = #codigoProgramaConstancia#
		
		<isNotEmpty property="rangoFinal">
			AND VAL_RANG_FINA = #rangoFinal#
		</isNotEmpty>
		
		ORDER BY VAL_RANG_FINA
   	</select>
   	
   	<delete id="deleteRangoConstanciaProgramaPuntos" parameterClass="rangoConstanciaProgramaPuntos">
   		DELETE FROM INC_PROGR_CONST_RANGO 
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND COD_PROG_CONS = #codigoProgramaConstancia#
		AND VAL_RANG_FINA = #rangoFinal#
   	</delete>
   	
   	<select id="getExistePremiosDescuento" parameterClass="java.util.Map" resultClass="int">
   		SELECT count(*)
      FROM INC_ARTIC_LOTE C, MAE_PRODU D
     WHERE C.LOPA_OID_LOTE_PREM_ARTI = #oidPremio# AND c.IND_TIPO_PREM = #valueIndTipoPrem#
            AND C.PROD_OID_PROD = D.OID_PROD
          ORDER BY C.COD_VENT_FICT, D.COD_SAP
   	   	   	</select>
   	
   	<select id="getExistePremiosArticulo" parameterClass="java.util.Map" resultClass="int">
   		SELECT count(*)
		  FROM INC_ARTIC_LOTE C, MAE_PRODU D
		 WHERE C.LOPA_OID_LOTE_PREM_ARTI = #oidPremio#
       	   AND C.PROD_OID_PROD = D.OID_PROD AND 
       	   (c.ind_tipo_prem= #valueIndTipoPrem# or c.ind_tipo_prem is Null)
       	 ORDER BY C.COD_VENT_FICT, D.COD_SAP 
   	   	   	</select>
   	
   	<resultMap id="concursoArticuloLoteDescuentoResult"   class="concursoArticuloLoteDescuento">
		<result property="oid"					  		column="OID_ARTI_LOTE"/>					
		<result property="indicadorDespacho"			column="IND_DESP"/>
		<result property="precioPublico"				column="IMP_PREC_PUBL"/>
		<result property="numeroUnidades"				column="NUM_UNID"/>
		<result property="codigoVentaFicticio"			column="COD_VENT_FICT"/>
		<result property="oidProducto"					column="PROD_OID_PROD"/>					
		<result property="oidLotePremioArticulo"		column="LOPA_OID_LOTE_PREM_ARTI"/>
		<result property="indicadorCentroServicio"		column="IND_CENT_DIST_GARA"/>
		<result property="oidCentroServGarantia"		column="CESE_OID_CESE_GARA"/>
		<result property="numeroMesesGarantia"			column="NUM_MESE_GARA"/>
		<result property="observaciones"				column="OBS_CENT_DIST"/>
		<result property="indicadorTipoEntrega"			column="IND_TIPO_ENTR_PREM"/>
		<result property="oidCentroServEntrega"			column="CESE_OID_CESE_ENTR"/>
		<result property="codigoSAP"					column="COD_SAP"/>
		<result property="descripcionProducto"			column="DES_PROD"/>
		<result property="montoDescuento"			    column="VAL_PREM_DESC"/>
            </resultMap>
    
 	<select id="getListConcursoArticuloLoteDescuento" parameterClass="string" resultMap="concursoArticuloLoteDescuentoResult">
		SELECT C.*, D.COD_SAP,
			   pq_apl_aux.Valor_Gen_I18n_Sicc(1, D.OID_PROD, 'MAE_PRODU') DES_PROD
		  FROM INC_ARTIC_LOTE C, MAE_PRODU D
		 WHERE C.LOPA_OID_LOTE_PREM_ARTI = #value#
       	   AND C.PROD_OID_PROD = D.OID_PROD AND IND_TIPO_PREM = 'D'
       	 ORDER BY C.COD_VENT_FICT, D.COD_SAP 
 	 	 	</select> 
 	
 	<select id="getcodigoProductoDescuento" resultClass="string">
		select max(cod_sap) from mae_produ
			</select>
	
	 <delete id="deleteArticulosLoteDescuento" parameterClass="java.util.Map">
    	DELETE FROM INC_ARTIC_LOTE
		WHERE LOPA_OID_LOTE_PREM_ARTI = #oidLotePremio# AND IND_TIPO_PREM = 'D'
		<iterate prepend="AND" property="oidArticuloLote" open=" OID_ARTI_LOTE NOT IN (" close=")" conjunction=",">
        	#oidArticuloLote[]#
						</iterate>    
			</delete>
	
	<insert id="insertConcursoArticuloLoteDescuento" parameterClass="concursoArticuloLoteDescuento">
		INSERT INTO INC_ARTIC_LOTE
            (OID_ARTI_LOTE,
			 IND_DESP,
			 IMP_PREC_PUBL,
			 NUM_UNID,
			 COD_VENT_FICT,
			 PROD_OID_PROD,
			 LOPA_OID_LOTE_PREM_ARTI,
			 
			 CESE_OID_CESE_GARA,
			 NUM_MESE_GARA,
			 OBS_CENT_DIST,
			 
			 CESE_OID_CESE_ENTR,
			 USU_CREA,
			 FEC_CREA,
			 IND_TIPO_PREM,
			 VAL_PREM_DESC)
	     VALUES 
	     	(INC_ARLO_SEQ.NEXTVAL,
			 #indicadorDespacho#,
			 #precioPublico#,
			 #numeroUnidades#,
			 #codigoVentaFicticio#,
			 (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			 #oidLotePremioArticulo#,
			
			 #oidCentroServGarantia#,
			 #numeroMesesGarantia#,
			 #observaciones#,
			 
			 #oidCentroServEntrega#,
			 #auditInfo.createdBy#,
			 #auditInfo.created#,
			 'D',
			 #montoDescuento#
			)
            </insert>
	
	 <update id="updateConcursoArticuloLoteDescuento" parameterClass="concursoArticuloLoteDescuento">
		UPDATE INC_ARTIC_LOTE
		   SET IND_DESP       	    	= #indicadorDespacho#,
			   IMP_PREC_PUBL   			= #precioPublico#,
			   NUM_UNID       			= #numeroUnidades#,
			   COD_VENT_FICT 			= #codigoVentaFicticio#,
			   PROD_OID_PROD       	    =  (SELECT OID_PROD FROM MAE_PRODU WHERE COD_SAP = #codigoSAP#),
			   LOPA_OID_LOTE_PREM_ARTI  = #oidLotePremioArticulo#,
			  
			   CESE_OID_CESE_GARA  		= #oidCentroServGarantia#,
			   NUM_MESE_GARA  			= #numeroMesesGarantia#,
			   OBS_CENT_DIST       	    = #observaciones#,
			   IND_TIPO_ENTR_PREM   	= #indicadorTipoEntrega#,
			   CESE_OID_CESE_ENTR       = #oidCentroServEntrega#,
			   USU_MODI                 = #auditInfo.updatedBy#,      
			   FEC_MODI		            = #auditInfo.lastUpdated#,
			   VAL_PREM_DESC            = #montoDescuento#
		 WHERE OID_ARTI_LOTE 	 	= #oid#
    </update>
    
    <select id="getNivelSelectivo" parameterClass="java.util.Map" resultClass="int">
   		SELECT count(*) FROM INC_PARAM_NIVEL_PREMI ip, INC_PARAM_GENER_PREMI ipg
		WHERE ip.pagp_oid_para_gene_prem = ipg.oid_para_gene_prem
		AND ip.val_nive_sele = #valorNivelSele# 
		AND ipg.tprm_oid_tipo_pion = #tipoPion#
		AND ip.oid_para_nive_prem = #oidNivelPremio#
   	</select>
   	
   	
   	<select id="getClasificacionParaINCByCriteria" parameterClass="map" resultMap="clasificacionParaINCResult">
		SELECT  
		  	OID_PART_CONC_CABE, 
			VAL_GRUP_CLIE, 
			PAIS_OID_PAIS, 
			DIRI_OID_DIRI, 
			DES_DESC
		FROM INC_PARTI_CONCU_CABEC
		WHERE PAIS_OID_PAIS = #oidPais#
		
		<isNotEmpty prepend="AND" property="descripcionLike">
			DES_DESC LIKE #descripcionLike#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="descripcion">
			DES_DESC = #descripcion#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="secuencial">
			OID_PART_CONC_CABE = #secuencial#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="diferenteSecuencial">
			OID_PART_CONC_CABE != #diferenteSecuencial#
		</isNotEmpty>
		
		ORDER BY DES_DESC
   	</select>
   	
   	<select id="getClasificacionParaINC" parameterClass="map" resultMap="clasificacionParaINCResult">
		SELECT  
		  	OID_PART_CONC_CABE, 
			VAL_GRUP_CLIE, 
			PAIS_OID_PAIS, 
			DIRI_OID_DIRI, 
			DES_DESC
		FROM INC_PARTI_CONCU_CABEC
		WHERE PAIS_OID_PAIS = #oidPais#
		 AND OID_PART_CONC_CABE = #secuencial#
   	</select>
   	
   	<select id="getNextOidClasificacionParaINC" parameterClass="map" resultClass="java.lang.Integer">
 		select INC_PACI_SEQ.nextVal from dual
 	</select>
   	
   	<insert id="insertClasificacionParaINC" parameterClass="clasificacionParaINC">
   		INSERT INTO INC_PARTI_CONCU_CABEC(
			OID_PART_CONC_CABE, 
			VAL_GRUP_CLIE, 
			PAIS_OID_PAIS, 
			DIRI_OID_DIRI, 
			DES_DESC,
			USU_CREA,
			FEC_CREA)
   		VALUES(
			#secuencial#,
			#valorGrupoCliente#,
			#oidPais#,
			#oidDestinatario#,
			#descripcion#,
			#auditInfo.createdBy#, 
	        #auditInfo.created#)
   	</insert>
   	
   	<update id="updateClasificacionParaINC" parameterClass="clasificacionParaINC">
   		UPDATE INC_PARTI_CONCU_CABEC 
   		SET
			VAL_GRUP_CLIE = #valorGrupoCliente#, 
			DIRI_OID_DIRI = #oidDestinatario#, 
			DES_DESC = #descripcion#, 
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated# 
   		WHERE OID_PART_CONC_CABE = #secuencial#   		 
   	</update>
   	
   	<delete id="deleteClasificacionParaINC" parameterClass="clasificacionParaINC">
   		DELETE FROM INC_PARTI_CONCU_CABEC 
   		WHERE OID_PART_CONC_CABE = #secuencial#   		 
   	</delete>
   	
   	
   	<select id="getNextOidClasificacionParaINCDetalle" parameterClass="map" resultClass="java.lang.Integer">
 		select INC_PAC3_SEQ.nextVal from dual
 	</select>
 	
 	
 	<select id="getClasificacionParaINCDetalleByCriteria" parameterClass="map" resultMap="clasificacionParaINCDetalleResult">
 	   SELECT  DETAL.OID_PART_CONC_DETA,
               DETAL.PACI_OID_PART_CONC_CABE,
               DETAL.TICL_OID_TIPO_CLIE,
	           DETAL.SBTI_OID_SUBT_CLIE,
	           DETAL.TCCL_OID_TIPO_CLAS,
	           DETAL.CLAS_OID_CLAS,
	           A.COD_TIPO_CLIE,
	           B.COD_SUBT_CLIE,
	           C.COD_TIPO_CLAS,
	           D.COD_CLAS,
	           A.COD_TIPO_CLIE || '  ' || A1.VAL_I18N DES_TIPO_CLIE,
	           B.COD_SUBT_CLIE || '  ' || B1.VAL_I18N DES_SUBT_CLIE,
	           C.COD_TIPO_CLAS || '  ' || C1.VAL_I18N DES_TIPO_CLAS,
	           D.COD_CLAS || ' ' || D1.VAL_I18N DES_CLAS,
	           DETAL.DES_DESC
	      FROM MAE_TIPO_CLIEN                A,
	           MAE_SUBTI_CLIEN               B,
	           MAE_TIPO_CLASI_CLIEN          C,
	           MAE_CLASI                     D,
	           GEN_I18N_SICC_COMUN          A1,
	           GEN_I18N_SICC_COMUN          B1,
	           GEN_I18N_SICC_COMUN          C1,
	           GEN_I18N_SICC_COMUN          D1,
	           INC_PARTI_CONCU_DETAL    DETAL
	     WHERE A.OID_TIPO_CLIE = A1.VAL_OID
	       AND B.OID_SUBT_CLIE = B1.VAL_OID
	       AND C.OID_TIPO_CLAS = C1.VAL_OID
	       AND D.OID_CLAS = D1.VAL_OID
	       AND A1.ATTR_ENTI = 'MAE_TIPO_CLIEN'
	       AND B1.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
	       AND C1.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN'
	       AND D1.ATTR_ENTI = 'MAE_CLASI'
	       AND A.OID_TIPO_CLIE = B.TICL_OID_TIPO_CLIE
	       AND B.OID_SUBT_CLIE = C.SBTI_OID_SUBT_CLIE
	       AND C.OID_TIPO_CLAS = D.TCCL_OID_TIPO_CLAS
	       AND DETAL.TICL_OID_TIPO_CLIE = A.OID_TIPO_CLIE
	       AND DETAL.SBTI_OID_SUBT_CLIE = B.OID_SUBT_CLIE
	       AND C.OID_TIPO_CLAS = DETAL.TCCL_OID_TIPO_CLAS 
	       AND D.OID_CLAS = DETAL.CLAS_OID_CLAS 
	       AND DETAL.PACI_OID_PART_CONC_CABE = #secuencialCabecera#
	    <isNotEmpty prepend="AND" property="descripcionLike">
			DETAL.DES_DESC LIKE #descripcionLike#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="descripcion">
			DETAL.DES_DESC = #descripcion#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="secuencialDetalle">
			DETAL.OID_PART_CONC_DETA = #secuencialDetalle#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="diferenteSecuencialDetalle">
			DETAL.OID_PART_CONC_DETA != #diferenteSecuencialDetalle#
		</isNotEmpty>  
	     ORDER BY DETAL.OID_PART_CONC_DETA,
	              DETAL.PACI_OID_PART_CONC_CABE,
	              DETAL.DES_DESC
	</select>
	
	<select id="getClasificacionParaINCDetalle" parameterClass="map" resultMap="clasificacionParaINCDetalleResult">
 	   SELECT  DETAL.OID_PART_CONC_DETA,
               DETAL.PACI_OID_PART_CONC_CABE,
               DETAL.TICL_OID_TIPO_CLIE,
	           DETAL.SBTI_OID_SUBT_CLIE,
	           DETAL.TCCL_OID_TIPO_CLAS,
	           DETAL.CLAS_OID_CLAS,
	           A.COD_TIPO_CLIE,
	           B.COD_SUBT_CLIE,
	           C.COD_TIPO_CLAS,
	           D.COD_CLAS,
	           A.COD_TIPO_CLIE || '  ' || A1.VAL_I18N DES_TIPO_CLIE,
	           B.COD_SUBT_CLIE || '  ' || B1.VAL_I18N DES_SUBT_CLIE,
	           C.COD_TIPO_CLAS || '  ' || C1.VAL_I18N DES_TIPO_CLAS,
	           D.COD_CLAS || ' ' || D1.VAL_I18N DES_CLAS,
	           DETAL.DES_DESC
	      FROM MAE_TIPO_CLIEN                A,
	           MAE_SUBTI_CLIEN               B,
	           MAE_TIPO_CLASI_CLIEN          C,
	           MAE_CLASI                     D,
	           GEN_I18N_SICC_COMUN          A1,
	           GEN_I18N_SICC_COMUN          B1,
	           GEN_I18N_SICC_COMUN          C1,
	           GEN_I18N_SICC_COMUN          D1,
	           INC_PARTI_CONCU_DETAL    DETAL
	     WHERE A.OID_TIPO_CLIE = A1.VAL_OID
	       AND B.OID_SUBT_CLIE = B1.VAL_OID
	       AND C.OID_TIPO_CLAS = C1.VAL_OID
	       AND D.OID_CLAS = D1.VAL_OID
	       AND A1.ATTR_ENTI = 'MAE_TIPO_CLIEN'
	       AND B1.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
	       AND C1.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN'
	       AND D1.ATTR_ENTI = 'MAE_CLASI'
	       AND A.OID_TIPO_CLIE = B.TICL_OID_TIPO_CLIE
	       AND B.OID_SUBT_CLIE = C.SBTI_OID_SUBT_CLIE
	       AND C.OID_TIPO_CLAS = D.TCCL_OID_TIPO_CLAS
	       AND DETAL.TICL_OID_TIPO_CLIE = A.OID_TIPO_CLIE
	       AND DETAL.SBTI_OID_SUBT_CLIE = B.OID_SUBT_CLIE
	       AND C.OID_TIPO_CLAS = DETAL.TCCL_OID_TIPO_CLAS 
	       AND D.OID_CLAS = DETAL.CLAS_OID_CLAS 
	       AND DETAL.PACI_OID_PART_CONC_CABE = #secuencialCabecera#
	       AND DETAL.OID_PART_CONC_DETA = #secuencialDetalle#
	</select>
	
	
	
	<select id="getTipoClienteList" parameterClass="map" resultMap="baseOidIncentivoResult">
		select a.oid_tipo_clie as OID,
		       a.cod_tipo_clie || '  ' || b.val_i18n as DESCRIPCION
		from mae_tipo_clien a,
		     gen_i18n_sicc_comun b
		where a.oid_tipo_clie=b.val_oid
		  and b.attr_enti='MAE_TIPO_CLIEN'
		order by a.cod_tipo_clie
	</select>
	
	<select id="getSubTipoClienteList" parameterClass="map" resultMap="baseOidIncentivoResult">
		select c.oid_subt_clie as OID,
	           c.COD_SUBT_CLIE || ' ' || b.val_i18n as DESCRIPCION
	    from mae_subti_clien c,
	        gen_i18n_sicc_comun b
	    where c.oid_subt_clie=b.val_oid
	      and b.attr_enti='MAE_SUBTI_CLIEN' 
	      and c.ticl_oid_tipo_clie = #oidTipocliente#
	    order by c.COD_SUBT_CLIE
	</select>
	
	<select id="getTipoClasificacionList" parameterClass="java.util.Map"  resultMap="baseOidIncentivoResult">
		select d.oid_tipo_clas as OID,
		       d.cod_tipo_clas || '  ' || b.val_i18n as DESCRIPCION
		from mae_tipo_clasi_clien d,
		     gen_i18n_sicc_comun b
		where d.oid_tipo_clas = b.val_oid
		  and b.attr_enti = 'MAE_TIPO_CLASI_CLIEN'
		  and d.sbti_oid_subt_clie = #oidSubtipocliente#
		order by d.cod_tipo_clas
	</select>
	
	<select id="getClasificacionList" parameterClass="java.util.Map"  resultMap="baseOidIncentivoResult">
		select e.oid_clas as OID,
		       e.cod_clas || ' ' || b.val_i18n as DESCRIPCION
		from mae_clasi e,gen_i18n_sicc_comun b
		where e.oid_clas = b.val_oid
		  and b.attr_enti = 'MAE_CLASI'
		  and e.tccl_oid_tipo_clas = #oidTipoClasificacion# 
		order by e.cod_clas
	</select>
	
	
	<insert id="insertClasificacionParaINCDetalle" parameterClass="clasificacionParaINCDetalle">
   		INSERT INTO INC_PARTI_CONCU_DETAL(
   		    PACI_OID_PART_CONC_CABE,
			OID_PART_CONC_DETA, 
			TICL_OID_TIPO_CLIE,
			SBTI_OID_SUBT_CLIE,
			TCCL_OID_TIPO_CLAS,
			CLAS_OID_CLAS,
			DES_DESC,
			USU_CREA,
			FEC_CREA)
   		VALUES(
			#secuencialCabecera#,
			#secuencialDetalle#,
			#oidTipocliente#,
			#oidSubtipocliente#,
			#oidTipoClasificacion#,
			#oidClasificacion#,
			#descripcion#,
			#auditInfo.createdBy#, 
	        #auditInfo.created#)
   	</insert>
	
	<update id="updateClasificacionParaINCDetalle" parameterClass="clasificacionParaINCDetalle">
   		UPDATE INC_PARTI_CONCU_DETAL 
   		SET
			TICL_OID_TIPO_CLIE = #oidTipocliente#,
	        SBTI_OID_SUBT_CLIE = #oidSubtipocliente#,
	        TCCL_OID_TIPO_CLAS = #oidTipoClasificacion#,
	        CLAS_OID_CLAS = #oidClasificacion#,
			DES_DESC = #descripcion#, 
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated# 
   		WHERE OID_PART_CONC_DETA = #secuencialDetalle#		 
   	</update>
   	
   	<delete id="deleteClasificacionParaINCDetalle" parameterClass="clasificacionParaINCDetalle">
   		DELETE FROM INC_PARTI_CONCU_DETAL 
   		WHERE OID_PART_CONC_DETA = #secuencialDetalle#		 
   	</delete>
   	
   	<select id="getExisteRegistroClasificacionPartiConcu" parameterClass="java.util.Map"  resultClass="java.lang.Integer">
		SELECT count(1) FROM INC_CLASI_PARTI_CONCU 
        WHERE PACI_OID_PART_CONC_CABE = #secuencial#	
	</select>
	
	<select id="getExisteRegistroClasificacionDetalle" parameterClass="java.util.Map"  resultClass="java.lang.Integer">
		SELECT count(1) FROM INC_PARTI_CONCU_DETAL  
        WHERE PACI_OID_PART_CONC_CABE = #secuencial#	
	</select>
	
	<insert id="insertNuevaConstanciaProgramaPuntos" parameterClass="nuevaConstanciaProgramaPuntos">
		INSERT INTO INC_PROGR_CONST_NUEVA(
		    PAIS_COD_PAIS, 
		    COD_PROG_CONS, 
		    NUM_CAMP_EXIG, 
		    NUM_PEDI_EXIG, 
		    NUM_PUNT_ABON,
		    USU_CREA, 
		    FEC_CREA)
		VALUES(
		    #codigoPais#,
		    #codigoProgramaConstancia#,
		    #periodosExigidos#,
		    #pedidosExigidos#,
		    #puntosAbonar#,
	        #auditInfo.createdBy#, 
	        #auditInfo.created#)
   	</insert>
   	   	
   	<select id="getNuevaConstanciaProgramaPuntosList" parameterClass="map" resultMap="nuevaConstanciaProgramaPuntosMapResult">
		SELECT 
		    PAIS_COD_PAIS, 
		    COD_PROG_CONS, 
		    NUM_CAMP_EXIG, 
		    NUM_PEDI_EXIG,
		    NUM_PUNT_ABON 
		FROM INC_PROGR_CONST_NUEVA
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND COD_PROG_CONS = #codigoProgramaConstancia#
		
		<isNotEmpty property="periodosExigidos">
			AND NUM_CAMP_EXIG = #periodosExigidos#
		</isNotEmpty>
		
		ORDER BY NUM_CAMP_EXIG
   	</select>
   	
   	<delete id="deleteNuevaConstanciaProgramaPuntos" parameterClass="nuevaConstanciaProgramaPuntos">
   		DELETE FROM INC_PROGR_CONST_NUEVA 
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND COD_PROG_CONS = #codigoProgramaConstancia#
		AND NUM_CAMP_EXIG = #periodosExigidos#
   	</delete>
   	
   	<select id="getListConcursosTipoProgramaPuntos" resultMap="baseResult">
		SELECT NUM_CONC CODIGO,  
        NUM_CONC || ' - ' || VAL_NOMB DESCRIPCION,
		   NUM_CONC FROM inc_concu_param_gener 
        WHERE IND_PROG_PUNT='1' 
        ORDER BY NUM_CONC DESC
	</select>
	
	<resultMap id="getCampaniasIniFinByConcursoTipoProgramaPuntosResult" class="java.util.HashMap">
	  <result property="periodoDesde" 	column="PERD_OID_PERI_DESD"/>
	  <result property="periodoHasta" 	column="PERD_OID_PERI_HAST"/>
   </resultMap>
 
	<select id="getCampaniasIniFinByConcursoTipoProgramaPuntos" 
	  resultMap="getCampaniasIniFinByConcursoTipoProgramaPuntosResult" parameterClass="string" >
	    select gen_pkg_gener.gen_fn_devuelve_id_cra_perio3(PERD_OID_PERI_DESD) PERD_OID_PERI_DESD,
        gen_pkg_gener.gen_fn_devuelve_id_cra_perio3(PERD_OID_PERI_HAST) PERD_OID_PERI_HAST
        FROM INC_CONCU_PARAM_GENER 
        WHERE NUM_CONC = #value#
   </select>
	
</sqlMap>