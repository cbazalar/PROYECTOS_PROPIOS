<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.cuentacorriente.procesosCCCSQL">

	<typeAlias alias="baseGenericoCCC"                          		type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
	<typeAlias alias="regularizacionPagoBancario"               		type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.RegularizacionPagoBancario"/>
        <typeAlias alias="errorPagoBancario"               				    type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.ErrorPagoBancario"/>
	<typeAlias alias="estructuraCADMasivos"  						    type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.EstructuraCADMasivos" />
	<typeAlias alias="estructuraChequesDigitados"  						type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.EstructuraChequesDigitados" />	
	<typeAlias alias="pagoBancarioExterno"  						    type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.PagoBancarioExterno" />
	<typeAlias alias="estructuraCADDocumentoLegalMasivos"  		        type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.EstructuraCADDocumentoLegalMasivos" />	
	<typeAlias alias="estructuraBloqueoFinancieroMasivo"  		        type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.EstructuraBloqueoFinancieroMasivo" />
	<typeAlias alias="estructuraPagosBancariosMasivos"  	    	    type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.EstructuraPagosBancariosMasivos" />
	<typeAlias alias="estructuraPagosBancariosPorRegularizarMasivos"  	type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.EstructuraPagosBancariosPorRegularizarMasivos" />
	<typeAlias alias="codigoVentaLabelValue"  						    type="biz.belcorp.ssicc.dao.model.LabelValueCUV"/>
	<typeAlias alias="cargosyAbonos"               					    type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.CargosyAbonos"/>
	<typeAlias alias="gastosAdministrativos"               				type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.GastosAdministrativos"/>
	<typeAlias alias="datosConsultoraBasico" 							type="biz.belcorp.ssicc.dao.spusicc.cuentacorriente.model.DatosConsultoraBasico"/>
	
	<resultMap id="baseResultCCC"          class="baseGenericoCCC">
    	<result property="codigo" 		   column="CODIGO" 	/>
    	<result property="descripcion" 	   column="DESCRIPCION"/>
    </resultMap>    
    
    <resultMap id="cuentaCorrienteHistoricaConsultoraResult"      class="cuentaCorrienteConsultora">
		<result property="fechaEmision"                column="FEC_EMIS_DOCU"/>	   
       	<result property="campanaReferencia"           column="CAM_REFE"/>	   
       	<result property="tipoMovimiento"              column="TIP_MOVI"/>
       	<result property="oidMovimiento"               column="OID_MOVI"/>
       	<result property="oidConsolidado"              column="SOCA_OID_SOLI_CABE"/>
       	<result property="numeroDocumento"             column="NUM_DOCU"/>		          		   
       	<result property="fechaVencimiento"            column="FEC_VENC"/>		          		   
       	<result property="fechaPago"                   column="FEC_PAGO"/>		          		   
       	<result property="cargo"                       column="IMP_CARG"/>		          		   
       	<result property="abono"                       column="IMP_ABON"/>		          		   
    </resultMap>
    
    <resultMap id="detalleCargaLoteBancarioResult"          class="java.util.HashMap">
    	<result property="numeroLote" 			column="LOTE"/>
		<result property="descripcionBanco" 	column="BANCO"/>
		<result property="fechaPagoMinimo"  	column="FECHAPAGOMIN"/>
		<result property="fechaPagoMaximo"  	column="FECHAPAGOMAX"/>
		<result property="cantidadTotal"    	column="CANT"/>
		<result property="importeTotal"     	column="IMP"/>
		<result property="cantidadOk"   		column="CANT_OK"/>
		<result property="importeOk"   			column="IMP_OK"/>
		<result property="cantidadError" 		column="CANT_ERRO"/>
		<result property="importeError"   		column="IMP_ERRO"/>
    </resultMap>
        		        
	<resultMap id="regularizacionPagoBancarioMantenimientoResult"	class="java.util.HashMap">
		<result property="oidMovimientoBancario"             	column="OID"/>
    	<result property="codigoCuentaCorrienteBancaria"        column="COD_BANC"/>
    	<result property="descripcionCuentaCorrienteBancaria"   column="DES_BANC"/>
    	<result property="descripcionError"   					column="DES_ERRO"/>
    	<result property="codigoConsultora"                     column="COD_CONS"/>
    	<result property="cedulaConsultora"                     column="NUM_DOCU_IDEN"/>
       	<result property="fechaProceso"                 	    column="FEC_PROC"/>
       	<result property="fechaPago"                 	        column="FEC_PAGO"/>
    	<result property="importePago"                          column="IMP_PAGO"/>		    	       		           	  
    </resultMap>		
                      
	<resultMap id="regularizacionPagoBancarioMantenimiento"	class="regularizacionPagoBancario">
	    <result property="oidMovimientoBancario"             column="OID"/>
	    <result property="codigoPais"                        column="COD_PAIS"/>
	    <result property="codigoSociedad"                    column="COD_SOCI"/>
    	<result property="codigoBanco"                       column="COD_BANC"/>
    	<result property="codigoCuentaCorriente"        	 column="DES_CC"/>
    	<result property="codigoConsultora"                  column="COD_CONS"/>
       	<result property="fechaPago"                 	     column="FEC_PAGO"/>
    	<result property="importePago"                       column="IMP_PAGO"/>		    	       		           	  
    </resultMap>
    
    <resultMap id="gestionarErrorPagoBancarioMantenimientoResult"	class="java.util.HashMap">
		<result property="oidMovimientoBancario"             	column="OID"/>
    	<result property="descripcionCuentaCorrienteBancaria"   column="DES_CC"/>
    	<result property="codigoConsultora"                     column="COD_CONS"/>
        <result property="fechaProceso"                 	        column="FEC_PROC"/>
       	<result property="fechaPago"                 	        column="FEC_PAGO"/>
    	<result property="importePago"                          column="IMP_PAGO"/>		    	       		           	  
        <result property="descripcionError"                     column="DES_ERRO"/>
    </resultMap>
    
    <resultMap id="errorPagoBancarioMantenimiento"	class="errorPagoBancario">
	    <result property="oidMovimientoBancario"                  column="OID"/>	    	       	
    	<result property="descripcionCuentaCorrienteBancaria"     column="DES_CC"/>
    	<result property="codigoConsultora"                       column="COD_CONS"/>
    	<result property="fechaProceso"                 	      column="FEC_PROC"/>
       	<result property="fechaPago"                 	          column="FEC_PAGO"/>
    	<result property="importePago"                            column="IMP_PAGO"/>
    	<result property="descripcionError"                       column="DES_ERRO"/>		    	       		           	  
    </resultMap>
    
    <resultMap id="ErrorCargaCargosAbonosMasivos" class="java.util.HashMap">      
		<result property="fila" 							 column="VAL_FILA" />              
		<result property="codigoError" 						 column="COD_ERRO" />       
		<result property="descripcionError" 				 column="DES_ERRO" />  
   </resultMap>

   <resultMap id="ErrorCargaCADDocumentoLegalMasivos" class="java.util.HashMap">         	
		<result property="fila" 							 column="VAL_FILA" />              
		<result property="codigoError" 						 column="COD_ERRO" />       
		<result property="descripcionError" 				 column="DES_ERRO" />  
   </resultMap>
   
   <resultMap id="ErrorBloqueoFinancieroMasivo" class="java.util.HashMap">         	
		<result property="fila" 							 column="VAL_FILA" />              
		<result property="codigoError" 						 column="COD_ERRO" />       
		<result property="descripcionError" 				 column="DES_ERRO" />  
   </resultMap>
              		       
   <resultMap id="detalleCuponTramiteDepur"	class="java.util.HashMap">
		<result property="oidDetalleCupon"             	        column="ID"/>
		<result property="codCliente"                        	column="COD_CLIE"/>
	    <result property="nomCliente"                           column="NOM_CLIE"/> 
    	<result property="monto"                             	column="MONTO"/>
    	<result property="fecha"                               	column="FECHA"/>
    	<result property="situacion"                            column="SITUACION"/>	    	       		           	  
    </resultMap>
     
    <resultMap id="getGastosAdmministrativosListResult"  class="java.util.HashMap">
    	<result property="oid"	                     column="OID"/>
    	<result property="descripcionRegion"         column="DESC_REGION"/>
    	<result property="descripcionZona"           column="DESC_ZONA"/>
    	<result property="descripcionSeccion"        column="DESC_SECCION"/>
		<result property="tipoCliente"	             column="TIPO_CLIENTE"/>
		<result property="subTipoCliente"            column="SUBTIPO_CLIENTE"/>
		<result property="tipoClasificacionCliente"  column="TIPO_CLASIFICACION_CLIENTE"/>
		<result property="clasificacion"             column="CLASIFICACION"/>
		<result property="codigoCliente"             column="CODIGO_CLIENTE"/>		
		<result property="statusCliente"             column="ESTA_CLIEN_DES"/>
		<result property="diasGracia"                column="VAL_DGRA"/>
		<result property="montoMinimo"               column="VAL_MMIN"/>
		<result property="importeGasto"              column="IMP_GAST"/>
		<result property="indicadorEjecucion"        column="IND_EJEC"/>				       
	</resultMap>
	
	<resultMap id="datosConsultoraBasicoResult" 	 			class="datosConsultoraBasico">
		<result property="codigoConsultora"			 		column ="COD_CONS"/>		                     			
		<result property="nombreConsultora"					column ="NOMB"/>
		<result property="tipoDocumento"					column ="TIPO_DOC"/>
		<result property="documentoIdentidad"				column ="NUM_DOC_IDEN"/>		
	</resultMap>
	
    <!-- OBTIENE LOS CUENTAS CORRIENTES BANCARIAS -->
	<select id="getCuentasCorrientesBancariasList" parameterClass="java.util.Map" resultMap="baseResultCCC">
	   SELECT 
	      CCB.COD_CC AS CODIGO, 
	   	  CCB.DES_CC AS DESCRIPCION
	   FROM CCC_CUENT_CORRI_BANCA CCB
	</select>
	
	<select id="getBancosDigitablesList" parameterClass="java.util.Map" resultMap="baseResultCCC">
	   SELECT 
	      CCB.COD_CC AS CODIGO, 
	   	  CCB.DES_CC AS DESCRIPCION
	   FROM CCC_CUENT_CORRI_BANCA CCB
	   WHERE CCB.IND_BANC_DIGI  = 1
	</select>
	
	<!-- OBTIENE LOS CUENTAS CORRIENTES BANCARIAS -->
	<select id="getCuentasCorrientesBancariasExternasList" parameterClass="java.util.Map" resultMap="baseResultCCC">
	   SELECT 
	      CCB.COD_CC AS CODIGO, 
	   	  CCB.DES_CC AS DESCRIPCION
	   FROM CCC_CUENT_CORRI_BANCA CCB
	   WHERE CCB.IND_CUEN_CORR_EXTE = 1
	</select>
	 
	              
	<!-- OBTIENE LOS TIPOS DE CARGOS Y ABONOS DIRECTOS-->
	<select id="getTiposCargoAbonoDirectos" parameterClass="java.util.Map" resultMap="baseResultCCC">
    	SELECT  
    		TPSP.OID_TIPO_ABON_SUBP AS CODIGO,
   			PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TCA.OID_TIPO_CARG_ABON,'CCC_TIPO_CARGO_ABONO') AS DESCRIPCION
  		FROM CCC_PROCE            PRO,
       		 CCC_SUBPR            SBP,
       	     CCC_TIPO_ABONO_SUBPR TPSP,
       	     CCC_TIPO_CARGO_ABONO TCA
 	    WHERE PRO.OID_PROC = SBP.CCPR_OID_PROC
   		AND SBP.OID_SUBP = TPSP.SUBP_OID_SUBP
   		AND TCA.OID_TIPO_CARG_ABON = TPSP.TCAB_OID_TCAB
   		AND PRO.IND_CV_DIRE = 1
   		<![CDATA[
			AND SBP.VAL_INDI_CONS <> 'N'
		]]>   		
   		ORDER BY 2,1 ASC
	</select>               
	
	<!-- OBTIENE LOS TIPOS DE CARGOS DIRECTOS-->
	<select id="getTiposCargosDirectos" parameterClass="java.util.Map" resultMap="baseResultCCC">
    	SELECT  
    		TPSP.OID_TIPO_ABON_SUBP AS CODIGO,
   			PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TCA.OID_TIPO_CARG_ABON,'CCC_TIPO_CARGO_ABONO') AS DESCRIPCION
  		FROM 
  		 CCC_PROCE            PRO,
         CCC_SUBPR            SBP,
       	 CCC_TIPO_ABONO_SUBPR TPSP,
       	 CCC_TIPO_CARGO_ABONO TCA
 	    WHERE PRO.OID_PROC = SBP.CCPR_OID_PROC
   		  AND SBP.OID_SUBP = TPSP.SUBP_OID_SUBP
   		  AND TCA.OID_TIPO_CARG_ABON = TPSP.TCAB_OID_TCAB
   		  AND SBP.IND_CARG_DIRE = 1    		  				
   		ORDER BY 2,1 ASC
	</select>               
	
	<!-- OBTIENE LOS TIPOS DE ABONOS DIRECTOS-->
	<select id="getTiposAbonosDirectos" parameterClass="java.util.Map" resultMap="baseResultCCC">
    	SELECT  
    		TPSP.OID_TIPO_ABON_SUBP AS CODIGO,
   			PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TCA.OID_TIPO_CARG_ABON,'CCC_TIPO_CARGO_ABONO') AS DESCRIPCION
  		FROM CCC_PROCE            PRO,
       		 CCC_SUBPR            SBP,
       	     CCC_TIPO_ABONO_SUBPR TPSP,
       	     CCC_TIPO_CARGO_ABONO TCA
 	    WHERE PRO.OID_PROC = SBP.CCPR_OID_PROC
   		AND SBP.OID_SUBP = TPSP.SUBP_OID_SUBP
   		AND TCA.OID_TIPO_CARG_ABON = TPSP.TCAB_OID_TCAB
   		AND SBP.IND_ABON_DIRE = 1   		 		 		
   		ORDER BY 2,1 ASC
	</select>               
	
	<!-- OBTIENE LOS TIPOS DE CARGOS DIRECTOS DIGITABLES-->
	<select id="getTiposCargosDirectosDigitables" parameterClass="java.util.Map" resultMap="baseResultCCC">
    	SELECT  
    		TPSP.OID_TIPO_ABON_SUBP AS CODIGO,
   			PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TCA.OID_TIPO_CARG_ABON,'CCC_TIPO_CARGO_ABONO') AS DESCRIPCION
  		FROM 
  		 CCC_PROCE            PRO,
         CCC_SUBPR            SBP,
       	 CCC_TIPO_ABONO_SUBPR TPSP,
       	 CCC_TIPO_CARGO_ABONO TCA
 	    WHERE PRO.OID_PROC = SBP.CCPR_OID_PROC
   		  AND SBP.OID_SUBP = TPSP.SUBP_OID_SUBP
   		  AND TCA.OID_TIPO_CARG_ABON = TPSP.TCAB_OID_TCAB
   		AND SBP.IND_CARG_DIRE = 1  				
   		  AND SBP.IND_DIGI = 1			
   		ORDER BY 2,1 ASC
	</select>               
	
	<!-- OBTIENE LOS TIPOS DE ABONOS DIRECTOS DIGITABLES-->
	<select id="getTiposAbonosDirectosDigitables" parameterClass="java.util.Map" resultMap="baseResultCCC">
    	SELECT  
    		TPSP.OID_TIPO_ABON_SUBP AS CODIGO,
   			PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TCA.OID_TIPO_CARG_ABON,'CCC_TIPO_CARGO_ABONO') AS DESCRIPCION
  		FROM CCC_PROCE            PRO,
       		 CCC_SUBPR            SBP,
       	     CCC_TIPO_ABONO_SUBPR TPSP,
       	     CCC_TIPO_CARGO_ABONO TCA
 	    WHERE PRO.OID_PROC = SBP.CCPR_OID_PROC
   		AND SBP.OID_SUBP = TPSP.SUBP_OID_SUBP
   		AND TCA.OID_TIPO_CARG_ABON = TPSP.TCAB_OID_TCAB
   		AND SBP.IND_ABON_DIRE = 1   		 		 		
   		AND SBP.IND_DIGI = 1   		 		 		
   		ORDER BY 2,1 ASC
	</select>               
	
	<!-- OBTIENE LOS TIPOS DE ORIGEN DE LOS LOTES BANCARIOS-->
	<select id="getTipoOrigenLotesBancarios" parameterClass="java.util.Map" resultMap="baseResultCCC">
    	SELECT  
   		 OLB.COD_TIPO_ORIG AS CODIGO,
   	     OLB.DES_TIPO_ORIG AS DESCRIPCION
	    FROM CCC_TIPOS_ORIGE_LOTES_BANCA OLB
		WHERE OLB.IND_ACTI = 1
		ORDER BY 1 ASC
	</select>       
	
	<!-- OBTIENE LOS TIPOS DE BLOQUEOS-->
	<select id="getTiposBloqueo" parameterClass="java.util.Map" resultMap="baseResultCCC">
    	SELECT MTB.COD_TIPO_BLOQ AS CODIGO, 
    		   GEN.VAL_I18N 	 AS DESCRIPCION
  	    FROM MAE_TIPO_BLOQU MTB, GEN_I18N_SICC_COMUN GEN
 		WHERE MTB.OID_TIPO_BLOQ = GEN.VAL_OID
   		AND GEN.ATTR_ENTI LIKE 'MAE_TIPO_BLOQU'           
	</select>      
	
    <!-- OBTIENE EL SALDO TOTAL DE LA CONSULTORA -->
    <select id="getSaldoUnico" parameterClass="java.util.Map" resultClass="string">
		SELECT CCC_PKG_GENER.CCC_FN_OBTIE_SALDO_UNICO(#oidCliente#)
		FROM DUAL
 	</select>    
 	
 	<!-- OBTIENE EL SALDO VENCIDO DE LA CONSULTORA -->
    <select id="getSaldoVencido" parameterClass="java.util.Map" resultClass="string">
		SELECT CCC_PKG_GENER.CCC_FN_OBTIE_SALDO_VENCI(#oidCliente#)
		FROM DUAL
 	</select>
 	
 	<!-- VALIDA SI EXISTE UN CUPON 3 -->
    <select id="getExisteCupon" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT CCC_PKG_GENER.CCC_FN_VALID_EXIST_CUPON(#codigoCliente#,#fechaPago#,#importePago#)
		FROM DUAL
 	</select>    
 	
 	
 	<!-- OBTIENE EL SALDO HISTORICO TOTAL DE LA CONSULTORA -->
    <select id="getSaldoHistoricoTotal" parameterClass="java.util.Map" resultClass="string">
		SELECT CCC_PKG_GENER.CCC_FN_OBTIE_SALDO_TOTAL_HISTO(#oidCliente#)
		FROM DUAL
 	</select>  
 	
	<select id="getTipoCADDocumentoLegalList" parameterClass="java.util.Map" resultMap="baseResultCCC">
		SELECT 
   		   PTS.COD_TIPO_SOLI AS CODIGO, 
   		   GEN.VAL_I18N AS DESCRIPCION
	    FROM             
   		   CCC_TIPOS_SOLIC_DOCUM_LEGAL CC,          
   		   PED_TIPO_SOLIC PTS,
   		   GEN_I18N_SICC_COMUN GEN
	    WHERE CC.COD_TIPO_SOLI = PTS.COD_TIPO_SOLI
     	  AND GEN.ATTR_ENTI LIKE 'PED_TIPO_SOLIC'
    	  AND GEN.VAL_OID = PTS.OID_TIPO_SOLI
	</select>
	 	        		
    <!-- OBTIENE LOS TIPOS DE BLOQUEOS-->
	<select id="getDetalleCargaLoteBancario" parameterClass="java.util.Map" resultMap="detalleCargaLoteBancarioResult">
	   SELECT MB.NUM_LOTE           		LOTE,
       		CCB.DES_CC            		    BANCO,
       		MB.FEC_PAGO_MINI      			FECHAPAGOMIN,
       		MB.FEC_PAGO_MAXI      			FECHAPAGOMAX,
       		MB.VAL_CANT_REGI_TOTA 			CANT,
       		MB.VAL_IMPO_REGI_TOTA 			IMP,
       		MB.VAL_CANT_REGI_OK   			CANT_OK,
       		MB.VAL_IMPO_REGI_OK   			IMP_OK,
       		MB.VAL_CANT_REGI_ERRO 			CANT_ERRO,
       		MB.VAL_IMPO_REGI_ERRO 			IMP_ERRO
  		FROM CCC_NUMER_LOTE_BANCA_RECEP MB, 
  		     CCC_CUENT_CORRI_BANCA CCB
 		WHERE MB.COD_CUEN_CORR_BANC = CCB.COD_CC
   		AND MB.NUM_LOTE = #numeroLote#	
	</select>    		
	
	<select id="getTiposLoteBancarioList" parameterClass="java.util.Map" resultMap="baseResultCCC">
	    SELECT 
	       TL.COD_TIPO CODIGO, 
	       TL.VAL_DESC DESCRIPCION
        FROM CCC_TIPOS_LOTE_BANCA TL
 	    WHERE TL.IND_ACTI = 1     	   
	</select>
	
	<select id="getEstadosLoteBancarioList" parameterClass="java.util.Map" resultMap="baseResultCCC">
	    SELECT 
	       EL.COD_ESTA CODIGO, 
	       EL.VAL_DESC DESCRIPCION
        FROM CCC_ESTAD_LOTE_BANCA EL
 	    WHERE EL.IND_ACTI = 1    	   
	</select>
	
	<select id="getEstadosPagoBancarioList" parameterClass="java.util.Map" resultMap="baseResultCCC">
	    SELECT 
	       EP.COD_ESTA CODIGO, 
	       EP.VAL_DESC DESCRIPCION
        FROM CCC_ESTAD_PAGO_BANCA EP
 	    WHERE EP.IND_ACTI = 1   	   
	</select>
	
	<select id="getTiposErrorPagoBancarioList" parameterClass="java.util.Map" resultMap="baseResultCCC">
	 SELECT 
	  TEB.COD_ERRO CODIGO, 
 	  TEB.VAL_DESC DESCRIPCION
     FROM CCC_TIPOS_ERROR_BANCA TEB
	</select>
	
	<resultMap id="detalleLotesBancariosResult"          class="java.util.HashMap">
    	<result property="numeroLote" 						column="LOTE"/>
    	<result property="descripcionTipoOrigen" 			column="DES_TIPO_ORIG"/>
		<result property="descripcionBanco" 			    column="BANCO"/>
		<result property="codigoEstadoLote" 				column="COD_ESTA_LOTE"/>
		<result property="descripcionEstadoLote" 			column="DES_ESTA_LOTE"/>
		<result property="fechaProceso" 					column="FECHAPROC"/>
		<result property="fechaPagoMinimo"  				column="FECHAPAGOMIN"/>
		<result property="fechaPagoMaximo"  				column="FECHAPAGOMAX"/>
		<result property="cantidadTotal"    				column="CANT"/>
		<result property="importeTotal"     				column="IMP"/>
		<result property="cantidadOk"   					column="CANT_OK"/>
		<result property="importeOk"   						column="IMP_OK"/>
		<result property="cantidadError" 					column="CANT_ERRO"/>
		<result property="importeError"   					column="IMP_ERRO"/>
    </resultMap>
    
	<!-- OBTIENE LOS TIPOS DE BLOQUEOS-->
	<select id="getLotesBancariosbyFilter" parameterClass="java.util.Map" resultMap="detalleLotesBancariosResult">
	   SELECT 
        MB.NUM_LOTE           LOTE,
        TOL.DES_TIPO_ORIG  DES_TIPO_ORIG,
        CCB.DES_CC            BANCO,
        ELB.COD_ESTA      COD_ESTA_LOTE,
        ELB.VAL_DESC        DES_ESTA_LOTE,   
        TRUNC(MB.FEC_PROC)           FECHAPROC,
        TRUNC(MB.FEC_PAGO_MINI)      FECHAPAGOMIN,
        TRUNC(MB.FEC_PAGO_MAXI)      FECHAPAGOMAX,
        MB.VAL_CANT_REGI_TOTA CANT,
        MB.VAL_IMPO_REGI_TOTA IMP,
        MB.VAL_CANT_REGI_OK   CANT_OK,
      MB.VAL_IMPO_REGI_OK   IMP_OK,
          MB.VAL_CANT_REGI_ERRO CANT_ERRO,
           MB.VAL_IMPO_REGI_ERRO IMP_ERRO
      FROM CCC_NUMER_LOTE_BANCA_RECEP MB, 
           CCC_CUENT_CORRI_BANCA CCB,
           CCC_ESTAD_LOTE_BANCA  ELB,
           CCC_TIPOS_ORIGE_LOTES_BANCA TOL
     WHERE MB.COD_CUEN_CORR_BANC = CCB.COD_CC
       AND MB.COD_IDEN_PROC = ELB.COD_ESTA
       AND TOL.COD_TIPO_ORIG = MB.COD_TIPO_ORIG 
       AND CCB.COD_CC = DECODE(#codigoCuentaCorriente#,NULL,CCB.COD_CC,'Todos',CCB.COD_CC,#codigoCuentaCorriente#)
       AND TRUNC(MB.FEC_PROC) = DECODE(TO_DATE(#fechaProceso#,'DD/MM/YYYY'),NULL,TRUNC(MB.FEC_PROC),TO_DATE(#fechaProceso#,'DD/MM/YYYY'))
   		  AND MB.NUM_LOTE = DECODE(#numeroLote#,NULL,MB.NUM_LOTE,#numeroLote#)
   		  AND MB.COD_IDEN_PROC = DECODE(#estadoLote#, NULL,MB.COD_IDEN_PROC,'Todos',MB.COD_IDEN_PROC,#estadoLote#)
	</select>    		
	
	        				
	<!-- OBTIENE EL DIRECTORIO DEL SERVIDOR -->
	<select id="getPathUpload" parameterClass="java.util.Map" resultClass="string">
	  SELECT ccc_pkg_gener.CCC_FN_OBTIE_PARAM_GENER('DirectorioTemporalCargasMasivas')
      FROM dual           
	</select>
			
	<!-- OBTIENE EL VALOR DEL PARAMETRO -->
	<select id="getIndicadorParametro" parameterClass="java.util.Map" resultClass="string">
	  SELECT ccc_pkg_gener.CCC_FN_OBTIE_PARAM_GENER(#indicadorParametro#)
      FROM dual           
	</select>
			
	<!-- OBTIENE EL DIRECTORIO DEL SERVIDOR -->
	<select id="getPathUploadCADDocumentoLegalMasivos" parameterClass="java.util.Map" resultClass="string">
       SELECT CAD_DOCL_DIRE_TEMP
       FROM CCC_PAIS_SOCIE_PARAM
       WHERE COD_PAIS = #codigoPais# 
       AND COD_SOCI = #codigoSociedad#  
	</select>
	
	<!-- OBTIENE EL DIRECTORIO DEL SERVIDOR -->
	<select id="getPathUploadBloqueoFinancieroMasivo" parameterClass="java.util.Map" resultClass="string">
       SELECT VAL_PARA
       FROM CCC_PARAM_GENER
       WHERE COD_PARA = 'PathUpload'
	</select>
			
	<!-- OBTIENE LOS PAGOS BANCARIOS A REGULARIZAR SEGUN FILTRO-->
	<select id="getPagosBancariosPorRegularizarByFilter" parameterClass="java.util.Map" resultMap="regularizacionPagoBancarioMantenimientoResult">
	   SELECT 
	   	      MB.OID_MOVI_BANC OID,
        CCB.COD_CC COD_BANC,
        CCB.DES_CC DES_BANC,
        TEB.VAL_DESC DES_ERRO,
	   	      MB.COD_CONS, 
        MB.NUM_DOCU_IDEN,
        MB.FEC_PROC,
	   	      MB.FEC_PAGO, 
	   	      MB.IMP_PAGO
  	   FROM 
  	   		CCC_MOVIM_BANCA       MB,
       		CCC_CUENT_CORRI_BANCA CCB,
        CCC_TIPOS_ERROR_BANCA TEB
       WHERE MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
   	 	 AND MB.COD_ERRO = TEB.COD_ERRO
   		 AND MB.COD_IDEN_PROC = 'I'   	
   		 AND MB.IND_PAGO_REGU = 0
   		 AND MB.ind_elim = 0   		      		 		    		 
   		 AND CCB.COD_CC = DECODE(#codigoCuentaCorrienteBancaria#,NULL,CCB.COD_CC,'Todos',CCB.COD_CC,#codigoCuentaCorrienteBancaria#)
   		 AND MB.COD_ERRO = DECODE(#codigoError#,NULL,MB.COD_ERRO,#codigoError#)
   		 AND MB.IMP_PAGO >= DECODE(#importePagoDesde#,NULL,MB.IMP_PAGO,#importePagoDesde#)		    		     		    		    		 
   		 AND MB.FEC_PAGO >= DECODE(TO_DATE(#fechaPagoDesde#,'DD/MM/YYYY'),NULL,MB.FEC_PAGO,TO_DATE(#fechaPagoDesde#,'DD/MM/YYYY'))   		    		 
   		 AND MB.FEC_PROC >= DECODE(TO_DATE(#fechaProcesoDesde#,'DD/MM/YYYY'),NULL,MB.FEC_PROC,TO_DATE(#fechaProcesoDesde#,'DD/MM/YYYY'))   		    		 
   		 <![CDATA[
   		         AND MB.IMP_PAGO <= DECODE(#importePagoHasta#,NULL,MB.IMP_PAGO,#importePagoHasta#)    	  		   
        	     AND MB.FEC_PAGO <= DECODE(TO_DATE(#fechaPagoHasta#,'DD/MM/YYYY'),NULL,MB.FEC_PAGO,TO_DATE(#fechaPagoHasta#,'DD/MM/YYYY'))        	     		   
        	     AND MB.FEC_PROC <= DECODE(TO_DATE(#fechaProcesoHasta#,'DD/MM/YYYY'),NULL,MB.FEC_PROC,TO_DATE(#fechaProcesoHasta#,'DD/MM/YYYY'))
		]]>	   		 
		   		    		   	   		 
	</select>      
	
	<!-- OBTIENE LOS PAGOS BANCARIOS A REGULARIZAR SEGUN FILTRO-->
	<select id="getRegularizacionPagoBancarioById" parameterClass="regularizacionPagoBancario" resultMap="regularizacionPagoBancarioMantenimiento">	
	   SELECT 
	         MB.OID_MOVI_BANC OID,  
	   	     SP.COD_PAIS,
	   	     SS.COD_SOCI,
	   	     CB.COD_BANC, 
	   	     CCB.DES_CC, 
	   	     MB.COD_CONS, 
	   	     MB.FEC_PAGO, 
	   	     MB.IMP_PAGO
  	   FROM 
  	   		CCC_MOVIM_BANCA       MB,
       		CCC_CUENT_CORRI_BANCA CCB,
       		CCC_SUCUR             CS,
       		CCC_BANCO             CB,
       		SEG_PAIS              SP,
       		SEG_SOCIE             SS
 	   WHERE MB.PAIS_OID_PAIS = SP.OID_PAIS
   		 AND SP.OID_PAIS = SS.PAIS_OID_PAIS
   		 AND MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
   		 AND CCB.SUCU_OID_SUCU = CS.OID_SUCU
   		 AND CS.CBAN_OID_BANC = CB.OID_BANC 
   		 AND SP.COD_PAIS = #codigoPais# 
   		 AND SS.COD_SOCI = #codigoSociedad#  		    		 
   		 AND MB.OID_MOVI_BANC = #oidMovimientoBancario#	
	</select>
			
	<!-- OBTIENE LOS PAGOS BANCARIOS A GESTIOAR SEGUN FILTRO-->
  <select id="getPagosBancariosPorGestionarByFilter" parameterClass="java.util.Map" resultMap="gestionarErrorPagoBancarioMantenimientoResult">
     SELECT 
      MB.OID_MOVI_BANC OID,  
      CCB.DES_CC, 
      MB.COD_CONS, 
      MB.FEC_PROC,
      MB.FEC_PAGO, 
      MB.IMP_PAGO,
      GEN.VAL_I18N DES_ERRO
     FROM 
      CCC_MOVIM_BANCA       MB,
      CCC_CUENT_CORRI_BANCA CCB,
      CCC_TIPO_ERROR CTE,
      GEN_I18N_SICC_COMUN GEN
     WHERE MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
       AND MB.TIER_OID_ERRO = CTE.OID_ERRO 
       AND MB.COD_IDEN_PROC = 'I'     
       AND CTE.OID_ERRO = GEN.VAL_OID
       AND GEN.ATTR_ENTI = 'CCC_TIPO_ERROR'                                  
        AND CCB.COD_CC = DECODE(#codigoCuentaCorrienteBancaria#,NULL,CCB.COD_CC,'Todos',CCB.COD_CC,#codigoCuentaCorrienteBancaria#)                                      
        AND CTE.COD_ERRO = DECODE(#codigoError#,NULL,CTE.COD_ERRO,'Todos',CTE.COD_ERRO,#codigoError#)
        AND MB.FEC_PROC >= DECODE(TO_DATE(#fechaProcesoDesde#,'DD/MM/YYYY'),NULL,MB.FEC_PAGO,TO_DATE(#fechaProcesoDesde#,'DD/MM/YYYY'))                
        <![CDATA[
               AND MB.FEC_PROC <= DECODE(TO_DATE(#fechaProcesoHasta#,'DD/MM/YYYY'),NULL,MB.FEC_PROC,TO_DATE(#fechaProcesoHasta#,'DD/MM/YYYY'))                      
        ]]>                                          
    </select>   
  	
  	<!-- OBTIENE EL PAGO BANCARIOS A GESTIONAR  SEGUN FILTRO-->
	<select id="getErrorPagoBancarioById" parameterClass="string"  resultMap="errorPagoBancarioMantenimiento">	
	   SELECT 
	         MB.OID_MOVI_BANC OID,  	   	     	   	     
	   	     CCB.DES_CC, 
	   	     MB.COD_CONS,
	   	     TO_CHAR(MB.FEC_PROC,'DD/MM/YYYY') FEC_PROC, 
	   	     TO_CHAR(MB.FEC_PAGO,'DD/MM/YYYY') FEC_PAGO,
	   	     MB.IMP_PAGO,
	   	     GEN.VAL_I18N DES_ERRO
  	   FROM 
  	   		CCC_MOVIM_BANCA       MB,
       		CCC_CUENT_CORRI_BANCA CCB,
       		CCC_TIPO_ERROR CTE,
       		GEN_I18N_SICC_COMUN GEN       		
 	   WHERE MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
 	     AND MB.TIER_OID_ERRO = CTE.OID_ERRO
 	     AND CTE.OID_ERRO = GEN.VAL_OID
         AND GEN.ATTR_ENTI = 'CCC_TIPO_ERROR'   		    		   		    	
   		 AND MB.OID_MOVI_BANC = #oidMovimientoBancario#	
	</select>
 	
		
	<!-- Devuelve Lista de detalle de cuenta corriente historica de un cliente -->
	<select id="getCuentaCorrienteHistoricaConsultoraList" parameterClass="java.util.Map" resultMap="cuentaCorrienteHistoricaConsultoraResult">
        SELECT   
              TO_CHAR(FEC_EMIS,'dd/MM/yyyy') FEC_EMIS_DOCU,
         NVL (TO_CHAR (CAM_REFE), ' ') CAM_REFE,
         TIP_MOVI,
		    DES_MOVI,
         OID_MOVI,
         SOCA_OID_SOLI_CABE,
         NUM_DOCU,
         NVL (TO_CHAR (FEC_VENC, 'dd/MM/yyyy'), ' ') FEC_VENC,
         NVL (TO_CHAR (FEC_PAGO, 'dd/MM/yyyy'), ' ') FEC_PAGO,
         IMP_CARG,
         IMP_ABON
    FROM (    select   null fec_emis,     
                   '' CAM_REFE,
                   '' TIP_MOVI,
                   'Abono en proceso CDR' DES_MOVI,
                   null OID_MOVI,
                   null SOCA_OID_SOLI_CABE,
                   null NUM_DOCU,
                   null FEC_VENC,
                   null  FEC_PAGO,
                   null IMP_CARG,
                   val_recl_pend IMP_ABON
             from mae_clien
            where cod_clie =  #codigoConsultora#
             <![CDATA[ 
            and nvl(val_recl_pend,0) <> 0
            ]]>
            union
               SELECT FEC_EMIS, CAM_REFE, TIP_MOVI, DES_MOVI, OID_MOVI,SOCA_OID_SOLI_CABE,NUM_DOCU, FEC_VENC, FEC_PAGO, SUM(IMP_CARG) IMP_CARG, SUM(IMP_ABON) IMP_ABON 
       FROM ((    
          SELECT       MCC.FEC_DOCU FEC_EMIS,
                 SPC.COD_PERI CAM_REFE,
                 CASE
                            <![CDATA[ 
                                WHEN MCC.TCAB_OID_TCAB_CREA = 2001 AND MCC.IMP_MOVI > 0 THEN 'P'
                            ]]>
                            <![CDATA[ 
                                WHEN MCC.TCAB_OID_TCAB_CREA = 2001 AND MCC.IMP_MOVI < 0 THEN 'R'
                            ]]>
                                ELSE 'D'
                         END TIP_MOVI,                 
                         CASE
                    WHEN MCC.TCAB_OID_TCAB_CREA = 2001
                       THEN CASE
                              WHEN EXISTS (
                                     SELECT OID_SOLI_CABE
                                       FROM PED_SOLIC_CABEC P,
                                            PED_TIPO_SOLIC_PAIS TP,
                                            PED_TIPO_SOLIC T
                                      WHERE P.SOCA_OID_SOLI_CABE =
                                                        MCC.SOCA_OID_SOLI_CABE
                                        AND P.TSPA_OID_TIPO_SOLI_PAIS =
                                                         TP.OID_TIPO_SOLI_PAIS
                                        AND TP.TSOL_OID_TIPO_SOLI =
                                                               T.OID_TIPO_SOLI
                                        AND P.IND_OC = 1
                                        AND T.IND_SOLI_NEGA = 0)
                                 THEN 'Pedido'
                              ELSE CASE
                                    <![CDATA[ 
                              WHEN MCC.IMP_MOVI > 0
                                    ]]>
                                 THEN 
                                             decode(MCC.SOCA_OID_SOLI_CABE,null,'AtenciÃ³n de Servicio', rec_pkg_proce.REC_FN_SOLIC_PEDID_HIPER(MCC.SOCA_OID_SOLI_CABE)
                                         )
                              ELSE NVL
                                     ((SELECT    'C'
                                              || PERIOCORPO.COD_PERI
                                              || ' '
                                              || OPERA.VAL_DESC_LARG
                                              || ' NRO.'
                                              || CABECRECLA.NUM_RECL
                                                                   AS DESCRIP
                                         FROM PED_SOLIC_CABEC CONS,
                                              PED_SOLIC_CABEC SOLICRECLA,
                                              PED_SOLIC_CABEC SOLICORIGEN,
                                              REC_SOLIC_OPERA SOLICOPERA,
                                              REC_OPERA_RECLA OPERARECLA,
                                              REC_CABEC_RECLA CABECRECLA,
                                              REC_TIPOS_OPERA TIPOSOPERA,
                                              REC_OPERA OPERA,
                                              CRA_PERIO PERIO,
                                              SEG_PERIO_CORPO PERIOCORPO
                                        WHERE CONS.OID_SOLI_CABE =
                                                        MCC.SOCA_OID_SOLI_CABE
                                          AND CONS.OID_SOLI_CABE =
                                                 SOLICRECLA.SOCA_OID_SOLI_CABE
                                          AND SOLICRECLA.SOCA_OID_DOCU_REFE IS NOT NULL
                                          AND SOLICRECLA.OID_SOLI_CABE =
                                                 SOLICOPERA.SOCA_OID_SOLI_CABE
                                          AND SOLICOPERA.OPRE_OID_OPER_RECL =
                                                      OPERARECLA.OID_OPER_RECL
                                          AND OPERARECLA.CARE_OID_CABE_RECL =
                                                      CABECRECLA.OID_CABE_RECL
                                          AND OPERARECLA.TIOP_OID_TIPO_OPER =
                                                      TIPOSOPERA.OID_TIPO_OPER
                                          AND TIPOSOPERA.ROPE_OID_OPER =
                                                                OPERA.OID_OPER
                                          AND SOLICRECLA.SOCA_OID_DOCU_REFE =
                                                     SOLICORIGEN.OID_SOLI_CABE
                                          AND SOLICORIGEN.PERD_OID_PERI =
                                                                PERIO.OID_PERI
                                          AND PERIO.PERI_OID_PERI =
                                                           PERIOCORPO.OID_PERI
                                          AND ROWNUM = 1),
                                                decode(MCC.SOCA_OID_SOLI_CABE,null,'CDR', rec_pkg_proce.REC_FN_SOLIC_PEDID_HIPER(MCC.SOCA_OID_SOLI_CABE)
                                        )
                                     )
                           END
                           END
                            ELSE
                                CASE 
                                   WHEN mcc.subp_oid_subp_crea = 203 THEN
                                     (   select decode(flx.val_nume_orde_cuot,2,'Primera ',3,'Segunda ')||GEN.VAL_I18N ||' de '||flx.cod_peri 
                                           from flx_cuota_flexi_factu_detal flx
                                           where flx.oid_movi_carg_flex = mcc.oid_movi_cc
                                           and flx.oid_peri_cuot_flex = mcc.perd_oid_peri 
                                           and flx.oid_clie = mcc.clie_oid_clie                    
                                      )
                                    WHEN mcc.subp_oid_subp_crea = 204 THEN
                                		'Cargo por Uso Flexipago'
                                   ELSE
                                      GEN.VAL_I18N 
                                END                             
                         END DES_MOVI,
                         MCC.OID_MOVI_CC OID_MOVI,  
                 MCC.SOCA_OID_SOLI_CABE SOCA_OID_SOLI_CABE,
                 MCC.NUM_IDEN_CUOT NUM_DOCU,
                 MCC.FEC_VENC FEC_VENC,
                 NULL FEC_PAGO,
                 CASE
                            <![CDATA[ 
                    WHEN (MCC.IMP_MOVI > 0)
                            ]]>
                       THEN MCC.IMP_MOVI
                    ELSE NULL
                 END IMP_CARG,
                 CASE
                            <![CDATA[ 
                    WHEN (MCC.IMP_MOVI > 0)
                            ]]>
                       THEN NULL
                    ELSE ABS (MCC.IMP_MOVI)
                 END IMP_ABON
            FROM CCC_MOVIM_CUENT_HISTO MCC,
                 CCC_SUBPR CS,
                 CCC_TIPO_ABONO_SUBPR TAS,
                 CCC_TIPO_CARGO_ABONO TCA,
                 GEN_I18N_SICC_PAIS GEN,
                 CRA_PERIO CP,
                 SEG_PERIO_CORPO SPC
           WHERE MCC.SUBP_OID_SUBP_CREA = CS.OID_SUBP
             AND CS.OID_SUBP = TAS.SUBP_OID_SUBP
             AND TAS.TCAB_OID_TCAB = TCA.OID_TIPO_CARG_ABON
             AND GEN.ATTR_ENTI LIKE 'CCC_TIPO_CARGO_ABONO'
             AND GEN.VAL_OID = TCA.OID_TIPO_CARG_ABON
             AND MCC.PERD_OID_PERI = CP.OID_PERI
             AND CP.PERI_OID_PERI = SPC.OID_PERI
             AND MCC.CLIE_OID_CLIE = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoConsultora#))
          UNION ALL
          (SELECT MB.FEC_PROC FEC_EMIS,
                 NULL OID_PERI,
                         'B'        TIP_MOVI,  
                         CCB.DES_CC DES_MOVI,
                         MB.OID_MOVI_BANC OID_MOVI,
                 MB.OID_MOVI_BANC SOCA_OID_SOLI_CABE,
                 MB.NUM_LOTE NUM_DOCU,
                 NULL FEC_VENC,
                 MB.FEC_PAGO FEC_PAGO,
                 NULL IMP_CARG,
                 MB.IMP_PAGO IMP_ABON
            FROM CCC_MOVIM_BANCA_HISTO MB,
                 CCC_CUENT_CORRI_BANCA CCB
           WHERE MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
             AND MB.COD_IDEN_PROC = 'P'
             AND CCB.IND_BANC_CHEQ = 0
             AND MB.CLIE_OID_CLIE = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoConsultora#))
          UNION ALL
          (SELECT MB.FEC_PROC FEC_EMIS,
                 NULL OID_PERI,
                         'CH'  TIP_MOVI,
                         CCB.DES_CC || ' ' || bc.des_banc DES_MOVI ,
                         MB.OID_MOVI_BANC OID_MOVI,
                 MB.OID_MOVI_BANC SOCA_OID_SOLI_CABE,
                 MB.NUM_LOTE NUM_DOCU,
                 MB.FEC_COBR_CHEQ FEC_VENC,
                 MB.FEC_PAGO FEC_PAGO,
                 NULL IMP_CARG,
                 MB.IMP_PAGO IMP_ABON
            FROM CCC_MOVIM_BANCA_HISTO MB,
                 CCC_CUENT_CORRI_BANCA CCB,
                 CCC_BANCO_CHEQU BC                
              WHERE MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
             AND MB.COD_IDEN_PROC = 'P'
             AND CCB.IND_BANC_CHEQ = 1
             AND MB.COD_BANC_CHEQ = BC.COD_BANC         
             AND MB.CLIE_OID_CLIE = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoConsultora#)))             
                     GROUP BY FEC_EMIS, CAM_REFE, TIP_MOVI, DES_MOVI, OID_MOVI,SOCA_OID_SOLI_CABE,NUM_DOCU, FEC_VENC, FEC_PAGO)
             ORDER BY FEC_EMIS DESC                                                   	           
    </select>
    
	<!-- INSERTA EN TABLA TEMPORAL -->
	<insert id="insertEstructuraCADMasivos" parameterClass="estructuraCADMasivos">
		<![CDATA[
	      	INSERT INTO CCC_CARGA_CARGO_ABONO_MASIV (
	      	   VAL_FILA,
	           COD_CLIE,     
			   IMP_MOVI,
			   IMP_MOVI_VALI,
			   VAL_OBSE,
			   NUM_LOTE,
			   COD_USUA,
			   FEC_PROC)						
	        VALUES ( 
			#fila#,
			TRIM(#codigoConsultora#),
			TRIM(#importeMovimiento#),
			TRIM(#importeMovimientoValidacion#),
			TRIM(#observacion#),
			TRIM(#numeroLote#),
			TRIM(#codigoUsuario#),
			SYSDATE)			
	    ]]>
	</insert>
	
	<!-- INSERTA EN TABLA TEMPORAL CCC_CARGA_CARGO_DOCLE_MASIV -->
	<insert id="insertEstructuraCADDocumentoLegalMasivos" parameterClass="estructuraCADDocumentoLegalMasivos">
		<![CDATA[
	      	INSERT INTO CCC_CARGA_CADIR_DOCLE_MASIV (
	      	   VAL_FILA,
	           COD_CLIE,     
			   IMP_MOVI,
			   IMP_MOVI_VALI,
			   NUM_BOLE_DESP_REFE,
			   COD_UNIC_VENT,
			   NUM_LOTE,
			   COD_USUA,
			   FEC_PROC)						
	        VALUES ( 
			#fila#,
			#codigoConsultora#,
			#importeMovimiento#,
			#importeMovimientoValidacion#,
			#numeroBoletaDespachoReferencia#,
			#codigoProducto#,
			#numeroLote#,
			#codigoUsuario#,
			SYSDATE			
	        )
	    ]]>
	</insert>
	
	<!-- INSERTA EN TABLA TEMPORAL -->
	<insert id="insertEstructuraChequesDigitados" parameterClass="estructuraChequesDigitados">
		<![CDATA[
	      	INSERT INTO ccc_carga_digit_chequ_banca (
	      	    NUM_LOTE,
 				COD_BANC,  				
  				COD_CLIE,    			
  				FEC_COBR,
  				IMP_CHEQ,
  				USU_CREA,
  				FEC_CREA)						
	        VALUES ( 			
	        TRIM(#numeroLote#),
	        TRIM(#codigoBanco#),	        
			TRIM(#codigoConsultora#),
			TRIM(TO_DATE(#fechaCobro#,'DD/MM/YYYY')),
			TRIM(#importeCheque#),			
			TRIM(#codigoUsuario#),
			SYSDATE)			
	    ]]>
	</insert>
	
		<!-- INSERTA EN TABLA TEMPORAL -->
	<insert id="insertarPagoBancarioExterno" parameterClass="pagoBancarioExterno">
		<![CDATA[
	      	INSERT INTO ccc_carga_digit_pagos_exter (
	      	    NUM_LOTE,
 				COD_BANC,  				
  				COD_CLIE,    			
  				FEC_PAGO,  				
  				IMP_PAGO)					
	        VALUES ( 			
	        TRIM(#numeroLote#),
	        TRIM(#codigoBanco#),	        
			TRIM(#codigoConsultora#),
			TO_DATE(#fechaPago#,'DD/MM/YYYY'),			
			TRIM(#importePago#))			
	    ]]>
	</insert>
	
	<!-- INSERTA EN TABLA TEMPORAL CCC_CARGA_BLOQUEO_FINAN_MASIV -->
	<insert id="insertEstructuraBloqueoFinancieroMasivo" parameterClass="estructuraBloqueoFinancieroMasivo">
		<![CDATA[
	      	INSERT INTO CCC_CARGA_BLOQU_FINAN_MASIV (
	      	   VAL_FILA,
	           COD_CLIE,     			   
			   NUM_LOTE,
			   COD_TIPO_ACCI,
  			   COD_TIPO_BLOQ,
  			   VAL_MOTI_BLOQ,
			   COD_USUA,
			   FEC_PROC)						
	        VALUES ( 
			#fila#,
			#codigoConsultora#,			
			#numeroLote#,
			#codigoTipoAccion#,
			#codigoTipoBloqueo#,
			#valorMotivoBloqueo#,
			#codigoUsuario#,
			SYSDATE			
	        )
	    ]]>
	</insert>
	
	<!-- OBTIENE EL LISTADO DE ERRORES -->
	<select id="getErroresCargaCargosAbonosMasivos" parameterClass="java.util.Map" resultMap="ErrorCargaCargosAbonosMasivos">		   
	SELECT VAL_FILA as "VAL_FILA",
          COD_ERRO as "COD_ERRO",
          DES_ERRO as "DES_ERRO"
     FROM CCC_ERROR_CARGO_ABONO_MASIV
     WHERE NUM_LOTE=#numeroLote#
     ORDER BY VAL_FILA ASC , COD_ERRO ASC
	</select>
	
	<!-- OBTIENE EL LISTADO DE ERRORES -->
	<select id="getErroresCargaCADDocumentoLegalMasivos" parameterClass="java.util.Map" resultMap="ErrorCargaCADDocumentoLegalMasivos">		   
	SELECT VAL_FILA as "VAL_FILA",
          COD_ERRO as "COD_ERRO",
          DES_ERRO as "DES_ERRO"
     FROM CCC_ERROR_CADIR_DOCLE_MASIV
     WHERE NUM_LOTE=#numeroLote#
     ORDER BY VAL_FILA ASC , COD_ERRO ASC
	</select>
	
	<!-- OBTIENE EL LISTADO DE ERRORES -->
	<select id="getErroresBloqueoFinancieroMasivo" parameterClass="java.util.Map" resultMap="ErrorBloqueoFinancieroMasivo">		   
	SELECT VAL_FILA as "VAL_FILA",
          COD_ERRO as "COD_ERRO",
          DES_ERRO as "DES_ERRO"
     FROM CCC_ERROR_BLOQU_FINAN_MASIV
     WHERE NUM_LOTE=#numeroLote#
     ORDER BY VAL_FILA ASC , COD_ERRO ASC
	</select>
	
	<parameterMap id="paramExecuteObtenerNumeroLote" class="java.util.Map" >
		<parameter property="numeroLote"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	</parameterMap>
		
	 <procedure id="executeObtenerNumeroLote" parameterMap="paramExecuteObtenerNumeroLote" >	     
         {call INT_PKG_CCC.CCC_PR_OBTIE_NUMER_LOTE(?)}
	 </procedure>          
	
	<parameterMap id="paramInsertCargoAbonoDirectoDigitado" class="java.util.Map" >
        <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="tipoCAD"    				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoConsultora"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="fechaVencimiento"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="observaciones"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="importeCAD"             	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>        
        <parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
   <procedure id="insertCargoAbonoDirectoDigitado" parameterMap="paramInsertCargoAbonoDirectoDigitado" >
		{call CCC_PKG_PROCE.CCC_PR_GENER_CARGO_ABONO_MANUA(?,?,?,?,?,?,?)}
    </procedure>          
	
    <parameterMap id="paramExecuteRegularizacionPagoBancario" class="java.util.Map" >
    	<parameter property="numeroLoteBancario"       	  		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="oidMovimientoBancario"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroConsecutivoTransaccion"  	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		       
		<parameter property="codigoConsultora"            		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="importePagoDetalle"           		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeRegularizacionPagoBancario" parameterMap="paramExecuteRegularizacionPagoBancario" >
         {call CCC_PKG_PROCE.CCC_PR_REGUL_PAGO_BANCA(?,?,?,?,?)}
	</procedure>      
	
	<parameterMap id="paramExecuteEliminarPagoBancarioPorRegularizar" class="java.util.Map" >    	
		<parameter property="oidMovimientoBancario"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"            			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>
    
    <procedure id="executeEliminarPagoBancarioPorRegularizar" parameterMap="paramExecuteEliminarPagoBancarioPorRegularizar" >
         {call CCC_PKG_PROCE.CCC_PR_ELIMI_REGUL_PAGO_BANCA(?,?)}
	</procedure>     
	
	<parameterMap id="paramExecuteArchivarPagoBancarioPorRegularizar" class="java.util.Map" >    	
		<parameter property="oidMovimientoBancario"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"            			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>
    
    <procedure id="executeArchivarPagoBancarioPorRegularizar" parameterMap="paramExecuteArchivarPagoBancarioPorRegularizar" >
         {call CCC_PKG_PROCE.CCC_PR_ARCHI_REGUL_PAGO_BANCA(?,?)}
	</procedure>
	
	<parameterMap id="paramExecuteGestionaErrorPagoBancario" class="java.util.Map" >    	
		<parameter property="oidMovimientoBancario"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>				       
		<parameter property="codigoConsultora"            		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaPago"            		        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="importePago"            		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"            		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeGestionarErrorPagoBancario" parameterMap="paramExecuteGestionaErrorPagoBancario" >
         {call CCC_PKG_PROCE.CCC_PR_GESTI_ERROR_PAGO_BANCA(?,?,?,?,?)}
	</procedure>   
	
	<parameterMap id="paramExecuteEliminarErrorPagoBancario" class="java.util.Map" >    	
		<parameter property="oidMovimientoBancario"       		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"            			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>
    
    <procedure id="executeEliminarErrorPagoBancario" parameterMap="paramExecuteEliminarErrorPagoBancario" >
         {call CCC_PKG_PROCE.CCC_PR_ELIMI_ERROR_PAGO_BANCA(?,?)}
	</procedure>	
	
	
	<parameterMap id="paramExecuteDeleteTablasCargaCargosAbonosMasivos" class="java.util.Map">		
	    <parameter property="numeroLote"      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />	
	</parameterMap>
		        
	<procedure id="deleteTablasCargaCargosAbonosMasivos" parameterMap="paramExecuteDeleteTablasCargaCargosAbonosMasivos">
		{call CCC_PKG_PROCE.CCC_PR_ELIMI_CARGO_ABONO_MASIV(?)}
	</procedure>
	
	<parameterMap id="paramExecuteValidarCargosAbonosMasivos" class="java.util.Map">	
	    <parameter property="tipoCarga"     				    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	    <parameter property="numeroLote"      		 		 jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	    <parameter property="cantidadRegistrosCargados"      jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	    <parameter property="importeRegistrosCargados"       jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />	
		<parameter property="error"      		     		 jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidarCargosAbonosMasivos" parameterMap="paramExecuteValidarCargosAbonosMasivos">
		{call CCC_PKG_PROCE.CCC_PR_VALID_CARGO_ABONO_MASIV(?,?,?,?,?) }
	</procedure>
	
	<parameterMap id="paramExecuteProcesarCargosAbonosMasivos" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="tipoCAD"    				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                
        <parameter property="fechaVencimiento"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                       
        <parameter property="numeroLote"          	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeProcesarCargosAbonosMasivos" parameterMap="paramExecuteProcesarCargosAbonosMasivos">
		{call CCC_PKG_PROCE.CCC_PR_PROCE_CARGO_ABONO_MASIV(?,?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="paramExecuteDeleteTablasCargaCADDocumentoLegalMasivos" class="java.util.Map">		
		<parameter property="numeroLote"      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
		
	<procedure id="deleteTablasCargaCADDocumentoLegalMasivos" parameterMap="paramExecuteDeleteTablasCargaCADDocumentoLegalMasivos">
		{call CCC_PKG_PROCE.CCC_PR_ELIMI_CADIR_DOCLE_MASIV(?) }
	</procedure>
	
	<parameterMap id="paramExecuteValidarCADDocumentoLegalMasivos" class="java.util.Map">		
	    <parameter property="numeroLote"      			     jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	    <parameter property="cantidadRegistrosCargados"      jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	    <parameter property="importeRegistrosCargados"       jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="error"           		         jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidarCADDocumentoLegalMasivos" parameterMap="paramExecuteValidarCADDocumentoLegalMasivos">
		{call CCC_PKG_PROCE.CCC_PR_VALID_CADIR_DOCLE_MASIV(?,?,?,?)}
	</procedure>
	
	<parameterMap id="paramExecuteProcesarCADDocumentoLegalMasivos" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSociedad"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
        <parameter property="tipoDocumentoLegal"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                                               
        <parameter property="numeroLote"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoModulo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoProceso"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
	<procedure id="executeProcesarCADDocumentoLegalMasivos" parameterMap="paramExecuteProcesarCADDocumentoLegalMasivos">
		{call CCC_PKG_PROCE.CCC_PR_PROCE_CADIR_DOCLE_MASIV(?,?,?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="paramExecuteDeleteTablasBloqueoFinancieroMasivo" class="java.util.Map">		
		<parameter property="numeroLote"      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
		
	<procedure id="deleteTablasBloqueoFinancieroMasivo" parameterMap="paramExecuteDeleteTablasBloqueoFinancieroMasivo">
		{call CCC_PKG_PROCE.CCC_PR_ELIMI_BLOQU_FINAN_MASIV(?) }
	</procedure>
	
	<parameterMap id="paramExecuteValidarBloqueoFinancieroMasivo" class="java.util.Map">		
	    <parameter property="numeroLote"      			     jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	    <parameter property="cantidadRegistrosCargados"      jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />	    
		<parameter property="error"           		         jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidarBloqueoFinancieroMasivo" parameterMap="paramExecuteValidarBloqueoFinancieroMasivo">
		{call CCC_PKG_PROCE.CCC_PR_VALID_BLOQU_FINAN_MASIV(?,?,?)}
	</procedure>
	
	<parameterMap id="paramExecuteProcesarBloqueoFinancieroMasivo" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="tipoAccion"        		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="tipoBloqueo"        		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                                               
        <parameter property="motivoBloqueo"        		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="numeroLote"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoModulo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoProceso"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
	<procedure id="executeProcesarBloqueoFinancieroMasivo" parameterMap="paramExecuteProcesarBloqueoFinancieroMasivo">
		{call CCC_PKG_PROCE.CCC_PR_PROCE_BLOQU_FINAN_MASIV(?,?,?,?,?,?,?,?)}
	</procedure>
			
	<procedure id="deleteTablasCargaPagosBancariosMasivos">
		{call CCC_PKG_PROCE.CCC_PR_ELIMI_PAGOS_BANCA_MASIV }
	</procedure>
	
	<!-- INSERTA EN TABLA TEMPORAL -->
	<insert id="insertEstructuraPagosBancariosMasivos" parameterClass="estructuraPagosBancariosMasivos">
		<![CDATA[
	      	INSERT INTO CCC_CARGA_PAGOS_BANCA_MASIV (
	      	   VAL_FILA,
	           COD_CLIE,
	           FEC_PAGO,     
			   IMP_PAGO)						
	        VALUES ( 
			#fila#,
			#codigoConsultora#,
			#fechaPago#,
			#importePago#			
	        )
	    ]]>
	</insert>
	
	<resultMap id="ErrorCargaPagosBancariosMasivos" class="java.util.HashMap">      
		<result property="fila" 							 column="VAL_FILA" />              
		<result property="codigoError" 						 column="COD_ERRO" />       
		<result property="descripcionError" 				 column="DES_ERRO" />  
   </resultMap>
   
	<!-- OBTIENE EL LISTADO DE ERRORES -->
	<select id="getErroresCargaPagosBancariosMasivos" resultMap="ErrorCargaPagosBancariosMasivos">		   
	SELECT VAL_FILA as "VAL_FILA",
          COD_ERRO  as "COD_ERRO",
          DES_ERRO  as "DES_ERRO"
     FROM CCC_ERROR_PAGOS_BANCA_MASIV
	</select>
	
	<parameterMap id="paramExecuteValidarPagosBancariosMasivos" class="java.util.Map">		
	    <parameter property="tipoCarga"     				    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="cantidadRegistrosCargados"         jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	    <parameter property="importeRegistrosCargados"          jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />		
		<parameter property="error"      jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidarPagosBancariosMasivos" parameterMap="paramExecuteValidarPagosBancariosMasivos">
		{call CCC_PKG_PROCE.CCC_PR_VALID_PAGOS_BANCA_MASIV(?,?,?,?) }
	</procedure>
		
	<parameterMap id="paramExecuteProcesarPagosBancariosMasivos" class="java.util.Map" >
		<parameter property="codigoBanco"     				    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoUsuario"             	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	        
		<parameter property="numeroLote"                	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
    </parameterMap>
    
	<procedure id="executeProcesarPagosBancariosMasivos" parameterMap="paramExecuteProcesarPagosBancariosMasivos">
		{call CCC_PKG_PROCE.CCC_PR_PROCE_PAGOS_BANCO_MASIV(?,?,?)}
	</procedure>
	
	<procedure id="deleteTablasCargaPagosBancariosPorRegularizarMasivos">
		{call CCC_PKG_PROCE.CCC_PR_ELIMI_REGUL_PAGOS_MASIV }
	</procedure>
	
	<!-- INSERTA EN TABLA TEMPORAL -->
	<insert id="insertEstructuraPagosBancariosPorRegularizarMasivos" parameterClass="estructuraPagosBancariosPorRegularizarMasivos">
		<![CDATA[
	      	INSERT INTO CCC_CARGA_REGUL_PAGOS_MASIV (
	      	   VAL_FILA,
	           COD_CLIE,
	           FEC_PAGO,     
			   IMP_PAGO)						
	        VALUES ( 
			#fila#,
			#codigoConsultora#,
			#fechaPago#,
			#importePago#			
	        )
	    ]]>
	</insert>
	
	<resultMap id="ErrorCargaPagosBancariosPorRegularizarMasivos" class="java.util.HashMap">      
		<result property="fila" 							 column="VAL_FILA" />              
		<result property="codigoError" 						 column="COD_ERRO" />       
		<result property="descripcionError" 				 column="DES_ERRO" />  
   </resultMap>
   
	<!-- OBTIENE EL LISTADO DE ERRORES -->
	<select id="getErroresCargaPagosBancariosPorRegularizarMasivos" resultMap="ErrorCargaPagosBancariosPorRegularizarMasivos">		   
	SELECT VAL_FILA as "VAL_FILA",
          COD_ERRO  as "COD_ERRO",
          DES_ERRO  as "DES_ERRO"
     FROM CCC_ERROR_REGUL_PAGOS_MASIV
	</select>
		   	
	<parameterMap id="paramExecuteValidarPagosBancariosPorRegularizarMasivos" class="java.util.Map">
		<parameter property="codigoPais"                			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSociedad"            		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
 		<parameter property="codigoCuentaCorrienteBancaria"     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="error"      							jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidarPagosBancariosPorRegularizarMasivos" parameterMap="paramExecuteValidarPagosBancariosPorRegularizarMasivos">
		{call CCC_PKG_PROCE.CCC_PR_VALID_REGUL_PAGOS_MASIV(?,?,?,?) }
	</procedure>
		
	<parameterMap id="paramExecuteProcesarPagosBancariosPorRegularizarMasivos" class="java.util.Map" >
		<parameter property="codigoPais"                			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSociedad"            			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCuentaCorrienteBancaria"     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"             		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	        
		<parameter property="codigoModulo"              		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoProceso"             			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
	<procedure id="executeProcesarPagosBancariosPorRegularizarMasivos" parameterMap="paramExecuteProcesarPagosBancariosPorRegularizarMasivos">
		{call CCC_PKG_PROCE.CCC_PR_PROCE_REGUL_PAGOS_MASIV(?,?,?,?,?,?)}
	</procedure>
				
	<parameterMap id="paramExecuteLiquidacionLoteBancario" class="java.util.Map" >				
        <parameter property="numeroLote"          		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                       
        <parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeLiquidacionLoteBancario" parameterMap="paramExecuteLiquidacionLoteBancario">
		{call CCC_PKG_PROCE.CCC_PR_LIQUI_LOTE_BANCA(?,?)}
	</procedure>	
	
	<parameterMap id="paramExecuteEliminarLoteBancario" class="java.util.Map" >			
        <parameter property="numeroLote"          		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                       
        <parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                               
    </parameterMap>
	<procedure id="executeEliminarLoteBancario" parameterMap="paramExecuteEliminarLoteBancario">
		{call CCC_PKG_PROCE.CCC_PR_ELIMI_LOTE_BANCA(?,?)}
	</procedure>
				
	<parameterMap id="paramExecuteGenerarPagoBancarioManual" class="java.util.Map" >
       <parameter property="codigoCuentaCorrienteBancaria"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="numeroLote"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="codigoConsultora"                           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="consecutivoTransaccion"                     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>      
       <parameter property="fechaPago"                                  jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="importePago"                                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 
    
    <procedure id="executeGenerarPagoBancarioManual" parameterMap="paramExecuteGenerarPagoBancarioManual"> 
       {call CCC_PKG_PROCE.CCC_PR_GENER_PAGO_BANCA_MANUA(?,?,?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="paramGenerarLoteBancarioExterno" class="java.util.Map" >            
       <parameter property="numeroLote"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>       
       <parameter property="codigoBanco"                                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 
    
    <procedure id="generarLoteBancarioExterno" parameterMap="paramGenerarLoteBancarioExterno"> 
       {call CCC_PKG_PROCE.CCC_PR_GENER_LOTE_BANCA_EXTER(?,?,?)}
	</procedure>
	
	<parameterMap id="paramExecuteGenerarPagoCheque" class="java.util.Map" >
       <parameter property="codigoPais"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="tipoDocumento"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="documentoIdentidad"                         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="codigoConsultora"                           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="tipoCheque"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="fechaCobro"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>      
       <parameter property="banco"                                      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="sucursal"                                   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="importePago"                                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 
    
    <procedure id="executeGenerarPagoCheque" parameterMap="paramExecuteGenerarPagoCheque"> 
       {call CCC_PKG_PROCE.CCC_PR_CCC_GENER_CHEQU_BANCA(?,?,?,?,?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="paramExecuteRegistrarLoteBancario" class="java.util.Map" >
       <parameter property="codigoCuentaCorrienteBancaria"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="codigoTipoOrigen"              				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="numeroLote"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeRegistrarLoteBancario" parameterMap="paramExecuteRegistrarLoteBancario"> 
       {call CCC_PKG_GENER.CCC_PR_REGIS_LOTE_BANCA(?,?,?,?)}
	</procedure>		
    
    <parameterMap id="paramGenerarLoteBancarioCheque" class="java.util.Map" >       
       <parameter property="numeroLote"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="generarLoteBancarioCheque" parameterMap="paramGenerarLoteBancarioCheque"> 
       {call CCC_PKG_PROCE.CCC_PR_GENER_LOTE_BANCA_CHEQU(?,?)}
	</procedure>		
	
    <parameterMap id="paramExecuteGenerarConsultoraCupon" class="java.util.Map" >
	   <parameter property="codigoPais"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoSociedad"                             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="codigoPeriodo"              				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>       
    </parameterMap> 	   
	<procedure id="executeGenerarConsultoraCupon" parameterMap="paramExecuteGenerarConsultoraCupon"> 
       {call CCC_PKG_PROCE.CCC_PR_GENER_CONSU_CUPON(?,?,?)}
	</procedure>  	
      	
    <parameterMap id="paramExecuteDepuracionPagosPorRegularizar" class="java.util.Map" >	   	   
       <parameter property="diasAntiguedad"                      	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>       
	   <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	   
    </parameterMap> 	       
	<procedure id="executeDepuracionPagosPorRegularizar" parameterMap="paramExecuteDepuracionPagosPorRegularizar"> 
       {call CCC_PKG_PROCE.CCC_PR_DEPUR_PAGOS_PENDI_REGUL(?,?)}
	</procedure>
	  	
    <parameterMap id="paramExecuteDepuracionSaldosMenoresDeudores" class="java.util.Map" >
	   <parameter property="codigoPeriodoHasta"                         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="importeHasta"                      			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>       
	   <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeDepuracionSaldosMenoresDeudores" parameterMap="paramExecuteDepuracionSaldosMenoresDeudores"> 
       {call CCC_PKG_PROCE.CCC_PR_DEPUR_SALDO_MENOR_DEUDO(?,?,?)}
	</procedure>		  	
    
    <parameterMap id="paramExecuteDepuracionSaldosMenoresAcreedores" class="java.util.Map" >
       <parameter property="codigoPeriodoHasta"                         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeDepuracionSaldosMenoresAcreedores" parameterMap="paramExecuteDepuracionSaldosMenoresAcreedores"> 
       {call CCC_PKG_PROCE.CCC_PR_DEPUR_SALDO_MENOR_ACREE(?,?)}
	</procedure>		 

	<parameterMap id="paramExecuteDepuracionDeudasIncobrables" class="java.util.Map" >
       <parameter property="codigoPeriodoHasta"                         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="importeDesde"                      			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoUsuario"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeDepuracionDeudasIncobrables" parameterMap="paramExecuteDepuracionDeudasIncobrables"> 
       {call CCC_PKG_PROCE.CCC_PR_DEPUR_DEUDA_INCOB(?,?,?)}
	</procedure>		 

    <parameterMap id="paramExecuteProcesarSaldosSeguimientoLevantamientos" class="java.util.Map" >
	   <parameter property="codigoPais"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoSociedad"                             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeProcesarSaldosSeguimientoLevantamientos" parameterMap="paramExecuteProcesarSaldosSeguimientoLevantamientos"> 
       {call CCC_PKG_PROCE.CCC_PR_ACTUA_SALDO_LEVAN(?,?)}
	</procedure> 
	
	<parameterMap id="paramExecuteCargarLotesBancarios" class="java.util.Map" >
	   <parameter property="codigoUsuario"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="numeroLote"                                    jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>	   
    </parameterMap> 	   
	<procedure id="executeCargarLotesBancarios" parameterMap="paramExecuteCargarLotesBancarios">
       {call INT_PKG_CCC.INT_PR_CCC_CARGA_LOTES_BANCA(?,?)}
	</procedure> 
	
	<resultMap id="EnvioMailsConfirmacionCargaLotesBancariosParamsResult" class="java.util.HashMap">																	        	      
		<result property="mailOrigen"          column="VAL_MAIL_ORIG"/>
		<result property="mailDestino"          column="VAL_MAIL_DEST"/>	    			
		<result property="subject"             column="VAL_SUBJ"/>
		<result property="plantilla"           column="NOM_BODY"/>	    
	</resultMap>
	
	<select id="getEnvioMailsConfirmacionCargaLotesBancariosParams" parameterClass="java.util.Map" resultMap="EnvioMailsConfirmacionCargaLotesBancariosParamsResult">
	   SELECT EEP.VAL_MAIL_ORIG, 
	          EEP.VAL_MAIL_DEST,          	  
              EEP.VAL_SUBJ,
              EEP.NOM_BODY
       FROM FIN_ENVIO_EMAIL_PARAM EEP
       WHERE EEP.COD_MODU = #codigoModulo#     
         AND EEP.COD_PROCE = #codigoProceso#      
	</select>
	
	<resultMap id="cargosyAbonosResult"	class="cargosyAbonos">
	    <result property="codigoCliente"             			column="COD_CLIE"/>
	    <result property="nombreCliente"                        column="NOMBRE"/>
	    <result property="oidTerritorio"                    	column="TERR_OID_TERR"/>
    	<result property="oidZona"                       		column="ZZON_OID_ZONA"/>
    	<result property="oidTerritorioAdmin"        		 	column="ZTAD_OID_TERR_ADMI"/>
    	<result property="valorEstruGeop"                  		column="VEPO_OID_VALO_ESTR_GEOP"/>
       	<result property="oidCliente"                 	     	column="CLIE_OID_CLIE"/>
    	<result property="oidClienteDireccion"                  column="CLDI_OID_CLIE_DIRE"/>	
		<result property="oidTipoDocumento"             		column="TDOC_OID_TIPO_DOCU"/>
	    <result property="oidTipoCliente"                       column="TICL_OID_TIPO_CLIE"/>
	    <result property="oidSubTipoCliente"                    column="SBTI_OID_SUBT_CLIE"/>
    	<result property="oidProducto"                       	column="PROD_OID_PROD"/>
    	<result property="codigoVenta"        	 				column="VAL_CODI_VENT"/>
    	<result property="codigoTerritorio"                  	column="TERRITORIO"/>
        <result property="codigoSeccion"                       	column="SECCION"/> 
	   	<result property="codigoZona"                 	     	column="ZONA"/>
		<result property="porcentajeDescuento"                  column="PORCENTAJE_DESCUENTO"/>	
		<result property="unidadesAtendidas"             		column="UNIDADES_ATENDIDAS"/>
	    <result property="montoFactUnitario"                    column="MONTO_FACTURADO_UNITARIO"/>
	    <result property="montoFactTotal"                    	column="MONTO_FACTURADO_TOTAL"/>
    	<result property="montoFactRealUnitario"                column="MONTO_FACTURADO_REAL_UNITARIO"/>
    	<result property="montoFactRealTotal"        	 		column="MONTO_FACTURADO_REAL_TOTAL"/>
    	<result property="montoCorregir"                  		column="MONTO_A_CORREGIR"/>
		<result property="resultado"                 	     	column="RESULTADO"/>
       	<result property="totalCargados"                 	    column="TOTAL_CARGADOS"/>
    	<result property="totalOK"                       		column="TOTAL_OK"/>		
		<result property="totalError"                           column="TOTAL_ERROR"/>    	       		           	  
    </resultMap>
	
	<select id="getCodigoVentaPrecio" parameterClass="java.util.Map"  resultClass="codigoVentaLabelValue">
		SELECT  
	   		   c.COD_SAP as label, 
	           d.VAL_I18N as value,
	   		   b.PRECIO_UNITARIO as precio, 
	   		   e.COD_TIPO_OFER as oferta
		FROM  pre_ofert a, 
			  pre_ofert_detal b, 
			  mae_produ c, 
			  gen_i18n_sicc_pais d, 
			  pre_tipo_ofert e, 
			  cra_perio f, 
			  seg_perio_corpo g, 
			  pre_matri_factu_cabec h
	    WHERE a.OID_OFER=b.OFER_OID_OFER 
			  and b.PROD_OID_PROD=c.OID_PROD
			  and c.OID_PROD=d.VAL_OID 
			  and d.ATTR_ENTI='MAE_PRODU' 
			  and b.TOFE_OID_TIPO_OFER=e.OID_TIPO_OFER
			  and a.MFCA_OID_CABE=h.OID_CABE 
			  and h.PERD_OID_PERI=f.OID_PERI 
			  and f.PERI_OID_PERI=g.OID_PERI
		      and g.COD_PERI=#codigoPeriodo#
			  and b.VAL_CODI_VENT=#codigoVenta#
    </select>
	
	<select id="getCargosAbonosList" parameterClass="java.util.Map"  resultMap="cargosyAbonosResult">
		SELECT    a.COD_CLIE COD_CLIE
			    , a.VAL_NOMB NOMBRE
				, a.TERR_OID_TERR  TERR_OID_TERR
				, a.ZZON_OID_ZONA ZZON_OID_ZONA
				, a.ZTAD_OID_TERR_ADMI ZTAD_OID_TERR_ADMI
				, a.VEPO_OID_VALO_ESTR_GEOP VEPO_OID_VALO_ESTR_GEOP
				, a.clie_oid_clie clie_oid_clie
				, a.cldi_oid_clie_dire cldi_oid_clie_dire
				, a.TDOC_OID_TIPO_DOCU TDOC_OID_TIPO_DOCU
				, a.TICL_OID_TIPO_CLIE TICL_OID_TIPO_CLIE
				, a.SBTI_OID_SUBT_CLIE SBTI_OID_SUBT_CLIE
				, a.prod_oid_prod prod_oid_prod
				, a.val_codi_vent val_codi_vent
				, a.COD_TERR TERRITORIO
				, a.COD_SECC SECCION
				, a.COD_ZONA ZONA
				, a.VAL_PORC_DESC PORCENTAJE_DESCUENTO
				, a.NUM_UNID_ATEN UNIDADES_ATENDIDAS
				, a.VAL_PREC_FACT_UNIT_LOCA MONTO_FACTURADO_UNITARIO
				, a.VAL_PREC_FACT_TOTA_LOCA MONTO_FACTURADO_TOTAL
				, a.MON_FACT_REAL_UNIT MONTO_FACTURADO_REAL_UNITARIO
				, a.MON_FACT_REAL_TOTA MONTO_FACTURADO_REAL_TOTAL
				, a.MON_A_CORR MONTO_A_CORREGIR
		        , a.VAL_RESU RESULTADO
		        , a.TOT_CARG TOTAL_CARGADOS
		        , a.TOT_OK TOTAL_OK
		        , a.TOT_ERRO TOTAL_ERROR
	  FROM CCC_TEMPO_BUSQU_DIFER_PRECI a
	 
    </select>
	
	<parameterMap id="paramExecuteProcesoCargosAbonos" class="java.util.Map" >
	   <parameter property="codigoPais"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoPeriodo"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoVenta"                                   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="precioCorrecto"                      		   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
       <parameter property="codigoCliente"                         		   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="tipoSolicitudCargos"                           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="tipoSolicitudAbonos"                           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoUsuario"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	 
      
	<procedure id="executeProcesoCargosAbonos" parameterMap="paramExecuteProcesoCargosAbonos"> 
       {call CCC_PKG_PROCE.CCC_PR_PROCE_CARGO_ABONO(?,?,?,?,?,?,?,?)}
	</procedure>	
	
	<select id="getRegistrosProcesar" parameterClass="java.util.Map"  resultMap="baseResultCCC">
		SELECT  l.cod_clie CODIGO,
				l.cod_peri DESCRIPCION
		FROM    
				ccc_audit_infor l
		WHERE 
	  		  l.COD_PERI=#codigoPeriodo#
	  		 and l.COD_VENT=#codigoVenta#
	  		 <isNotEmpty prepend="AND" property="codigoConsultora">
	           COD_CLIE =  #codigoConsultora#
	         </isNotEmpty>  
	         
	  		 <![CDATA[
				AND VAL_RESU <> 'OK'
			]]>   		

    </select>
	
	<parameterMap id="executeGenerarDataCargosAbonosParams" class="java.util.Map">
		<parameter property="precioCorrecto" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="codigoVenta" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="oidPeriodo" jdbcType="NUMBER" javaType="java.lang.Integer" mode="IN"/>
		<parameter property="codigoRegion" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="codigoZona" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="codigoConsultora" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
	</parameterMap>
	
	<procedure id="executeGenerarDataCargosAbonos" parameterMap="executeGenerarDataCargosAbonosParams">
		{call CCC_PKG_GENER.CCC_PR_GENER_DIFER_PRECIO(?,?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="executeBloqueoFinancieroPorDiasDeAtrasoParams" class="java.util.Map">
	    <parameter property="codigoPais"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSociedad"   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroDiasAtraso" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="importeDesde" 	   jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="codigoUsuario"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
	</parameterMap>
	
	<procedure id="executeBloqueoFinancieroPorDiasDeAtraso" parameterMap="executeBloqueoFinancieroPorDiasDeAtrasoParams">
		{call CCC_PKG_PROCE.CCC_PR_BLOQU_FINAN_DIAS_ATRAS(?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="executeGenerarInformacionDataCreditoParams" class="java.util.Map">
	    <parameter property="codigoPais"       	   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoModulo"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoInterface"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoPeriodoDesde"   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroDiasAtraso" 	   jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="importeDesde" 	   	   jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
		<parameter property="codigoUsuario"    	   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
	</parameterMap>
	
	<procedure id="executeGenerarInformacionDataCredito" parameterMap="executeGenerarInformacionDataCreditoParams">
		{call INT_PKG_CCC.INT_PR_CCC_INTER_DATA_CREDIT(?,?,?,?,?,?,?)}
	</procedure>
	
 <select id="getDetalleCuponTramiteDepur" parameterClass="java.util.Map"  resultMap="detalleCuponTramiteDepur">
 	
	SELECT CCC.OID_DETA_CUPO_TRAM_DEPU         	    "ID",      
	       MAE.COD_CLIE								"COD_CLIE",
	       MAE.VAL_NOM1 ||' '|| MAE.VAL_NOM2  ||' '|| MAE.VAL_APE1 ||' '|| MAE.VAL_APE2	"NOM_CLIE",
	       CCC.IMP_DETA								"MONTO",
	       CCC.FEC_DOCU 							"FECHA",
	       SITUA.VAL_DESC_SITU_CUPO					"SITUACION"
	  FROM CCC_DETAL_CUPON_TRAMI_DEPUR CCC, MAE_CLIEN MAE, CCC_SITUA_CUPON SITUA
	 WHERE MAE.OID_CLIE=CCC.CLIE_OID_CLIE 
	       AND CCC.SICU_OID_SITU_CUPO = SITUA.OID_SITU_CUPO
	       AND CCC.SICU_OID_SITU_CUPO = 1
  		   AND TRUNC(CCC.FEC_DOCU) >= TO_DATE(#fechaInicio#, 'DD/MM/YYYY')
  		   <![CDATA[ 
  		   AND TRUNC(CCC.FEC_DOCU) <= TO_DATE(#fechaFin#, 'DD/MM/YYYY')
  		   ]]>	
  	  <isNotEmpty property="montoInicio">
	    <![CDATA[
           AND CCC.IMP_DETA >= TO_NUMBER(#montoInicio#,'999999999.99')    			 
    	]]>		
	  </isNotEmpty>
	  <isNotEmpty property="montoFin">
		 <![CDATA[
 		   AND CCC.IMP_DETA <= TO_NUMBER(#montoFin#,'999999999.99')
 		 ]]>			
	  </isNotEmpty>
	  ORDER BY 2	
    </select>
    
   <update id="updateCuponTramiDepur" parameterClass="java.util.Map">
        UPDATE CCC_DETAL_CUPON_TRAMI_DEPUR
   		   SET SICU_OID_SITU_CUPO = 2
 		 WHERE OID_DETA_CUPO_TRAM_DEPU = #id#
	</update>
		 
	<select id="getGastosAdministrativosList" parameterClass="java.util.Map" resultMap="getGastosAdmministrativosListResult">		
  SELECT PGA.OID_PGAD OID,
       RG.DESCRIPCION DESC_REGION,
       ZN.DESCRIPCION DESC_ZONA,
       SC.DESCRIPCION DESC_SECCION,
       TC.DESCRIPCION TIPO_CLIENTE,
       STC.DESCRIPCION SUBTIPO_CLIENTE,
       TCS.DESCRIPCION TIPO_CLASIFICACION_CLIENTE,
       CL.DESCRIPCION CLASIFICACION,
       CI.COD_CLIE CODIGO_CLIENTE,
       PQ_APL_AUX.VALOR_GEN_I18N_SICC (#codigoIso#,
		                                       PGA.OID_ESTA_CLIE,
		                                       'MAE_ESTAT_CLIEN'
		                                      ) ESTA_CLIEN_DES,
       PGA.VAL_DGRA,
       PGA.VAL_MMIN,
       PGA.IMP_GAST,
       PGA.IND_EJEC
  FROM CCC_PARAM_GASTO_ADMIN PGA,
       (SELECT DISTINCT ZON_REGIO.OID_REGI OID,
                        UPPER(NVL(ZON_REGIO.DES_REGI, ' ')) DESCRIPCION
          FROM SEG_PAIS, SEG_MARCA, SEG_CANAL, ZON_REGIO
         WHERE ((ZON_REGIO.IND_ACTI = 1) AND
               (SEG_PAIS.COD_PAIS = #codigoPais#) AND
               (SEG_MARCA.COD_MARC = #codigoMarca#) AND
               (SEG_CANAL.COD_CANA = #codigoCanal#) AND
               (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS) AND
               (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC) AND
               (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA))
         ORDER BY 2 ASC) RG,
       (SELECT ZON_ZONA.OID_ZONA AS OID,
               NVL(ZON_ZONA.DES_ZONA, ' ') AS DESCRIPCION
          FROM ZON_ZONA, SEG_PAIS, SEG_CANAL, SEG_MARCA, ZON_REGIO
         WHERE (ZON_ZONA.IND_ACTI = 1)
           AND (SEG_PAIS.COD_PAIS = #codigoPais#)
           AND (SEG_MARCA.COD_MARC = #codigoMarca#)
           AND (SEG_CANAL.COD_CANA = #codigoCanal#)
           AND (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
           AND (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
           AND (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)
           AND (SEG_CANAL.OID_CANA = ZON_ZONA.CANA_OID_CANA)
           AND (SEG_PAIS.OID_PAIS = ZON_ZONA.PAIS_OID_PAIS)
           AND (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)) ZN,
       (SELECT ZON_SECCI.OID_SECC AS OID,
               NVL(ZON_SECCI.DES_SECCI, ' ') AS DESCRIPCION
          FROM ZON_SECCI, SEG_PAIS, SEG_CANAL, SEG_MARCA, ZON_ZONA
         WHERE (ZON_SECCI.IND_ACTI = 1)
           AND (SEG_PAIS.COD_PAIS = #codigoPais#)
           AND (SEG_MARCA.COD_MARC = #codigoMarca#)
           AND (SEG_CANAL.COD_CANA = #codigoCanal#)
           AND (SEG_CANAL.OID_CANA = ZON_ZONA.CANA_OID_CANA)
           AND (SEG_PAIS.OID_PAIS = ZON_ZONA.PAIS_OID_PAIS)
           AND (SEG_MARCA.OID_MARC = ZON_ZONA.MARC_OID_MARC)
           AND (ZON_SECCI.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA) 
        ORDER BY 2 ASC) SC,
       (SELECT OID_TIPO_CLIE OID, VAL_I18N DESCRIPCION
          FROM GEN_I18N_SICC_COMUN P, MAE_TIPO_CLIEN C, SEG_IDIOM I
         WHERE P.VAL_OID = C.OID_TIPO_CLIE
           AND P.IDIO_OID_IDIO = I.OID_IDIO
           AND P.ATTR_ENTI = 'MAE_TIPO_CLIEN'
           AND I.COD_ISO_IDIO = #codigoIso#
         ORDER BY 2) TC,
       (SELECT c.oid_subt_clie OID, VAL_I18N DESCRIPCION
          FROM GEN_I18N_SICC_COMUN P,
               MAE_SUBTI_CLIEN     C,
               MAE_TIPO_CLIEN      T,
               SEG_IDIOM           I
         WHERE P.VAL_OID = C.OID_SUBT_CLIE
           AND P.IDIO_OID_IDIO = I.OID_IDIO
           AND P.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
           AND T.OID_TIPO_CLIE = C.TICL_OID_TIPO_CLIE
           AND I.COD_ISO_IDIO = #codigoIso#) STC,
       (SELECT oid_Tipo_Clas OID, VAL_I18N DESCRIPCION
          FROM GEN_I18N_SICC_COMUN,
               SEG_IDIOM,
               MAE_TIPO_CLASI_CLIEN,
               MAE_TIPO_CLIEN,
               MAE_SUBTI_CLIEN
         WHERE GEN_I18N_SICC_COMUN.VAL_OID =
               MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS
           AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
           AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN'
           AND MAE_SUBTI_CLIEN.OID_SUBT_CLIE =
               MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE
           AND MAE_TIPO_CLIEN.OID_TIPO_CLIE =
               MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE) TCS,
       (SELECT OID_CLAS OID, VAL_I18N DESCRIPCION
          FROM GEN_I18N_SICC_COMUN,
               SEG_IDIOM,
               MAE_CLASI,
               MAE_TIPO_CLASI_CLIEN,
               MAE_SUBTI_CLIEN,
               MAE_TIPO_CLIEN
         WHERE GEN_I18N_SICC_COMUN.VAL_OID = MAE_CLASI.OID_CLAS
           AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
           AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_CLASI'
           AND SEG_IDIOM.COD_ISO_IDIO = #codigoIso#
           AND MAE_CLASI.TCCL_OID_TIPO_CLAS =
               MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS
           AND MAE_SUBTI_CLIEN.OID_SUBT_CLIE =
               MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE
           AND MAE_TIPO_CLIEN.OID_TIPO_CLIE =
               MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE) CL,
       MAE_CLIEN CI
 WHERE 
         PGA.OID_TIPO_CLIE = TC.OID(+)
         AND PGA.OID_SUBT_CLIE = STC.OID(+)
         AND PGA.OID_TIPO_CLAS_CLIE = TCS.OID(+)
         AND PGA.OID_CLAS_CLIE = CL.OID(+)
         AND PGA.CLIE_OID_CLIE = CI.OID_CLIE(+)
         AND PGA.OID_REGI = RG.OID(+) 
         AND PGA.OID_ZONA = ZN.OID(+)
         AND PGA.OID_SECC = SC.OID(+)
         AND PGA.IND_ACTI = 1
        <isNotEmpty property="oidCliente">
          AND PGA.CLIE_OID_CLIE = #oidCliente#
        </isNotEmpty>
        <isNotEmpty property="oidTipoCliente">
          AND PGA.OID_TIPO_CLIE = #oidTipoCliente#
        </isNotEmpty>
        <isNotEmpty property="oidSubTipoCliente">
          AND PGA.OID_SUBT_CLIE = #oidSubTipoCliente#
        </isNotEmpty>
        <isNotEmpty property="oidSubTipoClasificacion">
          AND PGA.OID_TIPO_CLAS_CLIE = #oidSubTipoClasificacion#
        </isNotEmpty>
        <isNotEmpty property="oidClasificacion">
          AND PGA.OID_CLAS_CLIE = #oidClasificacion#
        </isNotEmpty>
        <isNotEmpty property="codigoRegion">
          AND PGA.OID_REGI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_REGION(#codigoPais#,#codigoMarca#,#codigoCanal#,#codigoRegion#)
        </isNotEmpty>
        <isNotEmpty property="codigoZona">
          AND PGA.OID_ZONA = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_ZONA(#codigoPais#,#codigoMarca#,#codigoCanal#,#codigoRegion#,#codigoZona#)
        </isNotEmpty>        
        <isNotEmpty property="clienteList">  
          <iterate prepend="AND" property="clienteList" open="(" close=")" conjunction="OR">
               PGA.CLIE_OID_CLIE = #clienteList[]#
            </iterate> 
          </isNotEmpty>
	</select>
	
	<insert id="insertCCCGastosAdministrativos" parameterClass="java.util.Map">
		INSERT INTO CCC_PARAM_GASTO_ADMIN 
		(  OID_PGAD,           
	       OID_REGI,           
	       OID_ZONA,           
	       OID_SECC,           
	       OID_TIPO_CLIE,      
	       OID_SUBT_CLIE,      
	       OID_TIPO_CLAS_CLIE, 
	       OID_CLAS_CLIE,      
	       CLIE_OID_CLIE,      
	       OID_ESTA_CLIE,      
	       VAL_DGRA,           
	       VAL_MMIN,           
	       IMP_GAST,           
	       IND_EJEC,           
	       IND_ACTI,           
	       USU_CREA,           
	       FEC_CREA,           
	       USU_MODI,           
	       FEC_MODI       
		 )
		VALUES
		(CPGA_SEQ.nextval,
		 (SELECT OID_REGI FROM ZON_REGIO WHERE COD_REGI = #codigoRegion#),
		 (SELECT OID_ZONA FROM ZON_ZONA WHERE COD_ZONA = #codigoZona#),
		 (SELECT OID_SECC FROM ZON_SECCI WHERE COD_SECC = #codigoSeccion#),		 
		 #oidTipoCliente#,
		 #oidSubTipoCliente#,
		 #oidSubTipoClasificacion#,
		 #oidClasificacion#,
		 #oidCliente#,
		 #oidStatusCliente#
		 #diasGracia#,
		 #montoMinimo#,
		 #gastoAdministrativo#,
		 #indicadorEjecucion#,
		 1,
		 #usuario#,
		 SYSDATE,
		 #usuario#,
		 SYSDATE)
	</insert>
	
	<update id="deleteLogicoGastosAdministrativos" parameterClass="java.util.Map">
		UPDATE CCC_PARAM_GASTO_ADMIN
		SET IND_ACTI = 0,
		    USU_MODI = #usuario#,
		    FEC_MODI = SYSDATE
		WHERE OID_PGAD = #oid#		
	</update>
	
	<select id="getBancosCheques" parameterClass="java.util.Map" resultMap="baseResultCCC">
	  	SELECT CBC.COD_BANC as CODIGO, CBC.DES_BANC as DESCRIPCION 
	  	FROM CCC_BANCO_CHEQU CBC
	  	WHERE CBC.IND_ACTI = '1'  
	</select>
		
	<select id="getSucursalesCheques" parameterClass="java.util.Map" resultMap="baseResultCCC">
		SELECT  BSC.COD_SUCU as CODIGO, BSC.DES_SUCU as DESCRIPCION
		FROM CCC_BANCO_SUCUR_CHEQU BSC
		WHERE
		BSC.IND_ACTI = '1'  
		<isNotEmpty property="codigoBanco">                    
           AND BSC.BAN_CODI_BANC = #codigoBanco#
        </isNotEmpty>		
	</select>  
	
	<select id="getCabeceraConsultoraByDocIdentidad" parameterClass="java.util.Map" resultMap="datosConsultoraBasicoResult">
		SELECT MC.COD_CLIE AS COD_CONS,
		       MC.VAL_APE1  ||' '|| MC.VAL_APE2 ||' , '|| MC.VAL_NOM1||' '||MC.VAL_NOM2 AS  NOMB,	
		        MTD.COD_TIPO_DOCU AS  TIPO_DOC,
		       MI.NUM_DOCU_IDEN AS NUM_DOC_IDEN	      
		FROM MAE_CLIEN_IDENT MI, MAE_CLIEN MC, MAE_TIPO_DOCUM MTD
		WHERE MC.OID_CLIE = MI.CLIE_OID_CLIE
		   AND MTD.OID_TIPO_DOCU = MI.TDOC_OID_TIPO_DOCU
		  <isNotEmpty property="tipoDocumento"> 
		   		AND MTD.COD_TIPO_DOCU = #tipoDocumento#
		   </isNotEmpty>
		   <isNotEmpty property="numeroDocumentoIdentidad"> 
		   		AND MI.NUM_DOCU_IDEN = #numeroDocumentoIdentidad#
		   </isNotEmpty>
		   <isNotEmpty property="codigoConsultora">
		   	    AND MC.COD_CLIE = #codigoConsultora#
		   </isNotEmpty>
	</select> 
	
	<select id="getValParaCCCParamGener" parameterClass="string" resultClass="string">
       SELECT VAL_PARA
       FROM CCC_PARAM_GENER
       WHERE COD_PARA = #value#
	</select>
	
	<select id="getCantidadRegistroMovimBancaRuteo" parameterClass="java.util.Map" resultClass="int">
        select count(*)
        from ccc_movim_banca_ruteo
	</select>
				
    <insert id="insertCCCMovimBancaRuteo" parameterClass="string">
    <![CDATA[
            insert into own_ec_es.ccc_movim_banca@dbl_siccece_exec(
              oid_movi_banc          ,
              soci_oid_soci           ,
              subp_oid_marc_ulti      ,
              subp_oid_marc_crea      ,
              tcab_oid_abon_ulti      ,
              tcab_oid_abon_crea      ,
              ttra_oid_tipo_trans     ,
              ccba_oid_cc_banc        ,
              num_cons_tran           ,
              num_lote                ,
              cod_cons                ,
              cod_erro                ,
              val_digi_cheq_fact      ,
              val_docu_apli_anio      ,
              val_docu_apli_mes_seri  ,
              val_docu_apli_nume      ,
              val_docu_crea_anio      ,
              val_docu_crea_mes_seri  ,
              val_docu_crea_nume      ,
              val_esta_movi_pend      ,
              fec_cont                ,
              fec_pago                ,
              fec_proc                ,
              val_hora_proc           ,
              val_hora_norm_adic      ,
              cod_iden_proc           ,
              imp_pago                ,
              val_nomb_ofic           ,
              num_cupo                ,
              val_nume_docu           ,
              num_fact_bole           ,
              val_nume_lote_cont      ,
              val_obse                ,
              cod_ofic_reca           ,
              val_usua_proc           ,
              fec_movi_apli           ,
              val_impo_movi           ,
              cod_usua                ,
              num_lote_exte           ,
              num_hist                ,
              imp_apli                ,
              imp_sald_pend           ,
              pais_oid_pais           ,
              sbac_oid_sbac           ,
              tier_oid_erro           ,
              clie_oid_clie           ,
              mcac_oid_cabe           ,
              cod_usua_rece           ,
              val_hora_rece           ,
              cod_usua_liqu           ,
              val_hora_liqu           ,
              cod_usua_regu           ,
              val_hora_regu           ,
              cod_usu_carg_exce       ,
              val_hora_carg_exce      ,
              ind_pago_regu           ,
              cod_digi_ctrl           ,
              num_docu_iden           ,
              oid_banc_sucu_cheq      ,
              ind_tipo_cheq           ,
              fec_cobr_cheq           )

            select 
              own_ec_es.ccc_cmba_seq.nextval@dbl_siccece_exec,
              mb.soci_oid_soci           ,
              mb.subp_oid_marc_ulti      ,
              mb.subp_oid_marc_crea      ,
              mb.tcab_oid_abon_ulti      ,
              mb.tcab_oid_abon_crea      ,
              mb.ttra_oid_tipo_trans     ,
              mb.ccba_oid_cc_banc        ,
              mb.num_cons_tran           ,
              mb.num_lote                ,
              mb.cod_cons                ,
              mb.cod_erro                ,
              mb.val_digi_cheq_fact      ,
              mb.val_docu_apli_anio      ,
              mb.val_docu_apli_mes_seri  ,
              mb.val_docu_apli_nume      ,
              mb.val_docu_crea_anio      ,
              mb.val_docu_crea_mes_seri  ,
              mb.val_docu_crea_nume      ,
              mb.val_esta_movi_pend      ,
              mb.fec_cont                ,
              mb.fec_pago                ,
              mb.fec_proc                ,
              mb.val_hora_proc           ,
              mb.val_hora_norm_adic      ,
              mb.cod_iden_proc           ,
              mb.imp_pago                ,
              mb.val_nomb_ofic           ,
              mb.num_cupo                ,
              mb.val_nume_docu           ,
              mb.num_fact_bole           ,
              mb.val_nume_lote_cont      ,
              mb.val_obse                ,
              mb.cod_ofic_reca           ,
              mb.val_usua_proc           ,
              mb.fec_movi_apli           ,
              mb.val_impo_movi           ,
              mb.cod_usua                ,
              mb.num_lote_exte           ,
              mb.num_hist                ,
              mb.imp_apli                ,
              mb.imp_sald_pend           ,
              mb.pais_oid_pais           ,
              mb.sbac_oid_sbac           ,
              mb.tier_oid_erro           ,
              mb.clie_oid_clie           ,
              mb.mcac_oid_cabe           ,
              mb.cod_usua_rece           ,
              mb.val_hora_rece           ,
              mb.cod_usua_liqu           ,
              mb.val_hora_liqu           ,
              mb.cod_usua_regu           ,
              mb.val_hora_regu           ,
              mb.cod_usu_carg_exce       ,
              mb.val_hora_carg_exce      ,
              mb.ind_pago_regu           ,
              mb.cod_digi_ctrl           ,
              mb.num_docu_iden           ,
              mb.oid_banc_sucu_cheq      ,
              mb.ind_tipo_cheq           ,
              mb.fec_cobr_cheq           
            from ccc_movim_banca_ruteo mb
            where num_lote = #value#
	]]>
    </insert>     

	
	 <parameterMap id="executeCCCRegistrarLoteBancarioParams" class="java.util.Map" >
		<parameter property="nuevocodigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nuevocodigoSociedad"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nuevocodigoBancoSicc"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoOrigen"                     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="numeroLoteInterno"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                        																                              
        <parameter property="codigoUsuario"         	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
   <procedure id="executeCCCRegistrarLoteBancario" parameterMap="executeCCCRegistrarLoteBancarioParams" >
   		{call ccc_pr_regis_lote_banca_esika(?,?,?,?,?,?)}
    </procedure>											
	
	<parameterMap id="executeEnvioCargosEFTFtpParams" class="java.util.Map" >
        <parameter property="codigoUsuario"         	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"         	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
    </parameterMap>    
    <procedure id="executeEnvioCargosEFTFtp" parameterMap="executeEnvioCargosEFTFtpParams" >
   		{call int_pkg_ccc.int_ccc_pr_cargo_eftgr_ftp(?,?)}
	</procedure>
		
	<parameterMap id="executeEnvioCargosEFTMailParams" class="java.util.Map" >
        <parameter property="codigoUsuario"         	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"         	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
    </parameterMap>    
   	<procedure id="executeEnvioCargosEFTMail" parameterMap="executeEnvioCargosEFTMailParams" >
   		{call int_pkg_ccc.int_ccc_pr_cargo_eftgr_mail(?,?)}
	</procedure>
		
	<parameterMap id="executeEnvioCobranzasSAPFIChileParams" class="java.util.Map" >
        <parameter property="codigoUsuario"         	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
   <procedure id="executeEnvioCobranzasSAPFIChile" parameterMap="executeEnvioCobranzasSAPFIChileParams" >
   		{call int_pkg_ccc.int_pr_ccc_gener_sapfi_chile(?)}
	</procedure>
	
	<select id="getRutaCarpetaArchivo" parameterClass="string" resultClass="string">
		SELECT f.dir_ensa
		  FROM fin_param_inter_cabec f
		 WHERE f.cod_modu = 'CCC' 
		 AND f.cod_inte = #value# 
	</select>
	
    <select id="getUltimoOidPagoWeb" parameterClass="java.util.Map"  resultClass="int">
	  SELECT fin.oid_ulti_regi_proc
      FROM fin_contr_regis_progr fin
      WHERE fin.cod_modu = #codigoModulo# 
        AND fin.cod_prog = #codigoPrograma#    
    </select>
    
    <update id="updateUltimoOidPagoWeb" parameterClass="java.util.Map">
        UPDATE fin_contr_regis_progr fin
   		   SET
   		      fin.oid_ante_regi_proc = fin.oid_ulti_regi_proc, 
   		      fin.oid_ulti_regi_proc = (SELECT MAX(a.oid_pago)
   		   								 FROM ccc_carga_pagos_linea a)   		       
 		WHERE fin.cod_modu = #codigoModulo# 
          AND fin.cod_prog = #codigoPrograma#  
	</update>
	
	<resultMap id="resultPagosWebMap" class="java.util.HashMap">
	    <result property="oidPago"  					    column="ID"/>
	    <result property="codigoBanco"      				column="BANKC"/>
	    <result property="codigoCanal"      				column="CANAL"/>
	    <result property="tipoOperacion"  					column="TIPOPE"/>
	    <result property="codigoOperacion"  				column="CODOP"/>
	     <result property="codigoTrace"  				    column="TRACE"/>
        <result property="codigoConsultora"  				column="CODCON"/>       
        <result property="fechaPago"      				    column="FECPAG"/>
        <result property="montoPago"          			    column="MONDEU"/>        
    </resultMap>
                   
    <select id="getListPagosWeb" parameterClass="java.util.Map"  resultMap="resultPagosWebMap">
	   SELECT 
		 ID,
		 BANKC,
		 CANAL,		 
		 TIPOPE,
		 CODOP,
		 TRACE,
 		 CODCON,
 		 CONVERT(VARCHAR(25),FECPAG,20) FECPAG,
 		 MONDEU 		 
	    FROM $tabla$ 
	    WHERE ID > #ultimoOidPago#	    
    </select>
    
   <resultMap id="resultListInsertDeudaWebMap" class="java.util.HashMap">	    
	    <result property="codigoConsultora"      			column="CODCON"/>
	    <result property="nombreConsultora"      		    column="NOMCON"/>	    
        <result property="montoDeuda"          			    column="MONDEU"/>        
    </resultMap>
                   
    <select id="getListInsertDeudasWeb" parameterClass="java.util.Map"  resultMap="resultListInsertDeudaWebMap">
	  SELECT 
       COD_CONS CODCON,
       NOM_CONS NOMCON,
       VAL_DEUD MONDEU
      FROM CCC_NOVED_CLIEN_DEUDA_WEB
      WHERE TIP_NOVE = 'I'
    </select>
    
    <resultMap id="resultListUpdateDeudaWebMap" class="java.util.HashMap">	    
	    <result property="codigoConsultora"      			column="CODCON"/>
	    <result property="nombreConsultora"      		    column="NOMCON"/>	    
        <result property="montoDeuda"          			    column="MONDEU"/>        
    </resultMap>
                   
    <select id="getListUpdateDeudasWeb" parameterClass="java.util.Map"  resultMap="resultListUpdateDeudaWebMap">
	  SELECT 
       COD_CONS CODCON,
       NOM_CONS NOMCON,
       VAL_DEUD MONDEU
      FROM CCC_NOVED_CLIEN_DEUDA_WEB
      WHERE TIP_NOVE = 'U' 
    </select>
      
    <!-- ELIMINA EN TABLA DE SIP_SALDO -->
	<update id="deleteDeudaWeb" parameterClass="java.util.Map">
		<![CDATA[
	      	DELETE FROM SIP_SALDO WHERE CODCON = #codigoConsultora#						
	    ]]>
	</update>
      
   <!-- INSERTA EN TABLA DE SIP_SALDO -->
	<insert id="insertDeudaWeb" parameterClass="java.util.Map">
		<![CDATA[
	      	INSERT INTO SIP_SALDO (
	      	   CODCON,
	      	   MONTO,
	      	   NOMCON
	      	   )						
	        VALUES ( 
			#codigoConsultora#,
			#montoDeuda#,
			#nombreConsultora#			
			)			
	    ]]>
	</insert>

 <!-- ACTUALIZA EN TABLA DE SIP_SALDO -->
	<insert id="updateDeudaWeb" parameterClass="java.util.Map">
		<![CDATA[
	      	UPDATE SIP_SALDO 
	      	SET MONTO = #montoDeuda#
	        WHERE CODCON = #codigoConsultora#			
	    ]]>
	</insert>
		
   <!-- INSERTA EN TABLA DE PAGOS WEB-->
	<insert id="insertPagoWeb" parameterClass="java.util.Map">
		<![CDATA[
	      	INSERT INTO CCC_CARGA_PAGOS_LINEA (
	      	   NUM_LOTE,
	      	   OID_PAGO,
	      	   COD_BANC,
	      	   COD_CANA,
	      	   TIP_OPER,
	      	   COD_OPER,
	      	   COD_TRAC,
	           COD_CLIE,
	           FEC_PAGO,     
			   IMP_PAGO,			   			   
			   COD_USUA_PROC,			   
			   FEC_PROC,
			   IND_ESTA)						
	        VALUES ( 
			#numeroLote#,
			#oidPago#,
			TRIM(#codigoBanco#),
			TRIM(#codigoCanal#),
			TRIM(#tipoOperacion#),
			TRIM(#codigoOperacion#),
			TRIM(#codigoTrace#),
			TRIM(#codigoConsultora#),
			TO_DATE(TRIM(#fechaPago#),'DD/MM/YYYY HH24:MI:SS'),
			#montoPago#,					
			TRIM(#codigoUsuario#),
			SYSDATE,
			0)			
	    ]]>
	</insert>
   
   <parameterMap id="executeGeneraNovedadesDeudasWebParams" class="java.util.Map">	
		<parameter property="codigoUsuario"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
	</parameterMap>
	
	<procedure id="executeGeneraNovedadesDeudasWeb" parameterMap="executeGeneraNovedadesDeudasWebParams">
		{call CCC_PKG_PROCE.CCC_PR_GENER_NOVED_DEUDA_WEB(?)}
	</procedure>  
	
    <resultMap id="resultParamCargaArchivosBanco" class="java.util.HashMap">	    
	    <result property="codClieIni"      					column="cod_clie_ini"/>
	    <result property="codClieFin"      					column="cod_clie_fin"/>
	    <result property="fecPagoIni"      					column="fec_pago_ini"/>
	    <result property="fecPagoFin"      					column="fec_pago_fin"/>
	    <result property="fmtFecha"      					column="fec_pago_fmt"/>
	    <result property="impPagoIni"      					column="imp_pago_ini"/>
	    <result property="impPagoFin"      					column="imp_pago_fin"/>
	    <result property="cantDecimales"      					    column="imp_pago_dec"/>             
    </resultMap>
                   
    <select id="getParamCargaArchivosBanco" parameterClass="java.util.Map"  resultMap="resultParamCargaArchivosBanco">
		select pcb.cod_clie_ini,
		       pcb.cod_clie_fin,
		       pcb.fec_pago_ini,
		       pcb.fec_pago_fin,
		       pcb.fec_pago_fmt,
		       pcb.imp_pago_ini,
		       pcb.imp_pago_fin,
			   pcb.imp_pago_dec
		  from ccc_param_carga_banca pcb, seg_pais sp
		 where pcb.pais_oid_pais = sp.oid_pais
		   and sp.cod_pais = #codigoPais#
		   and pcb.banc_cod_banc = #codBanco#
		   and pcb.oid_tipo_orig = #oidTipoOrigen#
		   and pcb.ind_acti = 1
    </select>  
    
    <insert id="insertCargaArchivosBanco" parameterClass="java.util.Map">
		<![CDATA[
	      	INSERT INTO ccc_tempo_carga_archi_banca (
	      	      num_fila,
	      	      BANC_COD_BANC,
    			  cod_clie,     
    			  fec_pago,
                  imp_pago
            )						
	        VALUES ( 
			#numRegistros#,
			#codBanco#,
			#codigoCliente#,
			#fechaPago#,
			#importePago#)			
	    ]]>
	</insert>  
	
	<update id="deleteTablaCargaArchivosBanco">
		DELETE FROM ccc_tempo_carga_archi_banca
	</update>  
	
	<procedure id="executeValidarCargaArchivosBanco">
		{call CCC_PKG_PROCE.CCC_PR_GENER_CARGA_ARCHI_BANCO}
	</procedure>  
	
   <select id="getTipoOrigenBanco" parameterClass="java.util.Map" resultMap="baseResultCCC">
	    select pcb.oid_tipo_orig CODIGO, pcb.des_tipo_orig DESCRIPCION
		  from ccc_param_carga_banca pcb
		 where pcb.banc_cod_banc = #codBanco#
		   and pcb.ind_acti = 1
		 order by pcb.des_tipo_orig
	</select>

    <parameterMap id="executeCargaPagosBancoLineaParams" class="map">														
    	<parameter property="codigoUsuario" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  	</parameterMap>														
  	<procedure id="executeCargaPagosBancoLinea" parameterMap="executeCargaPagosBancoLineaParams">														
	  	{call CCC_PKG_PROCE.CCC_PR_CARGA_PAGOS_BANCO_LINEA(?)}											
  	</procedure>
  	
   													
  	<procedure id="executeCierreFacturacionSAPFI" >														
	  	{call CCC_PKG_PROCE.CCC_PR_PROCE_CIERR_FACTU}											
  	</procedure>
  	
  	<parameterMap id="paramExecuteRegistroIncobrables" class="java.util.Map" >
       <parameter property="documentoIdentidad" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeRegistroIncobrables" parameterMap="paramExecuteRegistroIncobrables">
		{call CCC_PKG_PROCE.CCC_PR_REGIS_CLIEN_INCOB(?)}
	</procedure>
	
	<resultMap id="interesMontoMoraResult"	class="java.util.HashMap">
    	<result property="oidParaInteMora"					column="OID_PARA_INTE_MORA"/>
    	<result property="diasCadencia"						column="NUM_DIAS_CADE"/>
    	<result property="diasCorte"						column="NUM_DIAS_CORT"/>
        <result property="montoMinimo"						column="VAL_MONT_MINI"/>
        <result property="tasaImpuesto"						column="VAL_TASA_IMPU"/>
        <result property="importeFijo"						column="VAL_IMP_FIJO"/>
        <result property="tasaInteres"						column="VAL_TASA_INTE_MENS"/>
        <result property="region"							column="OID_REGI"/>
    	<result property="zona"								column="OID_ZONA"/>
    	<result property="seccion"							column="OID_SECC"/>
        <result property="indTipoClie"						column="IND_EXCL_TIPO_CLIE"/>
        <result property="oidTipoClien"						column="OID_TIPO_CLIE"/>
        <result property="oidSubtClie"						column="OID_SUBT_CLIE"/>
        <result property="oidTipoClasClie"					column="OID_TIPO_CLAS_CLIE"/>
        <result property="oidClasClie"						column="OID_CLAS_CLIE"/>
    	<result property="oidCliente"						column="CLIE_OID_CLIE"/>
    	<result property="oidEstaClie"						column="OID_ESTA_CLIE"/>
        <result property="indicadorActivo"					column="IND_ACTI"/>
        <result property="indicadorTipoCarg"				column="IND_EXCL_TIPO_CARG"/>
        <result property="oidTipoCargo"						column="OID_TIPO_CARG"/>
        <result property="usuarioCrea"						column="USU_CREA"/>
        <result property="fechaCrea"						column="FEC_CREA"/>
    	<result property="usuarioModi"						column="USU_MODI"/>
    	<result property="fechaModi"						column="FEC_MODI"/>
        <result property="indIntePago"						column="IND_INTE_PAGO"/>
        <result property="indInteSaldo"						column="IND_INTE_SALD"/>
        <result property="fechaInicio"						column="FEC_INIC"/>
        <result property="fechaFin"							column="FEC_FIN"/>    	  
        <result property="saldoPermitido"				    column="SAL_PERM"/>
        <result property="numeroDiasBloqueo"				column="NUM_DIAS_BLOQ"/>    	       		           	  
        <result property="saldoPermitido"				    column="SAL_PERM"/>
        <result property="numeroDiasBloqueo"				column="NUM_DIAS_BLOQ"/>    	       		           	  
     </resultMap>
    
    <select id="getInteresMontoMora" resultMap="interesMontoMoraResult">
	   select  OID_PARA_INTE_MORA,
		       NUM_DIAS_CADE,
		       NUM_DIAS_CORT,
		       VAL_MONT_MINI,
		       VAL_TASA_IMPU,
		       VAL_IMP_FIJO,
		       VAL_TASA_INTE_MENS,
		       OID_REGI,
		       OID_ZONA,
		       OID_SECC,
		       IND_EXCL_TIPO_CLIE,
		       OID_TIPO_CLIE,
		       OID_SUBT_CLIE,
		       OID_TIPO_CLAS_CLIE,
		       OID_CLAS_CLIE,
		       CLIE_OID_CLIE,
		       OID_ESTA_CLIE,
		       IND_ACTI,
		       IND_EXCL_TIPO_CARG,
		       OID_TIPO_CARG,
		       USU_CREA,
		       FEC_CREA,
		       USU_MODI,
		       FEC_MODI,
		       IND_INTE_PAGO,
		       IND_INTE_SALD,
		       FEC_INIC,
		       FEC_FIN,
		       SAL_PERM,
           	   NUM_DIAS_BLOQ
		  from ccc_param_inter_mora
		 where ind_acti = '1'
	</select>
	
	<insert id="insertInteresMontoMora" parameterClass="java.util.Map">
		<![CDATA[
	      	insert into ccc_param_inter_mora
				  (OID_PARA_INTE_MORA,
			       NUM_DIAS_CADE,
			       NUM_DIAS_CORT,
			       VAL_MONT_MINI,
			       VAL_TASA_IMPU,
			       VAL_IMP_FIJO,
			       VAL_TASA_INTE_MENS,
			       OID_REGI,
			       OID_ZONA,
			       OID_SECC,
			       IND_EXCL_TIPO_CLIE,
			       OID_TIPO_CLIE,
			       OID_SUBT_CLIE,
			       OID_TIPO_CLAS_CLIE,
			       OID_CLAS_CLIE,
			       CLIE_OID_CLIE,
			       OID_ESTA_CLIE,
			       IND_ACTI,
			       IND_EXCL_TIPO_CARG,
			       OID_TIPO_CARG,
			       USU_CREA,
			       FEC_CREA,
			       USU_MODI,
			       FEC_MODI,
			       IND_INTE_PAGO,
			       IND_INTE_SALD,
			       FEC_INIC,
			       FEC_FIN,
			       SAL_PERM,
			       NUM_DIAS_BLOQ)
				values
				  (#oidParaInteMora#,
			    	#diasCadencia#,
			    	#diasCorte#,
			        #montoMinimo#,
			        #tasaImpuesto#,
			        #importeFijo#,
			        #tasaInteres#,
			        #region#,
			    	#zona#,
			    	#seccion#,
			        #indTipoClie#,
			        #oidTipoClien#,
			        #oidSubtClie#,
			        #oidTipoClasClie#,
			        #oidClasClie#,
			    	#oidCliente#,
			    	#oidEstaClie#,
			        #indicadorActivo#,
			        #indicadorTipoCarg#,
			        #oidTipoCargo#,
			        #usuarioCrea#,
			        #fechaCrea#,
			    	#usuarioModi#,
			    	#fechaModi#,
			        #indIntePago#,
			        #indInteSaldo#,
			        sysdate,
			        null,
			        #saldoPermitido#,
			        #numeroDiasBloqueo#)			
	    ]]>
	</insert>
	
	<update id="updateInteresMontoMora" parameterClass="java.util.Map">
        UPDATE ccc_param_inter_mora
   		   SET FEC_FIN = sysdate, IND_ACTI=#indiceAxuliar#
 		 WHERE IND_ACTI=#indiceBusqueda#
	</update>
	   
	<parameterMap id="paramExecuteRepoContaSaldosCampanias" class="java.util.Map" >
       <parameter property="fechaCorte" 		jdbcType="VARCHAR"    javaType="java.lang.String" mode="IN"/>
    </parameterMap>
    
	<procedure id="executeRepoContaSaldosCampanias" parameterMap="paramExecuteRepoContaSaldosCampanias">														
	  	{call CCC_PKG_REPOR_PROCE.CCC_PR_REPOR_CONTA_SALDO_CAMPA(?)}											
  	</procedure>
	   
  	<parameterMap id="executeInsertarPagoResult" class="java.util.Map">
		<parameter property="codigoBanco"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroOperacion"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="consultora"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaPago"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="montoPago"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="indicadorEjecucion" jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	</parameterMap>
	
	<procedure id="executeInsertarPago" parameterMap="executeInsertarPagoResult">
		{call CCC_PKG_PROCE.CCC_PR_INSER_PAGO_WEBSE(?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<parameterMap id="executeRevertirPagoResult" class="java.util.Map">
		<parameter property="codigoBanco"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroOperacion"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="consultora"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaPago"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="indicadorEjecucion" jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	</parameterMap>
	
	<procedure id="executeRevertirPago" parameterMap="executeRevertirPagoResult">
		{call CCC_PKG_PROCE.CCC_PR_REVER_PAGO_WEBSE(?, ?, ?, ?, ?) }
	</procedure>
	
	<parameterMap id="executeConsultarPagoResult" class="java.util.Map">
		<parameter property="consultora"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="indicadorEjecucion" jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	</parameterMap>
	
	<procedure id="executeConsultarPago" parameterMap="executeConsultarPagoResult">
		{call CCC_PKG_PROCE.CCC_PR_INSER_PAGO_WEBSE(?, ?) }
	</procedure>
	
	<select id="getClasificacionConsultoraByDocIdentidad" parameterClass="java.util.Map"  resultClass="java.lang.Integer">		
		SELECT count(*)
		FROM 
		    MAE_CLIEN            CLI,
		    MAE_CLIEN_TIPO_SUBTI MCTS,
		    MAE_CLIEN_CLASI      MCC,
		    MAE_CLIEN_IDENT MCI,
		    FLX_CLASI_CHEQU CACH,
		    MAE_TIPO_DOCUM MTD
		WHERE
		    MCI.CLIE_OID_CLIE = CLI.OID_CLIE
		    AND MCI.VAL_IDEN_DOCU_PRIN = 1
		    AND CLI.OID_CLIE = MCTS.CLIE_OID_CLIE
		    AND MCTS.OID_CLIE_TIPO_SUBT = MCC.CTSU_OID_CLIE_TIPO_SUBT
		    AND MCTS.TICL_OID_TIPO_CLIE = CACH.OID_TIPO_CLIE
		    AND MCTS.SBTI_OID_SUBT_CLIE = DECODE(CACH.OID_SUBT_CLIE, NULL, MCTS.SBTI_OID_SUBT_CLIE, CACH.OID_SUBT_CLIE)
		    AND MCC.TCCL_OID_TIPO_CLASI = DECODE(CACH.OID_TIPO_CLAS, NULL, MCC.TCCL_OID_TIPO_CLASI, CACH.OID_TIPO_CLAS)
		    AND MCC.CLAS_OID_CLAS = DECODE(CACH.OID_CLAS, NULL, MCC.CLAS_OID_CLAS, CACH.OID_CLAS)
		    AND MTD.OID_TIPO_DOCU = MCI.TDOC_OID_TIPO_DOCU
		    <isNotEmpty property="tipoDocumento"> 
		   		AND MTD.COD_TIPO_DOCU = #tipoDocumento#
		   </isNotEmpty>
		   <isNotEmpty property="numeroDocumentoIdentidad"> 
		   		AND MCI.NUM_DOCU_IDEN = #numeroDocumentoIdentidad#
		   </isNotEmpty>
		   <isNotEmpty property="codigoConsultora">
		   	    AND CLI.COD_CLIE = #codigoConsultora#
		   </isNotEmpty>		
	</select>
	   
	<parameterMap id="paramExecuteProcesarSaldosSeguimientoLevantamientosPorRango" class="java.util.Map" >
	   <parameter property="codigoPais"                                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoSociedad"                             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoPeriodo"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	   <parameter property="codigoTipoEjecucion"                        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeProcesarSaldosSeguimientoLevantamientosPorRango" parameterMap="paramExecuteProcesarSaldosSeguimientoLevantamientosPorRango"> 
       {call CCC_PKG_PROCE.CCC_PR_ACTUA_SALDO_HISTO(?,?,?,?)}
	</procedure> 
	
	<parameterMap id="paramExecuteProcesarSaldosActual" class="java.util.Map" >
	   <parameter property="codigoPeriodo"                              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeProcesarSaldosActual" parameterMap="paramExecuteProcesarSaldosActual"> 
       {call CCC_PKG_PROCE.CCC_PR_ACTUA_SALDO(?)}
	</procedure> 
	
	<!-- OBTIENE EL PERIODO ANTERIOR Y LOS PERIODOS DENTRO DEL RANGO -->
	<select id="getRangoPeriodos" parameterClass="java.util.Map" resultMap="baseResultCCC">
			<![CDATA[
			SELECT 0 AS CODIGO, cod_peri AS DESCRIPCION
			   FROM seg_perio_corpo
			  WHERE cod_peri >= #campanaInicio# AND cod_peri <= #campanaFin#
			ORDER BY 2	
			 ]]>	
	</select>
	   
	<parameterMap id="paramExecuteEliminarLoteBancarioAplicado" class="java.util.Map" >
		<parameter property="numeroLote"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoUsuario"   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap> 	   
	<procedure id="executeEliminarLoteBancarioAplicado" parameterMap="paramExecuteEliminarLoteBancarioAplicado">
       {call CCC_PKG_PROCE.CCC_PR_ELIMI_LOTE_BANCA_LIQUI(?,?)}
	</procedure>
	
	<select id="getConsultoraByDocIdentidad" parameterClass="java.util.Map" resultClass="string">
        SELECT 
		       COD_CLIE
		FROM 
		       MAE_CLIEN       C,
		       MAE_CLIEN_IDENT I,
		       MAE_TIPO_DOCUM MTD
		 WHERE 
		       C.OID_CLIE = I.CLIE_OID_CLIE
		       AND I.NUM_DOCU_IDEN=#numeroDocumentoIdentidad#
		       AND MTD.COD_TIPO_DOCU= #tipoDocumento#
		       AND MTD.OID_TIPO_DOCU = I.TDOC_OID_TIPO_DOCU 
    </select>
    
    <select id="getActivaConsultoraByDocIdentidad" parameterClass="java.util.Map"  resultClass="java.lang.Integer">		
		SELECT COUNT(*) 
		FROM 
		       FLX_CONSU_HABIL_FLEXI CH
		WHERE 
		       CH.COD_CLIE = #codigoConsultora#
		       AND CH.COD_PERI_COMU = #codigoPeriodo#
		       AND CH.IND_ACTI = 1	
	</select>
	
	<resultMap id="regularizacionPagoBancarioMantenimientoDividirPagoResult"	class="java.util.HashMap">
		<result property="oidMovimientoBancario"             	column="OID_MOV_BANC"/> 
    	<result property="descripcionError"   					column="DES_ERRO"/>
    	<result property="fechaPago"                 	        column="FEC_PAGO"/>
    	<result property="codigoCuentaCorrienteBancaria"        column="COD_BANC"/>
    	<result property="descripcionCuentaCorrienteBancaria"   column="DES_BANC"/>
    	<result property="importePago"                          column="IMP_PAGO"/>
    	<result property="codigoConsultora"                     column="COD_CONS"/>
    	<result property="cedulaConsultora"                     column="NUM_DOCU_IDEN"/>
    </resultMap>
    
    <!-- OBTIENE LOS PAGOS BANCARIOS A REGULARIZAR DIVIDIR PAGO SEGUN FILTRO-->
	<select id="getPagosBancariosPorRegularizarDividirPagoByFilter" parameterClass="java.util.Map" resultMap="regularizacionPagoBancarioMantenimientoDividirPagoResult">
		SELECT MB.OID_MOVI_BANC OID_MOV_BANC,
		       TEB.VAL_DESC DES_ERRO,
		       TO_CHAR(MB.FEC_PAGO, 'DD/MM/YYYY') FEC_PAGO,
		       CCB.COD_CC COD_BANC,
		       CCB.DES_CC DES_BANC,
		       MB.IMP_PAGO,
		       MB.COD_CONS,
		       MB.NUM_DOCU_IDEN
		  FROM CCC_MOVIM_BANCA MB, CCC_TIPOS_ERROR_BANCA TEB, CCC_CUENT_CORRI_BANCA CCB
		 WHERE MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
		   AND MB.COD_ERRO = TEB.COD_ERRO
		   AND MB.OID_MOVI_BANC = #oidMovBancario#
	</select>
	 
	<parameterMap id="executeGenerarInformacionBuroCrediticiaParams" class="java.util.Map">														
    	<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
		<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"		    	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	  </parameterMap>
	  														
	  <procedure id="executeGenerarInformacionBuroCrediticia" parameterMap="executeGenerarInformacionBuroCrediticiaParams">														
				{call int_pkg_ccc.INT_PR_CCC_GENER_INFOR_BURO(?, ?, ?, ?, ?)}											
	  </procedure>
	  
	 <resultMap id="getConsoCalcuInteMoralListResult"          class="java.util.HashMap">
    	<result property="codigoConsultora" 		   column="COD_CLIE" 	/>
    	<result property="documentoIndentidad" 	   column="VAL_IDEN_DOCU_PRIN"/>
    	<result property="montoInteres" 	   column="IMP_INTE_VARI"/>
    	<result property="fechaProceso" 	   column="FEC_PROC"/>
    </resultMap>
	  
	  
    <select id="getConsoCalcuInteMoralList" parameterClass="java.util.Map" resultMap="getConsoCalcuInteMoralListResult">
		 SELECT  MC.COD_CLIE,
				  MCI.VAL_IDEN_DOCU_PRIN , 
				  CI.IMP_INTE_VARI, 
				  CI.FEC_PROC
			 FROM CCC_CONSO_CALCU_INTER_MORA CI, MAE_CLIEN MC, MAE_CLIEN_IDENT MCI
			 WHERE  
			    CI.IND_BLOQ = 1
			   AND CI.IND_FACT = 0 
		       AND MCI.CLIE_OID_CLIE= CI.CLIE_OID_CLIE
		       AND MCI.VAL_IDEN_DOCU_PRIN = 1
		       AND MC.OID_CLIE= CI.CLIE_OID_CLIE
			  
			   
 			   <isNotEmpty  property="codigoConsultora">
				   $codigoConsultora$
			   </isNotEmpty>
			   
			   <isNotEmpty  property="fechaProcesoDesde">
			   		<isEmpty property="fechaProcesoHasta">
			   			 <![CDATA[
			   			 AND CI.FEC_PROC >=  TO_DATE(#fechaProcesoDesde#,'dd/MM/yyyy')
			   		   ]]>
			   		</isEmpty>
			   </isNotEmpty>
			   
			    <isNotEmpty  property="fechaProcesoHasta">
			    		<isEmpty property="fechaProcesoDesde">
			    			 <![CDATA[
			   				 AND CI.FEC_PROC <=  TO_DATE(#fechaProcesoHasta#,'dd/MM/yyyy')
			   		 		   ]]>
			    		</isEmpty>			   		
			   </isNotEmpty>
			   
			    <isNotEmpty  property="fechaProcesoDesde">
			    	<isNotEmpty  property="fechaProcesoHasta">
				  	 AND CI.FEC_PROC  between   TO_DATE(#fechaProcesoDesde#,'dd/MM/yyyy') and NVL( TO_DATE(#fechaProcesoHasta#,'dd/MM/yyyy') , CI.FEC_PROC)
				   </isNotEmpty>
			   </isNotEmpty>
			   
	 </select>
	 
	 
	 <update id="updateConsolidadoInterMoraCCC" parameterClass="java.util.Map">
        UPDATE CCC_CONSO_CALCU_INTER_MORA
   		   SET mon_fact =  TO_NUMBER(#montoInteres#, '999999999999.99')
 		 WHERE COD_CLIE = #codigoConsultora#
	</update>
	
	<select id="getPathUploadFacturarInteres" parameterClass="string" resultClass="string">
		SELECT val_ruta_zoni FROM bas_pais WHERE cod_pais = #value#
	</select>
	
	<delete id="deleteConsolidadoInterMoraCCC" parameterClass="string">
    	DELETE FROM CCC_TEMP_CONSUL_MONT_INTER WHERE COD_USUA = #value#
    </delete>
    
    <insert id="insertConsolidadoInterMoraCCC" parameterClass="map">
    	INSERT INTO CCC_TEMP_CONSUL_MONT_INTER(
    		NUM_FILA,
			COD_CONSULTORA,
			MONTO_INTERES,
			COD_USUA)
    	VALUES(
    		#numeroFila#,
    		#codigoConsultora#,
    		to_number(#montoInteres#,'999999999999.99'),
    		#codigoUsuario#
    	)
    </insert>
    
    <parameterMap id="validarCargaConsolidadoInterMoraCCCParams" class="map">
		<parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
     <procedure id="executeValidarCargaConsolidadoInterMoraCCC"   parameterMap="validarCargaConsolidadoInterMoraCCCParams" >
		{call CCC_PKG_PROCE.CCC_PR_VALIDAR_CONSULTORA_MONT(?)}
    </procedure> 
    
    <resultMap id="cargarConsolidadoInterMoraCCCMapResult" class="java.util.HashMap">
		<result property="numeroFila" column="NUM_FILA" />
		<result property="codigoConsultora" column="COD_CONSULTORA" />
		<result property="montoInteres" column="MONTO_INTERES" />
		<result property="mensajeError" column="MEN_ERRO" />
	</resultMap>    
    <select id="getCargarConsolidadoInterMoraCCC" parameterClass="string" resultMap="cargarConsolidadoInterMoraCCCMapResult">
    	SELECT
    		NUM_FILA,
			COD_CONSULTORA,
			MONTO_INTERES,
			MEN_ERRO
    	FROM CCC_TEMP_CONSUL_MONT_INTER
    	WHERE COD_USUA = #value#
    	AND EST_REGI = '0'
    	ORDER BY NUM_FILA
    </select>   
    
    <parameterMap id="procesarCargaFactuInterMoraParams" class="map">
		<parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeProcesarCargaFactuInterMora"   parameterMap="procesarCargaFactuInterMoraParams" >
		{call CCC_PKG_PROCE.CCC_PR_CARGAR_CONSULTORA_MONT(?)}
    </procedure>  
    
       
    <resultMap id="condonacionesDeudasCastigdasResult"          class="java.util.HashMap">
    	<result property="oid" 						column="oid_cons_cast_cabe"/>
    	<result property="codigoConsultora" 		column="cod_clie"/>
		<result property="nombreApellido" 			column="nom_clie"/>
		<result property="cedulaIdentidad" 			column="num_docu_iden"/>
		<result property="fechaCastigo" 			column="fec_cast"/>
		<result property="importeCastigdoOriginal" 	column="imp_deud_cast"/>
		<result property="importeCastigadoActual"  	column="imp_deud_actu"/>

    </resultMap>
    

	<select id="getCondonacionDeudasCastigadasList" parameterClass="java.util.Map" resultMap="condonacionesDeudasCastigdasResult">
	   SELECT 
		 c.oid_cons_cast_cabe,
		 c.cod_clie,
		 c.nom_clie,
		 c.num_docu_iden,
		 c.fec_cast,
		 c.imp_deud_cast,
		 c.imp_deud_actu
		FROM ccc_consu_casti_cabec c
		WHERE c.ind_acti = 1
		
		<isNotEmpty prepend="AND" property="codigoConsultora">
	           c.cod_clie = #codigoConsultora#
	    </isNotEmpty>  
	    <isNotEmpty prepend="AND" property="cedulaIdentidad">
	           c.num_docu_iden = #cedulaIdentidad#
	    </isNotEmpty> 
	</select>  

	<parameterMap id="paramExecuteCondonacionDeudaCastigo" class="java.util.Map" >				
        <parameter property="oid"          jdbcType="NUMBER" javaType="java.lang.Integer" mode="IN"/>                       
    </parameterMap>
	<procedure id="executeCondonacionDeudaCastigo" parameterMap="paramExecuteCondonacionDeudaCastigo">
		{call CCC_PKG_PROCE.CCC_PR_CONDO_DEUDA_CASTI(?)}
	</procedure>
	
	<!-- OBTIENE EL TOTAL DE FACTURA ACTIVA -->
    <select id="getTotalFacturaActiva" parameterClass="java.util.Map" resultClass="string">
		SELECT CCC_PKG_GENER.CCC_FN_OBTIE_SUMAT_TIPO_DOCUM(#fechaDesde#, #fechaHasta#) - CCC_PKG_GENER.CCC_FN_OBTIE_VALOR_FACTU_ANULA(#fechaDesde#, #fechaHasta#) FROM DUAL
 	</select>	  
    
	 
</sqlMap>