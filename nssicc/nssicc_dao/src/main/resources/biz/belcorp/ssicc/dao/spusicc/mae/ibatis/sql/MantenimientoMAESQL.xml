<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.MantenimientoMAESQL">

	
	<typeAlias alias="criterioBusquedaMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.CriterioBusqueda"/>
	<typeAlias alias="tipoDocumentoMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoDocumento"/>
	<typeAlias alias="estadoCivilMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.EstadoCivil"/>
	<typeAlias alias="tipoDirecMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoDireccion"/>
	<typeAlias alias="tipoComuMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoComunicacion"/>
	<typeAlias alias="tipoVinculoMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoVinculo"/>
	
	<typeAlias alias="estatusClienteMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoEstatus"/>
	<typeAlias alias="tipoClasificacionMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoClasificacion"/>
	<typeAlias alias="clasificacionMap" type="biz.belcorp.ssicc.dao.spusicc.mae.model.Clasificacion"/>
	<typeAlias alias="garantiasPremio" type="biz.belcorp.ssicc.dao.spusicc.mae.model.GarantiasPremio"/>
	
	<typeAlias alias="clienteBasico" type="biz.belcorp.ssicc.dao.spusicc.mae.model.Cliente"/>
	<typeAlias alias="clienteAdicional" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteAdicional"/>	
	<typeAlias alias="clientePrimerContacto" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClientePrimerContacto"/>	
	<typeAlias alias="clienteSubTipo" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteSubTipo"/>			
	<typeAlias alias="clienteClasificacion" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteClasificacion"/>				

	<typeAlias alias="clienteIdentificacion" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteIdentificacion"/>					
	<typeAlias alias="clienteDireccion" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteDireccion"/>						
	<typeAlias alias="clienteUnidadAdministrativa" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteUnidadAdministrativa"/>							
	<typeAlias alias="clienteComunicacion" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteComunicacion"/>								
	<typeAlias alias="clienteVinculo" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteVinculo"/>									
	
	<typeAlias alias="clienteMarca" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteMarca"/>										
	<typeAlias alias="clienteObservacion" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteObservacion"/>											
	<typeAlias alias="clienteHistoricoEstatus" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteHistoricoEstatus"/>												
	<typeAlias alias="historicoClasificacion" type="biz.belcorp.ssicc.dao.spusicc.mae.model.HistoricoClasificacion"/>	
	<typeAlias alias="concurso" type="biz.belcorp.ssicc.dao.spusicc.mae.model.Concurso"/>		
	<typeAlias alias="premioMAE" type="biz.belcorp.ssicc.dao.spusicc.mae.model.Premio"/>
	<typeAlias alias="baseGenericoMAE"          type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
	<typeAlias alias="clienteConcursoPremio" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteConcursoPremio"/>									
	<typeAlias alias="clienteReferencia"         type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteReferencias"/>
	<typeAlias alias="clienteHistoricoDatos"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteHistoricoDatos"/>	
	
	<typeAlias alias="excencionFlete"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.ExcencionFlete"/>
	
	<typeAlias alias="excencionSobreFlete"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.ExcencionSobreFlete"/>
	
	<typeAlias alias="tipoBloqueo"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoBloqueo"/>
	
	<typeAlias alias="tipoCliente"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.TipoCliente"/>
	
	<typeAlias alias="subtipoCliente"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.SubtipoCliente"/>
	
	<typeAlias alias="estatusCliente"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.EstatusCliente"/>
	
	<typeAlias alias="accionesProcesoBloqueo"     type="biz.belcorp.ssicc.dao.spusicc.mae.model.AccionesProcesoBloqueo"/>
	
    <resultMap id="baseResultOids"  class="baseGenerico">
    	<result property="codigo" 		column="OID" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>
    
    <resultMap id="baseResult"          class="baseGenericoMAE">
    	<result property="codigo" 		column="CODIGO" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>

	<resultMap id="baseResultZON"          class="baseGenericoMAE">
    	<result property="codigo" 		column="CODIGO" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>

	<resultMap id="baseResultBLOQUEO" class="java.util.HashMap">
    	<result property="tipoBloqueo" 		column="TIPO_BLOQUEO" 	/>
    	<result property="usuarioBloqueo" 	column="VAL_USUA_BLOQ"/>
    	<result property="fechaBloqueo" 	column="FEC_BLOQ"/>
    </resultMap>
	
	<resultMap id="excencionesFletesResultMap" class="java.util.HashMap">
    	<result property="oidExcencion"			column="OID_EXEN_FLET" 	/>
    	<result property="tipoCliente" 			column="DES_TICL"/>
    	<result property="subtipoCliente" 		column="DES_STCL"/>
    	<result property="tipoClasificacion" 	column="DES_TICS"/>
    	<result property="clasificacion" 		column="DES_CLAS"/>
    	<result property="indicador" 			column="DES_ESTA"/>
    </resultMap>   
	
    <resultMap id="excencionFleteResultMap"  class="excencionFlete">
    	<result property="oidExcencion" 			column="OID_EXEN_FLET" 	/>
    	<result property="oidPais" 					column="PAIS_OID_PAIS"/>
    	<result property="oidClasificacion" 		column="CLAS_OID_CLAS"/>
    	<result property="indicadorExcepcionFlete" 	column="IND_EXEN_FLET"/>
    	<result property="oidSubTipoCliente" 		column="SBTI_OID_SUBT_CLIE"/>
    	<result property="oidTipoCliente" 			column="TICL_OID_TIPO_CLIE"/>
    	<result property="oidTipoClasificacion" 	column="TCCL_OID_TIPO_CLAS"/>
        <result property="auditInfo.createdBy" 		column="USU_CREA"/>
        <result property="auditInfo.created" 		column="FEC_CREA"/>
        <result property="auditInfo.updatedBy" 		column="USU_MODI"/>
        <result property="auditInfo.lastUpdated" 	column="FEC_MODI"/>
    </resultMap>
	
    <resultMap id="excencionesSobreFletesResultMap" class="java.util.HashMap">
		<result property="codExenSfle" 			column="COR_EXEN_SFLE"/>
    	<result property="tipoCliente" 			column="DES_TICL"/>
    	<result property="subtipoCliente" 		column="DES_STCL"/>
    	<result property="tipoClasificacion" 	column="DES_TICS"/>
    	<result property="clasificacion" 		column="DES_CLAS"/>
    	<result property="indicador" 			column="DES_ESTA"/>
    </resultMap>  
    
    <resultMap id="excencionSobreFleteResultMap"  class="excencionSobreFlete">
    	
		<result property="codExenSfle" 				column="COR_EXEN_SFLE"/>
    	<result property="codClasificacion" 		column="COD_CLAS"/>
    	<result property="indicadorExcepcionFlete" 	column="IND_ACTI"/>
    	<result property="codSubTipoCliente" 		column="COD_SUBT_CLIE"/>
    	<result property="codTipoCliente" 			column="COD_TIPO_CLIE"/>
    	<result property="codTipoClasificacion" 	column="COD_TIPO_CLAS"/>
        <result property="auditInfo.createdBy" 		column="USU_CREA"/>
        <result property="auditInfo.created" 		column="FEC_CREA"/>
        <result property="auditInfo.updatedBy" 		column="USU_MODI"/>
        <result property="auditInfo.lastUpdated" 	column="FEC_MODI"/>
        
    </resultMap>
	
	
    <!-- OBTIENE LOS PERIODO VIGENTES POR PAIS MARCA Y CANAL -->
    <select id="getPeriodosVigentesByPaisMarcaCanal" parameterClass="java.util.Map" resultMap="baseResultOids">
      SELECT SEG_PERIO_CORPO.COD_PERI,
	         CRA_PERIO.OID_PERI AS OID,
	  		 SEG_PERIO_CORPO.COD_PERI AS DESCRIPCION
	    FROM CRA_PERIO,
	   		 SEG_PAIS,
			 SEG_MARCA,
			 SEG_CANAL,
	         SEG_PERIO_CORPO
        WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
    	   	  <isNotEmpty prepend="AND" property="codigoMarca">
			    (SEG_MARCA.COD_MARC = #codigoMarca#)
			  </isNotEmpty>
		      <isNotEmpty prepend="AND" property="codigoCanal">
			    (SEG_CANAL.COD_CANA = #codigoCanal#)
			  </isNotEmpty>
    	AND  (SEG_PAIS.OID_PAIS  = CRA_PERIO.PAIS_OID_PAIS)
		AND  (SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC)
		AND  (SEG_CANAL.OID_CANA = CRA_PERIO.CANA_OID_CANA)
		AND  (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
		AND  (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI)
	   	<![CDATA[
    	AND  ((TO_DATE( (TO_CHAR(SYSDATE,'MM/DD/YYYY')),'MM/DD/YYYY' )) >= CRA_PERIO.FEC_INIC)
	    AND  ((TO_DATE( (TO_CHAR(SYSDATE,'MM/DD/YYYY')),'MM/DD/YYYY' )) <= CRA_PERIO.FEC_FINA)
	    ]]>
	    )
		ORDER BY 1 ASC  
    </select>
	
    <!-- OBTIENE LOS TIPO/SUBTIPO DE CLIENTES PERMITIDOS A INSERTAR -->
    <select id="getSubTiposClienteInsertar" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT ING.COD_TIPO_CLIE || '-' || ING.COD_SUBT_CLIE || '-' || TIP.OID_TIPO_CLIE || '-' || SUB.OID_SUBT_CLIE || '-' ||
		       PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, TIP.OID_TIPO_CLIE, 'MAE_TIPO_CLIEN') || ' / ' || PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, SUB.OID_SUBT_CLIE, 'MAE_SUBTI_CLIEN')  AS OID, 
			   PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TIP.OID_TIPO_CLIE, 'MAE_TIPO_CLIEN') || ' / ' || PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, SUB.OID_SUBT_CLIE, 'MAE_SUBTI_CLIEN')  AS DESCRIPCION  
		  FROM MAE_CLIEN_INGRE ING, MAE_TIPO_CLIEN TIP, MAE_SUBTI_CLIEN SUB  
		 WHERE ING.COD_TIPO_CLIE = TIP.COD_TIPO_CLIE
		   AND SUB.TICL_OID_TIPO_CLIE = TIP.OID_TIPO_CLIE
		   AND SUB.COD_SUBT_CLIE = ING.COD_SUBT_CLIE 
		ORDER BY ING.NUM_ORDE 
    </select>
    
    <!-- OBTIENE EL TIPO DE CLASIFICACION DEFAULT PARA EL SUBTIPO CLIENTE SELECCIONADO -->
    <select id="getTipoClasificacionDefault" parameterClass="java.util.Map" resultClass="string">
         SELECT M.SBTI_OID_SUBT_CLIE || '-' || M.OID_TIPO_CLAS || '-' || V.VAL_I18N 
         FROM   MAE_TIPO_CLASI_CLIEN M, V_GEN_I18N_SICC V 
         WHERE  M.OID_TIPO_CLAS = V.VAL_OID 
           AND  V.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN' 
           AND  V.ATTR_NUM_ATRI = 1 
           AND  V.IDIO_OID_IDIO = 1
		   AND  M.OID_TIPO_CLAS IN (SELECT ING.OID_TIPO_CLASI
									  FROM MAE_CLIEN_INGRE ING, MAE_TIPO_CLIEN TIP, MAE_SUBTI_CLIEN SUB  
									 WHERE ING.COD_TIPO_CLIE = TIP.COD_TIPO_CLIE
									   AND SUB.TICL_OID_TIPO_CLIE = TIP.OID_TIPO_CLIE
									   AND SUB.COD_SUBT_CLIE = ING.COD_SUBT_CLIE
									   AND ING.COD_TIPO_CLIE = #codigoTipoCliente#		    
							           AND ING.COD_SUBT_CLIE = #codigoSubTipoCliente#)
    </select>

    <!-- OBTIENE LA CLASIFICACION DEFAULT PARA EL SUBTIPO CLIENTE SELECCIONADO -->
    <select id="getClasificacionDefault" parameterClass="java.util.Map" resultClass="string">
		SELECT S.OID_CLAS || '-' ||  D.VAL_I18N
		  FROM MAE_CLASI S, V_GEN_I18N_SICC D
		 WHERE S.OID_CLAS = D.VAL_OID
		   AND D.ATTR_ENTI = 'MAE_CLASI'
		   AND D.IDIO_OID_IDIO = 1
           AND D.ATTR_NUM_ATRI = 1		   
		   AND S.OID_CLAS IN (SELECT ING.OID_CLASI
  							    FROM MAE_CLIEN_INGRE ING, MAE_TIPO_CLIEN TIP, MAE_SUBTI_CLIEN SUB  
							   WHERE ING.COD_TIPO_CLIE = TIP.COD_TIPO_CLIE
							     AND SUB.TICL_OID_TIPO_CLIE = TIP.OID_TIPO_CLIE
							     AND SUB.COD_SUBT_CLIE = ING.COD_SUBT_CLIE
							     AND ING.COD_TIPO_CLIE = #codigoTipoCliente#		    
					             AND ING.COD_SUBT_CLIE = #codigoSubTipoCliente#)
    </select>
        
    <!-- OBTIENE EL OID DEL PAIS LOGUEADO -->
    <select id="getOidPais" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_PAIS 
		FROM   SEG_PAIS
		WHERE  COD_PAIS = #codigoPais# 
    </select>

    <!-- OBTIENE LA LONGITUD DEL CLIENTE CONFIGURADO PARA EL PAIS -->
    <select id="getLongitudCodigoCliente" parameterClass="java.util.Map" resultClass="string">
		SELECT NUM_POSI_NUME_CLIE
		FROM   SEG_PAIS   
		WHERE COD_PAIS = #codigoPais# 
    </select>

    <!-- OBTIENE LA LONGITUD DEL CLIENTE CONFIGURADO PARA EL PAIS DE LA ENTIDAD BAS_PAIS-->
    <select id="getLongitudCodigoClien" parameterClass="java.util.Map" resultClass="string">
		SELECT LON_CODI_CLIE 
		FROM bas_pais WHERE 
		cod_pais = #codigoPais# 
    </select>

    <!-- OBTIENE LA LONGITUD DEL NUMERO DE DOCUMENTO DE IDENTIDDAD OBLOGATORIO CONFIGURADO PARA EL PAIS -->
    <select id="getLongitudNumeroDocIdentidad" parameterClass="java.util.Map" resultClass="string">
		SELECT  val_long  FROM MAE_TIPO_DOCUM 
        WHERE 
        OID_TIPO_DOCU=(SELECT OID_TIPO_DOCU
		                FROM
		                    (SELECT OID_TIPO_DOCU
		                      FROM MAE_TIPO_DOCUM,SEG_PAIS
		                     WHERE IND_OBLI = '1'
		                    AND  COD_PAIS = #codigoPais# 
		                       AND PAIS_OID_PAIS = OID_PAIS
		                     ORDER BY COD_TIPO_DOCU)
		                WHERE ROWNUM=1 )		
    </select>
    
    <!-- OBTIENE ESTADOS CIVILES -->
    <select id="getEstadosCiviles" parameterClass="java.util.Map" resultMap="baseResultOids">
	    SELECT CIVIL.OID_ESTA_CIVI AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM MAE_ESTAD_CIVIL CIVIL, V_GEN_I18N_SICC I18N
  	     WHERE CIVIL.OID_ESTA_CIVI = I18N.VAL_OID
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'MAE_ESTAD_CIVIL'
         ORDER BY I18N.VAL_I18N
    </select>

    <!-- OBTIENE TRATAMIENTOS -->
    <select id="getTratamientos" parameterClass="java.util.Map" resultMap="baseResultOids">
	    SELECT TRA.OID_TIPO_TRAT AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM MAE_TIPO_TRATA TRA, V_GEN_I18N_SICC I18N
	     WHERE TRA.OID_TIPO_TRAT = I18N.VAL_OID
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'MAE_TIPO_TRATA'
	     ORDER BY I18N.VAL_I18N 
    </select>
    
    <!-- OBTIENE NIVEL DE ESTUDIOS -->
    <select id="getNivelEstudios" parameterClass="java.util.Map" resultMap="baseResultOids">
  	    SELECT ESTUDIO.OID_NIVE_ESTU AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM MAE_NIVEL_ESTUD ESTUDIO, V_GEN_I18N_SICC I18N
	     WHERE ESTUDIO.OID_NIVE_ESTU = I18N.VAL_OID
	       AND ESTUDIO.PAIS_OID_PAIS = #oidPais#
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'MAE_NIVEL_ESTUD'
	     ORDER BY I18N.VAL_I18N
    </select>    
    
    <!-- OBTIENE NACIONALIDADES -->
    <select id="getNacionalidades" parameterClass="java.util.Map" resultMap="baseResultOids">
  	    SELECT NAC.OID_NACI AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM SEG_NACIO NAC, V_GEN_I18N_SICC I18N
	     WHERE NAC.OID_NACI = I18N.VAL_OID
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'SEG_NACIO'
	     ORDER BY I18N.VAL_I18N
    </select>        

    <!-- OBTIENE TIPOS DE DOCUMENTO DE IDENTIDAD -->
    <select id="getTiposDocumentoIdentidad" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT DOC.OID_TIPO_DOCU AS OID, I18N.VAL_I18N AS DESCRIPCION
		FROM MAE_TIPO_DOCUM DOC, V_GEN_I18N_SICC I18N
		WHERE DOC.PAIS_OID_PAIS = #oidPais#
		  AND I18N.VAL_OID = DOC.OID_TIPO_DOCU
		  AND I18N.ATTR_ENTI = 'MAE_TIPO_DOCUM'
		  AND I18N.IDIO_OID_IDIO = 1
		  
		<isNotEmpty prepend="AND" property="siglaDocumento">
			UPPER(DOC.VAL_SIGL) = UPPER(#siglaDocumento#)        
		</isNotEmpty>  	        

		<isNotEmpty prepend="AND" property="indicadorDocFiscal">
			DOC.IND_DOC_IDEN_FISC = 1        
		</isNotEmpty>  	        
		  
		ORDER BY 2
    </select>

    <!-- OBTIENE EL TIPO DOCUMENTO OBLIGATORIO PARA EL PAIS LOGUEADO -->
    <select id="getTipoDocumentoObligatorio" parameterClass="string" resultClass="string">
	    SELECT OID_TIPO_DOCU
		FROM
			(SELECT OID_TIPO_DOCU
			  FROM MAE_TIPO_DOCUM
			 WHERE IND_OBLI = '1'
			   AND PAIS_OID_PAIS = #value# 
			 ORDER BY COD_TIPO_DOCU)
			WHERE ROWNUM=1 
    </select>

    <!-- OBTIENE EL TIPO DOCUMENTO PARA DUPLA CYZONE PARA EL PAIS LOGUEADO -->
    <select id="getTipoDocumentoDuplaCyzone" parameterClass="string" resultClass="string">
		SELECT OID_TIPO_DOCU
		  FROM MAE_TIPO_DOCUM
		 WHERE COD_TIPO_DOCU = '12' 
		   AND PAIS_OID_PAIS = #value# 
    </select>
    
    <!-- OBTIENE LOS SEXOS -->
    <select id="getSexos" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT 'F' AS OID, 'Femenino' AS DESCRIPCION
		  FROM DUAL
		UNION  
		SELECT 'M' AS OID, 'Masculino' AS DESCRIPCION
		  FROM DUAL  
    </select>    

    <!-- OBTIENE LOS TIPOS VIAS -->
    <select id="getTiposVias" parameterClass="java.util.Map" resultMap="baseResultOids">
  	    SELECT TIPOVIA.OID_TIPO_VIA OID, I18N.VAL_I18N DESCRIPCION
	      FROM SEG_TIPO_VIA TIPOVIA, V_GEN_I18N_SICC I18N
	     WHERE I18N.IDIO_OID_IDIO = 1
	       AND TIPOVIA.OID_TIPO_VIA = I18N.VAL_OID
	       AND I18N.ATTR_ENTI = 'SEG_TIPO_VIA'
	     ORDER BY I18N.VAL_I18N
    </select>    

    <!-- OBTIENE LAS UNIDADES GEOGRAFICAS -->
    <select id="getUnidadesGeograficas" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT ORDE_1 || ORDE_2 || ORDE_3 ||ORDE_4 || ORDE_5 || ORDE_6 AS OID, DES_GEOG AS DESCRIPCION
		FROM ZON_VALOR_ESTRU_GEOPO
		WHERE IND_ACTI = '1'
		  AND PAIS_OID_PAIS = #oidPais#
		<isEqual property="nivel" compareValue="1"> 
        	  AND ORDE_1 IS NOT NULL
        	  AND ORDE_2 IS NULL
		</isEqual>		  
		<isEqual property="nivel" compareValue="2"> 
			  AND ORDE_1 = #orden1# 
        	  AND ORDE_2 IS NOT NULL
        	  AND ORDE_3 IS NULL
		</isEqual>		  
		<isEqual property="nivel" compareValue="3"> 
			  AND ORDE_1 = #orden1# 
			  AND ORDE_2 = #orden2# 
        	  AND ORDE_3 IS NOT NULL
        	  AND ORDE_4 IS NULL
		</isEqual>		  
		<isEqual property="nivel" compareValue="4"> 
			  AND ORDE_1 = #orden1# 
			  AND ORDE_2 = #orden2# 
			  AND ORDE_3 = #orden3# 			  
        	  AND ORDE_4 IS NOT NULL
        	  AND ORDE_5 IS NULL
		</isEqual>		  
		<isEqual property="nivel" compareValue="5"> 
			  AND ORDE_1 = #orden1# 
			  AND ORDE_2 = #orden2# 
			  AND ORDE_3 = #orden3# 			  
			  AND ORDE_4 = #orden4# 			  			  
        	  AND ORDE_5 IS NOT NULL
        	  AND ORDE_6 IS NULL
		</isEqual>		  
		<isEqual property="nivel" compareValue="6"> 
			  AND ORDE_1 = #orden1# 
			  AND ORDE_2 = #orden2# 
			  AND ORDE_3 = #orden3# 			  
			  AND ORDE_4 = #orden4# 			  			  
			  AND ORDE_5 = #orden5# 			  			  			  
        	  AND ORDE_6 IS NOT NULL
        	  AND ORDE_7 IS NULL
		</isEqual>	
		ORDER BY DES_GEOG			  
    </select>    

    <!-- OBTIENE LOS TIPOS VIAS -->
    <select id="getNivelesGeograficos" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT   OID_ESTR_GEOP OID,
		         PQ_APL_AUX.VALOR_GEN_I18N_SICC (1,
		                                         NIV.OID_DIVI_POLI,
		                                         'ZON_NIVEL_GEOGR'
		                                        ) DESCRIPCION
		    FROM ZON_ESTRU_GEOPO EST, ZON_NIVEL_GEOGR NIV
		   WHERE EST.PAIS_OID_PAIS = #oidPais#
		     AND EST.DIPO_OID_DIVI_POLI = NIV.OID_DIVI_POLI
		     AND EST.IND_BORR = '0'
		ORDER BY COD_ORDE
    </select>    

    <!-- OBTIENE EL CLIENTE QUE COINCIDA CON EL TIPO Y NUMERO DE DOCUMENTO DE IDENTIDAD -->
    <select id="getDocumentosCliente" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT IDE.CLIE_OID_CLIE OID, CLIE.COD_CLIE DESCRIPCION
		  FROM MAE_CLIEN_IDENT IDE, MAE_TIPO_DOCUM TD, MAE_CLIEN CLIE
		 WHERE TD.OID_TIPO_DOCU = IDE.TDOC_OID_TIPO_DOCU
		   AND TD.PAIS_OID_PAIS = #oidPais#
		   AND IDE.CLIE_OID_CLIE = CLIE.OID_CLIE
		   AND IDE.TDOC_OID_TIPO_DOCU = #tipoDocumentoIdentidad#
		   AND IDE.NUM_DOCU_IDEN = #numeroDocumentoIdentidad#
    </select>

    <!-- OBTIENE EL NUMERO DE DOCUMENTO PRINCIPAL DEL CLIENTE -->
    <select id="getNumeroDocumentoPrincipal" parameterClass="string" resultClass="string">
		SELECT NUM_DOCU_IDEN
		  FROM MAE_CLIEN_IDENT
		 WHERE CLIE_OID_CLIE = #value# 
		   AND VAL_IDEN_DOCU_PRIN = '1'
    </select>

    <!-- OBTIENE LOS MARCAS DE ENTRADA DE TIPO DE ABONO CCC -->
    <select id="getMarcasTipoAbonoEntrada" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT U.OID_MARC_SITU AS OID, M.TASP_OID_TIPO_ABON_SUBP AS DESCRIPCION
		  FROM CCC_MARCA_SITUA U,
		       CCC_MARCA_TIPO_ABONO M,
		       CCC_TIPO_ABONO_SUBPR T,
		       CCC_SUBPR S,
		       CCC_PROCE P
		 WHERE U.OID_MARC_SITU = M.MASI_OID_MARC_SALI
		   AND M.TASP_OID_TIPO_ABON_SUBP = T.OID_TIPO_ABON_SUBP
		   AND T.SUBP_OID_SUBP = S.OID_SUBP
		   AND S.CCPR_OID_PROC = P.OID_PROC
		   AND S.COD_SUBP = #subprocesoCCC#
		   AND P.COD_PROC = #procesoCCC#
		   AND U.PAIS_OID_PAIS = #oidPais#
		   AND M.IND_ENTR_SALI LIKE 'E'
    </select>

    <!-- OBTIENE IMPORTE DE CUENTAS CASTIGADAS DEL CLIENTE -->
    <select id="getCuentasCastigadasCliente" parameterClass="java.util.Map" resultClass="string">
		SELECT NVL (SUM (IMP_PEND), 0)
		  FROM CCC_MOVIM_CUENT_CORRI
		 WHERE CLIE_OID_CLIE = #oidCliente# 
		 
		<isNotEmpty property="listMarcasEntradas">	
			<iterate prepend="AND" property="listMarcasEntradas" open="(" close=")" conjunction="OR">
      	 		MASI_OID_MARC_SITU = #listMarcasEntradas[]#
            </iterate> 		
		</isNotEmpty>	
			 
	   	<![CDATA[		  
		   AND IMP_MOVI <> IMP_PAGA
	    ]]>		   
    </select>

    <!-- VERIFICA SI EL PAIS SE VA A APLICAR LA VALIDACION DEL MODULO 10 PARA EL DOCUMENTO DE IDENTIDAD -->
    <select id="getPaisModulo10" parameterClass="string" resultClass="string">
		SELECT COUNT(*) 
		FROM   MAE_CLIEN_MODUL_10
		WHERE COD_PAIS = #value#  
    </select>

    <!-- VERIFICA SI EL TIPO DE DOCUMENTO SE APLICA PARA REALIZAR LA VALIDACION DE MODULO 10 -->
    <select id="getTipoDocumentoModulo10" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(*)
		  FROM MAE_TIPO_DOCUM
		 WHERE IND_OBLI = '1'
		   AND PAIS_OID_PAIS = #oidPais#
		   AND OID_TIPO_DOCU = #tipoDocumentoIdentidad# 
    </select>
                    
    <!-- PERMITE SABER SI LA GENERACION DEL CODIGO CLIENTE ES AUTOMATICO O MANUAL -->
    <select id="getCodigoClienteAutomatico" parameterClass="java.util.Map" resultClass="string">
		SELECT COD_TIPO_ASIG
		FROM  MAE_PARAM_CLIEN
		WHERE PAIS_OID_PAIS = #oidPais#
    </select>
                    
    <!-- OBTIENE LOS PESOS POR POSICION PARA LA GENERACION DEL CODIGO DE CLIENTE -->
    <select id="getPesosModulo11" resultMap="baseResultOids">
		SELECT NUM_POSI AS OID, VAL_PESO_APLI AS DESCRIPCION
		  FROM MAE_PESOS_MODUL_11
    </select>

    <!-- OBTIENE EL ULTIMO NUMERO DE SOLICITUD PARA LA GENERACION DEL CODIGO DE CLIENTE -->
    <select id="getUltimoNumeroSolicitud" parameterClass="java.util.Map" resultClass="string">
		SELECT VAL_ULTI_NUME_SOLI 
		  FROM PED_NUMER_SOLIC
		 WHERE COD_PAIS = #codigoPais#  
		   AND VAL_OPER = #codigoOperacion# 
    </select>

    <!-- ACTUALIZAMOS EL ULTIMO NUMERO DE SOLICITUD PARA LA GENERACION DEL CODIGO DE CLIENTE -->
    <update id="updateUltimoNumeroSolicitud" parameterClass="java.util.Map">
		UPDATE PED_NUMER_SOLIC
		   SET VAL_ULTI_NUME_SOLI = #ultimoNumeroSolicitud#  
		 WHERE COD_PAIS = #codigoPais#  
		   AND VAL_OPER = #codigoOperacion# 
    </update>

    <!-- VALIDA SI EXISTE LA ZONA -->
    <select id="getExisteZona" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_ZONA
		 FROM ZON_ZONA
		WHERE PAIS_OID_PAIS = #oidPais#
		  AND COD_ZONA = #codigoZona#
		  AND IND_ACTI = '1'
    </select>

    <!-- VALIDA SI EXISTE EL TERRITORIO -->
    <select id="getExisteTerritorio" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_TERR
		  FROM ZON_TERRI
		 WHERE PAIS_OID_PAIS = #oidPais# 
		   AND COD_TERR = #codigoTerritorio#
		   AND IND_BORR = '0'
    </select>
        
    <!-- VALIDA SI EL TERRITORIO PERTENCE A LA ZONA INGRESADA -->
    <select id="getExisteTerritorioEnZona" parameterClass="java.util.Map" resultClass="string">
		SELECT ADM.OID_TERR_ADMI 
		FROM ZON_TERRI_ADMIN ADM, ZON_TERRI TER, ZON_SECCI SEC
		WHERE ADM.TERR_OID_TERR = TER.OID_TERR
		  AND ADM.PERD_OID_PERI_FINA IS NULL
		  AND ADM.PAIS_OID_PAIS = #oidPais# 
		  AND TER.OID_TERR = #oidTerritorio#
		  AND SEC.OID_SECC = ADM.ZSCC_OID_SECC
		  AND SEC.ZZON_OID_ZONA = #oidZona#
    </select>

    <!-- VALIDA SI EL CODIGO CLIENTE EXISTE -->
    <select id="getExisteCodigoCliente" parameterClass="java.util.Map" resultClass="string">
		SELECT COD_CLIE
		  FROM MAE_CLIEN
		WHERE  PAIS_OID_PAIS = #oidPais#
		  AND  COD_CLIE = #codigoCliente#
    </select>

    <!-- OBTIENE TIPOS DE CLASIFICACION EN BASE AL SUBTIPOCLIENTE -->
    <select id="getTiposClasificaciones" parameterClass="java.util.Map" resultMap="baseResultOids">
         SELECT M.SBTI_OID_SUBT_CLIE || '-' || M.OID_TIPO_CLAS || '-' || V.VAL_I18N OID,  V.VAL_I18N DESCRIPCION
         FROM   MAE_TIPO_CLASI_CLIEN M, V_GEN_I18N_SICC V 
         WHERE  M.OID_TIPO_CLAS = V.VAL_OID 
           AND  V.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN' 
           AND  V.ATTR_NUM_ATRI = 1 
           AND  V.IDIO_OID_IDIO = 1
         		 
		<isNotEmpty property="listSubTipoClientes">	
			<iterate prepend="AND" property="listSubTipoClientes" open="(" close=")" conjunction="OR">
      	 		M.SBTI_OID_SUBT_CLIE = #listSubTipoClientes[]#
            </iterate> 		
		</isNotEmpty>	
		
         ORDER BY 2 
    </select>

    <!-- OBTIENE CLASIFICACIONES DE CLIENTES -->
    <select id="getClasificaciones" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT S.OID_CLAS || '-' ||  D.VAL_I18N AS OID, D.VAL_I18N AS DESCRIPCION
		  FROM MAE_CLASI S, V_GEN_I18N_SICC D, SEG_IDIOM I
		 WHERE S.OID_CLAS = D.VAL_OID
		   AND I.COD_ISO_IDIO = #codigoISO#
		   AND D.IDIO_OID_IDIO = I.OID_IDIO
		   AND D.ATTR_ENTI = 'MAE_CLASI'
		   AND S.TCCL_OID_TIPO_CLAS = #oidTipoClasificacion#
		 ORDER BY D.VAL_I18N
    </select>

    <!-- OBTIENE EL OID DE MARCA -->
    <select id="getOidMarca" parameterClass="string" resultClass="long">
		SELECT OID_MARC 
		FROM   SEG_MARCA
		WHERE  COD_MARC= #value#
    </select> 

    <!-- OBTIENE EL OID DE CANAL -->
    <select id="getOidCanal" parameterClass="string" resultClass="long">
		SELECT OID_CANA 
		FROM   SEG_CANAL
		WHERE  COD_CANA= #value#
    </select>
    
    <!-- OBTIENE EL OID FORMA PAGO DEL PAIS -->
    <select id="getOidFormaPagoPais" parameterClass="string" resultClass="long">
		SELECT FOPA_OID_FORM_PAGO 
		FROM   SEG_PAIS
		WHERE  OID_PAIS = #value#
    </select>

    <!-- OBTIENE EL OID FORMA PAGO POR DEFECTO DEL SUBTIPOCLIENTE -->
    <select id="getOidFormaPagoSubTipoCliente" parameterClass="java.util.Map" resultClass="long">
		SELECT OID_FORM_PAGO 
		  FROM MAE_CONFI_CAMPO C, (SELECT PAG.OID_FORM_PAGO, I18N.VAL_I18N
			      FROM BEL_FORMA_PAGO PAG, V_GEN_I18N_SICC I18N
			     WHERE PAG.OID_FORM_PAGO = I18N.VAL_OID
			       AND I18N.IDIO_OID_IDIO = 1
			       AND I18N.ATTR_ENTI = 'BEL_FORMA_PAGO'
				   AND PAG.PAIS_OID_PAIS = #oidPais#) NAC 
		 WHERE C.PAIS_OID_PAIS = #oidPais# 
		   AND C.SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#
		   AND C.ATRE_OID_ATRI_ESPE = 44
		   AND C.VAL_DEFE = NAC.VAL_I18N
    </select>

    <!-- OBTIENE EL VALOR POR DEFECTO Y SI ES OBLIGATORIO ESE DATO PARA EL CAMPO PASADO COMO PARAMETRO -->
    <select id="getValorConfiCampoSubTipoCliente" parameterClass="java.util.Map" resultClass="string">
	    SELECT C.IND_OBLI || '-' || C.VAL_DEFE 
	      FROM MAE_CONFI_CAMPO C 
		 WHERE C.PAIS_OID_PAIS = #oidPais# 
		   AND C.SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#
		   AND C.ATRE_OID_ATRI_ESPE = #oidCampoConfiguracion#
    </select>
    
    <!-- OBTIENE EL OID DEL TIPO DE DIRECCION -->
    <select id="getOidTipoDireccion" parameterClass="string" resultClass="long">
		SELECT OID_TIPO_DIRE
		  FROM MAE_TIPO_DIREC
		 WHERE COD_TIPO_DIRE = #value#
    </select>
    
    <!-- OBTIENE EL OID DEL TIPO DE COMUNICACION -->
    <select id="getOidTipoComunicacion" parameterClass="string" resultClass="long">
		SELECT OID_TIPO_COMU
		  FROM MAE_TIPO_COMUN
		 WHERE COD_TIPO_COMU = #value#
    </select>    

    <!-- OBTIENE EL OID DEL TIPO DE VINCULO PARA EL PAIS LOGUEADO -->
    <select id="getOidTipoVinculo" parameterClass="java.util.Map" resultClass="long">
	    SELECT OID_TIPO_VINC
	      FROM MAE_TIPO_VINCU 
	     WHERE PAIS_OID_PAIS = #oidPais#
	       AND COD_TIPO_VINC = #codigoTipoVinculo#
    </select>    
    
    <!-- OBTIENE EL CODIGO DE CRITERIO BUSQUEDA 1 -->
    <select id="getCriterioBusqueda1" parameterClass="string" resultClass="string">
		SELECT COD_ATRI
		  FROM PED_ATRIB_ESPEC
		 WHERE OID_ATRI_ESPE IN (SELECT ATRE_OID_ATRI_ESP1
		                           FROM MAE_CRITE_BUSQU
		                          WHERE PAIS_OID_PAIS = #value#)  
    </select>    

    <!-- OBTIENE EL CODIGO DE CRITERIO BUSQUEDA 2 -->
    <select id="getCriterioBusqueda2" parameterClass="string" resultClass="string">
		SELECT COD_ATRI
		  FROM PED_ATRIB_ESPEC
		 WHERE OID_ATRI_ESPE IN (SELECT ATRE_OID_ATRI_ESP2
		                           FROM MAE_CRITE_BUSQU
		                          WHERE PAIS_OID_PAIS = #value#)  
    </select>    
    
    <!-- BUSCA SI EXISTE UN VINCULO DUPLA CYZONE ACTIVO -->
    <select id="getClienteVinculoDuplaCyzone" parameterClass="java.util.Map" resultClass="string">
         SELECT OID_CLIE_VINC 
         FROM   MAE_CLIEN_VINCU 
         WHERE TIVC_OID_TIPO_VINC=(SELECT OID_TIPO_VINC FROM MAE_TIPO_VINCU WHERE COD_TIPO_VINC=#codigoTipoVinculo#)
           AND CLIE_OID_CLIE_VNTE = #oidClienteVinculante#
		<![CDATA[           
           AND FEC_DESD <= TO_DATE(#fechaActual#, 'dd/mm/yyyy') 
	    ]]>           
           AND FEC_HAST IS NULL
    </select>     

    <!-- ACTUALIZAMOS LA FECHA HASTA DEL VINCULO -->
    <update id="updateFechaHastaClienteVinculo" parameterClass="string">
		UPDATE MAE_CLIEN_VINCU
		   SET FEC_HAST = TRUNC (SYSDATE - 1)
		 WHERE OID_CLIE_VINC = #value#
    </update>

    <!-- BUSCA EL SUBTIPOCLIENTE CONSULTORA PARA EL CLIENTE PASADO COMO PARAMETROs -->
    <select id="getClienteSubTipo" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT CLI.OID_CLIE_TIPO_SUBT OID, CLI.SBTI_OID_SUBT_CLIE DESCRIPCION
		  FROM MAE_CLIEN_TIPO_SUBTI CLI, (SELECT OID_TIPO_CLIE
		                             FROM MAE_TIPO_CLIEN
		                             WHERE COD_TIPO_CLIE = #codigoTipoCliente#) TIP 
		 WHERE CLI.CLIE_OID_CLIE = #oidCliente#
		   AND CLI.TICL_OID_TIPO_CLIE = TIP.OID_TIPO_CLIE
    </select>     

    <!-- BUSCA EL OID DEL TIPO DE CLASIFICACION -->
    <select id="getOidTipoClasificacion" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_TIPO_CLAS
		  FROM MAE_TIPO_CLASI_CLIEN 
		 WHERE COD_TIPO_CLAS = #codigoTipoClasificacion#
		   AND SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#
    </select>     
    	
    <!-- BUSCA EL OID DE CLASIFICACION -->
    <select id="getOidClasificacion" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_CLAS
		  FROM MAE_CLASI
		 WHERE COD_CLAS = #codigoClasificacion#
		   AND TCCL_OID_TIPO_CLAS = #oidTipoClasificacion#
    </select>   
	
    <!-- BUSCA EL OID DE CLASIFICACION -->
    <select id="getOidClienteClasificacion" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_CLIE_CLAS
		  FROM MAE_CLIEN_CLASI
		 WHERE CTSU_OID_CLIE_TIPO_SUBT = #oidClienteSubTipo#
		   AND TCCL_OID_TIPO_CLASI = #oidTipoClasificacion#
    </select>   

    <resultMap id="mapUbigeo" class="java.util.HashMap">
    	<result property="ubigeo1"  column="ORDE_1"/>
    	<result property="ubigeo2" 	column="ORDE_2"/>
    	<result property="ubigeo3" 	column="ORDE_3"/>
    	<result property="ubigeo4" 	column="ORDE_4"/>
    	<result property="ubigeo5" 	column="ORDE_5"/>
    	<result property="ubigeo6" 	column="ORDE_6"/>
    </resultMap>

    <!-- BUSCA EL CODIGO UBIGEO RELACIONADO AL TERRITORIO -->
    <select id="getCodigoUbigeo" parameterClass="string" resultMap="mapUbigeo">
		SELECT VAL.ORDE_1 as ORDE_1, 
		       VAL.ORDE_2 as ORDE_2,  
			   VAL.ORDE_3 as ORDE_3, 
			   VAL.ORDE_4 as ORDE_4,
			   VAL.ORDE_5 as ORDE_5,
			   VAL.ORDE_6 as ORDE_6 
		FROM   ZON_VALOR_ESTRU_GEOPO VAL, ZON_TERRI TER
		WHERE  VAL.OID_VALO_ESTR_GEOP = TER.VEPO_OID_VALO_ESTR_GEOP
		  AND  TER.OID_TERR = #value#
    </select>   
    	
    <!-- ELIMINAMOS MENSAJES DE BIENVENIDA Y RECHAZO DE DUPLACYZONE -->
    <delete id="deleteMensajesDuplaCyzone" parameterClass="java.util.Map">
		DELETE FROM MSG_BUZON_MENSA
		      WHERE OID_BUZO_MENS IN (
		               SELECT BUZ.OID_BUZO_MENS
		                 FROM MSG_BUZON_MENSA BUZ,
		                      (SELECT OID_MENS
		                         FROM MSG_MENSA
		                        WHERE COD_MENS IN (#codMsgBienvenidaDuplaCyzone#, #codMsgRechazoDuplaCyzone#)) MSG
		                WHERE BUZ.CLIE_OID_CLIE = #oidCliente#
		                  AND BUZ.MENS_OID_MENS = MSG.OID_MENS
		                  AND IND_ACTI = '1')
    </delete>
    	
    <!-- BUSCA EL OID TIPOSUBTIPO RELACIONADO AL CODIGO CLIENTE 'MIGRACION' -->
    <select id="getOidClienteTipoSubTipoMigracion" parameterClass="string" resultClass="long">
		SELECT SUB.OID_CLIE_TIPO_SUBT
		  FROM MAE_CLIEN CLI, MAE_CLIEN_TIPO_SUBTI SUB
		 WHERE CLI.COD_CLIE = 'MIGRACION'
		   AND SUB.CLIE_OID_CLIE = CLI.OID_CLIE
		   AND CLI.PAIS_OID_PAIS = #value#
    </select>      	
    	
    <!-- OBTIENE LA LONGITUD DEL TIPO DE DOCUMENTO DE IDENTIDAD SELECCIONADO -->
    <select id="getLongitudTipoDocumento" parameterClass="java.util.Map" resultClass="string">
		SELECT VAL_LONG 
		  FROM MAE_TIPO_DOCUM
		 WHERE PAIS_OID_PAIS = #oidPais#
		   AND OID_TIPO_DOCU = #oidTipoDocumento# 
    </select>    
        	
    <!-- OBTIENE NEXT OID PARA LA TABLA MAE_CLIEN -->
	 <select id="getSecuenciaNextValueCliente" resultClass="long">
          SELECT MAE_CLIE_SEQ.NEXTVAL FROM DUAL
    </select>

    <!-- OBTIENE NEXT OID PARA LA TABLA MAE_CLIEN_TIPO_SUBTI -->
	 <select id="getSecuenciaNextValueSubTipo" resultClass="long">
          SELECT MAE_CTSU_SEQ.NEXTVAL FROM DUAL
    </select>

    <!-- OBTIENE NEXT OID PARA LA TABLA MAE_CLIEN_CLASI -->
	 <select id="getSecuenciaNextValueClasificacion" resultClass="long">
          SELECT MAE_CLCL_SEQ.NEXTVAL FROM DUAL       
    </select>

    <!-- OBTIENE NEXT OID PARA LA TABLA MAE_CLIEN_HISTO_ESTAT -->
	 <select id="getSecuenciaNextValueHistoricoStatus" resultClass="long">
          SELECT MAE_CLHE_SEQ.NEXTVAL FROM DUAL                       
    </select>

    <insert id="insertCliente" parameterClass="clienteBasico">
		INSERT INTO MAE_CLIEN
            (OID_CLIE, COD_CLIE, IND_FICH_INSC, PAIS_OID_PAIS, COD_DIGI_CTRL,
             VAL_APE1, VAL_APE2, VAL_NOM1, VAL_NOM2, VAL_TRAT, VAL_CRIT_BUS1,
             VAL_CRIT_BUS2, 
             COD_SEXO,
             FEC_INGR,
             FOPA_OID_FORM_PAGO, 
             VAL_APEL_CASA,
             COD_CLIE_ANTE,
             USU_MODI,
             IND_ORIG_REGI,
             USU_CREA
            )
	     VALUES 
	     	(#oid#, #codigo#, #indicadorFichaInscripcion#, #oidPais#, #digitoControl#,
             #apellido1#, #apellido2#, #nombre1#, #nombre2#, #tratamiento#, #criterioBusqueda1#,
             #criterioBusqueda2#, 
             #sexo#,
             #fechaIngreso#,
             #oidFormaPago#, 
             #apellidoCasada#,
             #codigoAnterior#,
             #usuarioModifica#,
             #indicadorOrigen#,
             #auditInfo.createdBy#
            )
    </insert>

    <insert id="insertClienteAdicional" parameterClass="clienteAdicional">
		INSERT INTO MAE_CLIEN_DATOS_ADICI
            (CLIE_OID_CLIE, NSEP_OID_NSEP, OID_CLIE_DATO_ADIC, COD_EMPL,
             FEC_NACI, VAL_EDAD, VAL_OCUP, VAL_PROF, VAL_CENT_TRAB,
             VAL_CARG_DESE, VAL_CENT_ESTU, VAL_NIVE_SOCI_ECO3, NUM_HIJO,
             NUM_PERS_DEPE, NUM_CAMP_SIN_PEDI, IMP_INGR_FAMI,
             IMP_MONT_LINE_CRED, NIRI_OID_NIVE_RIES, NIED_OID_NIVE_ESTU,
             SNON_OID_NACI, ESCV_OID_ESTA_CIVI, PERD_OID_PERI_NIVE_RIES,
             PERD_OID_PERI_LINE_CRED, IND_CORR, IND_ACTI, ESTA_OID_ESTA_CLIE,
             TCLV_OID_CICL_VIDA, VAL_EMAI, TCUT_OID_TIPO_CUTI, OTMA_OID_OTRA_MARC,
             COD_CUB,IND_COMP,VAL_MOTI_COMP,IND_IMPR_PDOC,
             COD_GRUP_FUNC,DES_GRUP_FUNC,VAL_USUA_RED,VAL_RELA_CONT,COD_CUB_JEFE,
             VAL_NOM_JEFE, VAL_PUE_ORG ,USU_CARG ,FEC_CARG,TIP_CARG ,IND_IMPR_DOCU,
             FEC_CREA, USU_CREA, IND_DOC_FISC, TPES_OID_TIPO_PERS, ORIN_OID_ORIG_INGR,NUM_CUEN_BANC, IND_GENE_PERC, BTCU_COD_TIPO_CUEN, BBPA_COD_BANC_PAGA                  		
            )
	     VALUES 
	     	(#oidCliente#, #oidNivelSocioEconomico#, MAE_CLDA_SEQ.NEXTVAL, #codigoEmpleado#,
             trunc(#fechaNacimiento#), #edad#, #ocupacion#, #profesion#, #centroTrabajo#,
             #cargo#, #centroEstudios#, #nivelSocioEconomico3#, #numeroHijos#,
             #numeroDependientes#, #numeroCampanasSinPedido#, #ingresoFamiliar#,
             #montoLineaCredito#, #oidNivelRiesgo#, #oidNivelEstudios#,
             #oidNacionalidad#, #oidEstadoCivil#, #oidPeriodoNivelRiesgo#,
             #oidPeriodoLineaCredito#, #indicadorCorrespondencia#, #indicadorActivo#, #oidEstatusCliente#,
             #oidCicloVida#, #email#, #oidTipoCutis#, #oidOtrasMarcas#,
             #codigoCUB#,#indicadorCompromiso#,#motivo#,#indicadorImpresionPaqDoc#,
             #codGrupoFuncional#,#desGrupoFuncional#,#usuRed#,#valRelContr#,#codJefeCUB#,
             #nomJefeDir#,#valPueOrg#,#usuCarg#,SYSDATE,#tipCarg#,#indImprDocu#,
             SYSDATE,#auditInfo.createdBy#,#indDocFiscal#, #valTipoPersona#, #valOrigenIngreso#,
             #valCuentaCorriente#, #indicadorCalularPercepcion#, #valTipoCuenta#, #valBanco#         
            )
    </insert>

    <insert id="insertClientePrimerContacto" parameterClass="clientePrimerContacto">
		INSERT INTO MAE_CLIEN_PRIME_CONTA
            (OID_CLIE_PRIM_CONT, 
             CLIE_OID_CLIE, 
             CTSU_CLIE_CONT,
             FEC_CONT,
             FEC_SIGU_CONT,
             COD_TIPO_CONT, 
             MARC_OID_MARC, 
             CANA_OID_CANA, 
             PERD_OID_PERI,
             FEC_CREA,
             USU_CREA
            )
	     VALUES 
	     	(MAE_CPRC_SEQ.NEXTVAL, 
	     	 #oidCliente#, 
	     	 #oidClienteSubTipo#,
	     	 <isNotEmpty property="sFechaContacto">
             	#sFechaContacto#,
             </isNotEmpty>
             <isEmpty property="sFechaContacto">
             	#fechaContacto#,
             </isEmpty>
             <isNotEmpty property="sFechaSiguienteContacto">
             	#sFechaSiguienteContacto#,
             </isNotEmpty>
             <isEmpty property="sFechaSiguienteContacto">
             	#fechaSiguienteContacto#,
             </isEmpty>
             #codigoTipoContacto#, 
             #oidMarca#, 
             #oidCanal#, 
             #oidPeriodo#,
             SYSDATE,
             #auditInfo.createdBy#
            )
    </insert>
    		
    <insert id="insertClienteSubTipo" parameterClass="clienteSubTipo">
		INSERT INTO MAE_CLIEN_TIPO_SUBTI
            (OID_CLIE_TIPO_SUBT, 
             CLIE_OID_CLIE, 
             TICL_OID_TIPO_CLIE,
             SBTI_OID_SUBT_CLIE, 
             IND_PPAL,
             FEC_CREA,
             USU_CREA
            )
	     VALUES 
	     	(#oid#, 
	     	 #oidCliente#, 
	     	 #oidTipoCliente#,
             #oidSubTipoCliente#, 
             #indicadorPrincipal#,
             SYSDATE,
             #auditInfo.createdBy#
            )
    </insert>
    	
    <insert id="insertClienteClasificacion" parameterClass="clienteClasificacion">
		INSERT INTO MAE_CLIEN_CLASI
            (OID_CLIE_CLAS, 
			 CTSU_OID_CLIE_TIPO_SUBT, 
			 CLAS_OID_CLAS,
             PERD_OID_PERI, 
			 TCCL_OID_TIPO_CLASI,
             FEC_CLAS, 
			 IND_PPAL,
			 USU_MODI,
             FEC_CREA,
             USU_CREA			 
            )
     	VALUES 
     		(#oid#, 
	         #oidClienteSubTipo#, 
			 #oidClasificacion#,
             #oidPeriodo#, 
			 #oidTipoClasificacion#,
             TRUNC(#fechaClasificacion#), 
			 #indicadorPrincipal#,
			 #codigoUsuario#,
             SYSDATE,
             #auditInfo.createdBy#			 
			)
    </insert>
        
    <insert id="insertClienteIdentificacion" parameterClass="clienteIdentificacion">
		INSERT INTO MAE_CLIEN_IDENT
            (OID_CLIE_IDEN, 
             TDOC_OID_TIPO_DOCU, 
             CLIE_OID_CLIE, 
             NUM_DOCU_IDEN,
             VAL_IDEN_DOCU_PRIN, 
             VAL_IDEN_PERS_EMPR,
             SBTD_COD_SUBT_DOCU,
             USU_MODI,
             FEC_CREA,
             USU_CREA             
            )
     	VALUES 
     		(MAE_CLID_SEQ.NEXTVAL, 
     		 #oidTipoDocumento#, 
     		 #oidCliente#, 
     		 #numeroDocumento#,
             #indicadorPrincipal#, 
             #identificadorPersonal#,
             #codigoSubtipoDocumento#,
             #codigoUsuario#,
             SYSDATE,
             #auditInfo.createdBy#             
            )

    </insert>        	

    <insert id="insertClienteDireccion" parameterClass="clienteDireccion">
		INSERT INTO MAE_CLIEN_DIREC
            (OID_CLIE_DIRE, CLIE_OID_CLIE, TIDC_OID_TIPO_DIRE,
             TIVI_OID_TIPO_VIA, TERR_OID_TERR, ZVIA_OID_VIA, NUM_PPAL,
             VAL_NOMB_VIA, VAL_COD_POST, VAL_INTE, VAL_MANZ, VAL_LOTE,
             VAL_KM, VAL_OBSE, VAL_NOMB_FICH, VAL_COOR_X, VAL_COOR_Y,
             VAL_COOR_Z, IND_DIRE_PPAL, IND_CTRL_INTE_GEOR,
             COD_UNID_GEOG, IND_ELIM, VAL_BARR, 
             CIUD_COD_CIUD, CIUD_COD_UGEO_REGI, 
             
             <isNotEmpty property="codigoPeriodoInicio">
             	PERD_OID_CAMP_INIC,
             </isNotEmpty>
             <isNotEmpty property="codigoPeriodoFin">
             	PERD_OID_CAMP_FINA,
             </isNotEmpty>
             
             DES_VILLA_POBL,
             USU_MODI,
             ZCAL_COR_ZCAL,
             FEC_CREA,
             USU_CREA,
             VAL_ETA_CONJ,
             VAL_CAL_PRIN,
             VAL_CAL_SECU,
             VAL_NOM_MANZ,
             TECO_COD_TERR_CORR             
            )
	     VALUES 
	        (MAE_CLDI_SEQ.NEXTVAL, #oidCliente#, #oidTipoDireccion#,
             #oidTipoVia#, #oidTerritorio#, #oidVia#, #numeroPrincipal#,
             #nombreVia#, #codigoPostal#, #interior#, #manzana#, #lote#,
             #kilometro#, #observaciones#, #nombreFichero#, #coordenadaX#, #coordenadaY#,
             #coordenadaZ#, #indicadorDireccionPrincipal#, #indicadorEstandarizacionGIS#,
             #codigoUnidadGeografica#,#indicadorEliminacion#, #barrio#,
             #codigoCiudad#,#codigoUbigeo1#,
             
             <isNotEmpty property="codigoPeriodoInicio">
             	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoInicio#),
             </isNotEmpty>
             <isNotEmpty property="codigoPeriodoFin">	
             	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoFin#),
             </isNotEmpty>
             
             #villaPoblacion#,
             #codigoUsuario#,
             #correVia#,
             SYSDATE,
             #auditInfo.createdBy#,
             #valEtapaConjunto#,
             #valCallePrincipal#,
             #valCalleSecundaria#,
             #valNomManzana#,
             #valCodigoTerritorialCorresponde#           
            )

    </insert>     
    
    <insert id="insertClienteDireccionCamposAdicionalesActivo" parameterClass="clienteDireccion">
		INSERT INTO MAE_CLIEN_DIREC
            (OID_CLIE_DIRE, CLIE_OID_CLIE, TIDC_OID_TIPO_DIRE,
             TIVI_OID_TIPO_VIA, TERR_OID_TERR, ZVIA_OID_VIA, NUM_PPRI,
             VAL_NOMB_VIA, VAL_COD_POST, VAL_INTE, VAL_MANZ, VAL_LOTE,
             VAL_KM, VAL_OBSE, VAL_NOMB_FICH, VAL_COOR_X, VAL_COOR_Y,
             VAL_COOR_Z, IND_DIRE_PPAL, IND_CTRL_INTE_GEOR,
             COD_UNID_GEOG, IND_ELIM, VAL_BARR, 
             CIUD_COD_CIUD, CIUD_COD_UGEO_REGI, 
             
             <isNotEmpty property="codigoPeriodoInicio">
             	PERD_OID_CAMP_INIC,
             </isNotEmpty>
             <isNotEmpty property="codigoPeriodoFin">
             	PERD_OID_CAMP_FINA,
             </isNotEmpty>
             
             DES_VILLA_POBL,
             USU_MODI,
             ZCAL_COR_ZCAL,
             FEC_CREA,
             USU_CREA,
             VAL_ETA_CONJ,
             VAL_CAL_PRIN,
             VAL_CAL_SECU,
             VAL_NOM_MANZ,
             TECO_COD_TERR_CORR             
            )
	     VALUES 
	        (MAE_CLDI_SEQ.NEXTVAL, #oidCliente#, #oidTipoDireccion#,
             #oidTipoVia#, #oidTerritorio#, #oidVia#, #numeroPrincipal#,
             '',
             #codigoPostal#, #interior#, #manzana#, #lote#,
             #kilometro#, #observaciones#, #nombreFichero#, #coordenadaX#, #coordenadaY#,
             #coordenadaZ#, #indicadorDireccionPrincipal#, #indicadorEstandarizacionGIS#,
             #codigoUnidadGeografica#,#indicadorEliminacion#, #barrio#,
             #codigoCiudad#,#codigoUbigeo1#,
             
             <isNotEmpty property="codigoPeriodoInicio">
             	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoInicio#),
             </isNotEmpty>
             <isNotEmpty property="codigoPeriodoFin">	
             	GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoFin#),
             </isNotEmpty>
             
             #villaPoblacion#,
             #codigoUsuario#,
             #correVia#,
             SYSDATE,
             #auditInfo.createdBy#,
             #valEtapaConjunto#,
             #valCallePrincipal#,
             #valCalleSecundaria#,
             #valNomManzana#,
             #valCodigoTerritorialCorresponde#           
            )

    </insert>        		
	
    <insert id="insertClienteUnidadAdministrativa" parameterClass="clienteUnidadAdministrativa">
		INSERT INTO MAE_CLIEN_UNIDA_ADMIN
            (OID_CLIE_UNID_ADMI, 
             CLIE_OID_CLIE, 
             PERD_OID_PERI_INI,
             PERD_OID_PERI_FIN, 
             ZTAD_OID_TERR_ADMI, 
             IND_ACTI,
             USU_MODI,
             <isNotEmpty property="indicadorCambio">
             	FEC_CAMB,
             </isNotEmpty>
             FEC_CREA,
             USU_CREA                          
            )
     	VALUES 
     	    (MAE_CUAD_SEQ.NEXTVAL, 
     	     #oidCliente#, 
     	     #periodoInicio#,
             #periodoFin#, 
             #oidTerritorioAdministrativo#,
             #indicadorActivo#,
             #codigoUsuario#,
             <isNotEmpty property="indicadorCambio">
             	SYSDATE,
             </isNotEmpty>
             SYSDATE,
             #auditInfo.createdBy#             
            )
            
    </insert>        	
        
    <insert id="insertClienteComunicacion" parameterClass="clienteComunicacion">
		INSERT INTO MAE_CLIEN_COMUN
            (OID_CLIE_COMU, 
             CLIE_OID_CLIE, 
             TICM_OID_TIPO_COMU, 
             VAL_DIA_COMU,
             VAL_TEXT_COMU, 
             FEC_HORA_DESD, 
             FEC_HORA_HAST, 
             VAL_INTE_COMU,
             IND_COMU_PPAL,
             USU_MODI,
             FEC_CREA,
             USU_CREA             
            )
     	VALUES 
     	    (MAE_CLCO_SEQ.NEXTVAL, 
     	     #oidCliente#, 
     	     #oidTipoComunicacion#, 
     	     #diaComunicacion#,
             #textoComunicacion#, 
             #fechaDesde#,
             #fechaHasta#, 
             #intervaloComunicacion#,
             #indicadorPrincipal#,
             #codigoUsuario#,
             SYSDATE,
             #auditInfo.createdBy#             
            )
            
    </insert>        	

    <insert id="insertClienteVinculo" parameterClass="clienteVinculo">
		INSERT INTO MAE_CLIEN_VINCU
            (OID_CLIE_VINC,
             FEC_DESD,
             FEC_HAST,
			 CLIE_OID_CLIE_VNDO, 
             CLIE_OID_CLIE_VNTE, 			 
			 TIVC_OID_TIPO_VINC,
             IND_VINC_PPAL,
             FEC_ULTI_ACTU,
             FEC_CREA,
             USU_CREA             
            )
	     VALUES 
	        (MAE_CVIN_SEQ.NEXTVAL,
             #fechaDesde#,
             #fechaHasta#,
             #oidCliente#, 
			 #oidClienteVinculante#, 
			 #oidTipoVinculo#,
             #indicadorPrincipal#,
             #fechaActualizacion#,
             SYSDATE,
             #auditInfo.createdBy#             
            )            
    </insert>

    <insert id="insertClienteMarca" parameterClass="clienteMarca">
		INSERT INTO MAE_CLIEN_MARCA
            (OID_CLIE_MARC, 
			 CLIE_OID_CLIE, 
			 MARC_OID_MARC, 
			 IND_PPAL
            )
	     VALUES 
	 		(MAE_CLMR_SEQ.NEXTVAL, 
			 #oidCliente#, 
			 #oidMarca#, 
			 #indicadorPrincipal#
            )
    </insert>

    <insert id="insertClienteObservacion" parameterClass="clienteObservacion">
		INSERT INTO MAE_CLIEN_OBSER
            (OID_OBSE, 
			 MARC_OID_MARC, 
			 CLIE_OID_CLIE, 
			 NUM_OBSE, 
			 VAL_TEXT
            )
	     VALUES 
	     	(MAE_CLOB_SEQ.NEXTVAL, 
	 		 #oidMarca#, 
			 #oidCliente#, 
			 #numeroObservacion#, 
			 #texto#
            )
    </insert>

    <insert id="insertClienteHistoricoEstatus" parameterClass="clienteHistoricoEstatus">
		INSERT INTO MAE_CLIEN_HISTO_ESTAT
            (OID_HIST_ESTA, 
			 PERD_OID_PERI, 
			 CLIE_OID_CLIE,
             PERD_OID_PERI_PERI_FIN, 
			 ESTA_OID_ESTA_CLIE,
			 FEC_CREA,
			 USU_CREA
            )
	     VALUES 
	        (#oid#, 
	         #oidPeriodo#, 
			 #oidCliente#,
             #oidPeriodoFin#, 
			 #oidEstatus#,
			 SYSDATE,
			 #auditInfo.createdBy#
            )
    </insert>
    
    <insert id="insertHistoricoClasificacion" parameterClass="historicoClasificacion">
		INSERT INTO MAE_HISTO_CLASI
            (OID_HIST_CLAS, 
			 CLHE_OID_HIST_ESTA, 
			 CLAS_OID_CLAS,
			 FEC_CREA,
			 USU_CREA
            )
	     VALUES 
	        (MAE_HTCL_SEQ.NEXTVAL, 
	         #oidClienteHistoricoEstatus#, 
			 #oidClasificacion#,
			 SYSDATE,
			 #auditInfo.createdBy#
            )
    </insert>
	
	<resultMap id="datosBasicoClienteByCriteriaResult"   class="java.util.HashMap">
	    <result property="codigo" 							  column="codigo"/>
		<result property="apellido1" 						  column="apellido1"/>
		<result property="apellido2" 						  column="apellido2"/>
		<result property="nombre1" 							  column="nombre1"/>
		<result property="nombre2" 							  column="nombre2"/>
		<result property="codigoZona" 					  	  column="codigoZona"/>
		<result property="documentoIdentidad"			  	  column="documentoIdentidad"/>
		<result property="indicadorActiva" 					  column="indicadorActiva"/>
		<result property="oidCliente"						  column="oidCliente"/>
  </resultMap>
        
    <!-- OBTIENE LISTA DE CLIENTES QUE CUMPLAN CON EL FILTRO DE BUSQUEDA -->
    <select id="getClientesByCriteria" parameterClass="java.util.Map" resultMap="datosBasicoClienteByCriteriaResult">
		SELECT codigo, 
		       nombre1, 
			     nombre2, 
			     apellido1, 
			     apellido2,
			     codigoZona,
			     documentoIdentidad,
			     indicadorActiva,
			     oidCliente
					FROM (SELECT ROWNUM, codigo, nombre1, nombre2, apellido1, apellido2,
		                codigoZona, documentoIdentidad, indicadorActiva, oidCliente
						  FROM(
							  SELECT DISTINCT c.cod_clie  codigo,
								 	              c.val_nom1  nombre1,
							                  c.val_nom2  nombre2,
							                  c.val_ape1  apellido1,
							                  c.val_ape2  apellido2,
									              zz.des_zona codigoZona,
									              i.num_docu_iden documentoIdentidad,
									              decode(da.ind_acti, 0, 'NO', 'SI') indicadorActiva,
					                      c.oid_clie oidCliente
							  FROM MAE_CLIEN c,
								 MAE_CLIEN_IDENT i ,
								 MAE_CLIEN_DATOS_ADICI da,
								 MAE_CLIEN_TIPO_SUBTI ts,
								 MAE_CLIEN_UNIDA_ADMIN ua,
								 ZON_TERRI_ADMIN zta,
								 ZON_TERRI zt,
								 ZON_ZONA  zz,
								 ZON_SECCI zs
							 WHERE c.PAIS_OID_PAIS = #oidPais#
							  AND i.CLIE_OID_CLIE = c.OID_CLIE
							  AND da.CLIE_OID_CLIE = c.OID_CLIE
							  AND ts.CLIE_OID_CLIE = c.OID_CLIE
							  AND ua.IND_ACTI='1'
  									<isNotEmpty prepend="AND" property="codigoCliente">        
										c.COD_CLIE LIKE #codigoCliente#
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre1">        
										UPPER(c.VAL_NOM1) LIKE UPPER(#nombre1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre2">        
										UPPER(c.VAL_NOM2) LIKE UPPER(#nombre2#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido1">        
										UPPER(c.VAL_APE1) LIKE UPPER(#apellido1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido2">        
										UPPER(c.VAL_APE2) LIKE UPPER(#apellido2#)
									  </isNotEmpty>  
									  <isNotEmpty prepend="AND" property="criterioBusqueda1">        
										UPPER(c.VAL_CRIT_BUS1) LIKE UPPER(#criterioBusqueda1#)
									  </isNotEmpty> 
									  <isNotEmpty prepend="AND" property="criterioBusqueda2">        
										UPPER(c.VAL_CRIT_BUS2) LIKE UPPER(#criterioBusqueda2#)
									  </isNotEmpty>             
									  <isNotEmpty prepend="AND" property="documentoIdentidad">        
										UPPER(i.NUM_DOCU_IDEN) LIKE UPPER(#documentoIdentidad#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="codigoZona">        
											zz.COD_ZONA = #codigoZona#
									  </isNotEmpty>
		  				 AND i.VAL_IDEN_DOCU_PRIN=1
							 AND ua.CLIE_OID_CLIE = c.OID_CLIE
							 AND ua.ZTAD_OID_TERR_ADMI =zta.OID_TERR_ADMI
							 AND zta.PAIS_OID_PAIS=c.PAIS_OID_PAIS
							 AND zs.OID_SECC = zta.ZSCC_OID_SECC
							 AND zt.OID_TERR = zta.TERR_OID_TERR
							 AND zt.PAIS_OID_PAIS =c.PAIS_OID_PAIS
							 AND zz.OID_ZONA = zs.ZZON_OID_ZONA
						UNION ALL
							  SELECT DISTINCT c.cod_clie codigo,						   			  
								 	  		c.val_nom1 nombre1,
							          c.val_nom2 nombre2,
							          c.val_ape1 apellido1,
							          c.val_ape2 apellido2,
									  		''         codigoZona,
					              i.num_docu_iden documentoIdentidad,
									      decode(da.ind_acti, 0, 'NO', 'SI') indicadorActiva,
									      c.oid_clie oidCliente
							  FROM MAE_CLIEN c,
								 MAE_CLIEN_IDENT i ,
								 MAE_CLIEN_DATOS_ADICI da,
								 MAE_CLIEN_TIPO_SUBTI ts
							 WHERE c.PAIS_OID_PAIS = #oidPais#
							  AND i.CLIE_OID_CLIE = c.OID_CLIE
							  AND da.CLIE_OID_CLIE = c.OID_CLIE
							  AND ts.CLIE_OID_CLIE = c.OID_CLIE
  									<isNotEmpty prepend="AND" property="codigoCliente">
										c.COD_CLIE LIKE #codigoCliente#
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre1">
										UPPER(c.VAL_NOM1) LIKE UPPER(#nombre1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre2">
										UPPER(c.VAL_NOM2) LIKE UPPER(#nombre2#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido1">
										UPPER(c.VAL_APE1) LIKE UPPER(#apellido1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido2">
										UPPER(c.VAL_APE2) LIKE UPPER(#apellido2#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="documentoIdentidad">
										UPPER(i.NUM_DOCU_IDEN) LIKE UPPER(#documentoIdentidad#)
									  </isNotEmpty>
		  					    AND i.VAL_IDEN_DOCU_PRIN=1
								 AND c.OID_CLIE NOT IN (
								 	 SELECT  ua.CLIE_OID_CLIE
									 FROM  MAE_CLIEN_UNIDA_ADMIN ua
									 WHERE ua.CLIE_OID_CLIE = c.OID_CLIE)
							     AND   #codigoZona# IS NULL
							 )
						)
  	<![CDATA[
		WHERE ROWNUM < 501
	    ]]>
    </select>
    
   	<resultMap id="datosDireccionesClienteByCriteriaResult"   class="java.util.HashMap">
	    <result property="tipoVia" 							  column="TIPO_VIA"/>
	    <result property="codigotipoVia" 							  column="COD_TIPO_VIA"/>
		<result property="nombreVia" 						  column="NOMBRE_VIA"/>
		<result property="correlativoVia" 						  column="CORRE_VIA"/>		
 	</resultMap>
     <select id="getDireccionesClientesByCriteria" parameterClass="java.util.Map" resultMap="datosDireccionesClienteByCriteriaResult">
     	SELECT 
     	I18N.VAL_I18N TIPO_VIA, 
     	I18N.val_oid COD_TIPO_VIA ,
     	ZN.NOM_CALL AS NOMBRE_VIA,
     	ZN.COR_ZCAL AS CORRE_VIA
     	FROM ZON_CALLE ZN, ZON_VALOR_ESTRU_GEOPO ZG, V_GEN_I18N_SICC I18N
			WHERE 
			ZN.VEPO_OID_VALO_ESTR_GEOP = ZG.OID_VALO_ESTR_GEOP
			AND I18N.ATTR_ENTI = 'SEG_TIPO_VIA'
			AND ZN.TIVI_OID_TIPO_VIA = I18N.VAL_OID
			AND I18N.IDIO_OID_IDIO = 1
			AND ZG.IND_ACTI = 1
			AND ZN.EST_REGI = 1
			AND ZN.PAIS_COD_PAIS = #codPais#
			AND ZG.ORDE_1 = #nivel1#
			AND ZG.ORDE_2 = #nivel2#
			AND ZG.ORDE_3 = #nivel3#
			AND ZG.ORDE_5 IS NULL
			AND ZG.ORDE_6 IS NULL
			AND ZG.ORDE_7 IS NULL
			AND ZG.ORDE_8 IS NULL
			AND ZG.ORDE_9 IS NULL
			<isNotEmpty prepend="AND" property="tipoVia"> ZN.TIVI_OID_TIPO_VIA = #tipoVia# </isNotEmpty>
			<isNotEmpty prepend="AND" property="nombreVia"> ZN.NOM_CALL LIKE '%'||#nombreVia#||'%' </isNotEmpty>
	   ORDER BY I18N.val_oid, ZN.NOM_CALL
     </select>
     
    <!-- VALIDA SI EL CODIGO CLIENTE EXISTE -->
    <select id="getExisteCodigoClienteByCodPais" parameterClass="java.util.Map" resultClass="clienteBasico">
		SELECT  COD_CLIE codigo, 
				VAL_NOM1 nombre1, 
				VAL_NOM2 nombre2, 
				VAL_APE1 apellido1, 
				VAL_APE2 apellido2,
				OID_CLIE oid,
		        (SELECT COUNT (*) FROM MAE_CLIEN_TIPO_SUBTI S , MAE_TIPO_CLIEN T
		          WHERE S.CLIE_OID_CLIE = M.OID_CLIE
		            AND S.TICL_OID_TIPO_CLIE = T.OID_TIPO_CLIE
		            AND T.COD_TIPO_CLIE = '02') oidFormaPago
		  FROM MAE_CLIEN M
		WHERE  M.PAIS_OID_PAIS = #oidPais#
		  AND  M.COD_CLIE = #codigoCliente#
    </select>  
     
     <!-- Devuelve La edad Minima -->
    <select id="getEdadMinima" parameterClass="java.util.Map" resultClass="string">
		select VAL_EDAD_MINI 
		from MAE_CLIEN_EDAD
		WHERE PAIS_OID_PAIS = #oidPais#
		  AND SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#
    </select>
 	
 	<!-- Devuelve La edad Maxima -->
    <select id="getEdadMaxima" parameterClass="java.util.Map" resultClass="string">
		select VAL_EDAD_MAXI 
		from MAE_CLIEN_EDAD
		WHERE PAIS_OID_PAIS = #oidPais#
	  	  AND SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#
    </select>	 
           
    <!-- Devuelve data si existe un mensaje para ese cliente -->
    <select id="getExisteMensajeBuzon" parameterClass="java.util.Map" resultClass="string">
		SELECT  oid_buzo_mens
		FROM    msg_buzon_mensa 
		WHERE   clie_oid_clie = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoCliente#)
			AND mens_oid_mens in (select oid_mens from msg_mensa where cod_mens in ('MAE02','MAE03'))
			AND ind_acti = 1				
    </select>       
    
    <insert id="insertBuzonMensajes" parameterClass="java.util.Map">
    	INSERT INTO MSG_BUZON_MENSA
    		(OID_BUZO_MENS ,
			 MENS_OID_MENS,
			 CLIE_OID_CLIE,
			 MODU_OID_MODU_ORIG ,
			 FEC_GRAB,
			 IND_ACTI,    
			 IND_LIST_CONS,
			 NUM_SECU,
			 DATO_VARI_01,
			 DATO_VARI_02)
		VALUES(MSG_BUME_SEQ.NEXTVAL, 
		      (SELECT OID_MENS FROM MSG_MENSA WHERE COD_MENS =#codigoMensaje#),
		      <isNotEmpty property="codigoCliente">
			     GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoCliente#),
			  </isNotEmpty>  
			  <isNotEmpty property="oidCliente">
			     #oidCliente#,
			  </isNotEmpty>  
			   #oidModuloOrigen#,
			   SYSDATE,
			   1,
			   0,
			   MSG_BUM2_SEQ.NEXTVAL,
			   #datoVariable01#,
			   #datoVariable02#)
    </insert>
    
    <select id="getConcursos" parameterClass="java.util.Map" resultClass="concurso">
         SELECT oidConcurso,
                numeroConcurso,
                nombreConcurso,
                periodoDesde,
                periodoHasta,
                numeroNivel,
                numeroNivelSelectivo,
                totalGeografico,
                codigoZona,
                tipopremio
         FROM                 
			(SELECT cpg.oid_para_gral   oidConcurso, 
			       cpg.num_conc        numeroConcurso,
			       cpg.val_nomb        nombreConcurso, 
				   speridesde.cod_peri periodoDesde,
			       sperihasta.cod_peri periodoHasta,
			       pgp.num_nive	   numeroNivel,
			       pgp.TPRM_OID_TIPO_PION tipopremio, 
			       (SELECT COUNT(1) from INC_PARAM_NIVEL_PREMI WHERE PAGP_OID_PARA_GENE_PREM = pgp.OID_PARA_GENE_PREM 
			           AND VAL_NIVE_SELE = 1) numeroNivelSelectivo,
			       (SELECT COUNT(1) FROM inc_ambit_geogr geo WHERE geo.copa_oid_para_gral = cpg.oid_para_gral) totalGeografico,
		           (SELECT z.cod_zona
		              FROM inc_ambit_geogr a, zon_zona z
		             WHERE a.copa_oid_para_gral = cpg.oid_para_gral
		               AND a.zzon_oid_zona IS NOT NULL
		               AND a.zzon_oid_zona = z.oid_zona
		               and z.cod_zona = #codigoZona#
		            UNION
		            SELECT z.cod_zona
		              FROM inc_ambit_geogr a, zon_zona z
		             WHERE a.copa_oid_para_gral = cpg.oid_para_gral
		               AND a.zorg_oid_regi IS NOT NULL
		               AND a.zzon_oid_zona IS NULL
		               AND a.zorg_oid_regi = z.zorg_oid_regi
		               AND z.cod_zona = #codigoZona#) codigoZona,
		           LOV_PKG_PROCE.LOV_FN_VALID_CLASI_CONCU(cpg.oid_para_gral, 
		                         GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoCliente#)) validacionClasificacion      
			  FROM inc_concu_param_gener cpg,
			       inc_param_gener_premi pgp, 
			  	   cra_perio peridesde, 
			  	   cra_perio perihasta, 
			       cra_perio periactu, 
			       seg_perio_corpo speridesde, 
			       seg_perio_corpo sperihasta
			 WHERE cpg.diri_oid_diri = #oidDirigConsul# 
			   AND cpg.bcal_oid_base_calc = #oidBaseCalcu#	
			   AND pgp.copa_oid_para_gral = cpg.oid_para_gral		
			   AND periactu.oid_peri = #oidPeriodo#
			   <![CDATA[
			   AND peridesde.fec_inic <= periactu.fec_inic
			   ]]>
			   <![CDATA[
			   AND periactu.fec_fina <= perihasta.fec_fina
			   ]]>		   
			   AND cpg.perd_oid_peri_desd = peridesde.oid_peri
			   AND cpg.perd_oid_peri_hast = perihasta.oid_peri
			   AND cpg.pais_oid_pais = #oidPais#
			   AND cpg.ind_Acti = 1		   
			   and speridesde.oid_peri = peridesde.PERI_OID_PERI
			   and sperihasta.oid_peri = perihasta.PERI_OID_PERI
		)
		WHERE validacionClasificacion = '1'	    
    </select>
    
    <select id="getPremios" parameterClass="java.util.Map" resultClass="premioMAE">
		SELECT   pnp.oid_para_nive_prem oidPremio,
		         i.val_i18n tipoPremio,
		         pnp.num_nive AS nivel,
				 NVL (lpa.num_prem, 
				 NVL (pm.num_prem,  
				 NVL (pd.num_prem, pp.num_prem))) numeroPremio, 
				 (case 
				    when pnp.tpre_oid_tipo_prem = 1 then pm.VAL_CANT || ' - ' || pm.VAL_PORC
				    when pnp.tpre_oid_tipo_prem = 2 then lpa.VAL_DESC_LOTE_PREM_ARTI
				    when pnp.tpre_oid_tipo_prem = 3 then pd.VAL_CANT_DESC || ' - ' || pd.VAL_PORC_DESC
				    when pnp.tpre_oid_tipo_prem = 4 then pp.VAL_CANT || ' - ' || pp.VAL_PORC				  
				  end) descripcion,
				  pg.oid_para_gral oidConcurso
		    FROM inc_concu_param_gener pg,
		         inc_param_gener_premi pgp,
		         inc_param_nivel_premi pnp,
		         inc_premi_artic pa,
		         inc_lote_premi_artic lpa,
		         inc_premi_monet pm,
		         inc_premi_descu pd,
		         inc_premi_punto pp,
		         inc_tipo_premi tp,
		         v_gen_i18n_sicc i
		   WHERE pg.oid_para_gral = #oidConcurso#
		     AND pgp.copa_oid_para_gral = pg.oid_para_gral
		     AND pgp.oid_para_gene_prem = pnp.pagp_oid_para_gene_prem
		     AND pnp.oid_para_nive_prem = pa.panp_oid_para_nive_prem(+)
		     AND lpa.prar_oid_prem_arti(+) = pa.oid_prem_arti
		     AND pnp.oid_para_nive_prem = pm.panp_oid_para_nive_prem(+)
		     AND pnp.oid_para_nive_prem = pd.oid_para_nive_prem(+)
		     AND pnp.oid_para_nive_prem = pp.panp_oid_para_nive_prem(+)
		     AND pnp.tpre_oid_tipo_prem = tp.oid_tipo_prem
		     AND i.attr_enti = 'INC_TIPO_PREMI'
		     AND i.attr_num_atri = 1
		     AND i.val_oid = tp.oid_tipo_prem
		     AND i.idio_oid_idio = 1
		     AND pnp.VAL_NIVE_SELE = 1
		   ORDER BY tipoPremio, nivel, numeroPremio		     
    </select>
    
    <insert id="insertRecomendante" parameterClass="clienteConcursoPremio">
    	insert into INC_CLIEN_RECTE(OID_CLIE_RETE, 							
									CLIE_OID_CLIE ,
									COPA_OID_PARA_GRAL,
		                            OID_MODU,
        		                    FEC_CREA                             
								   )
							VALUES (INC_CLR3_SEQ.nextval,
							        (GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoClienteRecomendante#)),
									#oidConcurso#,
		                            #oidModulo#,
                            		SYSDATE                             
								   )
    </insert>

	<insert id="insertRecomendado" parameterClass="clienteConcursoPremio">
		insert into INC_CLIEN_RECDO(OID_CLIE_REDO ,
                            CLIE_OID_CLIE ,
                            CLR3_OID_CLIE_RETE ,
                            PERD_OID_PERI ,
                            PANP_OID_PARA_NIVE_PREM,
                            NUM_PREM,
                            OID_MODU,
                            FEC_CREA                             
                            )
                     values(INC_CLRE_SEQ.Nextval,
                            (GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoClienteRecomendado#)),
                            #oidClienteRecomendante#,
                            #oidPeriodo#,
                            #oidNivelPremio#,
                            #numeroPremio#,
                            #oidModulo#,
                            SYSDATE
                            )
	</insert>
    
    <select id="getOidRecomendante" parameterClass="java.util.Map" resultClass="string">
	    select OID_CLIE_RETE 
		from INC_CLIEN_RECTE 
		where CLIE_OID_CLIE = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoClienteRecomendante#) and
		      COPA_OID_PARA_GRAL = #oidConcurso#
    </select>
    
    <select id="getOidRecomendado" parameterClass="java.util.Map" resultClass="string">
	         select OID_CLIE_REDO 
	         from   INC_CLIEN_RECDO 
		     where  CLR3_OID_CLIE_RETE = #oidClienteRecomendante# and
		            CLIE_OID_CLIE = (GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(#codigoClienteRecomendado#))
    </select>

    <!-- OBTIENE TIPO DIRECCION -->
    <select id="getTiposDireccion" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT OID_TIPO_DIRE AS OID, pq_apl_aux.Valor_Gen_I18n_Sicc(1, OID_TIPO_DIRE, 'MAE_TIPO_DIREC') AS DESCRIPCION
		 FROM MAE_TIPO_DIREC 
		   <![CDATA[		 
		WHERE COD_TIPO_DIRE <> '01'
		  AND COD_TIPO_DIRE <> '08'
		   ]]>		
		ORDER BY 2
    </select>    

    <!-- OBTIENE LOS NIVELES DE RIESGOS -->
    <select id="getNivelesRiesgo" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT rie.OID_NIVE_RIES || '-' || rie.COD_NIVE_RIES as OID, 
		       gen.val_i18n as DESCRIPCION
		FROM  GEN_I18N_SICC_COMUN gen,
		      SEG_IDIOM idi,
		      CAR_NIVEL_RIESG rie
		WHERE rie.OID_NIVE_RIES = gen.VAL_OID
		  AND gen.ATTR_ENTI = 'CAR_NIVEL_RIESG'
		  AND gen.IDIO_OID_IDIO = idi.OID_IDIO
		  AND idi.COD_ISO_IDIO = #codigoIdioma#
    </select>    

     <resultMap id="baseNivelRiesgoCliente"    class="java.util.HashMap">
    	<result property="oidCliente" 				column="OID_CLIE"   javaType="java.lang.String"/>		
    	<result property="codigoCliente" 			column="COD_CLIE"/>		    
    	<result property="nombreCliente" 			column="NOM_CLIE"/>		        	
    	<result property="oidNivelRiesgo"			column="OID_NIVE_RIES"  javaType="java.lang.String"/>		
    	<result property="codigoNivelRiesgo"  		column="COD_NIVE_RIES"/>		
    	<result property="descripcionRiesgo"   		column="VAL_I18N"/>		
    	<result property="oidPeriodoNivelRiezgo"    column="PERD_OID_PERI_NIVE_RIES" javaType="java.lang.String"/>
    	<result property="indicadorActividad"       column="IND_ACTI" javaType="java.lang.String"/>
    	<result property="oidEstatus"               column="ESTA_OID_ESTA_CLIE" javaType="java.lang.String"/>
    	<result property="numeroDocIdentidad"       column="NUM_DOCU_IDEN"/>
    	<result property="numeroPeriodosSinPedido"  column="NUM_CAMP_SIN_PEDI" javaType="java.lang.String"/>
	</resultMap>    

    <!-- OBTIENE EL NIVEL DE RIESGO DEL CLIENTE -->
    <select id="getNivelRiesgoCliente" parameterClass="java.util.Map" resultMap="baseNivelRiesgoCliente">
          SELECT CLI.OID_CLIE,
                 CLI.COD_CLIE, 
                 CLI.VAL_NOM1 || ' ' || CLI.VAL_NOM2 || ' ' || CLI.VAL_APE1 || ' ' || CLI.VAL_APE2 NOM_CLIE,
                 RIE.OID_NIVE_RIES,
                 RIE.COD_NIVE_RIES,
                 DNR.VAL_I18N,
                 ADI.PERD_OID_PERI_NIVE_RIES,
                 ADI.IND_ACTI,
                 ADI.ESTA_OID_ESTA_CLIE,
                 IDE.NUM_DOCU_IDEN,
                 NVL(ADI.NUM_CAMP_SIN_PEDI,0) NUM_CAMP_SIN_PEDI
            FROM SEG_PAIS PAI, 
                 MAE_CLIEN CLI, 
                 MAE_CLIEN_DATOS_ADICI ADI, 
                 CAR_NIVEL_RIESG RIE,
                 (SELECT * 
                    FROM GEN_I18N_SICC_COMUN GEN, 
                         SEG_IDIOM IDI
                   WHERE GEN.ATTR_ENTI ='CAR_NIVEL_RIESG'
                     AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
                     AND IDI.COD_ISO_IDIO = #codigoIdioma#) DNR,
                 MAE_CLIEN_IDENT IDE    
           WHERE PAI.OID_PAIS = CLI.PAIS_OID_PAIS
             AND CLI.OID_CLIE = ADI.CLIE_OID_CLIE
             AND ADI.NIRI_OID_NIVE_RIES = DNR.VAL_OID(+)
             AND DNR.VAL_OID = RIE.OID_NIVE_RIES (+)
             AND PAI.COD_PAIS = #codigoPais#
             AND CLI.COD_CLIE = #codigoCliente#
             AND CLI.OID_CLIE = IDE.CLIE_OID_CLIE
             AND IDE.VAL_IDEN_DOCU_PRIN = 1
    </select>    

    <select id="getFechaUltimaActualizacionClienteAdicional" parameterClass="java.util.Map" resultClass="string">
		SELECT TO_CHAR(adi.FEC_ULTI_ACTU, 'DD/MM/YYYY HH24:MI:SS') FECHA
		FROM   MAE_CLIEN_DATOS_ADICI adi, MAE_CLIEN cli
		WHERE  adi.CLIE_OID_CLIE = cli.OID_CLIE
		  AND  cli.OID_CLIE = #oidCliente#
    </select>    

    <select id="getFechaUltimaCreacionNivelRiesgoCliente" parameterClass="java.util.Map" resultClass="string">
		SELECT TO_CHAR(MAX(rie.FEC_CREA), 'DD/MM/YYYY HH24:MI:SS') FECHA
		FROM   MAE_CLIEN_NIVEL_RIESG rie
		WHERE  rie.CLIE_OID_CLIE = #oidCliente#
    </select>    
          
	<insert id="insertClienteNivelRiesgo" parameterClass="java.util.Map">
		INSERT INTO MAE_CLIEN_NIVEL_RIESG
			(COD_PAIS, COD_CLIE, CLIE_OID_CLIE, OID_NIVE_RIES_ANTE,
			 COD_NIVE_RIES_ANTE, OID_NIVE_RIES_ACTU,
			 COD_NIVE_RIES_ACTU, USU_CREA, FEC_CREA,OID_PERI_NIVE_RIES)
		VALUES
			(#codigoPais#, #codigoCliente#, #oidCliente#, #oidNivelRiesgoActual#,
			#codigoNivelRiesgoActual#, #oidNuevoNivelRiesgo#,
			#codigoNuevoNivelRiesgo#, #usuario#, SYSDATE,#oidPeriodoNivelRiezgo#)
	</insert>

	<update id="updateNivelRiesgoClienteAdicional" parameterClass="java.util.Map">
		UPDATE MAE_CLIEN_DATOS_ADICI
		   SET NIRI_OID_NIVE_RIES = #oidNuevoNivelRiesgo#,
		   
		   		<isNotEmpty property="indicadorActividad">
					IND_ACTI = #indicadorActividad#,					
					<isEqual property="indicadorActividad" compareValue="1">
						 CAM_ACTI = #campaniaProceso#,
						 USU_ACTI = #usuario#,
						 FEC_ACTI = SYSDATE,
					</isEqual>
					<isEqual property="indicadorActividad" compareValue="0">
						 CAM_INAC = #campaniaProceso#,
						 USU_INAC = #usuario#,
						 FEC_INAC = SYSDATE,
					</isEqual>
				</isNotEmpty>
		   		<isNotEmpty property="oidEstatusConsultoraNueva">
					ESTA_OID_ESTA_CLIE = 1,
				</isNotEmpty>
		       USU_MODI = #usuario#,
		       PERD_OID_PERI_NIVE_RIES = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA(#codigoPais#,'T','VD',TRUNC(SYSDATE)))                       
		 WHERE CLIE_OID_CLIE = #oidCliente#
	</update>


 	<select id="getZonasByPaisMarcaCanal" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZON_ZONA.COD_ZONA, ' ') AS CODIGO, 	   
		    NVL(ZON_ZONA.DES_ZONA, ' ') AS DESCRIPCION,
		    NVL(ZON_ZONA.COD_ZONA, 'ZZ')		
	 FROM  ZON_ZONA,
	       SEG_PAIS,
	       SEG_CANAL,
	       SEG_MARCA,
	       ZON_REGIO
	 WHERE (  (ZON_ZONA.IND_ACTI = 1)
              AND   (SEG_PAIS.COD_PAIS = #codigoPais#)
			<isNotEmpty prepend="AND" property="codigoMarca">
				(SEG_MARCA.COD_MARC = #codigoMarca#)
			</isNotEmpty>              
			<isNotEmpty prepend="AND" property="codigoCanal">
				(SEG_CANAL.COD_CANA = #codigoCanal#)
			</isNotEmpty>
	        AND (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
	        AND (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
	        AND (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)	        
	        AND (SEG_CANAL.OID_CANA = ZON_ZONA.CANA_OID_CANA)
	        AND (SEG_PAIS.OID_PAIS = ZON_ZONA.PAIS_OID_PAIS)
	        AND (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
	       )
	       ORDER BY 3
    </select>
    

	<select id="getTerritoriosByPaisMarcaCanalZona" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT ZON_TERRI.COD_TERR AS CODIGO, 	   
			   ZON_TERRI.COD_TERR AS DESCRIPCION 
		 FROM  ZON_ZONA,
		       SEG_PAIS,
		       SEG_CANAL,
		       SEG_MARCA,
		       ZON_REGIO,
			   ZON_SECCI,
			   ZON_TERRI,
			   ZON_TERRI_ADMIN
		 WHERE ZON_SECCI.IND_ACTI = 1
		        AND (SEG_PAIS.COD_PAIS = #codigoPais#)
				<isNotEmpty prepend="AND" property="codigoMarca">
					(SEG_MARCA.COD_MARC = #codigoMarca#)
				</isNotEmpty>              
				<isNotEmpty prepend="AND" property="codigoCanal">
					(SEG_CANAL.COD_CANA = #codigoCanal#)
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="codigoZona">
      	 			(ZON_ZONA.COD_ZONA = #codigoZona#)
            	</isNotEmpty> 						
				AND (SEG_PAIS.OID_PAIS = ZON_TERRI_ADMIN.PAIS_OID_PAIS)
		        AND (SEG_MARCA.OID_MARC = ZON_TERRI_ADMIN.MARC_OID_MARC)
		        AND (SEG_CANAL.OID_CANA = ZON_TERRI_ADMIN.CANA_OID_CANA)
		        AND (ZON_SECCI.OID_SECC = ZON_TERRI_ADMIN.ZSCC_OID_SECC)
		        AND (ZON_TERRI.OID_TERR = ZON_TERRI_ADMIN.TERR_OID_TERR)
		        AND (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
		        AND (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
		        AND (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)	        
		        AND (SEG_CANAL.OID_CANA = ZON_ZONA.CANA_OID_CANA)
		        AND (SEG_PAIS.OID_PAIS = ZON_ZONA.PAIS_OID_PAIS)
		        AND (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
		        AND (ZON_ZONA.OID_ZONA = ZON_SECCI.ZZON_OID_ZONA)		
		       ORDER BY 2
	</select>
    

   <resultMap id="clientesResult"   class="java.util.HashMap">
    	<result property="codigo" 					column="CODIGO" 	/>
    	<result property="documentoIdentidad" 		column="NUM_DOCU_IDEN"/>
		<result property="apellido1" 				column="APELLIDO1"/>
		<result property="apellido2" 				column="APELLIDO2"/>
		<result property="nombre1" 					column="NOMBRE1"/>
		<result property="nombre2" 					column="NOMBRE2"/>
		<result property="codigoZona" 			  	column="COD_ZONA"/>
		<result property="codigoTerritorio" 		column="COD_TERR"/>
		<result property="oid" 						column="OID_CLIE" 	/>
		<result property="indicadorActivo" 			column="IND_ACTI"/>
		<result property="statusCliente" 		  	column="STATUS"/>
		<result property="subTipoCliente" 			column="TIPOSUBTIPO"/>    	
		<result property="fechaIngreso" 			column="FEC_INGR"/>
		<result property="motivoCompromiso"			column="VAL_MOTI_COMP"/>
    </resultMap>


	<select id="getListClientesByCriteria" parameterClass="java.util.Map" resultMap="clientesResult">

		SELECT  CODIGO,NUM_DOCU_IDEN,NOMBRE1,NOMBRE2,APELLIDO1,
				APELLIDO2,COD_ZONA,COD_TERR,OID_CLIE,
				IND_ACTI,STATUS,TIPOSUBTIPO, FEC_INGR, VAL_MOTI_COMP
					FROM (SELECT ROWNUM,codigo,NUM_DOCU_IDEN,nombre1,nombre2,apellido1,apellido2,COD_ZONA,COD_TERR,oid_clie,IND_ACTI,status,TIPOSUBTIPO,FEC_INGR,VAL_MOTI_COMP
						  FROM(
							  SELECT DISTINCT c.cod_clie codigo,
						   			  i.NUM_DOCU_IDEN, 
								 	  c.val_nom1 nombre1,
							          c.val_nom2 nombre2, 
							          c.val_ape1 apellido1,
							          c.val_ape2 apellido2, 
									  TO_CHAR(zz.COD_ZONA) AS COD_ZONA,
									  TO_CHAR(zt.COD_TERR) AS COD_TERR,
					                  c.oid_clie,
									  da.IND_ACTI,
									  PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, da.ESTA_OID_ESTA_CLIE, 'MAE_ESTAT_CLIEN') status,
									  PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, ts.TICL_OID_TIPO_CLIE, 'MAE_TIPO_CLIEN') || ' / ' || PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, ts.SBTI_OID_SUBT_CLIE, 'MAE_SUBTI_CLIEN')  AS TIPOSUBTIPO,
									  TO_CHAR(c.FEC_INGR, 'DD/MM/YYYY') FEC_INGR,
                                      da.VAL_MOTI_COMP
							  FROM MAE_CLIEN c, 
								 MAE_CLIEN_IDENT i ,
								 MAE_CLIEN_DATOS_ADICI da,
								 MAE_CLIEN_TIPO_SUBTI ts,
								 MAE_CLIEN_UNIDA_ADMIN ua,
								 ZON_TERRI_ADMIN zta,
								 ZON_TERRI zt,
								 ZON_ZONA  zz,
								 ZON_SECCI zs
							 WHERE c.PAIS_OID_PAIS = #oidPais#
							  AND i.CLIE_OID_CLIE = c.OID_CLIE
							  AND da.CLIE_OID_CLIE = c.OID_CLIE
							  AND ts.CLIE_OID_CLIE = c.OID_CLIE
  									<isNotEmpty prepend="AND" property="codigoCliente">        
										c.COD_CLIE LIKE #codigoCliente#
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre1">        
										UPPER(c.VAL_NOM1) LIKE UPPER(#nombre1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre2">        
										UPPER(c.VAL_NOM2) LIKE UPPER(#nombre2#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido1">        
										UPPER(c.VAL_APE1) LIKE UPPER(#apellido1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido2">        
										UPPER(c.VAL_APE2) LIKE UPPER(#apellido2#)
									  </isNotEmpty>  
									  <isNotEmpty prepend="AND" property="documentoIdentidad">        
										UPPER(i.NUM_DOCU_IDEN) LIKE UPPER(#documentoIdentidad#)
									  </isNotEmpty>	 							  
									  <isNotEmpty prepend="AND" property="oidTipoCliente">        
											ts.TICL_OID_TIPO_CLIE =#oidTipoCliente#
									  </isNotEmpty>	 							  
									  <isNotEmpty prepend="AND" property="oidSubTipoCliente">        
											ts.SBTI_OID_SUBT_CLIE =#oidSubTipoCliente#
									  </isNotEmpty>	 							  
									  <isNotEmpty prepend="AND" property="codigoZona">        
											zz.COD_ZONA  =#codigoZona#
									  </isNotEmpty>	 							  
									  <isNotEmpty prepend="AND" property="codigoTerritorio">        
											zt.COD_TERR =#codigoTerritorio#
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="activo">        
										    da.IND_ACTI= #activo#
									  </isNotEmpty>	 					
		  					 AND i.VAL_IDEN_DOCU_PRIN=1									  		  									  							  
							 AND ua.CLIE_OID_CLIE = c.OID_CLIE 
							 AND ua.ZTAD_OID_TERR_ADMI =zta.OID_TERR_ADMI
							 AND zta.PAIS_OID_PAIS=c.PAIS_OID_PAIS	 
							 AND zs.OID_SECC = zta.ZSCC_OID_SECC
							 AND zt.OID_TERR = zta.TERR_OID_TERR
							 AND zt.PAIS_OID_PAIS =c.PAIS_OID_PAIS
							 AND zz.OID_ZONA = zs.ZZON_OID_ZONA
							 <isNotEmpty prepend="AND" property="compromiso">        
								da.IND_COMP = '1'
							 </isNotEmpty>
						UNION ALL
							  SELECT DISTINCT c.cod_clie codigo,
						   			  i.NUM_DOCU_IDEN, 
								 	  c.val_nom1 nombre1,
							          c.val_nom2 nombre2, 
							          c.val_ape1 apellido1,
							          c.val_ape2 apellido2, 
									  '' AS COD_ZONA,
									  '' AS COD_TERR,
					                  c.oid_clie,
									  da.IND_ACTI,
									  PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, da.ESTA_OID_ESTA_CLIE, 'MAE_ESTAT_CLIEN') status,
									  PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, ts.TICL_OID_TIPO_CLIE, 'MAE_TIPO_CLIEN') || ' / ' || PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, ts.SBTI_OID_SUBT_CLIE, 'MAE_SUBTI_CLIEN')  AS TIPOSUBTIPO,
									  TO_CHAR(c.FEC_INGR, 'DD/MM/YYYY') FEC_INGR,
                                      da.VAL_MOTI_COMP
							  FROM MAE_CLIEN c, 
								 MAE_CLIEN_IDENT i ,
								 MAE_CLIEN_DATOS_ADICI da,
								 MAE_CLIEN_TIPO_SUBTI ts
							 WHERE c.PAIS_OID_PAIS = #oidPais#
							  AND i.CLIE_OID_CLIE = c.OID_CLIE
							  AND da.CLIE_OID_CLIE = c.OID_CLIE
							  AND ts.CLIE_OID_CLIE = c.OID_CLIE
  									<isNotEmpty prepend="AND" property="codigoCliente">        
										c.COD_CLIE LIKE #codigoCliente#
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre1">        
										UPPER(c.VAL_NOM1) LIKE UPPER(#nombre1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre2">        
										UPPER(c.VAL_NOM2) LIKE UPPER(#nombre2#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido1">        
										UPPER(c.VAL_APE1) LIKE UPPER(#apellido1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido2">        
										UPPER(c.VAL_APE2) LIKE UPPER(#apellido2#)
									  </isNotEmpty>  
									  <isNotEmpty prepend="AND" property="documentoIdentidad">        
										UPPER(i.NUM_DOCU_IDEN) LIKE UPPER(#documentoIdentidad#)
									  </isNotEmpty>	 							  
									  <isNotEmpty prepend="AND" property="oidTipoCliente">        
											ts.TICL_OID_TIPO_CLIE =#oidTipoCliente#
									  </isNotEmpty>	 							  
									  <isNotEmpty prepend="AND" property="oidSubTipoCliente">        
											ts.SBTI_OID_SUBT_CLIE =#oidSubTipoCliente#
									  </isNotEmpty>	 							  								
									  <isNotEmpty prepend="AND" property="activo">        
										    da.IND_ACTI= #activo#
									  </isNotEmpty>	 					
		  					     AND i.VAL_IDEN_DOCU_PRIN=1
		  					     <isNotEmpty prepend="AND" property="compromiso">        
									da.IND_COMP = '1'
								 </isNotEmpty>		
								 AND c.OID_CLIE NOT IN (
								 	 SELECT  ua.CLIE_OID_CLIE
									 FROM  MAE_CLIEN_UNIDA_ADMIN ua					
									 WHERE    ua.CLIE_OID_CLIE = c.OID_CLIE) 
							     AND   #codigoZona# IS NULL
								 AND   #codigoTerritorio# IS NULL	 				  	 							 							 						
							 )
						)
  	<![CDATA[				
		WHERE ROWNUM < 501									         
	    ]]>
				
	</select>
	
	<resultMap id="datosBasicoClienteResult"   class="clienteBasico">
	 	<result property="oid" 							  	  column="OID_CLIE"/>
	    <result property="codigo" 							  column="COD_CLIE"/>
	    <result property="indicadorFichaInscripcion" 		  column="IND_FICH_INSC"/>
	    <result property="oidPais" 							  column="PAIS_OID_PAIS"/>
	    <result property="digitoControl" 					  column="COD_DIGI_CTRL"/>
		<result property="apellido1" 						  column="VAL_APE1"/>
		<result property="apellido2" 						  column="VAL_APE2"/>
		<result property="nombre1" 							  column="VAL_NOM1"/>
		<result property="nombre2" 							  column="VAL_NOM2"/>
		<result property="tratamiento" 			  			  column="VAL_TRAT"/>
		<result property="criterioBusqueda1" 				  column="VAL_CRIT_BUS1"/>
		<result property="criterioBusqueda2" 				  column="VAL_CRIT_BUS2"/>
		<result property="sexo" 							  column="COD_SEXO"/>
		<result property="fechaIngreso" 		  			  column="FEC_INGR"/>
		<result property="oidFormaPago" 					  column="FOPA_OID_FORM_PAGO"/>    	
		<result property="apellidoCasada" 					  column="VAL_APEL_CASA"/>    	
		<result property="deudaAnterior" 					  column="SAL_DEUD_ANTE"/>
		<result property="codigoAnterior" 					  column="COD_CLIE_ANTE"/>		    		
		<result property="indicadorOrigen" 					  column="IND_ORIG_REGI"/>
  </resultMap>

	<select id="getDatosBasicosCliente" parameterClass="java.util.Map" resultMap="datosBasicoClienteResult">

			SELECT C.*
			FROM MAE_CLIEN C, SEG_PAIS P
			WHERE C.COD_CLIE =#codigoCliente#
			  AND P.COD_PAIS=#codigoPais#
			  AND C.PAIS_OID_PAIS=P.OID_PAIS

	</select>	


 <resultMap id="datosAdicionalesClienteResult"   class="clienteAdicional">
 		<result property="oid" 							  	  		column="OID_CLIE_DATO_ADIC"/>
    	<result property="oidCliente" 								column="CLIE_OID_CLIE"/>
    	<result property="oidNivelSocioEconomico" 		  			column="NSEP_OID_NSEP"/>
    	<result property="codigoEmpleado" 							column="COD_EMPL"/>
    	<result property="fechaNacimiento" 							column="FEC_NACI"/>
		<result property="edad" 									column="VAL_EDAD"/>
		<result property="ocupacion" 								column="VAL_OCUP"/>
		<result property="profesion" 								column="VAL_PROF"/>
		<result property="centroTrabajo" 							column="VAL_CENT_TRAB"/>
		<result property="cargo" 			  						column="VAL_CARG_DESE"/>
		<result property="centroEstudios" 							column="VAL_CENT_ESTU"/>
		<result property="nivelSocioEconomico3" 					column="VAL_NIVE_SOCI_ECO3"/>
		<result property="numeroHijos" 								column="NUM_HIJO"/>
		<result property="numeroDependientes" 		  				column="NUM_PERS_DEPE"/>
		<result property="numeroCampanasSinPedido" 					column="NUM_CAMP_SIN_PEDI"/>    	
		<result property="ingresoFamiliar" 					  		column="IMP_INGR_FAMI"/>    	
		<result property="montoLineaCredito" 					  	column="IMP_MONT_LINE_CRED"/>    				
		<result property="oidNivelRiesgo" 					  		column="NIRI_OID_NIVE_RIES"/>    		
		<result property="oidNivelEstudios" 					  	column="NIED_OID_NIVE_ESTU"/>    		
		<result property="oidNacionalidad" 					  		column="SNON_OID_NACI"/>    		
		<result property="oidEstadoCivil" 					  		column="ESCV_OID_ESTA_CIVI"/>    				
		<result property="oidPeriodoNivelRiesgo" 					column="PERD_OID_PERI_NIVE_RIES"/>    		
		<result property="oidPeriodoLineaCredito" 					column="PERD_OID_PERI_LINE_CRED"/>    				
		<result property="indicadorCorrespondencia" 				column="IND_CORR"/>    				
		<result property="indicadorActivo" 					  		column="IND_ACTI"/>    		
		<result property="oidEstatusCliente" 					  	column="ESTA_OID_ESTA_CLIE"/>    
		<result property="oidCicloVida" 					  		column="TCLV_OID_CICL_VIDA"/>    						
		<result property="email" 					  		  		column="VAL_EMAI"/>
		<result property="codigoStatus" 					  		column="COD_ESTA_CLIE"/>
		<result property="descripcionStatus" 					  	column="DES_ESTA"/>   
		<result property="oidTipoCutis"		 					  	column="TCUT_OID_TIPO_CUTI"/>
		<result property="oidOtrasMarcas"		 					column="OTMA_OID_OTRA_MARC"/>
		<result property="codigoCUB"      		 					column="COD_CUB"/>
		<result property="indicadorCompromiso"      		 		column="IND_COMP"/>
		<result property="motivo"      		 						column="VAL_MOTI_COMP"/>
		<result property="indicadorImpresionPaqDoc" 				column="IND_IMPR_PDOC"/>
		<result property="codGrupoFuncional" 						column="COD_GRUP_FUNC"/>
		<result property="desGrupoFuncional" 						column="DES_GRUP_FUNC"/>
		<result property="usuRed" 									column="VAL_USUA_RED"/>
		<result property="valRelContr" 								column="VAL_RELA_CONT"/>
		<result property="codJefeCUB" 								column="COD_CUB_JEFE"/>
		<result property="nomJefeDir" 								column="VAL_NOM_JEFE"/>
		<result property="valPueOrg" 								column="VAL_PUE_ORG"/>
		<result property="usuCarg" 									column="USU_CARG"/>
		<result property="fecCarg" 									column="FEC_CARG"/>
		<result property="tipCarg" 									column="TIP_CARG"/>
		<result property="indImprDocu" 								column="IND_IMPR_DOCU"/>		
		<result property="indDocFiscal" 							column="IND_DOC_FISC"/>	
		<result property="valTipoPersona" 							column="TPES_OID_TIPO_PERS"/>	
		<result property="valOrigenIngreso" 						column="ORIN_OID_ORIG_INGR"/>
		<result property="valCuentaCorriente" 						column="NUM_CUEN_BANC"/>
		<result property="indicadorCalularPercepcion" 				column="IND_GENE_PERC"/>
		<result property="valTipoCuenta" 							column="BTCU_COD_TIPO_CUEN"/>
		<result property="valBanco" 								column="BBPA_COD_BANC_PAGA"/>		
		
  </resultMap>

	<select id="getDatosAdicionalesCliente" parameterClass="java.lang.String" resultMap="datosAdicionalesClienteResult">
					SELECT 	CDA.*,
					        (SELECT X.COD_ESTA_CLIE
							 FROM MAE_ESTAT_CLIEN X
							 WHERE X.OID_ESTA_CLIE = CDA.ESTA_OID_ESTA_CLIE) COD_ESTA_CLIE,
							 PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,CDA.ESTA_OID_ESTA_CLIE, 'MAE_ESTAT_CLIEN') AS DES_ESTA 
					FROM MAE_CLIEN_DATOS_ADICI CDA
					WHERE CDA.CLIE_OID_CLIE= #value#
	</select>	

	<resultMap id="primerContactoClienteResult"   class="clientePrimerContacto">	
		<result property="oid"						  column="OID_CLIE_PRIM_CONT"/>  				
		<result property="oidCliente"                 column="CLIE_OID_CLIE"/>       
		<result property="oidClienteSubTipo"          column="CTSU_CLIE_CONT"/>   
		<result property="fechaContacto"              column="FEC_CONT"/>            
		<result property="fechaSiguienteContacto"     column="FEC_SIGU_CONT"/>         
		<result property="codigoTipoContacto"         column="COD_TIPO_CONT"/>       
		<result property="oidMarca"                   column="MARC_OID_MARC"/>       
		<result property="oidCanal"                   column="CANA_OID_CANA"/>       
		<result property="oidPeriodo"                 column="PERD_OID_PERI"/>       
	</resultMap>


	<select id="getPrimerContactoCliente" parameterClass="java.lang.String" resultMap="primerContactoClienteResult">
					SELECT PC.*
					FROM MAE_CLIEN_PRIME_CONTA	PC
					WHERE PC.CLIE_OID_CLIE=	#value#
	</select>	


	<resultMap id="identificacionClienteResult"   class="clienteIdentificacion">	
		<result property="oid"							column="OID_CLIE_IDEN"/>       
		<result property="oidTipoDocumento"             column="TDOC_OID_TIPO_DOCU"/>  
		<result property="oidCliente"                   column="CLIE_OID_CLIE"/>       
		<result property="numeroDocumento"              column="NUM_DOCU_IDEN"/>       
		<result property="indicadorPrincipal"           column="VAL_IDEN_DOCU_PRIN"/>  
		<result property="identificadorPersonal"        column="VAL_IDEN_PERS_EMPR"/>
		<result property="codigoSubtipoDocumento"        column="SBTD_COD_SUBT_DOCU"/>
	</resultMap>


	<select id="getListIdentificacionCliente" parameterClass="java.lang.String" resultMap="identificacionClienteResult">
						SELECT OID_CLIE_IDEN,TDOC_OID_TIPO_DOCU,CLIE_OID_CLIE,NUM_DOCU_IDEN,VAL_IDEN_DOCU_PRIN,VAL_IDEN_PERS_EMPR, SBTD_COD_SUBT_DOCU
						FROM (SELECT CI.*
									FROM MAE_CLIEN_IDENT CI
									WHERE CI.CLIE_OID_CLIE = #value#
									ORDER BY CI.VAL_IDEN_DOCU_PRIN DESC)
						<![CDATA[				
						WHERE ROWNUM < 3									         
	    				]]>		
	</select>	                                               

	<resultMap id="tipoSubtipoClienteResult"   class="clienteSubTipo">
		<result property="oid"							  column="OID_CLIE_TIPO_SUBT"/>        
		<result property="oidCliente"                     column="CLIE_OID_CLIE"/>   
		<result property="oidTipoCliente"                 column="TICL_OID_TIPO_CLIE"/>        
		<result property="oidSubTipoCliente"              column="SBTI_OID_SUBT_CLIE"/>        
		<result property="indicadorPrincipal"             column="IND_PPAL"/>   
		<result property="codigoTipoCliente"              column="COD_TIPO_CLIE"/>   
		<result property="codigoSubTipoCliente"			  column="COD_SUBT_CLIE"/>  
		<result property="descripcionTipoCliente"		  column="DES_TIPO"/>  
		<result property="descripcionSubTipoCliente"	  column="DES_SUBTIPO"/>  
	</resultMap>

	<select id="getListTipoSubtipoCliente" parameterClass="java.lang.String" resultMap="tipoSubtipoClienteResult">

			SELECT TS.OID_CLIE_TIPO_SUBT,TS.CLIE_OID_CLIE,TS.TICL_OID_TIPO_CLIE,
				   TS.SBTI_OID_SUBT_CLIE,
				   TS.IND_PPAL,
				   TIP.COD_TIPO_CLIE,
				   SUB.COD_SUBT_CLIE,
				   PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TS.TICL_OID_TIPO_CLIE, 'MAE_TIPO_CLIEN') AS DES_TIPO,
				   PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,TS.SBTI_OID_SUBT_CLIE, 'MAE_SUBTI_CLIEN')  AS DES_SUBTIPO
			FROM MAE_CLIEN_TIPO_SUBTI TS,MAE_TIPO_CLIEN TIP, MAE_SUBTI_CLIEN SUB  
			WHERE TS.CLIE_OID_CLIE =  #value#
			 AND TS.TICL_OID_TIPO_CLIE = TIP.OID_TIPO_CLIE
			 AND TS.SBTI_OID_SUBT_CLIE = SUB.OID_SUBT_CLIE
				
	</select>	

	<resultMap id="clasificacionClienteResult"   class="clienteClasificacion">
			<result property="oid"								column="OID_CLIE_CLAS"/>   	
			<result property="oidClienteSubTipo"                 column="CTSU_OID_CLIE_TIPO_SUBT"/>        
			<result property="oidClasificacion"                  column="CLAS_OID_CLAS"/>   
			<result property="oidPeriodo"                        column="PERD_OID_PERI"/>   
			<result property="oidTipoClasificacion"              column="TCCL_OID_TIPO_CLASI"/>             
			<result property="fechaClasificacion"                column="FEC_CLAS"/>        
			<result property="indicadorPrincipal"                column="IND_PPAL"/>        
			<result property="descripcionTipoClasificacion"      column="DES_TIPO_CLAS"/>             
			<result property="descripcionClasificacion"          column="DES_CLAS"/>          
	</resultMap>

	<select id="getListClasificacionCliente" parameterClass="java.lang.String" resultMap="clasificacionClienteResult">

				SELECT CC.OID_CLIE_CLAS,
					   CC.CTSU_OID_CLIE_TIPO_SUBT,
				       CC.CLAS_OID_CLAS,
					   CC.PERD_OID_PERI,
					   CC.TCCL_OID_TIPO_CLASI,
					   CC.FEC_CLAS,
					   CC.IND_PPAL,
					   PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,CC.TCCL_OID_TIPO_CLASI, 'MAE_TIPO_CLASI_CLIEN') AS DES_TIPO_CLAS,
					   PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,CC.CLAS_OID_CLAS, 'MAE_CLASI') AS DES_CLAS
				FROM MAE_CLIEN_CLASI CC,
				     MAE_CLIEN_TIPO_SUBTI TS,
					 MAE_TIPO_CLASI_CLIEN TCC
				WHERE  CC.CTSU_OID_CLIE_TIPO_SUBT= #value#
				   AND CC.CTSU_OID_CLIE_TIPO_SUBT =TS.OID_CLIE_TIPO_SUBT
				   AND  CC.TCCL_OID_TIPO_CLASI =TCC.OID_TIPO_CLAS
				
	</select>	
	

	<resultMap id="direccionClienteResult"   class="clienteDireccion">		
		<result property="oid"								  column="OID_CLIE_DIRE"/>        
		<result property="oidCliente"                         column="CLIE_OID_CLIE"/>        
		<result property="oidTipoDireccion"                   column="TIDC_OID_TIPO_DIRE"/>   
		<result property="oidTipoVia"                         column="TIVI_OID_TIPO_VIA"/>    
		<result property="oidTerritorio"                      column="TERR_OID_TERR"/>        
		<result property="oidVia"                             column="ZVIA_OID_VIA"/>         
		<result property="numeroPrincipal"                    column="NUM_PPAL"/>             
		<result property="nombreVia"                          column="VAL_NOMB_VIA"/>         
		<result property="codigoPostal"                       column="VAL_COD_POST"/>         
		<result property="interior"                           column="VAL_INTE"/>             
		<result property="manzana"                            column="VAL_MANZ"/>             
		<result property="lote"                               column="VAL_LOTE"/>             
		<result property="kilometro"                          column="VAL_KM"/>               
		<result property="observaciones"                      column="VAL_OBSE"/>             
		<result property="nombreFichero"                      column="VAL_NOMB_FICH"/>        
		<result property="coordenadaX"                        column="VAL_COOR_X"/>           
		<result property="coordenadaY"                        column="VAL_COOR_Y"/>           
		<result property="coordenadaZ"                        column="VAL_COOR_Z"/>           
		<result property="indicadorDireccionPrincipal"        column="IND_DIRE_PPAL"/>        
		<result property="indicadorEstandarizacionGIS"        column="IND_CTRL_INTE_GEOR"/>   
		<result property="codigoUnidadGeografica"             column="COD_UNID_GEOG"/>        
		<result property="indicadorEliminacion"               column="IND_ELIM"/>             
		<result property="barrio"               			  column="VAL_BARR"/>
		<result property="codigoCiudad"            			  column="CIUD_COD_CIUD"/>
		<result property="codigoUbigeo1"           			  column="CIUD_COD_UGEO_REGI"/>
		<result property="villaPoblacion"          			  column="DES_VILLA_POBL"/>
		<result property="codigoTipoDireccion"     			  column="COD_TIPO_DIRE"/>
		<result property="codigoPeriodoInicio"          	  column="COD_CAMP_INIC"/>
		<result property="codigoPeriodoFin"          		  column="COD_CAMP_FINA"/>
		<result property="codigoPeriodoInicioActual"       	  column="COD_CAMP_INIC"/>
		<result property="codigoPeriodoFinActual"      		  column="COD_CAMP_FINA"/>
		<result property="correVia"      		  			  column="ZCAL_COR_ZCAL"/>		
		<result property="valEtapaConjunto"      		  	  column="VAL_ETA_CONJ"/>
		<result property="valCallePrincipal"      		  	  column="VAL_CAL_PRIN"/>
		<result property="valCalleSecundaria"      		  	  column="VAL_CAL_SECU"/>
		<result property="valNomBarrio"      		  	      column="VAL_NOM_BARR"/>
		<result property="valNomManzana"      		  	      column="VAL_NOM_MANZ"/>
		<result property="valCodigoTerritorialCorresponde"    column="TECO_COD_TERR_CORR"/>
		
	</resultMap>
	                                                      
	<select id="getListDireccionCliente" parameterClass="java.lang.String" resultMap="direccionClienteResult">   

					SELECT TEMP.*,
							MAE_PKG_PROCE_CLIEN.MAE_FN_OBTIE_CODIG_PERIO(TEMP.PERD_OID_CAMP_INIC) COD_CAMP_INIC,
					        MAE_PKG_PROCE_CLIEN.MAE_FN_OBTIE_CODIG_PERIO(TEMP.PERD_OID_CAMP_FINA) COD_CAMP_FINA
					FROM
						(SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						   CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 1
						UNION ALL
						SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						  CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND TP.COD_TIPO_DIRE='07'
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 0
						UNION ALL
						SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						  CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND TP.COD_TIPO_DIRE='08'
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 0
						UNION ALL
						SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						  CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND TP.COD_TIPO_DIRE !='07'
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 0) TEMP
						<![CDATA[				
						WHERE ROWNUM < 3									         
	    				]]>		                                                                                                               
				                                                                                                                
	</select>	
	
	
	<resultMap id="direccionClienteCamposAdicionalesResult"   class="clienteDireccion">		
		<result property="oid"								  column="OID_CLIE_DIRE"/>        
		<result property="oidCliente"                         column="CLIE_OID_CLIE"/>        
		<result property="oidTipoDireccion"                   column="TIDC_OID_TIPO_DIRE"/>   
		<result property="oidTipoVia"                         column="TIVI_OID_TIPO_VIA"/>    
		<result property="oidTerritorio"                      column="TERR_OID_TERR"/>        
		<result property="oidVia"                             column="ZVIA_OID_VIA"/>         
		<result property="numeroPrincipal"                    column="NUM_PPRI"/>             
		<result property="nombreVia"                          column="VAL_NOMB_VIA"/>         
		<result property="codigoPostal"                       column="VAL_COD_POST"/>         
		<result property="interior"                           column="VAL_INTE"/>             
		<result property="manzana"                            column="VAL_MANZ"/>             
		<result property="lote"                               column="VAL_LOTE"/>             
		<result property="kilometro"                          column="VAL_KM"/>               
		<result property="observaciones"                      column="VAL_OBSE"/>             
		<result property="nombreFichero"                      column="VAL_NOMB_FICH"/>        
		<result property="coordenadaX"                        column="VAL_COOR_X"/>           
		<result property="coordenadaY"                        column="VAL_COOR_Y"/>           
		<result property="coordenadaZ"                        column="VAL_COOR_Z"/>           
		<result property="indicadorDireccionPrincipal"        column="IND_DIRE_PPAL"/>        
		<result property="indicadorEstandarizacionGIS"        column="IND_CTRL_INTE_GEOR"/>   
		<result property="codigoUnidadGeografica"             column="COD_UNID_GEOG"/>        
		<result property="indicadorEliminacion"               column="IND_ELIM"/>             
		<result property="barrio"               			  column="VAL_BARR"/>
		<result property="codigoCiudad"            			  column="CIUD_COD_CIUD"/>
		<result property="codigoUbigeo1"           			  column="CIUD_COD_UGEO_REGI"/>
		<result property="villaPoblacion"          			  column="DES_VILLA_POBL"/>
		<result property="codigoTipoDireccion"     			  column="COD_TIPO_DIRE"/>
		<result property="codigoPeriodoInicio"          	  column="COD_CAMP_INIC"/>
		<result property="codigoPeriodoFin"          		  column="COD_CAMP_FINA"/>
		<result property="codigoPeriodoInicioActual"       	  column="COD_CAMP_INIC"/>
		<result property="codigoPeriodoFinActual"      		  column="COD_CAMP_FINA"/>
		<result property="correVia"      		  			  column="ZCAL_COR_ZCAL"/>		
		<result property="valEtapaConjunto"      		  	  column="VAL_ETA_CONJ"/>
		<result property="valCallePrincipal"      		  	  column="VAL_CAL_PRIN"/>
		<result property="valCalleSecundaria"      		  	  column="VAL_CAL_SECU"/>
		<result property="valNomBarrio"      		  	      column="VAL_NOM_BARR"/>
		<result property="valNomManzana"      		  	      column="VAL_NOM_MANZ"/>
		<result property="valCodigoTerritorialCorresponde"    column="TECO_COD_TERR_CORR"/>
		
	</resultMap>
	                                                      
	<select id="getListDireccionClienteCamposAdicionales" parameterClass="java.lang.String" resultMap="direccionClienteCamposAdicionalesResult">   

					SELECT TEMP.*,
							MAE_PKG_PROCE_CLIEN.MAE_FN_OBTIE_CODIG_PERIO(TEMP.PERD_OID_CAMP_INIC) COD_CAMP_INIC,
					        MAE_PKG_PROCE_CLIEN.MAE_FN_OBTIE_CODIG_PERIO(TEMP.PERD_OID_CAMP_FINA) COD_CAMP_FINA
					FROM
						(SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						   CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 1
						UNION ALL
						SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						  CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND TP.COD_TIPO_DIRE='07'
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 0
						UNION ALL
						SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						  CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND TP.COD_TIPO_DIRE='08'
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 0
						UNION ALL
						SELECT CD.*,TP.COD_TIPO_DIRE
						FROM MAE_CLIEN_DIREC CD,MAE_TIPO_DIREC TP
						WHERE  
						  CD.CLIE_OID_CLIE =#value#
						  AND CD.TIDC_OID_TIPO_DIRE = TP.OID_TIPO_DIRE
						 AND TP.COD_TIPO_DIRE !='07'
						 AND cd.IND_ELIM='0' 
						 AND CD.IND_DIRE_PPAL = 0) TEMP
						<![CDATA[				
						WHERE ROWNUM < 3									         
	    				]]>		                                                                                                               
				                                                                                                                
	</select>	          
	
	<resultMap id="comunicacionClienteResult"   class="clienteComunicacion">		
		<result property="oid"							  column="OID_CLIE_COMU"/>        		
		<result property="oidCliente"                     column="CLIE_OID_CLIE"/>            
		<result property="oidTipoComunicacion"            column="TICM_OID_TIPO_COMU"/>       
		<result property="diaComunicacion"                column="VAL_DIA_COMU"/>             
		<result property="textoComunicacion"              column="VAL_TEXT_COMU"/>            
		<result property="fechaDesde"                     column="FEC_HORA_DESD"/>            
		<result property="fechaHasta"                     column="FEC_HORA_HAST"/>            
		<result property="intervaloComunicacion"          column="VAL_INTE_COMU"/>            
		<result property="indicadorPrincipal"             column="IND_COMU_PPAL"/>            
		<result property="codigoTipoComunicacion"         column="COD_TIPO_COMU"/> 
	</resultMap>		                             
		
	<select id="getListComunicacionCliente" parameterClass="java.lang.String" resultMap="comunicacionClienteResult">   
						SELECT CC.*,TC.COD_TIPO_COMU
						FROM MAE_CLIEN_COMUN CC,MAE_TIPO_COMUN TC
						WHERE CC.CLIE_OID_CLIE = #value#
						 AND CC.TICM_OID_TIPO_COMU = TC.OID_TIPO_COMU
						ORDER BY CC.IND_COMU_PPAL DESC 			                                                                                            
	</select>
	
	
	<resultMap id="vinculoClienteResult"   class="clienteVinculo">	
		<result property="oid"							  column="OID_CLIE_VINC"/>
		<result property="fechaDesde"                     column="FEC_DESD"/>
		<result property="fechaHasta"                     column="FEC_HAST"/>
		<result property="oidCliente"                     column="CLIE_OID_CLIE_VNDO"/>
		<result property="oidClienteVinculante"           column="CLIE_OID_CLIE_VNTE"/>
		<result property="oidTipoVinculo"                 column="TIVC_OID_TIPO_VINC"/>
		<result property="indicadorPrincipal"             column="IND_VINC_PPAL"/>
		<result property="fechaActualizacion"	          column="FEC_ULTI_ACTU"/>
		<result property="codigoTipoVinculo"              column="COD_TIPO_VINC"/>
		<result property="codigoClienteVinculante"        column="COD_CLIE"/>
	</resultMap>			
				
	<select id="getListVinculoCliente" parameterClass="java.lang.String" resultMap="vinculoClienteResult">   
					SELECT CV.*,TV.COD_TIPO_VINC, CC.COD_CLIE
					FROM MAE_CLIEN_VINCU CV,MAE_TIPO_VINCU TV, MAE_CLIEN CC
					WHERE CV.CLIE_OID_CLIE_VNDO=#value#
					 AND CV.TIVC_OID_TIPO_VINC = TV.OID_TIPO_VINC          
					 AND CV.CLIE_OID_CLIE_VNTE = CC.OID_CLIE                                                                                  
	</select>
	
	<resultMap id="observacionClienteResult"   class="clienteObservacion">	
		<result property="oid"					column="OID_OBSE"/>
		<result property="oidMarca"				column="MARC_OID_MARC"/>
		<result property="oidCliente"			column="CLIE_OID_CLIE"/>
		<result property="numeroObservacion"	column="NUM_OBSE"/>
		<result property="texto"				column="VAL_TEXT"/>
	</resultMap>	


	<select id="getListObservacionCliente" parameterClass="java.lang.String" resultMap="observacionClienteResult">   
			          SELECT TEMP.*
					  FROM (SELECT CO.*
						    FROM MAE_CLIEN_OBSER CO
						    WHERE CO.CLIE_OID_CLIE = #value#
						    ORDER BY CO.NUM_OBSE) TEMP
						<![CDATA[				
						WHERE ROWNUM < 3									         
	    				]]>		                                                                                  
	</select>	
	
	<resultMap id="unidadAdministrativaResult"   class="clienteUnidadAdministrativa">	
		<result property="oid"								column="OID_CLIE_UNID_ADMI"/>    
		<result property="oidCliente"                       column="CLIE_OID_CLIE"/>    
		<result property="periodoInicio"                    column="PERD_OID_PERI_INI"/>    
		<result property="periodoFin"                       column="PERD_OID_PERI_FIN"/>    
		<result property="oidTerritorioAdministrativo"      column="ZTAD_OID_TERR_ADMI"/>    
		<result property="indicadorActivo"                  column="IND_ACTI"/>    
		<result property="codigoZona"                       column="COD_ZONA"/>    
		<result property="codigoTerritorio"                 column="COD_TERR"/>    
		<result property="codigoRegion"                     column="COD_REGI"/>    
		<result property="codigoSeccion"                    column="COD_SECC"/>
		<result property="codigoPeriodoInicio"              column="COD_PERI_INIC"/>
	</resultMap>	

	<select id="getUnidadAdministrativaCliente" parameterClass="java.lang.String" resultMap="unidadAdministrativaResult">   
				  SELECT  ua.*,zz.COD_ZONA,zt.COD_TERR,
				          zr.COD_REGI, zs.COD_SECC,
				          INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(ua.PERD_OID_PERI_INI) COD_PERI_INIC
				  FROM  MAE_CLIEN_UNIDA_ADMIN ua,
						ZON_TERRI_ADMIN zta,
						ZON_TERRI zt,
						ZON_ZONA  zz,
						ZON_SECCI zs,
						ZON_REGIO zr
				  WHERE  ua.CLIE_OID_CLIE = #value#
			  		  AND ua.PERD_OID_PERI_FIN IS NULL
				      AND ua.ZTAD_OID_TERR_ADMI =zta.OID_TERR_ADMI	 
					  AND zs.OID_SECC = zta.ZSCC_OID_SECC
					  AND zt.OID_TERR = zta.TERR_OID_TERR
					  AND zt.PAIS_OID_PAIS =zta.PAIS_OID_PAIS
				 	  AND zz.OID_ZONA = zs.ZZON_OID_ZONA
				 	  AND zr.OID_REGI = zz.ZORG_OID_REGI						  	                                                                              
	</select>				

	<update id="updateDatosBasicosCliente" parameterClass="clienteBasico">
								UPDATE MAE_CLIEN
								SET    VAL_APE1           = #apellido1#,
								       VAL_APE2           = #apellido2#,
								       VAL_NOM1           = #nombre1#,
								       VAL_NOM2           = #nombre2#,
								       VAL_TRAT           = #tratamiento#,			
								       COD_SEXO           =  #sexo#,
								       FOPA_OID_FORM_PAGO = #oidFormaPago#,
								       VAL_APEL_CASA      = #apellidoCasada#,
								       VAL_CRIT_BUS1 = #criterioBusqueda1#,
								       VAL_CRIT_BUS2 = #criterioBusqueda2#,
								       COD_CLIE 		  = #codigo#,
								       COD_DIGI_CTRL	  = #digitoControl#,
								       COD_CLIE_ANTE	  = #codigoAnterior#,
								       IND_ORIG_REGI      = #indicadorOrigen#,								       
								       USU_MODI  	      = #codigoUsuario#
								WHERE  OID_CLIE           = #oid#
	</update>


	<update id="updateDatosAdicionalesCliente" parameterClass="clienteAdicional">
				UPDATE MAE_CLIEN_DATOS_ADICI
				SET    CLIE_OID_CLIE      	   = #oidCliente#,
					   NSEP_OID_NSEP           = #oidNivelSocioEconomico#,			    
				       COD_EMPL                = #codigoEmpleado#,
				       FEC_NACI                = TRUNC(#fechaNacimiento#),
				       VAL_EDAD                = #edad#,
				       VAL_OCUP                = #ocupacion#,
				       VAL_PROF                = #profesion#,
				       VAL_CENT_TRAB           = #centroTrabajo#,
				       VAL_CARG_DESE           = #cargo#,
				       VAL_CENT_ESTU           = #centroEstudios#,
				       VAL_NIVE_SOCI_ECO3      = #nivelSocioEconomico3#,
				       NUM_HIJO                = #numeroHijos#,
				       NUM_PERS_DEPE           = #numeroDependientes#,
				       NUM_CAMP_SIN_PEDI       = #numeroCampanasSinPedido#,
				       IMP_INGR_FAMI           = #ingresoFamiliar#,
				       IMP_MONT_LINE_CRED      = #montoLineaCredito#,
				       NIRI_OID_NIVE_RIES      = #oidNivelRiesgo#,
				       NIED_OID_NIVE_ESTU      = #oidNivelEstudios#,
				       SNON_OID_NACI           = #oidNacionalidad#,
				       ESCV_OID_ESTA_CIVI      = #oidEstadoCivil#,
				       PERD_OID_PERI_NIVE_RIES = #oidPeriodoNivelRiesgo#,
				       PERD_OID_PERI_LINE_CRED = #oidPeriodoLineaCredito#,
				       IND_CORR                = #indicadorCorrespondencia#,
				       IND_ACTI                = #indicadorActivo#,
				       ESTA_OID_ESTA_CLIE      = #oidEstatusCliente#,
				       TCLV_OID_CICL_VIDA      = #oidCicloVida#,
				       VAL_EMAI                = #email#,
				       TCUT_OID_TIPO_CUTI	   = #oidTipoCutis#,
				       OTMA_OID_OTRA_MARC	   = #oidOtrasMarcas#,
				       COD_CUB                 = #codigoCUB#,		       
				       IND_COMP                = #indicadorCompromiso#,
				       VAL_MOTI_COMP           = #motivo#,
				       IND_IMPR_PDOC           = #indicadorImpresionPaqDoc#,
				       COD_GRUP_FUNC		   = #codGrupoFuncional#,
				       DES_GRUP_FUNC		   = #desGrupoFuncional#, 
				       VAL_USUA_RED			   = #usuRed#,
				       VAL_RELA_CONT           = #valRelContr#,
				       VAL_NOM_JEFE			   = #nomJefeDir#,
				       VAL_PUE_ORG             = #valPueOrg#,
				       COD_CUB_JEFE            = #codJefeCUB#,
				       USU_MODI  	      	   = #codigoUsuario#,
				       <isEqual property="cambioImprDocu" compareValue="1">
					   USU_CARG				   = #usuCarg#,
					   		<isNull property="usuCarg">
					   			FEC_CARG			= null,
					   		</isNull>
					   		<isNotNull property="usuCarg">
					   			FEC_CARG			= SYSDATE,
					   		</isNotNull>
					   TIP_CARG				= #tipCarg#,
					   </isEqual>
			           IND_IMPR_DOCU			= #indImprDocu#,
			           FEC_ULTI_ACTU			= SYSDATE,
			           IND_DOC_FISC		        =  #indDocFiscal#,
			           TPES_OID_TIPO_PERS		=  #valTipoPersona# ,	
			           ORIN_OID_ORIG_INGR		=  #valOrigenIngreso#,
			           NUM_CUEN_BANC			=  #valCuentaCorriente#,
			           IND_GENE_PERC			=  #indicadorCalularPercepcion#,
			           BTCU_COD_TIPO_CUEN		=  #valTipoCuenta#,
			           BBPA_COD_BANC_PAGA		=  #valBanco#                        
				WHERE  OID_CLIE_DATO_ADIC      = #oid#
	</update> 
	       
	                          
	<update id="updatePrimerContactoCliente" parameterClass="clientePrimerContacto">
							UPDATE MAE_CLIEN_PRIME_CONTA
							SET    CLIE_OID_CLIE      = #oidCliente#,
								   CTSU_CLIE_CONT     = #oidClienteSubTipo#,
								   
								<isNotEmpty property="sFechaContacto">
							       FEC_CONT           = TO_DATE(#sFechaContacto#,'DD/MM/YYYY'),
							    </isNotEmpty>
					             <isEmpty property="sFechaContacto">
					             	FEC_CONT           = TRUNC(#fechaContacto#),
					             </isEmpty>   
					             <isNotEmpty property="sFechaSiguienteContacto">
							       FEC_SIGU_CONT      = TO_DATE(#sFechaSiguienteContacto#,'DD/MM/YYYY'),
							     </isNotEmpty>
					             <isEmpty property="sFechaSiguienteContacto">
					             	FEC_SIGU_CONT      = TRUNC(#fechaSiguienteContacto#),
					             </isEmpty>
					               
							       COD_TIPO_CONT      = #codigoTipoContacto#,
							       MARC_OID_MARC      = #oidMarca#,
							       CANA_OID_CANA      = #oidCanal#,
							       PERD_OID_PERI      = #oidPeriodo#,
							       USU_MODI  	      = #codigoUsuario#,
							       FEC_ULTI_ACTU	  = SYSDATE
							WHERE  OID_CLIE_PRIM_CONT = #oid#
	
	</update>    		   	       
		
	<update id="updateIdentificacionCliente" parameterClass="clienteIdentificacion">
				 UPDATE  MAE_CLIEN_IDENT
					SET  TDOC_OID_TIPO_DOCU = #oidTipoDocumento#,
					     CLIE_OID_CLIE      = #oidCliente#,
					     NUM_DOCU_IDEN      = #numeroDocumento#,
					     VAL_IDEN_DOCU_PRIN = #indicadorPrincipal#,
					     VAL_IDEN_PERS_EMPR = #identificadorPersonal#,
					     SBTD_COD_SUBT_DOCU = #codigoSubtipoDocumento#,
					     USU_MODI		    = #codigoUsuario#,
					     FEC_ULTI_ACTU		= SYSDATE
				  WHERE  OID_CLIE_IDEN      = #oid#
	</update>

	<delete id="deleteIdentificacionCliente" parameterClass="clienteIdentificacion">
					DELETE FROM  MAE_CLIEN_IDENT
					WHERE  OID_CLIE_IDEN      = #oid#
	</delete>    

	<update id="updateTipoSubtipoCliente" parameterClass="clienteSubTipo">
						UPDATE MAE_CLIEN_TIPO_SUBTI
						SET    
						       CLIE_OID_CLIE      = #oidCliente#,
						       TICL_OID_TIPO_CLIE = #oidTipoCliente#,
						       SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#,
						       IND_PPAL           = #indicadorPrincipal#,
						       USU_MODI			  = #codigoUsuario#,
						       FEC_ULTI_ACTU	  = SYSDATE
						WHERE  OID_CLIE_TIPO_SUBT = #oid#
	
	</update>     

	<delete id="deletePrimerContactoHijaDupla" parameterClass="clienteSubTipo">
					DELETE FROM  MAE_CLIEN_PRIME_CONTA
					WHERE  CTSU_CLIE_CONT      = #oid#
	</delete>         
	
	<delete id="deleteTipoSubtipoCliente" parameterClass="clienteSubTipo">
					DELETE FROM  MAE_CLIEN_TIPO_SUBTI
					WHERE  OID_CLIE_TIPO_SUBT      = #oid#
	</delete>         

	<update id="updateClasificacionCliente" parameterClass="clienteClasificacion">
					UPDATE MAE_CLIEN_CLASI
					SET    CTSU_OID_CLIE_TIPO_SUBT = #oidClienteSubTipo#,
					       CLAS_OID_CLAS           = #oidClasificacion#,
					       PERD_OID_PERI           = #oidPeriodo#,
					       TCCL_OID_TIPO_CLASI     = #oidTipoClasificacion#,
					       FEC_CLAS                = DECODE(#fechaClasificacion#, NULL, NULL,TRUNC(#fechaClasificacion#)),
					       IND_PPAL                = #indicadorPrincipal#,
					       USU_MODI  	           = #codigoUsuario#
					WHERE  OID_CLIE_CLAS           = #oid#
	</update>     

	<delete id="deleteClasificacionCliente" parameterClass="clienteClasificacion">
					DELETE FROM  MAE_CLIEN_CLASI
					WHERE  OID_CLIE_CLAS      = #oid#
	</delete>         
		                	          
	<update id="updateDireccionCliente" parameterClass="clienteDireccion">
						UPDATE MAE_CLIEN_DIREC
						SET    CLIE_OID_CLIE      = #oidCliente#,
						       TIDC_OID_TIPO_DIRE = #oidTipoDireccion#,
						       TIVI_OID_TIPO_VIA  = #oidTipoVia#,
						       TERR_OID_TERR      = #oidTerritorio#,
						       ZVIA_OID_VIA       = #oidVia#,
						       NUM_PPAL           = #numeroPrincipal#,
						       VAL_NOMB_VIA       = #nombreVia#,
						       VAL_COD_POST       = #codigoPostal#,
						       VAL_INTE           = #interior#,
						       VAL_MANZ           = #manzana#,
						       VAL_LOTE           = #lote#,
						       VAL_KM             = #kilometro#,
						       VAL_OBSE           = #observaciones#,
						       VAL_NOMB_FICH      = #nombreFichero#,
						       VAL_COOR_X         = #coordenadaX#,
						       VAL_COOR_Y         = #coordenadaY#,
						       VAL_COOR_Z         = #coordenadaZ#,
						       IND_DIRE_PPAL      = #indicadorDireccionPrincipal#,
						       IND_CTRL_INTE_GEOR = #indicadorEstandarizacionGIS#,
						       COD_UNID_GEOG      = #codigoUnidadGeografica#,
						       IND_ELIM           = #indicadorEliminacion#,
						       VAL_BARR           = #barrio#,
						       CIUD_COD_CIUD	  = #codigoCiudad#,
						       CIUD_COD_UGEO_REGI = #codigoUbigeo1#,
						       
						       <isNotEmpty property="codigoPeriodoInicio">
				             	   PERD_OID_CAMP_INIC = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoInicio#),
 	 			               </isNotEmpty>
				               <isNotEmpty property="codigoPeriodoFin">
				        	   	   PERD_OID_CAMP_FINA = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoFin#),
						       </isNotEmpty>
						       
						       DES_VILLA_POBL	  = #villaPoblacion#,
						       USU_MODI  	      = #codigoUsuario#,
						       ZCAL_COR_ZCAL      = #correVia#,
						       FEC_ULTI_ACTU	  = SYSDATE,
						       
						       VAL_ETA_CONJ      = #valEtapaConjunto#,
						       VAL_CAL_PRIN      = #valCallePrincipal#,
						       VAL_CAL_SECU      = #valCalleSecundaria#,
						       VAL_NOM_MANZ      = #valNomManzana#,
						       TECO_COD_TERR_CORR = #valCodigoTerritorialCorresponde# 	
						       
						WHERE  OID_CLIE_DIRE      = #oid#
	
	</update>     
	
	
	<update id="updateDireccionClienteCamposAdicionales" parameterClass="clienteDireccion">
						UPDATE MAE_CLIEN_DIREC
						SET    CLIE_OID_CLIE      = #oidCliente#,
						       TIDC_OID_TIPO_DIRE = #oidTipoDireccion#,
						       TIVI_OID_TIPO_VIA  = #oidTipoVia#,
						       TERR_OID_TERR      = #oidTerritorio#,
						       ZVIA_OID_VIA       = #oidVia#,
						       NUM_PPRI           = #numeroPrincipal#,
						       VAL_NOMB_VIA       = '',
						       VAL_COD_POST       = #codigoPostal#,
						       VAL_INTE           = #interior#,
						       VAL_MANZ           = #manzana#,
						       VAL_LOTE           = #lote#,
						       VAL_KM             = #kilometro#,
						       VAL_OBSE           = #observaciones#,
						       VAL_NOMB_FICH      = #nombreFichero#,
						       VAL_COOR_X         = #coordenadaX#,
						       VAL_COOR_Y         = #coordenadaY#,
						       VAL_COOR_Z         = #coordenadaZ#,
						       IND_DIRE_PPAL      = #indicadorDireccionPrincipal#,
						       IND_CTRL_INTE_GEOR = #indicadorEstandarizacionGIS#,
						       COD_UNID_GEOG      = #codigoUnidadGeografica#,
						       IND_ELIM           = #indicadorEliminacion#,
						       VAL_BARR           = #barrio#,
						       CIUD_COD_CIUD	  = #codigoCiudad#,
						       CIUD_COD_UGEO_REGI = #codigoUbigeo1#,
						       
						       <isNotEmpty property="codigoPeriodoInicio">
				             	   PERD_OID_CAMP_INIC = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoInicio#),
 	 			               </isNotEmpty>
				               <isNotEmpty property="codigoPeriodoFin">
				        	   	   PERD_OID_CAMP_FINA = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodoFin#),
						       </isNotEmpty>
						       
						       DES_VILLA_POBL	  = #villaPoblacion#,
						       USU_MODI  	      = #codigoUsuario#,
						       ZCAL_COR_ZCAL      = #correVia#,
						       FEC_ULTI_ACTU	  = SYSDATE,
						       
						       VAL_ETA_CONJ      = #valEtapaConjunto#,
						       VAL_CAL_PRIN      = #valCallePrincipal#,
						       VAL_CAL_SECU      = #valCalleSecundaria#,
						       VAL_NOM_MANZ      = #valNomManzana#,
						       TECO_COD_TERR_CORR = #valCodigoTerritorialCorresponde# 	
						       
						WHERE  OID_CLIE_DIRE      = #oid#
	
	</update>     
	
	
	
	<update id="deleteDireccionCliente" parameterClass="clienteDireccion">
						UPDATE MAE_CLIEN_DIREC
						SET   IND_ELIM           = '1',
						      USU_MODI  	     = #codigoUsuario#,
						      FEC_ULTI_ACTU		 = SYSDATE
						WHERE  OID_CLIE_DIRE      = #oid#
	</update>   
	
	
	<update id="updateComunicacionCliente" parameterClass="clienteComunicacion">
					UPDATE MAE_CLIEN_COMUN
					SET    CLIE_OID_CLIE      = #oidCliente#,
					       TICM_OID_TIPO_COMU = #oidTipoComunicacion#,
					       VAL_DIA_COMU       = #diaComunicacion#,
					       VAL_TEXT_COMU      = #textoComunicacion#,
					       FEC_HORA_DESD      = #fechaDesde#,
					       FEC_HORA_HAST      = #fechaHasta#,
					       VAL_INTE_COMU      = #intervaloComunicacion#,
					       IND_COMU_PPAL      = #indicadorPrincipal#,
					       USU_MODI  	      = #codigoUsuario#,
					       FEC_ULTI_ACTU	  = SYSDATE
					WHERE  OID_CLIE_COMU      = #oid#
	
	</update> 
	
	<update id="updateUnidadAdministrativaCliente" parameterClass="clienteUnidadAdministrativa">
							UPDATE MAE_CLIEN_UNIDA_ADMIN
							SET    PERD_OID_PERI_INI  = #periodoInicio#,
							       PERD_OID_PERI_FIN  = #periodoFin#,
							       ZTAD_OID_TERR_ADMI = #oidTerritorioAdministrativo#,
							       IND_ACTI           = #indicadorActivo#,
							       USU_MODI  	      = #codigoUsuario#,
							       FEC_ULTI_ACTU	  = SYSDATE	 
							       <isNotEmpty property="indicadorCambio">
				             	      ,FEC_CAMB = SYSDATE
 	 			               		</isNotEmpty>
							WHERE  OID_CLIE_UNID_ADMI = #oid#
	
	</update>        
	
	
	<update id="updateVinculoCliente" parameterClass="clienteVinculo">
							UPDATE MAE_CLIEN_VINCU
							SET    FEC_DESD           = #fechaDesde#,
							       FEC_HAST           = #fechaHasta#,
							       CLIE_OID_CLIE_VNTE = #oidClienteVinculante#,
							       CLIE_OID_CLIE_VNDO = #oidCliente#,
							       TIVC_OID_TIPO_VINC = #oidTipoVinculo#,
							       IND_VINC_PPAL      = #indicadorPrincipal#,
							       USU_MODI  	      = #codigoUsuario#,
							       FEC_ULTI_ACTU	  = SYSDATE	
							WHERE  OID_CLIE_VINC      = #oid#
	</update>   
	
	<update id="updateObservacionCliente" parameterClass="clienteObservacion">
							UPDATE MAE_CLIEN_OBSER
							SET    MARC_OID_MARC = #oidMarca#,
							       CLIE_OID_CLIE = #oidCliente#,
							       NUM_OBSE      = #numeroObservacion#,
							       VAL_TEXT      = #texto#,
							       USU_MODI  	 = #codigoUsuario#
							WHERE  OID_OBSE      = #oid#
	</update>   		   
	
   <select id="getDevuelveOidCampanha" parameterClass="java.util.Map" resultClass="string">
			SELECT 
 				GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(
						PER_PKG_REPOR_PERCE.PER_FN_OBTIE_PERIO(#codigoPeriodo#,
    														 #oidPais#,
															 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA('T'),
															 GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL('VD'),
															 #numeroCampanna#))  
				FROM DUAL                                                                     	
   </select>	             
   
   	<delete id="deleteComunicacionCliente" parameterClass="clienteComunicacion">
					DELETE FROM MAE_CLIEN_COMUN
					WHERE  OID_CLIE_COMU      = #oid#															
	</delete>   


    <!-- OBTIENE LA LISTA DE PERIODOS POR PAIS MARCA Y CANAL -->
    <select id="getPeriodosByPaisMarcaCanal" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT DISTINCT CRA_PERIO.OID_PERI AS OID,
		       SEG_PERIO_CORPO.COD_PERI AS DESCRIPCION 	   	   	   
	      FROM  CRA_PERIO,
		   		SEG_MARCA,
		       	SEG_CANAL,
		       	SEG_PAIS,
		       	SEG_PERIO_CORPO
		  WHERE ((SEG_PAIS.COD_PAIS  = #codigoPais#)
		  		<isNotEmpty prepend="AND" property="codigoMarca">
				   (SEG_MARCA.COD_MARC = #codigoMarca#)
				</isNotEmpty>
				<isNotEmpty prepend="AND" property="codigoCanal">
				   (SEG_CANAL.COD_CANA = #codigoCanal#)
				</isNotEmpty>
	      AND	(SEG_PAIS.OID_PAIS = CRA_PERIO.PAIS_OID_PAIS)
		  AND   (SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC)
	      AND	(SEG_CANAL.OID_CANA = CRA_PERIO.CANA_OID_CANA)
	      AND	(SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
	      AND	(SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI)
	            )
		  ORDER BY 2 ASC  
    </select>

    <!-- VERIFICA SI EL TIPO DOCUMENTO ES DE SIGLA = RUC -->
    <select id="getTipoDocumentoSiglaRUC" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(*)    
		  FROM MAE_TIPO_DOCUM
		 WHERE PAIS_OID_PAIS = #oidPais#
		   AND VAL_SIGL = 'RUC'
		   AND OID_TIPO_DOCU = #oidTipoDocumento#    
    </select>

    <!-- VERIFICA SI EL CLIENTE HA FACTURADO -->
    <select id="getClienteHaFacturado" parameterClass="java.util.Map" resultClass="string">
		 SELECT COUNT(*)
		  FROM PED_SOLIC_CABEC
		 WHERE PAIS_OID_PAIS = #oidPais#
		   AND CLIE_OID_CLIE = #oidCliente#
		   
		 <iterate prepend="AND" property="periodo" open="(" close=")" conjunction="OR">
			 PERD_OID_PERI = #periodo[]#
         </iterate>

    </select>
    	
    <!-- VERIFICA SI LA REGION DE LA ZONA YA PROCESO CIERRE DE REGION PARA LA CAMPAÃ‘A ACTUAL -->
    <select id="getRegionCerradaxZona" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(con.OID_CTRL)
		  FROM FAC_CONTR_CIERR con,
		       FAC_TIPOS_CIERR tip,
		       CRA_PERIO cra,
		       SEG_PERIO_CORPO cor,
		       SEG_PAIS pai,
		       ZON_REGIO reg,
		       ZON_ZONA zon,
		       SEG_MARCA mar,
		       SEG_CANAL can
		 WHERE con.TCIE_OID_TIPO_CIER = tip.OID_TIPO_CIER
		   AND cra.OID_PERI = con.PERD_OID_PERI
		   AND cor.OID_PERI = cra.PERI_OID_PERI
		   AND pai.OID_PAIS = cra.PAIS_OID_PAIS
		   AND reg.OID_REGI = con.ZORG_OID_REGI
		   AND zon.ZORG_OID_REGI = reg.OID_REGI
		   AND zon.COD_ZONA = #codigoZona#
		   AND tip.COD_TIPO_CIER = 'R'
 	       
 	       <isNotEmpty property="codigoPeriodo">
		     AND cor.COD_PERI = #codigoPeriodo#
		   </isNotEmpty>
		   
		   <isNotEmpty property="oidPeriodo">
		     AND cra.OID_PERI = #oidPeriodo#
		   </isNotEmpty>
		   
		   AND pai.COD_PAIS = #codigoPais#
		   
		   <isNotEmpty property="codigoMarca">
		     AND mar.COD_MARC = #codigoMarca#
		   </isNotEmpty>
		   
		   <isNotEmpty property="codigoCanal">
		     AND can.COD_CANA = #codigoCanal#
		   </isNotEmpty>
		   
		   AND con.VAL_RESU_PROC = 'OK'
		   AND reg.MARC_OID_MARC = mar.OID_MARC
		   AND reg.CANA_OID_CANA = can.OID_CANA
		   AND reg.PAIS_OID_PAIS = pai.OID_PAIS
    </select>
    	
   <!-- OBTIENE LA SIGUIENTE CAMPAÃ‘A -->
    <select id="getSiguientePeriodo" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT OID_PERI OID, COD_PERI DESCRIPCION
		FROM (
		  SELECT B.OID_PERI, C.COD_PERI
		    FROM CRA_PERIO A, cra_perio B, SEG_PERIO_CORPO C, SEG_MARCA M, SEG_CANAL S, SEG_PAIS P, SEG_PERIO_CORPO D
		   WHERE B.PAIS_OID_PAIS = A.PAIS_OID_PAIS 
		     AND B.MARC_OID_MARC = A.MARC_OID_MARC 
		     AND B.CANA_OID_CANA = A.CANA_OID_CANA 
		     AND B.FEC_INIC > A.FEC_INIC 
		     AND C.OID_PERI = B.PERI_OID_PERI
		     AND D.OID_PERI = A.PERI_OID_PERI     
		     AND A.MARC_OID_MARC = M.OID_MARC
		     AND A.CANA_OID_CANA = S.OID_CANA
		     AND A.PAIS_OID_PAIS = p.OID_PAIS
		     AND P.COD_PAIS = #codigoPais#
		     AND M.COD_MARC = #codigoMarca#
		     AND S.COD_CANA = #codigoCanal#
		     
		     <isNotEmpty property="codigoPeriodo">
		     	AND D.COD_PERI = #codigoPeriodo#
		     </isNotEmpty>
		     
		     <isNotEmpty property="oidPeriodo">
		     	AND A.OID_PERI = #oidPeriodo#
		     </isNotEmpty>			
		     			
		   ORDER BY B.FEC_INIC  
		)
		WHERE ROWNUM = 1  
    </select>
        
    <!-- VERIFICA SI PARA EL PAIS, SE RECALCULA EL PERIODO DE INGRESO -->
    <select id="getPaisCalculaPeriodoIngreso" parameterClass="string" resultClass="string">
		SELECT COUNT(*)
		FROM   BAS_PAIS
		WHERE  COD_PAIS = #value#
		  AND  IND_PERI_INGR = '1'
    </select>

    <!-- OBTIENE LA FECHA DE INICIO DE LA CAMPAÃ‘A -->
    <select id="getFechaInicioPeriodo" parameterClass="java.util.Map" resultClass="string">
		SELECT TO_CHAR(FEC_INIC, 'DD/MM/YYYY')
		  FROM CRA_PERIO
		 WHERE OID_PERI = #oidPeriodo#

   	   	  <isNotEmpty property="fecha">
		   	<![CDATA[
	    	 	AND TO_DATE(#fecha#,'DD/MM/YYYY') >= FEC_INIC
		    	AND TO_DATE(#fecha#,'DD/MM/YYYY') <= FEC_FINA
		    ]]>
		  </isNotEmpty>		   
    </select>
    
    <!-- OBTIENE EL MODULO CORRESPONDIENTE A LA VALIDACION SELECCIONADO PARA EL PAIS, SINO SE ENCUENTRA SE OBTENDRA NULL -->
    <select id="getValorModuloxPaisTipoValidacion" parameterClass="java.util.Map" resultClass="string">
		SELECT MOD_VALI
		  FROM MAE_CLIEN_MODUL
		 WHERE COD_PAIS = #codigoPais#
		   AND TIP_VALI = #tipoValidacion#
		   AND IND_ACTI = '1'
    </select>

	<update id="updateRecomendado" parameterClass="clienteConcursoPremio">
	    UPDATE INC_CLIEN_RECDO
	       SET PANP_OID_PARA_NIVE_PREM = #oidNivelPremio#,
	           NUM_PREM = #numeroPremio#
	     WHERE OID_CLIE_REDO = #oidClienteRecomendado#      
	</update>    

	<select id="getTipoVinculo" resultMap="baseResult">
			SELECT COD_TIPO_VINCU CODIGO, 
				   DES_TIPO_VINCU DESCRIPCION
			FROM MAE_TIPO_VINCU_SSICC
	</select>

	<insert id="insertClienteReferenciaFamiliar" parameterClass="clienteReferencia">
		INSERT INTO MAE_REFER (
		   COD_CLIE, TIPO_REFE, TIPO_DOCU_REFE,NUM_DOCU_REFE, VAL_APE1, VAL_APE2, 
		   VAL_NOM1, VAL_NOM2, VAL_DIRE,VAL_BARR, VAL_CIUD, VAL_DEPA, 
		   VAL_TELF, VAL_CELU, VAL_TELF_TRAB,TIPO_VIA, VAL_NOM_VIA, NUM_DIRE, 
		   COD_DEPA, COD_PROV, COD_DIST,COD_SECT, TIPO_VINCU, NOM_EMPRE, 
		   DIR_EMPRE, CARG_EMPRE, USU_MODI, FEC_MODI, FEC_CREA, USU_CREA) 
		VALUES (#codigoCliente# ,'1' ,null ,null, #apellido1RefFamiliar#, #apellido2RefFamiliar#
		,#nombre1RefFamiliar#, #nombre2RefFamiliar#, #direccionRefFamiliar# ,#barrioRefFamiliar# , null, null
		,#telefonoCasaRefFamiliar# , #telefonoCelRefFamiliar#, null,null , null, null
		,null , null, null,null ,#codigoTipoVinculoRefFamiliar#, null
		,null , null, #codigoUsuario#, SYSDATE, SYSDATE, #auditInfo.createdBy#)	
	</insert>	
	
	<insert id="insertClienteReferenciaNoFamiliar" parameterClass="clienteReferencia">
		INSERT INTO MAE_REFER (
		   COD_CLIE, TIPO_REFE, TIPO_DOCU_REFE,NUM_DOCU_REFE, VAL_APE1, VAL_APE2, 
		   VAL_NOM1, VAL_NOM2, VAL_DIRE,VAL_BARR, VAL_CIUD, VAL_DEPA, 
		   VAL_TELF, VAL_CELU, VAL_TELF_TRAB,TIPO_VIA, VAL_NOM_VIA, NUM_DIRE, 
		   COD_DEPA, COD_PROV, COD_DIST,COD_SECT, TIPO_VINCU, NOM_EMPRE, 
		   DIR_EMPRE, CARG_EMPRE, USU_MODI, FEC_MODI, FEC_CREA, USU_CREA) 
		VALUES (#codigoCliente# ,'2' ,null ,null, #apellido1RefNoFamiliar#, #apellido2RefNoFamiliar#
		,#nombre1RefNoFamiliar#, #nombre2RefNoFamiliar#, #direccionRefNoFamiliar# ,#barrioRefNoFamiliar# , null, null
		,#telefonoCasaRefNoFamiliar#, #telefonoCelRefNoFamiliar#, null,null , null, null
		,null , null, null,null ,#codigoTipoVinculoRefNoFamiliar#, null
		,null , null, #codigoUsuario#, SYSDATE, SYSDATE, #auditInfo.createdBy#)	
	</insert>		

	<insert id="insertClienteReferenciaAval" parameterClass="clienteReferencia">

		 INSERT INTO MAE_REFER (
			   COD_CLIE, TIPO_REFE, TIPO_DOCU_REFE,NUM_DOCU_REFE, VAL_APE1, VAL_APE2, 
			   VAL_NOM1, VAL_NOM2, VAL_DIRE,VAL_BARR, VAL_CIUD, VAL_DEPA, 
			   VAL_TELF, VAL_CELU, VAL_TELF_TRAB,TIPO_VIA, VAL_NOM_VIA, NUM_DIRE, 
			   COD_DEPA, COD_PROV, COD_DIST,COD_SECT, TIPO_VINCU, NOM_EMPRE, 
			   DIR_EMPRE, CARG_EMPRE, USU_MODI, FEC_MODI, FEC_CREA, USU_CREA) 
		VALUES (#codigoCliente# ,'3' ,NVL((SELECT a.COD_TIPO_DOCU 
	   				  				    FROM MAE_TIPO_DOCUM A
					  					WHERE A.OID_TIPO_DOCU = #oidTipoDocumentoAval#),
					  					(SELECT MIN(X.COD_TIPO_DOCU) 
	   				  				     FROM MAE_TIPO_DOCUM X
					  					 WHERE X.IND_OBLI = '1'))	 
				,#numeroDocumentoAval#, #apellido1Aval#, #apellido2Aval#
		,#nombre1Aval#, #nombre2Aval#, #direccionAval# ,#barrioAval# , null, null
		,#telefonoCasaAval#, #telefonoCelAval#, null,null , null, null
		,#estado#,#municipio#,#parroquia#,null ,#codigoTipoVinculoAval#, null
		,null , null, #codigoUsuario#, SYSDATE, SYSDATE, #auditInfo.createdBy#)
	
	</insert>	        

	<resultMap id="clienteReferenciaResult"   class="java.util.HashMap">	
		<result property="codigoCliente"					column="COD_CLIE"/>    
		<result property="tipoReferencia"                   column="TIPO_REFE"/>        
		<result property="numeroDocumento"                  column="NUM_DOCU_REFE"/>    
		<result property="apellido1"      					column="VAL_APE1"/>    
		<result property="apellido2"                  		column="VAL_APE2"/>    
		<result property="nombre1"                       	column="VAL_NOM1"/>    
		<result property="nombre2"                 			column="VAL_NOM2"/>
		<result property="direccion"                 		column="VAL_DIRE"/>
		<result property="barrio"                 	    	column="VAL_BARR"/>
		<result property="telefonoCasa"                 	column="VAL_TELF"/>
		<result property="telefonoCelular"                 	column="VAL_CELU"/>
		<result property="codigoDpto"                 		column="COD_DEPA"/>
		<result property="codigoProvincia"                 	column="COD_PROV"/>
		<result property="codigoDistrito"                 	column="COD_DIST"/>
		<result property="tipoVinculo"                 		column="TIPO_VINCU"/>	
		<result property="oidTipoDocumento"                 column="OID_TIPO_DOCU"/>					
	</resultMap>	
		
    <select id="getListClienteReferencia" parameterClass="java.util.Map" resultMap="clienteReferenciaResult">
		SELECT A.*,
		     	(SELECT x.OID_TIPO_DOCU
	   			 FROM MAE_TIPO_DOCUM x
				 WHERE x.COD_TIPO_DOCU =a.TIPO_DOCU_REFE) OID_TIPO_DOCU 
		  FROM MAE_REFER A
		 WHERE A.COD_CLIE = #codigoCliente#
				<isNotEmpty prepend="AND" property="tipoReferencia">
				   (A.TIPO_REFE = #tipoReferencia#)
				</isNotEmpty>
    </select>	
    
    
    <update id="updateReferenciasFamiliar" parameterClass="clienteReferencia">
			UPDATE MAE_REFER
			SET    VAL_APE1       = #apellido1RefFamiliar#,
			       VAL_APE2       = #apellido2RefFamiliar#,
			       VAL_NOM1       = #nombre1RefFamiliar#,
			       VAL_NOM2       = #nombre2RefFamiliar#,
			       VAL_DIRE       = #direccionRefFamiliar#,
			       VAL_TELF       = #telefonoCasaRefFamiliar#,
			       VAL_CELU       = #telefonoCelRefFamiliar#,
			       TIPO_VINCU     = #codigoTipoVinculoRefFamiliar#,
			       USU_MODI  	  = #codigoUsuario#,
			       FEC_MODI       = SYSDATE
			WHERE  COD_CLIE       = #codigoCliente#     
			 AND TIPO_REFE = '1'							
	</update> 
	
	<update id="updateReferenciasNoFamiliar" parameterClass="clienteReferencia">
			UPDATE MAE_REFER
			SET    VAL_APE1       = #apellido1RefNoFamiliar#,
			       VAL_APE2       = #apellido2RefNoFamiliar#,
			       VAL_NOM1       = #nombre1RefNoFamiliar#,
			       VAL_NOM2       = #nombre2RefNoFamiliar#,
			       VAL_DIRE       = #direccionRefNoFamiliar#,
			       VAL_TELF       = #telefonoCasaRefNoFamiliar#,
			       VAL_CELU       = #telefonoCelRefNoFamiliar#,
			       TIPO_VINCU     = #codigoTipoVinculoRefNoFamiliar#,
			       USU_MODI  	  = #codigoUsuario#,
			       FEC_MODI       = SYSDATE
			WHERE  COD_CLIE       = #codigoCliente#     
			 AND TIPO_REFE = '2'							
	</update>
	
	<update id="updateReferenciasAval" parameterClass="clienteReferencia">
			UPDATE MAE_REFER
			SET    TIPO_DOCU_REFE = (SELECT a.COD_TIPO_DOCU 
				   				  	 FROM MAE_TIPO_DOCUM A
								  	 WHERE A.OID_TIPO_DOCU = #oidTipoDocumentoAval#),
				   NUM_DOCU_REFE 	=	#numeroDocumentoAval#,				
				   VAL_APE1       = #apellido1Aval#,
			       VAL_APE2       = #apellido2Aval#,
			       VAL_NOM1       = #nombre1Aval#,
			       VAL_NOM2       = #nombre2Aval#,
			       VAL_DIRE       = #direccionAval#,
			       VAL_TELF       = #telefonoCasaAval#,
			       VAL_CELU       = #telefonoCelAval#,
			       COD_DEPA       = #estado#,
			       COD_PROV       = #municipio#,
			       COD_DIST       = #parroquia#,       
			       TIPO_VINCU     = #codigoTipoVinculoAval#,
			       USU_MODI  	  = #codigoUsuario#,
			       FEC_MODI       = SYSDATE
			WHERE  COD_CLIE       = #codigoCliente#     
			 AND TIPO_REFE = '3'							
	</update>
	
	 <delete id="deleteReferencias" parameterClass="clienteReferencia">
					DELETE FROM MAE_REFER
					WHERE  COD_CLIE       = #codigoCliente#		
					 AND TIPO_REFE IN ('1','2','3')												
	</delete>  
	
    <!-- VERIFICA SI LA ZONA YA PROCESO CIERRE DE ZONA PARA LA CAMPAÃ‘A ACTUAL -->
    <select id="getZonaCerrada" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(con.OID_CTRL)
		  FROM FAC_CONTR_CIERR con,
		       FAC_TIPOS_CIERR tip,
		       CRA_PERIO cra,
		       SEG_PERIO_CORPO cor,
		       SEG_PAIS pai,
		       ZON_ZONA zon,
		       SEG_MARCA mar,
		       SEG_CANAL can
		 WHERE con.TCIE_OID_TIPO_CIER = tip.OID_TIPO_CIER
		   AND cra.OID_PERI = con.PERD_OID_PERI
		   AND cor.OID_PERI = cra.PERI_OID_PERI
		   AND pai.OID_PAIS = cra.PAIS_OID_PAIS
		   AND zon.OID_ZONA = con.ZZON_OID_ZONA
		   AND zon.COD_ZONA = #codigoZona#
           AND tip.COD_TIPO_CIER = 'Z'
		   AND cor.COD_PERI = #codigoPeriodo#
		   AND pai.COD_PAIS = #codigoPais#
		   AND mar.COD_MARC = #codigoMarca#
		   AND can.COD_CANA = #codigoCanal#
		   AND con.VAL_RESU_PROC = 'OK'
		   AND zon.MARC_OID_MARC = mar.OID_MARC
		   AND zon.CANA_OID_CANA = can.OID_CANA
		   AND zon.PAIS_OID_PAIS = pai.OID_PAIS 
    </select>
	
    <!-- OBTIENE EL OID DEL TIPO DE VIA -->
    <select id="getOidTipoVia" parameterClass="string" resultClass="long">
		SELECT OID_TIPO_VIA
		  FROM SEG_TIPO_VIA
		 WHERE COD_TIPO_VIA = #value#
	</select>
	
	<!-- ACTUALIZAMOS INDICADOR DE ACTIVO AL CLIENTE -->
    <update id="updateIndicadorActivoClienteVinculo" parameterClass="string">
		UPDATE MAE_CLIEN_DATOS_ADICI
   		   SET IND_ACTI = '0'
 		 WHERE CLIE_OID_CLIE IN (SELECT CLIE_OID_CLIE_VNDO FROM MAE_CLIEN_VINCU
         			                WHERE OID_CLIE_VINC = #value#)
    </update>
    
    <!-- RECUPERAMOS LOS OIDS DE CLIENTE RECOMENDANTE (INCENTIVOS) -->
    <select id="getOidsRecomendante" parameterClass="java.util.Map" resultClass="string">
	    SELECT rte.OID_CLIE_RETE 
  		  FROM INC_CLIEN_RECDO rdo, INC_CLIEN_RECTE rte
 		 WHERE rdo.CLIE_OID_CLIE = #oidClienteRecomendado#
   		   AND rte.OID_CLIE_RETE = rdo.CLR3_OID_CLIE_RETE
   		   AND rte.CLIE_OID_CLIE = #oidClienteRecomendante#
    </select>
    
    <!-- ELIMINAMOS LOS CLIENTES RECOMENDADOS (INCENTIVOS) -->
	<delete id="deleteRecomendados" parameterClass="java.util.Map">
	    DELETE FROM INC_CLIEN_RECDO
		WHERE OID_CLIE_REDO IN (SELECT rdo.OID_CLIE_REDO
		                          FROM INC_CLIEN_RECDO rdo, INC_CLIEN_RECTE rte
		                         WHERE rdo.CLIE_OID_CLIE = #oidClienteRecomendado# 
		                           AND rte.OID_CLIE_RETE = rdo.CLR3_OID_CLIE_RETE
		                           AND rte.CLIE_OID_CLIE = #oidClienteRecomendante#)     
	</delete>  
	    
	<!-- RECUPERAMOS EL TOTAL DE RECOMENDADOS ASOCIADOS AL RECOMENDANTE (INCENTIVOS) -->    
    <select id="getTotalRecomendados" parameterClass="string" resultClass="string">
         SELECT COUNT(rdo.OID_CLIE_REDO) 
		   FROM INC_CLIEN_RECDO rdo, INC_CLIEN_RECTE rte
		  WHERE rte.OID_CLIE_RETE = rdo.CLR3_OID_CLIE_RETE
			AND rte.OID_CLIE_RETE = #value#
    </select>

	<!-- ELIMINAMOS AL CLIENTE RECOMENDANTE (INCENTIVOS) -->
	<delete id="deleteRecomendante" parameterClass="string">
	    DELETE FROM INC_CLIEN_RECTE
	  	 WHERE OID_CLIE_RETE = #value#    
	</delete>  
	
    <!-- VERIFICA SI EL CLIENTE HA FACTURADO EN DETERMINADOS PERIODOS -->
    <select id="getClienteHaFacturadoPeriodos" parameterClass="java.util.Map" resultClass="string">
        SELECT COUNT(*) 
          FROM PED_SOLIC_CABEC s, 
               PED_TIPO_SOLIC_PAIS  tipoSolPais, 
               PED_TIPO_SOLIC tipoSol,
               PED_ESTAD_SOLIC estaSol
         WHERE s.IND_OC = 1
         
	         <isNotEmpty property="listPeriodos">	
				<iterate prepend="AND" property="listPeriodos" open="(" close=")" conjunction="OR">
	      	 		s.PERD_OID_PERI = #listPeriodos[]#
	            </iterate> 		
			 </isNotEmpty>	
			 
			 <isNotEmpty prepend="AND" property="codigoPeriodo">
				   s.PERD_OID_PERI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#)
				</isNotEmpty>

           AND s.CLIE_OID_CLIE = #oidCliente#
           AND ((s.IND_PEDI_PRUE is null) OR (s.IND_PEDI_PRUE = 0)) 
           AND s.TSPA_OID_TIPO_SOLI_PAIS = tipoSolPais.OID_TIPO_SOLI_PAIS 
           AND s.ESSO_OID_ESTA_SOLI = estaSol.OID_ESTA_SOLI
           AND tipoSolPais.TSOL_OID_TIPO_SOLI = tipoSol.OID_TIPO_SOLI 
           AND tipoSol.IND_DEVO  = 0 
           AND tipoSol.IND_ANUL  = 0 
           AND s.IND_TS_NO_CONSO = 1
           AND s.FEC_FACT IS NOT NULL
            
           <![CDATA[ 
           	 AND s.MODU_OID_MODU <> 15
           	 AND estaSol.COD_ESTA_SOLI <> '04'
             ]]>	  
    </select>

	<!-- RECUPERA EL ULTIMO PERIODO QUE HA FACTURADO EL CLIENTE -->
    <select id="getUltimoPeriodoFacturado" parameterClass="string" resultClass="string">
         SELECT OID_PERI 
         FROM  (SELECT OID_PERI 
                FROM CRA_PERIO 
                WHERE OID_PERI IN 
         (SELECT DISTINCT per.OID_PERI 
            FROM PED_SOLIC_CABEC s, 
                 PED_TIPO_SOLIC_PAIS tipoSolPais, 
                 PED_TIPO_SOLIC tipoSol,
                 PED_ESTAD_SOLIC estaSol, 
                 CRA_PERIO per 
           WHERE s.IND_OC = 1 
             AND s.CLIE_OID_CLIE = #value#
             AND ((s.IND_PEDI_PRUE is null) OR (s.IND_PEDI_PRUE = 0)) 
             AND s.TSPA_OID_TIPO_SOLI_PAIS = tipoSolPais.OID_TIPO_SOLI_PAIS
             AND s.ESSO_OID_ESTA_SOLI = estaSol.OID_ESTA_SOLI 
             AND tipoSolPais.TSOL_OID_TIPO_SOLI = tipoSol.OID_TIPO_SOLI 
             AND tipoSol.IND_DEVO  = 0 
             AND tipoSol.IND_ANUL  = 0 
             AND s.IND_TS_NO_CONSO = 1          
             
             <![CDATA[ 
           	 AND s.MODU_OID_MODU <> 15
           	 AND estaSol.COD_ESTA_SOLI <> '04'
             ]]>	  
                    
             AND s.PERD_OID_PERI = per.OID_PERI) 
            ORDER BY FEC_INIC DESC) 
         WHERE ROWNUM=1 
    </select>
	
	<!-- ACTUALIZAMOS PEDIDOS CON NUEVA UNIDAD ADMINISTRATIVA -->
    <update id="updatePedidosConNuevaUnidadAdministrativa" parameterClass="java.util.Map">
		UPDATE PED_SOLIC_CABEC  
            SET TERR_OID_TERR = (SELECT TERR_OID_TERR FROM ZON_TERRI_ADMIN WHERE OID_TERR_ADMI = #oidTerritorioAdministrativo# ),
                ZTAD_OID_TERR_ADMI = #oidTerritorioAdministrativo#,
                ZZON_OID_ZONA = (SELECT SEC.ZZON_OID_ZONA FROM ZON_TERRI_ADMIN TER, ZON_SECCI SEC 
 								 WHERE TER.OID_TERR_ADMI = #oidTerritorioAdministrativo# AND SEC.OID_SECC = TER.ZSCC_OID_SECC )
          WHERE OID_SOLI_CABE IN (SELECT PSC.OID_SOLI_CABE          
                                    FROM PED_SOLIC_CABEC PSC, CRA_PERIO PER, SEG_MARCA mar                 
                                   WHERE PSC.CLIE_OID_CLIE = #oidCliente#
                                     AND PSC.PERD_OID_PERI = PER.OID_PERI                 
                                     AND PSC.FEC_FACT IS NULL                
                                     AND PER.MARC_OID_MARC = MAR.OID_MARC
                                     AND MAR.COD_MARC = 'T')
    </update>
    
	<resultMap id="clienteHistoricoEstatusResult"   class="clienteHistoricoEstatus">
	 	<result property="oid" 							  column="OID_HIST_ESTA"/>
	    <result property="oidPeriodo" 					  column="PERD_OID_PERI"/>
	    <result property="oidCliente" 		  		   	  column="CLIE_OID_CLIE"/>
	    <result property="oidPeriodoFin" 				  column="PERD_OID_PERI_PERI_FIN"/>
	    <result property="oidEstatus" 					  column="ESTA_OID_ESTA_CLIE"/>
    </resultMap>

    <!-- RECUPERAMOS HISTORICO ESTATUS DE ACUERDO AL CLIENTE Y PERIODO FIN-->
    <select id="getHistoricoEstatusPeriodoFin"  parameterClass="java.util.Map" resultMap="clienteHistoricoEstatusResult">
 	    SELECT *
    	  FROM MAE_CLIEN_HISTO_ESTAT
	     WHERE CLIE_OID_CLIE = #oidCliente# 
	       AND PERD_OID_PERI_PERI_FIN = #oidPeriodoFin#
    </select>

    <!-- RECUPERAMOS HISTORICO ESTATUS DE ACUERDO AL CLIENTE Y PERIODO INICIO -->
    <select id="getHistoricoEstatusPeriodoInicio" parameterClass="java.util.Map" resultMap="clienteHistoricoEstatusResult">
 	    SELECT *
    	  FROM MAE_CLIEN_HISTO_ESTAT
	     WHERE CLIE_OID_CLIE = #oidCliente# 
	       AND PERD_OID_PERI = #oidPeriodo#
    </select>
    	
	<!-- ELIMINAMOS LOS HISTORICO DE CLASIFICACION ASOCIADOS AL OID HISTORICO ESTATUS -->
	<delete id="deleteHistoricoClasificacion" parameterClass="string">
	    DELETE FROM MAE_HISTO_CLASI
 		 WHERE CLHE_OID_HIST_ESTA = #value#   
	</delete>  

	<!-- ELIMINAMOS LOS HISTORICO DE ESTATUS ASOCIADOS AL OID HISTORICO ESTATUS -->
	<delete id="deleteHistoricoEstatus" parameterClass="string">
	    DELETE FROM MAE_CLIEN_HISTO_ESTAT
 		 WHERE OID_HIST_ESTA = #value#   
	</delete>  
	    
	<!-- ACTUALIZAMOS ESTATUS EN LA ENTIDAD DE HISTORICO ESTATUS -->
    <update id="updateHistoricoEstatus" parameterClass="java.util.Map">
		UPDATE MAE_CLIEN_HISTO_ESTAT
            SET ESTA_OID_ESTA_CLIE = #oidEstatus#,
                PERD_OID_PERI_PERI_FIN = NULL 
          WHERE OID_HIST_ESTA = #oidHistoricoEstatus#
    </update>
	    
	<!-- ACTUALIZAMOS ESTATUS Y CAMPAÃ‘A SIN PEDIDO EN ENTIDAD CLIENTE DATOS ADICIONALES -->
    <update id="updateDatosAdicionalesEstatus" parameterClass="java.util.Map">
		UPDATE MAE_CLIEN_DATOS_ADICI
   		   SET NUM_CAMP_SIN_PEDI = #numCampSinPedidos#,
               ESTA_OID_ESTA_CLIE = #oidEstatus#
         WHERE OID_CLIE_DATO_ADIC = #oidDatosAdicionales#
    </update>
    
   <!-- OBTIENE LA CAMPAÃ‘A ANTERIOR -->
    <select id="getPeriodoAnterior" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT OID_PERI OID, COD_PERI DESCRIPCION
		FROM (
		  SELECT B.OID_PERI, C.COD_PERI
		    FROM CRA_PERIO A, cra_perio B, SEG_PERIO_CORPO C, SEG_MARCA M, SEG_CANAL S, SEG_PAIS P, SEG_PERIO_CORPO D
		   WHERE B.PAIS_OID_PAIS = A.PAIS_OID_PAIS 
		     AND B.MARC_OID_MARC = A.MARC_OID_MARC 
		     AND B.CANA_OID_CANA = A.CANA_OID_CANA
		     
		     <![CDATA[ 
           	 AND C.COD_PERI < D.COD_PERI
             ]]>
  	         
		     AND C.OID_PERI = B.PERI_OID_PERI
		     AND D.OID_PERI = A.PERI_OID_PERI     
		     AND A.MARC_OID_MARC = M.OID_MARC
		     AND A.CANA_OID_CANA = S.OID_CANA
		     AND A.PAIS_OID_PAIS = p.OID_PAIS
		     
		     <isNotEmpty property="codigoPais">
		       AND P.COD_PAIS = #codigoPais#
		     </isNotEmpty>  
		     <isNotEmpty property="codigoMarca">
		       AND M.COD_MARC = #codigoMarca#
		     </isNotEmpty>
		     <isNotEmpty property="codigoCanal">
		       AND S.COD_CANA = #codigoCanal#
		     </isNotEmpty>
		     
		     <isNotEmpty property="codigoPeriodo">
		     	AND D.COD_PERI = #codigoPeriodo#
		     </isNotEmpty>
		     
		     <isNotEmpty property="oidPeriodo">
		     	AND A.OID_PERI = #oidPeriodo#
		     </isNotEmpty>			
		     			
		   ORDER BY C.COD_PERI DESC 
		)
		WHERE ROWNUM = 1  
    </select>
    
    <!-- VERIFICA SI EL PERIODO HA CERRADO -->
    <select id="getPeriodoCerrado" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(con.OID_CTRL)
		  FROM FAC_CONTR_CIERR con,
		       FAC_TIPOS_CIERR tip,
		       CRA_PERIO cra
		 WHERE con.TCIE_OID_TIPO_CIER = tip.OID_TIPO_CIER
		   AND cra.OID_PERI = con.PERD_OID_PERI
		   AND tip.COD_TIPO_CIER = 'P'
		   AND con.PERD_OID_PERI = #oidPeriodo#
		   AND con.VAL_RESU_PROC = 'OK'
    </select>
    
    <!-- ELIMINAMOS LOS REGISTROS DE LA ENTIDAD UNIDAD ADMINISTRATIVA QUE COMIENZA DEL PERIODO SELECCIONADO -->
	<delete id="deleteUnidadAdministrativaPeriodoInicio" parameterClass="java.util.Map">
		DELETE FROM MAE_CLIEN_UNIDA_ADMIN
		 WHERE CLIE_OID_CLIE = #oidCliente#
		   AND PERD_OID_PERI_INI = #oidPeriodo#						  	                                                                              
	</delete>				
    
	<select id="getUnidadAdministrativaClientexPeriodoFin" parameterClass="java.util.Map" resultMap="unidadAdministrativaResult">   
				  SELECT  ua.*,zz.COD_ZONA,zt.COD_TERR,
				  			zr.COD_REGI, zs.COD_SECC,
				  			INC_PKG_PROCE_INCEN.INC_FN_OBTIE_CODIG_PERIO(ua.PERD_OID_PERI_INI) COD_PERI_INIC
				  FROM  MAE_CLIEN_UNIDA_ADMIN ua,
						ZON_TERRI_ADMIN zta,
						ZON_TERRI zt,
						ZON_ZONA  zz,
						ZON_SECCI zs,
						ZON_REGIO zr
				  WHERE  ua.CLIE_OID_CLIE = #oidCliente#
				      AND ua.PERD_OID_PERI_FIN = #oidPeriodoFin#
				      AND ua.ZTAD_OID_TERR_ADMI =zta.OID_TERR_ADMI	 
					  AND zs.OID_SECC = zta.ZSCC_OID_SECC
					  AND zt.OID_TERR = zta.TERR_OID_TERR
					  AND zt.PAIS_OID_PAIS =zta.PAIS_OID_PAIS
				 	  AND zz.OID_ZONA = zs.ZZON_OID_ZONA
				 	  AND zr.OID_REGI = zz.ZORG_OID_REGI							  	                                                                              
	</select>				
    
    <resultMap id="mapIndicadorCajaBolsaProducto" class="java.util.HashMap">
    	<result property="codigoProducto"  column="COD_SAP"/>
    	<result property="descripcionProducto" 	column="DES_CORT"/>
    	<result property="indicadorCajaBolsa" 	column="DES_INDI"/>
    </resultMap>

    <!-- BUSCA EL INDICADOR CAJA BOLSA DE UN DETERMINADO PRODUCTO -->
    <select id="getIndicadorCajaBolsaProducto" parameterClass="java.util.Map" resultMap="mapIndicadorCajaBolsaProducto">
		SELECT    MP.COD_SAP,
		          gen_pkg_gener.gen_fn_devuelve_descripcion(mp.oid_prod,'MAE_PRODU',#codigoPais#) DES_CORT,
		          COD_INDI DES_INDI
		FROM      MAE_PRODU MP,
		          MAE_TIPO_EMPAQ MT
		WHERE     MP.COD_IND_DENT_CAJA = MT.COD_INDI (+)
		  AND     COD_SAP = #codigoSAP#
		  <isNotEmpty property="indicador">
		  AND     MT.DES_INDI = #indicador#
		  </isNotEmpty>
    </select>   
    
    <!-- Excecuta el proceso de obtencion de consultoras deudoras avaladas -->
   
      <parameterMap id="executeValidacionDeudoraConsultoraAvalParams" class="java.util.Map">														
    	<parameter property="codigoPais"                   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoConsultora"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="numeroDocumentoIdentidad"     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	  	<parameter property="tipo"                 		   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	  	<parameter property="mensajeError"     			   jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	 </parameterMap>
  														
  	<procedure id="executeValidacionDeudoraConsultoraAval" parameterMap="executeValidacionDeudoraConsultoraAvalParams">														
			{call MAE_PKG_PROCE_CLIEN.MAE_PR_GENER_CLIEN_DAVAL(?,?,?,?,?)}											
	</procedure>


  <resultMap id="consultorasDeudorasAvalResult" class="java.util.HashMap">
  	  <result property="codigoPais"   column="COD_PAIS"/>
      <result property="codigoConsultora"   column="COD_CLIE"/>
      <result property="apellidoPaterno" 	column="VAL_APE1"/>
      <result property="apellidoMaterno" 	column="VAL_APE2"/>
      <result property="nombre1" 			column="VAL_NOM1"/>
      <result property="nombre2" 			column="VAL_NOM2"/>      
      <result property="saldoVencido" 		column="IMP_SALD_VENC"/>
      <result property="importePendiente" 	column="IMP_PEND"/>            
   </resultMap>
   
	<select id="getListConsultorasDeudorasAval" parameterClass="java.util.Map" resultMap="consultorasDeudorasAvalResult">
		  SELECT *
		  FROM MAE_GTT_CONSU_DAVAL		  
		  WHERE COD_PAIS = #codigoPais# 		     		    	 
	</select>       
    
    <select id="getSizePedidosEnviados" parameterClass="java.util.Map" resultClass="int">
		 	SELECT COUNT(1) 
			FROM
			 INT_SOLIC_CONSO_CABEC PCI,
			 MAE_CLIEN MC,
			 PED_SOLIC_CABEC PC,
			 PED_TIPO_SOLIC_PAIS C,
			 PED_TIPO_SOLIC D,
  	         PED_ESTAD_SOLIC E
			WHERE PCI.COD_CLIE = #codigoCliente# AND
			   	PCI.COD_CLIE = MC.COD_CLIE
				AND MC.OID_CLIE = PC.CLIE_OID_CLIE
				AND PC.TSPA_OID_TIPO_SOLI_PAIS = C.OID_TIPO_SOLI_PAIS
				AND C.TSOL_OID_TIPO_SOLI = D.OID_TIPO_SOLI
				AND D.COD_TIPO_SOLI = 'SOC'   
				AND PC.GRPR_OID_GRUP_PROC != 5
		        AND PC.ESSO_OID_ESTA_SOLI = E.OID_ESTA_SOLI
		        AND E.COD_ESTA_SOLI = 'VA'
				
			  <isNotEmpty property="oidPeriodo">	
				    <iterate prepend="AND" property="oidPeriodo" open=" PC.PERD_OID_PERI IN (" close=")" conjunction=",">
        			 	#oidPeriodo[]#
		        	</iterate>    
			  </isNotEmpty>					     		    	 
	</select>
        
	<parameterMap id="paramExecuteRedifinirPeriodoIngreso" class="map">
		<parameter property="oidCliente" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="oidPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>

	<procedure id="executeRedifinirPeriodoIngreso" parameterMap="paramExecuteRedifinirPeriodoIngreso">
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_REDEF_PERIO_INGRE(?, ?, ?) }
	</procedure>
    
    <!-- VERIFICA SI EL CLIENTE ES POTENCIAL / AVAL -->
    <select id="getClientePotencialAval" parameterClass="string" resultClass="long">
	    SELECT sub.OID_CLIE_TIPO_SUBT
	  	  FROM MAE_CLIEN cli, MAE_CLIEN_TIPO_SUBTI sub,
	           MAE_TIPO_CLIEN tip, MAE_SUBTI_CLIEN sti
		 WHERE cli.OID_CLIE = sub.CLIE_OID_CLIE
		   AND sub.TICL_OID_TIPO_CLIE = tip.OID_TIPO_CLIE
		   AND sub.SBTI_OID_SUBT_CLIE = sti.OID_SUBT_CLIE
		   AND tip.COD_TIPO_CLIE = '01'
		   AND sti.COD_SUBT_CLIE = '02'
		   AND cli.COD_CLIE = #value#
    </select>
    
	<!-- ELIMINAMOS LAS CLASIFICACIONES RELACIONADOS A UN SUBTIPOCLIENTE -->
	<delete id="deleteClasificaciones" parameterClass="long">
	    DELETE FROM MAE_CLIEN_CLASI  
 		WHERE CTSU_OID_CLIE_TIPO_SUBT =#value#   
	</delete>  

	<!-- ELIMINAMOS UN SUBTIPOCLIENTE -->
	<delete id="deleteSubTipoCliente" parameterClass="long">
	    DELETE FROM MAE_CLIEN_TIPO_SUBTI
 		 WHERE OID_CLIE_TIPO_SUBT =#value#     
	</delete>  
    
	<insert id="insertClienteAval" parameterClass="java.util.Map">
		INSERT INTO MAE_CLIEN_HISTO_AVALD 	   
			(COD_PAIS, COD_CLIE, COD_CLIE_AVAL,
 			 IMP_SALD_VENC, IMP_PEND, COD_USUA, FEC_CREA)
		VALUES
			(#codigoPais#, #codigoCliente#, #codigoClienteAval#,
			#saldoVencido#, #importePendiente#, #codigoUsuario#, SYSDATE)
	</insert>
	    
    <!-- OBTIENE EL SEGUNDO TIPO DOCUMENTO OBLIGATORIO PARA EL PAIS LOGUEADO -->
    <select id="getSegundoTipoDocumento" parameterClass="string" resultClass="string">
	    SELECT OID_TIPO_DOCU
		FROM
			(SELECT OID_TIPO_DOCU
			  FROM MAE_TIPO_DOCUM
			 WHERE IND_OBLI = 0
			   AND IND_DOC_IDEN_FISC = 1
			   AND PAIS_OID_PAIS = #value# 
			 ORDER BY COD_TIPO_DOCU)
			WHERE ROWNUM=1 
    </select>
    
    <!-- Typing Tool MAE LOVE -->
    <typeAlias alias="clienteComunicacionOperadora"   type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteComunicacionOperadora"/>
    <typeAlias alias="clienteEncuesta" 				  type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteEncuesta"/>
    <typeAlias alias="clientePreferenciaComunicacion" type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClientePreferenciaComunicacion"/>
    <typeAlias alias="clienteTipoLogro"               type="biz.belcorp.ssicc.dao.spusicc.mae.model.ClienteTipoLogro"/>
    <typeAlias alias="segmentoGrupoLove"              type="biz.belcorp.ssicc.dao.spusicc.mae.model.SegmentoGrupoLove"/>


  <select id="getExisteClienteEncuesta" parameterClass="clienteEncuesta" resultClass="int">
		SELECT  COUNT(1)
		FROM MAE_LOVE_DATOS_ADICI A
		WHERE A.COD_CLIE=#codigoCliente#
    </select>
        
    <insert id="insertClienteEncuesta" parameterClass="clienteEncuesta">
		INSERT INTO MAE_LOVE_DATOS_ADICI (
		   COD_CLIE, SEC_SEGM_VIS3, FEC_ACTU_SEGM_VIS3, 
		   SEC_SEGM_VIS6, FEC_ACTU_SEGM_VIS6, SEC_SEGM_VISI_ESTA, 
		   FEC_ACTU_SEGM_VISI_ESTA, COD_TIPO_LOGR, DET_LOGR, 
		   NEC_LOGR, VAL_LOGR, CAM_INIC_LOGR, 
		   CAM_FINA_LOGR, POR_ASIG_LOGR, INF_MARCA, 
		   EMA_DUPL_POTE, USU_DIGI, FEC_DIGI) 
		VALUES (#codigoCliente# ,#secuenciaSegmentoVisita3# ,TO_DATE(#fechaActV3#,'dd/mm/yyyy:HH24:MI:SS'),
		    #secuenciaSegmentoVisita6#,TO_DATE(#fechaActV6#,'dd/mm/yyyy:HH24:MI:SS') ,#secuenciaSegmentoVisitaEstablecida# ,
		    TO_DATE(#fechaActEst#,'dd/mm/yyyy:HH24:MI:SS'), #codigoTipoLogro#, #detLogro#,
		    #necLogro#,TO_NUMBER(#valLogro#,'999999999.9999') ,#cmpIniLogro# ,
		    #cmpFinLogro#,TO_NUMBER(#porAsigLogro#,'999999.9999') ,#infMarca# ,
		    #emailDuplaPot#,#auditInfo.createdBy#,SYSDATE)       	         
		         		         	
	</insert>
	
	<update id="updateClienteEncuesta" parameterClass="clienteEncuesta">
			UPDATE MAE_LOVE_DATOS_ADICI
		    SET    
		       SEC_SEGM_VIS3           = #secuenciaSegmentoVisita3#,
		       FEC_ACTU_SEGM_VIS3      = TO_DATE(#fechaActV3#,'dd/mm/yyyy:HH24:MI:SS'),
		       SEC_SEGM_VIS6           = #secuenciaSegmentoVisita6#,
		       FEC_ACTU_SEGM_VIS6      = TO_DATE(#fechaActV6#,'dd/mm/yyyy:HH24:MI:SS'),
		       SEC_SEGM_VISI_ESTA      = #secuenciaSegmentoVisitaEstablecida#,
		       FEC_ACTU_SEGM_VISI_ESTA =  TO_DATE(#fechaActEst#,'dd/mm/yyyy:HH24:MI:SS'),
		       COD_TIPO_LOGR           = #codigoTipoLogro#,
		       DET_LOGR                = #detLogro#,
		       NEC_LOGR                = #necLogro#,
		       VAL_LOGR                = TO_NUMBER(#valLogro#,'999999999.9999'),
		       CAM_INIC_LOGR           = #cmpIniLogro#,
		       CAM_FINA_LOGR           =  #cmpFinLogro#,
		       POR_ASIG_LOGR           = TO_NUMBER(#porAsigLogro#,'999999.9999'),
		       INF_MARCA               = #infMarca#,
		       EMA_DUPL_POTE           = #emailDuplaPot#,
		       USU_MODI                = #auditInfo.updatedBy#,
		       FEC_MODI                = SYSDATE
		    WHERE  COD_CLIE                = #codigoCliente#		
	</update>


  <select id="getExisteSegmentoGrupoLove" parameterClass="segmentoGrupoLove" resultClass="segmentoGrupoLove">
		SELECT  A.SEC_SEGM secuenciaSegmento,
		        A.COD_SEGM codigoSegmento,
				A.DES_SEGM descripcionSegmento
		FROM MAE_LOVE_SEGME A
		WHERE A.COD_SEGM=#codigoSegmento#
		AND A.COD_GRUP_SEGM = #codigoGrupo#
    </select>
        
    <insert id="insertSegmentoGrupoLove" parameterClass="segmentoGrupoLove">

		INSERT INTO MAE_LOVE_SEGME(
			SEC_SEGM,
   			COD_SEGM,
   			DES_SEGM,
   			COD_GRUP_SEGM,
   			IND_ACTI,
   			USU_DIGI,
   			FEC_DIGI) 
		VALUES ( MAE_SEQ_LOVE_SEGME.NEXTVAL,#codigoSegmento#,#descripcionSegmento#,#codigoGrupo#,1, #auditInfo.createdBy#,SYSDATE)		       	         
		         		         	
	</insert>
	
	<update id="updateSegmentoGrupoLove" parameterClass="segmentoGrupoLove">
		UPDATE  MAE_LOVE_SEGME
		SET    DES_SEGM = #descripcionSegmento#,
		       USU_MODI      = #auditInfo.updatedBy#,
		       FEC_MODI      = sysdate
		WHERE  COD_SEGM = #codigoSegmento#
		  AND COD_GRUP_SEGM = #codigoGrupo#
	</update>

   <select id="getExisteGrupoLove" parameterClass="segmentoGrupoLove" resultClass="segmentoGrupoLove">
		SELECT  A.COD_GRUP_SEGM codigoGrupo,
				A.DES_GRUP_SEGM descripcionGrupo
		FROM MAE_LOVE_GRUPO_SEGME A
		WHERE A.COD_GRUP_SEGM=#codigoGrupo#
    </select>
        
    <insert id="insertGrupoLove" parameterClass="segmentoGrupoLove">

		INSERT INTO MAE_LOVE_GRUPO_SEGME(
   			COD_GRUP_SEGM,
   			DES_GRUP_SEGM,
   			IND_ACTI,
   			USU_DIGI,
   			FEC_DIGI) 
		VALUES ( #codigoGrupo#,#descripcionGrupo#,1, #auditInfo.createdBy#,SYSDATE)		       	         
		         		         	
	</insert>
	
	<update id="updateGrupoLove" parameterClass="segmentoGrupoLove">
		UPDATE  MAE_LOVE_GRUPO_SEGME
		SET    DES_GRUP_SEGM = #descripcionGrupo#,
		       USU_MODI      = #auditInfo.updatedBy#,
		       FEC_MODI      = sysdate
		WHERE  COD_GRUP_SEGM = #codigoGrupo#
	</update>
    
   
    <select id="getExisteTipoLogro" parameterClass="clienteTipoLogro" resultClass="clienteTipoLogro">
		SELECT  A.COD_TIPO_LOGR codTipoLogro,
				A.DES_TIPO_LOG1 desTipoLogro
		FROM MAE_LOVE_TIPO_LOGRO A
		WHERE A.COD_TIPO_LOGR=#codTipoLogro#
    </select>
        
    <insert id="insertTipoLogro" parameterClass="clienteTipoLogro">

		INSERT INTO MAE_LOVE_TIPO_LOGRO(
		   COD_TIPO_LOGR, DES_TIPO_LOG1, DES_TIPO_LOG2, 
		   IND_ACTI, USU_DIGI, FEC_DIGI) 
		VALUES (#codTipoLogro#,#desTipoLogro# ,NULL ,
		    1,#auditInfo.createdBy#,SYSDATE)		    	         
		         		         	
	</insert>
	
	<update id="updateTipoLogro" parameterClass="clienteTipoLogro">
		UPDATE MAE_LOVE_TIPO_LOGRO
		SET    DES_TIPO_LOG1 = #desTipoLogro#,
		       USU_MODI      = #auditInfo.updatedBy#,
		       FEC_MODI      = sysdate
		WHERE  COD_TIPO_LOGR = #codTipoLogro#
	</update>
   
    
    <select id="getExisteTipoOperadora" parameterClass="clienteComunicacionOperadora" resultClass="clienteComunicacionOperadora">
		SELECT A.COD_TIPO_OPER codTipoOperador,
			  A.DES_TIPO_OPER desTipoOperador
		FROM MAE_TIPO_OPERA A
		WHERE A.COD_TIPO_OPER=#codTipoOperador#
    </select>
    
    
    <insert id="insertTipoOperadora" parameterClass="clienteComunicacionOperadora">
		INSERT INTO MAE_TIPO_OPERA (
		   COD_TIPO_OPER, DES_TIPO_OPER, VAL_COST_OPER, 
		   IND_ACTI, USU_DIGI, FEC_DIGI) 
		VALUES ( #codTipoOperador#, #desTipoOperador#,0,
		    1, #auditInfo.createdBy#,sysdate)		         
		         		         	
	</insert>
	
	<update id="updateTipoOperadora" parameterClass="clienteComunicacionOperadora">
		UPDATE MAE_TIPO_OPERA
		SET    DES_TIPO_OPER = #desTipoOperador#,
		       USU_MODI      = #auditInfo.updatedBy#,
		       FEC_MODI      = sysdate
		WHERE  COD_TIPO_OPER = #codTipoOperador#
	</update>

   <select id="getExisteComunicacionCliente" parameterClass="clienteComunicacionOperadora" resultClass="int">
		SELECT COUNT(1) 
		FROM MAE_CLIEN_COMUN A , MAE_TIPO_COMUN B
		WHERE A.CLIE_OID_CLIE =#oidConsultora#
         AND A.TICM_OID_TIPO_COMU = B.OID_TIPO_COMU
         AND B.COD_TIPO_COMU=#codigoTipoComun#
    </select>
    
    
    <insert id="insertComunicacionCliente" parameterClass="clienteComunicacionOperadora">
		    
		    INSERT INTO MAE_CLIEN_COMUN
            (OID_CLIE_COMU, 
             CLIE_OID_CLIE, 
             TICM_OID_TIPO_COMU, 
             VAL_DIA_COMU,
             VAL_TEXT_COMU, 
             FEC_HORA_DESD, 
             FEC_HORA_HAST, 
             VAL_INTE_COMU,
             IND_COMU_PPAL,
             FEC_ULTI_ACTU,
             IND_CONF_COMU,
             COD_TIPO_OPER
            )
     	VALUES 
     	    (MAE_CLCO_SEQ.NEXTVAL, 
     	     #oidConsultora#, 
     	     #oidTipoComunicacion#, 
     	     null,
             #valTextComun#, 
             null,
             null, 
             null,
             0,
             sysdate,
             null,
             #codTipoOperador#
            )		         
		         		         	
	</insert>
	
	<update id="updateComunicacionClienteOperadora" parameterClass="clienteComunicacionOperadora">
		UPDATE MAE_CLIEN_COMUN
		SET    VAL_TEXT_COMU = #valTextComun#,
		       COD_TIPO_OPER = #codTipoOperador#,
		       FEC_ULTI_ACTU = SYSDATE
		WHERE  CLIE_OID_CLIE = #oidConsultora#
		AND TICM_OID_TIPO_COMU =#oidTipoComunicacion#
	</update>
    
    <select id="getExistePreferenciaComunicacion" parameterClass="clientePreferenciaComunicacion" resultClass="clientePreferenciaComunicacion">
		SELECT A.COD_TIPO_PREF codigoTipoPrefe,
		       A.DES_TIPO_PREF desTipoPreferen
		FROM MAE_TIPO_PREFE_COMUN A
		WHERE A.COD_TIPO_PREF=#codigoTipoPrefe#
    </select>
    
    <insert id="insertPreferencia" parameterClass="clientePreferenciaComunicacion">
		INSERT INTO MAE_TIPO_PREFE_COMUN (
		   COD_TIPO_PREF, DES_TIPO_PREF, IND_ACTI, 
		   USU_DIGI, FEC_DIGI) 
		VALUES ( #codigoTipoPrefe#, 
				 #desTipoPreferen#, 
				 '1',
		         #auditInfo.createdBy#, 
		         SYSDATE)			
	</insert>
	
	<update id="updatePreferencia" parameterClass="clientePreferenciaComunicacion">
		UPDATE MAE_TIPO_PREFE_COMUN
		SET    DES_TIPO_PREF = #desTipoPreferen#,		       
		       USU_MODI      =  #auditInfo.updatedBy#, 
		       FEC_MODI      = SYSDATE
		WHERE  COD_TIPO_PREF = #codigoTipoPrefe#		
	</update>
	
	
	<select id="getExistePreferenciaClienteComunicacion" parameterClass="clientePreferenciaComunicacion" resultClass="int">
		SELECT COUNT(1) 
		FROM MAE_LOVE_PREFE_COMUN A
		WHERE A.COD_CLIE=#codigoCliente#
		  AND A.COD_TIPO_PREF=#codigoTipoPrefe#
    </select>
    
    <insert id="insertPreferenciaCliente" parameterClass="clientePreferenciaComunicacion">
		
		INSERT INTO MAE_LOVE_PREFE_COMUN (
   				COD_CLIE, 
   				COD_TIPO_PREF, 
   				ORD_TIPO_PREF, 
   				USU_DIGI,
   				FEC_DIGI) 
			VALUES ( #codigoCliente#, 
					#codigoTipoPrefe#, 
					#ordenTipoPref#,
    				#auditInfo.createdBy#,
    				SYSDATE)		         
		         
	</insert>
	
	<update id="updatePreferenciaCliente" parameterClass="clientePreferenciaComunicacion">
		UPDATE MAE_LOVE_PREFE_COMUN
		SET   ORD_TIPO_PREF = #ordenTipoPref#,
		       USU_MODI      = #auditInfo.updatedBy#,
		       FEC_MODI      = SYSDATE
		WHERE  COD_CLIE      = #codigoCliente#
		AND    COD_TIPO_PREF = #codigoTipoPrefe#

	</update>
    	 
   <select id="getNivelRiesgo" parameterClass="java.util.Map" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_OBTIE_NIVEL_RIESG(#oidTerritorioAdministrativo#)
 		  FROM DUAL
   </select>	             
    	 
    <!-- OBTIENE LOS CARACTERES VALIDOS/NOVALIDOS RELACIONADOS A UN CODIGO DE MODULO DE VALIDACION -->
    <select id="getCaracteresxModuloValidacion" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT CRT_VALI AS CODIGO, CRT_VALI AS DESCRIPCION
		  FROM MAE_CONTR_CARAC
		 WHERE COD_MODU_VALI = #codigoModuloValidacion#
		   AND CRT_INDI = #indicador#
    </select>
    	 
	<procedure id="executeRedifinirPeriodoIngresoRetiradas" parameterMap="paramExecuteRedifinirPeriodoIngreso">
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_REDEF_PERIO_INGRE_RETIR(?, ?, ?) }
	</procedure>
    	 
    <!-- VALIDA SI LA ZONA ES DE TIPO OFICINA -->
    <select id="getZonaOficina" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1) 
		 FROM ZON_ZONA
		WHERE PAIS_OID_PAIS = #oidPais#
		  AND COD_ZONA = #codigoZona#
		  AND IND_ACTI = 1
		  AND IND_OFIC = 1
    </select>
    	 
    <!-- VALIDA SI LA ZONA ESTA INACTIVA -->
    <select id="getZonaInactiva" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1) 
		 FROM ZON_ZONA
		WHERE PAIS_OID_PAIS = #oidPais#
		  AND COD_ZONA = #codigoZona#
		  AND IND_ACTI = 0
    </select>
    	 
   <select id="getValidacionVigenciaRecomendacion" parameterClass="java.util.Map" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_VALID_VIGEN_RECOM(#oidCliente#, #oidPeriodo#)  
		FROM DUAL                                                                     	
   </select>	             
    	 
   <parameterMap id="executeRehacerTablasIncentivosParams" class="java.util.Map">														
    	<parameter property="oidPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codClienteRcdo"     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="codClienteRcte"     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	  	<parameter property="oidConcurso"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
    	 
  	<procedure id="executeRehacerTablasIncentivos" parameterMap="executeRehacerTablasIncentivosParams">														
			{call MAE_PKG_PROCE_CLIEN.MAE_PR_REHAC_TABLA_INCEN(?,?,?,?)}											
	</procedure>

   <parameterMap id="executeDeleteRecomendadosParams" class="java.util.Map">														
    	<parameter property="oidClienteRecomendado"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="oidClienteRecomendante"     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
    	 
  	<procedure id="executeDeleteRecomendados" parameterMap="executeDeleteRecomendadosParams">														
			{call MAE_PKG_PROCE_CLIEN.MAE_PR_BORRA_CLIEN_RECDO(?,?)}											
	</procedure>

   <parameterMap id="executeDeleteRecomendanteParams" class="java.util.Map">														
    	<parameter property="oidClienteRecomendante"     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
    	 
  	<procedure id="executeDeleteRecomendante" parameterMap="executeDeleteRecomendanteParams">														
			{call MAE_PKG_PROCE_CLIEN.MAE_PR_BORRA_CLIEN_RECTE(?)}											
	</procedure>
    	 
   <select id="getPeriodoRecomendacion" parameterClass="java.util.Map" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_OBTEN_PERIO_RECOM(#oidPais#, #oidCliente#)
 		  FROM DUAL
   </select>	             
    	 
    <select id="getDocumentoIdentidad" parameterClass="string" resultClass="string">
			  SELECT NUM_DOCU_IDEN
  			  FROM MAE_CLIEN_IDENT
  			  WHERE CLIE_OID_CLIE=#value#
   				AND VAL_IDEN_DOCU_PRIN=1
   </select>

 	<select id="getZonasDirectorio" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZON_ZONA.COD_ZONA, ' ') AS CODIGO, 	   
		    NVL(ZON_ZONA.DES_ZONA, ' ') AS DESCRIPCION,
		    NVL(ZON_ZONA.COD_ZONA, 'ZZ')		
	 FROM  ZON_ZONA,
	       ZON_REGIO
	 WHERE (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
	       <isNotEmpty property="codigoRegion">	
		    <iterate prepend="AND" property="codigoRegion" open=" ZON_REGIO.COD_REGI IN (" close=")" conjunction=",">
        	 	#codigoRegion[]#
        	</iterate>    
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="indicadorActivo">
					ZON_ZONA.IND_ACTI =#indicadorActivo#
		   </isNotEmpty>
			AND  zon_zona.CLIE_OID_CLIE IS NULL 			       
	 ORDER BY 3
    </select>
    
 	<select id="getZonasDirectorioCargo" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT 
		    NVL(ZZ.COD_ZONA, ' ') AS CODIGO, 	   
		    NVL(ZZ.DES_ZONA, ' ') AS DESCRIPCION,
			NVL(ZZ.COD_ZONA, 'ZZ')		
		FROM ZON_ZONA zz
		JOIN  ZON_REGIO zr ON ZZ.ZORG_OID_REGI = ZR.OID_REGI

		<isNotEmpty property="indicadorActivo">
			AND ZR.IND_ACTI=1 AND ZR.IND_BORR=0
			AND ZZ.IND_ACTI=1 AND ZZ.IND_BORR=0
		</isNotEmpty>
		
		WHERE 1=1
		
		<isEqual property="flag" compareValue="1">
			AND ZZ.CLIE_OID_CLIE IS NULL 
		</isEqual>			       
		
		<isNotEmpty property="codigoRegion">	
			<iterate prepend="AND" property="codigoRegion" open=" ZR.COD_REGI IN (" close=")" conjunction=",">
				#codigoRegion[]#
			</iterate>    
		</isNotEmpty>
		
		ORDER BY ZR.COD_REGI, ZZ.COD_ZONA
	 	
    </select>
	
	<select id="getZonasDirectorioCargoFOX" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT 
		    NVL(ZZ.COD_ZONA, ' ') AS CODIGO, 	   
		    NVL(ZZ.DES_ZONA, ' ') AS DESCRIPCION,
			NVL(ZZ.COD_ZONA, 'ZZ')		
		FROM ZON_DIREC_ZONA zz
		JOIN  ZON_DIREC_REGIO zr ON ZZ.PAIS_COD_PAIS = ZR.PAIS_COD_PAIS AND ZZ.REGI_COD_REGI = ZR.COD_REGI
		
		<isNotEmpty property="indicadorActivo">
			AND ZR.IND_ACTI=1 
			AND ZZ.IND_ACTI=1
		</isNotEmpty>
		
		WHERE 1=1
		
		AND ZR.PAIS_COD_PAIS = #codigoPais#
		
		<isEqual property="flag" compareValue="1">
			AND ZZ.CLIE_COD_CLIE IS NULL 
		</isEqual>			       
		
		<isNotEmpty property="codigoRegion">	
			<iterate prepend="AND" property="codigoRegion" open=" ZR.COD_REGI IN (" close=")" conjunction=",">
				#codigoRegion[]#
			</iterate>    
		</isNotEmpty>
		
		ORDER BY ZR.COD_REGI, ZZ.COD_ZONA
	 	
    </select>
	
	<select id="getZonasDirectorioZON" parameterClass="java.util.Map" resultMap="baseResultZON">
     		  			       SELECT NVL(Z.COD_ZONA, ' ') CODIGO,
		       NVL((SELECT Z.DES_ZONA
		             FROM MAE_CLIEN_TIPO_SUBTI A, MAE_TIPO_CLIEN B, MAE_CLIEN C
		            WHERE C.OID_CLIE = Z.CLIE_OID_CLIE
		              AND A.CLIE_OID_CLIE = C.OID_CLIE
		              AND B.COD_TIPO_CLIE = '04'
		              AND B.OID_TIPO_CLIE = A.TICL_OID_TIPO_CLIE),
		           Z.DES_ZONA||' '||'Disponible') DESCRIPCION, NVL(Z.COD_ZONA, 'ZZ')
		  FROM ZON_ZONA Z
		 WHERE Z.IND_ACTI = 1
		 ORDER BY 3	
    </select>
    	
     <select id="getRegionesDirectorio" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZON_REGIO.COD_REGI, ' ') AS CODIGO, 	   
		    NVL(ZON_REGIO.DES_REGI, ' ') AS DESCRIPCION,
		    NVL(ZON_REGIO.COD_REGI, 'ZZ')
	 FROM  ZON_REGIO		    
	 WHERE  CLIE_OID_CLIE IS NULL	
  		   <isNotEmpty prepend="AND" property="indicadorActivo">
					ZON_REGIO.IND_ACTI =#indicadorActivo#
		   </isNotEmpty>	   		       
	 ORDER BY 3
    </select>
    
     <select id="getRegionesDirectorioCargo" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZR.COD_REGI, ' ') AS CODIGO, 	   
		    NVL(ZR.DES_REGI, ' ') AS DESCRIPCION,
		    NVL(ZR.COD_REGI, 'ZZ')
	 FROM  ZON_REGIO ZR		    
	 WHERE 1=1
	 AND ZR.TIP_REGI = 1  
		<isEqual property="flag" compareValue="1">
			AND ZR.CLIE_OID_CLIE IS NULL
		</isEqual>
		<isNotEmpty prepend="AND" property="indicadorActivo">
			    ZR.IND_ACTI =#indicadorActivo#
		</isNotEmpty>
	 ORDER BY 3
    </select>
    
    <select id="getRegionesDirectorioCargoFOX" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(COD_REGI, ' ') AS CODIGO,        
            NVL(DES_REGI, ' ') AS DESCRIPCION,
            NVL(COD_REGI, 'ZZ')
     FROM  ZON_DIREC_REGIO
     WHERE PAIS_COD_PAIS = #codigoPais#
        <isEqual property="flag" compareValue="1">
            AND CLIE_COD_CLIE IS NULL
        </isEqual>
        <isNotEmpty prepend="AND" property="indicadorActivo">
            IND_ACTI =#indicadorActivo#
        </isNotEmpty>
     ORDER BY 3
    </select>
    
    <select id="getRegionesDirectorioCargoGZ" parameterClass="java.util.Map" resultMap="baseResult">    
		SELECT DISTINCT NVL(ZR.COD_REGI, ' ') AS CODIGO,      
			        NVL(ZR.DES_REGI, ' ') AS DESCRIPCION,
			        NVL(ZR.COD_REGI, 'ZZ')
		FROM ZON_ZONA ZZ
		JOIN  ZON_REGIO ZR ON ZZ.ZORG_OID_REGI = ZR.OID_REGI
		
		<isNotEmpty property="indicadorActivo">
			AND ZR.IND_ACTI=1 AND ZR.IND_BORR=0
			AND ZZ.IND_ACTI=1 AND ZZ.IND_BORR=0
		</isNotEmpty>
		
		WHERE 1 = 1 
		AND ZR.TIP_REGI = 1 
		<isEqual property="flag" compareValue="1">
			AND ZZ.CLIE_OID_CLIE IS NULL
		</isEqual>
		ORDER BY CODIGO
    </select>
	
	<select id="getRegionesDirectorioCargoGZFOX" parameterClass="java.util.Map" resultMap="baseResult">    
        SELECT DISTINCT NVL(ZR.COD_REGI, ' ') AS CODIGO,      
                    NVL(ZR.DES_REGI, ' ') AS DESCRIPCION,
                    NVL(ZR.COD_REGI, 'ZZ')
        FROM ZON_DIREC_ZONA zz
        JOIN  ZON_DIREC_REGIO zr ON 
        ZZ.PAIS_COD_PAIS = ZR.PAIS_COD_PAIS 
        AND ZZ.REGI_COD_REGI = ZR.COD_REGI        
        WHERE 1 = 1
                  
        AND ZR.PAIS_COD_PAIS = #codigoPais#
        
        <isNotEmpty property="indicadorActivo">
            AND ZR.IND_ACTI=1
            AND ZZ.IND_ACTI=1
        </isNotEmpty>
        
        <isEqual property="flag" compareValue="1">
            AND ZZ.CLIE_COD_CLIE IS NULL
        </isEqual>
        
        ORDER BY CODIGO
    </select>
	
	<select id="getRegionesDirectorioZON" parameterClass="java.util.Map" resultMap="baseResultZON">
		       SELECT NVL(R.COD_REGI, ' ') CODIGO,
		       NVL((SELECT R.DES_REGI
		             FROM MAE_CLIEN_TIPO_SUBTI A, MAE_TIPO_CLIEN B, MAE_CLIEN C
		            WHERE C.OID_CLIE = R.CLIE_OID_CLIE
		              AND A.CLIE_OID_CLIE = C.OID_CLIE
		              AND B.COD_TIPO_CLIE = '04'
		              AND B.OID_TIPO_CLIE = A.TICL_OID_TIPO_CLIE),
		           R.DES_REGI||' '||'Disponible') DESCRIPCION, NVL(R.COD_REGI, 'ZZ')
		  FROM ZON_REGIO R
		 WHERE R.IND_ACTI = 1
		 ORDER BY 3		    	    		      
    </select>
    	 
    <!-- OBTIENE TIPO CUTIS -->
    <select id="getTipoCutis" parameterClass="java.util.Map" resultMap="baseResultOids">
	    SELECT TRA.OID_TIPO_CUTI AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM MAE_TIPO_CUTIS TRA, V_GEN_I18N_SICC I18N
	     WHERE TRA.OID_TIPO_CUTI = I18N.VAL_OID
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'MAE_TIPO_CUTIS'
	     ORDER BY I18N.VAL_I18N 
    </select>

    <!-- OBTIENE OTRAS MARCAS -->
    <select id="getOtrasMarcas" parameterClass="java.util.Map" resultMap="baseResultOids">
	    SELECT TRA.OID_OTRA_MARC AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM MAE_OTRAS_MARCA TRA, V_GEN_I18N_SICC I18N
	     WHERE TRA.OID_OTRA_MARC = I18N.VAL_OID
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'MAE_OTRAS_MARCA'
	     ORDER BY I18N.VAL_I18N 
    </select>
    
    <!-- OBTIENE TIPO PERSONA -->
    <select id="getTipoPersona" parameterClass="java.util.Map" resultMap="baseResultOids">
	    SELECT TP.OID_TIPO_PERS AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM MAE_TIPO_PERSO TP, V_GEN_I18N_SICC I18N
	     WHERE TP.OID_TIPO_PERS = I18N.VAL_OID
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'MAE_TIPO_PERSO'
	     ORDER BY I18N.VAL_I18N 
    </select>
    
    <!-- OBTIENE ORIGEN INGRESO -->
	<select id="getOrigenIngreso" parameterClass="java.util.Map" resultMap="baseResultOids">
	    SELECT OI.OID_ORIG_INGR AS OID, I18N.VAL_I18N AS DESCRIPCION
	      FROM MAE_ORIG_INGRE OI, V_GEN_I18N_SICC I18N
	     WHERE OI.OID_ORIG_INGR = I18N.VAL_OID
	       AND I18N.IDIO_OID_IDIO = 1
	       AND I18N.ATTR_ENTI = 'MAE_ORIG_INGRE'
	     ORDER BY I18N.VAL_I18N 
    </select>

    <select id="getValidarOCRConsultora" parameterClass="java.util.Map" resultClass="java.util.HashMap">
			 		SELECT X.COD_CLIE codigoConsultora,
			 			(select z.NUM_DOCU_IDEN 
            			 from mae_clien_ident z
            			 where z.CLIE_OID_CLIE = X.OID_CLIE
             			 and z.TDOC_OID_TIPO_DOCU=2001) documentoIdentidad,
             			 GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(X.COD_CLIE, 'DES_REGI') descripcionRegion,
						 GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(X.COD_CLIE, 'COD_REGI') codigoRegion,
					     GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(X.COD_CLIE, 'DES_ZONA') descripcionZona,
					     GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(X.COD_CLIE, 'COD_ZONA') codigoZona,
						 X.VAL_NOM1 nombre1,
						 X.VAL_NOM2	nombre2,
						 X.VAL_APE1 apellido1,
						 X.VAL_APE2	apellido2
				    FROM MAE_CLIEN X	
		  <dynamic prepend="WHERE">	   
		  		 <isNotEmpty prepend="AND" property="codigoConsultora">			 	   
			 	    X.COD_CLIE = #codigoConsultora#
				 </isNotEmpty>
		  		 <isNotEmpty prepend="AND" property="numeroDocumento">			 	   
					 X.OID_CLIE IN(
					            select a.clie_oid_clie
					            from mae_clien_ident a
					            where a.CLIE_OID_CLIE = X.OID_CLIE
					            and  upper(a.NUM_DOCU_IDEN) = upper(#numeroDocumento#)
					            AND a.TDOC_OID_TIPO_DOCU=2001)
				 </isNotEmpty>
		   </dynamic>			 
	   
    </select>
    
    <!-- RECUPERAMOS ULTIMO HISTORICO ESTATUS DEL CLIENTE -->
    <select id="getUltimoHistoricoEstatus"  parameterClass="string" resultMap="clienteHistoricoEstatusResult">
 	    SELECT *
    	  FROM MAE_CLIEN_HISTO_ESTAT
	     WHERE CLIE_OID_CLIE = #value# 
	       AND PERD_OID_PERI_PERI_FIN IS NULL
    </select>
         
	<procedure id="executeActualizarPrimerContacto" parameterClass="string">														
			{call MAE_PKG_PROCE_CLIEN.MAE_PR_ACTUA_PRIME_CONTA(#"value#)}											
	</procedure>
	
	<procedure id="executeActualizarNivelesRiesgo">														
			{call MAE_PKG_PROCE_CLIEN.MAE_PR_ACTUA_NIVEL_RIESG}								
	</procedure>
	     
	<resultMap id="clienteBloqueoDesbloqueoSearchMapResult"		class="java.util.HashMap">
    	<result property="oidBloqueo" 		column="OID_BLOQ"/>
    	<result property="oidCliente" 		column="OID_CLIE"/>
    	<result property="codigoCliente" 	column="COD_CLIE"/>
    	<result property="nombre" 			column="NOMBRE"/>
    	<result property="bloqueado" 		column="BLOQUEADO"/>
    	<result property="tipoBloqueo" 		column="TIPO_BLOQUEO"/>
    	<result property="fechaBloqueo" 	column="FECHA_BLOQUEO"/>
    	<result property="fechaDesbloqueo" 	column="FECHA_DESBLOQUEO"/>
    	<result property="oidTipoBloqueo" 	column="OID_TIPO_BLOQUEO"/>
    	<result property="indicadorDesbloqueo" 	column="ind_desb"/>
    	<result property="descIndicadorDesbloqueo" 	column="des_ind_desb"/>
    </resultMap>
    
	<select id="getClientesBloqueoDesbloqueoByCriteria"  parameterClass="java.util.Map" resultMap="clienteBloqueoDesbloqueoSearchMapResult">
		SELECT 	DISTINCT
				bloq.OID_BLOQ,
       			bloq.OID_CLIE,
       			bloq.COD_CLIE,
       			bloq.NOMBRE,
       			bloq.BLOQUEADO,
       			bloq.TIPO_BLOQUEO,
       			TO_CHAR(bloq.FECHA_BLOQUEO, 'DD/MM/YYYY hh:mi:ss pm') FECHA_BLOQUEO,
       			TO_CHAR(bloq.FECHA_DESBLOQUEO, 'DD/MM/YYYY hh:mi:ss pm') FECHA_DESBLOQUEO,
       			bloq.OID_TIPO_BLOQUEO,
       			bloq.ind_desb,
       			bloq.des_ind_desb
 		  FROM (SELECT 	mb.OID_BLOQ,
              			m.oid_clie,
              			m.cod_clie,
              			TRIM(M.VAL_APE1) || ' ' || TRIM(M.VAL_APE2)  || ' ' || TRIM(M.VAL_NOM1) || ' ' || TRIM(M.VAL_NOM2)  AS NOMBRE,
              			'SI' AS bloqueado,
              			gtb.val_i18n AS tipo_bloqueo,
              			mb.fec_bloq AS fecha_bloqueo,
              			NULL AS fecha_desbloqueo,
              			gtb.val_oid OID_TIPO_BLOQUEO,
              			M.VAL_NOM1  NOMBRE1,
               			M.VAL_NOM2  NOMBRE2,
               			M.VAL_APE1  APELLIDO1,
               			M.VAL_APE2  APELLIDO2,
               			MB.ind_desb,
               			decode(MB.ind_desb, '1', 'Pendiente de RegularizaciÃ³n', '') des_ind_desb
         		  FROM 	mae_clien_bloqu mb,
              			mae_clien m,
              		   (SELECT g.val_oid, g.val_i18n FROM gen_i18n_sicc_comun g WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
                 WHERE	m.oid_clie = mb.clie_oid_clie
          		   AND 	mb.tibq_oid_tipo_bloq = gtb.val_oid
          		   AND 	mb.fec_desb IS NULL
       			UNION ALL
       			SELECT 	NULL OID_BLOQ,
              			m.oid_clie,
              			m.cod_clie,
              			TRIM(M.VAL_APE1) || ' ' || TRIM(M.VAL_APE2)  || ' ' || TRIM(M.VAL_NOM1) || ' ' || TRIM(M.VAL_NOM2)  AS NOMBRE,
              			'NO' AS bloqueado,
              			gtb.val_i18n AS tipo_bloqueo,
              			mb.fec_bloq AS fecha_bloqueo,
              			mb.fec_desb AS fecha_desbloqueo,
              			gtb.val_oid OID_TIPO_BLOQUEO,
              			M.VAL_NOM1  NOMBRE1,
               			M.VAL_NOM2  NOMBRE2,
               			M.VAL_APE1  APELLIDO1,
               			M.VAL_APE2  APELLIDO2,
               			MB.ind_desb,
               			decode(MB.ind_desb, '1', 'Pendiente de RegularizaciÃ³n', '') des_ind_desb
         		  FROM 	mae_clien_bloqu mb,
              			mae_clien m,
              		   (SELECT g.val_oid, g.val_i18n FROM gen_i18n_sicc_comun g WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
                 WHERE 	m.oid_clie = mb.clie_oid_clie
          		   AND 	mb.tibq_oid_tipo_bloq = gtb.val_oid
          		   AND 	mb.fec_desb IS NOT NULL
          		   AND 	NOT EXISTS (SELECT mb1.oid_bloq
                            		  FROM mae_clien_bloqu mb1
                                     WHERE mb1.clie_oid_clie = m.oid_clie
                                       AND mb1.fec_desb IS NULL)
                   AND 	mb.oid_bloq = (SELECT MAX(mb1.oid_bloq)
                                         FROM mae_clien_bloqu mb1
                                        WHERE mb1.clie_oid_clie = mb.clie_oid_clie
                                          AND mb1.fec_desb IS NOT NULL)
                UNION ALL
       			SELECT	NULL OID_BLOQ,
              			m.oid_clie,
              			m.cod_clie,
              			TRIM(M.VAL_APE1) || ' ' || TRIM(M.VAL_APE2)  || ' ' || TRIM(M.VAL_NOM1) || ' ' || TRIM(M.VAL_NOM2)  AS NOMBRE,
              			'NO' AS bloqueado,
              			NULL AS tipo_bloqueo,
              			NULL AS fecha_bloqueo,
              			NULL AS fecha_desbloqueo,
              			NULL OID_TIPO_BLOQUEO,
              			M.VAL_NOM1  NOMBRE1,
               			M.VAL_NOM2  NOMBRE2,
               			M.VAL_APE1  APELLIDO1,
               			M.VAL_APE2  APELLIDO2,
               			NULL ind_desb,
               			'' des_ind_desb
         		  FROM 	mae_clien m
        		 WHERE  NOT EXISTS (SELECT mb1.oid_bloq 
                            		  FROM mae_clien_bloqu mb1
                           		     WHERE mb1.clie_oid_clie = m.oid_clie)) bloq,
        		mae_clien_ident mi,
       			mae_tipo_docum mtd,
       			MAE_CLIEN_TIPO_SUBTI TS
 		 WHERE  bloq.oid_clie = mi.clie_oid_clie
   		   AND 	mi.tdoc_oid_tipo_docu = mtd.oid_tipo_docu
   		   AND 	ts.CLIE_OID_CLIE = MI.CLIE_OID_CLIE

		<isNotEmpty prepend="AND" property="codigoCliente">
	    	bloq.cod_clie = #codigoCliente#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="codigoTipoDocumentoIdentidad">
			mtd.OID_TIPO_DOCU = #codigoTipoDocumentoIdentidad#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="numeroDocumentoIdentidad">
			mi.num_docu_iden LIKE #numeroDocumentoIdentidad#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="nombre1">
			UPPER(bloq.NOMBRE1) LIKE UPPER(#nombre1#)
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="nombre2">
			UPPER(bloq.NOMBRE2) LIKE UPPER(#nombre2#)
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="apellido1">
			UPPER(bloq.APELLIDO1) LIKE UPPER(#apellido1#)
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="apellido2">
			UPPER(bloq.APELLIDO2) LIKE UPPER(#apellido2#)
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="oidTipoCliente">
			ts.TICL_OID_TIPO_CLIE =#oidTipoCliente#
		</isNotEmpty>

		<isNotEmpty prepend="AND" property="oidSubTipoCliente">
			ts.SBTI_OID_SUBT_CLIE =#oidSubTipoCliente#
		</isNotEmpty>

	ORDER BY cod_clie,
			 bloqueado DESC,
			 fecha_bloqueo,
			 tipo_bloqueo
	</select>
	
	<select id="getAccesosTiposBloqueoByUsuario"  parameterClass="java.lang.String" resultMap="baseResult">
		SELECT 
		tbl.cod_tipo_bloq AS codigo, 
		gtb.val_i18n AS descripcion
		  FROM seg_usuar_bloqu pb,
		       mae_tipo_bloqu tbl,
		       mae_valor_usuar_bloqu acc,
		       mae_valor_accio_bloqu modb,
		       (SELECT g.val_oid, g.val_i18n FROM gen_i18n_sicc_comun g WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
		 WHERE pb.est_regi = '1'
		   AND pb.tibq_oid_tipo_bloq = tbl.oid_tipo_bloq
		   AND pb.mvub_oid_valo_usua_bloq = acc.oid_valo_usua_bloq
		   AND acc.cod_valo_bloq IN ('A', 'L')
		   AND tbl.maab_oid_valo_acci_bloq = modb.oid_valo_acci_bloq
		   AND modb.cod_valo_bloq IN ('B', 'M')
		   AND gtb.val_oid = tbl.oid_tipo_bloq
		   AND pb.usua_cod_usua = #value#
		 ORDER BY gtb.val_i18n
	</select>
	
	<select id="getAccesosTiposDesbloqueoByUsuario"  parameterClass="java.lang.String" resultMap="baseResult">
		SELECT 
		tbl.cod_tipo_bloq AS codigo, 
		gtb.val_i18n AS descripcion
		  FROM seg_usuar_bloqu pb,
		       mae_tipo_bloqu tbl,
		       mae_valor_usuar_bloqu acc,
		       mae_valor_accio_bloqu modb,
		       (SELECT g.val_oid, g.val_i18n FROM gen_i18n_sicc_comun g WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
		 WHERE pb.est_regi = '1'
		   AND pb.tibq_oid_tipo_bloq = tbl.oid_tipo_bloq
		   AND pb.mvub_oid_valo_usua_bloq = acc.oid_valo_usua_bloq
		   AND acc.cod_valo_bloq IN ('A', 'D')
		   AND tbl.maab_oid_valo_acci_desb = modb.oid_valo_acci_bloq
		   AND modb.cod_valo_bloq IN ('B', 'M')
		   AND gtb.val_oid = tbl.oid_tipo_bloq
		   AND pb.usua_cod_usua = #value#
		 ORDER BY gtb.val_i18n
	</select>

	<select id="getBloqueosClienteByTipoBloqueo"  parameterClass="java.util.Map" resultMap="baseResultBLOQUEO">
		SELECT
			gtb.val_i18n AS tipo_bloqueo, 
        	mb.val_usua_bloq, 
        	to_char(mb.fec_bloq, 'dd/mm/yyyy hh:mi:ss pm') fec_bloq
		  FROM mae_clien_bloqu mb,
		       mae_tipo_bloqu tbnuevo,
		       mae_tipo_bloqu tbanterior,
		       (SELECT g.val_oid, g.val_i18n FROM gen_i18n_sicc_comun g WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
		 WHERE mb.tibq_oid_tipo_bloq = tbanterior.oid_tipo_bloq
		   AND mb.tibq_oid_tipo_bloq = gtb.val_oid
		   AND mb.fec_desb IS NULL
		   <![CDATA[
		   AND tbanterior.num_nive_grav_bloq <= tbnuevo.num_nive_grav_bloq
		   ]]>		   
		   AND tbnuevo.cod_tipo_bloq = #tipoBloqueo#
		   AND mb.clie_oid_clie = #oidCliente#
		   AND tbanterior.num_nive_grav_bloq = (SELECT MIN(tb.num_nive_grav_bloq)
		                                          FROM mae_tipo_bloqu tb, mae_clien_bloqu mb1
		                                         WHERE tb.oid_tipo_bloq = mb1.tibq_oid_tipo_bloq
		                                           AND mb1.clie_oid_clie = mb.clie_oid_clie
		                                           AND mb1.fec_desb IS NULL)
		   AND rownum = 1
	</select>
	     
    <insert id="insertBloqueoCliente" parameterClass="java.util.HashMap">
		INSERT INTO MAE_CLIEN_BLOQU(
		    OID_BLOQ,
		    CLIE_OID_CLIE,
		    TIBQ_OID_TIPO_BLOQ,
		    FEC_BLOQ,
		    VAL_MOTI_BLOQ,
		    VAL_USUA_BLOQ,
		    OBS_BLOQ,
		    MAAB_OID_VALO_ACCI_BLOQ,
		    ARNE_COD_PAIS,
		    ARNE_COD_AREA)
		VALUES(
		    mae_clbl_seq.NEXTVAL,
		    #oidCliente#,
		    GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_TIPO_BLOQ(#tipoBloqueo#),
		    SYSDATE,
		    #motivoBloqueo#,
		    #usuarioBloqueo#,
		    #observacionesBloqueo#,
		    GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_VACC_BLOQ('M'),
		    #codigoPais#,
		    #codigoArea#
		)
    </insert>
	     
	<select id="getAccesosTiposDesbloqueoByUsuarioTipo"  parameterClass="java.util.HashMap" resultMap="baseResult">
		SELECT 
		tbl.cod_tipo_bloq AS codigo, 
		gtb.val_i18n AS descripcion
		  FROM seg_usuar_bloqu pb,
		       mae_tipo_bloqu tbl,
		       mae_valor_usuar_bloqu acc,
		       mae_valor_accio_bloqu modb,
		       (SELECT g.val_oid, g.val_i18n FROM gen_i18n_sicc_comun g WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
		 WHERE pb.est_regi = '1'
		   AND pb.tibq_oid_tipo_bloq = tbl.oid_tipo_bloq
		   AND pb.mvub_oid_valo_usua_bloq = acc.oid_valo_usua_bloq
		   AND acc.cod_valo_bloq IN ('A', 'D')
		   AND tbl.maab_oid_valo_acci_desb = modb.oid_valo_acci_bloq
		   AND modb.cod_valo_bloq IN ('B', 'M')
		   AND gtb.val_oid = tbl.oid_tipo_bloq
		   AND tbl.oid_tipo_bloq = #oidTipoBloqueo#
		   AND pb.usua_cod_usua = #codigoUsuario#
		 ORDER BY gtb.val_i18n
	</select>

	<resultMap id="bloqueoClienteMapResult"		class="java.util.HashMap">
    	<result property="oidBloqueo" 		column="OID_BLOQ"/>
    	<result property="oidCliente" 		column="OID_CLIE"/>
    	<result property="codigoCliente" 	column="COD_CLIE"/>
    	<result property="nombre" 			column="NOMBRE"/>
    	<result property="tipoBloqueo" 		column="TIPO_BLOQUEO"/>
    	<result property="motivoBloqueo" 	column="MOTI_BLOQ"/>
    	<result property="observacionesBloqueo" 	column="OBS_BLOQ"/>
    	<result property="fechaDesbloqueo" 			column="FEC_DESB"/>
    	<result property="usuarioDesbloqueo" 		column="VAL_USUA_DESB"/>
    	<result property="codigoArea" 		        column="ARNE_COD_AREA"/>
    	<result property="descripcionArea" 		    column="DES_COD_AREA"/>
    	<result property="indicadorDesbloqueo" 		column="ind_desb"/>
    </resultMap>

	<select id="getBloqueoCliente"  parameterClass="java.lang.String" resultMap="bloqueoClienteMapResult">
	     SELECT OID_BLOQ,
	            mb.clie_oid_clie OID_CLIE, 
	            m.cod_clie,
	            m.val_nom1 || ' ' || m.val_nom2 || ' ' || m.val_ape1 || ' ' || m.val_ape1 AS nombre,
	            gtb.val_i18n AS tipo_bloqueo,
	            mb.VAL_MOTI_BLOQ MOTI_BLOQ,
	            mb.OBS_BLOQ,
	            TO_CHAR(mb.FEC_DESB, 'dd/mm/yyyy hh:mi:ss pm') FEC_DESB,
	            mb.VAL_USUA_DESB,
	            MB.ARNE_COD_AREA,
	            mb.ind_desb,
	            (SELECT DES_AREA_NEGO 
	             FROM MAE_AREA_NEGOC X
	             WHERE X.COD_PAIS = MB.ARNE_COD_PAIS 
	               AND X.COD_AREA = MB.ARNE_COD_AREA) DES_COD_AREA
	       FROM mae_clien_bloqu mb,
	            mae_clien m,
	            (SELECT g.val_oid, g.val_i18n FROM gen_i18n_sicc_comun g WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
	      WHERE m.oid_clie = mb.clie_oid_clie
	        AND mb.tibq_oid_tipo_bloq = gtb.val_oid
	        AND mb.OID_BLOQ = #value#
	</select>
	
    <update id="updateBloqueoCliente" parameterClass="java.util.Map">
		UPDATE MAE_CLIEN_BLOQU SET 
		   FEC_DESB = SYSDATE,
		   VAL_USUA_DESB = #usuarioDesbloqueo#,
		   MAAB_OID_VALO_ACCI_DESB = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_VACC_BLOQ('M'),
		   OBS_DESB = #observacionesDesbloqueo#,
		   ARNE_COD_PAIS = #codigoPais#,
		   ARNE_COD_AREA = #codigoArea#,
		   ind_desb = #indicadorDesbloqueo#
		 WHERE OID_BLOQ = #oidBloqueo#  
    </update>
	
	<resultMap id="logBloqueoClienteMapResult"		class="java.util.HashMap">
    	<result property="tipoBloqueo" 			column="TIPO_BLOQUEO"/>
    	<result property="fechaBloqueo" 		column="FEC_BLOQ"/>
    	<result property="formaBloqueo" 		column="FOR_BLOQ"/>
    	<result property="usuarioBloqueo" 		column="USU_BLOQ"/>
    	<result property="motivoBloqueo" 		column="MOT_BLOQ"/>
    	<result property="observacionesBloqueo"	column="OBS_BLOQ"/>
    	<result property="codigoArea"	        column="ARNE_COD_AREA"/>
    	<result property="descripcionArea"	    column="DES_COD_AREA"/>
    	<result property="indicadorDesbloqueo"	column="IND_DESB"/>
    	<result property="descIndicadorDesbloqueo"	column="DES_IND_DESB"/>
    </resultMap>
	
	<select id="getLogBloqueosCliente"  parameterClass="java.lang.Long" resultMap="logBloqueoClienteMapResult">
		SELECT   gtb.val_i18n tipo_bloqueo,
		         TO_CHAR (mb.fec_bloq, 'dd/mm/yyyy hh:mi:ss pm') fec_bloq,
		         ma.des_valo_bloq for_bloq, mb.val_usua_bloq usu_bloq, mb.val_moti_bloq mot_bloq, obs_bloq,
		         MB.ARNE_COD_AREA,
		         (SELECT DES_AREA_NEGO 
	             FROM MAE_AREA_NEGOC X
	             WHERE X.COD_PAIS = MB.ARNE_COD_PAIS 
	               AND X.COD_AREA = MB.ARNE_COD_AREA) DES_COD_AREA,
		         MB.IND_DESB,
		         decode(MB.ind_desb, '1', 'Pendiente de RegularizaciÃ³n', '') des_ind_desb
		         
		    FROM mae_clien_bloqu mb,
		         mae_valor_accio_bloqu ma,
		         (SELECT g.val_oid, g.val_i18n
		            FROM gen_i18n_sicc_comun g
		           WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
		   WHERE mb.tibq_oid_tipo_bloq = gtb.val_oid
		     AND mb.maab_oid_valo_acci_bloq = ma.oid_valo_acci_bloq
		     AND mb.clie_oid_clie = #value#
		ORDER BY mb.fec_bloq DESC
	</select>

	<resultMap id="logDesbloqueoClienteMapResult"		class="java.util.HashMap">
    	<result property="tipoBloqueo" 				column="TIPO_BLOQUEO"/>
    	<result property="fechaBloqueo" 			column="FEC_BLOQ"/>
    	<result property="fechaDesbloqueo" 			column="FEC_DESB"/>
    	<result property="formaDesbloqueo" 			column="FOR_DESB"/>
    	<result property="usuarioDesbloqueo" 		column="USU_DESB"/>
    	<result property="observacionesDesbloqueo"	column="OBS_DESB"/>
    	<result property="codigoArea"	        column="ARNE_COD_AREA"/>
    	<result property="descripcionArea"	    column="DES_COD_AREA"/>
    	<result property="indicadorDesbloqueo"	column="IND_DESB"/>
    	<result property="descIndicadorDesbloqueo"	column="DES_IND_DESB"/>
    </resultMap>

	<select id="getLogDesbloqueosCliente"  parameterClass="java.lang.Long" resultMap="logDesbloqueoClienteMapResult">
		SELECT   gtb.val_i18n tipo_bloqueo,
		         TO_CHAR (mb.fec_bloq, 'dd/mm/yyyy hh:mi:ss pm') fec_bloq,
		         TO_CHAR (mb.fec_desb, 'dd/mm/yyyy hh:mi:ss pm') fec_desb,         
		         ma.des_valo_bloq for_desb, mb.val_usua_desb usu_desb, obs_desb,
		         MB.ARNE_COD_AREA,
		         (SELECT DES_AREA_NEGO 
	             FROM MAE_AREA_NEGOC X
	             WHERE X.COD_PAIS = MB.ARNE_COD_PAIS 
	               AND X.COD_AREA = MB.ARNE_COD_AREA) DES_COD_AREA,
		         MB.IND_DESB,
		         decode(MB.ind_desb, '1', 'Pendiente de RegularizaciÃ³n', '') des_ind_desb
		         
		    FROM mae_clien_bloqu mb,
		         mae_valor_accio_bloqu ma,
		         (SELECT g.val_oid, g.val_i18n
		            FROM gen_i18n_sicc_comun g
		           WHERE g.attr_enti = 'MAE_TIPO_BLOQU') gtb
		   WHERE mb.tibq_oid_tipo_bloq = gtb.val_oid
		     AND mb.maab_oid_valo_acci_desb = ma.oid_valo_acci_bloq
		     AND mb.clie_oid_clie = #value#
		ORDER BY mb.fec_desb DESC
	</select>
	
    <select id="getCiudades" parameterClass="java.util.Map" resultMap="baseResultOids">
		SELECT COD_UGEO_REGI || '__' || COD_CIUD OID, 
		       DES_CIUD DESCRIPCION
		  FROM ZON_CIUDA
		 WHERE COD_UGEO_REGI = #codigoRegion#
		 ORDER BY DES_CIUD
    </select>

   <select id="getValidarNumeroDocumentoMod11V" parameterClass="string" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_VALID_NUMER_DOCUM_MOD11(#value#)  
		FROM DUAL                                                                     	
   </select>	             

   <select id="getSecuenciaCodigoCliente" parameterClass="string" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_OBTEN_SECUE_CODIG_CLIEN(#codigoPais#)  
		FROM DUAL
   </select>

    <select id="getPedidosEnProceso" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1) 
		  FROM PED_SOLIC_CABEC sol, 
		       PED_TIPO_SOLIC_PAIS  tsp, 
		       PED_TIPO_SOLIC tso,
		       CRA_PERIO cra,
		       SEG_PERIO_CORPO cor
		 WHERE sol.CLIE_OID_CLIE = #oidCliente#
		   AND sol.TSPA_OID_TIPO_SOLI_PAIS = tsp.OID_TIPO_SOLI_PAIS 
		   AND tsp.TSOL_OID_TIPO_SOLI = tso.OID_TIPO_SOLI 
		   AND tso.COD_TIPO_SOLI = 'SOC'
		   AND sol.PERD_OID_PERI = cra.OID_PERI
		   AND cra.PERI_OID_PERI = cor.OID_PERI
		   AND cor.cod_peri = #codigoPeriodo#
		   AND sol.GRPR_OID_GRUP_PROC in (1,2,3,4)    
    </select>

    <select id="getOidTipoDocumento" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_TIPO_DOCU    
		  FROM MAE_TIPO_DOCUM
		 WHERE PAIS_OID_PAIS = #oidPais#
		   AND COD_TIPO_DOCU = #tipoDocumento#
    </select>
    
    <select id="getOidTipoDocumento1" parameterClass="java.util.Map" resultClass="string">
		SELECT OID_TIPO_DOCU    
		  FROM MAE_TIPO_DOCUM
		 WHERE PAIS_OID_PAIS = #oidPais#
		   AND OID_TIPO_DOCU = #tipoDocumento#
    </select>
     
    <select id="getExisteCodigoCUB" parameterClass="java.util.Map" resultClass="string">
    	SELECT COD_CUB
		  FROM MAE_CLIEN_DATOS_ADICI
		WHERE  COD_CUB = #codigoCUB#
    </select>
    
    <select id="getPeriodoInicioVacaciones" parameterClass="java.util.Map" resultClass="string">
		SELECT DISTINCT CAM_INIC
		  FROM MAE_PARAM_DIREC_VACAC
		  
		<![CDATA[		  
		 WHERE CAM_INIC <= #codigoPeriodo#
		   AND #codigoPeriodo# <= CAM_FINA
		]]>   
    </select>

    <select id="getPeriodoFinVacaciones" parameterClass="java.util.Map" resultClass="string">
		SELECT DISTINCT CAM_FINA
		  FROM MAE_PARAM_DIREC_VACAC
		<![CDATA[		  
		 WHERE CAM_INIC <= #codigoPeriodo#
		   AND #codigoPeriodo# <= CAM_FINA
		]]>		   
    </select>
    
    <parameterMap id="executeActualizacionClasificacionVacacionesParams" class="java.util.Map">														
    	<parameter property="codigoPais"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="oidCliente"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="codigoUsuario"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 </parameterMap>
  														
  	<procedure id="executeActualizacionClasificacionVacaciones" parameterMap="executeActualizacionClasificacionVacacionesParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_ACTUA_CLASI_DIREC_VACAC(?, ?, ?)}											
	</procedure>

    <parameterMap id="executeEliminarClasificacionVacacionesParams" class="java.util.Map">														
    	<parameter property="codigoPais"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="oidCliente"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 </parameterMap>
  														
  	<procedure id="executeEliminarClasificacionVacaciones" parameterMap="executeEliminarClasificacionVacacionesParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_ELIMI_CLASI_DIREC_VACAC(?, ?)}											
	</procedure>
		
	<select id="getTienePedidoFacturado" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1) 
		  FROM PED_SOLIC_CABEC sol, 
		       PED_TIPO_SOLIC_PAIS  tsp, 
		       PED_TIPO_SOLIC tso,
		       CRA_PERIO cra,
		       SEG_PERIO_CORPO cor
		 WHERE sol.CLIE_OID_CLIE = #oidCliente#
		   AND sol.TSPA_OID_TIPO_SOLI_PAIS = tsp.OID_TIPO_SOLI_PAIS 
		   AND tsp.TSOL_OID_TIPO_SOLI = tso.OID_TIPO_SOLI 
		   AND tso.COD_TIPO_SOLI = 'SOC'
		   AND sol.PERD_OID_PERI = cra.OID_PERI
		   AND cra.PERI_OID_PERI = cor.OID_PERI
		   AND cor.cod_peri = #codigoPeriodo#
		   AND sol.FEC_FACT IS NULL    
    </select>
		 
    <select id="getTienePedidoEnProcesoFacturacion" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1) 
		  FROM PED_SOLIC_CABEC sol, 
		       PED_TIPO_SOLIC_PAIS  tsp, 
		       PED_TIPO_SOLIC tso,
		       CRA_PERIO cra,
		       SEG_PERIO_CORPO cor
		 WHERE sol.CLIE_OID_CLIE = #oidCliente#
		   AND sol.TSPA_OID_TIPO_SOLI_PAIS = tsp.OID_TIPO_SOLI_PAIS 
		   AND tsp.TSOL_OID_TIPO_SOLI = tso.OID_TIPO_SOLI 
		   AND tso.COD_TIPO_SOLI = 'SOC'
		   AND sol.PERD_OID_PERI = cra.OID_PERI
		   AND cra.PERI_OID_PERI = cor.OID_PERI
		   AND cor.cod_peri = #codigoPeriodo#
		   AND sol.GRPR_OID_GRUP_PROC in (2,3,4)    
    </select>

    <select id="getValidarBloqueoDesbloqueoCliente" parameterClass="java.util.Map" resultClass="string">
    	SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_VALID_BLOQU_DESBL_CLIEN(#codigoCliente#, #accionBloqueo#, #tipoBloqueo#)  
		FROM DUAL
    </select>
    	
	<update id="updateDesbloqueoCliente" parameterClass="java.util.Map">
		UPDATE MAE_CLIEN_BLOQU 
		   SET FEC_DESB = SYSDATE,
		       VAL_USUA_DESB = #usuarioBloqueo#,
		       MAAB_OID_VALO_ACCI_DESB = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_VACC_BLOQ('M'),
		       OBS_DESB = #observacionesBloqueo#,
		       IND_DESB = #indicadorDesbloqueo#
		 WHERE CLIE_OID_CLIE = #oidCliente#
		   AND TIBQ_OID_TIPO_BLOQ = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_TIPO_BLOQ(#tipoBloqueo#) 
		   AND FEC_BLOQ IS NOT NULL
		   AND FEC_DESB IS NULL  
    </update>
    
    <insert id="insertSolicitudCreditoRechazado" parameterClass="java.util.Map">    	
		INSERT INTO INT_SOLIC_CONSO_CREDI
		  (COD_PAIS,
		   COD_COMP,
		   COD_CLIE,
		   NUM_LOTE,
		   SEC_NUME_DOCU,
		   UNI_ADMI,
		   FEC_PROC,
		   COD_PERI,
		   VAL_APE1, 
		   VAL_APE2, 
		   VAL_NOM1, 
		   VAL_NOM2, 
		   TIP_DOCU, 
		   NUM_DOCU_IDEN,
		   FEC_HORA_CREA_SOLI
		   )
		VALUES
		  (#codigoPais#,
		   #codigoCompania#,
		   #codigoCliente#,		   
		   #numeroLote#,
		   #numeroSecuencia#,
		   MAE_PKG_PROCE_CLIEN.MAE_FN_OBTEN_CODUA_SOLIC_CREDI(#codigoZona#, #codigoTerritorio#),
		   trunc(SYSDATE),
		   MAE_PKG_PROCE_CLIEN.MAE_FN_OBTIE_CODIG_PERIO(#oidPeriodo#),
		   #apellidoPaterno#,
		   #apellidoMaterno#,
		   #nombre1#,
		   #nombre2#,
		   (SELECT a.COD_TIPO_DOCU 
 		      FROM MAE_TIPO_DOCUM A
			 WHERE A.OID_TIPO_DOCU = #tipoDocumentoIdentidad#),
		   #numeroDocumentoIdentidad#,
		   TO_CHAR(SYSDATE, 'dd/mm/yyyy hh24:mi:ss')
		   )
	</insert>
    
    <insert id="insertDocumentoDigitacion" parameterClass="java.util.Map">
	    INSERT INTO STO_DOCUM_DIGIT
			  (COD_PAIS,
			   COD_TIPO_DOCU,
			   NUM_LOTE,
			   SEC_NUME_DOCU,
			   IND_ENVI,
			   IND_RECH,
			   COD_CLIE,
			   USU_DIGI,
			   FEC_DIGI
			   )
			VALUES
			  (#codigoPais#,
			   #codigoTipoDocumento#,
			   #numeroLote#,
			   #numeroSecuencia#,
			   #indicadorEnvio#,
			   #indicadorRechazo#,
			   #codigoCliente#,
			   #codigoUsuario#,
			   SYSDATE
			   )
	</insert>

    <insert id="insertDetalleExcepcion" parameterClass="java.util.Map">
    	INSERT INTO STO_DETAL_DOCUM_EXCEP  
		    (COD_PAIS,
		     COD_TIPO_DOCU,
		     NUM_LOTE,
		     COD_VALI,
		     SEC_NUME_DOCU,
		     IND_APRO,
		     IND_GEST,
		     IND_LEVA_ERRO,
		     COD_MENS,
		     USU_DIGI,
			 FEC_DIGI)    
		VALUES
			(#codigoPais#,
			 #codigoTipoDocumento#,
			 #numeroLote#,
			 #codigoValidacion#,
			 #numeroSecuencia#,
			 #indicadorAprobado#,
			 #indicadorGestion#,
			 #indicadorLevaError#,
			 #codigoMensaje#,
			 #codigoUsuario#,
			 SYSDATE
			 )
	</insert>
    
    <parameterMap id="executeGenerarSolicitudCreditoRechazadaParams" class="java.util.Map">														
    	<parameter property="codigoPais"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoCliente"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoUsuario"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 </parameterMap>
  														
  	<procedure id="executeGenerarSolicitudCreditoRechazada" parameterMap="executeGenerarSolicitudCreditoRechazadaParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_GENER_SOLIC_CREDI_RECHA(?, ?, ?)}											
	</procedure>
	
	
    <select id="getObtieneTipoValidacion" parameterClass="java.util.Map" resultClass="string">
		SELECT nvl2(tip_vali,'true','false')
		  FROM MAE_CLIEN_MODUL
		 WHERE COD_PAIS = #codigoPais#
		   AND TIP_VALI = 'VAL_EXIDOC' 
    </select>
    
    <select id="getValidacionDocumentoIdentidad" parameterClass="string" resultClass="string">
			  SELECT NUM_DOCU_IDEN
  			  FROM MAE_CLIEN_IDENT
  			  WHERE num_docu_iden= #value# 
  			  AND ROWNUM = 1
   </select>
   
   
   <resultMap id="baseDatosCliente"    class="java.util.HashMap">
   		<result property="codigoCliente" 			column="COD_CLIE"/>
    	<result property="nombreCliente" 			column="NOM_CLIE"/>
    	<result property="region"       			column="DES_REGI"/>
    	<result property="zona"         			column="DES_ZONA"/>
    	<result property="codigozona"      			column="COD_ZONA"/>
    	<result property="indicadorEmprendedora"    column="IND_EMPR"/>
    	<result property="codigozonaPrograma"      	column="COD_ZONA_PROG"/>
    	<result property="indicadorBaja"            column="IND_BAJA"/>
	</resultMap>  
   
    <!-- OBTIENE LA INFORMACION DEL CLIENTE -->
    <select id="getDatosCliente" parameterClass="java.util.Map" resultMap="baseDatosCliente">
    	select mc.cod_clie,
    	       mc.VAL_NOM1 || ' ' || mc.VAL_NOM2 || ' ' || mc.VAL_APE1 || ' ' || mc.VAL_APE2 NOM_CLIE,
		       gen_pkg_gener.gen_fn_clien_datos(mc.cod_clie,'DES_REGI') DES_REGI,
		       gen_pkg_gener.gen_fn_clien_datos(mc.cod_clie,'DES_ZONA') DES_ZONA,
		       gen_pkg_gener.gen_fn_clien_datos(mc.cod_clie,'COD_ZONA') COD_ZONA,
		       xxx.ind_empr                                             IND_EMPR,
               xxx.pre_codi_zona                                        COD_ZONA_PROG,
               xxx.ind_baja                                             IND_BAJA
		from mae_clien mc,
             emp_empre xxx
		where mc.cod_clie = #codigoCliente#
		  and xxx.cod_clie(+) = mc.cod_clie
    </select>
    
     <!-- OBTIENE LA INFORMACION DEL CLIENTE -->
    <select id="getDatosEmprendedoraCliente" parameterClass="java.util.Map" resultMap="baseDatosCliente">
       select vte.cod_clie,
       		  vte.VAL_NOM1 || ' ' || vte.VAL_NOM2 || ' ' || vte.VAL_APE1 || ' ' || vte.VAL_APE2 NOM_CLIE,
		      gen_pkg_gener.gen_fn_clien_datos(vte.cod_clie,'DES_REGI') DES_REGI,
		      gen_pkg_gener.gen_fn_clien_datos(vte.cod_clie,'DES_ZONA') DES_ZONA,
		      gen_pkg_gener.gen_fn_clien_datos(vte.cod_clie,'COD_ZONA') COD_ZONA,
              ee.ind_empr IND_EMPR  ,
              ee.pre_codi_zona COD_ZONA_PROG ,
              ee.ind_baja   IND_BAJA
		from mae_clien_vincu mv,
			 mae_clien vte,
			 mae_clien vdo,
             emp_empre ee 
	   where mv.clie_oid_clie_vnte = vte.oid_clie
		 and mv.clie_oid_clie_vndo = vdo.oid_clie
		 and mv.fec_hast is null
		 and mv.tivc_oid_tipo_vinc in (select tv.oid_tipo_vinc 
				                                  from mae_tipo_vincu tv 
				                                 where tv.cod_tipo_vinc = '07')
		 and vdo.cod_clie = #codigoCliente#
		 and ee.cod_clie(+) = vte.cod_clie
	</select>			  
    
    <select id="getMotivosBaja" parameterClass="java.util.Map" resultMap="baseResult">
    	select mb.cod_moti_baja as codigo, 
    	       mb.des_moti_baja as descripcion
	      from emp_motiv_baja mb 
		 where mb.ind_pre_empr = #indicadorEmprendedora#
    </select>

	<parameterMap id="executeBajaManualEmpresariasParams" class="java.util.Map">														    	
    	<parameter property="codigoCliente"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="motivo"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoUsuario"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 </parameterMap>
  														
  	<procedure id="executeBajaManualEmpresarias" parameterMap="executeBajaManualEmpresariasParams">														
		{call EMP_PKG_PROCE.EMP_PR_PROCE_BAJAS_EMPRE(?, ?, ?)}											
	</procedure>
    
    <select id="getZonaPeriodoCerrada" parameterClass="java.util.Map" resultClass="string">    
	   select decode(count(1),0,'N','S')
		 from fac_contr_cierr cc,
		      FAC_TIPOS_CIERR tc,
		      cra_perio cp,
		      zon_regio zr,
		      zon_zona zz
		where cc.tcie_oid_tipo_cier = tc.oid_tipo_cier
		  and tc.cod_tipo_cier = 'R' 
		  and cc.val_resu_proc = 'OK'    
		  and zr.oid_regi = cc.zorg_oid_regi
		  and cc.perd_oid_peri = cp.oid_peri
		  and cp.val_nomb_peri like '%'||#codigoPeriodo#||'%'
		  and zr.oid_regi = zz.zorg_oid_regi
		  and zz.cod_zona = #codigoZona#
  </select>
  
  <parameterMap id="executeReasignacionManualEmpresariasParams" class="java.util.Map">														    	
    	<parameter property="codigoCliente"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoNuevaEmprendedora"   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="motivo"           			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoUsuario"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 </parameterMap>
    
  <procedure id="executeReasignacionManualEmpresarias" parameterMap="executeReasignacionManualEmpresariasParams">														
		{call EMP_PKG_PROCE.EMP_PR_PROCE_REASI_EMPRE(?, ?, ?, ?)}											
  </procedure>
	  
  <parameterMap id="executeActualizacionDatosPortalParams" class="java.util.Map">										
  	    <parameter property="codigoPais"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>				    	
    	<parameter property="codigoConsultora"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="email"   						jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="telefonoFijo"           		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="telefonoCelular"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="mensajeError"     			   jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>
	 </parameterMap>
    
  <procedure id="executeActualizacionDatosPortal" parameterMap="executeActualizacionDatosPortalParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_ACTUA_CLIEN_PORTA(?, ?, ?, ?,?,?)}											
  </procedure>
  
  <delete id="deleteReporteClienteTemporal" parameterClass="string">
		DELETE MAE_REPOR_CLIEN_TEMPO
 		 WHERE USU_REG = #value#
  </delete>	  
	  
  <insert id="insertReporteClienteTemporal" parameterClass="java.util.HashMap">
  		INSERT INTO MAE_REPOR_CLIEN_TEMPO (
		    COD_CLIE, VAL_NOM1, VAL_NOM2, VAL_APE1, VAL_APE2, COD_ZONA, COD_TERR,
		    IND_ACTI, STATUS, TIP_SUB_TIPO, FEC_INGR, VAL_MOTI_COMP, USU_REG)
		VALUES (
			#codigo#, #nombre1#, #nombre2#, #apellido1#, #apellido2#, #codigoZona#, #codigoTerritorio#,
			#indicadorActivo#, #statusCliente#, #subTipoCliente#, TO_DATE(#fechaIngreso#, 'DD/MM/YYYY'), #motivoCompromiso#, #login#)
  </insert>
	
	<!-- VERIFICA SI LA REGION DE LA SECCION YA PROCESO CIERRE DE REGION PARA LA CAMPAÃ‘A ACTUAL -->
    <select id="getRegionCerradaxSeccion" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(FPC.COR_PROG_CIER)
		  FROM FAC_PROGR_CIERR FPC
		 WHERE FPC.TIP_CIER = 'R'
		   AND FPC.CAM_PROC = #codigoPeriodoActual#
		   AND FPC.COD_REGI = #codigoRegion#
		   AND FPC.EST_CIER = 'P'
		   AND FPC.EST_REGI = '1'
    </select>  	
    
     <!-- OBTIENE EL TIPO DOCUMENTO -->
    <select id="getCodigoTipoDocLegal" parameterClass="string" resultClass="string">
	    SELECT MTD.oid_tipo_docu 
	    	FROM MAE_TIPO_DOCUM   MTD
			INNER JOIN fac_tipo_docum FTD
			ON MTD.TIDO_OID_TIPO_DOCU = FTD.oid_tipo_docu
			WHERE
			FTD.cod_tipo_docu IN ('001','002','029')
			and MTD.oid_tipo_docu = #tipoDocumentoIdentidad#
    </select>
    
    <select id="getZonasDirectorioActivas" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZON_ZONA.COD_ZONA, ' ') AS CODIGO, 	   
		    NVL(ZON_ZONA.DES_ZONA, ' ') AS DESCRIPCION,
		    NVL(ZON_ZONA.COD_ZONA, 'ZZ')		
	 FROM  ZON_ZONA,
	       ZON_REGIO
	 WHERE (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
	       <isNotEmpty property="codigoRegion">	
		    <iterate prepend="AND" property="codigoRegion" open=" ZON_REGIO.COD_REGI IN (" close=")" conjunction=",">
        	 	#codigoRegion[]#
        	</iterate>    
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="indicadorActivo">
					ZON_ZONA.IND_ACTI =#indicadorActivo#
		   </isNotEmpty> 			       
	 ORDER BY 3
    </select>
    
    <select id="getZonasDirectorioActivasFOX" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZZ.COD_ZONA, ' ') AS CODIGO,        
            NVL(ZZ.DES_ZONA, ' ') AS DESCRIPCION,
            NVL(ZZ.COD_ZONA, 'ZZ')        
     FROM  ZON_DIREC_ZONA ZZ,
           ZON_DIREC_REGIO ZR
     WHERE ZZ.PAIS_COD_PAIS = ZR.PAIS_COD_PAIS
     AND ZZ.REGI_COD_REGI = ZR.COD_REGI
     AND ZR.PAIS_COD_PAIS = #codigoPais#
           <isNotEmpty property="codigoRegion">    
            <iterate prepend="AND" property="codigoRegion" open=" ZR.COD_REGI IN (" close=")" conjunction=",">
                 #codigoRegion[]#
            </iterate>    
          </isNotEmpty>
          <isNotEmpty prepend="AND" property="indicadorActivo">
                    ZZ.IND_ACTI =#indicadorActivo#
           </isNotEmpty>                    
     ORDER BY 3
    </select>
    
    <select id="getOidEstadoCivil" parameterClass="string" resultClass="long">
		SELECT OID_ESTA_CIVI
		  FROM MAE_ESTAD_CIVIL
		 WHERE COD_ESTA_CIVI = #value#
    </select>

    <select id="getOidGradoInstruccion" parameterClass="string" resultClass="long">
		SELECT OID_NIVE_ESTU
		  FROM MAE_NIVEL_ESTUD
		 WHERE COD_NIVE_ESTU = #value#
    </select>

    <select id="getOidNacionalidad" parameterClass="string" resultClass="long">
		SELECT OID_NACI
		  FROM SEG_NACIO
		 WHERE COD_NACI = #value#
    </select>
    
    <select id="getOidTratamiento" parameterClass="string" resultClass="long">
		SELECT OID_TIPO_TRAT
		  FROM MAE_TIPO_TRATA
		 WHERE COD_TIPO_TRAT = #value#
    </select>
    
    <select id="getOidTipoCliente" parameterClass="string" resultClass="long">
		SELECT OID_TIPO_CLIE
		  FROM MAE_TIPO_CLIEN 
		 WHERE COD_TIPO_CLIE = #value#
    </select>
    
    <select id="getOidSubTipoCliente" parameterClass="java.util.Map" resultClass="long">
		SELECT OID_SUBT_CLIE
		  FROM MAE_SUBTI_CLIEN 
		 WHERE TICL_OID_TIPO_CLIE = #oidTipoCliente#
		   AND COD_SUBT_CLIE = #codigoSubTipoCliente#
    </select>
    
    <select id="getCodigoPeriodoByOidPeriodo" parameterClass="string" resultClass="java.lang.String">
		SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_DES_PERIO(#value#) FROM DUAL
	</select>
	
	<select id="getExisteClienteCUB" parameterClass="string" resultClass="string">
    	SELECT cli.COD_CLIE
		  FROM MAE_CLIEN_DATOS_ADICI adi, MAE_CLIEN cli
		 WHERE adi.COD_CUB = #codigoCUB#
		   AND adi.CLIE_OID_CLIE = cli.OID_CLIE 
    </select>
    
    <select id="getValorByPaisAndTipo" parameterClass="java.util.Map" resultClass="string">
		SELECT MOD_VALI||','||IND_ACTI
		  FROM MAE_CLIEN_MODUL
		 WHERE COD_PAIS = #codigoPais#
		   AND TIP_VALI = #tipoValidacion#
    </select>
    	
	<parameterMap id="executeInsercionHistoricoDatosParams" class="clienteHistoricoDatos">										
  	    <parameter property="codigoPais"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>				    	
    	<parameter property="codigoCliente"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="primerApellidoAnterior"   	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="segundoApellidoAnterior"   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="primerNombreAnterior"  	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="segundoNombreAnterior"   	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="fechaNacimientoAnterior"  	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="numeroDocumentoAnterior"   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="telefonoCelularAnterior"  	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="telefonoFijoAnterior"   	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="emailAnterior"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="ubigeoAnterior"   		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="tipoViaAnterior"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="numeroPrincipalAnterior"  	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="barrioAnterior"   		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="direccionAnterior"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="referenciaAnterior"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="regionAnterior"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="zonaAnterior"   		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="seccionAnterior"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="territorioAnterior"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="primerApellido"   			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="segundoApellido"         	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="primerNombre"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="segundoNombre"   		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="fechaNacimiento"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="numeroDocumento"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="telefonoCelular"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="telefonoFijo"   		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="email"  			        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="ubigeo"   		            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="tipoVia"  			        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="numeroPrincipal"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="barrio"   		            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="direccion"   	     	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="referencia"   		        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="region"  			        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="zona"   		            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="seccion"   		        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="territorio"   		        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="indicadorOrigen"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoUsuario"   	        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	
	</parameterMap>
    
  	<procedure id="executeInsercionHistoricoDatos" parameterMap="executeInsercionHistoricoDatosParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_INSER_HISTO_DATOS(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}											
  	</procedure>
  	
  	<select id="getEsEjecutiva" parameterClass="string" resultClass="string">
		SELECT COUNT(1)
	  	  FROM ZON_SECCI
		 WHERE CLIE_OID_CLIE = #value#
    </select>
    
    <parameterMap id="executeActualizacionEjecutivaParams" class="java.util.Map">										
  	    <parameter property="codigoPais"  			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>				    	
    	<parameter property="oidCliente"   			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
    
    <procedure id="executeActualizacionEjecutiva" parameterMap="executeActualizacionEjecutivaParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_ELIMI_DATOS_EJECU(?, ?)}											
    </procedure>
  	
  	<resultMap id="getCodigoRegionySeccionResult"		class="java.util.HashMap">
    	<result property="codigoRegion" 			column="COD_REGI"/>
    	<result property="codigoSeccion" 			column="COD_SECC"/>
  	</resultMap>
  	
    <select id="getCodigoRegionySeccion" parameterClass="java.util.Map" resultMap="getCodigoRegionySeccionResult">
		SELECT reg.COD_REGI, 
		       sec.COD_SECC
		  FROM ZON_REGIO reg,
		       ZON_ZONA zon,
		       ZON_SECCI sec,
		       ZON_TERRI ter,
		       ZON_TERRI_ADMIN adm
		 WHERE reg.OID_REGI = zon.ZORG_OID_REGI
		   AND zon.OID_ZONA = sec.ZZON_OID_ZONA
		   AND ter.OID_TERR = adm.TERR_OID_TERR
		   AND adm.ZSCC_OID_SECC = sec.OID_SECC
		   AND zon.IND_ACTI = 1
		   AND zon.COD_ZONA = #codigoZona#
		   AND adm.IND_BORR = 0
		   AND ter.COD_TERR = #codigoTerritorio#
		   AND adm.PERD_OID_PERI_FINA IS NULL
    </select>
  	
  	<select id="getExisteCliente" parameterClass="java.util.Map" resultClass="string">
		SELECT DISTINCT CLI.COD_CLIE
		  FROM MAE_CLIEN CLI, 
		       MAE_CLIEN_DATOS_ADICI ADI,
		       MAE_CLIEN_IDENT IDE,
		       MAE_TIPO_DOCUM TIP
		 WHERE CLI.OID_CLIE = ADI.CLIE_OID_CLIE
		   AND CLI.OID_CLIE = IDE.CLIE_OID_CLIE
		   AND IDE.TDOC_OID_TIPO_DOCU = TIP.OID_TIPO_DOCU
		 
		 	<isNotEmpty property="codigoCliente">  
			  AND CLI.COD_CLIE = #codigoCliente#
		 	</isNotEmpty>
		 	
		 	<isNotEmpty property="codigoCUB">  
			  AND ADI.COD_CUB = #codigoCUB#
		 	</isNotEmpty>
		 	
		 	<isNotEmpty property="tipoDocumento">  
			  AND TIP.COD_TIPO_DOCU = #tipoDocumento#
		 	</isNotEmpty>
		 	
		 	<isNotEmpty property="numeroDocumento">  
			  AND IDE.NUM_DOCU_IDEN = #numeroDocumento#
		 	</isNotEmpty>
    </select>
    
    <select id="getValidarNumeroDocumentoMod10" parameterClass="string" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_DEVUE_MODUL_DIEZ(#value#)  
		FROM DUAL                                                                     	
   </select>
   
	<parameterMap id="paramExecuteCalcularEstatusCliente" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegion" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoCliente" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>

	<procedure id="executeCalcularEstatusCliente" parameterMap="paramExecuteCalcularEstatusCliente">
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_PROCE_CALCU_ESTAT(?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<select id="getAccesosTiposAreaByPais"  parameterClass="java.lang.String" resultMap="baseResult">
		SELECT 
			cod_area  AS codigo, 
		    des_area_nego AS descripcion
		 FROM MAE_AREA_NEGOC
		 WHERE cod_pais = #value#
		  and  ind_acti = '1'
		 ORDER BY cod_area
	</select>
	
	<select id="getDescripcionTipoBloqueo"  parameterClass="java.util.Map" resultClass="string">
	   SELECT VAL_I18N FROM 
		  GEN_I18N_SICC_COMUN X,
		  MAE_TIPO_BLOQU Y
		WHERE X.ATTR_ENTI = 'MAE_TIPO_BLOQU' 
		 AND Y.OID_TIPO_BLOQ = X.VAL_OID
		 AND Y.COD_TIPO_BLOQ = #tipoBloqueo#
   </select>
   
   <select id="getDevuelveBloqueoDesbloqueoCliente" parameterClass="java.util.Map" resultClass="string">
    	SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_DEVUE_BLOQU_DESBL_CLIEN(#codigoCliente#, #accionBloqueo#, #tipoBloqueo#)  
		FROM DUAL
    </select>
   
   <select id="getPedidosRedifinirVigenciaUA" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1) 
		  FROM sto_detal_docum_excep E, 
		       sto_docum_digit D 
		 WHERE D.COD_PAIS      = E.COD_PAIS AND 
		       D.COD_TIPO_DOCU = E.COD_TIPO_DOCU AND 
		       D.NUM_LOTE      = E.NUM_LOTE AND 
		       D.SEC_NUME_DOCU = E.SEC_NUME_DOCU AND 
		       E.COD_VALI      = 'OCC-3'AND 
		       E.COD_TIPO_DOCU = 'OCC'AND  
		       E.COD_PAIS      = #codigoPais# AND 
		       d.cod_peri      = #codigoPeriodo# AND 
		       d.cod_clie      = #codigoCliente# AND 
		       D.IND_RECH      = '0' AND 
		       D.IND_ENVI      = '0'
    </select>
    
    <parameterMap id="paramExecuteRedifinirVigenciaUA" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="oidCliente" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>

	<procedure id="executeRedifinirVigenciaUA" parameterMap="paramExecuteRedifinirVigenciaUA">
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_REDEF_VIGEN_UNIDA_ADMIN(?, ?, ?, ?) }
	</procedure>
	
	<select id="getVerificarRegionCerradaCampannaActiva" parameterClass="java.util.Map" resultClass="int">
			SELECT COUNT(ZON.COD_REGI)                     
		      from fac_contr_cierr cc,                             
		              FAC_TIPOS_CIERR tc,                          
		              cra_perio cp,                                
		              BAS_CTRL_FACT X,                             
		              seg_perio_corpo a,
		              ZON_REGIO ZON,
		              SEG_PAIS PAIS                         
		       where CC.PAIS_OID_PAIS = PAIS.OID_PAIS
		          AND cc.tcie_oid_tipo_cier = tc.oid_tipo_cier      
		          AND tc.cod_tipo_cier = 'R'                     
		          AND cc.val_resu_proc = 'OK'                      
		          AND X.STA_CAMP = '0'                             
		          AND X.IND_CAMP_ACT = '1'  
		          AND X.FEC_PROC =   CC.FEC_CIER                     
		          AND cc.perd_oid_peri = cp.oid_peri               
		                                                                 
		          AND a.cod_peri = X.COD_PERI                      
		          AND a.oid_peri = CP.peri_oid_peri 
		          
		          AND CC.ZORG_OID_REGI = ZON.OID_REGI 
		          AND PAIS.COD_PAIS = #codigoPais#
		          AND ZON.COD_REGI =  #codigoRegion#
      </select>
      
      <select id="getVerificarZonaCerradaCampannaActiva" parameterClass="java.util.Map" resultClass="int">
			SELECT COUNT(ZON.COD_ZONA)                    
		      from fac_contr_cierr cc,                             
		              FAC_TIPOS_CIERR tc,                          
		              cra_perio cp,                                
		              BAS_CTRL_FACT X,                             
		              seg_perio_corpo a,
		              ZON_ZONA ZON,
		              SEG_PAIS PAIS                         
		       where  CC.PAIS_OID_PAIS = PAIS.OID_PAIS
		          AND cc.tcie_oid_tipo_cier = tc.oid_tipo_cier      
		          AND tc.cod_tipo_cier = 'Z'                     
		          AND cc.val_resu_proc = 'OK'                      
		          AND X.STA_CAMP = '0'                             
		          AND X.IND_CAMP_ACT = '1'  
		          AND X.FEC_PROC =   CC.FEC_CIER                     
		          AND cc.perd_oid_peri = cp.oid_peri               
		                                                                 
		          AND a.cod_peri = X.COD_PERI                      
		          AND a.oid_peri = CP.peri_oid_peri 
		          
		          AND CC.ZZON_OID_ZONA = ZON.OID_ZONA 
		          
		          AND PAIS.COD_PAIS = #codigoPais#
		          AND ZON.COD_ZONA = #codigoZona#
      </select>
	
      <resultMap id="getConsultarClienteWSResult"   class="java.util.HashMap">
	    <result property="codigo" 							  column="codigo"/>
		<result property="apellido1" 						  column="apellido1"/>
		<result property="apellido2" 						  column="apellido2"/>
		<result property="nombre1" 							  column="nombre1"/>
		<result property="nombre2" 							  column="nombre2"/>
		<result property="sexo" 							  column="sexo"/>
		<result property="fecIngreso" 						  column="fecIngreso"/>
		<result property="indicadorActiva" 					  column="indicadorActiva"/>
		<result property="tipoCliente" 						  column="tipoCliente"/>
		<result property="subtipoCliente" 					  column="subtipoCliente"/>
		<result property="fecNac" 							  column="fecNac"/>
		<result property="codGrupoFuncional" 				  column="codGrupoFuncional"/>
		<result property="descGrupoFuncional" 				  column="descGrupoFuncional"/>
		<result property="codEmple" 						  column="codEmple"/>
		<result property="codCUB" 							  column="codCUB"/>
		<result property="codCUBJefe" 						  column="codCUBJefe"/>
		<result property="usuRed" 							  column="usuRed"/>
		<result property="nrodoc" 							  column="nrodoc"/>
		<result property="regi" 					  	  	  column="regi"/>
		<result property="zona"			  	  				  column="zona"/>
		<result property="codZT"						      column="codZT"/>
		<result property="mailBelc"						      column="mailBelc"/>
  </resultMap>
  
  <select id="getConsultarClienteWS" parameterClass="java.util.Map" resultMap="getConsultarClienteWSResult">
	  SELECT codigo, apellido1, apellido2,  nombre1, nombre2, sexo, fecIngreso, indicadorActiva, 
	         tipoCliente, subtipoCliente,  fecNac, codGrupoFuncional, descGrupoFuncional, 
	         codEmple, codCUB, codCUBJefe, usuRed, nrodoc, regi, zona, codZT, mailBelc
		      FROM(
		        SELECT DISTINCT c.cod_clie codigo,
		         				c.val_ape1 apellido1,
		                        c.val_ape2 apellido2,
		                        c.val_nom1 nombre1,
		                        c.val_nom2 nombre2,
		                        c.cod_sexo sexo,
		                        c.fec_ingr fecIngreso,
		                        decode(da.ind_acti, 0, 'NO', 'SI') indicadorActiva,
		                        ts.ticl_oid_tipo_clie tipoCliente,
		                        ts.sbti_oid_subt_clie subtipoCliente,
		                        da.fec_naci fecNac,
		                        da.cod_grup_func codGrupoFuncional,
		                        da.des_grup_func descGrupoFuncional,
		                        da.cod_empl codEmple,
		                        da.cod_cub codCUB,
		                        da.cod_cub_jefe codCUBJefe,
		                        da.val_usua_red usuRed,
		                        i.num_docu_iden nrodoc,
		                        zr.des_regi regi,
		                        zz.des_zona zona,
		                        zt.cod_terr codZT,
		                        GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(c.COD_CLIE),'MB') mailBelc
	                                
			        FROM MAE_CLIEN c,
			         MAE_CLIEN_IDENT i ,
			         MAE_CLIEN_DATOS_ADICI da,
			         MAE_CLIEN_TIPO_SUBTI ts,
			         MAE_CLIEN_UNIDA_ADMIN ua,
			         ZON_TERRI_ADMIN zta,
			         ZON_TERRI zt,
			         ZON_ZONA  zz,
			         ZON_SECCI zs,
			         ZON_REGIO zr
			       WHERE c.PAIS_OID_PAIS = #oidPais#
			        AND i.CLIE_OID_CLIE = c.OID_CLIE
			        AND da.CLIE_OID_CLIE = c.OID_CLIE
			        AND ts.CLIE_OID_CLIE = c.OID_CLIE
			        AND ua.IND_ACTI='1'    
			        AND i.VAL_IDEN_DOCU_PRIN=1
			        AND ua.CLIE_OID_CLIE = c.OID_CLIE
			        AND ua.ZTAD_OID_TERR_ADMI =zta.OID_TERR_ADMI
			        AND zta.PAIS_OID_PAIS=c.PAIS_OID_PAIS
			        AND zs.OID_SECC = zta.ZSCC_OID_SECC
			        AND zt.OID_TERR = zta.TERR_OID_TERR
			        AND zt.PAIS_OID_PAIS =c.PAIS_OID_PAIS
			        AND zz.OID_ZONA = zs.ZZON_OID_ZONA
			        AND zz.zorg_oid_regi = zr.oid_regi
			        <isNotEmpty prepend="AND" property="codigoCliente">        
						c.cod_clie LIKE #codigoCliente#
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="codigoCUB">        
						da.cod_cub LIKE #codigoCUB#
					</isNotEmpty>
					<isNotEmpty prepend="AND" property="numeroDocumento">        
						i.num_docu_iden = #numeroDocumento#
					</isNotEmpty>
					<!-- <isNotEmpty prepend="AND" property="usuarioRed">        
						da.val_usua_red LIKE #usuarioRed#
					</isNotEmpty>
					
					<isNotEmpty prepend="AND" property="tipoDocumento">        
					</isNotEmpty>
					 -->
					
			        )
	
  </select>

	<select id="getValidarRegularizacion" parameterClass="java.util.Map" resultClass="int">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_VALID_REGUL_CLIEN(#codigoCliente#, #codigoUsuario#) FROM DUAL
	</select>
	
    <parameterMap id="updateRegularizacionParams" class="map" >
		<parameter property="codigoCliente"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="oidBloqueo"			jdbcType="NUMERIC" javaType="java.lang.Integer" mode="IN"/>
		<parameter property="codigoRetorno"       	jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>	    
    </parameterMap>
    <procedure id="updateRegularizacion" parameterMap="updateRegularizacionParams">
    	{call MAE_PKG_PROCE_CLIEN.MAE_PR_ACTUA_REGUL_CLIEN(?,?,?)}
    </procedure>
    
	<select id="getValidacionNumeroRucModulo11" parameterClass="java.lang.String" resultClass="int">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_VALID_NUMER_RUC_MOD11(#value#) FROM DUAL
	</select>
	
	<select id="getValidarNumeroCarnetIdentidad" parameterClass="java.lang.String" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_VALID_CARNE_IDENT(#value#) FROM DUAL
	</select>
	  
	<select id="getDocumentosConsultora" parameterClass="java.util.Map" resultMap="baseResult">
		
		SELECT 
		    t.cod_tipo_docu CODIGO, 
		    t.val_sigl DESCRIPCION
		  FROM mae_clien_ident i, mae_clien c, MAE_TIPO_DOCUM t
		 WHERE     c.oid_clie = i.clie_oid_clie
		       AND c.cod_clie = #codigoConsultora#
		       AND I.VAL_IDEN_DOCU_PRIN = 1
		       AND t.oid_tipo_docu = i.tdoc_oid_tipo_docu
		<isNotEmpty property="siglasDocumento">	
			<iterate prepend="AND" property="siglasDocumento" open="(" close=")" conjunction="OR">
      	 		t.val_sigl = #siglasDocumento[]#
            </iterate> 		
		</isNotEmpty>	
       		
	</select>	
    
	<select id="getDigitoControlModuloPTR" parameterClass="string" resultClass="string">
		SELECT MAE_PKG_PROCE_CLIEN.MAE_FN_VALID_MODUL_PTR(#value#)
 		  FROM DUAL
   </select>

	<select id="getPeriodosRetiradas" parameterClass="string" resultClass="string">
		SELECT NUM_PERI_RETI
		  FROM SEG_PAIS
		 WHERE COD_PAIS = #value#
   </select>
   
   <update id="updatePeriodosRetiradas" parameterClass="java.util.Map">
		UPDATE SEG_PAIS
		   SET NUM_PERI_RETI = #numeroPeriodos#
		 WHERE COD_PAIS = #codigoPais# 
   </update>
       
   	<select id="getExcencionesFletesByCriteria" parameterClass="java.util.Map" resultMap="excencionesFletesResultMap">
		SELECT 
		EF.OID_EXEN_FLET,
		PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, EF.TICL_OID_TIPO_CLIE, 'MAE_TIPO_CLIEN')  DES_TICL,
		PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, EF.SBTI_OID_SUBT_CLIE, 'MAE_SUBTI_CLIEN') DES_STCL,
		PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, EF.TCCL_OID_TIPO_CLAS, 'MAE_TIPO_CLASI_CLIEN') DES_TICS,
		PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, EF.CLAS_OID_CLAS, 'MAE_CLASI') DES_CLAS,
		DECODE(IND_EXEN_FLET, '1', 'Activo', '0', 'Inactivo', '') DES_ESTA
		FROM MAE_EXENC_FLETE EF
		WHERE EF.PAIS_OID_PAIS = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#)
		
		<isEqual property="tipoBusqueda" compareValue="1">
		<isNotEmpty property="oidTipoCliente">
			AND EF.TICL_OID_TIPO_CLIE = #oidTipoCliente#
		</isNotEmpty>		
		<isNotEmpty property="oidSubTipoCliente">
			AND EF.SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#
		</isNotEmpty>		
		<isNotEmpty property="oidTipoClasificacion">
			AND EF.TCCL_OID_TIPO_CLAS = #oidTipoClasificacion#
		</isNotEmpty>		
		<isNotEmpty property="oidClasificacion">
			AND EF.CLAS_OID_CLAS = #oidClasificacion#
		</isNotEmpty>		
		</isEqual>
		
		<isEqual property="tipoBusqueda" compareValue="2">
			<isNotEmpty property="oidTipoCliente">
				AND EF.TICL_OID_TIPO_CLIE = #oidTipoCliente#
			</isNotEmpty>
			<isEmpty property="oidTipoCliente">
				AND EF.TICL_OID_TIPO_CLIE IS NULL
			</isEmpty>
					
			<isNotEmpty property="oidSubTipoCliente">
				AND EF.SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#
			</isNotEmpty>
			<isEmpty property="oidSubTipoCliente">
				AND EF.SBTI_OID_SUBT_CLIE IS NULL
			</isEmpty>
					
			<isNotEmpty property="oidTipoClasificacion">
				AND EF.TCCL_OID_TIPO_CLAS = #oidTipoClasificacion#
			</isNotEmpty>		
			<isEmpty property="oidTipoClasificacion">
				AND EF.TCCL_OID_TIPO_CLAS IS NULL
			</isEmpty>		
			
			<isNotEmpty property="oidClasificacion">
				AND EF.CLAS_OID_CLAS = #oidClasificacion#
			</isNotEmpty>		
			<isEmpty property="oidClasificacion">
				AND EF.CLAS_OID_CLAS IS NULL
			</isEmpty>		
		</isEqual>
		
		<isNotEmpty property="indicadorExcepcionFlete">
			AND EF.IND_EXEN_FLET = #indicadorExcepcionFlete#
		</isNotEmpty>
		
		ORDER BY EF.OID_EXEN_FLET		
   	</select>
   	
   	<select id="getExcencionFlete" parameterClass="string" resultMap="excencionFleteResultMap">   	
		SELECT 
			OID_EXEN_FLET,
			PAIS_OID_PAIS,
		    CLAS_OID_CLAS,
		    IND_EXEN_FLET,
		    SBTI_OID_SUBT_CLIE,
		    TICL_OID_TIPO_CLIE,
		    TCCL_OID_TIPO_CLAS,
		    USU_CREA,
		    FEC_CREA,
		    USU_MODI,
		    FEC_MODI
		FROM MAE_EXENC_FLETE
		WHERE OID_EXEN_FLET = #value#     	
   	</select>
   	
   	<insert id="insertExcencionFlete" parameterClass="excencionFlete">
   		INSERT INTO MAE_EXENC_FLETE(
			OID_EXEN_FLET,
			PAIS_OID_PAIS,
		    CLAS_OID_CLAS,
		    IND_EXEN_FLET,
		    SBTI_OID_SUBT_CLIE,
		    TICL_OID_TIPO_CLIE,
		    TCCL_OID_TIPO_CLAS,
		    USU_CREA,
		    FEC_CREA)
   		VALUES(
			MAE_EXFL_SEQ.NEXTVAL,
			#oidPais#,
			#oidClasificacion#,
			#indicadorExcepcionFlete#,
			#oidSubTipoCliente#,
			#oidTipoCliente#,
			#oidTipoClasificacion#,
			#auditInfo.createdBy#,
			#auditInfo.created#)
   	</insert>
   	
   	<update id="updateExcencionFlete" parameterClass="excencionFlete">
   		UPDATE MAE_EXENC_FLETE
   		SET
		CLAS_OID_CLAS = #oidClasificacion#,
		IND_EXEN_FLET = #indicadorExcepcionFlete#,
		SBTI_OID_SUBT_CLIE = #oidSubTipoCliente#,
		TICL_OID_TIPO_CLIE = #oidTipoCliente#,
		TCCL_OID_TIPO_CLAS = #oidTipoClasificacion#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#
   		WHERE OID_EXEN_FLET = #oidExcencion#
   		AND PAIS_OID_PAIS = #oidPais#
   	</update>
       
   	<select id="getExcencionesSobreFletesByCriteria" parameterClass="java.util.Map" resultMap="excencionesSobreFletesResultMap">
		SELECT COR_EXEN_SFLE,
        PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,  (SELECT TC.OID_TIPO_CLIE 
                                            FROM MAE_TIPO_CLIEN TC 
                                            WHERE 
                                            TC.COD_TIPO_CLIE=ESF.COD_TIPO_CLIE), 
                                            'MAE_TIPO_CLIEN')  DES_TICL,
        PQ_APL_AUX.VALOR_GEN_I18N_SICC(1,  (SELECT 
                                               STC.OID_SUBT_CLIE
                                            FROM 
                                            MAE_TIPO_CLIEN TC,
                                            MAE_SUBTI_CLIEN STC 
                                            WHERE 
                                            TC.COD_TIPO_CLIE = ESF.COD_TIPO_CLIE AND
                                            TC.OID_TIPO_CLIE = STC.TICL_OID_TIPO_CLIE AND
                                            STC.COD_SUBT_CLIE = ESF.COD_SUBT_CLIE),
                                            'MAE_SUBTI_CLIEN') DES_STCL,
        PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, (SELECT 
                                               TCC.OID_TIPO_CLAS
                                            FROM 
                                            MAE_TIPO_CLIEN TC,
                                            MAE_SUBTI_CLIEN STC, 
                                            MAE_TIPO_CLASI_CLIEN TCC
                                            WHERE 
                                            TC.COD_TIPO_CLIE = ESF.COD_TIPO_CLIE AND
                                            TC.OID_TIPO_CLIE = STC.TICL_OID_TIPO_CLIE AND
                                            STC.COD_SUBT_CLIE = ESF.COD_SUBT_CLIE AND
                                            STC.OID_SUBT_CLIE = TCC.SBTI_OID_SUBT_CLIE AND
                                            TCC.COD_TIPO_CLAS = ESF.COD_TIPO_CLAS ), 
                                            'MAE_TIPO_CLASI_CLIEN') DES_TICS,
        PQ_APL_AUX.VALOR_GEN_I18N_SICC(1, (SELECT 
                                               C.OID_CLAS
                                            FROM 
                                            MAE_TIPO_CLIEN TC,
                                            MAE_SUBTI_CLIEN STC, 
                                            MAE_TIPO_CLASI_CLIEN TCC,
                                            MAE_CLASI C
                                            WHERE 
                                            TC.COD_TIPO_CLIE = ESF.COD_TIPO_CLIE AND
                                            TC.OID_TIPO_CLIE = STC.TICL_OID_TIPO_CLIE AND
                                            STC.COD_SUBT_CLIE = ESF.COD_SUBT_CLIE AND
                                            STC.OID_SUBT_CLIE = TCC.SBTI_OID_SUBT_CLIE AND
                                            TCC.COD_TIPO_CLAS = ESF.COD_TIPO_CLAS AND
                                            TCC.OID_TIPO_CLAS = C.TCCL_OID_TIPO_CLAS AND
                                            C.COD_CLAS = ESF.COD_CLAS ), 
                                            'MAE_CLASI') DES_CLAS,
        DECODE(IND_ACTI, '1', 'Activo', '0', 'Inactivo', '') DES_ESTA
        FROM 
        MAE_EXENC_SOBRE_FLETE ESF
		WHERE ESF.PAIS_COD_PAIS = #codPais#
		
		<isEqual property="tipoBusqueda" compareValue="1">
			<isNotEmpty property="codTipoCliente">
				AND ESF.COD_TIPO_CLIE = #codTipoCliente#
			</isNotEmpty>		
			<isNotEmpty property="codSubTipoCliente">
				AND ESF.COD_SUBT_CLIE = #codSubTipoCliente#
			</isNotEmpty>		
			<isNotEmpty property="codTipoClasificacion">
				AND ESF.COD_TIPO_CLAS =  #codTipoClasificacion#
			</isNotEmpty>		
			<isNotEmpty property="codClasificacion">
				AND ESF.COD_CLAS = #codClasificacion#
			</isNotEmpty>		
		</isEqual>
		
		<isEqual property="tipoBusqueda" compareValue="2">
			<isNotEmpty property="codTipoCliente">
				AND ESF.COD_TIPO_CLIE = #codTipoCliente#
			</isNotEmpty>
			<isEmpty property="codTipoCliente">
				AND ESF.COD_TIPO_CLIE IS NULL
			</isEmpty>
					
			<isNotEmpty property="codSubTipoCliente">
				AND ESF.COD_SUBT_CLIE = #codSubTipoCliente#
			</isNotEmpty>
			<isEmpty property="codSubTipoCliente">
				AND ESF.COD_SUBT_CLIE IS NULL
			</isEmpty>
					
			<isNotEmpty property="codTipoClasificacion">
				AND ESF.COD_TIPO_CLAS = #codTipoClasificacion#
			</isNotEmpty>		
			<isEmpty property="codTipoClasificacion">
				AND ESF.COD_TIPO_CLAS IS NULL
			</isEmpty>		
			
			<isNotEmpty property="codClasificacion">
				AND ESF.COD_CLAS = #codClasificacion#
			</isNotEmpty>		
			<isEmpty property="codClasificacion">
				AND ESF.COD_CLAS IS NULL
			</isEmpty>		
		</isEqual>
		
		<isNotEmpty property="indicadorExcepcionFlete">
			AND ESF.IND_ACTI = #indicadorExcepcionFlete#
		</isNotEmpty>
		
		ORDER BY ESF.COR_EXEN_SFLE	
   	</select>
   	
   	
   	
   	
   	<select id="getExcencionSobreFlete" parameterClass="string" resultMap="excencionSobreFleteResultMap">   	
		SELECT 

			ESF.COR_EXEN_SFLE,
			ESF.COD_CLAS,
			ESF.IND_ACTI,
			ESF.COD_SUBT_CLIE,
			ESF.COD_TIPO_CLIE,
			ESF.COD_TIPO_CLAS,
			USU_CREA,
		    FEC_CREA,
		    USU_MODI,
		    FEC_MODI	    
		    
		FROM MAE_EXENC_SOBRE_FLETE ESF
        WHERE COR_EXEN_SFLE = #value# 
         
   	</select>
   	
   	
   
   	
   	<insert id="insertExcencionSobreFlete" parameterClass="excencionSobreFlete">
   		INSERT INTO MAE_EXENC_SOBRE_FLETE(
   			COR_EXEN_SFLE,
			PAIS_COD_PAIS,
		    COD_CLAS,
		    IND_ACTI,
		    COD_SUBT_CLIE,
		    COD_TIPO_CLIE,
		    COD_TIPO_CLAS,
		    USU_CREA,
		    FEC_CREA)
   		VALUES(
   			(SELECT (NVL(MAX(COR_EXEN_SFLE),0)+1) FROM MAE_EXENC_SOBRE_FLETE),
			#codPais#,
			#codClasificacion#,
			#indicadorExcepcionFlete#,
			#codSubTipoCliente#,
			#codTipoCliente#,
			#codTipoClasificacion#,
			#auditInfo.createdBy#,
			sysdate)
   	</insert>
   	
   	<update id="updateExcencionSobreFlete" parameterClass="excencionSobreFlete">
   		UPDATE MAE_EXENC_SOBRE_FLETE
   		SET
		COD_CLAS = #codClasificacion#,
		IND_ACTI = #indicadorExcepcionFlete#,
		COD_SUBT_CLIE = #codSubTipoCliente#,
		COD_TIPO_CLIE = #codTipoCliente#,
		COD_TIPO_CLAS = #codTipoClasificacion#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = sysdate
   		WHERE COR_EXEN_SFLE = #codExenSfle#
   		AND PAIS_COD_PAIS = #codPais#
        
   	</update>
   	<select id="getPalabrasCompuestasList" parameterClass="java.util.Map" resultMap="baseResult">
     select cod_comp as CODIGO, 
     		des_comp as DESCRIPCION 
       from mae_palab_compu
    </select>
   	
    <select id="getPalabrasAltisonantesList" parameterClass="java.util.Map" resultMap="baseResult">
     select cod_alti as CODIGO, 
     		des_alti as DESCRIPCION 
       from mae_palab_altis
    </select>
       
   	<select id="getEntidades" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT 
		COD_ENTI_GENE CODIGO, 
		DES_ENTI_GENE DESCRIPCION
		FROM BAS_ENTID_GENER
		WHERE PAIS_COD_PAIS = #codigoPais# 
		AND SIST_COD_SIST= #codigoInterfaz#
		AND IND_ACTI = '1'
		ORDER BY DES_ENTI_GENE   	
   	</select>
   	
	<resultMap id="tipoBloqueoResultMap" class="java.util.HashMap">
    	<result property="oid"							column="OID_TIPO_BLOQ" 	/>
    	<result property="codigo" 						column="COD_TIPO_BLOQ"/>
    	<result property="descripcion" 					column="DES_TIPO_BLOQ"/>
    	<result property="indicadorBloqueoFinanciero" 	column="IND_BLOQ_FINA"/>
    	<result property="formaBloqueo" 				column="DES_VALO_BLOQ"/>
    	<result property="formaDesbloqueo" 				column="DES_VALO_DESB"/>
    	<result property="nivelGravedad" 				column="NUM_NIVE_GRAV_BLOQ"/>
    	<result property="motivoRechazo" 				column="DES_MOTI_RECH"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>      	
   	<select id="getTipoBloqueoByCriteria" parameterClass="map" resultMap="tipoBloqueoResultMap">   	
		SELECT
		MTB.OID_TIPO_BLOQ, 
		MTB.COD_TIPO_BLOQ,
		GEN.VAL_I18N DES_TIPO_BLOQ,
		DECODE(MTB.IND_BLOQ_FINA, '1', 'SI', 'NO') IND_BLOQ_FINA,
		VAB.DES_VALO_BLOQ DES_VALO_BLOQ,
		VAD.DES_VALO_BLOQ DES_VALO_DESB,
		MTB.NUM_NIVE_GRAV_BLOQ,
		MOR.DES_MOTI_RECH,
		DECODE(MTB.IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI
		FROM  
		    GEN_I18N_SICC_COMUN GEN, 
		    SEG_IDIOM IDI, 
		    MAE_TIPO_BLOQU MTB, 
		    MAE_VALOR_ACCIO_BLOQU VAB, 
		    MAE_VALOR_ACCIO_BLOQU VAD,
		    STO_MOTIV_RECHA MOR
		WHERE MTB.OID_TIPO_BLOQ = GEN.VAL_OID
		AND MTB.MAAB_OID_VALO_ACCI_BLOQ = VAB.OID_VALO_ACCI_BLOQ(+)
		AND MTB.MAAB_OID_VALO_ACCI_DESB = VAD.OID_VALO_ACCI_BLOQ(+)
		AND MTB.STMR_OID_MOTI_RECH = MOR.OID_MOTI_RECH(+)
		AND GEN.ATTR_ENTI = 'MAE_TIPO_BLOQU'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		/*AND MTB.IND_ACTI = '1'*/
		AND IDI.COD_ISO_IDIO = #codigoIdioma#		
		
		<isNotEmpty property="codigo">
			AND MTB.COD_TIPO_BLOQ = #codigo#
		</isNotEmpty>
		
		<isNotEmpty property="descripcion">
			AND UPPER(GEN.VAL_I18N) LIKE '%'||UPPER(#descripcion#)||'%'
		</isNotEmpty>
		
   	</select>
   	
   	<select id="getMotivosRechazo" resultMap="baseResult">
		SELECT
		OID_MOTI_RECH CODIGO,
		DES_MOTI_RECH DESCRIPCION
		FROM STO_MOTIV_RECHA
		ORDER BY DES_MOTI_RECH   	
   	</select>
   	
   	<select id="getFormasBloqueo" resultMap="baseResult">
		SELECT
		OID_VALO_ACCI_BLOQ CODIGO,
		DES_VALO_BLOQ DESCRIPCION
		FROM MAE_VALOR_ACCIO_BLOQU
		ORDER BY DES_VALO_BLOQ   	
   	</select>
   	
   	<select id="getOidTipoBloqueo" resultClass="string">
   		SELECT MAE_TIBQ_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
	<insert id="insertDescripcion" parameterClass="java.util.Map">
		INSERT INTO gen_i18n_sicc_comun (
   			oid_i18n,
   			attr_enti,
   			attr_num_atri,
   			idio_oid_idio,
   			val_i18n,
   			val_oid
		)
		VALUES(
   			gen_i18n_seq.nextval,
   			#nombreTabla#,
   			#numAtributo#,
   			#oidIdioma#,
   			#valAtributo#,
   			#valOidAtributo#)
	</insert>

   	<insert id="updateDescripcion" parameterClass="java.util.Map">
		UPDATE gen_i18n_sicc_comun
		SET
			val_i18n = #valAtributo#
		WHERE attr_enti = #nombreTabla# 
   		AND attr_num_atri = #numAtributo# 
   		AND idio_oid_idio = #oidIdioma#    			
   		AND val_oid = #valOidAtributo# 
	</insert>
   	
   	<insert id="insertTipoBloqueo" parameterClass="tipoBloqueo">
		INSERT INTO MAE_TIPO_BLOQU(
		    OID_TIPO_BLOQ, 
		    COD_TIPO_BLOQ, 
		    IND_BLOQ_FINA, 
		    NUM_NIVE_GRAV_BLOQ, 
		    STMR_OID_MOTI_RECH, 
		    MAAB_OID_VALO_ACCI_BLOQ, 
		    MAAB_OID_VALO_ACCI_DESB,
		    IND_ACTI,
		    USU_CREA,
		    FEC_CREA)
		VALUES(
		    #oid#,
		    #codigo#,
		    #indicadorBloqueoFinanciero#,
		    #nivelGravedad#,
		    #oidMotivoRechazo#,
		    #oidFormaBloqueo#,
		    #oidFormaDesbloqueo#,
		    #indicadorEstado#,
		    #auditInfo.createdBy#,
		    #auditInfo.created#)
   	</insert>
   	
   	<update id="updateTipoBloqueo" parameterClass="tipoBloqueo">   	
		UPDATE MAE_TIPO_BLOQU
		SET             
		    COD_TIPO_BLOQ = #codigo#, 
		    IND_BLOQ_FINA = #indicadorBloqueoFinanciero#, 
		    NUM_NIVE_GRAV_BLOQ = #nivelGravedad#, 
		    STMR_OID_MOTI_RECH = #oidMotivoRechazo#, 
		    MAAB_OID_VALO_ACCI_BLOQ = #oidFormaBloqueo#, 
		    MAAB_OID_VALO_ACCI_DESB = #oidFormaDesbloqueo#,
		    IND_ACTI = #indicadorEstado#,
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated# 
		WHERE OID_TIPO_BLOQ = #oid#   	
   	</update>

    <resultMap id="tipoBloqueoResult" class="tipoBloqueo">
		<result property="oid" 							column="OID_TIPO_BLOQ"/>
    	<result property="codigo" 						column="COD_TIPO_BLOQ"/>
    	<result property="descripcion" 					column="DES_TIPO_BLOQ"/>
    	<result property="indicadorBloqueoFinanciero" 	column="IND_BLOQ_FINA"/>
    	<result property="nivelGravedad" 				column="NUM_NIVE_GRAV_BLOQ"/>
    	<result property="oidMotivoRechazo" 			column="STMR_OID_MOTI_RECH"/>
    	<result property="oidFormaBloqueo" 				column="MAAB_OID_VALO_ACCI_BLOQ"/>
    	<result property="oidFormaDesbloqueo" 			column="MAAB_OID_VALO_ACCI_DESB"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>     	
   	<select id="getTipoBloqueo" parameterClass="map" resultMap="tipoBloqueoResult">
		SELECT
		    MTB.OID_TIPO_BLOQ, 
		    MTB.COD_TIPO_BLOQ, 
		    GEN.VAL_I18N DES_TIPO_BLOQ,
		    MTB.IND_BLOQ_FINA, 
		    MTB.NUM_NIVE_GRAV_BLOQ, 
		    MTB.STMR_OID_MOTI_RECH, 
		    MTB.MAAB_OID_VALO_ACCI_BLOQ, 
		    MTB.MAAB_OID_VALO_ACCI_DESB,
		    MTB.IND_ACTI
		FROM  GEN_I18N_SICC_COMUN GEN,  SEG_IDIOM IDI,  MAE_TIPO_BLOQU MTB 
		WHERE MTB.OID_TIPO_BLOQ = GEN.VAL_OID
		AND GEN.ATTR_ENTI = 'MAE_TIPO_BLOQU'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		AND IDI.COD_ISO_IDIO = #codigoIdioma#
		AND MTB.OID_TIPO_BLOQ = #oid#        
   	</select>
       
   	<select id="getBloqueoClientePreFacturacion" parameterClass="map" resultClass="string">
   		SELECT COUNT(1)
		  FROM BAS_PARAM_PAIS
		 WHERE COD_PAIS = #codigoPais#
		   AND COD_SIST = #codigoSistema#
		   AND NOM_PARA = #nombreParametro#
		   AND VAL_PARA = '1'
		   AND IND_ACTI = '1'
   	</select>  
   	
   	<select id="getClientePedido" parameterClass="map" resultClass="string">
   		SELECT count(*)
		  FROM PED_SOLIC_CABEC PSC, MAE_CLIEN MC
		 WHERE PSC.CLIE_OID_CLIE = MC.OID_CLIE
		   AND MC.COD_CLIE = #codigoCliente#
		   AND PSC.TSPA_OID_TIPO_SOLI_PAIS = fin_pkg_gener.fin_fn_obtie_oid_solic_pais('SOC')
		   AND PSC.GRPR_OID_GRUP_PROC IN (1, 2, 3)
		   AND PSC.PERD_OID_PERI = OCR_SOLIC_PEDIDOS.GEN_FN_DEVUELVE_OID_CRA_PERIO(#codigoPeriodo#)
		   AND PSC.FEC_FACT IS NULL
   	</select>
   	
   	<resultMap id="tipoClienteResultMap" class="java.util.HashMap">
    	<result property="oid"							column="OID_TIPO_CLIE" 	/>
    	<result property="codigo" 						column="COD_TIPO_CLIE"/>
    	<result property="descripcion" 					column="DES_TIPO_CLIE"/>
    	<result property="indicadorEvaluarStatus" 		column="IND_EVAL_ESTA"/>
    	<result property="indicadorEmpleado" 			column="IND_EMPL"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>      	
   	<select id="getTipoClienteByCriteria" parameterClass="map" resultMap="tipoClienteResultMap">   	
		SELECT
		MTC.OID_TIPO_CLIE, 
		MTC.COD_TIPO_CLIE,
		GEN.VAL_I18N DES_TIPO_CLIE,
		DECODE(MTC.IND_EVAL_ESTA, '1', 'SI', 'NO') IND_EVAL_ESTA,
		DECODE(MTC.IND_EMPL, '1', 'SI', 'NO') IND_EMPL,
		DECODE(MTC.IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI
		FROM  
		    GEN_I18N_SICC_COMUN GEN, 
		    SEG_IDIOM IDI, 
		    MAE_TIPO_CLIEN MTC 
		WHERE MTC.OID_TIPO_CLIE = GEN.VAL_OID
		AND GEN.ATTR_ENTI = 'MAE_TIPO_CLIEN'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		/*AND MTC.IND_ACTI = '1'*/
		AND IDI.COD_ISO_IDIO = #codigoIdioma#		
		
		<isNotEmpty property="codigoTipoCliente">
			AND MTC.COD_TIPO_CLIE = #codigoTipoCliente#
		</isNotEmpty>
		
		<isNotEmpty property="descripcionTipoCliente">
			AND UPPER(GEN.VAL_I18N) LIKE '%'||UPPER(#descripcionTipoCliente#)||'%'
		</isNotEmpty>
		
		<isNotEmpty property="indicadorEvaluarEstatus">
			AND MTC.IND_EVAL_ESTA = #indicadorEvaluarEstatus#
		</isNotEmpty>
		
		<isNotEmpty property="indicadorEmpleado">
			AND MTC.IND_EMPL = #indicadorEmpleado#
		</isNotEmpty>
		
   	</select>
    
    <insert id="insertTipoCliente" parameterClass="tipoCliente">
		INSERT INTO MAE_TIPO_CLIEN(
		    OID_TIPO_CLIE, 
		    COD_TIPO_CLIE, 
		    IND_EVAL_ESTA, 
		    IND_EMPL,
		    IND_ACTI,
		    USU_CREA,
		    FEC_CREA)
		VALUES(
		    #oid#,
		    #codigo#,
		    #indicadorEvaluarStatus#,
		    #indicadorEmpleado#,
		    #indicadorEstado#,
		    #auditInfo.createdBy#,
		    #auditInfo.created#)
   	</insert>
   	
   	<update id="updateTipoCliente" parameterClass="tipoCliente">   	
		UPDATE MAE_TIPO_CLIEN
		SET             
		    COD_TIPO_CLIE = #codigo#, 
		    IND_EVAL_ESTA = #indicadorEvaluarStatus#,
		    IND_EMPL = #indicadorEmpleado#,
		    IND_ACTI = #indicadorEstado#,
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated# 
		WHERE OID_TIPO_CLIE = #oid#   	
   	</update>

    <resultMap id="tipoClienteResult" class="tipoCliente">
		<result property="oid" 							column="OID_TIPO_CLIE"/>
    	<result property="codigo" 						column="COD_TIPO_CLIE"/>
    	<result property="descripcion" 					column="DES_TIPO_CLIE"/>
    	<result property="indicadorEvaluarStatus" 		column="IND_EVAL_ESTA"/>
    	<result property="indicadorEmpleado" 			column="IND_EMPL"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>     	
   	<select id="getTipoCliente" parameterClass="map" resultMap="tipoClienteResult">
		SELECT
		    MTC.OID_TIPO_CLIE, 
		    MTC.COD_TIPO_CLIE, 
		    GEN.VAL_I18N DES_TIPO_CLIE,
		    MTC.IND_EVAL_ESTA, 
		    MTC.IND_EMPL,
		    MTC.IND_ACTI
		FROM  GEN_I18N_SICC_COMUN GEN,  SEG_IDIOM IDI,  MAE_TIPO_CLIEN MTC 
		WHERE MTC.OID_TIPO_CLIE = GEN.VAL_OID
		AND GEN.ATTR_ENTI = 'MAE_TIPO_CLIEN'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		AND IDI.COD_ISO_IDIO = #codigoIdioma#
		AND MTC.OID_TIPO_CLIE = #oid#        
   	</select>   
   	
   	<select id="getOidTipoClienteSeq" resultClass="string">
   		SELECT MAE_TICL_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<select id="getOidSubtipoClienteSeq" resultClass="string">
   		SELECT MAE_SBTI_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<select id="getOidEstatusCliente" resultClass="string">
   		SELECT MAE_ESTA_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	    <resultMap id="subtipoClienteResultMap" class="java.util.HashMap">
    	<result property="oid"							column="OID_SUBT_CLIE" 	/>
    	<result property="codigo" 						column="COD_SUBT_CLIE"/>
    	<result property="descripcion" 					column="DES_SUBT_CLIE"/>
    	<result property="oidTipoCliente" 				column="TICL_OID_TIPO_CLIE"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>      	
   	<select id="getSubtipoClienteByCriteria" parameterClass="map" resultMap="subtipoClienteResultMap">   	
		SELECT
		MSC.OID_SUBT_CLIE, 
		MSC.COD_SUBT_CLIE,
		GEN.VAL_I18N DES_SUBT_CLIE,
	   (SELECT GEN.VAL_I18N DESCRIPCION
	      FROM GEN_I18N_SICC_COMUN GEN, SEG_IDIOM IDI, MAE_TIPO_CLIEN MEC
	     WHERE MEC.OID_TIPO_CLIE = GEN.VAL_OID
	       AND GEN.ATTR_ENTI = 'MAE_TIPO_CLIEN'
	       AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
			   AND IDI.COD_ISO_IDIO = #codigoIdioma#
	       AND MEC.OID_TIPO_CLIE = MSC.TICL_OID_TIPO_CLIE) TICL_OID_TIPO_CLIE,
		DECODE(MSC.IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI
		FROM  
		    GEN_I18N_SICC_COMUN GEN, 
		    SEG_IDIOM IDI, 
		    MAE_SUBTI_CLIEN MSC 
		WHERE MSC.OID_SUBT_CLIE = GEN.VAL_OID
		AND GEN.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		/*AND MSC.IND_ACTI = '1'*/
		AND IDI.COD_ISO_IDIO = #codigoIdioma#		
		
		<isNotEmpty property="codigoSubtipoCliente">
			AND MSC.COD_SUBT_CLIE = #codigoSubtipoCliente#
		</isNotEmpty>
		
		<isNotEmpty property="descripcionSubtipoCliente">
			AND UPPER(GEN.VAL_I18N) LIKE '%'||UPPER(#descripcionSubtipoCliente#)||'%'
		</isNotEmpty>
		
		<isNotEmpty property="oidTipoCliente">
			AND MSC.TICL_OID_TIPO_CLIE = #oidTipoCliente#
		</isNotEmpty>
		
   	</select>
    
    <insert id="insertSubtipoCliente" parameterClass="subtipoCliente">
		INSERT INTO MAE_SUBTI_CLIEN(
		    OID_SUBT_CLIE, 
		    COD_SUBT_CLIE, 
		    TICL_OID_TIPO_CLIE,
		    IND_ACTI,
		    USU_CREA,
		    FEC_CREA)
		VALUES(
		    #oid#,
		    #codigo#,
		    #oidTipoCliente#,
		    #indicadorEstado#,
		    #auditInfo.createdBy#,
		    #auditInfo.created#)
   	</insert>
   	
   	<update id="updateSubtipoCliente" parameterClass="subtipoCliente">   	
		UPDATE MAE_SUBTI_CLIEN
		SET             
		    COD_SUBT_CLIE = #codigo#, 
		    TICL_OID_TIPO_CLIE = #oidTipoCliente#,
		    IND_ACTI = #indicadorEstado#,
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated#
		WHERE OID_SUBT_CLIE = #oid#   	
   	</update>

    <resultMap id="subtipoClienteResult" class="subtipoCliente">
		<result property="oid" 							column="OID_SUBT_CLIE"/>
    	<result property="codigo" 						column="COD_SUBT_CLIE"/>
    	<result property="descripcion" 					column="DES_SUBT_CLIE"/>
    	<result property="oidTipoCliente" 				column="TICL_OID_TIPO_CLIE"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>     	
   	<select id="getSubtipoCliente" parameterClass="map" resultMap="subtipoClienteResult">
		SELECT
		    MSC.OID_SUBT_CLIE, 
		    MSC.COD_SUBT_CLIE, 
		    GEN.VAL_I18N DES_SUBT_CLIE,
		    MSC.TICL_OID_TIPO_CLIE,
		    MSC.IND_ACTI
		FROM  GEN_I18N_SICC_COMUN GEN,  SEG_IDIOM IDI,  MAE_SUBTI_CLIEN MSC 
		WHERE MSC.OID_SUBT_CLIE = GEN.VAL_OID
		AND GEN.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		AND IDI.COD_ISO_IDIO = #codigoIdioma#
		AND MSC.OID_SUBT_CLIE = #oid#        
   	</select>
   	
   	    <resultMap id="estatusClienteResultMap" class="java.util.HashMap">
    	<result property="oid"							column="OID_ESTA_CLIE" 	/>
    	<result property="codigo" 						column="COD_ESTA_CLIE"/>
    	<result property="descripcion" 					column="DES_ESTA_CLIE"/>
    	<result property="codigoTipoEstatus" 			column="TESC_OID_TIPO_ESTA"/>
    	<result property="estatusPosteriorPosible" 		column="ESTA_OID_ESTA_CLIE"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>      	
    
    <resultMap id="garantiaPremiosResultMap" class="java.util.HashMap">
    	<result property="codigoSAP"							column="COD_SAP" 	/>
    	<result property="numDias" 						column="NUM_DIAS_GARA"/>
    	<result property="indicadorRegistro" 				column="EST_REGI"/>
    </resultMap>  
    
    <select id="getGarantiaPremiosByCriteria" parameterClass="map" resultMap="garantiaPremiosResultMap">   	
		SELECT COD_SAP,NUM_DIAS_GARA, CASE WHEN EST_REGI = '1' THEN 'ACTIVO' ELSE 'INACTIVO' END AS EST_REGI
		FROM INC_PRODU_GARAN
		<isNotEmpty property="codigoSAP">
			WHERE COD_SAP = #codigoSAP# 
		</isNotEmpty>
    </select>    	
   	<select id="getEstatusClienteByCriteria" parameterClass="map" resultMap="estatusClienteResultMap">   	
		SELECT
		MEC.OID_ESTA_CLIE, 
		MEC.COD_ESTA_CLIE,
		GEN.VAL_I18N DES_ESTA_CLIE,
		(select COD_TIPO_ESTA
          from MAE_TIPO_ESTAT_CLIEN
         WHERE OID_TIPO_ESTA = MEC.TESC_OID_TIPO_ESTA) TESC_OID_TIPO_ESTA,
	   (SELECT GEN.VAL_I18N DESCRIPCION
	      FROM GEN_I18N_SICC_COMUN GEN, SEG_IDIOM IDI, MAE_TIPO_CLIEN MEC
	     WHERE MEC.OID_TIPO_CLIE = GEN.VAL_OID
	       AND GEN.ATTR_ENTI = 'MAE_ESTAT_CLIEN'
	       AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
			   AND IDI.COD_ISO_IDIO = 'es'
	       AND MEC.OID_TIPO_CLIE = MEC.ESTA_OID_ESTA_CLIE) ESTA_OID_ESTA_CLIE,
		DECODE(MEC.IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI
		FROM  
		    GEN_I18N_SICC_COMUN GEN, 
		    SEG_IDIOM IDI, 
		    MAE_ESTAT_CLIEN MEC 
		WHERE MEC.OID_ESTA_CLIE = GEN.VAL_OID
		AND GEN.ATTR_ENTI = 'MAE_ESTAT_CLIEN'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		/*AND MEC.IND_ACTI = '1'*/
		AND IDI.COD_ISO_IDIO = #codigoIdioma#		
		
		<isNotEmpty property="codigoEstadoCliente">
			AND MEC.COD_ESTA_CLIE = #codigoEstadoCliente#
		</isNotEmpty>
		
		<isNotEmpty property="descripcionEstatusCliente">
			AND UPPER(GEN.VAL_I18N) LIKE '%'||UPPER(#descripcionEstatusCliente#)||'%'
		</isNotEmpty>
		
		<isNotEmpty property="codigoTipoEstatus">
			AND MEC.TESC_OID_TIPO_ESTA = #codigoTipoEstatus#
		</isNotEmpty>
		
		<isNotEmpty property="estatusPosteriorPosible">
			AND MEC.ESTA_OID_ESTA_CLIE = #estatusPosteriorPosible#
		</isNotEmpty>
		
   	</select>
    
    <insert id="insertEstatusCliente" parameterClass="estatusCliente">
		INSERT INTO MAE_ESTAT_CLIEN(
		    OID_ESTA_CLIE, 
		    COD_ESTA_CLIE, 
		    TESC_OID_TIPO_ESTA,
		    ESTA_OID_ESTA_CLIE,
		    IND_ACTI,
		    USU_CREA,
		    FEC_CREA)
		VALUES(
		    #oid#,
		    #codigo#,
		    #codigoTipoEstatus#,
		    #estatusPosteriorPosible#,
		    #indicadorEstado#,
		    #auditInfo.createdBy#,
		    #auditInfo.created#)
   	</insert>
   	
   	<update id="updateEstatusCliente" parameterClass="estatusCliente">   	
		UPDATE MAE_ESTAT_CLIEN
		SET             
		    COD_ESTA_CLIE = #codigo#, 
		    ESTA_OID_ESTA_CLIE = #estatusPosteriorPosible#,
		    TESC_OID_TIPO_ESTA=#codigoTipoEstatus#,
		    IND_ACTI = #indicadorEstado#,
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated#
		WHERE OID_ESTA_CLIE = #oid#   	
   	</update>

    <resultMap id="estatusClienteResult" class="estatusCliente">
		<result property="oid" 							column="OID_ESTA_CLIE"/>
    	<result property="codigo" 						column="COD_ESTA_CLIE"/>
    	<result property="descripcion" 					column="DES_TIPO_CLIE"/>
    	<result property="estatusPosteriorPosible" 		column="ESTA_OID_ESTA_CLIE"/>
    	<result property="codigoTipoEstatus" 			column="TESC_OID_TIPO_ESTA"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>     	
   	<select id="getEstatusCliente" parameterClass="map" resultMap="estatusClienteResult">
		SELECT
		    MEC.OID_ESTA_CLIE, 
		    MEC.COD_ESTA_CLIE, 
		    GEN.VAL_I18N DES_TIPO_CLIE,
		    MEC.ESTA_OID_ESTA_CLIE,
		    MEC.TESC_OID_TIPO_ESTA,
		    MEC.IND_ACTI
		FROM  GEN_I18N_SICC_COMUN GEN,  SEG_IDIOM IDI,  MAE_ESTAT_CLIEN MEC 
		WHERE MEC.OID_ESTA_CLIE = GEN.VAL_OID
		AND GEN.ATTR_ENTI = 'MAE_ESTAT_CLIEN'
		AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		AND IDI.COD_ISO_IDIO = #codigoIdioma#
		AND MEC.OID_ESTA_CLIE = #oid#        
   	</select>
   	
   	<select id="getTipoEstadosCliente" resultMap="baseResult">
		select OID_TIPO_ESTA CODIGO, 
			   COD_TIPO_ESTA DESCRIPCION
  	      from MAE_TIPO_ESTAT_CLIEN 	
   	</select>
   	
   	<select id="getEstadoPosteriorPosible" parameterClass="map" resultMap="baseResult">
		SELECT MEC.ESTA_OID_ESTA_CLIE CODIGO, GEN.VAL_I18N DESCRIPCION
		  FROM GEN_I18N_SICC_COMUN GEN, SEG_IDIOM IDI, MAE_ESTAT_CLIEN MEC
		 WHERE MEC.ESTA_OID_ESTA_CLIE = GEN.VAL_OID
		   AND GEN.ATTR_ENTI = 'MAE_ESTAT_CLIEN'
		   AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		   AND IDI.COD_ISO_IDIO = #codigoIdioma#
   	</select>
   	
   	<select id="getTipoClienteList" parameterClass="map" resultMap="baseResult">
		SELECT MEc.OID_TIPO_CLIE CODIGO, GEN.VAL_I18N DESCRIPCION
		  FROM GEN_I18N_SICC_COMUN GEN, SEG_IDIOM IDI, MAE_TIPO_CLIEN MEC
		 WHERE MEC.OID_TIPO_CLIE = GEN.VAL_OID
		   AND GEN.ATTR_ENTI = 'MAE_TIPO_CLIEN'
		   AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		   AND IDI.COD_ISO_IDIO = #codigoIdioma#
   	</select>

   	<select id="getSubTipoClienteList" parameterClass="map" resultMap="baseResult">
		SELECT MSC.COD_SUBT_CLIE AS CODIGO,GEN.VAL_I18N AS DESCRIPCION
		FROM GEN_I18N_SICC_COMUN GEN, MAE_SUBTI_CLIEN MSC 
		WHERE MSC.OID_SUBT_CLIE = GEN.VAL_OID
		      AND GEN.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
		      AND MSC.TICL_OID_TIPO_CLIE = #tipoCliente#
   	</select>
   	
   	<select id="getTipoClasificacion" parameterClass="map" resultMap="baseResult">
   		
		select COD_TIPO_CLAS AS CODIGO,VAL_I18N AS DESCRIPCION
		from MAE_TIPO_CLASI_CLIEN cli, GEN_I18N_SICC_COMUN gen
		WHERE cli.oid_tipo_clas = gen.val_oid AND
		GEN.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN' AND
		cli.Sbti_Oid_Subt_Clie = #subtipoCliente#
   	</select>
   	
   	
   	 <resultMap id="ClasificacionesGridResultMap" class="java.util.HashMap">
    	<result property="codigoClas"							column="OID_CLAS" 	/>
    	<result property="tipoCliente" 						column="TICL_OID_TIPO_CLIE"/>
    	<result property="subTipoCliente" 				column="DES_SUBT_CLIE"/>
    	<result property="tipoClasificacion" 				column="TIPO_CLASIFICACION"/>
    	<result property="codClasificacion" 				column="COD_CLAS"/>
    	<result property="descClasificacion" 				column="CLASIFICACION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    	<result property="indicadorHiperconsulta" 				column="IND_HIPE"/>
    	<result property="indicadorIVR" 				column="IND_IVR"/>
    </resultMap>  
   	
   	<select id="getClasificacionesGrid" parameterClass="map" resultMap="ClasificacionesGridResultMap">
		
	SELECT 
			     (SELECT GEN.VAL_I18N DESCRIPCION
			        FROM GEN_I18N_SICC_COMUN GEN, MAE_TIPO_CLIEN MEC
			       WHERE MEC.OID_TIPO_CLIE = GEN.VAL_OID
			         AND GEN.ATTR_ENTI = 'MAE_TIPO_CLIEN'
               AND MEC.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE ) TICL_OID_TIPO_CLIE,
          (SELECT GEN.VAL_I18N DESCRIPCION
              FROM GEN_I18N_SICC_COMUN GEN, MAE_SUBTI_CLIEN MST
             WHERE MST.OID_SUBT_CLIE = GEN.VAL_OID
               AND GEN.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
               AND MST.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE) DES_SUBT_CLIE,
			     (select VAL_I18N 
					 from MAE_TIPO_CLASI_CLIEN cli, GEN_I18N_SICC_COMUN gen
					 WHERE cli.oid_tipo_clas = gen.val_oid AND
					 GEN.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN' AND
           cli.OID_TIPO_CLAS = MAE_CLASI.TCCL_OID_TIPO_CLAS ) TIPO_CLASIFICACION,
           OID_CLAS,
           COD_CLAS,
           VAL_I18N AS CLASIFICACION,
           DECODE(MAE_CLASI.IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI,
           DECODE(MAE_CLASI.IND_HIPE, '1', 'Si', 'No') IND_HIPE,
           DECODE(MAE_CLASI.IND_IVR, '1', 'Si', 'No') IND_IVR
		FROM GEN_I18N_SICC_COMUN,
				SEG_IDIOM ,
				MAE_CLASI,
				MAE_TIPO_CLASI_CLIEN,
				MAE_SUBTI_CLIEN,
				MAE_TIPO_CLIEN
		WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_CLASI.OID_CLAS
				AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
				AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_CLASI'
				AND MAE_CLASI.TCCL_OID_TIPO_CLAS = MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS	  
				AND MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE
				AND MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE
			<isNotEmpty property="oidTipoClienteCL">
				AND	MAE_TIPO_CLIEN.OID_TIPO_CLIE = #oidTipoClienteCL#		
			</isNotEmpty>
			<isNotEmpty property="oidSubTipoCliente">
				AND	MAE_SUBTI_CLIEN.OID_SUBT_CLIE = #oidSubTipoCliente#		
			</isNotEmpty>
			<isNotEmpty property="oidTipoClasificacion">
			   	AND MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS = #oidTipoClasificacion#
		   	</isNotEmpty>
			<isNotEmpty property="codClas">
			AND		 MAE_CLASI.COD_CLAS = #codClas#	
			</isNotEmpty>
			<isNotEmpty property="descripcionClas">
				AND UPPER(GEN_I18N_SICC_COMUN.VAL_I18N) LIKE '%'||UPPER(#descripcionClas#)||'%'
			</isNotEmpty>
		 
   	</select>
   	
   	<select id="getExisteOidTipoCliente" parameterClass="tipoCliente" resultClass="string">   	
		SELECT OID_TIPO_CLIE
		  FROM MAE_TIPO_CLIEN
		 WHERE COD_TIPO_CLIE = #codigo# 	
   	</select>
   	
   	<select id="getExisteOidSubtipoCliente" parameterClass="subtipoCliente" resultClass="string">   	
		SELECT OID_SUBT_CLIE
		  FROM MAE_SUBTI_CLIEN
		 WHERE COD_SUBT_CLIE = #codigo#
		   AND TICL_OID_TIPO_CLIE = #oidTipoCliente# 	
   	</select>
   	
   	<select id="getExisteOidEstatusCliente" parameterClass="estatusCliente" resultClass="string">   	
		SELECT OID_ESTA_CLIE 
		  FROM MAE_ESTAT_CLIEN 
		 WHERE COD_ESTA_CLIE = #codigo#	
   	</select> 	
   	
   	<delete id="deleteTipoBloqueo">
       DELETE FROM MAE_TIPO_BLOQU WHERE OID_TIPO_BLOQ = #oid#
    </delete>
    
    <delete id="deleteDescripcion">
       DELETE FROM gen_i18n_sicc_comun 
		WHERE attr_enti = #nombreTabla# 
   		  AND attr_num_atri = #numAtributo# 
   		  AND idio_oid_idio = #oidIdioma#    			
   		  AND val_oid = #valOidAtributo# 
    </delete>
    
    
   	<insert id="insertGarantiasPremio" parameterClass="garantiasPremio">
		INSERT INTO INC_PRODU_GARAN(
		    COD_PAIS, 
		    COD_SAP, 
		    NUM_DIAS_GARA,
		    EST_REGI,
		    USU_CREA,
		    FEC_CREA)
		VALUES(
		    #codigoPais#,
		    #codigoSAP#,
		    #numDias#,
		    #indicadorRegistro#,
		    #auditInfo.createdBy#,
		    #auditInfo.created#)
   	</insert>
   	
   	
   	<update id="updateGarantiasPremio" parameterClass="garantiasPremio">   	
		UPDATE INC_PRODU_GARAN
		SET             
		    COD_PAIS = #codigoPais#, 
		    COD_SAP = #codigoSAP#,
		    NUM_DIAS_GARA=#numDias#,
		    EST_REGI = #indicadorRegistro#,
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated#
		WHERE COD_SAP = #codigoSAP#   	
   	</update>

	<resultMap id="garantiaResultMap" class="garantiasPremio">
    	<result property="codigoPais" column="codigoPais" 	/>
    	<result property="codigoSAP" column="codigoSAP" 	/>
    	<result property="numDias" column="numDias" 	/>
    	<result property="indicadorRegistro" column="indicadorRegistro" 	/>
    </resultMap>  
    
   	<select id="getGarantiasPremio" parameterClass="map" resultMap="garantiaResultMap">   	
		SELECT COD_PAIS as codigoPais, COD_SAP as codigoSAP, NUM_DIAS_GARA as numDias,EST_REGI as indicadorRegistro
		  FROM INC_PRODU_GARAN 
		 WHERE COD_SAP = #codigoSAP#	
   	</select> 
   	
   	<select id="getExisteGarantiasPremio" parameterClass="garantiasPremio" resultClass="string">   	
		SELECT COD_SAP 
		  FROM INC_PRODU_GARAN 
		 WHERE COD_SAP = #codigoSAP#	
   	</select> 	
   	
   	<select id="getValidaIngresoTelefono" parameterClass="map" resultClass="string">
   		SELECT count(1)
		  FROM BAS_PARAM_PAIS
		 WHERE COD_SIST = #codigoSistema#
		   AND COD_PAIS = #codigoPais#
		   AND VAL_PARA = #valorParametro#
		   AND IND_ACTI = #indicadorActivo#
		   AND NOM_PARA = #nombreParametro#
   	</select> 	

   	<parameterMap id="executeInsertClasificacionParams" class="java.util.Map">														
    	<parameter property="codigoTipoClasificacion"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoClasificacion"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="descripcionClasificacion"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="indicadorRegistro"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="indicadorHiperconsulta"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 	<parameter property="indicadorIVR"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 </parameterMap>
  														
  	<procedure id="insertClasificacion" parameterMap="executeInsertClasificacionParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_INSER_CLAS(?, ?, ?, ?, ?, ?)}											
	</procedure>
   	
   	<update id="updateClasificacion" parameterClass="clasificacionMap">   	
		UPDATE MAE_CLASI 
		SET TCCL_OID_TIPO_CLAS=#codigoTipoClasificacion#,
                     COD_CLAS=#codigoClasificacion#,
                     IND_ACTI=#indicadorRegistro#,
                     IND_HIPE=#indicadorHiperconsulta#,
                     IND_IVR=#indicadorIVR#
		WHERE OID_CLAS=#oidClasificacion#
   	</update>
   	
   	<resultMap id="clasificacionResultMap" class="clasificacionMap">
   		<result property="oidClasificacion" column="OID_CLAS" 	/>
    	<result property="codigoClasificacion" column="COD_CLAS" 	/>
    	<result property="indicadorRegistro" column="IND_ACTI" 	/>
    	<result property="descripcionClasificacion" column="DESCRIPCION" 	/>
    	<result property="codigoTipoClienteCL" column="OID_TIPO_CLIE" 	/>
    	<result property="codigoTipoSubCliente" column="OID_SUBT_CLIE" 	/>
    	<result property="codigoTipoClasificacion" column="OID_TIPO_CLAS" 	/>
    	<result property="indicadorHiperconsulta" column="IND_HIPE" 	/>
    	<result property="indicadorIVR" column="IND_IVR" 	/>
    </resultMap> 

   	<select id="getClasificacion" parameterClass="map" resultMap="clasificacionResultMap">   	
		SELECT 
         (SELECT MEC.OID_TIPO_CLIE
         FROM MAE_TIPO_CLIEN MEC
             WHERE MEC.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE ) OID_TIPO_CLIE,
          (SELECT MST.OID_SUBT_CLIE
              FROM  MAE_SUBTI_CLIEN MST
             WHERE  MST.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE) OID_SUBT_CLIE,
          (select cli.OID_TIPO_CLAS 
           from MAE_TIPO_CLASI_CLIEN cli
           WHERE cli.OID_TIPO_CLAS = MAE_CLASI.TCCL_OID_TIPO_CLAS ) OID_TIPO_CLAS,
           OID_CLAS,
           COD_CLAS,
           VAL_I18N AS DESCRIPCION,
           MAE_CLASI.IND_ACTI,
           MAE_CLASI.IND_HIPE,
           MAE_CLASI.IND_IVR
		FROM GEN_I18N_SICC_COMUN,
				SEG_IDIOM ,
				MAE_CLASI,
				MAE_TIPO_CLASI_CLIEN,
				MAE_SUBTI_CLIEN,
				MAE_TIPO_CLIEN	 
		WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_CLASI.OID_CLAS
				AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
				AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_CLASI'
				AND MAE_CLASI.TCCL_OID_TIPO_CLAS = MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS	  
				AND MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE
				AND MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE  
		   		AND	OID_CLAS = #oidClasificacion#	
   	</select> 
   	
   	
   	<select id="getExisteClasificacion" parameterClass="clasificacionMap" resultClass="string">   	
		SELECT COD_CLAS
		FROM MAE_CLASI
		WHERE COD_CLAS=#codigoClasificacion#
		    AND TCCL_OID_TIPO_CLAS = #codigoTipoClasificacion#
   	</select> 	
   	
   	
   	<resultMap id="TipoClasificacionesGridResultMap" class="java.util.HashMap">
    	<result property="codigoTipoClas"							column="OID_TIPO_CLAS" 	/>
    	<result property="tipoCliente" 						column="TICL_OID_TIPO_CLIE"/>
    	<result property="subTipoCliente" 				column="DES_SUBT_CLIE"/>
    	<result property="codTipoClasificacion" 				column="COD_TIPO_CLAS"/>
    	<result property="descTipoClasificacion" 				column="DESCRIPCION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    	<result property="tipoClasificacionPais" 				column="IND_TIPO_CLAS_PAIS"/>
    	
    </resultMap>  
   	
   	<select id="getTipoClasificacionesGrid" parameterClass="map" resultMap="TipoClasificacionesGridResultMap">
		
	SELECT 
         (SELECT GEN.VAL_I18N DESCRIPCION
              FROM GEN_I18N_SICC_COMUN GEN, MAE_TIPO_CLIEN MEC
             WHERE MEC.OID_TIPO_CLIE = GEN.VAL_OID
               AND GEN.ATTR_ENTI = 'MAE_TIPO_CLIEN'
               AND MEC.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE ) TICL_OID_TIPO_CLIE,
          (SELECT GEN.VAL_I18N DESCRIPCION
              FROM GEN_I18N_SICC_COMUN GEN, MAE_SUBTI_CLIEN MST
             WHERE MST.OID_SUBT_CLIE = GEN.VAL_OID
               AND GEN.ATTR_ENTI = 'MAE_SUBTI_CLIEN'
               AND MST.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE) DES_SUBT_CLIE,
           OID_TIPO_CLAS,
           COD_TIPO_CLAS,
           VAL_I18N AS DESCRIPCION,
           DECODE(MAE_TIPO_CLASI_CLIEN.IND_ACTI, '1', 'SI', 'NO') IND_ACTI,
           DECODE(MAE_TIPO_CLASI_CLIEN.IND_TIPO_CLAS_PAIS, '1', 'SI', 'NO') IND_TIPO_CLAS_PAIS
		FROM GEN_I18N_SICC_COMUN,
				SEG_IDIOM ,
				MAE_TIPO_CLASI_CLIEN,
				MAE_SUBTI_CLIEN,
				MAE_TIPO_CLIEN
		WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS
				AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
				AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN'  
				AND MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE
				AND MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE
			<isNotEmpty property="oidTipoClienteTCL">
				AND	MAE_TIPO_CLIEN.OID_TIPO_CLIE = #oidTipoClienteTCL#		
			</isNotEmpty>
			<isNotEmpty property="oidSubTipoClienteTCL">
				AND	MAE_SUBTI_CLIEN.OID_SUBT_CLIE = #oidSubTipoClienteTCL#		
			</isNotEmpty>
			<isNotEmpty property="tipoCodClas">
				AND	MAE_TIPO_CLASI_CLIEN.COD_TIPO_CLAS = #tipoCodClas#	
			</isNotEmpty>
			<isNotEmpty property="descripcionTipoClas">
				AND UPPER(GEN_I18N_SICC_COMUN.VAL_I18N) LIKE '%'||UPPER(#descripcionTipoClas#)||'%'
			</isNotEmpty>
	</select>
	
	
   	<parameterMap id="executeInsertTipoClasificacionParams" class="java.util.Map">														
    	<parameter property="codigoTipoSubCliente"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="codigoTipoClasificacion"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    	<parameter property="tipoClasificacionPais"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="descripcionTipoClasificacion"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
     	<parameter property="indicadorRegistro"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	 </parameterMap>
  														
  	<procedure id="insertTipoClasificacion" parameterMap="executeInsertTipoClasificacionParams">														
		{call MAE_PKG_PROCE_CLIEN.MAE_PR_INSER_TIPO_CLAS(?, ?, ?, ?, ?)}											
	</procedure>
   	
   	<update id="updateTipoClasificacion" parameterClass="tipoClasificacionMap">   	
		
		UPDATE MAE_TIPO_CLASI_CLIEN SET SBTI_OID_SUBT_CLIE = #codigoTipoSubCliente#,
		                                COD_TIPO_CLAS = #codigoTipoClasificacion#,
		                                IND_TIPO_CLAS_PAIS =#tipoClasificacionPais#,
		                                IND_ACTI = #indicadorRegistro#
		WHERE OID_TIPO_CLAS = #oidTipoClasificacion#
		
   	</update>
	
	<resultMap id="tipoClasificacionResultMap" class="tipoClasificacionMap">
   		<result property="oidTipoClasificacion" column="OID_TIPO_CLAS" 	/>
    	<result property="codigoTipoClasificacion" column="COD_TIPO_CLAS" 	/>
    	<result property="indicadorRegistro" column="IND_ACTI" 	/>
    	<result property="descripcionTipoClasificacion" column="DESCRIPCION" 	/>
    	<result property="codigoTipoClienteCL" column="OID_TIPO_CLIE" 	/>
    	<result property="codigoTipoSubCliente" column="OID_SUBT_CLIE" 	/>
    	<result property="tipoClasificacionPais" column="IND_TIPO_CLAS_PAIS" 	/>
    	
    </resultMap> 

   	<select id="getObtieneTipoClasificacion" parameterClass="map" resultMap="tipoClasificacionResultMap">   	

		SELECT 
         (SELECT MEC.OID_TIPO_CLIE
         FROM MAE_TIPO_CLIEN MEC
             WHERE MEC.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE ) OID_TIPO_CLIE,
          (SELECT MST.OID_SUBT_CLIE
              FROM  MAE_SUBTI_CLIEN MST
             WHERE  MST.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE) OID_SUBT_CLIE,
           OID_TIPO_CLAS,
           COD_TIPO_CLAS,
           VAL_I18N AS DESCRIPCION,
           MAE_TIPO_CLASI_CLIEN.IND_ACTI,
           MAE_TIPO_CLASI_CLIEN.IND_TIPO_CLAS_PAIS
		FROM GEN_I18N_SICC_COMUN,
				SEG_IDIOM ,
				MAE_TIPO_CLASI_CLIEN,
				MAE_SUBTI_CLIEN,
				MAE_TIPO_CLIEN	 
		WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS
				AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
				AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_CLASI_CLIEN'  
				AND MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE
				AND MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE  
		   		AND	MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS = #oidTipoClasificacion#	
   	</select> 
   	
   	
   	<select id="getExisteTipoClasificacion" parameterClass="tipoClasificacionMap" resultClass="string">   	
		SELECT COD_TIPO_CLAS
		FROM MAE_TIPO_CLASI_CLIEN
		WHERE COD_TIPO_CLAS=#codigoTipoClasificacion#
			  AND  SBTI_OID_SUBT_CLIE=#codigoTipoSubCliente#
   	</select> 	
   	
	
   	<insert id="insertTipoEstatusCliente" parameterClass="estatusClienteMap">
		INSERT INTO MAE_TIPO_ESTAT_CLIEN(
		    OID_TIPO_ESTA,
		    COD_TIPO_ESTA,
		    MARC_OID_MARC)
		VALUES(
		    #oidEstatus#,
		    #codigo#,
		    #marca#)
   	</insert>
   	
   	<select id="getOidTipoEstatusCliente" resultClass="string">
   		SELECT MAE_TESC_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<update id="updateTipoEstatusCliente" parameterClass="estatusClienteMap">   	
		UPDATE MAE_TIPO_ESTAT_CLIEN 
		SET COD_TIPO_ESTA=#codigo#,
		    MARC_OID_MARC=#marca#
		WHERE OID_TIPO_ESTA = #oidEstatus# 
   	</update>
   	
   	<resultMap id="EstatusClienteGridResultMap" class="java.util.HashMap">
    	<result property="oidEstatus"							column="OID_TIPO_ESTA" 	/>
    	<result property="codigo" 						column="COD_TIPO_ESTA"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="marca" 				column="MARCA"/>
    	
    </resultMap>  
   	
   	<select id="getEstatusClienteGrid" parameterClass="map" resultMap="EstatusClienteGridResultMap">
		   		
		SELECT OID_TIPO_ESTA,
		           COD_TIPO_ESTA,
		           VAL_I18N AS DESCRIPCION,
		           SEG_MARCA.DES_MARC AS MARCA
	    FROM GEN_I18N_SICC_COMUN,
	        SEG_IDIOM ,
	        MAE_TIPO_ESTAT_CLIEN,
	        SEG_MARCA
	    WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_ESTAT_CLIEN.OID_TIPO_ESTA
	        AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
	        AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_ESTAT_CLIEN'  
		    AND SEG_MARCA.OID_MARC = MAE_TIPO_ESTAT_CLIEN.MARC_OID_MARC
		<isNotEmpty property="codigo">
				AND	MAE_TIPO_ESTAT_CLIEN.COD_TIPO_ESTA = #codigo#	
		</isNotEmpty>
		<isNotEmpty property="marca">
				AND	MAE_TIPO_ESTAT_CLIEN.MARC_OID_MARC = #marca#	
		</isNotEmpty>
		<isNotEmpty property="descripcionEstatus">
			AND UPPER(GEN_I18N_SICC_COMUN.VAL_I18N) LIKE '%'||UPPER(#descripcionEstatus#)||'%'
		</isNotEmpty>
   	</select>
   	
   	<resultMap id="estatusResultMap" class="estatusClienteMap">
   		<result property="oidEstatus"			column="OID_TIPO_ESTA" 	/>
    	<result property="codigo" 		column="COD_TIPO_ESTA"/>
    	<result property="descripcion" 			column="DESCRIPCION"/>
    	<result property="marca" 				column="MARCA"/>
    </resultMap> 

   	<select id="getObtieneTipoEstatusCliente" parameterClass="map" resultMap="estatusResultMap">   	
   		SELECT OID_TIPO_ESTA,
		           COD_TIPO_ESTA,
		           VAL_I18N AS DESCRIPCION,
		           MARC_OID_MARC AS MARCA
	    FROM GEN_I18N_SICC_COMUN,
	        SEG_IDIOM ,
	        MAE_TIPO_ESTAT_CLIEN
	    WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_ESTAT_CLIEN.OID_TIPO_ESTA
	        AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
	        AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_ESTAT_CLIEN'
	        AND MAE_TIPO_ESTAT_CLIEN.OID_TIPO_ESTA = #oidEstatus#
   	</select>
   	
   	
   	<select id="getExisteTipoEstatusCliente" parameterClass="estatusClienteMap" resultClass="string">   	
		SELECT COD_TIPO_ESTA
		FROM MAE_TIPO_ESTAT_CLIEN
		WHERE COD_TIPO_ESTA=#codigo#
   	</select> 	
   	
   	
   	<select id="getMarcaList" parameterClass="map" resultMap="baseResult">
		SELECT OID_MARC CODIGO, DES_MARC DESCRIPCION
		  FROM SEG_MARCA
   	</select>
   	
    <insert id="insertTipoVinculo" parameterClass="tipoVinculoMap">
		INSERT INTO MAE_TIPO_VINCU (OID_TIPO_VINC,COD_TIPO_VINC,IND_ACTI,Ind_Reco,PAIS_OID_PAIS)
            	 			 VALUES(#oidTipoVinc#,#codigo#,#estado#,#recomendado#,2001)
   	</insert>
   	
   	<select id="getOidObtieneTipoVinculo" resultClass="string">
   		SELECT MAE_TIVC_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<update id="updateTipoVinculo" parameterClass="tipoVinculoMap">   	
		UPDATE MAE_TIPO_VINCU SET IND_ACTI = #estado#,
                          IND_RECO = #recomendado#,
                          COD_TIPO_VINC = #codigo#
       WHERE OID_TIPO_VINC = #oidTipoVinc#
   	</update>
   	
   	<resultMap id="TipoVinculoGridResultMap" class="java.util.HashMap">
    	<result property="oidTipoVinc"							column="OID_TIPO_VINC" 	/>
    	<result property="codigo" 						column="COD_TIPO_VINC"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    	<result property="recomendado" 				column="IND_RECO"/>
    </resultMap>  
   	
   	<select id="getTipoVinculoGrid" parameterClass="map" resultMap="TipoVinculoGridResultMap">
		   		
	 SELECT OID_TIPO_VINC,
               COD_TIPO_VINC,
               VAL_I18N AS DESCRIPCION,
               DECODE(IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI,
               DECODE(IND_RECO, '1', 'Si', 'No') IND_RECO
      FROM GEN_I18N_SICC_PAIS,
          SEG_IDIOM ,
          MAE_TIPO_VINCU
      WHERE  GEN_I18N_SICC_PAIS.VAL_OID = MAE_TIPO_VINCU.OID_TIPO_VINC
          AND GEN_I18N_SICC_PAIS.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
          AND GEN_I18N_SICC_PAIS.ATTR_ENTI = 'MAE_TIPO_VINCU'
		<isNotEmpty property="codigoTipoVinculo">
				AND	MAE_TIPO_VINCU.COD_TIPO_VINC = #codigoTipoVinculo#	
		</isNotEmpty>
		<isNotEmpty property="recomendado">
				AND	MAE_TIPO_VINCU.IND_RECO = #recomendado#	
		</isNotEmpty>
		<isNotEmpty property="descripcionVinculo">
			AND UPPER(GEN_I18N_SICC_PAIS.VAL_I18N) LIKE '%'||UPPER(#descripcionVinculo#)||'%'
		</isNotEmpty>
   	</select>
   	
   	<resultMap id="TipoVinculoResultMap" class="tipoVinculoMap">
   		<result property="oidTipoVinc"							column="OID_TIPO_VINC" 	/>
    	<result property="codigo" 						column="COD_TIPO_VINC"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    	<result property="recomendado" 				column="IND_RECO"/>
    </resultMap> 

   	<select id="getObtieneTipoVinculo" parameterClass="map" resultMap="TipoVinculoResultMap">   	
		   		
		  SELECT OID_TIPO_VINC,
		               COD_TIPO_VINC,
		               VAL_I18N AS DESCRIPCION,
		               IND_ACTI,
		               IND_RECO
		      FROM GEN_I18N_SICC_PAIS,
		          SEG_IDIOM ,
		          MAE_TIPO_VINCU
		      WHERE  GEN_I18N_SICC_PAIS.VAL_OID = MAE_TIPO_VINCU.OID_TIPO_VINC
		          AND GEN_I18N_SICC_PAIS.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
		          AND GEN_I18N_SICC_PAIS.ATTR_ENTI = 'MAE_TIPO_VINCU'
		          AND  MAE_TIPO_VINCU.OID_TIPO_VINC = #oidTipoVinc#

   	</select>
   	
   	
   	<select id="getExisteTipoVinculo" parameterClass="tipoVinculoMap" resultClass="string">   	
		SELECT COD_TIPO_VINC
		FROM MAE_TIPO_VINCU 
		WHERE COD_TIPO_VINC = #codigo#
   	</select> 	
   	
   	
    <insert id="insertTipoComu" parameterClass="tipoComuMap">
		INSERT INTO MAE_TIPO_COMUN (OID_TIPO_COMU,COD_TIPO_COMU,IND_ACTI)
            				 VALUES(#oidTipoComu#,#codigo#,#estado#)
   	</insert>
   	
   	<select id="getOidTipoComu" resultClass="string">
   		SELECT MAE_TICM_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<update id="updateTipoComu" parameterClass="tipoComuMap">   	
		UPDATE MAE_TIPO_COMUN SET IND_ACTI = #estado#,
								 COD_TIPO_COMU = #codigo#		
       WHERE OID_TIPO_COMU = #oidTipoComu#
   	</update>
   	
   	<resultMap id="TipoComuGridResultMap" class="java.util.HashMap">
    	<result property="oidTipoComu"							column="OID_TIPO_COMU" 	/>
    	<result property="codigo" 						column="COD_TIPO_COMU"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    	
    </resultMap>  
   	
   	<select id="getTipoComuGrid" parameterClass="map" resultMap="TipoComuGridResultMap">
		   		
 	  SELECT OID_TIPO_COMU,
               COD_TIPO_COMU,
               VAL_I18N AS DESCRIPCION,
               DECODE(IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI
      FROM GEN_I18N_SICC_COMUN,
          SEG_IDIOM ,
          MAE_TIPO_COMUN
      WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_COMUN.OID_TIPO_COMU
          AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
          AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_COMUN'
		<isNotEmpty property="codigoTipoComu">
				AND	MAE_TIPO_COMUN.COD_TIPO_COMU = #codigoTipoComu#	
		</isNotEmpty>
		<isNotEmpty property="descripcionTipoComu">
			AND UPPER(GEN_I18N_SICC_COMUN.VAL_I18N) LIKE '%'||UPPER(#descripcionTipoComu#)||'%'
		</isNotEmpty>
   	</select>
   	
   	<resultMap id="TipoComuResultMap" class="tipoComuMap">
   		<result property="oidTipoComu"							column="OID_TIPO_COMU" 	/>
    	<result property="codigo" 						column="COD_TIPO_COMU"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    </resultMap> 

   	<select id="getObtieneTipoComu" parameterClass="map" resultMap="TipoComuResultMap">   	
		   		
		 SELECT OID_TIPO_COMU,
               COD_TIPO_COMU,
               VAL_I18N AS DESCRIPCION,
               IND_ACTI
      FROM GEN_I18N_SICC_COMUN,
          SEG_IDIOM ,
          MAE_TIPO_COMUN
      WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_COMUN.OID_TIPO_COMU
	          AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
	          AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_COMUN'
	          AND  MAE_TIPO_COMUN.OID_TIPO_COMU = #oidTipoComu#

   	</select>
   	
   	
   	<select id="getExisteTipoComu" parameterClass="tipoComuMap" resultClass="string">   	
		SELECT COD_TIPO_COMU
		  FROM MAE_TIPO_COMUN 
		  WHERE COD_TIPO_COMU = #codigo#

   	</select> 	
   	
   	<insert id="insertTipoDirec" parameterClass="tipoDirecMap">
		INSERT INTO MAE_TIPO_DIREC (OID_TIPO_DIRE,COD_TIPO_DIRE,IND_ACTI)
            				 VALUES(#oidTipoDirec#,#codigo#,#estado#)
   	</insert>
   	
   	<select id="getOidTipoDirec" resultClass="string">
   		SELECT MAE_TIDC_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<update id="updateTipoDirec" parameterClass="tipoDirecMap">   	
		UPDATE MAE_TIPO_DIREC SET IND_ACTI = #estado#,
								  COD_TIPO_DIRE = #codigo#
        WHERE OID_TIPO_DIRE = #oidTipoDirec#
   	</update>
   	
   	<resultMap id="TipoDirecGridResultMap" class="java.util.HashMap">
    	<result property="oidTipoDirec"							column="OID_TIPO_DIRE" 	/>
    	<result property="codigo" 						column="COD_TIPO_DIRE"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    	
    </resultMap>  
   	
   	<select id="getTipoDirecGrid" parameterClass="map" resultMap="TipoDirecGridResultMap">
		   		
 	  
		SELECT OID_TIPO_DIRE,
               COD_TIPO_DIRE,
               VAL_I18N AS DESCRIPCION,
               DECODE(IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI
	    FROM GEN_I18N_SICC_COMUN,
	        SEG_IDIOM ,
	        MAE_TIPO_DIREC
	    WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_DIREC.OID_TIPO_DIRE
	        AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
	        AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_DIREC'
		<isNotEmpty property="codigoTipoDirec">
				AND	MAE_TIPO_DIREC.COD_TIPO_DIRE = #codigoTipoDirec#	
		</isNotEmpty>
		<isNotEmpty property="descripcionTipoDirec">
			AND UPPER(GEN_I18N_SICC_COMUN.VAL_I18N) LIKE '%'||UPPER(#descripcionTipoDirec#)||'%'
		</isNotEmpty>
   	</select>
   	
   	<resultMap id="TipoDirecResultMap" class="tipoDirecMap">
   		<result property="oidTipoDirec"							column="OID_TIPO_DIRE" 	/>
    	<result property="codigo" 						column="COD_TIPO_DIRE"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="estado" 				column="IND_ACTI"/>
    </resultMap> 

   	<select id="getObtieneTipoDirec" parameterClass="map" resultMap="TipoDirecResultMap">   	
	 SELECT OID_TIPO_DIRE,
               COD_TIPO_DIRE,
               VAL_I18N AS DESCRIPCION,
               IND_ACTI
	    FROM GEN_I18N_SICC_COMUN,
	        SEG_IDIOM ,
	        MAE_TIPO_DIREC
	    WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_TIPO_DIREC.OID_TIPO_DIRE
	        AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
	        AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_TIPO_DIREC'
	        AND MAE_TIPO_DIREC.OID_TIPO_DIRE = #oidTipoDirec#
	
	</select>
   	
   	
   	<select id="getExisteTipoDirec" parameterClass="tipoDirecMap" resultClass="string">   	
		SELECT COD_TIPO_DIRE 
		FROM MAE_TIPO_DIREC 
		WHERE COD_TIPO_DIRE = #codigo#

   	</select> 	
   	
   	
   	<insert id="insertEstadoCivil" parameterClass="estadoCivilMap">
		INSERT INTO MAE_ESTAD_CIVIL (OID_ESTA_CIVI,COD_ESTA_CIVI)
            VALUES(#oidEstadoCivil#,#codigo#)
   	</insert>
   	
   	<update id="updateEstadoCivil" parameterClass="estadoCivilMap">
   		UPDATE MAE_ESTAD_CIVIL 
   		SET COD_ESTA_CIVI = #codigo#
   		WHERE OID_ESTA_CIVI = #oidEstadoCivil#
   	</update>
   	
   	<select id="getOidObtieneEstadoCivil" resultClass="string">
   		SELECT MAE_ESCV_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<resultMap id="EstadoCivilGridResultMap" class="java.util.HashMap">
    	<result property="oidEstadoCivil"			column="OID_ESTA_CIVI" 	/>
    	<result property="codigo" 						column="COD_ESTA_CIVI"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	
    </resultMap>  
   	
   	<select id="getEstadoCivilGrid" parameterClass="map" resultMap="EstadoCivilGridResultMap">
		   		
  	  SELECT OID_ESTA_CIVI,
               COD_ESTA_CIVI,
               VAL_I18N AS DESCRIPCION
      FROM GEN_I18N_SICC_COMUN,
          SEG_IDIOM ,
          MAE_ESTAD_CIVIL
      WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_ESTAD_CIVIL.OID_ESTA_CIVI
          AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
          AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_ESTAD_CIVIL'
		<isNotEmpty property="codigoCivil">
				AND	MAE_ESTAD_CIVIL.COD_ESTA_CIVI = #codigoCivil#	
		</isNotEmpty>
		<isNotEmpty property="descripcionCivil">
			AND UPPER(GEN_I18N_SICC_COMUN.VAL_I18N) LIKE '%'||UPPER(#descripcionCivil#)||'%'
		</isNotEmpty>
   	</select>
   	
   	<resultMap id="EstadoCivilResultMap" class="estadoCivilMap">
   		<result property="oidEstadoCivil"			column="OID_ESTA_CIVI" 	/>
    	<result property="codigo" 						column="COD_ESTA_CIVI"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    </resultMap> 

   	<select id="getObtieneEstadoCivil" parameterClass="map" resultMap="EstadoCivilResultMap">   	
	 SELECT OID_ESTA_CIVI,
               COD_ESTA_CIVI,
               VAL_I18N AS DESCRIPCION
      FROM GEN_I18N_SICC_COMUN,
          SEG_IDIOM ,
          MAE_ESTAD_CIVIL
      WHERE  GEN_I18N_SICC_COMUN.VAL_OID = MAE_ESTAD_CIVIL.OID_ESTA_CIVI
          AND GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
          AND GEN_I18N_SICC_COMUN.ATTR_ENTI = 'MAE_ESTAD_CIVIL'
          AND  MAE_ESTAD_CIVIL.OID_ESTA_CIVI = #oidEstadoCivil#
	
	</select>
   	
   	
   	<select id="getExisteEstadoCivil" parameterClass="estadoCivilMap" resultClass="string">   	
		SELECT COD_ESTA_CIVI
		FROM MAE_ESTAD_CIVIL 
		WHERE COD_ESTA_CIVI = #codigo#

   	</select>
   	
   	
   	
   	
   	
   	<insert id="insertTipoDocumento" parameterClass="tipoDocumentoMap">
		INSERT INTO MAE_TIPO_DOCUM (OID_TIPO_DOCU,PAIS_OID_PAIS,COD_TIPO_DOCU,IND_OBLI,VAL_SIGL,VAL_LONG,IND_DNI,IND_DOC_IDEN_FISC,IND_ACTI,TIDO_OID_TIPO_DOCU)
            VALUES(#oidTipoDoc#,#codigoPais#,#codigo#,#obligatorio#,#siglas#,#longitud#,#dni#,#fiscal#,#estado#,#tipoDocu#)

   	</insert>
   	
   	<select id="getOidObtieneTipoDocumento" resultClass="string">
   		SELECT MAE_TDOC_SEQ.NEXTVAL FROM  DUAL
   	</select>
   	
   	<update id="updateTipoDocumento" parameterClass="tipoDocumentoMap"> 
   	
   		UPDATE MAE_TIPO_DOCUM SET IND_OBLI = #obligatorio#,
                          VAL_SIGL = #siglas#,
                          VAL_LONG = #longitud#,
                          IND_DNI = #dni#,
                          IND_DOC_IDEN_FISC = #fiscal#,
                          IND_ACTI = #estado#,
                          TIDO_OID_TIPO_DOCU = #tipoDocu#,
                          COD_TIPO_DOCU = #codigo#
       WHERE OID_TIPO_DOCU = #oidTipoDoc#
   	</update>
   	
   	<resultMap id="TipoDocumentoGridResultMap" class="java.util.HashMap">
    	<result property="oidTipoDoc"			column="OID_TIPO_DOCU" 	/>
    	<result property="codigo" 						column="COD_TIPO_DOCU"/>
    	<result property="obligatorio" 				column="IND_OBLI"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="siglas" 				column="SIGLAS"/>
    	<result property="longitud" 				column="LONGITUD"/>
    	<result property="dni" 				column="IND_DNI"/>
    	<result property="fiscal" 				column="IND_FISCAL"/>
    	<result property="tipoDocumento" 				column="DES_TIPO_DOCU"/>
    	<result property="estado" 				column="ESTADO"/>
    </resultMap>  
   	
   	<select id="getTipoDocumentoGrid" parameterClass="map" resultMap="TipoDocumentoGridResultMap">
		   		
  	  SELECT MAE_TIPO_DOCUM.OID_TIPO_DOCU,
               MAE_TIPO_DOCUM.COD_TIPO_DOCU,
               DECODE(MAE_TIPO_DOCUM.Ind_OBLI, '1', 'SI', 'NO') IND_OBLI,
               VAL_I18N AS DESCRIPCION,
               MAE_TIPO_DOCUM.VAL_SIGL AS SIGLAS,
               MAE_TIPO_DOCUM.VAL_LONG AS LONGITUD, 
               DECODE(MAE_TIPO_DOCUM.Ind_Dni, '1', 'SI', 'NO') IND_DNI,
               DECODE(MAE_TIPO_DOCUM.IND_DOC_IDEN_FISC, '1', 'SI', 'NO') IND_FISCAL,
               FAC_TIPO_DOCUM.DES_TIPO_DOCU,
               DECODE(MAE_TIPO_DOCUM.IND_ACTI, '1', 'ACTIVO', 'INACTIVO')  as ESTADO         
      FROM GEN_I18N_SICC_PAIS,
          SEG_IDIOM ,
          MAE_TIPO_DOCUM,
          FAC_TIPO_DOCUM
      WHERE  GEN_I18N_SICC_PAIS.VAL_OID = MAE_TIPO_DOCUM.OID_TIPO_DOCU
          AND GEN_I18N_SICC_PAIS.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
          AND GEN_I18N_SICC_PAIS.ATTR_ENTI = 'MAE_TIPO_DOCUM'
          AND MAE_TIPO_DOCUM.TIDO_OID_TIPO_DOCU = FAC_TIPO_DOCUM.OID_TIPO_DOCU
		<isNotEmpty property="codigoTDOC">
				AND	MAE_TIPO_DOCUM.COD_TIPO_DOCU = #codigoTDOC#	
		</isNotEmpty>
		<isNotEmpty property="siglasTDOC">
				AND	UPPER(MAE_TIPO_DOCUM.VAL_SIGL) LIKE '%'||UPPER(#siglasTDOC#)||'%'
		</isNotEmpty>
		<isNotEmpty property="descripcionTDOC">
			AND UPPER(GEN_I18N_SICC_PAIS.VAL_I18N) LIKE '%'||UPPER(#descripcionTDOC#)||'%'
		</isNotEmpty>
   	</select>
   	
   	<resultMap id="TipoDocumentoResultMap" class="tipoDocumentoMap">
   		<result property="oidTipoDoc"			column="OID_TIPO_DOCU" 	/>
    	<result property="codigo" 						column="COD_TIPO_DOCU"/>
    	<result property="obligatorio" 				column="IND_OBLI"/>
    	<result property="descripcion" 				column="DESCRIPCION"/>
    	<result property="siglas" 				column="SIGLAS"/>
    	<result property="longitud" 				column="LONGITUD"/>
    	<result property="dni" 				column="IND_DNI"/>
    	<result property="fiscal" 				column="IND_FISCAL"/>
    	<result property="tipoDocu" 				column="TIPODOCUMENTO"/>
    	<result property="estado" 				column="ESTADO"/>
    </resultMap> 

   	<select id="getObtieneTipoDocumento" parameterClass="map" resultMap="TipoDocumentoResultMap">   	
	 SELECT MAE_TIPO_DOCUM.OID_TIPO_DOCU,
               MAE_TIPO_DOCUM.COD_TIPO_DOCU,
               MAE_TIPO_DOCUM.IND_OBLI,
               VAL_I18N AS DESCRIPCION,
               MAE_TIPO_DOCUM.VAL_SIGL AS SIGLAS,
               MAE_TIPO_DOCUM.VAL_LONG AS LONGITUD, 
               MAE_TIPO_DOCUM.IND_DNI,
               MAE_TIPO_DOCUM.IND_DOC_IDEN_FISC AS IND_FISCAL,
               FAC_TIPO_DOCUM.OID_TIPO_DOCU as TIPODOCUMENTO,
               MAE_TIPO_DOCUM.IND_ACTI as ESTADO         
      FROM GEN_I18N_SICC_PAIS,
          SEG_IDIOM ,
          MAE_TIPO_DOCUM,
          FAC_TIPO_DOCUM
      WHERE  GEN_I18N_SICC_PAIS.VAL_OID = MAE_TIPO_DOCUM.OID_TIPO_DOCU
          AND GEN_I18N_SICC_PAIS.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO
          AND GEN_I18N_SICC_PAIS.ATTR_ENTI = 'MAE_TIPO_DOCUM'
          AND MAE_TIPO_DOCUM.TIDO_OID_TIPO_DOCU = FAC_TIPO_DOCUM.OID_TIPO_DOCU
          AND  MAE_TIPO_DOCUM.OID_TIPO_DOCU = #oidTipoDoc#	
	</select>
   	
   	
   	<select id="getExisteTipoDocumento" parameterClass="tipoDocumentoMap" resultClass="string">   	
		SELECT COD_TIPO_DOCU
		FROM MAE_TIPO_DOCUM 
		WHERE COD_TIPO_DOCU = #codigo#
   	</select> 	 	








   	<insert id="insertCriteriosBusqueda" parameterClass="criterioBusquedaMap">
		INSERT INTO MAE_CRITE_BUSQU (OID_CRIT_BUSQ,PAIS_OID_PAIS,ATRE_OID_ATRI_ESP1,ATRE_OID_ATRI_ESP2,IND_ACTI)
                     VALUES (#oidCriterioBus#,#codigoPais#,#atributo1#,#atributo2#,#estado#)

   	</insert>
   	
   	<select id="getOidObtieneCriterioBusqueda" resultClass="string">
   		SELECT MAE_CRBU_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<update id="updateCriterioBusqueda" parameterClass="criterioBusquedaMap"> 
   		UPDATE     MAE_CRITE_BUSQU SET ATRE_OID_ATRI_ESP1 = #atributo1#,
                               ATRE_OID_ATRI_ESP2 = #atributo2#,
                               IND_ACTI = #estado#
                           WHERE OID_CRIT_BUSQ = #oidCriterioBus#
   	</update>
   	
   	<resultMap id="CriterioBusquedaGridResultMap" class="java.util.HashMap">
    	<result property="oidCriterioBus"			column="OID_CRIT_BUSQ" 	/>
    	<result property="atributo1" 						column="ATRIBUTO1"/>
    	<result property="atributo2" 				column="ATRIBUTO2"/>
    	<result property="estado" 				column="IND_ACTI"/>
    </resultMap>  
   	
   	<select id="getCriterioBusquedaGrid" parameterClass="map" resultMap="CriterioBusquedaGridResultMap">
		   		
	  	select OID_CRIT_BUSQ ,A.DES_ATRI AS ATRIBUTO1,B.DES_ATRI AS ATRIBUTO2,
	       DECODE(IND_ACTI, '1', 'ACTIVO', 'INACTIVO') IND_ACTI
		from PED_ATRIB_ESPEC A,
		     MAE_CRITE_BUSQU,
		     PED_ATRIB_ESPEC B
		WHERE A.VAL_FORM = 'CLIENTES' AND B.VAL_FORM = 'CLIENTES'
		AND A.OID_ATRI_ESPE = MAE_CRITE_BUSQU.ATRE_OID_ATRI_ESP1
		AND B.OID_ATRI_ESPE = MAE_CRITE_BUSQU.ATRE_OID_ATRI_ESP2
		<isNotEmpty property="atributo1">
				AND	MAE_CRITE_BUSQU.ATRE_OID_ATRI_ESP1 = #atributo1#	
		</isNotEmpty>
		<isNotEmpty property="atributo2">
				AND	MAE_CRITE_BUSQU.ATRE_OID_ATRI_ESP2 = #atributo2#
		</isNotEmpty>
   	</select>
   	
   	<resultMap id="CriterioBusquedaResultMap" class="criterioBusquedaMap">
   		<result property="oidCriterioBus"			column="OID_CRIT_BUSQ" 	/>
    	<result property="atributo1" 						column="ATRIBUTO1"/>
    	<result property="atributo2" 				column="ATRIBUTO2"/>
    	<result property="estado" 				column="IND_ACTI"/>
    </resultMap> 

   	<select id="getObtieneCriterioBusqueda" parameterClass="map" resultMap="CriterioBusquedaResultMap">   	
	   	select OID_CRIT_BUSQ ,ATRE_OID_ATRI_ESP1 AS ATRIBUTO1,ATRE_OID_ATRI_ESP2 AS ATRIBUTO2,
	       	  IND_ACTI
		from PED_ATRIB_ESPEC A,
		     MAE_CRITE_BUSQU,
		     PED_ATRIB_ESPEC B
		WHERE A.VAL_FORM = 'CLIENTES' AND B.VAL_FORM = 'CLIENTES'
		AND A.OID_ATRI_ESPE = MAE_CRITE_BUSQU.ATRE_OID_ATRI_ESP1
		AND B.OID_ATRI_ESPE = MAE_CRITE_BUSQU.ATRE_OID_ATRI_ESP2
        AND  OID_CRIT_BUSQ = #oidCriterioBus#	
	</select>
   	
   	
   	<select id="getExisteCriterioBusqueda" parameterClass="criterioBusquedaMap" resultClass="string">   	
		SELECT OID_CRIT_BUSQ
		FROM MAE_CRITE_BUSQU 
			WHERE ATRE_OID_ATRI_ESP1=#atributo1#
	    AND ATRE_OID_ATRI_ESP2=#atributo2#
	    AND PAIS_OID_PAIS=#codigoPais#
   	</select> 	 	
   	 	 	
   	   	
   	<select id="getCriteriosBusqueda" parameterClass="map" resultMap="baseResult">
		select OID_ATRI_ESPE AS CODIGO,DES_ATRI AS DESCRIPCION 
		from PED_ATRIB_ESPEC
		WHERE VAL_FORM = 'CLIENTES'
   	</select>
   	
   	<select id="getTiposDocumentosListado" parameterClass="map" resultMap="baseResult">
		SELECT OID_TIPO_DOCU AS CODIGO, DES_TIPO_DOCU AS DESCRIPCION FROM FAC_TIPO_DOCUM
   	</select>
   	
   	
   	<insert id="insertDescripcionSiccPais" parameterClass="java.util.Map">
		INSERT INTO gen_i18n_sicc_pais (
   			oid_i18n,
   			attr_enti,
   			attr_num_atri,
   			idio_oid_idio,
   			val_i18n,
   			val_oid
		)
		VALUES(
   			gen_i18n_seq.nextval,
   			#nombreTabla#,
   			#numAtributo#,
   			#oidIdioma#,
   			#valAtributo#,
   			#valOidAtributo#)
	</insert>
	
   	<insert id="updateDescripcionSiccPais" parameterClass="java.util.Map">
		UPDATE gen_i18n_sicc_pais
		SET val_i18n = #valAtributo#
		WHERE attr_enti = #nombreTabla# 
   		AND attr_num_atri = #numAtributo# 
   		AND idio_oid_idio = #oidIdioma#    			
   		AND val_oid = #valOidAtributo# 
	</insert>
	
	<select id="getListPrimerContacto" parameterClass="java.lang.Long" resultMap="primerContactoClienteResult">
				SELECT PC.*
				FROM MAE_CLIEN_PRIME_CONTA	PC
				WHERE PC.CTSU_CLIE_CONT =	#value#
	</select>
	
	<select id="getPrimerContactoOid" parameterClass="java.lang.Long" resultMap="primerContactoClienteResult">
					SELECT PC.*
					FROM MAE_CLIEN_PRIME_CONTA	PC
					WHERE PC.OID_CLIE_PRIM_CONT =	#value#
	</select>	
	
	<select id="getTipoBloqueoList" resultMap="baseResult">
		SELECT MTB.OID_TIPO_BLOQ as codigo,
       		   GEN.VAL_I18N   as descripcion
		  FROM GEN_I18N_SICC_COMUN GEN, SEG_IDIOM IDI, MAE_TIPO_BLOQU MTB
		 WHERE MTB.OID_TIPO_BLOQ = GEN.VAL_OID
		   AND GEN.ATTR_ENTI = 'MAE_TIPO_BLOQU'
		   AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		   AND IDI.COD_ISO_IDIO = #codigoIdioma#
		   AND MTB.IND_ACTI = '1'   	
   	</select>	
   	
   	<select id="getProcesoBloqueoList" resultMap="baseResult">
		select mpb.oid_proc_bloq codigo, 
		       mpb.des_proc_bloq descripcion
  	      from MAE_PROCE_BLOQU mpb 	
   	</select>
   	
   	<select id="getAccionBloqueoList" resultMap="baseResult">
		select mab.oid_acci_bloq codigo, 
		       mab.des_acci_bloq descripcion
  	      from MAE_ACCIO_BLOQU mab
  	     <isNotEmpty property="oidProcesoBloqueo">
			where mab.mapb_oid_proc_bloq = #oidProcesoBloqueo# 
		</isNotEmpty>
   	</select>
   	
   	<select id="getOidAccionesProcesoBloqueo" resultClass="string">
   		SELECT MAE_MPBL_SEQ.NEXTVAL FROM DUAL
   	</select>
   	
   	<insert id="insertAccionesProcesoBloqueo" parameterClass="accionesProcesoBloqueo">
		insert into MAE_ACCIO_PROCE_BLOQU
			  (OID_ACCI_PROC_BLOQ,
			   MAPB_OID_PROC_BLOQ,
			   TIBQ_OID_TIPO_BLOQ,
			   PAIS_OID_PAIS,
			   MABL_OID_ACCI_BLOQ,
			   USU_CREA,
			   FEC_CREA,
			   IND_ACTI)
			values
			  (#oid#, 
			   #oidProcesoBloqueo#, 
			   #oidTipoBloqueo#, 
			   gen_pkg_gener.gen_fn_devuelve_id_pais(#codigoPais#), 
			   #oidAccionBloqueo#, 
			   #auditInfo.createdBy#,
		       #auditInfo.created#,
		       #indicadorEstado#)
   	</insert>
   	
	<update id="updateAccionesProcesoBloqueo" parameterClass="accionesProcesoBloqueo">   	
		UPDATE MAE_ACCIO_PROCE_BLOQU
		SET  
		    MAPB_OID_PROC_BLOQ = #oidProcesoBloqueo#, 
		    TIBQ_OID_TIPO_BLOQ = #oidTipoBloqueo#, 
		    MABL_OID_ACCI_BLOQ = #oidAccionBloqueo#,
		    IND_ACTI = #indicadorEstado#,
	        USU_MODI = #auditInfo.updatedBy#, 
	        FEC_MODI = #auditInfo.lastUpdated# 
		WHERE OID_ACCI_PROC_BLOQ = #oid#   	
   	</update>
   	<resultMap id="accionesProcesoBloqueoResult" class="accionesProcesoBloqueo">
		<result property="oid" 							column="OID_ACCI_PROC_BLOQ"/>
    	<result property="oidProcesoBloqueo" 			column="MAPB_OID_PROC_BLOQ"/>
    	<result property="oidTipoBloqueo" 	 			column="TIBQ_OID_TIPO_BLOQ"/>
    	<result property="oidAccionBloqueo"				column="MABL_OID_ACCI_BLOQ"/>
    	<result property="indicadorEstado" 				column="IND_ACTI"/>
    </resultMap>     	
   	<select id="getAccionesProcesoBloqueo" parameterClass="map" resultMap="accionesProcesoBloqueoResult">
		select OID_ACCI_PROC_BLOQ,
		       MAPB_OID_PROC_BLOQ,
		       TIBQ_OID_TIPO_BLOQ,
		       MABL_OID_ACCI_BLOQ,
		       IND_ACTI
		  from MAE_ACCIO_PROCE_BLOQU
		 where OID_ACCI_PROC_BLOQ = #oid#        
   	</select>
   	
   	<resultMap id="accionesProcesoBloqueoResultMap" class="java.util.HashMap">
    	<result property="oid"						column="OID_ACCI_PROC_BLOQ"/>
    	<result property="oidProcesoBloqueo" 		column="MAPB_OID_PROC_BLOQ"/>
    	<result property="oidTipoBloqueo" 			column="TIBQ_OID_TIPO_BLOQ"/>
    	<result property="oidAccionBloqueo" 			column="MABL_OID_ACCI_BLOQ"/>
    	<result property="indicadorEstado" 		    	column="IND_ACTI"/>
    </resultMap>      	
   	<select id="getAccionesProcesoBloqueoByCriteria" parameterClass="map" resultMap="accionesProcesoBloqueoResultMap">   	
		select OID_ACCI_PROC_BLOQ,
		       (select mpb.des_proc_bloq
		          from MAE_PROCE_BLOQU mpb
		         where mpb.oid_proc_bloq = MAPB_OID_PROC_BLOQ) MAPB_OID_PROC_BLOQ,
		       (SELECT GEN.VAL_I18N
		          FROM GEN_I18N_SICC_COMUN GEN, SEG_IDIOM IDI, MAE_TIPO_BLOQU MTB
		         WHERE MTB.OID_TIPO_BLOQ = GEN.VAL_OID
		           AND GEN.ATTR_ENTI = 'MAE_TIPO_BLOQU'
		           AND GEN.IDIO_OID_IDIO = IDI.OID_IDIO
		           AND IDI.COD_ISO_IDIO = #codigoIdioma#
		           AND MTB.OID_TIPO_BLOQ = TIBQ_OID_TIPO_BLOQ) TIBQ_OID_TIPO_BLOQ,
		       (select mab.des_acci_bloq
		          from MAE_ACCIO_BLOQU mab
		         where mab.mapb_oid_proc_bloq = MAPB_OID_PROC_BLOQ
		           and mab.oid_acci_bloq = MABL_OID_ACCI_BLOQ) MABL_OID_ACCI_BLOQ,
		       nvl(Decode(IND_ACTI, '1', 'ACTIVO', '0', 'INACTIVO'), '') IND_ACTI
		  from MAE_ACCIO_PROCE_BLOQU
		  WHERE 1 = 1		
		<isNotEmpty property="oidTipoBloqueo">
			AND TIBQ_OID_TIPO_BLOQ = #oidTipoBloqueo#
		</isNotEmpty>
		
		<isNotEmpty property="oidProcesoBloqueo">
			AND MAPB_OID_PROC_BLOQ = #oidProcesoBloqueo#
		</isNotEmpty>
		
		<isNotEmpty property="oidAccionBloqueo">
			AND MABL_OID_ACCI_BLOQ = #oidAccionBloqueo#
		</isNotEmpty>
		
		<isNotEmpty property="indicadorEstado">
			AND IND_ACTI = #indicadorEstado#
		</isNotEmpty>		
   	</select>
   	
   	<select id="getExisteOidAccionesProcesoBloqueo" parameterClass="accionesProcesoBloqueo" resultClass="string">   	
		select mapb.OID_ACCI_PROC_BLOQ
		  from MAE_ACCIO_PROCE_BLOQU mapb
		 where mapb.pais_oid_pais =
		       gen_pkg_gener.gen_fn_devuelve_id_pais(#codigoPais#)
		   and mapb.tibq_oid_tipo_bloq = #oidTipoBloqueo#
		   and mapb.mapb_oid_proc_bloq = #oidProcesoBloqueo#	
   	</select>
   		 	
   	<select id="getValidaDocumentoIdentidad" parameterClass="map" resultClass="string">
		select MC.COD_CLIE
		  from MAE_CLIEN_IDENT MCI, MAE_CLIEN MC
		 where MCI.num_docu_iden = #numeroDocumento#
		 AND MCI.CLIE_OID_CLIE = MC.OID_CLIE
		 AND MC.PAIS_OID_PAIS = GEN_PKG_GENER.gen_fn_devuelve_id_pais(#codigoPais#)   	
   		 <isNotEmpty prepend="AND" property="codigoCliente">
			  <![CDATA[
			  		MC.OID_CLIE <> GEN_PKG_GENER.gen_fn_devuelve_id_cliente(#codigoCliente#)
			  ]]>
		   </isNotEmpty>
   	</select>
   	
   	<select id="getSubTiposDocumentoIdentidad" parameterClass="map" resultMap="baseResult">
		select MSD.COD_SUBT_DOCU codigo, 
       		   MSD.DES_SUBT_DOCU descripcion 
	      from MAE_SUBTI_DOCUM MSD
	     WHERE MSD.TDOC_OID_TIPO_DOCU = #oidTipoDocumento#
	</select>
	
	<select id="getMostrarSubTipoDocumentoIdentidad" parameterClass="map" resultClass="string">
		select COUNT(1)
		  from MAE_CLIEN_MODUL
		 where TIP_VALI = #tipoValidacion#
		   and MOD_VALI = #moduloValidacion#
		   and IND_ACTI = #indicadorEstado#
		   and COD_PAIS = #codigoPais#
   	</select>
   	
   	<select id="getEntidadBancoMaeList" parameterClass="map" resultMap="baseResult">
   		SELECT OID_BANC CODIGO,
   			DES_BANC  DESCRIPCION 
   		FROM CCC_BANCO 
   		WHERE PAIS_OID_PAIS=#oidPais#		
	</select>
	
	<select id="getMostrarBancoCuentaCorriente" parameterClass="map" resultClass="string">
		SELECT COUNT(1) 
		FROM MAE_CLIEN_MODUL 
		WHERE IND_ACTI=1 
		AND TIP_VALI='VAL_PAGO_SOC'
		AND MOD_VALI = 'CTA01'
		AND COD_PAIS = #codigoPais#
   	</select>
   	
   	<!-- OBTIENE LOS CODIGOS TERRITORIAL CORRESPONDE -->
    <select id="getCodigosTerritorialCorresponde" parameterClass="java.util.Map" resultMap="baseResult">
  	    SELECT COD_TERR_CORR CODIGO,
		       DES_TERR_CORR DESCRIPCION
		  FROM MAE_TERRI_CORRE
    </select>
    
    <!-- OBTIENE LOS BANCOS -->
    <select id="getBancos" parameterClass="java.util.Map" resultMap="baseResult">
  	    SELECT COD_BANC_PAGA CODIGO,
		       DES_BANC_PAGA DESCRIPCION
		  FROM BAS_BANCO_PAGAD
		 WHERE COD_PAIS = #codigoPais#
    </select>
    
    <!-- OBTIENE LOS TIPOS DE CUENTA -->
    <select id="getTiposCuenta" parameterClass="java.util.Map" resultMap="baseResult">
  	    SELECT COD_TIPO_CUEN CODIGO,
		       DES_TIPO_CUEN DESCRIPCION
		  FROM BAS_TIPO_CUENT
    </select>
    
    <select id="getMostrarTipoCuentaCuentaCorriente" parameterClass="map" resultClass="string">
		SELECT COUNT(1) 
		  FROM MAE_CLIEN_MODUL 
		 WHERE IND_ACTI = 1 
		   AND TIP_VALI = 'VAL_PAGO_SOC2'
		   AND MOD_VALI = 'CTA02'
		   AND COD_PAIS = #codigoPais#
   	</select>
	
</sqlMap>
