<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.ProcesosPEJSQL">
	<typeAlias alias="baseGenerico" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>

	<typeAlias alias="consultoraNivel1" type="biz.belcorp.ssicc.dao.spusicc.pej.model.ConsultoraNivel1"/>
	<typeAlias alias="metaEjecutivaIngresosPedidos" type="biz.belcorp.ssicc.dao.spusicc.pej.model.MetaEjecutivaIngresosPedidos"/>
	<typeAlias alias="nivelEjecutiva" type="biz.belcorp.ssicc.dao.spusicc.pej.model.NivelEjecutiva"/>
	<typeAlias alias="porcentajeComisionesCabecera" type="biz.belcorp.ssicc.dao.spusicc.pej.model.PorcentajeComisionesCabecera"/>
	<typeAlias alias="porcentajeComisionesDetalle" type="biz.belcorp.ssicc.dao.spusicc.pej.model.PorcentajeComisionesDetalle"/>
	<typeAlias alias="canasta" type="biz.belcorp.ssicc.dao.spusicc.pej.model.Canasta"/>
	
	<typeAlias alias="programaEjecutiva" type="biz.belcorp.ssicc.dao.spusicc.pej.model.ProgramaEjecutiva"/>
	<typeAlias alias="fase" type="biz.belcorp.ssicc.dao.spusicc.pej.model.Fase"/>
	<typeAlias alias="nivelPEJ" type="biz.belcorp.ssicc.dao.spusicc.pej.model.Nivel"/>
	<typeAlias alias="rango" type="biz.belcorp.ssicc.dao.spusicc.pej.model.Rango"/>
	<typeAlias alias="grupoPEJ" type="biz.belcorp.ssicc.dao.spusicc.pej.model.Grupo"/>
	<typeAlias alias="porcentaje" type="biz.belcorp.ssicc.dao.spusicc.pej.model.Porcentaje"/>
	<typeAlias alias="tipoAbono" type="biz.belcorp.ssicc.dao.spusicc.pej.model.TipoAbono"/>
	
	<resultMap id="nivelListResult" class="nivelEjecutiva"> 
		<result property="codigoPais"		   column ="COD_PAIS"/>		                     			
		<result property="codigoNivel"		   column ="COD_NIVE"/>
		<result property="descripcionNivel"	   column ="DES_NIVE"/>
		<result property="pedidoPromedioDesde" column ="PED_PROM_DESD"/>
		<result property="pedidoPromedioHasta" column ="PED_PROM_HAST"/>
		<result property="incrementoPedido"    column ="INC_PEDI"/>
	</resultMap>
	
	<resultMap id="porcentajeComisionesCabeceraResult" class="porcentajeComisionesCabecera">
		<result property="codigoPais"       column="COD_PAIS"/>
		<result property="codigoPorcentaje" column="COD_PORC"/>
		<result property="codigoMarca"      column="COD_MARC"/>
		<result property="codigoCanal"      column="COD_CANA"/>
		<result property="campaniaDesde"    column="CAM_DESD"/>
		<result property="campaniaHasta"    column="CAM_HAST"/>
	</resultMap>
	
	<resultMap id="porcentajeComisionesDetalleResult" class="porcentajeComisionesDetalle">
		<result property="codigoPorcentaje" column="COD_PORC"/>
		<result property="codigoNivel"      column="COD_NIVE"/>
		<result property="numeroNivel"      column="NUM_NIVE"/>
		<result property="montoDesde"       column="IMP_MONT_DESD"/>
		<result property="montoHasta"       column="IMP_MONT_HAST"/>
		<result property="valorPorc"        column="VAL_PORC_COMI"/>
		<result property="descripcionNivel" column="DES_NIVE"/>
	</resultMap>
	
	<resultMap id="genericResult" class="java.util.HashMap">
		<result property="codigo"      column="CODIGO"/>
		<result property="descripcion" column="DESCRIPCION"/>
	</resultMap>
	
	<resultMap id="getCanastasResult" class="java.util.HashMap">
		<result property="codigoPais"       column="COD_PAIS"/>
		<result property="campanhaDespacho" column="CAM_DESP"/>
		<result property="codigoVenta"      column="COD_VENT"/>
	</resultMap>
	
	<resultMap id="canastaResult" class="canasta">
		<result property="codigoPais"    column="COD_PAIS"/>
		<result property="codigoPeriodo" column="CAM_DESP"/>
		<result property="codigoVenta"   column="COD_VENT"/>
	</resultMap>
	
	<resultMap id="programasResult" class="java.util.HashMap">
		<result property="codigoPrograma"  column="COD_PROG_EJEC"/>
		<result property="codigoPais"          	column="PAIS_COD_PAIS"/>
		<result property="descripcion"         	column="DES_PROG_EJEC"/>
		<result property="campanyaInicio"	column="COD_CAMP_INIC"/>
		<result property="campanyaFinal"  	column="COD_CAMP_FINA"/>
		<result property="campanyaEtapa"  column="NUM_ETAP_FASE"/>
		<result property="estado"   				column="IND_ACTI"/>
	</resultMap>
	
	<select id="getNivelList" parameterClass="string" resultMap="nivelListResult">
		SELECT COD_PAIS, 
			COD_NIVE, 
			DES_NIVE,
			PED_PROM_DESD,
			PED_PROM_HAST,
			INC_PEDI
		FROM PEJ_NIVEL_EJECU 
		WHERE COD_PAIS = #codigoPais#
	</select>
	
	<select id="getExisteCliente" parameterClass="java.lang.String" resultClass="integer">
		 SELECT COUNT(1)
		 FROM mae_clien a
		 WHERE a.cod_clie = #value#
	</select>
	
	<select id="getExisteZona" parameterClass="java.lang.String" resultClass="integer">
		SELECT COUNT(1)
		FROM ZON_ZONA z
		WHERE z.COD_ZONA = #value#
		AND   IND_ACTI = 1
	</select>
	
	<select id="getExisteSeccionByZona" parameterClass="java.util.Map" resultClass="integer"> 
		SELECT COUNT(1) 
		FROM  ZON_SECCI se,
		      ZON_ZONA zo
		WHERE zo.oid_zona = se.zzon_oid_zona
		AND   zo.cod_zona = #codigoZona#
		AND   se.COD_SECC = #codigoSeccion#
	</select>
	
	<select id="getExisteCampInicialFinal" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1) 
		FROM  PEJ_ETAPA_EJECU
		WHERE CAM_INIC = #campIncial#
		AND   CAM_FINA = #campFinal#
	</select>
	
	<select id="getProgramasByCriteria" parameterClass="java.util.Map" resultMap="programasResult">
        SELECT
		COD_PROG_EJEC,
		PAIS_COD_PAIS,
		DES_PROG_EJEC,
		COD_CAMP_INIC,
		COD_CAMP_FINA,
		NUM_ETAP_FASE,
		IND_ACTI
        FROM EJE_PROGR
        WHERE EST_REGI = '1'
		<isNotEmpty prepend="AND" property="codigoPais">
	 		PAIS_COD_PAIS = #codigoPais#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoPrograma">
	 		COD_PROG_EJEC = #codigoPrograma#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="descripcion">
	 		DES_PROG_EJEC LIKE UPPER(#descripcion#)
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="estado">
	 		IND_ACTI = #estado#
		</isNotEmpty>		
        ORDER BY COD_PROG_EJEC
    </select>
	
	<insert id="insertConsultoraNivel1" parameterClass="consultoraNivel1">
		INSERT INTO PEJ_CONSU_PRIME_NIVEL
		(COD_PAIS,
		 COD_ETAP,
		 COD_CLIE,
		 USU_DIGI,
		 FEC_DIGI
		)VALUES
		(#codigoPais#,
		 #codigoEtapa#,
		 #codigoCliente#,
		 #usuarioDigitacion#,
		 sysdate)
	</insert>
	
	<delete id="deleteCargaConsultorasNivel1ByEtapa" parameterClass="java.util.Map">
		DELETE FROM PEJ_CONSU_PRIME_NIVEL
		WHERE COD_PAIS = #codigoPais#
		AND   COD_ETAP = #codigoEtapa#
	</delete>
	
	<delete id="deleteTempoMetaIngresosPedidos">
		DELETE FROM PEJ_TEMPO_METAS_EJECU_CABEC
	</delete>
	
	<insert id="saveTempoMetaIngresosPedidos" parameterClass="metaEjecutivaIngresosPedidos">
		INSERT INTO PEJ_TEMPO_METAS_EJECU_CABEC
		(COD_PAIS,
	     ANO_INCI,
		 COD_ETAP,
		 COD_EJEC,
		 COD_ZONA,
		 COD_SECC,
		 CAM_INIC,
		 CAM_FINA,
		 MET_PEDI,
		 MET_INGR_CAMP,
		 MET_INGR_BI_CAMP,
		 USU_DIGI,
		 FEC_DIGI
		)VALUES
		(#codigoPais#,
		 #anioInicio#,
		 #codigoEtapa#,
		 #codigoCliente#,
		 #codigoZona#,
		 #codigoSeccion#,
		 #periodoInicial#,
		 #periodoFinal#,
		 #metaPedidos#,
		 #metaIngresosCampaña#,
		 #metaIngresosBiCampaña#,
		 #usuarioDigitacion#,
		 sysdate)
	</insert>
	
	<parameterMap id="executeCargaMetaIngresosPedidosParams" class="map" >
		<parameter property="codigoPais"              	jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="anioInicial"	   			jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
  		<parameter property="codigoEtapa"	            jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
  	</parameterMap>
	
	<procedure id="executeCargaMetaIngresosPedidos" parameterMap="executeCargaMetaIngresosPedidosParams">
		{call PEJ_PKG_PROCE.PEJ_PR_PROCE_CARGA_META_INGRE(?,?,?)}
	</procedure>
	
	<select id="getPorcentajesComisionesList" parameterClass="java.util.Map" resultMap="porcentajeComisionesCabeceraResult">
			SELECT A.COD_PAIS,
			       A.CAM_DESD,
			       A.CAM_HAST,
			       A.COD_PORC,
			       A.COD_MARC,
			       A.COD_CANA
			FROM PEJ_PORCE_COMIS_CABEC A
			WHERE A.COD_PAIS = #codigoPais#
		  	<isNotEmpty prepend="AND" property="codigoPorcentaje">
			      A.COD_PORC = #codigoPorcentaje#
			</isNotEmpty>		
	</select>
	
	<select id="getPorcentajeComisionDetalleList" parameterClass="porcentajeComisionesCabecera" resultMap="porcentajeComisionesDetalleResult">
		SELECT  C.COD_PORC,
				C.COD_NIVE,
		        C.NUM_NIVE,
		        C.IMP_MONT_DESD,
		        C.IMP_MONT_HAST,
		        C.VAL_PORC_COMI,
		        B.DES_NIVE
		   FROM PEJ_NIVEL_EJECU B,
		        PEJ_PORCE_COMIS_DETAL C
		  WHERE C.COD_NIVE = B.COD_NIVE
		  <isNotEmpty prepend="AND" property="codigoPorcentaje">
		      C.COD_PORC = #codigoPorcentaje#
		  </isNotEmpty>
          ORDER BY COD_NIVE, IMP_MONT_DESD	
	</select>
	
	<update id="updatePorcentajeComisionCabeceraAndDetalle" parameterClass="porcentajeComisionesCabecera">
		UPDATE PEJ_PORCE_COMIS_CABEC
        SET CAM_DESD = #campaniaDesde#,
            CAM_HAST = #campaniaHasta#
        WHERE COD_PAIS = #codigoPais#
          AND COD_PORC = #codigoPorcentaje#
          AND COD_MARC = #codigoMarca#
          AND COD_CANA = #codigoCanal#
    </update>
    
    <select id="getSecuenciaNextValue" resultClass="string">
    	SELECT LPAD(PPCC_SEQ.NEXTVAL,5,'0') FROM DUAL
    </select>
    
    <insert id="insertPorcentajeComisionCabecera" parameterClass="porcentajeComisionesCabecera">
		   INSERT INTO PEJ_PORCE_COMIS_CABEC   
		     (COD_PAIS,
		      COD_PORC,
		      COD_MARC,
		      COD_CANA,
		      CAM_DESD,
		      CAM_HAST,
		      USU_DIGI,
		      FEC_DIGI)
		   VALUES
		     (#codigoPais#,
		      #codigoPorcentaje#,
		      #codigoMarca#,
		      #codigoCanal#,
		      #campaniaDesde#,
		      #campaniaHasta#,
		      #usuario#,
		      sysdate)
	</insert>
	
	<insert id="insertPorcentajeComisionDetalle" parameterClass="porcentajeComisionesDetalle"> 
	    INSERT INTO PEJ_PORCE_COMIS_DETAL
	        (COD_PORC,
	         COD_NIVE,
	         NUM_NIVE,
	         IMP_MONT_DESD,
	         IMP_MONT_HAST,
	         VAL_PORC_COMI)
	      VALUES
	        (#codigoPorcentaje#,
	         #codigoNivel#,
	         #numeroNivel#,
	         TO_NUMBER(#montoDesde#,'99999999999.99'),
	         TO_NUMBER(#montoHasta#,'99999999999.99'),
	         TO_NUMBER(#valorPorc#,'999999.99'))
    </insert>
    
    <select id="getMaximoNumeroNivel" parameterClass="java.util.Map" resultClass="integer" >
		select nvl(max(NUM_NIVE),0)+1
		from PEJ_PORCE_COMIS_DETAL 
		WHERE COD_PORC = #codigoPorcentaje# 
        AND COD_NIVE = #codigoNivel# 
   </select>  
   
   <update id="updatePorcentajeComisionDetalle" parameterClass="porcentajeComisionesDetalle">
       UPDATE PEJ_PORCE_COMIS_DETAL
       SET IMP_MONT_DESD = TO_NUMBER(#montoDesde#,'99999999999.99'),
           IMP_MONT_HAST = TO_NUMBER(#montoHasta#,'99999999999.99'),
           VAL_PORC_COMI = TO_NUMBER(#valorPorc#,'999999.99')
       WHERE COD_PORC = #codigoPorcentaje#
       AND COD_NIVE = #codigoNivel#
       AND NUM_NIVE = #numeroNivel#
  	</update>
  	
  	<delete id="deletePorcentajeComisionDetal" parameterClass="porcentajeComisionesDetalle">
		DELETE FROM PEJ_PORCE_COMIS_DETAL
		WHERE COD_PORC = #codigoPorcentaje#
		AND   COD_NIVE = #codigoNivel#
		AND   NUM_NIVE = #numeroNivel#
	</delete>
	
	<delete id="deletePorcentajeComisionDetalle" parameterClass="porcentajeComisionesCabecera">
		DELETE FROM PEJ_PORCE_COMIS_DETAL
		WHERE COD_PORC = #codigoPorcentaje#
	</delete>
	
	<delete id="deletePorcentajeComisionCabecera" parameterClass="porcentajeComisionesCabecera">
		DELETE FROM PEJ_PORCE_COMIS_CABEC
		WHERE COD_PAIS = #codigoPais#
		AND   COD_PORC = #codigoPorcentaje#
	</delete>
	
	<select id="getNivelesList" parameterClass="java.util.Map" resultMap="nivelListResult">
		SELECT COD_PAIS,
		       COD_NIVE,
		       DES_NIVE,
		       PED_PROM_DESD,
		       PED_PROM_HAST,
		       INC_PEDI
		FROM  PEJ_NIVEL_EJECU
		WHERE COD_PAIS = #codigoPais#
		<isNotEmpty prepend="AND" property="codigoNivel">
	      COD_NIVE = #codigoNivel#
	    </isNotEmpty>	
	</select>
	
	<delete id="deleteNivelesEjecutivas" parameterClass="java.util.Map">
		DELETE FROM PEJ_NIVEL_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND   COD_NIVE = #codigoNivel#
	</delete>
	
	<select id="getNivelEjecutiva" parameterClass="java.util.Map" resultMap="nivelListResult">
		SELECT COD_PAIS,
		       COD_NIVE,
		       DES_NIVE,
		       PED_PROM_DESD,
		       PED_PROM_HAST,
		       INC_PEDI
		FROM   PEJ_NIVEL_EJECU
		WHERE  COD_PAIS = #codigoPais#
		AND    COD_NIVE = #codigoNivel#
	</select>
	
	<insert id="insertNivelEjecutiva" parameterClass="nivelEjecutiva">
		INSERT INTO PEJ_NIVEL_EJECU(
		COD_PAIS,
		COD_NIVE,
		DES_NIVE,
		PED_PROM_DESD,
		PED_PROM_HAST,
		INC_PEDI)
		VALUES(
		#codigoPais#,
		#codigoNivel#,
		#descripcionNivel#,
		#pedidoPromedioDesde#,
		#pedidoPromedioHasta#,
		#incrementoPedido#)
	</insert>
	
	<update id="updateNivelEjecutiva" parameterClass="nivelEjecutiva">
		UPDATE PEJ_NIVEL_EJECU
		SET DES_NIVE = #descripcionNivel#,
		    PED_PROM_DESD = #pedidoPromedioDesde#,
		    PED_PROM_HAST = #pedidoPromedioHasta#,
		    INC_PEDI = #incrementoPedido#
		WHERE COD_PAIS = #codigoPais#
		AND   COD_NIVE = #codigoNivel#
	</update>
	
	<parameterMap id="executeProcesoPEJCalculoVariablesSeccionCampañaParams" class="map">
		<parameter property="codigoPais"    jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoRegion"  jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeProcesoPEJCalculoVariablesSeccionCampaña" parameterMap="executeProcesoPEJCalculoVariablesSeccionCampañaParams">
		{call PEJ_PKG_PROCE.PEJ_PR_PROCE_CALCU_VARIA_SECCI(?,?,?,?,?,?)}
	</procedure>
	
	<select id="validarRegionProcesada" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1)
		FROM PEJ_CALCU_EJECU_CAMPA
		WHERE COD_PAIS = #codigoPais#
		AND   COD_PERI = #codigoPeriodo#
		AND   COD_REGI = #codigoRegion#
	</select>
	
	<select id="getEtapas" resultMap="genericResult">
		select COD_ETAP_EJEC as CODIGO, 
               COD_ETAP_EJEC || ' ' ||'(' || CAM_INIC || ' - ' || CAM_FINA || ')' as DESCRIPCION
		from pej_etapa_ejecu
	</select>
	
	<select id="validaEtapaProcesada" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1)
		FROM PEJ_NIVEL_EJECU_ETAPA
		WHERE COD_PAIS = #codigoPais#
		AND   ANO_INIC = #anioInicial#
		AND   COD_ETAP = #nroEtapa#
	</select>
	
	<parameterMap id="executeProcesoPEJGraduacionParams" class="map">
		<parameter property="codigoPais"    jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="anioInicial"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nroEtapa"      jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeProcesoPEJGraduacion" parameterMap="executeProcesoPEJGraduacionParams">
		{call PEJ_PKG_PROCE.PEJ_PR_PROCE_GRADU(?,?,?,?,?)}
	</procedure>
	
	<select id="validaCodigoVenta" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1)
		FROM pre_ofert ofe,
		     pre_ofert_detal ofedet,
		     pre_matri_factu mf,
		     pre_matri_factu_cabec mfc,
		     mae_produ prod,
		     (SELECT v.val_oid, v.val_i18n
		      FROM v_gen_i18n_sicc v
		      WHERE v.attr_enti = 'MAE_PRODU' 
		      AND v.idio_oid_idio = 1) i18prod
		WHERE mfc.perd_oid_peri = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA('T'),GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL('VD'))
		AND mf.mfca_oid_cabe = mfc.oid_cabe
		AND ofe.mfca_oid_cabe = mfc.oid_cabe
		AND ofe.oid_ofer = ofedet.ofer_oid_ofer
		AND ofedet.oid_deta_ofer = mf.ofde_oid_deta_ofer
		AND ofedet.val_codi_vent = #codigoVenta#
		AND ofedet.prod_oid_prod = prod.oid_prod
		AND prod.oid_prod = i18prod.val_oid
	</select>
	
	<select id="getCanastasList" parameterClass="java.util.Map" resultMap="getCanastasResult">
		SELECT COD_PAIS,CAM_DESP, COD_VENT
		FROM PEJ_CANAS_EJECU
		WHERE COD_PAIS = #codigoPais#
		<isNotEmpty prepend="AND" property="codigoPeriodo">
			CAM_DESP = #codigoPeriodo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="codigoVenta">
	    	COD_VENT = #codigoVenta#
	    </isNotEmpty>
	</select>
	
	<delete id="deleteCanastas" parameterClass="java.util.Map">
		DELETE FROM PEJ_CANAS_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND   CAM_DESP = #campanhaDespacho#
		AND   COD_VENT = #codigoVenta#
	</delete>
	
	<select id="getCanasta" parameterClass="java.util.Map" resultMap="canastaResult">
		SELECT COD_PAIS,CAM_DESP,COD_VENT
		FROM PEJ_CANAS_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND   CAM_DESP = #campanhaDespachoId#
		AND   COD_VENT = #codigoVentaId#
	</select>
	
	<insert id="inserCanasta" parameterClass="canasta">
		INSERT INTO PEJ_CANAS_EJECU(
		COD_PAIS,
		CAM_DESP,
		COD_VENT,
		USU_DIGI,
		FEC_DIGI)
		VALUES(
		#codigoPais#,
		#codigoPeriodo#,
		#codigoVenta#,
		#usuarioDigitador#,
		sysdate)
	</insert>
	
	<update id="updateCanasta" parameterClass="canasta">
		UPDATE PEJ_CANAS_EJECU
		SET CAM_DESP = #codigoPeriodo#,
		    COD_VENT = #codigoVenta#,
		    USU_ACTU = #usuarioActulizador#,
		    FEC_ACTU = sysdate
		WHERE COD_PAIS = #codigoPais#
		AND   CAM_DESP = #codigoPeriodoAnterior#
		AND   COD_VENT = #codigoVentaAnterior#  
	</update>
	
	<select id="validaCodigoVentaDuplicadoCamp" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1)
		FROM PEJ_CANAS_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND   CAM_DESP = #codigoPeriodo#
		AND   COD_VENT = #codigoVenta# 
	</select>
	
	<select id="validaOfertaDigitable" parameterClass="java.util.Map" resultClass="integer">
		SELECT IND_DIGI
		FROM pre_ofert ofe,
		     pre_ofert_detal ofedet,
		     pre_matri_factu mf,
		     pre_matri_factu_cabec mfc,
		     mae_produ prod,
		     (SELECT v.val_oid, v.val_i18n
		      FROM v_gen_i18n_sicc v
		      WHERE v.attr_enti = 'MAE_PRODU' 
		      AND v.idio_oid_idio = 1) i18prod
		WHERE mfc.perd_oid_peri = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA('T'),GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL('VD'))
		AND mf.mfca_oid_cabe = mfc.oid_cabe
		AND ofe.mfca_oid_cabe = mfc.oid_cabe
		AND ofe.oid_ofer = ofedet.ofer_oid_ofer
		AND ofedet.oid_deta_ofer = mf.ofde_oid_deta_ofer
		AND ofedet.val_codi_vent = #codigoVenta#
		AND ofedet.prod_oid_prod = prod.oid_prod
		AND prod.oid_prod = i18prod.val_oid
	</select>
	
	<select id="validaRegionComisionCalculada" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1)
		FROM PEJ_COMIS_CABEC
		WHERE COD_PAIS = #codigoPais#
		AND   COD_REGI = #codigoRegion#
		AND   COD_PERI = #codigoPeriodo#
	</select>
	
	<parameterMap id="executeProcesoPEJCalculaComisionRecuperacionParams" class="map">
		<parameter property="codigoPais"    jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoRegion"  jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoUsuario" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeProcesoPEJCalculaComisionRecuperacion" parameterMap="executeProcesoPEJCalculaComisionRecuperacionParams">
		{call PEJ_PKG_PROCE.PEJ_PR_CALCU_COMIC_RECUP(?,?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="executeProcesoPEJCargaTarjetaPaycardParams" class="map">
		<parameter property="codigoPais"    jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoUsuario" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeProcesoPEJCargaTarjetaPaycard" parameterMap="executeProcesoPEJCargaTarjetaPaycardParams">
		{call PEJ_PKG_PROCE.PEJ_PR_PROCE_CARGA_TARJE_PAYCA(?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="executeProcesoPEJDespachoCanastasParams" class="map">
		<parameter property="codigoPais"    jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoUsuario" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeProcesoPEJDespachoCanastas" parameterMap="executeProcesoPEJDespachoCanastasParams">
		{call PEJ_PKG_PROCE.PEJ_PR_DESPA_CANAS(?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="executeProcesoPEJRecuperacionComisionParams" class="map">
		<parameter property="codigoPais"    jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="anioInicial"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nroEtapa"      jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeProcesoPEJRecuperacionComision" parameterMap="executeProcesoPEJRecuperacionComisionParams">
		{call PEJ_PKG_PROCE.PEJ_PR_RECUP_COMIS(?,?,?,?,?)}
	</procedure>
	
	<parameterMap id="executeProcesoPEJGeneracionBonosParams" class="map">
		<parameter property="codigoPais"    jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="anioInicial"   jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nroEtapa"      jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario" jdbcType="VARCHAR2" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeProcesoPEJGeneracionBonos" parameterMap="executeProcesoPEJGeneracionBonosParams">
		{call PEJ_PKG_PROCE.PEJ_PR_GENER_BONOS(?,?,?,?,?,?)}
	</procedure>
	
	<resultMap id="getProgramaEjecutivasResult" class="java.util.HashMap">
		<result property="codigoEjecutiva"       column="COD_EJEC"/>
		<result property="codigoEtapa"           column="COD_ETAP"/>
		<result property="nombreEjecutiva"       column="NOM_EJEC"/>
		<result property="codigoPeriodo"         column="COD_PERI"/>
		<result property="montoPagado"           column="IMP_MONT_PAGA"/>
		<result property="montoPaycard"          column="IMP_MONT_PAYC"/>
		<result property="montoCanasta"          column="IMP_MONT_CANA"/>
		<result property="indicadorComision"     column="IND_COMI"/>
		<result property="indicadorPedido"       column="IND_PEDI"/>
		<result property="indicadorPago"         column="IND_PAGO"/>
	</resultMap>
	
	<select id="getProgramaEjecutivasList" parameterClass="java.util.Map" resultMap="getProgramaEjecutivasResult">
		SELECT a.COD_EJEC,
		       a.COD_ETAP,
		       (SELECT VAL_NOM1 || ' '|| VAL_NOM2 || ' ' || VAL_APE1 || ' ' || VAL_APE2 
		        FROM MAE_CLIEN 
		        WHERE PAIS_OID_PAIS = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#)
		        AND   COD_CLIE = a.Cod_Ejec) as NOM_EJEC,
		       a.COD_PERI,
		       a.IMP_MONT_PAGA,
		       a.IMP_MONT_PAYC,
		       a.IMP_MONT_CANA,
		       (CASE 
		        WHEN a.IND_COMI = 1 THEN
		            'SI'
		        ELSE
		            'NO'
		        END)AS IND_COMI,
		       (CASE 
		        WHEN b.Ind_Pedi = 1 THEN
		            'SI'
		        ELSE
		            'NO'
		        END) AS IND_PEDI,
		       (CASE 
		        WHEN b.Ind_Pago = 1 THEN
		            'SI'
		        ELSE
		            'NO'
		        END) AS IND_PAGO
		FROM PEJ_COMIS_CABEC a,
		     PEJ_CALCU_EJECU_CAMPA b
		WHERE a.COD_PAIS = #codigoPais#
		AND   a.cod_ejec = b.Cod_Ejec
		AND   a.Cod_Peri = b.Cod_Peri
		<isNotEmpty property="codigoEjecutiva">
	    	AND   a.COD_EJEC = #codigoEjecutiva#
	    </isNotEmpty>
	    <isNotEmpty property="codigoEtapa">
	    	AND   a.COD_ETAP = #codigoEtapa#
	    </isNotEmpty>
	    ORDER BY 4
	</select>
	
	<select id="getMetaPedido" parameterClass="java.util.Map" resultClass="integer">
		SELECT MET_PEDI
		FROM PEJ_METAS_EJECU_CABEC
		WHERE COD_PAIS = #codigoPais#
		AND COD_EJEC = #codigoEjecutiva#
		AND COD_ETAP = #codigoEtapa#
	</select>
	
	<select id="getDescripcionNivelByEjecuEtap" parameterClass="java.util.Map" resultClass="string">
		SELECT (SELECT b.DES_NIVE 
		        FROM PEJ_NIVEL_EJECU b
		        WHERE b.COD_PAIS = #codigoPais# 
		        AND b.COD_NIVE = a.COD_NIVE) AS DES_NIVE
		FROM PEJ_NIVEL_EJECU_ETAPA a
		WHERE a.COD_PAIS = #codigoPais#
		AND a.COD_EJEC = #codigoEjecutiva#
		AND a.COD_ETAP = #codigoEtapaAnterior#
	</select>
	
	<select id="getCantidadCampanhaEtapa" parameterClass="java.util.Map" resultClass="integer">
		SELECT CAN_CAMP
		FROM PEJ_ETAPA_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND COD_ETAP_EJEC = #codigoEtapa#
	</select>
	
	<select id="getCampanhaInicialEtapa" parameterClass="java.util.Map" resultClass="string">
		SELECT CAM_INIC
		FROM PEJ_ETAPA_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND COD_ETAP_EJEC = #codigoEtapa#
	</select>
	
	<select id="getCampanhaFinalEtapa" parameterClass="java.util.Map" resultClass="string">
		SELECT CAM_FINA
		FROM PEJ_ETAPA_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND COD_ETAP_EJEC = #codigoEtapa#
	</select>
	
	<select id="getObtienePeriodo" parameterClass="java.util.Map" resultClass="string">
		SELECT PER_PKG_REPOR_PERCE.PER_FN_OBTIE_PERIO(#periodo#,
                                                      GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#),
                                                      GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA('T'),
                                                      GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL('VD'),
                                                      #valorRegistro#) 
		FROM DUAL
	</select>
	
	<resultMap id="getVariablesEjecutivasCampaByPeriodoEjecResult" class="java.util.HashMap">
		<result property="metaPedidoPago"        column="MET_PEDI_PAGO"/>
		<result property="pedidoNeto"            column="PED_NETO"/>
		<result property="metaingresosBiCampaña" column="MET_INGR_BI_CAMPA"/>
		<result property="ingresosCampaña"       column="ING_CAMP"/>
		<result property="ingresos"              column="INGRESOS"/>
		<result property="recupera"              column="RECUPERA"/>
	</resultMap> 
	
	<select id="getVariablesEjecutivasCampaByPeriodoEjec" parameterClass="java.util.Map" resultMap="getVariablesEjecutivasCampaByPeriodoEjecResult">
		SELECT MET_PEDI_PAGO,PED_NETO,MET_INGR_BI_CAMPA,ING_CAMP,
		       (CASE WHEN IND_INGR = 1 THEN 'SI' ELSE 'NO' END) AS INGRESOS,
		       (CASE WHEN IND_RECU = 1 THEN 'SI' ELSE 'NO' END) AS RECUPERA
		FROM PEJ_CALCU_EJECU_CAMPA
		WHERE COD_PAIS = #codigoPais#
		AND COD_EJEC = #codigoEjecutiva#
		AND COD_PERI = #codigoPeriodo#
	</select>
	
	<resultMap id="getComisionByEjecutivaPeriodoResult" class="java.util.HashMap">
		<result property="montoComision"                 column="IMP_MONT_COMI"/>
		<result property="indicadorComisionRecuperacion" column="IND_COMI_RECU"/>
	</resultMap>
	
	<select id="getComisionByEjecutivaPeriodo" parameterClass="java.util.Map" resultMap="getComisionByEjecutivaPeriodoResult">
		SELECT (CASE 
		        WHEN IND_COMI = 1 THEN
		            IMP_MONT_COMI
		        ELSE
		          0
		        END)IMP_MONT_COMI,
		       IND_COMI_RECU
		FROM PEJ_COMIS_CABEC
		WHERE COD_PAIS = #codigoPais#
		AND   COD_EJEC = #codigoEjecutiva#
		AND   COD_PERI = #codigoPeriodo#
	</select>
	
	<resultMap id="getMontosBonosEjecAnhioInicEtapaResult" class="java.util.HashMap">
		<result property="montoBonoExcelencia"                 column="IMP_MONT_BONO_EXCE"/>
		<result property="montoBonoCrecimiento" column="IMP_MONT_BONO_CREC"/>
	</resultMap>
	
	<select id="getMontosBonosEjecAnhioInicEtapa" parameterClass="java.util.Map" resultMap="getMontosBonosEjecAnhioInicEtapaResult">
		SELECT IMP_MONT_BONO_EXCE,IMP_MONT_BONO_CREC
		FROM PEJ_BONOS_EJECU
		WHERE COD_PAIS = #codigoPais#
		AND COD_EJEC = #codigoEjecutiva#
		AND ANO_INIC = #anhioInicial#
		AND COD_ETAP = #codigoEtapa#
	</select>
	
	<resultMap id="getPagosEjecEtapaResult" class="java.util.HashMap">
		<result property="codigoPeriodo"      column="COD_PERI"/>
		<result property="montoPago"          column="IMP_MONT_PAGO"/>
		<result property="montoComision"      column="IMP_MONT_COMI"/>
		<result property="porcentajeComision" column="VAL_PORC_COMI"/>
	</resultMap>
	
	<select id="getPagosEjecEtapaList" parameterClass="java.util.Map" resultMap="getPagosEjecEtapaResult">
		SELECT COD_PERI,
	           IMP_MONT_PAGO,
	           IMP_MONT_COMI,
	           VAL_PORC_COMI
	    FROM PEJ_PAGOS_NIVEL
	    WHERE COD_PAIS = #codigoPais#
	    AND   COD_EJEC = #codigoEjecutiva#
	    AND   COD_ETAP = #codigoEtapa#
	    AND   ANO_INIC = #anhioInicial#
	    ORDER BY COD_PERI,NUM_NIVE ASC
	</select>
	
	<select id="getNextCodigoPrograma" resultClass="string">
		SELECT TRIM (TO_CHAR (NVL (MAX (COD_PROG_EJEC), 0) + 1, '00')) COD_PROG_EJEC
  		  FROM EJE_PROGR
	</select>
	
	<insert id="insertProgramaEjecutiva" parameterClass="programaEjecutiva">
		INSERT INTO EJE_PROGR (
		   COD_PROG_EJEC, 
		   PAIS_COD_PAIS, 
		   DES_PROG_EJEC, 
		   COD_CAMP_INIC, 
		   COD_CAMP_FINA,
		   NUM_ETAP_FASE, 
		   USU_CREA, 
		   FEC_CREA, 
		   IND_ACTI, 
		   EST_REGI) 
		VALUES (#codigoPrograma#,
				#codigoPais#,
				#descripcion#,
				#campanyaInicio#,
				#campanyaFinal#,
				#campanyaEtapa#,
				#auditInfo.createdBy#,
				#auditInfo.created#,
				#estado#,
				1)
    </insert>
    
    <insert id="insertFase" parameterClass="fase">
		INSERT INTO EJE_FASES_PROGR (
		   PAIS_COD_PAIS,
		   COD_FASE,
		   COD_PROG_EJEC,
		   COD_CAMP_INIC, 
		   COD_CAMP_FINA, 
		   USU_CREA, 
		   FEC_CREA,
		   IND_ACTI) 
		VALUES (
				#codigoPais#,
				#codigo#,
				#codigoPrograma#,
				#campanyaInicio#,
				#campanyaFinal#,
				#auditInfo.createdBy#,
				#auditInfo.created#,
				#estado#)
    </insert>
    
    <insert id="insertNivel" parameterClass="nivelPEJ">
		INSERT INTO EJE_NIVEL_PROGR (
		   PAIS_COD_PAIS,
		   COD_NIVE, 
		   COD_PROG_EJEC, 
		   DES_NIVE, 
		   NUM_PEDI_MINI,
		   COD_NIVE_REQU,
		   USU_CREA, 
		   FEC_CREA,
		   IND_ACTI) 
		VALUES (
				#codigoPais#,
				#codigo#,
				#codigoPrograma#,
				#descripcion#,
				#numeroPedidoMinimo#,
				#codigoNivelRequisito#,
				#auditInfo.createdBy#,
				#auditInfo.created#,
				#estado#)
    </insert>
    
    <insert id="insertRango" parameterClass="rango">
		INSERT INTO EJE_RANGO_PROGR (
		   PAIS_COD_PAIS,
		   COD_RANG, 
		   COD_PROG_EJEC, 
		   DES_RANG, 
		   VAL_INIC_RANG,
		   VAL_FINA_RANG,
		   USU_CREA, 
		   FEC_CREA,
		   IND_ACTI) 
		VALUES (
				#codigoPais#,
				#codigo#,
				#codigoPrograma#,
				#descripcion#,
				TO_NUMBER(#valorInicial#,'999999999999.99'),
				TO_NUMBER(#valorFinal#,'999999999999.99'),
				#auditInfo.createdBy#,
				#auditInfo.created#,
				#estado#)
    </insert>
    
    <insert id="insertGrupo" parameterClass="grupoPEJ">
		INSERT INTO EJE_GRUPO_COMIS (
		   PAIS_COD_PAIS,
		   COD_GRUP_COMI,
		   COD_PROG_EJEC,
		   DES_GRUP_COMI,
		   USU_CREA, 
		   FEC_CREA,
		   IND_ACTI) 
		VALUES (
				#codigoPais#,
				#codigo#,
				#codigoPrograma#,
				#descripcion#,
				#auditInfo.createdBy#,
				#auditInfo.created#,
				#estado#)
    </insert>
    
    <insert id="insertPorcentaje" parameterClass="porcentaje">
		 INSERT INTO EJE_NIVEL_RANGO_PROGR
		   (PAIS_COD_PAIS,
		    COD_PROG_EJEC,
		    COD_NIVE,
		    COD_RANG,
		    COD_GRUP_COMI,
		    COD_FASE,
		    VAL_PORC_COMI,
		    USU_CREA,
		    FEC_CREA,
		    IND_ACTI)
		 VALUES
		   (#codigoPais#, 
		    #codigoPrograma#, 
		    #codigoNivelPorcentaje#, 
		    #codigoRangoPorcentaje#, 
		    #codigoGrupoPorcentaje#, 
		    #codigoFasePorcentaje#,
		    TO_NUMBER(#valorPorcentajeComision#,'999999999999.99'),
			#auditInfo.createdBy#,
			#auditInfo.created#,
		    #estadoPorcentaje#)
    </insert>
     
    <insert id="insertTipoAbono" parameterClass="tipoAbono">
		INSERT INTO EJE_TIPO_ABONO (
		   PAIS_COD_PAIS,
		   COD_ABON, 
		   COD_PROG_EJEC,
		   DES_ORIG_ABON, 
		   USU_CREA, 
		   FEC_CREA,
		   IND_ACTI) 
		VALUES (
				#codigoPais#,
				#codigo#,
				#codigoPrograma#,
				#descripcion#,
				#auditInfo.createdBy#,
				#auditInfo.created#,
				#estado#)
    </insert>
    
	<resultMap id="faseResult" class="fase">
	      <result property="codigoPais" 		  		column="PAIS_COD_PAIS" 	/>
	      <result property="codigoPrograma" 	column="COD_PROG_EJEC" 	/>
	      <result property="codigo" 		  			column="COD_FASE" 	/>
	      <result property="campanyaInicio" 		column="COD_CAMP_INIC" 	/>
	      <result property="campanyaFinal" 		column="COD_CAMP_FINA" 	/>
	      <result property="estado"			    	column="IND_ACTI" 	/>
	 </resultMap>
	
	<select id="getFasePEJ"  parameterClass="java.util.Map" resultMap="faseResult">
		SELECT A.PAIS_COD_PAIS,
			   A.COD_PROG_EJEC,
			   A.COD_FASE,
			   A.COD_CAMP_INIC,
			   A.COD_CAMP_FINA,
			   A.IND_ACTI
		  FROM EJE_FASES_PROGR A
		 WHERE PAIS_COD_PAIS = #codigoPais#
		 <isNotEmpty prepend="AND" property="codigoPrograma">
			A.COD_PROG_EJEC = #codigoPrograma#
		 </isNotEmpty>
		 <isNotEmpty prepend="AND" property="codigoFase">
			A.COD_FASE = #codigoFase#
		 </isNotEmpty>
		 ORDER BY A.COD_FASE ASC
	</select>
	
	<resultMap id="nivelResult" class="nivelPEJ">
	      <result property="codigoPais" 		  				column="PAIS_COD_PAIS" 	/>
	      <result property="codigoPrograma" 			column="COD_PROG_EJEC" 	/>
	      <result property="codigo" 		    				column="COD_NIVE" 	/>
	      <result property="descripcion" 					column="DES_NIVE" 	/>
	      <result property="numeroPedidoMinimo" 	column="NUM_PEDI_MINI" 	/>
	      <result property="codigoNivelRequisito" 		column="COD_NIVE_REQU" 	/>
	      <result property="estado"			    			column="IND_ACTI" 	/>
	 </resultMap>
	
	<select id="getNivelPEJ"  parameterClass="java.util.Map" resultMap="nivelResult">
		SELECT A.PAIS_COD_PAIS,
			   A.COD_PROG_EJEC, 
		       A.COD_NIVE,
		       A.DES_NIVE,
		       A.NUM_PEDI_MINI,
		       A.COD_NIVE_REQU,
		       A.IND_ACTI
		  FROM EJE_NIVEL_PROGR A
		  WHERE PAIS_COD_PAIS = #codigoPais#
		 <isNotEmpty prepend="AND" property="codigoPrograma">
			A.COD_PROG_EJEC = #codigoPrograma#
		 </isNotEmpty>
		 <isNotEmpty prepend="AND" property="codigoNivel">
			A.COD_NIVE = #codigoNivel#
		 </isNotEmpty>
		 ORDER BY A.COD_NIVE ASC
	</select>
	
	<resultMap id="rangoResult" class="rango">
	      <result property="codigoPais" 		  		column="PAIS_COD_PAIS" 	/>
	      <result property="codigoPrograma" 	column="COD_PROG_EJEC" 	/>
	      <result property="codigo" 		    		column="COD_RANG" 	/>
	      <result property="descripcion" 			column="DES_RANG" 	/>
	      <result property="valorInicial" 			column="VAL_INIC_RANG" 	/>
	      <result property="valorFinal" 				column="VAL_FINA_RANG" 	/>
	      <result property="estado"			    	column="IND_ACTI" 	/>
	 </resultMap>
	
	<select id="getRangoPEJ"  parameterClass="java.util.Map" resultMap="rangoResult">
		SELECT A.PAIS_COD_PAIS,
			   A.COD_PROG_EJEC, 
		       A.COD_RANG,
		       A.DES_RANG,
		       A.VAL_INIC_RANG,
		       A.VAL_FINA_RANG,
		       A.IND_ACTI
		  FROM EJE_RANGO_PROGR A
		 WHERE A.PAIS_COD_PAIS = #codigoPais# 
		 <isNotEmpty prepend="AND" property="codigoPrograma">
			 A.COD_PROG_EJEC = #codigoPrograma#
		 </isNotEmpty>
		 <isNotEmpty prepend="AND" property="codigoRango">
			A.COD_RANG = #codigoRango#
		 </isNotEmpty>
		 ORDER BY A.COD_RANG ASC
	</select>
	
	<resultMap id="grupoResult" class="grupoPEJ">
	      <result property="codigoPais" 		  		column="PAIS_COD_PAIS" 	/>
	      <result property="codigoPrograma" 	column="COD_PROG_EJEC" 	/>
	      <result property="codigo" 		    		column="COD_GRUP_COMI" 	/>
	      <result property="descripcion" 			column="DES_GRUP_COMI" 	/>
	      <result property="estado"			    	column="IND_ACTI" 	/>
	 </resultMap>
	
	<select id="getGrupoPEJ"  parameterClass="java.util.Map" resultMap="grupoResult">
		SELECT A.PAIS_COD_PAIS,
			   A.COD_PROG_EJEC, 
		       A.COD_GRUP_COMI,
		       A.DES_GRUP_COMI,
		       A.IND_ACTI
		  FROM EJE_GRUPO_COMIS A
		  WHERE A.PAIS_COD_PAIS = #codigoPais# 
				 <isNotEmpty prepend="AND" property="codigoPrograma">
					  A.COD_PROG_EJEC = #codigoPrograma#
				 </isNotEmpty>
				 <isNotEmpty prepend="AND" property="codigoGrupo">
					   A.COD_GRUP_COMI = #codigoGrupo#
				 </isNotEmpty>
		  ORDER BY A.COD_GRUP_COMI ASC
	</select>
	
	<resultMap id="porcentajeResult" class="porcentaje">
	      <result property="codigoPais" 	column="PAIS_COD_PAIS" 	/>
	      <result property="codigoPrograma" 	column="COD_PROG_EJEC" 	/>
	      <result property="codigoNivelPorcentaje" 	column="COD_NIVE" 	/>
	      <result property="descripcionNivelPorcentaje" 	column="DES_NIVE" 	/>
	      <result property="codigoRangoPorcentaje" 	column="COD_RANG" 	/>
	      <result property="descripcionRangoPorcentaje" 	column="DES_RANG" 	/>
	      <result property="codigoGrupoPorcentaje" 	column="COD_GRUP_COMI" 	/>
	      <result property="descripcionGrupoPorcentaje" 	column="DES_GRUP_COMI" 	/>
	      <result property="codigoFasePorcentaje" 	column="COD_FASE" 	/>
	      <result property="valorPorcentajeComision" 	column="VAL_PORC_COMI" 	/>
	      <result property="estadoPorcentaje" 	column="IND_ACTI" 	/>
	 </resultMap>
	
	<select id="getPorcentajePEJ"  parameterClass="java.util.Map" resultMap="porcentajeResult">
		SELECT A.PAIS_COD_PAIS,
		       A.COD_PROG_EJEC,
		       A.COD_NIVE,
		       C.DES_NIVE,
		       A.COD_RANG,
		       D.DES_RANG,
		       A.COD_GRUP_COMI,
		       B.DES_GRUP_COMI,
		       A.COD_FASE,
		       A.VAL_PORC_COMI,
		       A.IND_ACTI
		  FROM EJE_NIVEL_RANGO_PROGR A,
		       EJE_GRUPO_COMIS       B,
		       EJE_NIVEL_PROGR       C,
		       EJE_RANGO_PROGR       D
		 WHERE (A.PAIS_COD_PAIS = B.PAIS_COD_PAIS AND
		       A.COD_PROG_EJEC = B.COD_PROG_EJEC AND
		       A.COD_GRUP_COMI = B.COD_GRUP_COMI)
		   AND (A.PAIS_COD_PAIS = C.PAIS_COD_PAIS AND
		       A.COD_PROG_EJEC = C.COD_PROG_EJEC AND A.COD_NIVE = C.COD_NIVE)
		   AND (A.PAIS_COD_PAIS = D.PAIS_COD_PAIS AND
		       A.COD_PROG_EJEC = D.COD_PROG_EJEC AND A.COD_RANG = D.COD_RANG)
		   AND A.PAIS_COD_PAIS = #codigoPais#
		   AND A.COD_PROG_EJEC = #codigoPrograma#
		<isNotEmpty prepend="AND" property="estadoPorcentaje">
 			 A.IND_ACTI = #estadoPorcentaje#
		</isNotEmpty>
	</select>
	
	<resultMap id="tipoAbonoResult" class="tipoAbono">
	      <result property="codigoPais" 		  		column="PAIS_COD_PAIS" 	/>
	      <result property="codigoPrograma" 	column="COD_PROG_EJEC" 	/>
	      <result property="codigo" 		    		column="COD_ABON" 	/>
	      <result property="descripcion" 			column="DES_ORIG_ABON" 	/>
	      <result property="estado" 					column="IND_ACTI" 	/>
	 </resultMap>
	
	<select id="getTipoAbonoPEJ"  parameterClass="java.util.Map" resultMap="tipoAbonoResult">
		SELECT A.PAIS_COD_PAIS,
			   A.COD_PROG_EJEC, 
		       A.COD_ABON, 
			   A.DES_ORIG_ABON, 
			   A.IND_ACTI
		  FROM EJE_TIPO_ABONO A
		 WHERE A.PAIS_COD_PAIS = #codigoPais#
			<isNotEmpty prepend="AND" property="codigoPrograma">
				A.COD_PROG_EJEC = #codigoPrograma#
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="codigoTipoAbono">
				A.COD_ABON = #codigoTipoAbono#
			</isNotEmpty>
		 ORDER BY A.COD_ABON ASC
	</select>
	
	<update id="updateProgramaEjecutiva" parameterClass="programaEjecutiva">
		UPDATE EJE_PROGR
		   SET DES_PROG_EJEC = #descripcion#, 
		       COD_CAMP_INIC = #campanyaInicio#,
		       COD_CAMP_FINA = #campanyaFinal#,
		       NUM_ETAP_FASE = #campanyaEtapa#,
		       IND_ACTI = #estado#,
		       EST_REGI = '1',
		       USU_MODI = #auditInfo.updatedBy#,
		       FEC_MODI = #auditInfo.lastUpdated#
		 WHERE PAIS_COD_PAIS = #codigoPais#
		 	  AND COD_PROG_EJEC = #codigoPrograma#
	</update>
	
	<update id="updateFase" parameterClass="fase">
		UPDATE EJE_FASES_PROGR
		   SET COD_CAMP_INIC = #campanyaInicio#,
		       COD_CAMP_FINA = #campanyaFinal#,
		       IND_ACTI = #estado#,
		       USU_MODI = #auditInfo.updatedBy#,
		       FEC_MODI = #auditInfo.lastUpdated#
		 WHERE PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
		   AND COD_FASE = #codigo#
    </update>
	
	<update id="updateNivel" parameterClass="nivelPEJ">
		UPDATE EJE_NIVEL_PROGR
		   SET DES_NIVE = #descripcion#,
		       COD_NIVE_REQU = #codigoNivelRequisito#,
		       IND_ACTI = #estado#,
		       USU_MODI = #auditInfo.updatedBy#,
		       FEC_MODI = #auditInfo.lastUpdated#
		 WHERE PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
		   AND COD_NIVE = #codigo#
    </update>
    
    <update id="updateRango" parameterClass="rango">
		UPDATE EJE_RANGO_PROGR
		   SET DES_RANG = #descripcion#,
		       VAL_INIC_RANG = TO_NUMBER(#valorInicial#,'999999999999.99'),
		       VAL_FINA_RANG = TO_NUMBER(#valorFinal#,'999999999999.99'),
		       IND_ACTI = #estado#,
		       USU_MODI = #auditInfo.updatedBy#,
		       FEC_MODI = #auditInfo.lastUpdated#
		 WHERE A.PAIS_COD_PAIS = #codigoPais# 
		      AND COD_PROG_EJEC = #codigoPrograma#
		      AND COD_RANG = #codigo#
    </update>
    
	<update id="updateGrupo" parameterClass="grupoPEJ">
		UPDATE EJE_GRUPO_COMIS
		   SET DES_GRUP_COMI = #descripcion#,
		       IND_ACTI = #estado#,
		       USU_MODI = #auditInfo.updatedBy#,
		       FEC_MODI = #auditInfo.lastUpdated#
		 WHERE PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
		   AND COD_GRUP_COMI = #codigo#
    </update>
    
    <update id="updatePorcentaje" parameterClass="porcentaje">
		UPDATE EJE_NIVEL_RANGO_PROGR
		   SET VAL_PORC_COMI = TO_NUMBER(#valorPorcentajeComision#,'999999999999.99'),
		       USU_MODI = #auditInfo.updatedBy#,
		       FEC_MODI = #auditInfo.lastUpdated#
		 WHERE PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
		   AND COD_NIVE = #codigoNivelPorcentaje#
		   AND COD_RANG = #codigoRangoPorcentaje#
		   AND COD_GRUP_COMI = #codigoGrupoPorcentaje#
		   AND IND_ACTI = #estadoPorcentaje#
    </update>
    
    <update id="updateTipoAbono" parameterClass="tipoAbono">
		UPDATE EJE_TIPO_ABONO
		   SET DES_ORIG_ABON = #descripcion#,
		       IND_ACTI = #estado#,
		       USU_MODI = #auditInfo.updatedBy#,
		       FEC_MODI = #auditInfo.lastUpdated#
		 WHERE PAIS_COD_PAIS = #codigoPais#
		      AND COD_PROG_EJEC = #codigoPrograma#
		      AND COD_ABON = #codigo#
    </update>
    
    <resultMap id="getPeriodoDefaultResult" class="java.util.HashMap"> 
		<result property="codigoPeriodo"		   column ="COD_PERI"/>		                     			
		<result property="fechaProceso"		   column ="FEC_PROC"/>
	</resultMap>
    
    <select id="getPeriodoDefault" resultMap="getPeriodoDefaultResult">
		SELECT ZZ.COD_PERI, to_char(ZZ.FEC_PROC, 'DD/MM/YYYY') FEC_PROC
		  FROM BAS_CTRL_FACT ZZ
		 WHERE ZZ.IND_CAMP_ACT = '1'
		   AND ZZ.STA_CAMP = '0'
	</select>
	
	<update id="deleteProgramaEjecutiva" parameterClass="java.util.Map">
		UPDATE EJE_PROGR
		   SET EST_REGI = '9',
		       IND_ACTI = 0,
		       COD_CAMP_FINA = #campanyaProceso#,
		       USU_MODI = #usuario.login#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		 	  AND COD_PROG_EJEC = #codigoPrograma#
    </update>
	
	<update id="deleteFase" parameterClass="java.util.Map">
		UPDATE EJE_FASES_PROGR
		   SET IND_ACTI = 0,
		       USU_MODI = #usuario.login#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		 	  AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
    <update id="deleteNivel" parameterClass="java.util.Map">
		UPDATE EJE_NIVEL_PROGR
		   SET IND_ACTI = 0,
		       USU_MODI = #usuario.login#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		 	  AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
    <update id="deleteRango" parameterClass="java.util.Map">
		UPDATE EJE_RANGO_PROGR
		   SET IND_ACTI = 0,
		       USU_MODI = #usuario.login#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais# 
		      AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
	<update id="deleteGrupo" parameterClass="java.util.Map">
		UPDATE EJE_GRUPO_COMIS
		   SET IND_ACTI = 0,
		       USU_MODI = #usuario.login#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		 	  AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
    <update id="deletePorcentaje" parameterClass="java.util.Map">
		UPDATE EJE_NIVEL_RANGO_PROGR
		   SET IND_ACTI = 0,
		       USU_MODI = #usuario.login#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais# 
		      AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
    <update id="deleteTipoAbono" parameterClass="java.util.Map">
		UPDATE EJE_TIPO_ABONO
		   SET IND_ACTI = 0,
		       USU_MODI = #usuario.login#,
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais# 
		      AND COD_PROG_EJEC = #codigoPrograma#
    </update>

    <update id="deleteClienteExcluido" parameterClass="java.util.Map">
		UPDATE EJE_CLIEN_EXCLU
		   SET IND_ACTI = 0, 
		       USU_MODI = #usuario.login#, 
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
    <update id="deleteMetasSeccion" parameterClass="java.util.Map">
		UPDATE EJE_METAS_SECCI
		   SET USU_MODI = #usuario.login#, 
		       FEC_MODI = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
    <update id="deleteNivelCampanya" parameterClass="java.util.Map">
		UPDATE EJE_NIVEL_CAMPA 
		   SET IND_ACTI = 0, 
		       USU_MODI = #usuario.login#, 
		       FEC_ACTU = SYSDATE
		 WHERE PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
    </update>
    
	<resultMap id="tipoCargaResult"       class="java.util.HashMap">
    	<result property="codigo" 		    	column="CODIGO" 	/>		
    	<result property="descripcion" 		column="DESCRIPCION"/>
    	<result property="prefijo" 				column="PREFIJO"/>
    </resultMap>

	<select id="getTipoCarga" resultMap="tipoCargaResult">
		  SELECT COD_LIST CODIGO, DES_LIST DESCRIPCION, COD_PREF_CARG PREFIJO
		    FROM EJE_LISTA_CARGA_MASIV
		ORDER BY VAL_NUME_ORDE ASC
    </select>
	
	<select id="getNumeroCarga" resultClass="string">
		SELECT NVL(MAX(NUM_REGI_CARG) + 1, 1) AS NUM_CARGA
  		  FROM EJE_CARGA_MASIV_EJECU
    </select>
    
    <insert id="insertCargaProgramaEjecutivas" parameterClass="java.util.Map">
		INSERT INTO EJE_CARGA_MASIV_EJECU (
				NUM_REGI_CARG,	CLIE_COD_CLIE,	COD_CAMP_REFE,	COD_LIST,	CAM_INIC,	CAM_FINA,	COD_NIVE,	VAL_META_RECA,	VAL_META_INGR,	
				VAL_META_PEDI,  VAL_MONT_RECL, COD_FASE,	COD_ABON, VAL_TIPO_OPER,	COD_MOTI_RECH,	NUM_FILA,	EST_PROC,	USU_CREA,	FEC_CREA)
		VALUES  (#numeroCarga#,	#codigoCliente#,	#campanyaReferencia#,	#tipoCarga#,	#campInicio#,	#campFinal#,	#codigoNivel#,	#metaRecaudo#,	#metaIngreso#,	
				#metaPedido#,	#montoReclamo#, #codigoFase#,	#tipoAbono#,	#tipoOperacion#,	null,	#numeroFila#,	0,	#codigoUsuario#,	SYSDATE)
    </insert>

	<parameterMap id="paramExecuteValidarCargaProgramaEjecutivas" class="map">
		<parameter property="codigoPais"  					jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroCarga" 				jdbcType="NUMBER" mode="IN"/>
		<parameter property="campanyaAplicacion" 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPrograma" 			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoCarga" 					jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
	<procedure id="executeValidarCargaProgramaEjecutivas" parameterMap="paramExecuteValidarCargaProgramaEjecutivas" >
		{call PEJ_PKG_PROCE.PEJ_PR_VALID_CARGA_PROGR( ?, ?, ?, ?, ? )}
	</procedure>
	
	<resultMap id="getCargaProgramaEjecutivasResult"  class="java.util.HashMap">
		<result property="numeroFila"	      column="NUM_FILA"/>
		<result property="codigoCliente"	  column="CLIE_COD_CLIE"/>
		<result property="codigoMotivo"       column="COD_MOTI_RECH"/>
		<result property="descripcionMotivo"  column="DES_RECH"/>
    </resultMap>

    <select id="getCargaProgramaEjecutivasList" parameterClass="java.util.Map" resultMap="getCargaProgramaEjecutivasResult">
		SELECT car.NUM_FILA, car.CLIE_COD_CLIE, car.COD_MOTI_RECH, 
		       (SELECT mot.DES_RECH FROM EJE_MOTIV_RECHA_CARGA mot WHERE mot.COD_MOTI_RECH = car.COD_MOTI_RECH) DES_RECH
		  FROM EJE_CARGA_MASIV_EJECU car
		 WHERE car.NUM_REGI_CARG = #numeroCarga#
		 ORDER BY car.NUM_FILA
	</select>
	
	<parameterMap id="paramExecuteActualizarCargaProgramaEjecutivas" class="map">
		<parameter property="codigoPais" 					jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroCarga" 				jdbcType="NUMBER" mode="IN"/>
		<parameter property="campanyaAplicacion" 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPrograma" 			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoCarga" 					jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario" 						jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
	<procedure id="executeActualizarCargaProgramaEjecutivas" parameterMap="paramExecuteActualizarCargaProgramaEjecutivas" >
		{call PEJ_PKG_PROCE.PEJ_PR_ACTUA_CARGA_PROGR( ?, ?, ?, ?, ?, ?)}
	</procedure>
	
	<select id="getExisteClienteCargaProgramaEjecutivas" parameterClass="string" resultClass="string">
		SELECT car.CLIE_COD_CLIE
		  FROM EJE_CARGA_MASIV_EJECU car
		 WHERE car.CLIE_COD_CLIE = #value#
	</select>

	<select id="getExisteDependenciaFase" parameterClass="java.util.Map" resultClass="string">
		  SELECT COUNT(1) 
		    FROM EJE_NIVEL_RANGO_PROGR 
		  WHERE PAIS_COD_PAIS = #codigoPais#
		       AND COD_PROG_EJEC = #codigoPrograma# 
		  	   AND COD_FASE = #codigoFase#
	</select>
	
	<select id="getExisteDependenciaNivel" parameterClass="java.util.Map" resultClass="string">
		  SELECT COUNT(1) 
		    FROM EJE_NIVEL_RANGO_PROGR 
		  WHERE PAIS_COD_PAIS = #codigoPais#
		       AND COD_PROG_EJEC = #codigoPrograma# 
		  	   AND COD_NIVE = #codigoNivel#
	</select>
	
	<select id="getExisteDependenciaRango" parameterClass="java.util.Map" resultClass="string">
		  SELECT COUNT(1) 
		    FROM EJE_NIVEL_RANGO_PROGR 
		  WHERE PAIS_COD_PAIS = #codigoPais#
		       AND COD_PROG_EJEC = #codigoPrograma# 
		  	   AND COD_RANG = #codigoRango#
	</select>
	
	<select id="getExisteDependenciaGrupo" parameterClass="java.util.Map" resultClass="string">
		  SELECT COUNT(1) 
		    FROM EJE_NIVEL_RANGO_PROGR 
		  WHERE PAIS_COD_PAIS = #codigoPais#
		       AND COD_PROG_EJEC = #codigoPrograma# 
		  	   AND COD_GRUP_COMI = #codigoGrupo#
	</select>
	
	<select id="getExisteDependenciaTipoAbono" parameterClass="java.util.Map" resultClass="string">
		  SELECT COUNT(1) 
		    FROM EJE_LIQUI_CAMPA
		  WHERE PAIS_COD_PAIS = #codigoPais#
		       AND COD_PROG_EJEC = #codigoPrograma# 
		  	   AND COD_ABON = #codigoAbono#
	</select>

	<select id="getExisteLiquidacionCampanya" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(1)
		  FROM EJE_LIQUI_CAMPA
		 WHERE IND_PROC = 0
		   AND PAIS_COD_PAIS = #codigoPais#
		   AND COD_PROG_EJEC = #codigoPrograma#
		   AND CAM_PROC = #campanyaProceso#
	</select>
		
    <insert id="deleteCargaProgramaEjecutivas" parameterClass="string">
	    <![CDATA[
			DELETE FROM EJE_CARGA_MASIV_EJECU WHERE USU_CREA =#value#
	    ]]>
    </insert>
    
    <parameterMap id="paramsExecuteProcesoPEJCalcularAvanceGestion" class="map">
		<parameter property="codigoPais" 				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca" 				jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal" 	            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo" 			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion" 			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
	<procedure id="executeProcesoPEJCalcularAvanceGestion" parameterMap="paramsExecuteProcesoPEJCalcularAvanceGestion" >
		{call PEJ_PKG_PROCE.PEJ_PR_CALCU_AVANC_GESTI( ?, ?, ?, ?, ?)}
	</procedure>
    
</sqlMap>
