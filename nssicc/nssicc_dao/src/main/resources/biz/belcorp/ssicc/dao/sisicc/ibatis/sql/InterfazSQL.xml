<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="sisicc.InterfazSQL">
  <typeAlias alias="base" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
  <typeAlias alias="periodo" type="biz.belcorp.ssicc.dao.sisicc.model.Periodo"/>
  <typeAlias alias="actividad" type="biz.belcorp.ssicc.dao.sisicc.model.Actividad"/>
  <typeAlias alias="accesocanal" type="biz.belcorp.ssicc.dao.sisicc.model.AccesoCanal"/>
  <typeAlias alias="subacceso" type="biz.belcorp.ssicc.dao.sisicc.model.Subacceso"/>
  
  <typeAlias alias="intefazRetailMatrizCampanya" type="biz.belcorp.ssicc.dao.sisicc.model.InterfazRetailMatrizCampanya"/>
  <typeAlias alias="interfazRetailFacturasVentaDirecta" type="biz.belcorp.ssicc.dao.sisicc.model.InterfazRetailFacturasVentaDirecta"/>
  <typeAlias alias="interfazRetailComplementoFacturasVentaDirecta" type="biz.belcorp.ssicc.dao.sisicc.model.InterfazRetailComplementoFacturasVentaDirecta"/>
  
  <typeAlias alias="interfazOCRRegiones" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
  <typeAlias alias="interfazOCRZonas" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>

  <typeAlias alias="interfazSAMInicializacionStocks" type="biz.belcorp.ssicc.dao.sisicc.model.InterfazSAMInicializacionStocks"/>
  
  <typeAlias alias="interfazSABRentabilidadPorZona" type="biz.belcorp.ssicc.dao.sisicc.model.InterfazSABRentabilidadPorZona"/>
  <typeAlias alias="interfazSABIncentivosConsultoras" type="biz.belcorp.ssicc.dao.sisicc.model.InterfazSABIncentivosConsultoras"/>
  <typeAlias alias="interfazSABFuenteVentasPrevista" type="biz.belcorp.ssicc.dao.sisicc.model.InterfazSABFuenteVentasPrevista"/>

  <typeAlias alias="interfazCOMLibretaAhorros"   type="biz.belcorp.ssicc.dao.sisicc.model.InterfazCOMLibretaAhorros"/>
  <typeAlias alias="interfazCOMLideresNuevas"    type="biz.belcorp.ssicc.dao.sisicc.model.InterfazCOMLideresNuevas"/>
  <typeAlias alias="interfazCOMPagoLideres"      type="biz.belcorp.ssicc.dao.sisicc.model.InterfazCOMPagoLider"/>    

  <typeAlias alias="movimientosBancariosCabecera"    type="biz.belcorp.ssicc.dao.sisicc.model.MovimientosBancariosCabecera"/>
<typeAlias alias="estimadoProductos"   					   type="biz.belcorp.ssicc.dao.sisicc.model.EstimadoProductos"/>
  <typeAlias alias="movimientosBancariosDetalle"     type="biz.belcorp.ssicc.dao.sisicc.model.MovimientosBancariosDetalle"/>    
  
  <typeAlias alias="consolidadosOtrosCanales"    type="biz.belcorp.ssicc.dao.sisicc.model.InterfazPERActualizarPercepcionesConsolidado"/>
  <typeAlias alias="interfazACCRecepcionarRecomendantePremio"    type="biz.belcorp.ssicc.dao.sisicc.model.InterfazACCRecepcionarRecomendantePremio"/>  

  <resultMap id="interfazGEOZonaTerritorioClienteResult" class="java.util.HashMap">
		<result property="codigoPais" 				column="PAIS_COD_PAIS"/>
		<result property="codigoCliente" 			column="COD_CLIE"/>
		<result property="tipoDireccion" 			column="TIP_DIRE"/>
		<result property="tipoVia" 					column="TIP_VIA"/>
		<result property="nombreVia" 				column="NOM_VIA"/>
		<result property="valorNumero" 				column="VAL_NUME"/>
		<result property="valorInterior" 			column="VAL_INTE"/>
		<result property="valorManzana" 			column="VAL_MANZ"/>
		<result property="valorLote" 				column="VAL_LOTE"/>
		<result property="valorKilometro" 			column="VAL_KILO"/>
		<result property="codigoUbigeoNivel1" 		column="COD_UBIG_NIV1"/>
		<result property="codigoUbigeoNivel2" 		column="COD_UBIG_NIV2"/>
		<result property="codigoUbigeoNivel3" 		column="COD_UBIG_NIV3"/>
		<result property="codigoUbigeoNivel4" 		column="COD_UBIG_NIV4"/>
		<result property="nivelSocioeconomico"		column="NIV_SOCI"/>
		<result property="valorCoordenadaX" 		column="VAL_COOX"/>
		<result property="valorCoordenadaY" 		column="VAL_COOY"/>
		<result property="valorCoordenadaZ" 		column="VAL_COOZ"/>
		<result property="codigoTerritorio" 		column="COD_TERR"/>
		<result property="estadoValidacion" 		column="EST_VALI"/>
		<result property="codigoZona" 				column="COD_ZONA"/>
		<result property="usuarioDigitacion" 		column="USU_DIGI"/>
		<result property="fechaDigitacion"  		column="FEC_DIGI" javaType="java.sql.Timestamp"/>
		<result property="usuarioModificacion" 		column="USU_MODI"/>
		<result property="fechaModificacion"    	column="FEC_MODI" javaType="java.sql.Timestamp"/>
		<result property="estado" 					column="EST_CLIE"/>
    </resultMap>
    

  <resultMap id="interfazCOMEnviarPagoLideresResult" class="java.util.HashMap">
    <result property="codigoPlanilla" 	column="CODPLA"/>
    <result property="montoPagar" 	    column="MONPAG"/>
  </resultMap>


  <resultMap id="interfazDATEnviarControlCierresResult" class="java.util.HashMap">
    <result property="codigoPeriodo" 		column="CODPERIODO"/>
    <result property="codigoRegion" 	column="CODREGION"/>
    <result property="codigoZona" 		column="CODZONA"/>
    <result property="flagImpresion" 	    column="FLAGIMP"/>
    <result property="flagStatusFacturacion" 	column="FLAGSTATUSFAC"/>     
    <result property="resultado" 	    column="RESULTADO"/>
  </resultMap>

  <resultMap id="interfazDATEnviarControlCierresErrorResult" class="java.util.HashMap">
    <result property="codigoRegion" 	column="CODREGION"/>
    <result property="codigoZona" 		column="CODZONA"/>    
    <result property="codigoPeriodo" 		column="CODPERIODO"/>        
    <result property="mensaje" 		column="RESULTADO"/>
    <result property="fechaCierre" 	    column="FECHACIERRE"/>
    <result property="secuencialCierre" 	column="SECCIERRE"/>     
  </resultMap>

  
  <resultMap id="baseResult" class="base">
    <result property="codigo" 		column="CODIGO" 	/>
    <result property="descripcion" 	column="DESCRIPCION"/>
  </resultMap>
  
  <resultMap id="periodoResult" class="periodo">
    <result property="codigoPais" 			column="CODPAI" />
    <result property="codigoMarca" 			column="CODMAR" />
    <result property="codigoCanal" 			column="CODCAN" />
    <result property="codigoAcceso"			column="CODACC" />
    <result property="codigoPeriodo"		column="CODPER" />
    <result property="fechaInicioPeriodo"	column="FECINI" />
    <result property="fechaFinPeriodo"		column="FECFIN" />
  </resultMap>
  
  <resultMap id="actividadResult" class="actividad">
    <result property="codigoPais" 		column="CODPAI" />
    <result property="codigoMarca" 		column="CODMAR" />
    <result property="codigoCanal" 		column="CODCAN" />
    <result property="codigoActividad" 	column="CODACT" />
    <result property="descripcion" 		column="DSC" />
  </resultMap>
  
  <resultMap id="accesoCanalResult" class="accesocanal">
    <result property="codigoCanal" 	column="CODCAN" />
    <result property="codigoAcceso" column="CODACC" />
    <result property="descripcion" 	column="DSC" 	/>
  </resultMap>
  
  <resultMap id="subAccesosResult" class="subacceso">
    <result property="codigoAcceso" column="PARENT" 	/>
    <result property="codigo" 		column="CODIGO" 	/>
    <result property="descripcion"	column="DESCRIPCION"/>
  </resultMap>
  
  <resultMap id="interfazREUCronogramaFacturacionResult" class="java.util.HashMap">
    <result property="codigoPais"         column="CODPAIS"    />
    <result property="codigoZona"         column="CODZONA"    />
    <result property="codigoCampanya"     column="ANYOCAMP"   />
    <result property="fechaFacturacion"   column="FECHAFACT"  />
    <result property="fechaRefacturacion" column="FECHAREFACT"  />    
  </resultMap>
  
  <resultMap id="interfazREUPeriodosFacturacionResult" class="java.util.HashMap">
    <result property="codigoPais"	           	   column="CODPAIS"	/>  
    <result property="codigoPeriodo"	           column="CODPERIODO"	/>
    <result property="fechaInicio" 		           column="FECINICIO"	/>
    <result property="fechaFin" 	               column="FECFIN"   	/>
  </resultMap>
  
  <resultMap id="interfazSABEnviarIncentivosConsultorasResult" class="java.util.HashMap">
    <result property="codigoPais"	              column="CODPAIS"/>
    <result property="codigoSociedad" 		      column="CODSOCIEDAD"/>
    <result property="codigoCanal" 	              column="CODCANAL"/>
    <result property="ejercicio"                  column="EJERCICIO"/>
    <result property="periodo"	                  column="PERIODO"/>
    <result property="numeroConcurso" 		      column="NUMEROCONCURSO"/>
    <result property="nivelPremio" 	              column="NIVELPREMIO"/>
    <result property="numeroPremio"               column="NUMEROPREMIO"/>
    <result property="codigoProducto"             column="CODIGOPRODUCTO"/>
    <result property="posicionPlan"               column="POSICIONPLAN"/>
    <result property="cantidadPremiosEntregados"  column="CANTPREMIOSENTREGADOS"/>
    <result property="unidadMedida"               column="UNIDADMEDIDA"/>
    <result property="precioPublicoPremio"        column="PRECIOPUBLICOPREMIO"/>
    <result property="codigoMonedaLocal"          column="CODMONEDALOCAL"/>
  </resultMap>
  
  <resultMap id="interfazBELUbicacionesGeograficasResult" class="java.util.HashMap">
    <result property="codigoUbicacionGeografica"	           column="CODUBIGEOGRAFICA"	/>
    <result property="codigoUbicacionGeograficaPostal" 		   column="CODUBIGEOGRAFICAPOSTAL"	/>
    <result property="descCompletaDepartamento" 	           column="DESCOMDEPARTAMENTO"   	/>
    <result property="descCompletaProvincia"                   column="DESCOMPROVINCIA" 	/>
    <result property="descCompletaDistrito"	                   column="DESCOMDISTRITO"	/>
    <result property="descAbreviadaDepartamento" 		       column="DESABREDEPARTAMENTO"	/>
    <result property="descAbreviadaProvincia" 	               column="DESABREPROVINCIA"   	/>
    <result property="descAbreviadaDistrito"                   column="DESABREDISTRITO" 	/>
  </resultMap>
  
  <resultMap id="interfazBELDireccionClientesResult"  class="java.util.HashMap">
    <result property="codigoCliente"	                         column="CODCLIENTE"	/>
    <result property="tipoVia" 		                             column="TIPOVIA"	/>
    <result property="nombreVia" 	                             column="NOMBREVIA"   	/>
    <result property="statusIndicadorDescripcionAdicional"       column="INDDESADC" 	/>
    <result property="numeroVia"	                             column="NUMEROVIA"	/>
    <result property="numeroBlock" 		                         column="NUMEROBLOCK"	/>
    <result property="numeroManzana" 	                         column="NUMEROMANZANA"   	/>
    <result property="numeroLote"                                column="NUMEROLOTE" 	/>
    <result property="numeroKilometro"                           column="NUMEROKILOMETRO" 	/>
    <result property="numeroInteriorDomicilio"                   column="NUMINTDOMICILIO" 	/>
    <result property="codigoPostal"	                             column="CODPOSTAL"	/>
    <result property="codigoUbigeoINEI" 		                 column="CODUBIINEI"	/>
    <result property="codigoTipoCentroPoblado" 	                 column="CODTIPOCENTROPOBLADO"   	/>
    <result property="numeroEtapa"                               column="NUMEROETAPA" 	/>
    <result property="numeroSector"	                             column="NUMEROSECTOR"	/>
    <result property="statusIndicadorDescripcionReferencia" 	 column="INDDESREF"	/>
    <result property="numeroTelefono1" 	                         column="NUMTEL1"   	/>
    <result property="numeroTelefono2"                           column="NUMTEL2" 	/>
    <result property="statusIndicadorDireccionTrabajo"           column="INDDIRTRABAJO" 	/>
    <result property="numeroTelefono3"                           column="NUMTEL3" 	/>
    <result property="numeroTelefono4"                           column="NUMTEL4" 	/>
    <result property="statusIndicadorAdicional"                  column="INDADICIONAL" 	/>
  </resultMap>
  
  <resultMap id="interfazBELPorcentajesReferenciaResult" class="java.util.HashMap">
    <result property="periodo" 				    column="PERIODO" 	/>
    <result property="codigoCliente" 			column="CODCLIENTE"	/>
    <result property="estadoFacturacion" 		column="ESTFACTURACION"/>
    <result property="codigoGrupo" 				column="CODGRUPO"	/>
    <result property="porcentajeComision" 		column="PORCOMISION"/>
  </resultMap>
  
  <resultMap id="interfazBELUnidadesAtendidasResult" class="java.util.HashMap">
    <result property="periodo" 				    column="PERIODO" 	/>
    <result property="numeroFactura" 			column="NUMFACTURA"	/>
    <result property="codigoVenta" 		        column="CODVENTA"/>
    <result property="unidadesAtendidas" 		column="UNDATENDIDAS"	/>
  </resultMap>
  
  <resultMap id="interfazREUEnviarConsultorasResult" class="java.util.HashMap">
      <result property="codigoPais"               column="COD_PAIS" />
      <result property="codigoCliente"            column="COD_CLIE" /> 
      <result property="apellidoPaterno"          column="VAL_APE1" />
      <result property="apellidoMaterno"          column="VAL_APE2" />
      <result property="nombre1"                  column="VAL_NOM1" />
      <result property="nombre2"                  column="VAL_NOM2" />
      <result property="sexo"                     column="COD_SEXO" />
      <result property="fechaNacimiento"          column="FEC_NACI" />
      <result property="estadoCivil"              column="COD_ESTA_CIVI" />
      <result property="estadoCliente"            column="COD_ESTA_CLIE" />
      <result property="numeroDocumento"          column="NUM_DOCU_IDEN" />
      <result property="tipoVia"                  column="COD_TIPO_VIA" />
      <result property="nombreVia"                column="VAL_NOMB_VIA" />
      <result property="numeroPrincipal"          column="NUM_PPAL" />
      <result property="observaciones"            column="VAL_OBSE" />
      <result property="codigoPostal"             column="VAL_COD_POST" />
      <result property="telefonoCasa"             column="VAL_TELE_FIJO" />
      <result property="telefonoTrabajo"          column="VAL_TELE_OFIC" />
      <result property="celular"                  column="VAL_TELE_CELU" />
      <result property="correo"                   column="VAL_CORR_ELEC" />
      <result property="codigoSGV"                column="COD_SUBG_VENT" />
      <result property="codigoRegion"             column="COD_REGI" />
      <result property="codigoZona"               column="COD_ZONA" />
      <result property="codigoSeccion"            column="COD_SECC" />
      <result property="codigoTerreno"            column="COD_TERR" />
      <result property="estatusSE"                column="EST_SOCI_ECON" />
      <result property="orden1"                   column="ORDE_1" />
      <result property="orden2"                   column="ORDE_2" />
      <result property="nombreUnidadGeografica1"  column="NOM_DEPA" />
      <result property="nombreUnidadGeografica2"  column="NOM_PROV" />
      <result property="nombreUnidadGeografica3"  column="NOM_DIST" />
      <result property="anyoCampanyaUltimoPedido" column="CAM_ULTI_PEDI" />
      <result property="saldoCtaCte"              column="SAL_CUEN_CORR" />
      <result property="indicadorPedido"          column="IND_PEDI" />
      <result property="tipoConsultora"           column="COD_TIPO_CONS" />
      <result property="estadoConsultora"         column="EST_CONS" />
      <result property="tipoDocumento"            column="COD_TIPO_DOCU" />
      <result property="numeroRUC"                column="NUM_RUC" />
      <result property="flagEmitirFactura"        column="FLA_EMIT_FACT" />
      <result property="valorPorcentajeDcto"      column="VAL_PORC_DESC" />
      <result property="fechaEgreso"              column="FEC_EGRE" />
      <result property="campanyaIngreso"          column="CAM_INGR" />
      <result property="montoFacturado"           column="VAL_PREC_FACT_TOTA_LOCA" />
      <result property="montoNominal"             column="VAL_NIV1" />
  </resultMap>
  
  <resultMap id="interfazRETEnviarMatrizCampanyaResult" class="java.util.HashMap">
	<result property="codigoPais" 				column="CODPAIS" />
	<result property="codigoPeriodo" 			column="CODPER" /> 
	<result property="codigoVenta" 				column="CODVEN" />
	<result property="codigoProducto" 			column="CODPRO" />
	<result property="descripcionProducto" 		column="DSCPRO" />
	<result property="codigoTipoOferta" 		column="CODOFE" />
	<result property="precioCatalogo" 			column="PRECAT" />
	<result property="flagComisionable" 		column="FLGCOM" />
	<result property="tasaImpuestos" 			column="TASIMP" />
	<result property="marcaProducto" 			column="MARPRO" />
	<result property="codigoNegocio" 			column="CODNEG" />
	<result property="codigoUnidadNegocio" 		column="CODUNE" />
	<result property="valorDescuentoEspecifico"	column="VALDES" />
  </resultMap>

  <resultMap id="intefazMYEMovimientosCuentaCorrienteResult" class="java.util.HashMap">
    <result property="codigoPais"               column="CODPAIS"/>
    <result property="codigoConsultora"         column="CODCON"/>
    <result property="numeroLote"               column="NUMSEC"/>
    <result property="tipoOperacion"            column="TIPOPE"/>
    <result property="fechaOperacion"           column="FECOPE"/>
    <result property="fechaVencimiento"         column="FECVEN"/>
    <result property="anyoCampanya"             column="ANYCAM"/>
    <result property="descripcionTransaccion"   column="DESTRA"/>
    <result property="montoOperacion"           column="MONOPE"/>
  </resultMap>

  <resultMap id="intefazMYEEnviarRegionesResult" class="java.util.HashMap">
    <result property="codigoPais" column="COD_PAIS"/>
    <result property="codigoRegion" column="COD_REGI"/>
    <result property="descripcionRegion" column="DES_REGI"/>
    <result property="nombreGerenteRegion" column="NOM_CLIE"/>
    <result property="correoGerenteRegion"  column="VAL_TEXT_COMU"/>
  </resultMap>

  <resultMap id="intefazMYEEnviarZonasResult" class="java.util.HashMap">
    <result property="codigoPais" column="COD_PAIS"/>
    <result property="codigoZona" column="COD_ZONA"/>
    <result property="descripcionZona" column="DES_ZONA"/>
    <result property="codigoRegion" column="COD_REGI"/>
    <result property="direccionGerenteZona" column="DIR_CLIE"/>
    <result property="telefonoGerenteZona" column="NUM_TELE"/>
    <result property="numeroDocumentodentidad"  column="NUM_DOCU_IDEN"/>
    <result property="estadoActividadZona"  column="IND_ACTI"/>
    <result property="correoGerenteZona"  column="EMA_CLIE"/>
    <result property="codigoPlanillaGerenteZona"  column="COD_EMPL"/>
    <result property="codigoGerenteZona"  column="COD_CLIE"/>
     <result property="nombreGerenteZona"  column="NOM_GERE_ZONA"/>																	
  </resultMap>

  <resultMap id="interfazMYEEnviarInstructorasResult" class="java.util.HashMap">
    <result property="codigoPais"           column="PAIS_COD_PAIS"/>
    <result property="codigoEjecutiva"   	column="COD_INST"/>
    <result property="nombreEjecutiva"      column="NOM_INST"/>
    <result property="situacionEjecutiva"   column="SIT_INST"/>
    <result property="email"                column="EMA_INST"/>
	<result property="tipoEjecutiva"        column="TEJE_COD_TIPO_EJEC"/>
  </resultMap>

  <resultMap id="interfazRETEnviarFacturasVentaDirectaResult" class="java.util.HashMap">
	<result property="codigoPais" 			column="CODPAIS"/>
	<result property="numeroFactura" 		column="NUMFAC"/>
	<result property="codigoVenta" 			column="CODVEN"/>
	<result property="codigoProducto" 		column="CODPRO"/>
	<result property="cuentaConsultora" 	column="CODCLI"/>
	<result property="fechaFactura" 		column="FECFAC"/>
	<result property="codigoMarca" 			column="CODMAR"/>
	<result property="unidadesAtendidas" 	column="UNIATE"/>
	<result property="valorTotal" 			column="VALTOT"/>
	<result property="origenFactura" 		column="ORGFAC"/>
	<result property="ubicacionGeografica" 	column="UBIGEO"/>
	<result property="campanyaFactura" 		column="CAMFAC"/>
  </resultMap>

  <resultMap id="interfazRETEnviarComplementoFacturasVentaDirectaResult" class="java.util.HashMap">
	<result property="codigoPais" 							column="CODPAIS"/>
	<result property="numeroFactura" 						column="NUMFAC"/>
	<result property="codigoVenta" 							column="CODVEN"/>
	<result property="codigoProducto" 						column="CODPRO"/>
	<result property="cuentaConsultora" 					column="CODCLI"/>
	<result property="valorVentaCatalogoUnitario" 			column="VVCU"/>
	<result property="valorVentaCatalogoUnitarioDescuento" 	column="VVCUD"/>
	<result property="valorVentaCatalogoDescuento" 			column="VVCD"/>
	<result property="totalImpuesto" 						column="TOTIMP"/>
	<result property="flete" 								column="FLETE"/>
	<result property="tipoDocumento" 						column="TIPDOC"/>
  </resultMap>

  <resultMap id="interfazREUDocumentosAnuladosResult" class="java.util.HashMap">
	<result property="codigoPais" 							column="CODPAIS"/>
	<result property="numeroBoleta" 						column="NUMBOL"/>
	<result property="codigoPeriodo" 						column="CODPERIODO"/>
	<result property="codigoCliente" 						column="CODCLIENTE"/>
	<result property="fechaAnulacion"						column="FECHAANULACION"/>
  </resultMap>

  <resultMap id="interfazOCREnviarRegionesResult" class="java.util.HashMap">
    <result property="codigoRegion" 		column="CODIGOREGION" 	/>
    <result property="descripcionRegion" 	column="DESCRIPCIONREGION"/>
  </resultMap>

  <resultMap id="interfazOCREnviarZonasResult" class="java.util.HashMap">
    <result property="codigoRegion" 	column="CODIGOREGION"/>
    <result property="codigoZona" 	    column="CODIGOZONA"/>
  </resultMap>
  
  <resultMap id="interfazOCREnviarConsolidadoOCSCabeceraResult" class="java.util.HashMap">
    <result property="codigoPais" 		column="COD_PAIS" />
    <result property="periodo" 			column="CAM_SOLI" />
    <result property="codigoCliente"	column="COD_CLIE" />
    <result property="numeroClientes" 	column="NUM_CLIE" />
    <result property="tipoSolicitud" 	column="TIP_SOLI" />
    <result property="subAcceso" 		column="COD_SUBA" />
    <result property="accesoFisico" 	column="COD_ACCE" />
    <result property="tipoDespacho" 	column="TIP_DESP" />
    <result property="fecha"		 	column="FEC_SOLI" />
    <result property="estadoProceso" 	column="STA_PROC" />
  </resultMap>
  
  <resultMap id="interfazOCREnviarConsolidadoOCSDetalleResult" class="java.util.HashMap">
    <result property="codigoPais" 			column="COD_PAIS" />
    <result property="periodo" 				column="CAM_SOLI" />
    <result property="codigoCliente"		column="COD_CLIE" />
    <result property="tipoPosicion" 		column="TIP_POSI" />
    <result property="codigoProducto" 		column="COD_PROD" />
    <result property="unidadesDemandadas"	column="UNI_DEMANDADAS" />
    <result property="estadoProceso" 		column="STA_PROC" />
  </resultMap>

  <resultMap id="interfazEVIRecepcionarOCResult" class="java.util.HashMap">
    <result property="codigoCliente" 					column="COD_CLIE"            />                    
    <result property="fecha" 							column="FEC_RECE"            />                    
    <result property="codigoRegion" 					column="COD_REGI"            />                    
    <result property="descripcionRegion" 				column="DES_REGI"            />                    
    <result property="codigoZona" 						column="COD_ZONA"            />                    
    <result property="descripcionZona" 					column="DES_ZONA"            />                    
    <result property="codigoPeriodo" 					column="COD_PERI"            />                    
    <result property="tipoOC" 							column="TIP_ORDE"            />                    
    <result property="indicadorRechazo"					column="IND_RECH"            />                    
    <result property="deudaPendiente"				 	column="VAL_SALD_DEUD"		 />
    <result property="indicadorActividad"			 	column="IND_ACTI"			 />   
  </resultMap> 
  
  <resultMap id="interfazEVIRecepcionarPrimerosPedidosResult" class="java.util.HashMap">
    <result property="codigoZona" 				column="COD_ZONA" />
    <result property="fecha" 					column="FEC_RECE" />
    <result property="periodo"					column="COD_PERI" />
    <result property="numeroLote"               column="NUM_LOTE" />
    <result property="numeroPrimerosPedidos" 	column="NUM_PRIM_PEDI" />
    <result property="codigoPais"               column="COD_PAIS" />
  </resultMap>

  <resultMap id="interfazEVIPrefacturacionCabeceraResult" class="java.util.HashMap">
    <result property="codigoPais" 		column="CODIGO_PAIS" />
    <result property="codigoPeriodo" 	column="CODIGO_PERIODO" />
    <result property="codigoRegion"		column="CODIGO_REGION" />
    <result property="codigoZona" 	column="CODIGO_ZONA" />
    <result property="pedidosRecibidos" 	column="PEDIDOS_RECIBIDOS" />
    <result property="porcentajeRecepcion" 	column="PORCENTAJE_RECEPCION" />
    <result property="primerosPedidos" 	column="PRIMEROS_PEDIDOS" />
    <result property="pedidosRetenidos" 	column="PEDIDIOS_RETENIDOS" /> 
    <result property="estimadosPedidos" 	column="ESTIMADOS_PEDIDOS" />     
  </resultMap>

  <resultMap id="interfazEVIPrefacturacionDetalleResult" class="java.util.HashMap">
    <result property="codigoPais" 		column="CODIGO_PAIS" />
    <result property="codigoConsultora" 	column="CODIGO_CONSULTORA" />
    <result property="saldoConsultora"		column="SALDO_CONSULTORA" />
  </resultMap>

  <resultMap id="interfazEVIFacturacionCabeceraResult" class="java.util.HashMap">
    <result property="codigoPais" 	column="CODIGO_PAIS" />  
    <result property="codigoRegion" 	column="CODIGO_REGION" />  
    <result property="codigoZona" 	column="CODIGO_ZONA" />  
    <result property="codigoPeriodo" 	column="CODIGO_PERIODO" />  
    <result property="pedidosFacturados" 	column="PEDIDOS_FACTURADOS" />  
    <result property="porcentajePedidosFacturados" 	column="PORCENTAJE_PEDIDOS_FACTURADOS" />  
    <result property="pedidosRechazados" 	column="PEDIDOS_RECHAZADOS" />  
    <result property="montoFacturado" 	column="MONTO_FACTURADO" />  
    <result property="montoEstimadoVenta" 	column="MONTO_ESTIMADO_VENTA" />  
    <result property="estimadoPedidos" 	column="ESTIMADO_PEDIDOS" />                                      
  </resultMap>

  <resultMap id="interfazEVIFacturacionDetalleResult" class="java.util.HashMap">
    <result property="codigoPais" 	column="CODIGO_PAIS" />  
    <result property="codigoPeriodo" 	column="CODIGO_PERIODO" />  
    <result property="codigoConsultora" 	column="CODIGO_CONSULTORA" />  
    <result property="saldoConsultora" 	column="SALDO_CONSULTORA" />  
    <result property="motivoRechazo" 	column="MOTIVO_RECHAZO" />  
  </resultMap>

  <resultMap id="interfazEVIConsultoraCDRResult" class="java.util.HashMap">
    <result property="codigoPais" 			column="COD_PAIS" />
    <result property="codigoCliente"	 	column="COD_CLIE" />  
    <result property="guiaCDR" 				column="NUM_RECL" /> 
	<result property="montoAceptadoGuia" 	column="SOLES_ACEPTADOS" /> 
    <result property="flagRechazo" 			column="RECHAZO_CDR" />  
  </resultMap>

  <resultMap id="interfazEVIConsultoraPuntajeResult" class="java.util.HashMap">
	    <result property="codigoPais" 			column="COD_PAIS" /> 
	    <result property="codigoCliente" 		column="COD_CLIE" />
	    <result property="tipoPuntaje"	 		column="TIPO_PUNTAJE" />   
	    <result property="periodo"	 			column="COD_PERI" />
	    <result property="puntos"	 			column="PUNTOS" />
  </resultMap>

  <resultMap id="interfazSAMEnviarInicializacionStocksResult" class="java.util.HashMap">
	<result property="codigoPais" 			column="CODPAI"/>
	<result property="codigoAlmacen" 		column="CODALM"/>
	<result property="codigoProducto" 		column="CODPRO"/>
	<result property="variacionInventario" 	column="VARINV"/>
  </resultMap>

  <resultMap id="interfazSABEnviarRentabilidadPorZonaResult" class="java.util.HashMap">
	<result property="codigoPais" 			column="CODPAI"/>
	<result property="codigoSociedad" 		column="CODSOC"/>
	<result property="codigoEjercicio" 		column="CODEJE"/>
	<result property="codigoPeriodo" 		column="CODPER"/>
	<result property="codigoZona" 			column="CODZON"/>
	<result property="descripcionZona" 		column="DESZON"/>
	<result property="tipoMoneda" 			column="TIPMON"/>
	<result property="centroCosto" 			column="CENCOS"/>
	<result property="cuentaContable" 		column="CUECON"/>
	<result property="codigoMoneda" 		column="CODMON"/>
	<result property="valorIncobrabilidad"	column="VALINC"/>
  </resultMap>

  <resultMap id="interfazSABEnviarFuenteVentasPrevistaResult" class="java.util.HashMap">
	<result property="codigoPais" 			column="codigoPais"/>
	<result property="codigoSociedad" 		column="codigoSociedad"/>
	<result property="codigoAlmacen" 		column="codigoAlmacen"/>
	<result property="codigoMarca" 		    column="codigoMarca"/>	
	<result property="codigoCanal" 		    column="codigoCanal"/>
	<result property="anio" 		    	column="anio"/>
	<result property="codigoMoneda" 		column="codigoMoneda"/>
	<result property="periodo" 			    column="periodo"/>
	<result property="codigoZona" 			column="codigoZona"/>
	<result property="codigoRegion" 		column="codigoRegion"/>
	<result property="activasIniciales" 	column="activasIniciales"/>
	<result property="activasFinales"	    column="activasFinales"/>
	<result property="ingresos" 			column="ingresos"/>
	<result property="reingresos" 		    column="reingresos"/>
	<result property="egresos" 		        column="egresos"/>
	<result property="rezonificadasRecibidas" 	column="rezonificadasRecibidas"/>
	<result property="rezonificadasEntregadas"	column="rezonificadasEntregadas"/>
	<result property="numeroOrdenes" 		column="numeroOrdenes"/>
	<result property="numeroPedidos" 		column="numeroPedidos"/>
	<result property="unidadesVendidas" 	column="unidadesVendidas"/>
	<result property="numeroClientes" 		column="numeroClientes"/>
	<result property="ventaNeta" 		    column="ventaNeta"/>
	<result property="fechaCierre"	        column="fechaCierre"/>
	<!-- Ini efernandezo -->
	<result property="retencionPosiblesEgresos"			column="VAL_RETE_POSI_EGRE"/>
	<result property="porcentajeEgresosPuros"			column="PORCENTAJEEGRESOSPUROS"/>
	<result property="estimadoPUP"						column="PUP"/>
	<result property="estimadoPPU"  					column="PPU"/>
	<result property="actividadInfladaZona"  			column="VAL_ACTI_LIDE"/>
	<result property="nroConsultorasClientesPrivi"  	column="NUM_CONS_CLIE_PRIV"/>
	<result property="nroClientesInscritosPrivi"  		column="NUM_CLIE_INSC_PRIV"/>
	<result property="nroClientesTransaccionesPrivi"	column="NUM_CLIE_TRAN_PRIV"/>
	<result property="retencion2doPeriodo"  			column="VAL_RETE_2PED"/>
	<result property="retencion3erPeriodo"  			column="VAL_RETE_3PED"/>
	<result property="retencion4toPeriodo"  			column="VAL_RETE_4PED"/>
	<result property="retencionActivas"  				column="VAL_RETE_ACTI"/>
	<result property="porcentajeRotacion" 				column="VAL_PORC_ROTA"/>
	<result property="posiblesEgresos"  				column="VAL_POSI_EGRE"/>
	<!-- Fin efernandezo -->
  </resultMap>

  <resultMap id="interfazBELFacturasCabeceraResult" class="java.util.HashMap">
	<result property="anyoCampanya" 	column="ANYCAM"/>
	<result property="codigoCliente" 	column="CODCLI"/>
	<result property="numeroFactura" 	column="NUMFAC"/>
	<result property="tipoPedido" 		column="TIPPED"/>
	<result property="fechaFactura" 	column="FECFAC"/>
	<result property="tipoDocumento"	column="TIPDOC"/>
  </resultMap>

  <resultMap id="interfazBELFacturasDetalleResult" class="java.util.HashMap">
	<result property="numeroFactura" 		column="NUMFAC"/>
	<result property="codigoVenta" 			column="CODVEN"/>
	<result property="codigoProducto" 		column="CODPRO"/>
	<result property="unidadesAtendidas" 	column="UNIATE"/>
	<result property="unidadesFaltantes" 	column="UNIFAL"/>
	<result property="precioCatalogo" 		column="PRECAT"/>
	<result property="precioFactura" 		column="PREFAC"/>
	<result property="precioContable" 		column="PRECON"/>
  </resultMap>

  <resultMap id="interfazGISEnviarDireccionConsultorasResult" class="java.util.HashMap">                 
	<result property="tipoRegistro" 	column="TIPREG"/>
	<result property="codigoPais" 		column="CODPAI"/>
	<result property="codigoMarca" 		column="CODMAR"/>
	<result property="codigoCanal" 		column="CODCAN"/>
	<result property="codigoCliente" 	column="CODCLI"/>
	<result property="codigoTerritorio"	column="CODTER"/>
	<result property="nombre" 			column="NOMCLI"/>
	<result property="apellidoUno" 		column="APEUNO"/>
	<result property="apellidoDos" 		column="APEDOS"/>
	<result property="estatus" 			column="EST"/>
	<result property="via" 				column="VIA"/>
	<result property="numeroPrincipal" 	column="NUMPRI"/>
	<result property="interior" 		column="INTE"/>
	<result property="manzana" 			column="MAN"/>
	<result property="observaciones" 	column="OBS"/>
	<result property="errorUbicacion" 	column="ERRUBI"/>
	<result property="secuencialVia" 	column="SECVIA"/>
	<result property="ubigeo" 			column="UBIGEO"/>
  </resultMap>

  <resultMap id="clienteSICCDetailResult" class="clienteSICC">
	<result property="oidTipoCliente" 				column="OIDTCL"/>
	<result property="descripcionTipoCliente" 		column="DESTCL"/>
	<result property="oidSubtipoCliente" 			column="OIDSCL"/>
	<result property="descripcionSubtipoCliente" 	column="DESSCL"/>
	<result property="codigo" 						column="CODCLI"/>
	<result property="numeroDocumento" 				column="NUMDOC"/>
	<result property="apellidoPaterno" 				column="APEPAT"/>
	<result property="apellidoMaterno" 				column="APEMAT"/>
	<result property="nombre" 						column="NOMCLI"/>
	<result property="fechaIngreso" 				column="FECING"/>
	<result property="orden1" 						column="ORD1"/>
	<result property="orden2" 						column="ORD2"/>
	<result property="orden3" 						column="ORD3"/>
	<result property="orden4" 						column="ORD4"/>
	<result property="descripcionOrden1" 			column="DESDPT"/>
	<result property="descripcionOrden2" 			column="DESPRO"/>
	<result property="descripcionOrden3" 			column="DESDIS"/>
	<result property="descripcionOrden4" 			column="DESCPO"/>
	<result property="codigoTipoDireccion" 			column="CODTDI"/>
	<result property="descripcionTipoDireccion" 	column="DESTDI"/>
	<result property="codigoTipoVia" 				column="CODTVI"/>
	<result property="descripcionTipoVia" 			column="DESTVI"/>
	<result property="nombreVia" 					column="NOMVIA"/>
	<result property="numeroPrincipal" 				column="NUMPAL"/>
	<result property="observaciones" 				column="OBSERV"/>
	<result property="codigoZona" 					column="CODZON"/>
	<result property="codigoTerritorio" 			column="CODTER"/>
  </resultMap>

  <resultMap id="clienteSICCPendienteResult" class="java.util.HashMap">
	<result property="CODCLI" 	column="CODCLI"/>
	<result property="NOMCOM" 	column="NOMCOM"/>
	<result property="TIPCLI" 	column="TIPCLI"/>
	<result property="SBTCLI" 	column="SBTCLI"/>
	<result property="NUMDOC" 	column="NUMDOC"/>
	<result property="TIPDIR" 	column="TIPDIR"/>
	<result property="DIRCOM" 	column="DIRCOM"/>
	<result property="DESDPT" 	column="DESDPT"/>
	<result property="DESPRO" 	column="DESPRO"/>
	<result property="DESDIS" 	column="DESDIS"/>
	<result property="DESCPO" 	column="DESCPO"/>
	<result property="CODZON" 	column="CODZON"/>
	<result property="CODTER" 	column="CODTER"/>
	<result property="FECING" 	column="FECING"/>
  </resultMap>

  
	<typeAlias alias="PercepcionesVtaDirecta" 		 type="biz.belcorp.ssicc.dao.scdf.model.PercepcionesVtaDirecta"/>
	<typeAlias alias="PercepcionesVtaDirectaDetalle" type="biz.belcorp.ssicc.dao.scdf.model.PercepcionesVtaDirecta"/>
	<typeAlias alias="PercepcionesVtaDirectaSunat" type="biz.belcorp.ssicc.dao.scdf.model.PercepcionesVtaDirecta"/>	


	<resultMap id="interfazMYEPercepcionesVentaDirectaCabeceraResult" class="java.util.HashMap">
		    <result property="codigoPais" 		column="COD_PAIS"/>  
		    <result property="serCope" 			column="SER_COPE"/>
		    <result property="numCope" 			column="NUM_COPE"/>
		    <result property="fecCope" 	    	column="FEC_COPE"/>
		    <result property="conCons" 	    	column="COD_CONS"/>    
		    <result property="monPerc" 			column="MON_PERC"/>
		    <result property="estado" 			column="ESTADO"  />
		    <result property="codAusu" 			column="COD_AUSU"/>
		    <result property="numLote" 			column="NUM_LOTE"/>
		    <result property="auxiliar" 		column="AUXILIAR"/>        
	</resultMap>  
    
  <resultMap id="interfazMYEPercepcionesVentaDirectaDetalleResult" class="java.util.HashMap">
	    <result property="codigoPais" 		column="COD_PAIS"/>  
	    <result property="serCope" 			column="SER_COPE"/>  
	    <result property="numCope" 			column="NUM_COPE"/>
	    <result property="tipDole" 			column="TIP_DOLE"/>    
	    <result property="serDole" 			column="SER_DOLE"/>    
	    <result property="numDole" 			column="NUM_DOLE"/>     
	    <result property="fecDole" 	    	column="FEC_DOLE"/>    
	    <result property="monTodl" 	    	column="MON_TODL"/>        
	    <result property="porPerc" 			column="POR_PERC"/>    
	    <result property="monPerc" 			column="MON_PERC"/>
	    <result property="monPago" 			column="MON_PAGO"/>
	    <result property="auxiliar" 		column="AUXILIAR"/>        
  </resultMap>

  <resultMap id="interfazMYECodigoAutorizacionSunatResult" class="java.util.HashMap">
    <result property="codAuto" 		column="COD_AUTO"/>  
    <result property="numAusu" 		column="NUM_AUSU"/>
    <result property="fecAuto" 		column="FEC_AUTO"/>
    <result property="serDocu" 	    column="SER_DOCU"/>
    <result property="numInau" 	    column="NUM_INAU"/>    
    <result property="numFiau" 		column="NUM_FIAU"/>
    <result property="auxiliar" 	column="AUXILIAR"/>
  </resultMap>
  
  <resultMap id="interfazCOMEnviarLibretaAhorrosResult" class="java.util.HashMap">                 
	<result property="codigoPlanilla" 	     column="CODPLA"/>
	<result property="dni" 		             column="DNI"/>
	<result property="numeroLibretaAhorro" 	 column="NULIAHORRO"/>
	<result property="tipoCuenta" 		     column="TIPCU"/>
	<result property="codigoBanco" 	         column="CODBAN"/>
  </resultMap>

  <resultMap id="interfazCOMEnviarLideresNuevasResult" class="java.util.HashMap">                 
	<result property="nombres" 	               column="NOM"/>
	<result property="apellidoPaterno" 		   column="APEPA"/>
	<result property="apellidoMaterno" 	       column="APEMA"/>
	<result property="fechaIngreso" 		   column="FECING"/>
	<result property="dni" 	                   column="DNI"/>
	<result property="direccion" 	           column="DIR"/>
    <result property="flag"                    column="FLAG"/>
	<result property="telefono" 		       column="TEL"/>
	<result property="fechaNacimiento" 	       column="FECNAC"/>
	<result property="ciudad" 		           column="CIUD"/>
	<result property="estadoCivil" 	           column="ESCIV"/>
	<result property="limaProvincia" 	       column="LIMPRO"/>
	<result property="fechaIngresoPlanilla"    column="FECINGPLA"/>
	<result property="centroCosto" 	           column="CENCOS"/>
	<result property="codigoZona" 		       column="CODZON"/>
	<result property="descripcionDistrito" 	   column="DESDISTR"/>
	<result property="codigoLider" 	           column="CODLID"/>
	<result property="descripcionDepartamento" column="DESDEPA"/>
	<result property="descripcionProvincia"    column="DESPRO"/>
  </resultMap>
  
	<resultMap id="solicitudesMonetariasCabecera" class="java.util.HashMap">
		<result property="codigoPais"				column="PAIS_COD_PAIS"/>
		<result property="correlativo"				column="COR_CUEN_CORR_DOLE"/>
		<result property="codigoPeriodo"			column="COD_PERI"/>
		<result property="codigoCliente"			column="COD_CLIE"/>
		<result property="numeroClientes"			column="NUM_CLIE"/>
		<result property="tipoSolicitud"			column="COD_TIPO_SOLI"/>
		<result property="codigoSubacceso"			column="COD_SBAC"/>
		<result property="codigoAcceso"				column="COD_ACCE"/>
		<result property="tipoDespacho"				column="TIP_DESP"/>
		<result property="fechaFacturacion"			column="FEC_FACT"/>
		<result property="codigoCanalReferencia"	column="COD_CANA_REFE"/>
		<result property="codigoAccesoReferencia"	column="COD_ACCE_REFE"/>
		<result property="codigoSubaccesoReferencia" column="COD_SBAC_REFE"/>
		<result property="numeroDocumentoReferencia" column="NUM_DOCU_REFE"/>
		<result property="status"                    column="STA_PROC"/>
	</resultMap>
	
	<resultMap id="solicitudesMonetariasPosicion" class="java.util.HashMap">
		<result property="codigoPais"				column="PAIS_COD_PAIS"/>
		<result property="codigoPeriodo"			column="COD_PERI"/>
		<result property="codigoCliente"			column="COD_CLIE"/>
		<result property="tipoPosicion"				column="TIP_POSI"/>
		<result property="codigoVenta"				column="COD_VENT"/>
		<result property="cantidad"					column="VAL_CANT"/>
		<result property="codigoProducto"			column="COD_PROD"/>
		<result property="importePercepcion"		column="VAL_IMPO"/>
		<result property="formaPago"				column="COD_FORM_PAGO"/>
		<result property="status"					column="STA_PROC"/>
		<result property="cuentaCorrienteDocle"		column="COR_CUEN_CORR_DOLE"/>
	</resultMap>	

  <resultMap id="productReclamResult" class="java.util.HashMap">                     
    <result property="numLote" 						column="NUMLOTE" 				/>  
    <result property="codigoPais" 					column="CODPAIS" 		/>      
    <result property="codigoCanal" 					column="CODCANAL" 			/>          
    <result property="codigoAcceso" 				column="CODACC"				/>                
    <result property="codigoSubacceso" 				column="CODSUBAC" 		/>      
    <result property="tipoPeriodo" 					column="TIPOPER" 		/>    
    <result property="codigoPeriodo" 				column="CODPER"			/>          
    <result property="fechaEnvio" 					column="FECENVIO"		/>            
    <result property="tipoOferta" 					column="TIPOFER"			/>            
    <result property="tipoMovAlmac" 				column="TIPOMOV"		/>        
    <result property="codigoNegocio" 				column="NEGOCIO"		/>        
    <result property="codigoMarca" 					column="MARCA"		/>        
    <result property="indicadorIST" 				column="INDICADOR"		/>        
    <result property="codigoSap"			 		column="CODSAP"			/>  
    <result property="unidadAdevolver" 				column="UNIDADEVOLV"/>
    <result property="unidadAdevolverRec" 			column="UNIDADEVOLVREC"/>
    <result property="precioNetoUnitLoc" 			column="PRECIONETO" />
    <result property="precioContabUnitLoc" 			column="PRECIOCONT" />
    <result property="almacOrig" 					column="ALMACORIG" />
    <result property="almacDest" 					column="ALMACDEST" />
    <result property="numDoc" 						column="NUMDOC" />
    <result property="codigoOperacion" 				column="CODOPER" />
    <result property="tipoOperacion" 				column="TIPOOPER" />
    <result property="codigoLinea"		 			column="LIN" 				/>  
    <result property="codigoCabecRec"		 		column="RECCAB" 				/>  
    <result property="codigoCabecOper"		 		column="RECOPER" 				/>  
    <result property="tipoIngreso"		 			column="TIPING" 		/>  
    <result property="region"					 	column="REG"				/>  
    <result property="fechareclamo"		 			column="FECREC" 		/>  
    <result property="documentoref"		 			column="DOCREF"			/>  
    <result property="cliente"				 		column="CLIENTE"		/>  
    <result property="codigoVenta"		 			column="CODVENT"		/>  
    <result property="descProducto"		 			column="DESCPROD"		/>  
    <result property="campanhaRef"		 			column="CAMPREF"		/>  
    <result property="unidadesRec"		 			column="UNIDREC"		/>  
    <result property="unidadesDev" 		 			column="UNIDDEVU"		/>  
  </resultMap> 

  <resultMap id="productReclamSAM7Result" class="java.util.HashMap">                     
    <result property="numLote" 						column="NUMLOTE" 				/>  
    <result property="codigoPais" 					column="CODPAIS" 		/>      
    <result property="codigoCanal" 					column="CODCANAL" 			/>          
    <result property="codigoAcceso" 				column="CODACC"				/>                
    <result property="codigoSubacceso" 				column="CODSUBAC" 		/>      
    <result property="tipoPeriodo" 					column="TIPOPER" 		/>    
    <result property="codigoPeriodo" 				column="CODPER"			/>          
    <result property="fechaEnvio" 					column="FECENVIO"		/>            
    <result property="tipoOferta" 					column="TIPOFER"			/>            
    <result property="tipoMovAlmac" 				column="TIPOMOV"		/>        
    <result property="codigoNegocio" 				column="NEGOCIO"		/>        
    <result property="codigoMarca" 					column="MARCA"		/>        
    <result property="indicadorIST" 				column="INDICADOR"		/>        
    <result property="codigoSap"			 		column="CODSAP"			/>  
    <result property="unidadAdevolver" 				column="UNIDADEVOLV"/>
    <result property="unidadAdevolverRec" 			column="UNIDADEVOLVREC"/>
    <result property="precioNetoUnitLoc" 			column="PRECIONETO" />
    <result property="precioContabUnitLoc" 			column="PRECIOCONT" />
    <result property="almacOrig" 					column="ALMACORIG" />
    <result property="almacDest" 					column="ALMACDEST" />
    <result property="numDoc" 						column="NUMDOC" />
    <result property="codigoOperacion" 				column="CODOPER" />
    <result property="tipoOperacion" 				column="TIPOOPER" />
  </resultMap> 

  <resultMap id="consultaReclamResult" class="java.util.HashMap">                     
    <result property="codRec" 						column="CODREC" 				/>  
  </resultMap> 

  <resultMap id="productReclamResultxLote" class="java.util.HashMap">                     
    <result property="fechareclamo"		 			column="FECREC" 		/>  
    <result property="unidadAdevolver" 				column="UNIDADEVOLV"/>
    <result property="unidadAdevolverRec" 				column="UNIDADEVOLVREC"/>
    <result property="descRegion"					column="DESCREG"				/>  
    <result property="descZona"						column="DESCZON"/>
    <result property="descSubacceso" 				column="DESCSUBAC" 		/>      
    <result property="codigoOperacion" 				column="CODOPER" />
    <result property="totalGuias" 		 			column="TOTALGUIAS"		/>  
  </resultMap> 

  <resultMap id="productReclamCabResult" class="java.util.HashMap">
    <result property="codigoPais" 							column="CODPAIS" 		/>           
    <result property="numAtencion" 							column="NUMATENC" 				/>     
	<result property="numReclamo" 							column="NUMRECLAMO" 				/>   
    <result property="codigoCanal" 							column="CODCANAL" 			/>       
    <result property="codigoAcceso" 						column="CODACC"				/>         
    <result property="codigoSubacceso" 					column="CODSUBAC" 		/>         
    <result property="numDocRef" 								column="NUMDOCREF" 		/>         
    <result property="perioDocRef" 							column="PERIODOCREF"			/>     
    <result property="fecDocRef" 								column="FECDOCREF"		/>         
    <result property="codigoCliente"				 		column="CLIENTE"		/>           
    <result property="codigoTipoCliente" 				column="TIPOCLIENTE"			/>     
    <result property="codSubTipoCliente" 				column="SUBTIPOCLIENTE"		/>     
    <result property="codigoSubger" 						column="SUBGERENC"		/>             
    <result property="codigoRegion" 						column="REGION"		/>             
    <result property="codigoMarca" 							column="MARCA"		/>             
    <result property="codigoSeccion" 						column="SECCION"		/>           
    <result property="codigoZona"			 					column="ZONA"			/>             
    <result property="codigoTerritCliente" 			column="TERRITCLIENTE"/>         
    <result property="codigoTipoDoc" 						column="TIPODOC" />              
    <result property="estadoRec" 								column="ESTADOREC" />            
    <result property="codMotivBloq" 						column="MOTIVBLOQ" />            
    <result property="codMotivRech" 						column="MOTIVRECH" />            
    <result property="codMotivDesb" 						column="MOTIVDESB" />            
    <result property="totalEnvia" 							column="TOTALENVIA" />           
    <result property="totalDevuelve" 						column="TOTALDEVUELVE"/>         
    <result property="saldoPagar" 							column="SALDOPAGAR" 	/>         
    <result property="codTipoIng" 							column="TIPOING" 	/>             
    <result property="usuIngreso" 							column="USUINGRESO" 	/>         
    <result property="periodRec" 								column="PERIODREC" 		/>         
    <result property="fecIngreso" 							column="FECINGRESO" 	/>         
    <result property="numAtenInter" 						column="NUMATENINTER" />         
  </resultMap>                                                                   
                                                     
  <resultMap id="productReclamDetResult" class="java.util.HashMap">           
    <result property="codigoPais" 							column="CODPAIS" 		/>        
    <result property="numAtencion" 							column="NUMATENC" 				/>  
	<result property="numSecOper" 							column="NUMSECOPER" 				/>
    <result property="codigoCanal" 							column="CODCANAL" 			/>    
    <result property="codigoAcceso" 						column="CODACC"				/>      
    <result property="codigoSubacceso" 					column="CODSUBAC" 		/>      
    <result property="docRef" 								  column="DOCREF" 		/>        
    <result property="periodRec" 								column="PERIODREC"			/>    
    <result property="codigoPeriodo" 						column="PERIODO"		/>        
    <result property="clienteSeg"				 				column="CLIENTESEG"		/>      
    <result property="tipoOperacion" 						column="TIPOOPER"			/>     	
    <result property="codigoOperacion" 					column="CODOPER"		/>     		
    <result property="tipoBloq" 								column="TIPOBLOQ"		/>        
    <result property="codigoMarca" 							column="MARCA"		/>          
    <result property="indEntrMerc" 							column="INDENTRMERC"		/>    
    <result property="tipoSolicPerd"			 			column="TIPOSOLICPERD"			/>
    <result property="estadoOper" 							column="ESTADOOPER" />        
    <result property="codMotivBloq" 						column="MOTIVBLOQ" />         
    <result property="codMotivRech" 						column="MOTIVRECH" />         
    <result property="codMotivDesb" 						column="MOTIVDESB" />         
    <result property="responPerd" 							column="RESPONPERD" />        
    <result property="flgAsumePerd" 						column="FLGASUMEPERD"/>       
    <result property="montPerdida" 							column="MONTPERDIDA" 	/>      
    <result property="codigoArt" 								column="CODIGOART" 	/>        
    <result property="precPerd" 								column="PRECPERD" 	/>        
    <result property="fecFact" 									column="FECFACT" 	/>         	
    <result property="indAtendido" 							column="INDATENDIDO" />       
	<result property="porcPerdida" 							column="PORCPERDIDA" />       
    <result property="numAtenInter" 						column="NUMATENINTER" />         
  </resultMap>                                                                

  <resultMap id="productReclamDetDetResult" class="java.util.HashMap">          
    <result property="codigoPais" 							column="CODPAIS" 		/>          
    <result property="numAtencion" 							column="NUMATENC" 				/>    
	<result property="numSecOper" 							column="NUMSECOPER" 				/>  
	<result property="numLinea" 								column="NUMLINEA" 				/>    
    <result property="codigoCanal" 							column="CODCANAL" 			/>      
    <result property="indEstado" 								column="INDESTADO" 		/>        
    <result property="codigoPeriodo" 						column="PERIODO"		/>          
    <result property="tipoOferta" 							column="TIPOOFERTA"			/>     	
    <result property="tipoMovim" 								column="TIPOMOVIM"		/>     		
    <result property="codigoMarca" 							column="MARCA"		/>            
    <result property="codMotivDevol" 						column="MOTIVDEVOL" />          
    <result property="codMotivDesb" 						column="MOTIVDESB" />           
    <result property="montoPerdida" 						column="MONTOPERDIDA" 	/>      
    <result property="codigoProducto" 					column="PRODUCTO" 	/>          
    <result property="precioPerdida" 						column="PRECPERDIDA" 	/>        
    <result property="dteEstrateg" 							column="DTEESTRATEG" 	/>        
    <result property="atendido" 								column="INDATENDIDO" />         
	<result property="dteNumOferta"  						column="DTENUMOFERTA"   />      
	<result property="dteLineaOferta"						column="DTELINEAOFERTA" />      
    <result property="unidadReclam" 						column="UNIDADRECLAM" 	/>      
    <result property="precio" 									column="PRECIO" 	/>            
    <result property="importeAbono" 						column="IMPORTEABONO" 	/>      
    <result property="importeCargo" 						column="IMPORTECARGO" 	/>      
    <result property="unidadDevuelt" 	 					column="UNIDADDEVUELT" 	/>      
    <result property="tipoSolic" 								column="TIPOSOLIC" 	/>          
    <result property="tipoPosic" 								column="TIPOPOSIC" 	/>          
    <result property="numAtenInter" 						column="NUMATENINTER" />         		
  </resultMap>                                                                  

	<resultMap id="interfazPERArchivoPDTResult" class="java.util.HashMap">
		<result property="tipoDocumentoIdentidad" column="TIP_DOID"/>
		<result property="numeroDocumentoIdentidad" column="NUM_DOID"/>
		<result property="razonSocial" column="RAZ_SOCI"/>
		<result property="apellidoPaterno" column="APE_PATE"/>
		<result property="apellidoMaterno" column="APE_MATE"/>
		<result property="nombres" column="VAL_NOMB"/>
		<result property="serieComprobantePercepcion" column="SER_COPE"/>
		<result property="numeroComprobantePercepcion" column="NUM_COPE"/>
		<result property="fechaEmisionComprobantePercepcion" column="FEC_COPE"/>
		<result property="indicadorDerechoCreditoFiscal" column="IND_DCFI"/>
	    <result property="ventaMaterialesDestinadoZonaAfec" column="VEN_MATE_DEST"/>
		<result property="indicadorClientesListado" column="IND_CLLI"/>
		<result property="montoPagoComprobantePercepcion" column="MON_PERC"/>
		<result property="tipoComprobantePago" column="TIP_COPA"/>
		<result property="serieComprobantePago" column="SER_DOLE"/>
		<result property="numeroComprobantePago" column="NUM_DOLE"/>
		<result property="fechaEmisionComprobantePago" column="FEC_DOLE"/>
		<result property="montoTotalComprobantePago" column="MON_PAGO"/>
	</resultMap>


  <resultMap id="interfazSICVentaBaseConsultorasResult" class="java.util.HashMap">
	<result property="codigoPais" 		column="COD_PAIS" />   
	<result property="codigoConcurso" 	column="COD_CONCURSO" />   
	<result property="codigoEmpresa" 	column="CODIGO_EMPRESA" />   
	<result property="codigoPeriodo" 	column="COD_PERIODO" />   
	<result property="codigoConsultora" 	column="COD_CLIENTE" />   
	<result property="puntaje" 		column="MONTO_VENTA" />   
 </resultMap>

 <resultMap id="interfazSICVentasPuntajesXCampanyaResult" class="java.util.HashMap">
	<result property="codigoPais" 		column="COD_PAIS" />   
	<result property="codigoEmpresa" 	column="CODIGO_EMPRESA" />   
	<result property="codigoConsultora" 	column="COD_CLIENTE" />   
	<result property="codigoConcurso" 	column="COD_CONCURSO" />  
	<result property="codigoPeriodo" 	column="COD_PERIODO" />   
	<result property="puntosCampanya" 		column="PUNTOS_CAMPANYA" />   
	<result property="puntosAcumulados" 		column="PUNTOS_ACUMULADOS" />   
	<result property="ventaCampanya" 		column="VENTA_CAMPANYA" />   
 </resultMap>
 
 <resultMap id="recaudosBancariosResult" class="java.util.HashMap">
	<result property="numeroLoteExterno" 		column="NUM_LOTE_EXTE" />   
	<result property="consecutivo" 	column="CON_TRAN" />   
	<result property="numeroFacturaBoleta" 	column="NUM_FABO" />   
	<result property="fechaPago" 	column="FEC_PAGO" />  
	<result property="importePago" 	column="IMP_RECA_GENE" />   
	<result property="codigoBancoSicc" 		column="COD_CCBA" />   
	<result property="numeroCupon" 		column="NUM_CUPO" />   
	<result property="codigoConsultora" 		column="COD_CONS" />   
	<result property="digitoChequeo" 		column="DIG_CHEQ" />   
	<result property="oficinaRecaudadora" 		column="OFI_RECA" />   
	<result property="nombreOficina" 		column="NOM_OFIC" />   
	<result property="tipoTransaccion" 		column="TIP_TRAN" />   
	<result property="numeroDocumento" 		column="NUM_DOCU" />   
	<result property="horario" 		column="VAL_HORA" />   
	<result property="usuarioProceso" 		column="USU_PROC" />   
	<result property="fechaProceso" 		column="FEC_PROC" />   
	<result property="horaProceso" 		column="HOR_PROC" />   
 </resultMap>
   
   
 
  <resultMap id="interfazSICInscritasResult" class="java.util.HashMap">
	<result property="codigoConsultora" 	    column="CODIGO_CLIENTE" />   
	<result property="codigoEmpresa" 	        column="CODIGO_EMPRESA" />   	
	<result property="codigoPeriodo" 	        column="CODIGO_PERIODO" />   
	<result property="codigoPais" 	   	        column="CODIGO_PAIS" />   
	<result property="apellidoPaterno" 	        column="APELLIDO_PATERNO" />   
	<result property="apellidoMaterno"    	    column="APELLIDO_MATERNO" />   
	<result property="nombre" 	                column="NOMBRE" />   
	<result property="fechaNacimiento" 	        column="FECHA_NACIMIENTO" />   
	<result property="telefono" 	            column="TELEFONO" />   
	<result property="email" 	                column="EMAIL" />   	
    <result property="celular"                  column="CELULAR" />   
    <result property="indicadorAutorizacion"    column="IND_COMU_PPAL" />   
	<result property="fechaEntregaCarnet" 	    column="FECHA_ENTREGA_CARNET" />   	
	<result property="fechaUltimaModificacion" 	column="FECHA_ULTIMA_MODIFICACION" />   	
	<result property="fechaIngreso" 	        column="FECHA_INGRESO" />   	
	<result property="ultimoUsuarioActualizo" 	column="ULTIMO_USUARIO_ACTUALIZO" />
	<result property="origenInscripcion" 	    column="ORIGEN_INSCRIPCION" />   				
	<result property="claveAccesoDuplaWeb" 	    column="CLAVE_ACCESO_DUPLAWEB" />   				
 </resultMap>

   <resultMap id="interfazOCREnviarRangosPeriodoResult" class="java.util.HashMap">
    <result property="codigoPais" 				column="CODIGOPAIS"/>
    <result property="codigoPeriodoInicio" 	    column="CODIGOPERIODOINICIO"/>
    <result property="codigoPeriodoFin" 	    column="CODIGOPERIODOFIN"/>
    <result property="fecha" 	    			column="FECHA"/>
  </resultMap>
  
 
<typeAlias alias="RecepcionarActualizaCodigoProveedor"    type="biz.belcorp.ssicc.dao.sisicc.model.InterfazCOMRecepcionarActualizaCodigoProveedor"/> 

  <parameterMap id="rentabilidadZonaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSociedad"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroDiasIncobrabilidad"   jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazSABEnviarRentabilidadPorZona" parameterMap="rentabilidadZonaParams" >
		{call CCC_PR_RENTA_ZONA(?,?,?,?,?,?)}
  </procedure>
 
  <parameterMap id="liderNuevaParams"           class="map" >
		<parameter property="codigoPais"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoPeriodo"     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoIdioma"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeCOM_PR_LIDER_NUEVA" parameterMap="liderNuevaParams" >
		{call COM_PR_LIDER_NUEVA(?,?,?)}
  </procedure>


  <!-- INTERFAZ - MYE5 - ENVIAR PERCEPCIONES DE VENTA DIRECTA CABECERA -->
  <select id="getInterfazMYEPercepcionesVentaDirectaCabecera" parameterClass="java.util.Map" resultMap="interfazMYEPercepcionesVentaDirectaCabeceraResult">
           SELECT P.PAIS_COD_PAIS AS COD_PAIS,
				  P.SER_COPE AS SER_COPE,
				  P.NUM_COPE AS NUM_COPE,
		          P.COD_CONS AS COD_CONS,
				  P.FEC_COPE AS FEC_COPE,
                  PER_PKG_PROCE_PERCE.PER_FN_DEVUE_MONTO_PERCE_VTADI(
						P.PAIS_COD_PAIS, P.SER_COPE, P.NUM_COPE, P.COD_CONS) AS MON_PERC,
							
				  P.COD_AUSU AS COD_AUSU,
				  1 AS ESTADO,
				  (SELECT NUM_EJIN FROM BAS_INTER B
					 WHERE B.PAIS_COD_PAIS = #codigoPais#
					 AND   B.SIST_COD_SIST = #codigoSistema#
					 AND   B.COD_INTE = #codigoInterfaz#) AS NUM_LOTE,
				  1 AS AUXILIAR
			 FROM PER_PERCE_VENTA_DIREC P 
			 WHERE P.PAIS_COD_PAIS =#codigoPais#
			 AND   P.FEC_COPE>=TO_DATE(#fechaDesde#,'DD/MM/YYYY')
			 <![CDATA[  
			 AND   P.FEC_COPE<=TO_DATE(#fechaHasta#,'DD/MM/YYYY')
			 ]]>	
			 GROUP BY P.PAIS_COD_PAIS,	
			       	  P.SER_COPE,
					  P.NUM_COPE,     
					  P.COD_CONS,
					  P.FEC_COPE,
					  P.COD_AUSU  
  </select>

  <!-- INTERFAZ - MYE5 - ENVIAR PERCEPCIONES DE VENTA DIRECTA DETALLE -->

  <select id="getInterfazMYEPercepcionesVentaDirectaDetalle" parameterClass="java.util.Map" resultMap="interfazMYEPercepcionesVentaDirectaDetalleResult">
		 SELECT                    P.PAIS_COD_PAIS AS COD_PAIS,
							       P.SER_COPE AS SER_COPE,
							       P.NUM_COPE AS NUM_COPE,
		                           (SELECT COD_HOMO FROM PER_TIPO_DOCUM_IDENT_LEGAL B
			                        WHERE B.PAIS_COD_PAIS = #codigoPais# AND 
                                         COD_CLAS = 'TC' AND	  
                                         COD_AHOM = P.TIP_DOLE) TIP_DOLE,
								   P.SER_DOLE AS SER_DOLE,
								   P.NUM_DOLE AS NUM_DOLE,
								   P.FEC_DOLE AS FEC_DOLE,
								   P.MON_TODL AS MON_TODL,
								   P.POR_PERC AS POR_PERC,
								   P.MON_PERC AS MON_PERC,
								   P.MON_PAGO AS MON_PAGO, 						   
							       1 		  AS AUXILIAR
							FROM PER_PERCE_VENTA_DIREC P
							WHERE P.PAIS_COD_PAIS =#codigoPais#
							      AND P.FEC_COPE>=TO_DATE(#fechaDesde#,'DD/MM/YYYY')
								<![CDATA[  
							      AND P.FEC_COPE<=TO_DATE(#fechaHasta#,'DD/MM/YYYY')
								 ]]>	
					       ORDER BY  
						       SER_COPE,
						       NUM_COPE,
							   SER_DOLE,
						       NUM_DOLE			       
   </select>

  <!-- INTERFAZ - MYE5 - ENVIAR PERCEPCIONES DE VENTA DIRECTA AUTORIZACION SUNAT -->
  <select id="getInterfazMYECodigoAutorizacionSunat" parameterClass="java.util.Map" resultMap="interfazMYECodigoAutorizacionSunatResult">
				select 
					   COD_AUTO AS COD_AUTO,
					   NUM_AUSU AS NUM_AUSU,
					   FEC_AUTO AS FEC_AUTO,
					   SER_DOCU AS SER_DOCU,
					   NUM_INAU AS NUM_INAU,
					   NUM_FIAU AS NUM_FIAU,
					   1 AS AUXILIAR   
				from per_autor_sunat_coper sunat
  </select>


  <!-- INTERFAZ - REUTILIZACION - ENVIAR CRONOGRAMA DE FACTURACION -->
  <select id="getInterfazREUCronogramaFacturacion" parameterClass="java.util.Map" resultMap="interfazREUCronogramaFacturacionResult">
         SELECT NVL(SEG_PAIS.COD_PAIS, ' ') AS CODPAIS,
                NVL(ZON_ZONA.COD_ZONA, ' ') AS CODZONA,
                NVL(SEG_PERIO_CORPO.COD_PERI, ' ') AS ANYOCAMP,
                CRA_CRONO1.FEC_INIC AS FECHAFACT,
                NVL(
                (SELECT CRA_CRONO2.FEC_INIC
                   FROM CRA_CRONO CRA_CRONO2,
                        CRA_ACTIV CRA_ACTIV2
                  WHERE (CRA_CRONO2.CACT_OID_ACTI= CRA_ACTIV2.OID_ACTI)
                  AND   (CRA_CRONO2.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA)
                  AND   (CRA_ACTIV2.COD_ACTI = 'RF')
                  AND   (CRA_CRONO2.PERD_OID_PERI = CRA_PERIO.OID_PERI)
                 ), CRA_CRONO1.FEC_INIC) AS FECHAREFACT
           FROM CRA_PERIO, 
                SEG_CANAL, 
                SEG_MARCA, 
                SEG_PAIS, 
                SEG_PERIO_CORPO,
                SEG_TIPO_PERIO,
                CRA_CRONO CRA_CRONO1,
                CRA_ACTIV CRA_ACTIV1,
                ZON_ZONA 
         WHERE ((CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
         AND    (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
         AND    (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
         AND    (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
         AND    (SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
         AND    (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
         AND    (CRA_CRONO1.PERD_OID_PERI = CRA_PERIO.OID_PERI)
         AND    (CRA_CRONO1.CACT_OID_ACTI = CRA_ACTIV1.OID_ACTI)
         AND    (CRA_CRONO1.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA)
         AND    (SEG_PAIS.COD_PAIS = #codigoPais#)
         AND    (SEG_MARCA.COD_MARC = #codigoMarca#)
         AND    (SEG_CANAL.COD_CANA = #codigoCanal#)
         AND    (CRA_PERIO.VAL_ESTA = 1)
         AND    (ZON_ZONA.IND_ACTI  = 1)
         AND    (CRA_ACTIV1.COD_ACTI = #codigoActividad#)
         <![CDATA[
         AND (SEG_PERIO_CORPO.COD_PERI >= #periodoDesde#)
         AND (SEG_PERIO_CORPO.COD_PERI <= #periodoHasta#)
         ]]> 
         AND NOT EXISTS (
                 SELECT CRA_DETAL_GRUPO_ZONA.ZZON_OID_ZONA
                 FROM  CRA_CABEC_GRUPO_ZONA,
                 CRA_DETAL_GRUPO_ZONA
                 WHERE (CRA_CABEC_GRUPO_ZONA.OID_CABE_GRUP_ZONA = CRA_DETAL_GRUPO_ZONA.CGZO_OID_CABE_GRUP_ZONA)
                 AND   (CRA_DETAL_GRUPO_ZONA.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA)
                 AND   (CRA_CABEC_GRUPO_ZONA.COD_GRUP = #codigoGrupoZona#)
                 AND   (CRA_DETAL_GRUPO_ZONA.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA)
                 )
         )
         UNION ALL
         SELECT NVL(SEG_PAIS.COD_PAIS, ' ') AS CODPAIS,
                NVL(ZON_ZONA.COD_ZONA, ' ') AS CODZONA,
                NVL(SEG_PERIO_CORPO.COD_PERI, ' ') AS ANYOCAMP,
                CRA_CRONO.FEC_INIC AS FECHAFACT,
                CRA_CRONO.FEC_INIC AS FECHAREFACT
           FROM CRA_PERIO, 
                SEG_CANAL, 
                SEG_MARCA, 
                SEG_PAIS, 
                SEG_PERIO_CORPO,
                SEG_TIPO_PERIO,
                CRA_CRONO,
                CRA_ACTIV,
                CRA_CABEC_GRUPO_ZONA,
                CRA_DETAL_GRUPO_ZONA,
                ZON_ZONA 
         WHERE ((CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
         AND    (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
         AND    (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
         AND    (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
         AND    (SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
         AND    (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
         AND    (CRA_CRONO.PERD_OID_PERI = CRA_PERIO.OID_PERI)
         AND    (CRA_CRONO.CACT_OID_ACTI = CRA_ACTIV.OID_ACTI)
         AND    (CRA_CRONO.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA)
         AND    (CRA_CABEC_GRUPO_ZONA.OID_CABE_GRUP_ZONA = CRA_DETAL_GRUPO_ZONA.CGZO_OID_CABE_GRUP_ZONA)
         AND    (CRA_DETAL_GRUPO_ZONA.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA)
         AND    (SEG_PAIS.COD_PAIS = #codigoPais#)
         AND    (SEG_MARCA.COD_MARC = #codigoMarca#)
         AND    (SEG_CANAL.COD_CANA = #codigoCanal#)
         AND    (CRA_PERIO.VAL_ESTA = 1)
         AND    (ZON_ZONA.IND_ACTI  = 1)
         AND    (CRA_ACTIV.COD_ACTI = #codigoRecojoPedidos#)
         AND    (CRA_CABEC_GRUPO_ZONA.COD_GRUP = #codigoGrupoZona#)
         <![CDATA[
         AND    (SEG_PERIO_CORPO.COD_PERI >= #periodoDesde#)
         AND    (SEG_PERIO_CORPO.COD_PERI <= #periodoHasta#)
         ]]> 
         )
         ORDER BY 1, 3, 2, 4
  </select>

  <!-- INTERFAZ - MYEBEL - ENVIAR MOVIMIENTOS DE CUENTA CORRIENTE -->
  <select id="getInterfazMYEMovimientosCuentaCorriente" parameterClass="java.util.Map" resultMap="intefazMYEMovimientosCuentaCorrienteResult">
    SELECT DISTINCT
           NVL(SEG_PAIS.COD_PAIS, ' ')  AS CODPAIS, 
           NVL(MAE_CLIEN.COD_CLIE, ' ') AS CODCON,
           #numeroLote# AS NUMSEC,
           (CASE CCC_SUBPR.VAL_INDI_CONS 
              WHEN 'D' THEN 'C' 
              WHEN 'H' THEN 'A'
              ELSE ' '
            END) AS TIPOPE,
    
           (CASE 
              WHEN CCC_DETAL_CARGO_ABONO_DIREC.FEC_PAGO_BANC IS NULL THEN TO_CHAR(CCC_DETAL_CARGO_ABONO_DIREC.FEC_MOVI, 'YYYYMMDD')
              ELSE TO_CHAR(CCC_DETAL_CARGO_ABONO_DIREC.FEC_PAGO_BANC, 'YYYYMMDD')
            END) AS FECOPE,
             
           TO_CHAR(CCC_MOVIM_CUENT_CORRI.FEC_VENC, 'YYYYMMDD') AS FECVEN,
           
           (CASE CCC_SUBPR.VAL_INDI_CONS
              WHEN 'D' THEN NVL(SEG_PERIO_CORPO.COD_PERI, ' ')
              ELSE ' '
            END) AS ANYCAM,

           <![CDATA[            
           (CASE CCC_PROCE.COD_PROC
              WHEN 'CCC001' THEN 
                (CASE 
                   WHEN CCC_DETAL_CARGO_ABONO_DIREC.IMP > 0 THEN 'PED. C-' || SEG_PERIO_CORPO.COD_PERI || ' B.DESPACHO ' ||  CCC_MOVIM_CUENT_CORRI.VAL_EJER_CUOT || LPAD(CCC_MOVIM_CUENT_CORRI.NUM_IDEN_CUOT, 8, '0')
                   ELSE (SELECT DISTINCT
                                GEN_I18N_SICC_COMUN.VAL_I18N || ' C-' || SEG_PERIO_CORPO.COD_PERI || ' NRO. ' || REC_CABEC_RECLA.NUM_RECL
                           FROM PED_SOLIC_CABEC,
                                REC_OPERA,
                                REC_CABEC_RECLA,
                                CRA_PERIO,
                                SEG_PERIO_CORPO,
                                PED_TIPO_SOLIC_PAIS,
                                PED_TIPO_SOLIC,
                                GEN_I18N_SICC_COMUN,
                                SEG_IDIOM
                           WHERE ((PED_SOLIC_CABEC.VAL_NUME_SOLI = TO_NUMBER(CCC_MOVIM_CUENT_CORRI.VAL_EJER_CUOT || LPAD (CCC_MOVIM_CUENT_CORRI.NUM_IDEN_CUOT, 8, '0')))
                           AND   (PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS = REC_OPERA.TSPA_OID_SOLI_PAIS_GENE)
                           AND   (PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS = PED_TIPO_SOLIC_PAIS.OID_TIPO_SOLI_PAIS)
                           AND   (PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI = PED_TIPO_SOLIC.OID_TIPO_SOLI)
                           AND   (REC_CABEC_RECLA.SOCA_OID_SOLI_CABE = PED_SOLIC_CABEC.SOCA_OID_DOCU_REFE)
                           AND   (PED_SOLIC_CABEC.PERD_OID_PERI = CRA_PERIO.OID_PERI)
                           AND   (REC_CABEC_RECLA.PERD_OID_PERI_DOCU_REFE = CRA_PERIO.OID_PERI)
                           AND   (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
                           AND   (GEN_I18N_SICC_COMUN.ATTR_ENTI = 'PED_TIPO_SOLIC')
                           AND   (SEG_IDIOM.COD_IDIO = #codigoIdioma#)
                           AND   (SEG_IDIOM.OID_IDIO = GEN_I18N_SICC_COMUN.IDIO_OID_IDIO)
                           AND   (GEN_I18N_SICC_COMUN.VAL_OID = PED_TIPO_SOLIC.OID_TIPO_SOLI)
                                 )
                        )                                               
                 END)
                 
              WHEN 'TES001' THEN (SELECT 'Pago ' || CCC_BANCO.DES_BANC
                                    FROM CCC_CUENT_CORRI_BANCA,
                                         CCC_SUCUR,
                                         CCC_BANCO
                                    WHERE (CCC_DETAL_CARGO_ABONO_DIREC.CCBA_OID_CUEN_CORR_BANC = CCC_CUENT_CORRI_BANCA.OID_CUEN_CORR_BANC) 
                                    AND   (CCC_CUENT_CORRI_BANCA.SUCU_OID_SUCU = CCC_SUCUR.OID_SUCU)
                                    AND   (CCC_SUCUR.CBAN_OID_BANC = CCC_BANCO.OID_BANC)
                                 )
              ELSE
                (CASE WHEN (CCC_PROCE. COD_PROC <> 'TES001') AND (CCC_PROCE. COD_PROC <> 'CCC001') THEN
                   (SELECT GEN_I18N_SICC_PAIS.VAL_I18N
                      FROM CCC_TIPO_CARGO_ABONO,
                           GEN_I18N_SICC_PAIS,
                           SEG_IDIOM
                      WHERE (CCC_TIPO_ABONO_SUBPR.TCAB_OID_TCAB = CCC_TIPO_CARGO_ABONO.OID_TIPO_CARG_ABON)
                      AND   (GEN_I18N_SICC_PAIS.ATTR_ENTI = 'CCC_TIPO_CARGO_ABONO')
                      AND   (SEG_IDIOM.COD_IDIO = #codigoIdioma#)
                      AND   (SEG_IDIOM.OID_IDIO = GEN_I18N_SICC_PAIS.IDIO_OID_IDIO)
                      AND   (GEN_I18N_SICC_PAIS.VAL_OID = CCC_TIPO_CARGO_ABONO.OID_TIPO_CARG_ABON)
                   )   
                 END)
            END) AS DESTRA,
            ]]> 
            
           NVL(CCC_DETAL_CARGO_ABONO_DIREC.IMP, 0) AS MONOPE
            
     FROM  CCC_DETAL_CARGO_ABONO_DIREC,
           CCC_MOVIM_CUENT_CORRI,
           MAE_CLIEN,
           SEG_PAIS,
           CCC_TIPO_ABONO_SUBPR,
           CCC_SUBPR,
           CCC_PROCE,
           SEG_SUBAC,
           SEG_ACCES,
           SEG_CANAL,
           CRA_PERIO,
           SEG_PERIO_CORPO
     WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
     AND   (SEG_CANAL.COD_CANA = #codigoCanal#)
     AND   (SEG_ACCES.COD_ACCE = #codigoAcceso#)
     <isNotEmpty prepend="AND" property="codigoSubacceso">
           (SEG_SUBAC.COD_SBAC = #codigoSubacceso#) 
     </isNotEmpty>
     <!--isNotEmpty prepend="AND" property="fechaUltimoProceso">
     <![CDATA[    
      (CCC_DETAL_CARGO_ABONO_DIREC.FEC_MOVI > #fechaUltimoProceso#)
     ]]>  
     </isNotEmpty-->
     <isNotEmpty prepend="AND" property="numeroDiasModificacion">
     <![CDATA[    
      (CCC_DETAL_CARGO_ABONO_DIREC.FEC_MOVI > SYSDATE - #numeroDiasModificacion#)
     ]]>  
     </isNotEmpty>
     AND   (CCC_SUBPR.VAL_INDI_CONS IN ('D', 'H'))
     AND   (CCC_DETAL_CARGO_ABONO_DIREC.MVCC_OID_MOVI_CC  = CCC_MOVIM_CUENT_CORRI.OID_MOVI_CC)
     AND   (CCC_DETAL_CARGO_ABONO_DIREC.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
     AND   (MAE_CLIEN.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
     AND   (CCC_DETAL_CARGO_ABONO_DIREC.TASP_OID_TIPO_ABON_SUBP = CCC_TIPO_ABONO_SUBPR.OID_TIPO_ABON_SUBP)
     AND   (CCC_TIPO_ABONO_SUBPR.SUBP_OID_SUBP = CCC_SUBPR.OID_SUBP)
     AND   (CCC_SUBPR.CCPR_OID_PROC = CCC_PROCE.OID_PROC)
     AND   (CCC_MOVIM_CUENT_CORRI.SBAC_OID_SBAC = SEG_SUBAC.OID_SBAC)
     AND   (SEG_SUBAC.ACCE_OID_ACCE = SEG_ACCES.OID_ACCE)
     AND   (SEG_ACCES.CANA_OID_CANA = SEG_CANAL.OID_CANA)
     AND   (CCC_MOVIM_CUENT_CORRI.PERD_OID_PERI = CRA_PERIO.OID_PERI)
     AND   (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
     )
     ORDER BY ANYCAM, FECVEN, CODCON
  </select>

  <!-- INTERFAZ - MYEBEL - ENVIAR REGIONES -->
  <select id="getInterfazMYEEnviarRegiones" parameterClass="java.util.Map" resultMap="intefazMYEEnviarRegionesResult">
    SELECT SEG_PAIS.COD_PAIS,
           ZON_REGIO.COD_REGI,
           ZON_REGIO.DES_REGI,
           MAE_CLIEN.COD_CLIE,
           LTRIM(TRIM(MAE_CLIEN.VAL_NOM1) || ' ' || TRIM(MAE_CLIEN.VAL_APE1) || ' ' ||  TRIM(MAE_CLIEN.VAL_APE2)) NOM_CLIE,
           MAE_TIPO_COMUN_EMAIL.VAL_TEXT_COMU
      FROM ZON_REGIO,
           SEG_PAIS,
           SEG_MARCA,
           SEG_CANAL,
           MAE_CLIEN,
           (SELECT MAE_TIPO_COMUN.COD_TIPO_COMU,
                   MAE_CLIEN_COMUN.CLIE_OID_CLIE,
                   MAE_CLIEN_COMUN.VAL_TEXT_COMU
            FROM MAE_TIPO_COMUN,
            MAE_CLIEN_COMUN
            WHERE ((MAE_TIPO_COMUN.OID_TIPO_COMU = MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU)
            AND    (MAE_TIPO_COMUN.COD_TIPO_COMU = 'ML') )
           ) MAE_TIPO_COMUN_EMAIL
     WHERE (    (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
            AND (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)
            AND (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
            AND (MAE_CLIEN.OID_CLIE (+) = ZON_REGIO.CLIE_OID_CLIE)
            AND (ZON_REGIO.IND_ACTI = 1)
            AND (MAE_CLIEN.OID_CLIE = MAE_TIPO_COMUN_EMAIL.CLIE_OID_CLIE (+))
            AND (SEG_PAIS.COD_PAIS = #codigoPais#)
            AND (SEG_MARCA.COD_MARC = #codigoMarca#)
            AND (SEG_CANAL.COD_CANA = #codigoCanal#)
           )
           ORDER BY COD_REGI
  </select>

  <!-- INTERFAZ - MYEBEL - ENVIAR ZONAS -->
  <select id="getInterfazMYEEnviarZonas" parameterClass="java.util.Map" resultMap="intefazMYEEnviarZonasResult">
    SELECT SEG_PAIS.COD_PAIS,
           ZON_ZONA.COD_ZONA,
           ZON_ZONA.DES_ZONA,
           ZON_REGIO.COD_REGI,
           SEG_TIPO_VIA.DES_ABRV_TIPO_VIA || ' ' || MAE_CLIEN_DIREC.VAL_NOMB_VIA || ' ' || MAE_CLIEN_DIREC.NUM_PPAL || ' ' || MAE_CLIEN_DIREC.VAL_OBSE DIR_CLIE, 
           MAE_TIPO_COMUN_TELEF.VAL_TEXT_COMU NUM_TELE,
           MAE_CLIEN_IDENT.NUM_DOCU_IDEN,
           ZON_ZONA.IND_ACTI,
           MAE_TIPO_COMUN_EMAIL.VAL_TEXT_COMU EMA_CLIE,
           MAE_CLIEN_DATOS_ADICI.COD_EMPL,
           MAE_CLIEN.COD_CLIE,
           GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(MAE_CLIEN.OID_CLIE,'NOM_CLIE')	NOM_GERE_ZONA												
      FROM ZON_ZONA,
           ZON_REGIO,
           SEG_PAIS,
           SEG_TIPO_VIA,
           SEG_MARCA,
           SEG_CANAL,
           MAE_CLIEN,
           MAE_CLIEN_DATOS_ADICI,
           MAE_CLIEN_DIREC,
           MAE_CLIEN_IDENT,
           (SELECT MAE_TIPO_COMUN.COD_TIPO_COMU,
                   MAE_CLIEN_COMUN.CLIE_OID_CLIE,
                   MAE_CLIEN_COMUN.VAL_TEXT_COMU
            FROM MAE_TIPO_COMUN,
            MAE_CLIEN_COMUN
            WHERE ((MAE_TIPO_COMUN.OID_TIPO_COMU = MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU)
            AND    (MAE_TIPO_COMUN.COD_TIPO_COMU = 'ML') )
           ) MAE_TIPO_COMUN_EMAIL,
           (SELECT MAE_TIPO_COMUN.COD_TIPO_COMU,
                   MAE_CLIEN_COMUN.CLIE_OID_CLIE,
                   MAE_CLIEN_COMUN.VAL_TEXT_COMU
            FROM MAE_TIPO_COMUN,
            MAE_CLIEN_COMUN
            WHERE ((MAE_TIPO_COMUN.OID_TIPO_COMU = MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU)
            AND    (MAE_TIPO_COMUN.COD_TIPO_COMU = 'TF') )
           ) MAE_TIPO_COMUN_TELEF
     WHERE (    (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
            AND (MAE_CLIEN.OID_CLIE (+) = ZON_ZONA.CLIE_OID_CLIE)
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_DIREC.CLIE_OID_CLIE (+))
            AND (SEG_PAIS.OID_PAIS = ZON_ZONA.PAIS_OID_PAIS)
            AND (SEG_TIPO_VIA.OID_TIPO_VIA (+) = MAE_CLIEN_DIREC.TIVI_OID_TIPO_VIA)
            AND (SEG_MARCA.OID_MARC = ZON_ZONA.MARC_OID_MARC)
            AND (SEG_CANAL.OID_CANA = ZON_ZONA.CANA_OID_CANA)
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE (+))
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_IDENT.CLIE_OID_CLIE (+))
            AND (MAE_CLIEN_IDENT.VAL_IDEN_DOCU_PRIN (+) = 1)
            AND (MAE_CLIEN.OID_CLIE = MAE_TIPO_COMUN_EMAIL.CLIE_OID_CLIE (+))
            AND (MAE_CLIEN.OID_CLIE = MAE_TIPO_COMUN_TELEF.CLIE_OID_CLIE (+))
            AND (SEG_PAIS.COD_PAIS = #codigoPais#)
            AND (SEG_MARCA.COD_MARC = #codigoMarca#)
            AND (SEG_CANAL.COD_CANA = #codigoCanal#)
            AND (MAE_CLIEN_DIREC.IND_DIRE_PPAL (+) = 1)
            AND (MAE_CLIEN_DIREC.IND_ELIM (+) = 0)
            AND (ZON_ZONA.IND_ACTI = 1)
           )
           ORDER BY COD_REGI, COD_ZONA
  </select>

  <!-- INTERFAZ - RETAIL - ENVIAR MATRIZ DE CAMPAA -->
  <select id="getInterfazRETEnviarMatrizCampanya" parameterClass="java.util.Map" resultMap="interfazRETEnviarMatrizCampanyaResult">
      SELECT NVL(SEG_PAIS.COD_PAIS, ' ') AS CODPAIS, 
             NVL(SEG_PERIO_CORPO.COD_PERI, ' ') AS CODPER,
             NVL(PRE_OFERT_DETAL.VAL_CODI_VENT, ' ') AS CODVEN,
             NVL(MAE_PRODU.COD_SAP, ' ') AS CODPRO,
             NVL(MAE_PRODU.DES_CORT, ' ') AS DSCPRO,
             NVL(PRE_TIPO_OFERT.COD_TIPO_OFER, ' ') AS CODOFE,
             NVL(PRE_OFERT_DETAL.IMP_PREC_CATA, 0) AS PRECAT,
             NVL(PRE_TIPO_OFERT.IND_COMI, 0) AS FLGCOM,
             NVL(PED_TASA_IMPUE.VAL_TASA_IMPU, 0) AS TASIMP, 
             NVL(SEG_MARCA_PRODU.COD_MARC_PROD, ' ') AS MARPRO,
             NVL(MAE_NEGOC.COD_NEGO, ' ') AS CODNEG, 
             NVL(MAE_UNIDA_NEGOC.COD_UNID_NEGO, ' ') AS CODUNE, 
             ' ' AS VALDES
       	FROM PRE_OFERT_DETAL,
			 PRE_TIPO_OFERT,
			 SEG_PAIS,
			 SEG_MARCA,
			 SEG_CANAL,
             SEG_ACCES,
			 SEG_SUBAC,
			 CRA_PERIO,
			 SEG_PERIO_CORPO,
			 SEG_TIPO_PERIO,
         	 MAE_PRODU,
			 MAE_NEGOC,
			 MAE_UNIDA_NEGOC,
			 SEG_MARCA_PRODU,
         	 PED_IMPUE_GENER,
         	 PED_TASA_IMPUE
        WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
        AND	  (SEG_MARCA.COD_MARC = #codigoMarca#)
        AND	  (SEG_CANAL.COD_CANA = #codigoCanal#)
        AND	  (SEG_ACCES.COD_ACCE = #codigoAcceso#)
        AND	  (SEG_SUBAC.COD_SBAC = #codigoSubacceso#)
              <![CDATA[    
        AND	  (SEG_PERIO_CORPO.COD_PERI >= #periodoDesde#)
              ]]>	
              <![CDATA[    
        AND	  (SEG_PERIO_CORPO.COD_PERI <= #periodoHasta#)
              ]]>
        AND	  (PRE_OFERT_DETAL.IND_DIGI = 1)
 	    AND	  (PRE_OFERT_DETAL.TOFE_OID_TIPO_OFER = PRE_TIPO_OFERT.OID_TIPO_OFER)
	   	AND	  (CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
	   	AND   (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
	   	AND	  (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
 	    AND	  (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
		AND	  (SEG_SUBAC.ACCE_OID_ACCE = SEG_ACCES.OID_ACCE)
 	    AND	  (SEG_ACCES.CANA_OID_CANA = SEG_CANAL.OID_CANA)
	   	AND	  (SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
	   	AND	  (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
	   	AND   (PRE_OFERT_DETAL.PROD_OID_PROD = MAE_PRODU.OID_PROD)
	   	AND   (MAE_PRODU.NEGO_OID_NEGO = MAE_NEGOC.OID_NEGO)
	   	AND   (MAE_PRODU.UNEG_OID_UNID_NEGO = MAE_UNIDA_NEGOC.OID_UNID_NEGO)
	   	AND   (MAE_PRODU.MAPR_OID_MARC_PROD = SEG_MARCA_PRODU.OID_MARC_PROD)
	   	AND	  (PED_IMPUE_GENER.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
		AND	  (PED_IMPUE_GENER.SBAC_OID_SBAC = SEG_SUBAC.OID_SBAC) 
		AND	  (PED_IMPUE_GENER.TAIM_OID_TASA_IMPU = PED_TASA_IMPUE.OID_TASA_IMPU) 
              )
  </select>


  <select id="getInterfazMYEEnviarInstructoras" parameterClass="java.util.Map" resultMap="interfazMYEEnviarInstructorasResult">
    SELECT PAIS_COD_PAIS,
           'I' || COD_INST AS COD_INST,
           nvl(APE_PATE,' ') || ' ' || nvl(APE_MATE,' ') || ' ' ||nvl(PRI_NOMB,' ') || ' ' ||nvl(SEG_NOMB,' ') AS NOM_INST,
           DECODE(SIT_INST,'A','1','0') AS SIT_INST,
           EMA_INST,
		   TEJE_COD_TIPO_EJEC
      FROM EDU_MAEST_INSTR 
      WHERE PAIS_COD_PAIS = #codigoPais#
	<![CDATA[
        AND EST_REGI <> '9'
    ]]>
     ORDER BY COD_INST
  </select>


  <!-- INTERFAZ - RET - ENVIAR FACTURAS DE VENTA DIRECTA -->
   <parameterMap id="interfazRETEnviarFacturaVentaDirectaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="origenFactura"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazRETEnviarFacturaVentaDirecta" parameterMap="interfazRETEnviarFacturaVentaDirectaParams" >
		{call INT_PKG_RETAI.INT_PR_RET_FACTU_VENTA_DIREC(?, ?, ?, ?, ?, ?, ?, ?, ?)}
  </procedure>
  

  <parameterMap id="interfazRETEnviarCompleFacturaVentaDirectaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazRETEnviarCompleFacturaVentaDirecta" parameterMap="interfazRETEnviarCompleFacturaVentaDirectaParams" >
		{call INT_PKG_RETAI.INT_PR_RET_COMPL_FACTU_VTADI(?, ?, ?, ?, ?, ?, ?, ?)}
  </procedure>


  <!-- INTERFAZ - REUTILIZACION - ENVIAR CONSULTORAS -->
  <select id="getInterfazREUEnviarConsultoras" parameterClass="java.util.Map" resultMap="interfazREUEnviarConsultorasResult">
    SELECT B1.COD_PAIS,
           B1.COD_CLIE,
    	   B1.OID_CLIE,
    	   B1.VAL_APE1,
    	   B1.VAL_APE2,
    	   B1.VAL_NOM1,
    	   B1.VAL_NOM2,
    	   B1.COD_SEXO,
    	   B1.FEC_NACI,
    	   B1.COD_ESTA_CIVI,
    	   B1.COD_ESTA_CLIE,
    	   (CASE B1.COD_TIPO_DOCU
    	    WHEN '01' THEN B1.NUM_DOCU_IDEN
    	    ELSE ' '
    	    END
    	   ) AS NUM_DOCU_IDEN,
    	   B1.COD_TIPO_VIA,
    	   B1.VAL_NOMB_VIA,
    	   B1.NUM_PPAL,
    	   B1.VAL_OBSE,
    	   B1.VAL_COD_POST,
    	   B1.VAL_TELE_FIJO,
    	   B1.VAL_TELE_CELU,
    	   B1.VAL_TELE_OFIC,
    	   B1.VAL_CORR_ELEC,
    	   B2.COD_SUBG_VENT,
    	   B2.COD_REGI,
    	   B2.COD_ZONA,
    	   B2.COD_SECC,
    	   NVL (B1.COD_TERR, 0) AS COD_TERR,
    	   (CASE B1.COD_NSE2
          WHEN NULL THEN NVL (B1.COD_NSE1, ' ')
    	    ELSE NVL (B1.COD_NSE2, ' ')
    	    END
    	   ) AS EST_SOCI_ECON,
    	   B1.ORDE_1,
    	   B1.ORDE_2,
    	   B1.NOM_DEPA,
    	   B1.NOM_PROV,
    	   B1.NOM_DIST,
    	   B2.CAM_ULTI_PEDI,
    	   0 AS SAL_CUEN_CORR,
    	   (CASE B1.IND_ACTI
    	    WHEN 0 THEN 'N'
    	    ELSE 
    			CASE B1.COD_TIPO_BLOQ
    	        WHEN '01' THEN 'N'
    	        WHEN '02' THEN 'N'
    	        ELSE 'S'
    	        END
    	    END
    	   ) AS IND_PEDI,
    	   (CASE B1.COD_ESTA_CLIE
    	    WHEN '01' THEN '1 '
    	    ELSE 
    		    CASE B3.COD_TIPO_CONS
    	        WHEN 'L' THEN 'L'
    	        ELSE 'R'
    	        END
    	    END
    	   ) AS COD_TIPO_CONS,
    	   (CASE B1.IND_ACTI
    	    WHEN 0 THEN '01'
    	    ELSE 
    		    CASE B1.COD_TIPO_BLOQ
    	        WHEN '01' THEN '01'
    	        WHEN '02' THEN '01'
    	        ELSE '00'
    	        END
    	    END
    	   ) AS EST_CONS,
    	   B1.COD_TIPO_DOCU AS COD_TIPO_DOCU,
    	  (CASE B1.COD_TIPO_DOCU
    	   WHEN '02' THEN NVL (B1.NUM_DOCU_IDEN, ' ')
    	   ELSE ' '
    	   END
    	  ) AS NUM_RUC,
    	  (CASE B1.COD_TIPO_DOCU
    	   WHEN '01' THEN '0'
    	   ELSE '1'
    	   END
    	  ) AS FLA_EMIT_FACT,
    	  #valorPorcentajeDcto# AS VAL_PORC_DESC,
    	  B6.FEC_EGRE,
    	  B7.CAM_INGR,
    	  B4.VAL_PREC_FACT_TOTA_LOCA,
    	  B5.VAL_NIV1
    FROM
    (
    SELECT SEG_PAIS.COD_PAIS,
           MAE_CLIEN.OID_CLIE,
           MAE_CLIEN.COD_CLIE,
           MAE_CLIEN.VAL_APE1,
           MAE_CLIEN.VAL_APE2,
           MAE_CLIEN.VAL_NOM1,
           MAE_CLIEN.VAL_NOM2,
           MAE_CLIEN.COD_SEXO,
           MAE_CLIEN_DATOS_ADICI.FEC_NACI,
           MAE_CLIEN_DATOS_ADICI.IND_ACTI,
           MAE_ESTAD_CIVIL.COD_ESTA_CIVI,
           MAE_ESTAT_CLIEN.COD_ESTA_CLIE,
           SEG_TIPO_VIA.COD_TIPO_VIA,
           MAE_CLIEN_DIREC.VAL_NOMB_VIA,
           MAE_CLIEN_DIREC.NUM_PPAL,
           MAE_CLIEN_DIREC.VAL_OBSE,
           MAE_CLIEN_DIREC.VAL_COD_POST,
           MAE_CLIEN_IDENT.NUM_DOCU_IDEN,
           MAE_TIPO_DOCUM.COD_TIPO_DOCU,
           ZON_TERRI.COD_TERR,
           ZON_TERRI.COD_NSE1,
           ZON_TERRI.COD_NSE2,
           TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 1, 6)) AS ORDE_1,
           TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 7, 6)) AS ORDE_2,
           TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 13, 6)) AS ORDE_3,
           TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 19, 6)) AS ORDE_4,
           (SELECT NVL (ZONA.DES_GEOG, ' ')
              FROM ZON_VALOR_ESTRU_GEOPO ZONA
             WHERE ZONA.ORDE_1 = TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 1, 6))
               AND ZONA.ORDE_2 IS NULL
               AND ZONA.ORDE_3 IS NULL
               AND ZONA.ORDE_4 IS NULL
               AND ZONA.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS
               AND ROWNUM = 1) AS NOM_DEPA,
           (SELECT NVL (ZONA.DES_GEOG, ' ')
              FROM ZON_VALOR_ESTRU_GEOPO ZONA
             WHERE ZONA.ORDE_1 = TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 1, 6))
               AND ZONA.ORDE_2 = TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 7, 6))
               AND ZONA.ORDE_3 IS NULL
               AND ZONA.ORDE_4 IS NULL
               AND ZONA.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS
               AND ROWNUM = 1) AS NOM_PROV,
           (SELECT NVL (ZONA.DES_GEOG, ' ')
              FROM ZON_VALOR_ESTRU_GEOPO ZONA
             WHERE ZONA.ORDE_1 = TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 1, 6))
               AND ZONA.ORDE_2 = TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 7, 6))
               AND ZONA.ORDE_3 = TRIM (SUBSTR (MAE_CLIEN_DIREC.COD_UNID_GEOG, 13, 6))
               AND ZONA.ORDE_4 IS NULL
               AND ZONA.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS
               AND ROWNUM = 1) AS NOM_DIST,
    	   (SELECT MAE_CLIEN_COMUN.VAL_TEXT_COMU
    	    FROM MAE_CLIEN_COMUN, MAE_TIPO_COMUN
    		WHERE MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU
    		AND MAE_TIPO_COMUN.COD_TIPO_COMU = 'TF'
    		AND MAE_CLIEN_COMUN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE
    	   ) VAL_TELE_FIJO,
    	   (SELECT MAE_CLIEN_COMUN.VAL_TEXT_COMU
    	    FROM MAE_CLIEN_COMUN, MAE_TIPO_COMUN
    		WHERE MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU
    		AND MAE_TIPO_COMUN.COD_TIPO_COMU = 'TM'
    		AND MAE_CLIEN_COMUN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE
    	   ) VAL_TELE_CELU,
    	   (SELECT MAE_CLIEN_COMUN.VAL_TEXT_COMU
    	    FROM MAE_CLIEN_COMUN, MAE_TIPO_COMUN
    		WHERE MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU
    		AND MAE_TIPO_COMUN.COD_TIPO_COMU = 'TT'
    		AND MAE_CLIEN_COMUN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE
    	   ) VAL_TELE_OFIC,
    	   (SELECT MAE_CLIEN_COMUN.VAL_TEXT_COMU
    	    FROM MAE_CLIEN_COMUN, MAE_TIPO_COMUN
    		WHERE MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU
    		AND MAE_TIPO_COMUN.COD_TIPO_COMU = 'ML'
    		AND MAE_CLIEN_COMUN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE
    	   ) VAL_CORR_ELEC,
           MAE_TIPO_BLOQU.COD_TIPO_BLOQ
      FROM SEG_PAIS,
           MAE_CLIEN,
           MAE_CLIEN_DATOS_ADICI,
           MAE_CLIEN_TIPO_SUBTI,
           MAE_TIPO_CLIEN,
           MAE_ESTAD_CIVIL,
           MAE_ESTAT_CLIEN,
           SEG_TIPO_VIA,
           MAE_CLIEN_IDENT,
           MAE_CLIEN_DIREC,
           MAE_TIPO_DOCUM,
           ZON_TERRI,
           MAE_CLIEN_BLOQU,
           MAE_TIPO_BLOQU
     WHERE (    (SEG_PAIS.OID_PAIS = MAE_CLIEN.PAIS_OID_PAIS)
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE)
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE)
            AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE)
            AND (MAE_ESTAD_CIVIL.OID_ESTA_CIVI(+) = MAE_CLIEN_DATOS_ADICI.ESCV_OID_ESTA_CIVI)
            AND (MAE_ESTAT_CLIEN.OID_ESTA_CLIE = MAE_CLIEN_DATOS_ADICI.ESTA_OID_ESTA_CLIE)
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_IDENT.CLIE_OID_CLIE(+))
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_DIREC.CLIE_OID_CLIE(+))
            AND (SEG_TIPO_VIA.OID_TIPO_VIA(+) = MAE_CLIEN_DIREC.TIVI_OID_TIPO_VIA)
            AND (MAE_TIPO_DOCUM.OID_TIPO_DOCU(+) = MAE_CLIEN_IDENT.TDOC_OID_TIPO_DOCU)
            AND (MAE_CLIEN_DIREC.TERR_OID_TERR = ZON_TERRI.OID_TERR(+))
            AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_BLOQU.CLIE_OID_CLIE(+))
            AND (MAE_TIPO_BLOQU.OID_TIPO_BLOQ(+) = MAE_CLIEN_BLOQU.TIBQ_OID_TIPO_BLOQ)
            AND (MAE_CLIEN_DIREC.IND_DIRE_PPAL(+) = 1)
            AND (MAE_CLIEN_IDENT.VAL_IDEN_DOCU_PRIN(+) = 1)
			AND MAE_CLIEN_DIREC.IND_DIRE_PPAL = 1 
			AND MAE_CLIEN_DIREC.IND_ELIM = 0
    		AND (SEG_PAIS.COD_PAIS = #codigoPais#)
            <isNotEmpty prepend="AND" property="codigoTipoCliente">
    		    (MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoCliente#) 
    		</isNotEmpty>
    		<isNotEmpty prepend="AND" property="numeroDiasModificacion">
            <![CDATA[
                (
                   (MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU > SYSDATE - #numeroDiasModificacion#) OR
                   (MAE_CLIEN.FEC_ULTI_ACTU > SYSDATE - #numeroDiasModificacion#) OR
                   (MAE_CLIEN_IDENT.FEC_ULTI_ACTU > SYSDATE - #numeroDiasModificacion#) OR
                   (MAE_CLIEN_TIPO_SUBTI.FEC_ULTI_ACTU > SYSDATE - #numeroDiasModificacion#) OR
                   (MAE_CLIEN_DIREC.FEC_ULTI_ACTU > SYSDATE - #numeroDiasModificacion#)
                )
            ]]>
            </isNotEmpty>
           )
    ) B1,
    (
    SELECT MAE_CLIEN_UNIDA_ADMIN.CLIE_OID_CLIE,
           ZON_SUB_GEREN_VENTA.COD_SUBG_VENT,
           ZON_REGIO.COD_REGI,
           ZON_ZONA.COD_ZONA,
           ZON_SECCI.COD_SECC,
           SEG_PERIO_CORPO.COD_PERI CAM_ULTI_PEDI
      FROM MAE_CLIEN_UNIDA_ADMIN,
           ZON_SUB_GEREN_VENTA,
           ZON_REGIO,
           ZON_ZONA,
           ZON_SECCI,
           ZON_TERRI_ADMIN,
           CRA_PERIO,
           SEG_PERIO_CORPO,
           SEG_CANAL,
           SEG_MARCA
     WHERE (    (ZON_SUB_GEREN_VENTA.OID_SUBG_VENT = ZON_REGIO.ZSGV_OID_SUBG_VENT)
            AND (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
            AND (ZON_ZONA.OID_ZONA = ZON_SECCI.ZZON_OID_ZONA)
            AND (ZON_SECCI.OID_SECC = ZON_TERRI_ADMIN.ZSCC_OID_SECC)
            AND (MAE_CLIEN_UNIDA_ADMIN.ZTAD_OID_TERR_ADMI = ZON_TERRI_ADMIN.OID_TERR_ADMI)
            AND (CRA_PERIO.OID_PERI = MAE_CLIEN_UNIDA_ADMIN.PERD_OID_PERI_INI)
            AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
            AND (SEG_CANAL.OID_CANA = CRA_PERIO.CANA_OID_CANA)
            AND (SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC)
            AND (SEG_CANAL.COD_CANA = 'VD')
            AND (SEG_MARCA.COD_MARC = 'T')
            AND (MAE_CLIEN_UNIDA_ADMIN.IND_ACTI = 1)
            <isNotEmpty prepend="AND" property="numeroDiasModificacion">
            <![CDATA[
               (MAE_CLIEN_UNIDA_ADMIN.FEC_ULTI_ACTU > SYSDATE - #numeroDiasModificacion#)
            ]]>
            </isNotEmpty>
           )
    ) B2,
    (
    SELECT MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE,
           'L' COD_TIPO_CONS
      FROM MAE_CLIEN_CLASI,
           MAE_CLIEN_TIPO_SUBTI,
           MAE_TIPO_CLASI_CLIEN,
           MAE_TIPO_CLIEN,
           MAE_CLASI,
           MAE_SUBTI_CLIEN
     WHERE (    (MAE_CLIEN_TIPO_SUBTI.OID_CLIE_TIPO_SUBT = MAE_CLIEN_CLASI.CTSU_OID_CLIE_TIPO_SUBT)
            AND (MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS = MAE_CLIEN_CLASI.TCCL_OID_TIPO_CLASI)
            AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE)
            AND (MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS = MAE_CLASI.TCCL_OID_TIPO_CLAS)
            AND (MAE_CLASI.OID_CLAS = MAE_CLIEN_CLASI.CLAS_OID_CLAS)
            AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE)
            AND (MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_CLIEN_TIPO_SUBTI.SBTI_OID_SUBT_CLIE)
            AND (MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE)
            AND (MAE_CLASI.COD_CLAS = '01')
            AND (MAE_TIPO_CLASI_CLIEN.COD_TIPO_CLAS = '01')
            AND (MAE_SUBTI_CLIEN.COD_SUBT_CLIE = '04')
            <isNotEmpty prepend="AND" property="numeroDiasModificacion">
            <![CDATA[
                (MAE_CLIEN_TIPO_SUBTI.FEC_ULTI_ACTU > SYSDATE - #numeroDiasModificacion#)
            ]]>
            </isNotEmpty>
    	    <isNotEmpty prepend="AND" property="codigoTipoCliente">
    	        (MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoCliente#)
    	    </isNotEmpty>
           )
    ) B3,
    (
    SELECT   DISTINCT
             PED_SOLIC_CABEC.CLIE_OID_CLIE,
    		 FIRST_VALUE(PED_SOLIC_CABEC.VAL_PREC_FACT_TOTA_LOCA) 
    		 OVER (PARTITION BY PED_SOLIC_CABEC.CLIE_OID_CLIE ORDER BY SEG_PERIO_CORPO.COD_PERI DESC) 
    		 AS VAL_PREC_FACT_TOTA_LOCA
        FROM PED_SOLIC_CABEC,
             SEG_SUBAC,
             SEG_ACCES,
             SEG_CANAL,
             SEG_PERIO_CORPO,
             CRA_PERIO,
             SEG_MARCA
       WHERE (    (SEG_SUBAC.OID_SBAC = PED_SOLIC_CABEC.SBAC_OID_SBAC)
              AND (SEG_ACCES.OID_ACCE = SEG_SUBAC.ACCE_OID_ACCE)
              AND (SEG_CANAL.OID_CANA = SEG_ACCES.CANA_OID_CANA)
              AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
              AND (CRA_PERIO.OID_PERI = PED_SOLIC_CABEC.PERD_OID_PERI)
              AND (SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC)
              AND (PED_SOLIC_CABEC.FEC_FACT IS NOT NULL)
    		  AND (PED_SOLIC_CABEC.IND_TS_NO_CONSO = 0)
              AND (PED_SOLIC_CABEC.IND_OC = 1)
              AND (SEG_ACCES.COD_ACCE = 'GZ')
              AND (SEG_SUBAC.COD_SBAC = '000')
              AND (SEG_CANAL.COD_CANA = 'VD')
              AND (SEG_MARCA.COD_MARC = 'T')
             )
    ) B4,
    (
    SELECT   MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE,
             PED_MONTO_MINIM.VAL_NIV1
        FROM PED_MONTO_MINIM,
             PED_TIPO_SOLIC_PAIS,
             MAE_TIPO_CLIEN,
             MAE_SUBTI_CLIEN,
             MAE_CLIEN_TIPO_SUBTI,
             PED_TIPO_SOLIC
       WHERE (    (PED_TIPO_SOLIC_PAIS.OID_TIPO_SOLI_PAIS = PED_MONTO_MINIM.TSPA_OID_TIPO_SOLI_PAIS)
              AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = PED_MONTO_MINIM.TICL_OID_TIPO_CLIE)
              AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE)
              AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE)
              AND (MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_CLIEN_TIPO_SUBTI.SBTI_OID_SUBT_CLIE)
              AND (PED_TIPO_SOLIC.OID_TIPO_SOLI = PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI)
              AND (PED_TIPO_SOLIC.COD_TIPO_SOLI = 'SOC')
              <isNotEmpty prepend="AND" property="codigoTipoCliente">
    	          (MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoCliente#)
    	      </isNotEmpty>
             )
    ) B5,
    (
    SELECT AUX_PERI_EGRE.CLIE_OID_CLIE,
           AUX_PERI_EGRE.CAM_EGRE,
    	   MAX(FAC_CONTR_CIERR.FEC_CIER) FEC_EGRE
    FROM FAC_TIPOS_CIERR, FAC_CONTR_CIERR, CRA_PERIO, SEG_PERIO_CORPO,
    ( 
    SELECT   MAE_CLIEN_HISTO_ESTAT.CLIE_OID_CLIE,
             MAX (SEG_PERIO_CORPO.COD_PERI) CAM_EGRE
        FROM MAE_CLIEN_HISTO_ESTAT,
             MAE_ESTAT_CLIEN,
             SEG_PERIO_CORPO,
             CRA_PERIO
       WHERE (    (MAE_ESTAT_CLIEN.OID_ESTA_CLIE = MAE_CLIEN_HISTO_ESTAT.ESTA_OID_ESTA_CLIE)
              AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
              AND (CRA_PERIO.OID_PERI = MAE_CLIEN_HISTO_ESTAT.PERD_OID_PERI)
              AND (MAE_ESTAT_CLIEN.COD_ESTA_CLIE = '05')
             )
    GROUP BY MAE_CLIEN_HISTO_ESTAT.CLIE_OID_CLIE
    ) AUX_PERI_EGRE
    WHERE (    (FAC_TIPOS_CIERR.OID_TIPO_CIER = FAC_CONTR_CIERR.TCIE_OID_TIPO_CIER)
    	   AND (FAC_CONTR_CIERR.PERD_OID_PERI = CRA_PERIO.OID_PERI)
    	   AND (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
    	   AND (SEG_PERIO_CORPO.COD_PERI = AUX_PERI_EGRE.CAM_EGRE)
    	   AND (FAC_TIPOS_CIERR.COD_TIPO_CIER = 'R')
          )
    GROUP BY AUX_PERI_EGRE.CLIE_OID_CLIE, AUX_PERI_EGRE.CAM_EGRE
    ) B6,
    (
    SELECT   MAE_CLIEN_HISTO_ESTAT.CLIE_OID_CLIE,
             MAX (SEG_PERIO_CORPO.COD_PERI) CAM_INGR
        FROM MAE_CLIEN_HISTO_ESTAT,
             MAE_ESTAT_CLIEN,
             SEG_PERIO_CORPO,
             CRA_PERIO
       WHERE (    (MAE_ESTAT_CLIEN.OID_ESTA_CLIE = MAE_CLIEN_HISTO_ESTAT.ESTA_OID_ESTA_CLIE)
              AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
              AND (CRA_PERIO.OID_PERI = MAE_CLIEN_HISTO_ESTAT.PERD_OID_PERI)
              AND (MAE_ESTAT_CLIEN.COD_ESTA_CLIE = '02')
             )
    GROUP BY MAE_CLIEN_HISTO_ESTAT.CLIE_OID_CLIE
    ) B7
    WHERE (B1.OID_CLIE = B2.CLIE_OID_CLIE)
    AND   (B1.OID_CLIE = B3.CLIE_OID_CLIE(+))
    AND   (B1.OID_CLIE = B4.CLIE_OID_CLIE)
    AND   (B1.OID_CLIE = B5.CLIE_OID_CLIE)
    AND   (B1.OID_CLIE = B6.CLIE_OID_CLIE(+))
    AND   (B1.OID_CLIE = B7.CLIE_OID_CLIE)
  </select>

  <resultMap id="interfazREUMatrizCampanyaResult" class="java.util.HashMap">
    <result property="codigoPais"                       column="COD_PAIS"/>
    <result property="codigoPeriodo"                    column="COD_PERI"/>
    <result property="codigoVenta"                      column="VAL_CODI_VENT"/>
    <result property="codigoGrupo"                      column="COD_GRUP"/>
    <result property="codigoProducto"                   column="COD_SAP"/>
    <result property="codigoTipoOferta"                 column="COD_TIPO_OFER"/>
    <result property="precioProducto"                   column="IMP_PREC_CATA"/>
    <result property="precioContable"                   column="VAL_PREC_CONT"/>
    <result property="numeroPaginaCatalogo"             column="NUM_PAGI_CATA"/>
    <result property="factorRepeticionProducto"         column="VAL_FACT_REPE"/>
    <result property="numeroUnidadesMaximas"            column="NUM_UNID_ALAR"/>
    <result property="indicadorProductoEstadisticable"  column="IND_ESTA"/>
    <result property="grupoDescuento"                   column="COD_GRUP_DESC"/>
    <result property="indicadorComisionable"            column="IND_COMI"/>
    <result property="indicadorComisionAdicional"       column="IND_COMI_ADIC"/>
    <result property="codigoNegocio"                    column="COD_NEGO"/>
    <result property="codigoUnidadNegocio"              column="COD_UNID_NEGO"/>
    <result property="codigoMarcaProducto"              column="COD_MARC_PROD"/>
    <result property="comisionable"                     column="IND_COM2"/>
    <result property="descripcionSAP"                   column="DES_CORT"/>
    <result property="codigoCatalogo"                   column="COD_CATA"/>
  </resultMap>

  <!-- INTERFAZ - REUTILIZACION - ENVIAR MATRIZ DE CAMPAA -->
  <select id="getInterfazREUMatrizCampanya" parameterClass="java.util.Map" resultMap="interfazREUMatrizCampanyaResult">
        SELECT DISTINCT
               SEG_PAIS.COD_PAIS,
               SEG_PERIO_CORPO.COD_PERI,
               PRE_OFERT_DETAL.VAL_CODI_VENT,
               ' ' AS COD_GRUP,
               MAE_PRODU.COD_SAP,
               PRE_TIPO_OFERT.COD_TIPO_OFER,
               PRE_OFERT_DETAL.IMP_PREC_CATA,
               MAE_PRODU.VAL_PREC_CONT,
               PRE_OFERT_DETAL.NUM_PAGI_CATA,
               PRE_OFERT_DETAL.VAL_FACT_REPE,
               PED_TIPO_SOLIC_PAIS.NUM_UNID_ALAR,
               PRE_TIPO_OFERT.IND_ESTA,
               MAE_GRUPO_DESCU.COD_GRUP_DESC,
               ' ' AS IND_COMI, 
               ' ' AS IND_COMI_ADIC,
               MAE_NEGOC.COD_NEGO,
               MAE_UNIDA_NEGOC.COD_UNID_NEGO,
               SEG_MARCA_PRODU.COD_MARC_PROD,
               PRE_TIPO_OFERT.IND_COMI IND_COM2,
               MAE_PRODU.DES_CORT,
               PRE_CATAL.COD_CATA
          FROM SEG_PAIS,
               SEG_PERIO_CORPO,
               SEG_CANAL,
               SEG_MARCA,
               SEG_TIPO_PERIO,
               CRA_PERIO,
               PRE_OFERT_DETAL,
               PRE_OFERT,
               PRE_MATRI_FACTU_CABEC,
               PRE_TIPO_OFERT,
               MAE_PRODU,
               SEG_MARCA_PRODU,
               PED_TIPO_SOLIC_PAIS,
               PRE_CATAL,
               MAE_UNIDA_NEGOC,
               PED_IMPUE_NEGOC,
               PED_TIPO_SOLIC,
               MAE_NEGOC,
               MAE_GRUPO_DESCU,
               SEG_ACCES
       	 WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
               	<isNotEmpty prepend="AND" property="codigoMarca">
               	    (SEG_MARCA.COD_MARC = #codigoMarca#)
               	</isNotEmpty>
               	AND (SEG_CANAL.COD_CANA = #codigoCanal#)
               	AND (SEG_ACCES.COD_ACCE = #codigoAcceso#)
               	<!--isNotEmpty prepend="AND" property="fechaUltimoProceso">
               	<![CDATA[
               	    (PRE_OFERT_DETAL.FEC_ULTI_ACTU > #fechaUltimoProceso#)
               	]]>
               	 </isNotEmpty-->
               	<![CDATA[
               	AND (SEG_PERIO_CORPO.COD_PERI >= #periodoDesde#)
               	]]>
               	<![CDATA[
               	AND (SEG_PERIO_CORPO.COD_PERI <= #periodoHasta#)
               	]]>
                AND (PRE_OFERT_DETAL.IND_DIGI = 1)
                AND (PED_TIPO_SOLIC.COD_TIPO_SOLI = 'SOC')   	
                AND (SEG_TIPO_PERIO.OID_TIPO_PERI = SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI)
                AND (SEG_TIPO_PERIO.OID_TIPO_PERI = SEG_CANAL.TIPE_OID_TIPO_PERI)
                AND (SEG_PAIS.OID_PAIS = CRA_PERIO.PAIS_OID_PAIS)
                AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
                AND (SEG_CANAL.OID_CANA = CRA_PERIO.CANA_OID_CANA)
                AND (SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC)
                AND (PRE_OFERT.OID_OFER = PRE_OFERT_DETAL.OFER_OID_OFER)
                AND (CRA_PERIO.OID_PERI = PRE_MATRI_FACTU_CABEC.PERD_OID_PERI)
                AND (PRE_MATRI_FACTU_CABEC.OID_CABE = PRE_OFERT.MFCA_OID_CABE)
                AND (SEG_CANAL.OID_CANA = PRE_TIPO_OFERT.CANA_OID_CANA)
                AND (PRE_TIPO_OFERT.OID_TIPO_OFER = PRE_OFERT_DETAL.TOFE_OID_TIPO_OFER)
                AND (SEG_PAIS.OID_PAIS = MAE_PRODU.PAIS_OID_PAIS)
                AND (MAE_PRODU.OID_PROD = PRE_OFERT_DETAL.PROD_OID_PROD)
                AND (SEG_MARCA_PRODU.OID_MARC_PROD = MAE_PRODU.MAPR_OID_MARC_PROD)
                AND (SEG_PAIS.OID_PAIS = PED_TIPO_SOLIC_PAIS.PAIS_OID_PAIS)
                AND (SEG_PAIS.OID_PAIS = PRE_CATAL.PAIS_OID_PAIS)
                AND (PRE_CATAL.OID_CATA = PRE_OFERT_DETAL.OCAT_OID_CATAL)
                AND (PRE_CATAL.OID_CATA = PRE_OFERT.OCAT_OID_CATA)
                AND (SEG_PAIS.OID_PAIS = MAE_UNIDA_NEGOC.PAIS_OID_PAIS)
                AND (MAE_UNIDA_NEGOC.OID_UNID_NEGO = MAE_PRODU.UNEG_OID_UNID_NEGO)
                AND (SEG_MARCA.OID_MARC = PED_TIPO_SOLIC.MARC_OID_MARC)
                AND (PED_TIPO_SOLIC.OID_TIPO_SOLI = PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI)
                AND (MAE_NEGOC.OID_NEGO = MAE_PRODU.NEGO_OID_NEGO)
                AND (MAE_GRUPO_DESCU.COD_MARC_PROD = SEG_MARCA_PRODU.COD_MARC_PROD)
                AND (MAE_GRUPO_DESCU.COD_UNID_NEGO = MAE_UNIDA_NEGOC.COD_UNID_NEGO)
                AND (MAE_GRUPO_DESCU.COD_GRUP_ARTI = TRIM(MAE_PRODU.VAL_GRUP_ARTI))
                AND (SEG_CANAL.OID_CANA = SEG_ACCES.CANA_OID_CANA)
                AND (SEG_ACCES.OID_ACCE = CRA_PERIO.ACCE_OID_ACCE)
                <!--
                AND (SEG_ACCES.OID_ACCE = PRE_OFERT.ACCE_OID_ACCE)
                AND (SEG_ACCES.OID_ACCE = PED_TIPO_SOLIC.ACCE_OID_ACCE)
                -->
                AND (SEG_PAIS.OID_PAIS = PED_IMPUE_NEGOC.PAIS_OID_PAIS(+))
               )
        ORDER BY SEG_PAIS.COD_PAIS ASC,
                 SEG_PERIO_CORPO.COD_PERI ASC,
                 PRE_OFERT_DETAL.VAL_CODI_VENT ASC,
                 MAE_PRODU.COD_SAP ASC,
                 PRE_TIPO_OFERT.COD_TIPO_OFER ASC
  </select>


  <!-- INTERFAZ - REUTILIZACION - ENVIAR DOCUMENTOS ANULADOS -->
  <select id="getInterfazREUDocumentosAnulados" parameterClass="java.util.Map" resultMap="interfazREUDocumentosAnuladosResult">
        SELECT   SEG_PAIS.COD_PAIS AS CODPAIS,
                 PED_SOLIC_CABEC.VAL_NUME_SOLI AS NUMBOL,
                 MAE_CLIEN.COD_CLIE AS CODCLIENTE,
                 REC_CABEC_RECLA.FEC_INGR AS FECHAANULACION,
                 SEG_PERIO_CORPO.COD_PERI AS CODPERIODO
            FROM REC_OPERA_RECLA,
                 REC_CABEC_RECLA,
                 REC_OPERA,
                 REC_TIPOS_OPERA,
                 MAE_CLIEN,
                 PED_SOLIC_CABEC,
                 CRA_PERIO,
                 SEG_PERIO_CORPO,
                 REC_ESTAD_OPERA,
                 SEG_PERIO_CORPO SEG_PERIO_CORPO_RECLA,
                 CRA_PERIO CRA_PERIO_RECLA,
                 REC_ESTAD_RECLA,
                  SEG_PAIS,
                  SEG_CANAL,
                 SEG_MARCA
           WHERE (    (REC_CABEC_RECLA.OID_CABE_RECL = REC_OPERA_RECLA.CARE_OID_CABE_RECL)
                  AND (REC_OPERA.OID_OPER = REC_TIPOS_OPERA.ROPE_OID_OPER)
                  AND (REC_TIPOS_OPERA.OID_TIPO_OPER = REC_OPERA_RECLA.TIOP_OID_TIPO_OPER)
                  AND (MAE_CLIEN.OID_CLIE = REC_CABEC_RECLA.CLIE_OID_CLIE)
                  AND (PED_SOLIC_CABEC.OID_SOLI_CABE = REC_CABEC_RECLA.SOCA_OID_SOLI_CABE)
                  AND (CRA_PERIO.OID_PERI = PED_SOLIC_CABEC.PERD_OID_PERI)
                  AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
                  AND (REC_ESTAD_OPERA.OID_ESTA_OPER = REC_OPERA_RECLA.ESOP_OID_ESTA_OPER)
                  AND (CRA_PERIO_RECLA.OID_PERI = REC_CABEC_RECLA.PERD_OID_PERI_RECL)
                  AND (CRA_PERIO_RECLA.PERI_OID_PERI = SEG_PERIO_CORPO_RECLA.OID_PERI)
                  AND (REC_ESTAD_RECLA.OID_ESTA_RECL = REC_CABEC_RECLA.ESRE_OID_ESTA_RECL)
                  AND (SEG_PAIS.OID_PAIS = MAE_CLIEN.PAIS_OID_PAIS)
                  AND (SEG_CANAL.OID_CANA = CRA_PERIO.CANA_OID_CANA)
                  AND (SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC)
                  AND (REC_OPERA.COD_OPER = 'A')
                  AND (REC_ESTAD_OPERA.COD_ESTA_OPER = 'F')
                  AND (REC_ESTAD_RECLA.COD_ESTA = 'F')
                  AND (SEG_PERIO_CORPO_RECLA.COD_PERI = #codigoPeriodo#)
                  AND (SEG_PAIS.COD_PAIS = #codigoPais#)
                  AND (SEG_CANAL.COD_CANA = #codigoCanal#)
            AND   (SEG_MARCA.COD_MARC = #codigoMarca#)
                  AND (REC_CABEC_RECLA.FEC_INGR = TO_DATE(#fechaFacturacion#,'DD/MM/YYYY'))
                 )
        ORDER BY CODPAIS, CODCLIENTE, NUMBOL
  </select>


  <!-- INTERFAZ - OCR - ENVIAR REGIONES -->
  <select id="getInterfazOCREnviarRegiones" parameterClass="java.util.Map" resultMap="interfazOCREnviarRegionesResult">
           SELECT NVL(ZON_REGIO.COD_REGI, ' ') AS CODIGOREGION,	    
                  UPPER(NVL(ZON_REGIO.DES_REGI, ' ')) AS DESCRIPCIONREGION
             FROM SEG_PAIS,
        	      SEG_MARCA,
        	      SEG_CANAL,
        	      ZON_REGIO
            WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
            AND	  (ZON_REGIO.IND_ACTI = 1)
            <isNotEmpty prepend="AND" property="codigoMarca">
                (SEG_MARCA.COD_MARC = #codigoMarca#)
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="codigoCanal">
                (SEG_CANAL.COD_CANA = #codigoCanal#)
            </isNotEmpty>
            <isEqual property="enviarHistorico" compareValue="N">
              <isNotEmpty prepend="AND" property="fechaInicioUltimoProceso">
              <![CDATA[
                (ZON_REGIO.FEC_ULTI_ACTU >= #fechaInicioUltimoProceso#)
              ]]>
              </isNotEmpty>
            </isEqual>      
            AND   (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
            AND   (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)
            AND   (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
            )
        	ORDER BY 1
  </select>


  <!-- INTERFAZ - OCR - ENVIAR ZONAS -->
  <select id="getInterfazOCREnviarZonas" parameterClass="java.util.Map" resultMap="interfazOCREnviarZonasResult">
           SELECT NVL(ZON_REGIO.COD_REGI, ' ') AS CODIGOREGION, 	   
           	      NVL(ZON_ZONA.COD_ZONA, ' ') AS CODIGOZONA,
 		          ZON_ZONA.FEC_ULTI_ACTU
             FROM SEG_MARCA,
           	      SEG_CANAL,
           	      SEG_PAIS,
           	      ZON_REGIO,
           	      ZON_ZONA
            WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
              AND (ZON_ZONA.IND_ACTI = 1)
       		  <isNotEmpty prepend="AND" property="codigoMarca">
       		     (SEG_MARCA.COD_MARC = #codigoMarca#)
       		  </isNotEmpty>
       		  <isNotEmpty prepend="AND" property="codigoCanal">
       		     (SEG_CANAL.COD_CANA = #codigoCanal#)
       		  </isNotEmpty>
              <isEqual property="enviarHistorico" compareValue="N">
           		  <isNotEmpty prepend="AND" property="fechaInicioUltimoProceso">
           		  <![CDATA[    
           		     (ZON_ZONA.FEC_ULTI_ACTU >= #fechaInicioUltimoProceso#)
           		  ]]>
           		  </isNotEmpty>
              </isEqual>
              AND (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)
              AND (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
              AND (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
              AND (SEG_MARCA.OID_MARC = ZON_ZONA.MARC_OID_MARC)
              AND (SEG_CANAL.OID_CANA = ZON_ZONA.CANA_OID_CANA)
              AND (SEG_PAIS.OID_PAIS = ZON_ZONA.PAIS_OID_PAIS)
              AND (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
              )
           	ORDER BY 1
  </select>


  <!-- INTERFAZ - SAP MM - ENVIAR INICIALIZACION DE STOCKS-->
  <select id="getInterfazSAMEnviarInicializacionStocks" parameterClass="java.util.Map" resultMap="interfazSAMEnviarInicializacionStocksResult">
	SELECT NVL(SEG_PAIS.COD_PAIS, ' ') AS CODPAI, 
		   NVL(BEL_ALMAC.COD_ALMA, ' ') AS CODALM, 
		   NVL(MAE_PRODU.COD_SAP, ' ') AS CODPRO,
	       NVL(BEL_STOCK.VAL_SALD * -1, 0) AS VARINV
	  FROM SEG_PAIS,
	       BEL_ALMAC,
	       BEL_ESTAD_MERCA,
	       BEL_STOCK,
	       MAE_PRODU
	 WHERE (    (SEG_PAIS.COD_PAIS = #codigoPais#)
			<isNotEmpty prepend="AND" property="codigoAlmacen">
				(BEL_ALMAC.COD_ALMA = #codigoAlmacen#)
			</isNotEmpty>
			<isNotEmpty prepend="AND" property="codigoEstadoMerca">
				(BEL_ESTAD_MERCA.COD_ESTA = #codigoEstadoMerca#)
			</isNotEmpty>
	        AND (SEG_PAIS.OID_PAIS = BEL_ALMAC.PAIS_OID_PAIS)
	        AND (SEG_PAIS.OID_PAIS = BEL_ESTAD_MERCA.PAIS_OID_PAIS)
	        AND (BEL_ALMAC.OID_ALMA = BEL_STOCK.ALMC_OID_ALMA)
	        AND (BEL_ESTAD_MERCA.OID_ESTA_MERC = BEL_STOCK.ESME_OID_ESTA_MERC)
	        AND (SEG_PAIS.OID_PAIS = MAE_PRODU.PAIS_OID_PAIS)
	        AND (MAE_PRODU.OID_PROD = BEL_STOCK.PROD_OID_PROD)
	        AND (BEL_STOCK.VAL_SALD > 0 )
	       )
  </select>


  <!-- INTERFAZ - SAP BPS - ENVIAR RENTABILIDAD POR ZONA-->
  <select id="getInterfazSABEnviarRentabilidadPorZona" parameterClass="java.util.Map" resultMap="interfazSABEnviarRentabilidadPorZonaResult">
	SELECT 
		   CCC_RENTA_ZONA_TEMPO.COD_PAIS AS CODPAI, 
		   CCC_RENTA_ZONA_TEMPO.COD_SOCI AS CODSOC, 
		   CCC_RENTA_ZONA_TEMPO.COD_ZONA AS CODZON, 
		   CCC_RENTA_ZONA_TEMPO.DES_ZONA AS DESZON, 
		   CCC_RENTA_ZONA_TEMPO.COD_MONE AS CODMON, 
		   CCC_RENTA_ZONA_TEMPO.IMP_MOVI AS VALINC, 
		   SUBSTR(TRIM(CCC_RENTA_ZONA_TEMPO.COD_PERI), 0, 4) AS CODEJE, 
		   '0' || SUBSTR(TRIM(CCC_RENTA_ZONA_TEMPO.COD_PERI), 5, 2) AS CODPER,
		   #tipoMoneda# AS TIPMON,
		   #centroCosto# AS CENCOS,
		   #cuentaContable# AS CUECON
		   FROM CCC_RENTA_ZONA_TEMPO
  </select>


  <!-- INTERFAZ  - SAP BPS - ENVIAR INCENTIVOS CONSULTORAS-PREMIOS ENTREGADOS -->
  <select id="getInterfazSABEnviarIncentivosConsultoras" parameterClass="java.util.Map" resultMap="interfazSABEnviarIncentivosConsultorasResult">
     SELECT SUBSTR(SEG_PAIS.COD_PAIS,0,2) AS CODPAIS,
    		SEG_SOCIE.COD_SOCI AS CODSOCIEDAD,
            CASE SEG_CANAL.COD_CANA
            WHEN #codigoVentaDirectaSiCC# THEN #codigoVentaDirectaSAP#
            ELSE SEG_CANAL.COD_CANA
            END AS CODCANAL ,
    		SUBSTR(SEG_PERIO_CORPO.COD_PERI,0,4) AS EJERCICIO ,
			CONCAT('0', SUBSTR(SEG_PERIO_CORPO.COD_PERI,5,2)) AS PERIODO,
    		REPLACE(INC_CONCU_PARAM_GENER.NUM_CONC, '/', '') AS NUMEROCONCURSO,
    		INC_PARAM_NIVEL_PREMI.NUM_NIVE AS NIVELPREMIO,
    		INC_LOTE_PREMI_ARTIC.NUM_PREM AS NUMEROPREMIO,
    		SUBSTR(MAE_PRODU.COD_SAP,0,18)  AS CODIGOPRODUCTO,
    		#posicionPlan# AS POSICIONPLAN,
    		TRIM(TO_CHAR(SUM (PED_SOLIC_POSIC.NUM_UNID_ATEN), '999990.000')) AS CANTPREMIOSENTREGADOS,
			#unidadMedida# AS UNIDADMEDIDA,
    		TRIM(TO_CHAR(SUM(PED_SOLIC_POSIC.VAL_PREC_CONT_TOTA_LOCA), '9999999990.00')) AS PRECIOPUBLICOPREMIO,
			SEG_MONED.COD_MONE AS CODMONEDALOCAL
      FROM  PED_SOLIC_CABEC,
	  		SEG_PAIS,
			SEG_SOCIE,
			SEG_MODUL,
			CRA_PERIO,
            SEG_MARCA,
            SEG_CANAL,
            SEG_PERIO_CORPO,
			SEG_MONED,
			PED_SOLIC_POSIC,
			MAE_PRODU,
			INC_CONCU_PARAM_GENER,
			INC_PARAM_GENER_PREMI,
			INC_PARAM_NIVEL_PREMI,
			INC_PREMI_ARTIC,
            INC_LOTE_PREMI_ARTIC
     WHERE  ((SEG_PAIS.COD_PAIS = #codigoPais#) 
     AND	(SEG_MARCA.COD_MARC = #codigoMarca#)
     AND	(SEG_CANAL.COD_CANA = #codigoCanal#)
     AND	(SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
       	  	<isNotEmpty prepend="AND" property="codigoSociedad">
              (SEG_SOCIE.COD_SOCI = #codigoSociedad#)
       	  	</isNotEmpty>
	 AND	(PED_SOLIC_CABEC.FEC_FACT IS NOT NULL)
	 AND	(SEG_MODUL.COD_MODU = '13')
	 AND 	(PED_SOLIC_CABEC.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
	 AND 	(PED_SOLIC_CABEC.SOCI_OID_SOCI = SEG_SOCIE.OID_SOCI)
	 AND 	(PED_SOLIC_CABEC.MODU_OID_MODU = SEG_MODUL.OID_MODU)
	 AND 	(PED_SOLIC_CABEC.PERD_OID_PERI = CRA_PERIO.OID_PERI)
     AND    (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
     AND 	(CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
     AND 	(CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
	 AND 	(SEG_PAIS.MONE_OID_MONE = SEG_MONED.OID_MONE)
	 AND 	(PED_SOLIC_POSIC.SOCA_OID_SOLI_CABE = PED_SOLIC_CABEC.OID_SOLI_CABE)
	 AND 	(PED_SOLIC_POSIC.PROD_OID_PROD = MAE_PRODU.OID_PROD)
	 AND 	(PED_SOLIC_CABEC.COPA_OID_PARA_GENE = INC_CONCU_PARAM_GENER.OID_PARA_GRAL) 
	 AND 	(INC_PARAM_GENER_PREMI.COPA_OID_PARA_GRAL = INC_CONCU_PARAM_GENER.OID_PARA_GRAL)
	 AND 	(INC_PARAM_NIVEL_PREMI.PAGP_OID_PARA_GENE_PREM = INC_PARAM_GENER_PREMI.OID_PARA_GENE_PREM)
	 AND 	(INC_PREMI_ARTIC.PANP_OID_PARA_NIVE_PREM = INC_PARAM_NIVEL_PREMI.OID_PARA_NIVE_PREM)
	 AND 	(INC_LOTE_PREMI_ARTIC.PRAR_OID_PREM_ARTI = INC_PREMI_ARTIC.OID_PREM_ARTI)
	 AND	(PED_SOLIC_CABEC.NUM_PREM = INC_LOTE_PREMI_ARTIC.NUM_PREM)
	        )
	 GROUP BY SEG_PAIS.COD_PAIS, SEG_SOCIE.COD_SOCI, SEG_CANAL.COD_CANA,SEG_PERIO_CORPO.COD_PERI,
			  SEG_PERIO_CORPO.COD_PERI, INC_CONCU_PARAM_GENER.NUM_CONC, INC_PARAM_NIVEL_PREMI.NUM_NIVE, 
			  INC_LOTE_PREMI_ARTIC.NUM_PREM, MAE_PRODU.COD_SAP,SEG_MONED.COD_MONE
  </select>


  <!-- INTERFAZ - SAP BPS - ENVIAR FUENTE VENTAS PREVISTA -->
  <select id="getInterfazSABEnviarFuenteVentasPrevista" parameterClass="java.util.Map" resultMap="interfazSABEnviarFuenteVentasPrevistaResult">
  	  SELECT  INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS AS codigoPais,
	          INT_SAB_VENTA_PREVI_ZONA.COD_SOCI AS codigoSociedad,
			  INT_SAB_VENTA_PREVI_ZONA.COD_ALMA AS codigoAlmacen,
			  INT_SAB_VENTA_PREVI_ZONA.COD_MARC AS codigoMarca,
			  INT_SAB_VENTA_PREVI_ZONA.COD_CANA AS codigoCanal,
			  SUBSTR(INT_SAB_VENTA_PREVI_ZONA.COD_PERI,0,4) AS anio,
			  SEG_MONED.COD_MONE AS codigoMoneda,
			  INT_SAB_VENTA_PREVI_ZONA.COD_PERI AS periodo,
			  INT_SAB_VENTA_PREVI_ZONA.COD_ZONA AS codigoZona,
			  INT_SAB_VENTA_PREVI_ZONA.COD_REGI AS codigoRegion,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_ACIN AS activasIniciales,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_ACFI AS activasFinales,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_INGR AS ingresos,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_REIN AS reingresos,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_EGPU AS egresos,
			  '0'  AS rezonificadasRecibidas,
			  '0'  AS rezonificadasEntregadas,
			  '0'  AS numeroOrdenes,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_PEDI AS numeroPedidos,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_UNID AS unidadesVendidas,
			  INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE AS numeroClientes,
			  INT_SAB_VENTA_PREVI_ZONA.VAL_VENE AS ventaNeta,
			  SYSDATE AS fechaCierre,
			  <!-- Ini efernandezo -->
         	  INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_POSI_EGRE	AS VAL_RETE_POSI_EGRE,
              INT_SAB_VENTA_PREVI_ZONA.POR_EGPU           	AS PORCENTAJEEGRESOSPUROS,
              INT_SAB_VENTA_PREVI_ZONA.VAL_PUP	          	AS PUP,
              INT_SAB_VENTA_PREVI_ZONA.VAL_PPU	          	AS PPU,
              INT_SAB_VENTA_PREVI_ZONA.VAL_ACTI_LIDE 	    AS VAL_ACTI_LIDE,
              INT_SAB_VENTA_PREVI_ZONA.NUM_CONS_CLIE_PRIV	AS NUM_CONS_CLIE_PRIV,
              INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE_INSC_PRIV	AS NUM_CLIE_INSC_PRIV,
              INT_SAB_VENTA_PREVI_ZONA.NUM_CLIE_TRAN_PRIV	AS NUM_CLIE_TRAN_PRIV,
              INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_2PED		AS VAL_RETE_2PED,
              INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_3PED		AS VAL_RETE_3PED,
              INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_4PED		AS VAL_RETE_4PED,
              INT_SAB_VENTA_PREVI_ZONA.VAL_RETE_ACTI		AS VAL_RETE_ACTI,
              INT_SAB_VENTA_PREVI_ZONA.VAL_PORC_ROTA		AS VAL_PORC_ROTA,
              INT_SAB_VENTA_PREVI_ZONA.VAL_POSI_EGRE		AS VAL_POSI_EGRE
			  <!-- Fin efernandezo -->
		FROM  SEG_PAIS, 
	          SEG_MONED, 
			  INT_SAB_VENTA_PREVI_ZONA
		WHERE ((SEG_PAIS.MONE_OID_MONE = SEG_MONED.OID_MONE)
	          AND (INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS = SEG_PAIS.COD_PAIS)
	          AND (INT_SAB_VENTA_PREVI_ZONA.PAIS_COD_PAIS = #codigoPais#)
			  AND (INT_SAB_VENTA_PREVI_ZONA.COD_SOCI = #codigoSociedad#)
			  AND (INT_SAB_VENTA_PREVI_ZONA.COD_ALMA = #codigoAlmacen#)
			  AND (INT_SAB_VENTA_PREVI_ZONA.COD_MARC = #codigoMarca#)
			  AND (INT_SAB_VENTA_PREVI_ZONA.COD_CANA = #codigoCanal#)
			  AND (INT_SAB_VENTA_PREVI_ZONA.COD_PERI = #codigoPeriodo#)
	      )
  </select>


 <!-- INTERFAZ - BEL - ENVIAR FACTURAS CABECERA -->
 <select id="getInterfazBELFacturasCabecera" parameterClass="java.util.Map" resultMap="interfazBELFacturasCabeceraResult">
         SELECT CABECERA.ANYCAM AS ANYCAM,
	   	 		CABECERA.CODCLI AS CODCLI,
	   			PED_SOLIC_CABEC.VAL_NUME_SOLI AS NUMFAC, 
	   			CABECERA.TIPPED AS TIPPED,
   	   			TO_CHAR(CABECERA.FECEMI, 'YYYYMMDD') AS FECFAC,
	   			CABECERA.TIPDOC AS TIPDOC
	       FROM
   		     (SELECT NVL(SEG_PERIO_CORPO.COD_PERI, ' ') AS ANYCAM,
		   	 		 NVL(MAE_CLIEN.COD_CLIE, ' ') AS CODCLI,
		   			 NVL(PED_SOLIC_CABEC.VAL_NUME_SOLI, 0) AS NUMFAC,
		   			 'N' AS TIPPED,
		   			 PED_SOLIC_CABEC.FEC_FACT AS FECEMI,
		   			 (CASE FAC_TIPO_DOCUM_LEGAL.IND_TIPO_DOCU 
        		 	    WHEN 'B' THEN '01'
        		 		WHEN 'F' THEN '02'
        	          END) AS TIPDOC,
		   			 PED_SOLIC_CABEC.OID_SOLI_CABE,
		   			 PED_SOLIC_CABEC.SOCA_OID_SOLI_CABE        
	            FROM PED_SOLIC_CABEC,
	                 SEG_PAIS,
		   			 SEG_MARCA,
	       			 SEG_CANAL,
	       			 CRA_PERIO,
	       			 SEG_PERIO_CORPO,
	       			 SEG_TIPO_PERIO,
					 SEG_SUBAC,
   	  	   			 SEG_ACCES,
		   			 PED_ESTAD_SOLIC,
		   			 FAC_TIPO_DOCUM,
		   			 FAC_TIPO_DOCUM_LEGAL,
		   			 PED_TIPO_SOLIC_PAIS,
	       			 PED_TIPO_SOLIC,
		   			 MAE_CLIEN
	 		   WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
	           AND 	 (SEG_MARCA.COD_MARC = #codigoMarca#)
	           AND 	 (SEG_CANAL.COD_CANA = #codigoCanal#)
			   		 <isNotEmpty prepend="AND" property="codigoAcceso">
	           		   (SEG_ACCES.COD_ACCE = #codigoAcceso#)
	        		 </isNotEmpty>
               AND	 (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
               AND 	 (PED_SOLIC_CABEC.FEC_FACT = TO_DATE(#fechaFacturacion#,'DD/MM/YYYY'))
	           AND 	 (PED_SOLIC_CABEC.IND_TS_NO_CONSO = 1)
	           AND 	 (PED_SOLIC_CABEC.IND_OC = 1)
	           AND 	 (PED_SOLIC_CABEC.IND_PEDI_PRUE = 0)
	           <![CDATA[
		       AND   (PED_ESTAD_SOLIC.COD_ESTA_SOLI <> 'AN')
		       ]]>
			   AND 	 (PED_TIPO_SOLIC.IND_DEVO = 0)
	           AND 	 (PED_TIPO_SOLIC.IND_ANUL = 0)
			   AND 	 (FAC_TIPO_DOCUM_LEGAL.IND_ACTI_DOCU = 1)
			   AND 	 (PED_SOLIC_CABEC.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
			   AND 	 (PED_SOLIC_CABEC.PERD_OID_PERI = CRA_PERIO.OID_PERI)
	           AND 	 (CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
			   AND 	 (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
			   AND 	 (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
			   AND 	 (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
			   AND 	 (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
			   AND 	 (SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
			   AND 	 (PED_SOLIC_CABEC.SBAC_OID_SBAC = SEG_SUBAC.OID_SBAC)
			   AND 	 (SEG_SUBAC.ACCE_OID_ACCE = SEG_ACCES.OID_ACCE)
			   AND 	 (PED_SOLIC_CABEC.ESSO_OID_ESTA_SOLI = PED_ESTAD_SOLIC.OID_ESTA_SOLI)
	           AND 	 (PED_SOLIC_CABEC.TIDO_OID_TIPO_DOCU = FAC_TIPO_DOCUM.OID_TIPO_DOCU)
	           AND 	 (FAC_TIPO_DOCUM.COD_TIPO_DOCU = FAC_TIPO_DOCUM_LEGAL.COD_TIPO_DOLE)
			   AND 	 (PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS = PED_TIPO_SOLIC_PAIS.OID_TIPO_SOLI_PAIS)
			   AND 	 (PED_TIPO_SOLIC_PAIS.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
			   AND 	 (PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI = PED_TIPO_SOLIC.OID_TIPO_SOLI)
			   AND 	 (PED_SOLIC_CABEC.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)	        
			   )
			 ) CABECERA, PED_SOLIC_CABEC
		   WHERE CABECERA.SOCA_OID_SOLI_CABE = PED_SOLIC_CABEC.OID_SOLI_CABE
		   ORDER BY NUMFAC
  </select>


  <!-- INTERFAZ - BEL - ENVIAR FACTURAS DETALLE-->
  <select id="getInterfazBELFacturasDetalle" parameterClass="java.util.Map" resultMap="interfazBELFacturasDetalleResult">
  		  SELECT PED_SOLIC_CABEC.VAL_NUME_SOLI AS NUMFAC,
               	 CABECERA.CODVEN AS CODVEN,
               	 CABECERA.CODPRO AS CODPRO,	   
               	 CABECERA.UNIATE AS UNIATE,	   
               	 CABECERA.UNIFAL AS UNIFAL,
               	 CABECERA.PRECAT AS PRECAT,
               	 CABECERA.PREFAC AS PREFAC,
               	 CABECERA.PRECON AS PRECON
             FROM 
               (SELECT NVL(PED_SOLIC_CABEC.VAL_NUME_SOLI, 0) AS NUMFAC,
            		   NVL(PED_SOLIC_POSIC.VAL_CODI_VENT, ' ') AS CODVEN,
            		   NVL(MAE_PRODU.COD_SAP, ' ') AS CODPRO,
            		   NVL(PED_SOLIC_POSIC.NUM_UNID_ATEN, 0) AS UNIATE,
            		   (NVL(PED_SOLIC_POSIC.NUM_UNID_POR_ATEN, 0) - NVL(PED_SOLIC_POSIC.NUM_UNID_COMPR, 0)) AS UNIFAL,
            		   NVL(PED_SOLIC_POSIC.VAL_PREC_CATA_UNIT_LOCA, 0) AS PRECAT,
            		   NVL(PED_SOLIC_POSIC.VAL_PREC_FACT_UNIT_LOCA, 0) AS PREFAC,
            		   NVL(PED_SOLIC_POSIC.VAL_PREC_CONT_UNIT_LOCA, 0) AS PRECON,
            		   PED_SOLIC_CABEC.OID_SOLI_CABE,
            		   PED_SOLIC_CABEC.SOCA_OID_SOLI_CABE
            	  FROM PED_SOLIC_CABEC,
            	       SEG_PAIS,
            		   SEG_MARCA,
            	       SEG_CANAL,
            	       CRA_PERIO,
            	       SEG_PERIO_CORPO,
            	       SEG_TIPO_PERIO,
            		   SEG_SUBAC,
   	  	   			   SEG_ACCES,	       
            		   PED_ESTAD_SOLIC,
        			   FAC_TIPO_DOCUM,
            		   FAC_TIPO_DOCUM_LEGAL,
            	       PED_TIPO_SOLIC_PAIS,
            		   PED_TIPO_SOLIC,
            		   PED_SOLIC_POSIC,
            	       PED_ESTAD_POSIC,
            		   MAE_PRODU,
            	       SEG_MARCA_PRODU
            	 WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
       	         AND   (SEG_MARCA.COD_MARC = #codigoMarca#)
       	         AND   (SEG_CANAL.COD_CANA = #codigoCanal#)
       	         AND   (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
                   	   <isNotEmpty prepend="AND" property="codigoAcceso">
                         (SEG_ACCES.COD_ACCE = #codigoAcceso#)
                       </isNotEmpty>
       	         AND   (PED_SOLIC_CABEC.FEC_FACT = TO_DATE(#fechaFacturacion#,'DD/MM/YYYY'))
       	         AND   (PED_SOLIC_CABEC.IND_TS_NO_CONSO = 1)
       	         AND   (PED_SOLIC_CABEC.IND_OC = 1)
       	         AND   (PED_SOLIC_CABEC.IND_PEDI_PRUE = 0)
       			 AND   (PED_TIPO_SOLIC.IND_DEVO = 0)
       	         AND   (PED_TIPO_SOLIC.IND_ANUL = 0)
                 <![CDATA[
                 AND   (PED_ESTAD_SOLIC.COD_ESTA_SOLI <> 'AN')
                 AND   (PED_ESTAD_POSIC.COD_ESTA_POSI <> 'AN')
                 ]]>
       	     	 AND   (FAC_TIPO_DOCUM_LEGAL.IND_ACTI_DOCU = 1)
   				 AND   (PED_SOLIC_CABEC.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
       	         AND   (PED_SOLIC_CABEC.PERD_OID_PERI = CRA_PERIO.OID_PERI)
   				 AND   (CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
       			 AND   (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
       	         AND   (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
       	         AND   (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
   				 AND   (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
   				 AND   (PED_SOLIC_CABEC.SBAC_OID_SBAC = SEG_SUBAC.OID_SBAC)
			   	 AND   (SEG_SUBAC.ACCE_OID_ACCE = SEG_ACCES.OID_ACCE)
   				 AND   (SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
       	         AND   (PED_SOLIC_CABEC.ESSO_OID_ESTA_SOLI = PED_ESTAD_SOLIC.OID_ESTA_SOLI)
       	         AND   (PED_SOLIC_CABEC.TIDO_OID_TIPO_DOCU = FAC_TIPO_DOCUM.OID_TIPO_DOCU)
       			 AND   (FAC_TIPO_DOCUM.COD_TIPO_DOCU = FAC_TIPO_DOCUM_LEGAL.COD_TIPO_DOLE)
       	         AND   (PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS = PED_TIPO_SOLIC_PAIS.OID_TIPO_SOLI_PAIS)
       			 AND   (PED_TIPO_SOLIC_PAIS.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
   				 AND   (PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI = PED_TIPO_SOLIC.OID_TIPO_SOLI)
       			 AND   (PED_SOLIC_CABEC.OID_SOLI_CABE = PED_SOLIC_POSIC.SOCA_OID_SOLI_CABE)
       	         AND   (PED_SOLIC_POSIC.ESPO_OID_ESTA_POSI = PED_ESTAD_POSIC.OID_ESTA_POSI)
       			 AND   (PED_SOLIC_POSIC.PROD_OID_PROD = MAE_PRODU.OID_PROD)
       			 AND   (MAE_PRODU.MAPR_OID_MARC_PROD = SEG_MARCA_PRODU.OID_MARC_PROD))
             ) CABECERA, PED_SOLIC_CABEC
           WHERE CABECERA.SOCA_OID_SOLI_CABE = PED_SOLIC_CABEC.OID_SOLI_CABE
           ORDER BY NUMFAC
  </select>

  <!-- INTERFAZ - REU - ENVIAR PERIODOS DE FACTURACION -->
  <select id="getInterfazREUPeriodosFacturacion" parameterClass="java.util.Map" resultMap="interfazREUPeriodosFacturacionResult">
	SELECT 
		 SEG_PAIS.COD_PAIS AS CODPAIS,
		 NVL(SEG_PERIO_CORPO.COD_PERI, ' ') AS CODPERIODO,
		 TO_CHAR(CRA_PERIO.FEC_INIC, 'YYYYMMDD') AS FECINICIO,
		 TO_CHAR(CRA_PERIO.FEC_FINA, 'YYYYMMDD') AS FECFIN
    FROM SEG_PERIO_CORPO,
         CRA_PERIO,
         SEG_MARCA,
         SEG_CANAL,
         SEG_PAIS
    WHERE ((SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
           AND (SEG_MARCA.OID_MARC = CRA_PERIO.MARC_OID_MARC)
           AND (SEG_CANAL.OID_CANA = CRA_PERIO.CANA_OID_CANA)
           AND (SEG_PAIS.OID_PAIS = CRA_PERIO.PAIS_OID_PAIS)
           AND (SEG_PAIS.COD_PAIS = #codigoPais#) 
           AND (SEG_MARCA.COD_MARC = #codigoMarca#)
           AND (SEG_CANAL.COD_CANA = #codigoCanal#)
		   <![CDATA[    
           AND (SEG_PERIO_CORPO.COD_PERI >= #periodoDesde#)
		   ]]>	
		   <![CDATA[    
           AND (SEG_PERIO_CORPO.COD_PERI <= #periodoHasta#)
		    ]]>	
        )
  </select>


  <!-- INTERFAZ - BEL - ENVIAR DIRECCION DE CLIENTES -->
  <select id="getInterfazBELDireccionClientes" parameterClass="java.util.Map" resultMap="interfazBELDireccionClientesResult">
	SELECT  MAE_CLIEN.COD_CLIE AS CODCLIENTE,
    		SEG_TIPO_VIA.COD_TIPO_VIA AS TIPOVIA,
		    MAE_CLIEN_DIREC.VAL_NOMB_VIA AS NOMBREVIA,
		    (CASE ZON_VIA.COD_VIA  WHEN NULL THEN NVL(ZON_VIA.COD_VIA, ' ') ELSE 1 END) AS INDDESADC,
	        MAE_CLIEN_DIREC.NUM_PPAL AS NUMEROVIA,
		    TO_CHAR(' ') AS NUMEROBLOCK,
		    MAE_CLIEN_DIREC.VAL_MANZ AS NUMEROMANZANA,
		    MAE_CLIEN_DIREC.VAL_LOTE AS NUMEROLOTE,
		    TO_CHAR(' ') AS NUMEROKILOMETRO,
		    TO_CHAR(' ') AS NUMINTDOMICILIO,
			TO_CHAR(' ') AS CODPOSTAL,
		    (ZON_VALOR_ESTRU_GEOPO.ORDE_1 || ZON_VALOR_ESTRU_GEOPO.ORDE_2 || ZON_VALOR_ESTRU_GEOPO.ORDE_3 || 
			 ZON_VALOR_ESTRU_GEOPO.ORDE_4 || ZON_VALOR_ESTRU_GEOPO.ORDE_5 || ZON_VALOR_ESTRU_GEOPO.ORDE_6 ||
			 ZON_VALOR_ESTRU_GEOPO.ORDE_7 || ZON_VALOR_ESTRU_GEOPO.ORDE_8 || ZON_VALOR_ESTRU_GEOPO.ORDE_9)  AS CODUBIINEI,
    	    TO_CHAR(' ') AS CODTIPOCENTROPOBLADO,
		    TO_CHAR(' ') AS NUMEROETAPA,
		    TO_CHAR(' ') AS NUMEROSECTOR,
		    TO_CHAR(' ') AS INDDESREF,

			(SELECT VAL_TEXT_COMU 
			   FROM MAE_CLIEN_COMUN,
				    MAE_TIPO_COMUN
			   WHERE MAE_CLIEN_COMUN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE
			   AND	MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU
			   AND	MAE_TIPO_COMUN.COD_TIPO_COMU = 'TF') AS NUMTEL1,
			
			(SELECT VAL_TEXT_COMU 
			   FROM MAE_CLIEN_COMUN,
				    MAE_TIPO_COMUN
			   WHERE MAE_CLIEN_COMUN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE
			   AND	MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU
			   AND	MAE_TIPO_COMUN.COD_TIPO_COMU = 'TM') AS NUMTEL2,
			
			(SELECT VAL_TEXT_COMU 
			   FROM MAE_CLIEN_COMUN,
				    MAE_TIPO_COMUN
			   WHERE MAE_CLIEN_COMUN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE
			   AND	MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU
			   AND	MAE_TIPO_COMUN.COD_TIPO_COMU = 'TT') AS NUMTEL3,

		    TO_CHAR(' ') AS INDDIRTRABAJO,
		    TO_CHAR(' ') AS NUMTEL4,
		    TO_CHAR(' ') AS INDADICIONAL
      FROM  MAE_CLIEN,
       		MAE_CLIEN_TIPO_SUBTI,
			MAE_TIPO_CLIEN,
			MAE_CLIEN_DIREC,
	        SEG_TIPO_VIA,
       		ZON_VIA,
       		ZON_TERRI,
       		ZON_VALOR_ESTRU_GEOPO
	 WHERE  (MAE_CLIEN.OID_CLIE = MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE)
	 AND 	(MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE = MAE_TIPO_CLIEN.OID_TIPO_CLIE)
	 AND	(MAE_CLIEN.OID_CLIE = MAE_CLIEN_DIREC.CLIE_OID_CLIE)
     AND	(MAE_CLIEN_DIREC.TIVI_OID_TIPO_VIA = SEG_TIPO_VIA.OID_TIPO_VIA)
     AND	(MAE_CLIEN_DIREC.ZVIA_OID_VIA = ZON_VIA.OID_VIA (+))
     AND	(MAE_CLIEN_DIREC.TERR_OID_TERR = ZON_TERRI.OID_TERR)
     AND	(ZON_TERRI.VEPO_OID_VALO_ESTR_GEOP = ZON_VALOR_ESTRU_GEOPO.OID_VALO_ESTR_GEOP)         
     AND	(MAE_CLIEN_DIREC.IND_DIRE_PPAL = 1 )
	 AND	(MAE_CLIEN_DIREC.IND_ELIM = 0 )
           	<isNotEmpty prepend="AND" property="codigoTipoCliente">
     		  (MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoCliente#) 
            </isNotEmpty>
            <isNotEmpty prepend="AND" property="fechaInicioUltimoProceso">
	        <![CDATA[    
	 	      (MAE_CLIEN_DIREC.FEC_ULTI_ACTU > #fechaInicioUltimoProceso#) 
	        ]]>	
            </isNotEmpty>
     ORDER BY COD_CLIE		   
  </select>


  <!-- INTERFAZ - BEL - ENVIAR PORCENTAJES REFERENCIA  -->
  <select id="getInterfazBELPorcentajesReferencia" parameterClass="java.util.Map" resultMap="interfazBELPorcentajesReferenciaResult">
   	SELECT DISTINCT
       	   CABECERA.PERIODO,
       	   CABECERA.CODCLIENTE,	   
       	   CABECERA.ESTFACTURACION,	   
       	   CABECERA.CODGRUPO,
       	   CABECERA.PORCOMISION
      FROM		   
		   (SELECT NVL(SEG_PERIO_CORPO.COD_PERI, ' ') AS PERIODO,
	   			   NVL(MAE_CLIEN.COD_CLIE, ' ') AS CODCLIENTE,
	   			   TO_CHAR('N') AS ESTFACTURACION,  
	   			   NVL(MAE_GRUPO_DESCU.COD_GRUP_DESC, ' ') AS CODGRUPO,
	   			   NVL(PED_SOLIC_POSIC.VAL_PORC_DESC, 0) AS PORCOMISION,
				   PED_SOLIC_CABEC.OID_SOLI_CABE,
    		   	   PED_SOLIC_CABEC.SOCA_OID_SOLI_CABE
        	  FROM PED_SOLIC_CABEC,
    	       	   CRA_PERIO,
				   SEG_PAIS,
    		   	   SEG_MARCA,
    	       	   SEG_CANAL,
    	       	   SEG_PERIO_CORPO,
    	       	   SEG_TIPO_PERIO,
				   SEg_SUBAC,
    		   	   SEG_ACCES,	       
    		   	   PED_ESTAD_SOLIC,
			   	   FAC_TIPO_DOCUM,
    		   	   FAC_TIPO_DOCUM_LEGAL,
    	       	   PED_TIPO_SOLIC_PAIS,
    		   	   PED_TIPO_SOLIC,
    		   	   PED_SOLIC_POSIC,
    	       	   PED_ESTAD_POSIC,
    		   	   MAE_PRODU,
    	       	   SEG_MARCA_PRODU,
        		   MAE_CLIEN,
				   MAE_UNIDA_NEGOC,
				   MAE_GRUPO_DESCU 
        	 WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
        	 AND   (SEG_MARCA.COD_MARC = #codigoMarca#)
        	 AND   (SEG_CANAL.COD_CANA = #codigoCanal#)
        	 AND   (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
				   <isNotEmpty prepend="AND" property="codigoAcceso">
                      (SEG_ACCES.COD_ACCE = #codigoAcceso#)
                   </isNotEmpty>
        	 AND   (PED_SOLIC_CABEC.FEC_FACT = TO_DATE(#fechaFacturacion#,'DD/MM/YYYY'))
   	         AND   (PED_SOLIC_CABEC.IND_TS_NO_CONSO = 1)
   	         AND   (PED_SOLIC_CABEC.IND_OC = 1)
   			 AND   (PED_SOLIC_CABEC.IND_PEDI_PRUE = 0)	
   			 <![CDATA[   		
   	         AND   (PED_ESTAD_SOLIC.COD_ESTA_SOLI <> 'AN')
   			 AND   (FAC_TIPO_DOCUM_LEGAL.IND_ACTI_DOCU = 1)
			 AND   (PED_TIPO_SOLIC.IND_DEVO = 0)
   	         AND   (PED_TIPO_SOLIC.IND_ANUL = 0)
   			 AND   (PED_ESTAD_POSIC.COD_ESTA_POSI <> 'AN')
   			 ]]>	
    	     AND   (PED_SOLIC_CABEC.PERD_OID_PERI = CRA_PERIO.OID_PERI)
			 AND   (CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
    		 AND   (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
    	     AND   (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
    	     AND   (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
			 AND   (SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
			 AND   (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
			 AND   (PED_SOLIC_CABEC.SBAC_OID_SBAC = SEG_SUBAC.OID_SBAC)
		   	 AND   (SEG_SUBAC.ACCE_OID_ACCE = SEG_ACCES.OID_ACCE)
        	 AND   (PED_SOLIC_CABEC.ESSO_OID_ESTA_SOLI = PED_ESTAD_SOLIC.OID_ESTA_SOLI)
        	 AND   (PED_SOLIC_CABEC.TIDO_OID_TIPO_DOCU = FAC_TIPO_DOCUM.OID_TIPO_DOCU)
			 AND   (FAC_TIPO_DOCUM.COD_TIPO_DOCU = FAC_TIPO_DOCUM_LEGAL.COD_TIPO_DOLE)
        	 AND   (PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS = PED_TIPO_SOLIC_PAIS.OID_TIPO_SOLI_PAIS)
			 AND   (PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI = PED_TIPO_SOLIC.OID_TIPO_SOLI)
			 AND   (PED_SOLIC_CABEC.OID_SOLI_CABE = PED_SOLIC_POSIC.SOCA_OID_SOLI_CABE)
        	 AND   (PED_SOLIC_POSIC.ESPO_OID_ESTA_POSI = PED_ESTAD_POSIC.OID_ESTA_POSI (+))
			 AND   (PED_SOLIC_POSIC.PROD_OID_PROD = MAE_PRODU.OID_PROD)
			 AND   (MAE_PRODU.MAPR_OID_MARC_PROD = SEG_MARCA_PRODU.OID_MARC_PROD (+))
			 AND   (PED_SOLIC_CABEC.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)	        
   			 AND   (MAE_PRODU.UNEG_OID_UNID_NEGO = MAE_UNIDA_NEGOC.OID_UNID_NEGO (+))
   			 AND   (MAE_GRUPO_DESCU.PAIS_COD_PAIS = SEG_PAIS.COD_PAIS)
			 AND   (MAE_GRUPO_DESCU.COD_GRUP_ARTI = MAE_PRODU.VAL_GRUP_ARTI)
			 AND   (MAE_GRUPO_DESCU.COD_UNID_NEGO = MAE_UNIDA_NEGOC.COD_UNID_NEGO) 
   			 AND   (MAE_GRUPO_DESCU.COD_MARC_PROD = SEG_MARCA_PRODU.COD_MARC_PROD))
          ) CABECERA, PED_SOLIC_CABEC
    WHERE   CABECERA.SOCA_OID_SOLI_CABE = PED_SOLIC_CABEC.OID_SOLI_CABE 
	ORDER BY PERIODO, CODCLIENTE
  </select>


  <!-- INTERFAZ - BEL - ENVIAR UNIDADES ATENDIDAS  -->
  <select id="getInterfazBELUnidadesAtendidas" parameterClass="java.util.Map" resultMap="interfazBELUnidadesAtendidasResult">
  			 SELECT DISTINCT
           			NVL(SEG_PERIO_CORPO.COD_PERI, ' ') AS PERIODO,
        	   		NVL(PED_SOLIC_CABEC.VAL_NUME_SOLI, 0) AS NUMFACTURA,
        	   		NVL(PRE_OFERT_DETAL.VAL_CODI_VENT, ' ') AS CODVENTA,
        	   		NVL(REC_LINEA_OPERA_RECLA.NUM_UNID_DEVU, 0) AS UNDATENDIDAS
         	   FROM REC_OPERA_RECLA,
			  		REC_LINEA_OPERA_RECLA,
					REC_TIPO_MOVIM,
					REC_CABEC_RECLA,
            	    SEG_PAIS,
					PRE_MATRI_FACTU,
					PRE_OFERT_DETAL,
            		CRA_PERIO,
					SEG_MARCA,
            	    SEG_CANAL,
            	    SEG_PERIO_CORPO,
            	    SEG_TIPO_PERIO,
            		SEG_ACCES,
        			PED_SOLIC_CABEC
              WHERE (SEG_PAIS.COD_PAIS = #codigoPais#)
        	  AND	(SEG_MARCA.COD_MARC = #codigoMarca#)
        	  AND	(SEG_CANAL.COD_CANA = #codigoCanal#)
        	  		<isNotEmpty prepend="AND" property="codigoAcceso">
        			   (SEG_ACCES.COD_ACCE = #codigoAcceso#)
        			</isNotEmpty>
        	  AND   (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
        	  AND   (REC_OPERA_RECLA.FEC_FACT = TO_DATE(#fechaFacturacion#,'DD/MM/YYYY'))
    		  AND	(REC_OPERA_RECLA.IND_ATEN = 1)
    		  AND	(REC_TIPO_MOVIM.COD_TIPO_MOVI = 'D')  
        	  AND   (REC_OPERA_RECLA.OID_OPER_RECL = REC_LINEA_OPERA_RECLA.OPRE_OID_OPER_RECL)
			  AND	(REC_LINEA_OPERA_RECLA.TIMO_OID_TIPO_MOVI = REC_TIPO_MOVIM.OID_TIPO_MOVI)
			  AND   (REC_CABEC_RECLA.OID_CABE_RECL = REC_OPERA_RECLA.CARE_OID_CABE_RECL)
			  AND   (REC_CABEC_RECLA.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
			  AND   (REC_LINEA_OPERA_RECLA.MAFA_OID_MATR_FACT = PRE_MATRI_FACTU.OID_MATR_FACT (+))
        	  AND	(PRE_MATRI_FACTU.OFDE_OID_DETA_OFER = PRE_OFERT_DETAL.OID_DETA_OFER (+))
              AND   (REC_CABEC_RECLA.PERD_OID_PERI_DOCU_REFE = CRA_PERIO.OID_PERI)
			  AND   (CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
              AND   (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
              AND   (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
              AND   (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
        	  AND   (SEG_CANAL.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
        	  AND   (SEG_PERIO_CORPO.TIPE_OID_TIPO_PERI = SEG_TIPO_PERIO.OID_TIPO_PERI)
        	  AND	(REC_CABEC_RECLA.SOCA_OID_SOLI_CABE = PED_SOLIC_CABEC.SOCA_OID_SOLI_CABE)
			  ORDER BY PERIODO, NUMFACTURA, CODVENTA, UNDATENDIDAS
  </select>


  <!-- INTERFAZ - BEL - ENVIAR UBICACIONES GEOGRAFICAS -->
  <select id="getInterfazBELUbicacionesGeograficas" parameterClass="java.util.Map" resultMap="interfazBELUbicacionesGeograficasResult">
     WITH TEMPORAL_ZON_VALOR_ESTRU_GEOPO AS 
        (SELECT DISTINCT 
    	        OID_VALO_ESTR_GEOP,
    			DES_GEOG, 
    			ORDE_1, 
    			ORDE_2, 
    			ORDE_3, 
    			ORDE_4, 
    			COD_POST,
    			EGEO_OID_ESTR_GEOP
          FROM  SEG_PAIS,
                ZON_VALOR_ESTRU_GEOPO
          WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
    	  AND	(ZON_VALOR_ESTRU_GEOPO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
        	    <isNotEmpty prepend="AND" property="fechaInicioUltimoProceso">
    			   <![CDATA[    
    		          (ZON_VALOR_ESTRU_GEOPO.FEC_ACTU  > #fechaInicioUltimoProceso#) 
    			   ]]>	
    			</isNotEmpty>
     	        ) 
          )
    
    	  SELECT DISTINCT 
    			 SUBSTR(TRIM(T.ORDE_1), -2) AS CODUBIGEOGRAFICA,
    			 SUBSTR(TRIM(T.COD_POST), 0, 6)  AS CODUBIGEOGRAFICAPOSTAL,
                 T.DES_GEOG AS  DESCOMDEPARTAMENTO,
                 '' AS DESCOMPROVINCIA,
                 '' AS DESCOMDISTRITO,
                 SUBSTR(TRIM(T.DES_GEOG), 0, 10) AS DESABREDEPARTAMENTO,
                 '' AS DESABREPROVINCIA,
                 '' AS DESABREDISTRITO
    		FROM TEMPORAL_ZON_VALOR_ESTRU_GEOPO T
    		WHERE T.ORDE_1 IS NOT NULL  
    		AND	  T.ORDE_2 IS NULL
    		AND	  T.ORDE_3 IS NULL
    		AND	  T.ORDE_4 IS NULL
    
    	  UNION
    
    	  SELECT DISTINCT 
                 CONCAT(SUBSTR(TRIM(T.ORDE_1), -2), SUBSTR(TRIM(T.ORDE_2), -2)) AS CODUBIGEOGRAFICA,
                 SUBSTR(  TRIM(T.COD_POST),0,6) AS CODUBIGEOGRAFICAPOSTAL,
                 T2.DES_GEOG AS  DESCOMDEPARTAMENTO,
    		     T.DES_GEOG AS DESCOMPROVINCIA,
                 '' AS DESCOMDISTRITO,
                 SUBSTR( TRIM(T2.DES_GEOG),0,10) AS DESABREDEPARTAMENTO,
                 SUBSTR( TRIM(T.DES_GEOG),0,10) AS DESABREPROVINCIA,
                 '' AS DESABREDISTRITO
    	    FROM TEMPORAL_ZON_VALOR_ESTRU_GEOPO T, TEMPORAL_ZON_VALOR_ESTRU_GEOPO T2
    	    WHERE T.ORDE_1 IS NOT NULL
    	    AND	  T.ORDE_2 IS NOT NULL
    	    AND	  T.ORDE_3 IS NULL
    	    AND	  T.ORDE_4 IS NULL
    	    AND   T.OID_VALO_ESTR_GEOP = T2.OID_VALO_ESTR_GEOP  
    
    	  UNION
    
    	  SELECT DISTINCT
    	  		 CONCAT(CONCAT(SUBSTR(TRIM(T.ORDE_1), -2), SUBSTR(TRIM(T.ORDE_2), -2)), 
    			        SUBSTR(TRIM(T.ORDE_3), -2)) AS CODUBIGEOGRAFICA, 
    		     SUBSTR( TRIM(T.COD_POST),0,6) AS CODUBIGEOGRAFICAPOSTAL,
           		 T3.DES_GEOG AS  DESCOMDEPARTAMENTO,
    			 T2.DES_GEOG AS DESCOMPROVINCIA,
    	   		 T.DES_GEOG  AS DESCOMDISTRITO,
           		 SUBSTR(TRIM(T3.DES_GEOG),0,10) AS DESABREDEPARTAMENTO,
           		 SUBSTR(TRIM(T2.DES_GEOG),0,10) AS DESABREPROVINCIA,
           		 SUBSTR(TRIM(T.DES_GEOG),0,10) AS DESABREDISTRITO
    		FROM TEMPORAL_ZON_VALOR_ESTRU_GEOPO T, 
    			 TEMPORAL_ZON_VALOR_ESTRU_GEOPO T2, 
    			 TEMPORAL_ZON_VALOR_ESTRU_GEOPO T3
    		WHERE T.ORDE_1 IS NOT NULL
    		AND	  T.ORDE_2 IS NOT NULL
    		AND	  T.ORDE_3 IS NOT NULL
    		AND	  T.ORDE_4 IS NULL
    		AND	  T.OID_VALO_ESTR_GEOP = T2.OID_VALO_ESTR_GEOP 
    		AND	  T2.OID_VALO_ESTR_GEOP = T3.OID_VALO_ESTR_GEOP
  </select>


  <!-- INTERFAZ - GIS - ENVIAR DIRECION CONSULTORAS -->
  <select id="getInterfazGISEnviarDireccionConsultoras" parameterClass="java.util.Map" resultMap="interfazGISEnviarDireccionConsultorasResult">
        SELECT DISTINCT
			   'N' AS TIPREG,
       		   SEG_PAIS.COD_PAIS AS CODPAI,
       		   SEG_MARCA.COD_MARC AS CODMAR,
       		   SEG_CANAL.COD_CANA AS CODCAN,
       	       MAE_CLIEN.COD_CLIE AS CODCLI,
       		   ZON_TERRI.COD_TERR AS CODTER,
       		   NVL(MAE_CLIEN.VAL_NOM1, ' ') || ' ' || NVL(MAE_CLIEN.VAL_NOM2, ' ') AS NOMCLI,
       		   NVL(MAE_CLIEN.VAL_APE1, ' ') AS APEUNO,
       		   NVL(MAE_CLIEN.VAL_APE2, ' ') || ' ' || NVL(MAE_CLIEN.VAL_APEL_CASA, ' ') AS APEDOS,
			   
			   (SELECT GEN_I18N_SICC_COMUN.VAL_I18N
      		      FROM  GEN_I18N_SICC_COMUN,
           	   	  	    SEG_IDIOM,
    	   	   		    BAS_IDIOM
    		      WHERE ((GEN_I18N_SICC_COMUN.VAL_OID = MAE_ESTAT_CLIEN.OID_ESTA_CLIE )
				  AND 	(GEN_I18N_SICC_COMUN.IDIO_OID_IDIO = SEG_IDIOM.OID_IDIO)
				  AND 	(BAS_IDIOM.COD_ESIC = SEG_IDIOM.COD_IDIO)
    			  AND 	(GEN_I18N_SICC_COMUN.ATTR_ENTI ='MAE_ESTAT_CLIEN')
    			  AND 	(BAS_IDIOM.COD_ESIC = UPPER(#codigoIdioma#)) 
    			        )
    	   	   ) AS EST,
			   
       	       NVL(MAE_CLIEN_DIREC.VAL_NOMB_VIA, ' ') AS VIA, 
       		   MAE_CLIEN_DIREC.NUM_PPAL AS NUMPRI,
       	       NVL(MAE_CLIEN_DIREC.VAL_INTE, 0) AS INTE,
       		   NVL(MAE_CLIEN_DIREC.VAL_MANZ, 0) AS MAN,
       	       NVL(MAE_CLIEN_DIREC.VAL_OBSE, ' ') AS OBS,
       		   NVL(MAE_CLIEN_DIREC.IND_CTRL_INTE_GEOR, ' ') AS ERRUBI,
       	       ZON_VIA.COD_VIA AS SECVIA,
			   NVL(MAE_CLIEN_DIREC.COD_UNID_GEOG, ' ') AS UBIGEO
			   
       	  FROM MAE_CLIEN,
			   SEG_PAIS,
       	       MAE_CLIEN_UNIDA_ADMIN,
			   SEG_MARCA,
       	       SEG_CANAL,
       	       ZON_TERRI_ADMIN,
			   ZON_TERRI,
			   MAE_CLIEN_TIPO_SUBTI,
			   MAE_TIPO_CLIEN,
			   ZON_SECCI,
			   ZON_REGIO,
       	       ZON_ZONA,
			   MAE_CLIEN_DIREC,
			   ZON_VIA,
			   MAE_CLIEN_DATOS_ADICI,
       	       MAE_ESTAT_CLIEN
       	 WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
  	     AND   (SEG_MARCA.COD_MARC = #codigoMarca#)
  	     AND   (SEG_CANAL.COD_CANA = #codigoCanal#)
  	     AND   (MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoCliente#)
  	     AND   (ZON_REGIO.COD_REGI = #codigoRegion#)
  	     AND   (ZON_SECCI.IND_ACTI = 1)
		 AND   (ZON_ZONA.IND_ACTI = 1)
		 AND   (ZON_REGIO.IND_ACTI = 1)
  	     AND   (ZON_TERRI_ADMIN.IND_BORR = 0)
  	     AND   (MAE_CLIEN_UNIDA_ADMIN.IND_ACTI = 1)
  	     AND   (MAE_CLIEN_DIREC.IND_DIRE_PPAL = 1)
		 AND    MAE_CLIEN_DIREC.IND_ELIM = 0
		 AND   (MAE_CLIEN.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
		 AND   (MAE_CLIEN_UNIDA_ADMIN.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
		 AND   (MAE_CLIEN_UNIDA_ADMIN.ZTAD_OID_TERR_ADMI = ZON_TERRI_ADMIN.OID_TERR_ADMI)
		 AND   (ZON_TERRI_ADMIN.MARC_OID_MARC = SEG_MARCA.OID_MARC)
  	     AND   (ZON_TERRI_ADMIN.CANA_OID_CANA = SEG_CANAL.OID_CANA)
		 AND   (ZON_TERRI_ADMIN.TERR_OID_TERR = ZON_TERRI.OID_TERR)
		 AND   (MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
		 AND   (MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE = MAE_TIPO_CLIEN.OID_TIPO_CLIE)
		 AND   (ZON_TERRI_ADMIN.ZSCC_OID_SECC = ZON_SECCI.OID_SECC)
		 AND   (ZON_SECCI.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA)
		 AND   (ZON_ZONA.ZORG_OID_REGI = ZON_REGIO.OID_REGI)
		 AND   (MAE_CLIEN_DIREC.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
		 AND   (MAE_CLIEN_DIREC.ZVIA_OID_VIA = ZON_VIA.OID_VIA)
		 AND   (MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
  	     AND   (MAE_CLIEN_DATOS_ADICI.ESTA_OID_ESTA_CLIE = MAE_ESTAT_CLIEN.OID_ESTA_CLIE (+))
  	     )
  </select>


  <!-- INTERFAZ - GEO - ENVIAR ZONA Y TERRITORIO DE CLIENTE -->
  <select id="getClientesUAGenerar" resultMap="interfazGEOZonaTerritorioClienteResult">
		SELECT 
		PAIS_COD_PAIS, 
		COD_CLIE, 
		TIP_DIRE, 
		TIP_VIA, 
		NOM_VIA, 
		VAL_NUME, 
		VAL_INTE, 
		VAL_MANZ, 
		VAL_LOTE, 
		VAL_KILO, 
		COD_UBIG_NIV1, 
		COD_UBIG_NIV2, 
		COD_UBIG_NIV3, 
		COD_UBIG_NIV4, 
		NIV_SOCI, 
		VAL_COOX, 
		VAL_COOY, 
		VAL_COOZ, 
		COD_TERR, 
		EST_VALI, 
		COD_ZONA, 
		USU_DIGI, 
		FEC_DIGI, 
		USU_MODI, 
		FEC_MODI, 
		EST_CLIE 
		FROM INT_GEO_CLIEN_UNADM
  </select>


  <!-- INTERFAZ - COM - ENVIAR LIBRETA AHORROS -->
  <select id="getInterfazCOMEnviarLibretaAhorros" parameterClass="java.util.Map" resultMap="interfazCOMEnviarLibretaAhorrosResult">
	 SELECT  MAE_CLIEN_LIDER.COD_PLAN AS CODPLA,
       	   	 MAE_CLIEN_LIDER.NUM_DNI AS DNI,
	   	   	 MAE_CLIEN_LIDER.NUM_LIAH AS NULIAHORRO,
	   	   	 ' ' AS TIPCU,
	   	   	 ' ' AS CODBAN 
	  FROM   MAE_CLIEN_LIDER
	  WHERE ((MAE_CLIEN_LIDER.PAIS_COD_PAIS = #codigoPais#) 
	        )
  </select>

  
  <!-- INTERFAZ - COM - ENVIAR LIDERES NUEVAS -->
  <select id="getInterfazCOMEnviarLideresNuevas" parameterClass="java.util.Map" resultMap="interfazCOMEnviarLideresNuevasResult">
        SELECT NOM_CLIE AS NOM, 
			  APE_PATE AS APEPA, 
   			  APE_MATE AS APEMA, 
			  FEC_INGR AS FECING, 
			  NUM_DNI AS DNI, 
   			  VAL_DIRE AS DIR, 
              '0' AS FLAG,
			  VAL_TELE AS TEL, 
			  FEC_NACI AS FECNAC, 
   			  VAL_CIUD AS CIUD, 
			  EST_CIVI AS ESCIV, 
			  VAL_LIPR AS LIMPRO,
   			  FEC_INPL AS FECINGPLA, 
			  CEN_COST AS CENCOS, 
			  COD_ZONA AS CODZON, 
   			  DES_DIST AS DESDISTR, 
			  SUBSTR(COD_CLID, -LEAST(LENGTH(COD_CLID), 10)) AS CODLID, 
			  DES_DEPA AS DESDEPA, 
   			  DES_PROV AS DESPRO
	     FROM MAE_LIDER_NUEVA_TEMPO
		WHERE COD_PAIS = #codigoPais#
  </select>
   
  <!-- INTERFAZ - COM - RECEPCIONAR CODIGOS DE PLANILLA -->
  <update id="updateLibretaAhorroInterfaz" parameterClass="libretaAhorro">
        UPDATE MAE_CLIEN_LIDER 
        SET COD_PLAN  = #codigoPlanilla# 
        WHERE NUM_DNI = #documentoIdentidad# 
  </update>
    

  <!-- INTERFAZ - COM - ENVIAR PAGO LIDERES -->
  <select id="getInterfazCOMEnviarPagoLideres" parameterClass="java.util.Map" resultMap="interfazCOMEnviarPagoLideresResult">
			SELECT DISTINCT
				C.COD_PLAN AS CODPLA, 
				TRIM(TO_CHAR(COM_PKG_REPOR.COM_FN_DEVUE_COMIS_LIDER_SECCI(A.PERI_COD_PERI, A.COD_LIDE_SECC, #codigoComisionIngreso#, #codigoComisionRecu1#) , '99999990.99')) AS MONPAG
			   FROM COM_COMIS_PERIO_CALCU A,
					MAE_CLIEN_LIDER C 
			   WHERE A.PERI_COD_PERI = #codigoPeriodo#
				 AND C.PAIS_COD_PAIS = #codigoPais#
				 AND C.COD_PLAN IS NOT NULL 
				 AND C.COD_CLID = A.COD_LIDE_SECC
				 AND COM_PKG_REPOR.COM_FN_DEVUE_COMIS_LIDER_SECCI(A.PERI_COD_PERI, A.COD_LIDE_SECC, #codigoComisionIngreso#, #codigoComisionRecu1#) > 0
				 AND NOT EXISTS (SELECT X.COD_CLIB
								  FROM MAE_CLIEN_LIDER_BLOQU X
                                                 WHERE (<![CDATA[  
								           X.PAIS_COD_PAIS = C.PAIS_COD_PAIS
									   AND X.COD_CLIB = A.COD_LIDE_SECC 
									   AND (#codigoPeriodo# >= X.PER_INIC)
									   AND (#codigoPeriodo# <= X.PER_FINA OR X.PER_FINA IS NULL) 
                                       AND X.EST_CLIB = '1'
   	     	  								  		   ]]>	
                                                       )
                     						    )
				 
			   ORDER BY C.COD_PLAN
	</select>


    
    <!--  MANTENIMIENTO INSERCION - PER - MOVIMIENTOS BANCARIOS CABECERA -->
    <insert id="insertMovimientosBancariosCabecera" parameterClass="movimientosBancariosCabecera">
    	<![CDATA[
	    INSERT INTO PER_MOVIM_BANCA_CABEC
	    (
		PAIS_COD_PAIS,
		NUM_LOTE_INTE,
		NUM_LOTE_EXTE,
		FEC_PROC,
		COD_SOCI,
		COD_CCBA,
		TIOR_TIPO_ORIG_DATO,
		STA_LOTE,
		USU_DIGI,
		FEC_DIGI,
		EST_MOCA
		) 
	    VALUES 
	    (
		#codigoPais#,
		#numeroLoteInterno#,
		#numeroLoteExterno#,
		#fechaProceso#,
		#codigoSociedad#,
		#codigoBancoSicc#,
		#codigoTipoOrigenDatos#,
		#statusLote#,
		#auditInfo.createdBy#,
		#auditInfo.created#,
		#estado#
	    )
	    ]]>
	</insert>

    <!--  MANTENIMIENTO INSERCION - PER - MOVIMIENTOS BANCARIOS DETALLE -->
    <insert id="insertMovimientosBancariosDetalle" parameterClass="movimientosBancariosDetalle">
    	<![CDATA[
	    INSERT INTO PER_MOVIM_BANCA_DETAL
	    (
	    PAIS_COD_PAIS,
		TIOR_TIPO_ORIG_DATO,
		MOCA_NUM_LOTE_INTE,
		FEC_PAGO,
		CON_TRAN,
		VAL_PAGO,
		NUM_CUPO,
		COD_CONS,
		DIG_CHEQ,
		OFI_RECA,
		NOM_OFIC,
		TIP_TRAN,
		NUM_DOCU,
		VAL_HORA,
		USU_PROC,
		FEC_PROC,
		HOR_PROC,
		DES_OBSE,
		IMP_PAGO_APLI,
		IMP_PAGO_PEND,
		IMP_RECA_GENE,
		IMP_PERC,
		STA_MOVI,
		USU_DIGI,
		FEC_DIGI,
		EST_MODE,
		COD_PLAN_EMPL,
		IND_REPE												
		) 
	    VALUES 
	    (
	    #codigoPais#,
		#codigoTipoOrigenDatos#,
		#numeroLoteInterno#,
		#fechaPago#,
		#consecutivo#,
		#importePago#,
		#numeroCupon#,
		#codigoConsultora#,
		#digitoChequeo#,
		#oficinaRecaudadora#,
		#nombreOficina#,
		#tipoTransaccion#,
		#numeroDocumento#,
		#horario#,
		#usuarioProceso#,
		#fechaProceso#,
		#horaProceso#,
		#observacion#,
		#importePagoAplicado#,
		#importePagoPendiente#,
		#importeRecaudoGenerado#,
		#importePercepcion#,
		#statusMovimiento#,
		#auditInfo.createdBy#,
		#auditInfo.created#,
		#estado#,
        #codigoPlanilla#,
        0														
	    )
	    ]]>
	</insert>
	
	<!--  VALIDA EXISTENCIA EN PER - MOVIMIENTOS BANCARIOS DETALLE -->														    
    <select id="existePercepcionesDetalle" parameterClass="movimientosBancariosDetalle" resultClass="int">
        select decode(count(*),0,0,1 )
		from per_movim_banca_detal pmd
		where pmd.cod_cons = #codigoConsultora#
		and to_char(pmd.fec_pago,'dd/mm/yyyy') = to_char(#fechaPago#,'dd/mm/yyyy')
		and pmd.val_pago  = #importePago#
	    and pmd.tior_tipo_orig_dato = '09'
	    and pmd.est_mode = 1
	    and pmd.ind_repe = 0
	</select>
    
      <!-- INTERFAZ - COM - RECEPCIONAR CODIGOS DE PLANILLA -->														
	  <update id="updateIndRepePercepcionesDetalle" parameterClass="movimientosBancariosDetalle">														
	      update per_movim_banca_detal pmd
		     set pmd.ind_repe = 1
		   where pmd.cod_cons = #codigoConsultora#
		     and to_char(pmd.fec_pago, 'dd/mm/yyyy') = to_char(#fechaPago#,'dd/mm/yyyy')
		     and pmd.val_pago = #importePago# 
		     and pmd.tior_tipo_orig_dato = '09'
		     and pmd.ind_repe = 0
		     and pmd.est_mode = 1
		     and rownum = 1														
	  </update>
														
	<!--  MANTENIMIENTO INSERCION - PER - MOVIMIENTOS BANCARIOS DETALLE -->
    <insert id="insertInterfazPERActualizarPercepcionesConsolidado" parameterClass="consolidadosOtrosCanales">
		INSERT INTO PER_PERCE_CONSO
		(
		PAIS_COD_PAIS,
		COD_SOCI,
		COD_CANA,
		COD_ACCE,
		COD_SBAC,
		TIP_CLIE,
		COD_CLIE,
		SER_COPE,
		NUM_COPE,
		SEC_COPE,
		COR_PECO,
		TIP_DOID,
		NUM_DOID,
		TIP_DOLE,
		FEC_DOLE,
		SER_DOLE,
		NUM_DOLE,
		MON_PAGO,
		MON_PERC,
		POR_PERC,
		MON_TODL,
		FEC_COPE,
		FLA_PROC,
		FLA_CANC,
		USU_DIGI,
		FEC_DIGI,
		EST_PECO,
		APE_PATE,
		APE_MATE,
		VAL_NOMB
		)
		VALUES
		(
		#codigoPais#,
		#codigoSociedad#,
		#codigoCanal#,
		#codigoAcceso#,
		#codigoSubacceso#,
		#tipoCliente#,
		#codigoCliente#,
		#serieComprobantePercepcion#,
		#numeroComprobantePercepcion#,
		#secuenciaComprobantePercepcion#,
		#correlativoComprobantePercepcion#,
		#tipoDocumentoIdentidad#,
		#numeroDocumentoIdentidad#,
		#tipoDocumentoLegal#,
		#fechaEmisionDocumentoLegal#,
		#serieDocumentoLegal#,
		#numeroDocumentoLegal#,
		TO_NUMBER(TRIM(#montoPago#),'999999.9999'),												
		TO_NUMBER(TRIM(#montoPercepcion#),'999999.9999'),												
		TO_NUMBER(TRIM(#porcentajePercepcion#),'999999.9999'),												
		TO_NUMBER(TRIM(#montoTotalDocumentoLegal#),'999999.9999'),												
		#fechaEmisionComprobantePercepcion#,
		#flagProceso#,
		#flagCancelacion#,
		#auditInfo.createdBy#,
		#auditInfo.created#,
		#estado#,
		#apellidoPaterno#,
		#apellidoMaterno#,
		#nombres#
		)
	</insert>
	
	<select id="getPercepcionesConsolidadoCorrelativoSiguiente" resultClass="string">
		SELECT NVL(MAX(COR_PECO)+1,1) FROM PER_PERCE_CONSO
	</select>
	
	<select id="getInterfazSICEnviarClasificacionConsultorasNuevasPeriodoEvaluar" parameterClass="java.util.Map" resultClass="java.lang.String">
		<![CDATA[
		SELECT seg_perio_corpo.cod_peri
		  FROM seg_perio_corpo,
		       cra_perio,
		       seg_marca,
		       seg_canal,
		       seg_pais
		 WHERE (    (seg_perio_corpo.oid_peri = cra_perio.peri_oid_peri)
		        AND (seg_marca.oid_marc = cra_perio.marc_oid_marc)
		        AND (seg_canal.oid_cana = cra_perio.cana_oid_cana)
		        AND (seg_pais.oid_pais = cra_perio.pais_oid_pais)
				AND (seg_pais.cod_pais = #codigoPais#)
                AND (seg_marca.cod_marc = #codigoMarca#)
				AND (seg_canal.cod_cana = #codigoCanal#)
				AND (seg_perio_corpo.cod_peri <= #periodo#)
		       )
		 ORDER BY seg_perio_corpo.cod_peri DESC		
		 ]]>
	</select>
		
	<select id="getInterfazSICEnviarClasificacionConsultorasNuevasNuevo" parameterClass="java.util.Map" resultClass="java.lang.String">
        SELECT DISTINCT
               COD_CLIE
        FROM   MAE_CLIEN,
               MAE_CLIEN_DATOS_ADICI,
               MAE_ESTAT_CLIEN,
               MAE_TIPO_CLIEN,
               MAE_SUBTI_CLIEN
        WHERE (    (MAE_CLIEN.OID_CLIE = MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE)
               AND (MAE_ESTAT_CLIEN.OID_ESTA_CLIE = MAE_CLIEN_DATOS_ADICI.ESTA_OID_ESTA_CLIE) 
               AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE)
               AND (MAE_ESTAT_CLIEN.COD_ESTA_CLIE = '01' OR MAE_ESTAT_CLIEN.COD_ESTA_CLIE = '02')
               <isNotEmpty property="codigoSubTipoCliente">  
                  <iterate prepend="AND" property="codigoSubTipoCliente" open="(" close=")" conjunction="OR">
                     MAE_SUBTI_CLIEN.COD_SUBT_CLIE = #codigoSubTipoCliente[]#
                  </iterate>  
               </isNotEmpty>                
               AND (MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoCliente#)
               AND NOT EXISTS (
                       SELECT MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE
                          FROM MAE_CLIEN_TIPO_SUBTI,
                               MAE_CLIEN_CLASI,
                               MAE_TIPO_CLASI_CLIEN
                         WHERE (MAE_CLIEN_TIPO_SUBTI.OID_CLIE_TIPO_SUBT = MAE_CLIEN_CLASI.CTSU_OID_CLIE_TIPO_SUBT)
                           AND (MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS = MAE_CLIEN_CLASI.TCCL_OID_TIPO_CLASI)
                           AND (MAE_TIPO_CLASI_CLIEN.COD_TIPO_CLAS = #codigoTipoClasificacionNuevo#)
                          AND (MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
                       ) 
               AND NOT EXISTS (
                       SELECT MAE_CLIEN_BLOQU.CLIE_OID_CLIE
                         FROM MAE_CLIEN_BLOQU
                        WHERE (MAE_CLIEN_BLOQU.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
                   )
		      )
	</select>
	
	<select id="getInterfazSICEnviarClasificacionConsultorasNuevasAntiguo" parameterClass="java.util.Map" resultClass="java.lang.String">
        SELECT DISTINCT
               COD_CLIE
          FROM MAE_CLIEN,
               MAE_CLIEN_PRIME_CONTA,
               MAE_TIPO_CLIEN,
               MAE_SUBTI_CLIEN,
               MAE_CLIEN_TIPO_SUBTI,
               CRA_PERIO,
               SEG_PERIO_CORPO
         WHERE (    (MAE_CLIEN.OID_CLIE = MAE_CLIEN_PRIME_CONTA.CLIE_OID_CLIE)
                AND (MAE_CLIEN.OID_CLIE = MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE)
                AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE)
                AND (MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_CLIEN_TIPO_SUBTI.SBTI_OID_SUBT_CLIE)
                AND (MAE_TIPO_CLIEN.OID_TIPO_CLIE = MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE)
                AND (CRA_PERIO.OID_PERI = MAE_CLIEN_PRIME_CONTA.PERD_OID_PERI)
                AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
                <isNotEmpty property="codigoSubTipoCliente">  
                  <iterate prepend="AND" property="codigoSubTipoCliente" open="(" close=")" conjunction="OR">
                     MAE_SUBTI_CLIEN.COD_SUBT_CLIE = #codigoSubTipoCliente[]#
                  </iterate>  
                </isNotEmpty>               
                AND (MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoCliente#)
                AND (SEG_PERIO_CORPO.COD_PERI = #periodoEvaluar#)
                AND NOT EXISTS (
                        SELECT MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE
                          FROM MAE_CLIEN_TIPO_SUBTI,
                               MAE_CLIEN_CLASI,
                               MAE_TIPO_CLASI_CLIEN
                         WHERE (MAE_CLIEN_TIPO_SUBTI.OID_CLIE_TIPO_SUBT = MAE_CLIEN_CLASI.CTSU_OID_CLIE_TIPO_SUBT)
                           AND (MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS = MAE_CLIEN_CLASI.TCCL_OID_TIPO_CLASI)
                           AND (MAE_TIPO_CLASI_CLIEN.COD_TIPO_CLAS = #codigoTipoClasificacionAntiguo#)
                           AND (MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
                       ) 
                AND NOT EXISTS (
                        SELECT MAE_CLIEN_BLOQU.CLIE_OID_CLIE
                          FROM MAE_CLIEN_BLOQU
                         WHERE (MAE_CLIEN_BLOQU.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
                   )
               )
	</select>
	
	<select id="getInterfazSICTipoClasificacion" parameterClass="java.util.Map" resultClass="java.lang.String">
		<![CDATA[
		SELECT val_tipo_clas
		FROM int_pri_clien_nueva_tipo_clasi 
		WHERE pais_cod_pais = #codigoPais# and cod_tipo_clas = #codigoClasificacion#
		]]>	
	</select>
	
	<delete id="deleteInterfazPRIRecepcionarClientes">
        TRUNCATE TABLE PRI_CALIF_CLIEN
    </delete>

	<insert id="insertInterfazPRIRecepcionarClientes" parameterClass="java.util.Map">

    	<![CDATA[
          insert into pri_calif_clien
            (cod_peri, 
             cod_cons, 
             cod_clie, 
             nom_clie, 
             tel_clie, 
             fec_naci,
			 cod_pais
		    )
        values      
		(
		#codigoPeriodo# ,
		#codigoConsultora# ,
        #codigoCliente# ,
        #nombreCliente# ,
        #numerosTelefonosCliente# ,
		#fechaNacimientoCliente#,
		#codigoPais# 
        )
	    ]]>
	</insert>

	<delete id="deleteInterfazPRIRecepcionarCalificacion">
        TRUNCATE TABLE PRI_CALIF_CONSU
    </delete>

	<delete id="deleteInterfazPRIRecepcionarMovimientoCliente">
        TRUNCATE TABLE PRI_MOVIM_CLIEN
    </delete>

	<insert id="insertInterfazPRIRecepcionarCalificacion" parameterClass="java.util.Map">

    	<![CDATA[
      insert into pri_calif_consu
          (
           cod_cons, 
           cod_peri, 
           fla_fich_ins, 
           fla_tarj_ins, 
           fla_prod_acm, 
           fla_prem_spr, 
           fla_prem_sop, 
           fla_prem_cpr, 
           fla_prem_cop, 
           fla_fich_bon, 
           fla_tarj_bon, 
           cod_pais
           )
       values
      (
		#codigoConsultora# ,
		#codigoPeriodo# ,
        #flagClientesInscritos# ,
        #flagClientesTarjeta# ,
        #flagClientesPuntos# ,
        #flagClientesPremios# ,
        #flagClientesOportunidad# ,
        #flagClientesCanjePremios# ,
        #flagClientesCanjeOportunidad# ,
        #flagClientesFicha# ,
        #flagClientesAbonoTarjeta# ,
		#codigoPais# 
        )
	    ]]>
	</insert>

	<delete id="deleteInterfazRETRecepcionarVentasRetailCab">
        TRUNCATE TABLE INT_RET_CABEC_RECLA
    </delete>

	<delete id="deleteInterfazRETRecepcionarVentasRetailDet">
        TRUNCATE TABLE INT_RET_OPERA_RECLA 
    </delete>

	<delete id="deleteInterfazRETRecepcionarVentasRetailDetDet">
        TRUNCATE TABLE INT_RET_LINEA_OPERA_RECLA
    </delete>

	<insert id="insertInterfazRETRecepcionarVentasRetailCab" parameterClass="java.util.Map">

    	<![CDATA[
        insert into int_ret_cabec_recla
          (cod_pais, 
           num_aten, 
           numreclamo, 
           marca, 
           codcanal, 
           codacc, 
           codsubac, 
           numdocref, 
           periodocref, 
           fecdocref, 
           cliente, 
           tipocliente, 
           subtipocliente, 
           subgerenc, 
           region, 
           seccion, 
           zona, 
           territcliente, 
           tipodoc, 
           estadorec, 
           motivbloq, 
           motivrech, 
           motivdesb, 
           totalenvia, 
           totaldevuelve, 
           saldopagar, 
           tipoing, 
           usuingreso, 
           periodrec, 
           fecingreso, 
           numateninter )
        values (

        #codigoPais#		,
        #numAtencion#           ,
        #numReclamo#            ,
        #codigoMarca#           ,
        #codigoCanal#           ,
        #codigoAcceso#          ,
        #codigoSubacceso#       ,
        #numDocRef#             ,
        #perioDocRef#           ,
        #fecDocRef#             ,
        #codigoCliente#         ,
        #codigoTipoCliente#     ,
        #codSubTipoCliente#     ,
        #codigoSubger#          ,
        #codigoRegion#          ,
        #codigoSeccion#         ,
        #codigoZona#            ,
        #codigoTerritCliente#   ,
        #codigoTipoDoc#         ,
        #estadoRec#             ,
        #codMotivBloq#          ,
        #codMotivRech#          ,
        #codMotivDesb#          ,
        #totalEnvia#            ,
        #totalDevuelve#         ,
        #saldoPagar#            ,
        #codTipoIng#            ,
        #usuIngreso#            ,
        #periodRec#             ,
        #fecIngreso#            ,
        #numAtenInter#           
      )
	    ]]>
	</insert>

	<insert id="insertInterfazRETRecepcionarVentasRetailDet" parameterClass="java.util.Map">

    	<![CDATA[
    insert into int_ret_opera_recla
      (
       cod_pais, 
       num_aten, 
       num_secu_oper, 
       periodrec, 
       marca, 
       tiposolicperd, 
       periodo, 
       estadooper, 
       tipooper, 
       codoper, 
       motivbloq, 
       tipobloq, 
       motivrech, 
       motivdesb, 
       codcanal, 
       codacc, 
       codsubac, 
       docref, 
       indentrmerc, 
       responperd, 
       flgasumeperd, 
       clienteseg, 
       codigoart, 
       montperdida, 
       precperd, 
       fecfact, 
       indatendido, 
       porcperdida
       )
    values (
        #codigoPais#     ,
        #numAtencion#    ,
        #numSecOper#     ,
        #periodRec#      ,
        #codigoMarca#	 ,    
        #tipoSolicPerd#  ,    
        #codigoPeriodo#  ,  
        #estadoOper#     ,      
        #tipoOperacion#  ,
        #codigoOperacion#,
        #codMotivBloq#   ,
        #tipoBloq#       ,
        #codMotivRech#   ,
        #codMotivDesb#   ,
        #codigoCanal#    ,
        #codigoAcceso#   ,
        #codigoSubacceso#,
        #docRef#         ,
        #indEntrMerc#    ,
        #responPerd#     ,
        #flgAsumePerd#   ,
        #clientSeg#      ,
        #codigoArt#      ,    
        #montPerdida#    ,
        #precPerd#       ,
        #fecFact#         ,    
        #indAtendido#    ,
        #porcPerdida#            
 	)	    

  ]]>
	</insert>

	<insert id="insertInterfazRETRecepcionarVentasRetailDetDet" parameterClass="java.util.Map">

    	<![CDATA[
    insert into int_ret_linea_opera_recla
        (
            cod_pais, 
            num_aten, 
            num_secu_oper, 
            num_line, 
            tipomovim, 
            motivdesb, 
            periodo, 
            codcanal, 
            marca, 
            tipooferta, 
            producto, 
            unidadreclam, 
            precio, 
            importeabono, 
            importecargo, 
            unidaddevuelt, 
            indestado, 
            tiposolic, 
            tipoposic, 
            montoperdida, 
            precperdida, 
            indatendido, 
            motivdevol, 
            dteestrateg, 
            dtenumoferta, 
            dtelineaoferta
        )
      values
      (
        #codigoPais#	,
        #numAtencion#   ,
        #numSecOper#    ,
        #numLinea#      ,
        #tipoMovim#     ,
        #codMotivDesb#  ,
        #codigoPeriodo# ,
        #codigoCanal#   ,
        #codigoMarca#   ,
        #tipoOferta#    ,
        #codigoProducto#,
        #unidadReclam#  ,
        #precio#        ,
        #importeAbono#  ,
        #importeCargo#  ,
        #unidadDevuelt# ,
        #indEstado#     ,
        #tipoSolic#     ,
        #tipoPosic#     ,
        #montoPerdida#  ,
        #precioPerdida# ,
        #atendido#      ,
        #codMotivDevol# ,
        #dteEstrateg#   ,
        #dteNumOferta#  ,
        #dteLineaOferta# 
      )  
	    ]]>
	</insert>

    <!--  INTERFAZ ACUMULAR HISTORICO DERALLE VENTA RETAIL -->
	<insert id="insertRETConsolidadoVentasRetail" parameterClass="java.util.Map">
			INSERT INTO RET_CONSO_VENTA
		        ( SELECT CABREC.COD_PAIS,
                         CABREC.CLIENTE ,
                         CABREC.FECINGRESO FECING,                                     
                         SUM(LINREC.UNIDADRECLAM*LINREC.Precio) ,
                         'N' ,
						 decode(trim(CABREC.ZONA),null,GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CABREC.CLIENTE,'COD_ZONA'),cabrec.zona)                         
                         
                  FROM    INT_RET_OPERA_RECLA OPEREC, 
                          INT_RET_CABEC_RECLA CABREC, INT_RET_LINEA_OPERA_RECLA LINREC
                  WHERE 
                           CABREC.COD_PAIS = #codigoPais#  AND
                           CABREC.COD_PAIS = OPEREC.COD_PAIS  AND                                                 
                           CABREC.NUM_ATEN = OPEREC.NUM_ATEN AND                 
                           OPEREC.CODOPER = 'VR'  AND                 
                           LINREC.COD_PAIS = OPEREC.COD_PAIS  AND               
                           LINREC.NUM_SECU_OPER = OPEREC.NUM_SECU_OPER AND                  
                           LINREC.NUM_ATEN = OPEREC.NUM_ATEN 
          
                     GROUP BY 
                        CABREC.COD_PAIS, 
                        CABREC.CLIENTE ,
						CABREC.Zona , 
                        CABREC.FECINGRESO  )

    </insert>

    <!--  CONSOLIDADO VENTA RETAIL CONSULTORAS POR ZONA Y GERENTE DE ZONA -->
	<insert id="insertRETConsolidadoVentasRetailxZona" parameterClass="java.util.Map">
			INSERT INTO RET_CONSO_VENTA_ZONA
                ( SELECT  v.COD_PAIS,
                        GEN_PKG_GENER.GEN_FN_DEVUELVE_COD_EMP_GZONA(v.cod_zona)  ,
                         v.fec_trans ,
                         v.cod_zona ,
                         SUM(v.val_tota_mnto_fact) ,
                         'N'                         
                  FROM    RET_CONSO_VENTA v
                  WHERE 
                           V.COD_PAIS = #codigoPais#  AND
                           v.ind_envia = 'N'          
                     GROUP BY 
                        v.COD_PAIS, 
                        v.cod_zona ,
                        v.fec_trans
				)
    </insert>

  	<update id="updateRETConsolidadoVentasRetail" parameterClass="java.util.Map" >
    	UPDATE RET_CONSO_VENTA v
    	SET 
          		v.IND_ENVIA = 'S'
    	WHERE
		      	v.COD_PAIS = #codigoPais# AND 
				v.IND_ENVIA = 'N'
  	</update>

<insert id="insertInterfazOCRConsolidadoOCSCabecera" parameterClass="java.util.Map">

		<selectKey resultClass="java.lang.Long" keyProperty="pk">
			select seq_solic_cab.nextval as pk from dual
		</selectKey>			

    	<![CDATA[
	    INSERT INTO INT_SOLIC_CABEC
	    (
		OID_CAB ,
		COD_PAIS,
		CAM_SOLI,
		COD_CLIE,
		NUM_CLIE,
		TIP_SOLI,
		COD_SUBA,
		COD_ACCE,
		TIP_DESP,
		FEC_SOLI,
		STA_PROC
		) 
	    VALUES 
	    (
		#pk# ,
		#codigoPais#,
		#periodo#,
		#codigoCliente#,
		#numeroClientes#,
		#tipoSolicitud#,
		#subAcceso#,
		#accesoFisico#,
		#tipoDespacho#,
		#fecha#,
		#estado#
	    )
	    ]]>
	</insert>
	
	<insert id="insertInterfazOCRConsolidadoOCSDetalle" parameterClass="java.util.Map">

		<selectKey resultClass="java.lang.Long" keyProperty="pk">
			select seq_solic_pos.nextval as pk from dual
		</selectKey>			

    	<![CDATA[
	    INSERT INTO INT_SOLIC_POSIC
	    (
		OID_POSIC ,
		COD_PAIS,
		CAM_SOLI,
		COD_CLIE,
		TIP_POSI,
		COD_PROD,
		UNI_DEMA,
		STA_PROC
		) 
	    VALUES 
	    (
		#pk#,
		#codigoPais#,
		#periodo#,
		#codigoCliente#,
		#tipoPosicion#,
		#codigoProducto#,
		#unidadesDemandadas#,
		' '
	    )
	    ]]>
	</insert>
	
	<select id="getInterfazOCRConsolidadoOCSCabecera" parameterClass="java.util.Map" resultMap="interfazOCREnviarConsolidadoOCSCabeceraResult">
		<![CDATA[
     		SELECT
		        CONSOLIDADO.* ,
           		#numeroClientes# AS NUM_CLIE,
		        #subAcceso# AS COD_SUBA,
		        #accesoFisico# AS COD_ACCE,
		        #tipoDespacho# AS TIP_DESP,
		        TO_CHAR(CONSOLIDADO.FEC_SOLI, 'YYYYMMDD') AS FEC_SOLI,
			    ' ' AS STA_PROC 
     		FROM
	     		( SELECT CAB.COD_PAIS,
		       		CAB.CAM_SOLI,
		       		CAB.COD_CLIE,
		       		CAB.TIP_SOLI ,
           			CAB.FEC_SOLI
  		  		FROM INT_SOLIC_CABEC CAB
  		  		WHERE CAB.STA_PROC <> 'R'	
  		  		GROUP BY CAB.COD_PAIS, CAB.CAM_SOLI, CAB.COD_CLIE, CAB.TIP_SOLI, CAB.FEC_SOLI ) CONSOLIDADO 
		]]>	
	</select>

    <parameterMap id="executeInterfazPRIEnviarCalificacionParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoClasificacion" 		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazPRIEnviarCalificacion" 
   			  parameterMap="executeInterfazPRIEnviarCalificacionParams" >
		{call GEN_PKG_INTER_ARCHI.PRI_PR_PRI_CALIF_CONSU(?,?,?,?,?)}
    </procedure>  

	<delete id="deleteVentaBaseConsultoras">
        TRUNCATE TABLE INT_INC_VENTA_BASE
    </delete>

    <!--  INTERFAZ DUPLA CYZONE - ENVIAR VENTA BASE CONSULTORAS -->
	<insert id="insertVentaBaseConsultoras" parameterClass="java.util.Map">
			INSERT INTO INT_INC_VENTA_BASE

		( SELECT   
			#codigoPais# ,
			concursos.NUM_CONC AS COD_CONCURSO,	
			#codigoPeriodo# ,
			clientes.COD_CLIE AS COD_CLIENTE,
			' ' AS CODIGO_EMPRESA ,
			case
				when VENTA.IMP_MONTO_VENTA is null or VENTA.IMP_MONTO_VENTA = 0 then trunc(concursos.IMP_MONT_MINI) 
				else trunc(venta.IMP_MONTO_VENTA)
			end MONTO_VENTA
		  FROM
			(
				SELECT 
					MAE_CLIEN.OID_CLIE,
					MAE_CLIEN.COD_CLIE 
				FROM
					MAE_CLIEN,
					MAE_CLIEN_TIPO_SUBTI, 
					MAE_TIPO_CLIEN, 
					MAE_SUBTI_CLIEN
				WHERE
					MAE_CLIEN.OID_CLIE = MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE
					AND MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE = MAE_TIPO_CLIEN.OID_TIPO_CLIE				
					AND MAE_CLIEN_TIPO_SUBTI.SBTI_OID_SUBT_CLIE = MAE_SUBTI_CLIEN.OID_SUBT_CLIE
					AND MAE_TIPO_CLIEN.OID_TIPO_CLIE  = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE
		<iterate prepend="AND" property="codigoTipoClientes" open="(" close=")" conjunction="OR">
		   			MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoClientes[]#    
         </iterate>                                  
		<iterate prepend="AND" property="codigoSubTipoClientes" open="(" close=")" conjunction="OR">
				(MAE_TIPO_CLIEN.COD_TIPO_CLIE || '-' || MAE_SUBTI_CLIEN.COD_SUBT_CLIE)  = #codigoSubTipoClientes[]#    
         </iterate>                                  
         ) CLIENTES ,       
	   	   (  
			   SELECT 
					concurso.oid_para_gral ,        
					concurso.NUM_CONC,
          			rango.imp_mont_mini AS imp_mont_mini
				FROM
					INC_CONCU_PARAM_GENER concurso,
          			MAE_ESTAT_CLIEN estcli ,
          			INC_ESTAT_VENTA estventa ,
          			Inc_Monto_Minim_Rango_Consu rango 
				WHERE
           			concurso.oid_para_gral = estventa.copa_oid_para_gral and
           			estventa.esta_oid_esta_clie = estcli.oid_esta_clie and
           			estcli.cod_esta_clie = '02' and
           			estventa.oid_esta_vent = rango.estv_oid_esta_vent and
           			concurso.num_conc = #codigoConcurso#
       		) CONCURSOS ,
			INC_METAS_TIPO_VENTA VENTA
		WHERE
			clientes.OID_CLIE = VENTA.CLIE_OID_CLIE 
			AND VENTA.COPA_OID_PARA_GRAL = concursos.OID_PARA_GRAL )
    </insert>

    <parameterMap id="executeInterfazRETEnviarComisionesParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaInicio"             	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFin"		         	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazRETEnviarComisiones" 
   			  parameterMap="executeInterfazRETEnviarComisionesParams" >
		{call GEN_PKG_INTER_ARCHI.RET_PR_COMIS_VENTA_RETAIL(?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazRETEnviarMatrizCampanyaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCanal"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSubacceso"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="periodoDesde"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="periodoHasta"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazRETEnviarMatrizCampanya" 
   			  parameterMap="executeInterfazRETEnviarMatrizCampanyaParams" >
		{call INT_PKG_RETAI.INT_PR_RET_MATRI_CAMPA(?,?,?,?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazRETEnviarMatrizPuntajesCalypsoParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCanal"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSubacceso"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="periodoDesde"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="periodoHasta"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazRETEnviarMatrizPuntajesCalypso" 
   			  parameterMap="executeInterfazRETEnviarMatrizPuntajesCalypsoParams" >
		{call INT_PKG_RETAI.INT_PR_RET_MATRI_PUNTA_CALYP(?,?,?,?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazREUEnviarMatrizCampanyaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCanal"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoAcceso"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="periodoDesde"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="periodoHasta"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazREUEnviarMatrizCampanya" 
   			  parameterMap="executeInterfazREUEnviarMatrizCampanyaParams" >
		{call INT_PKG_REUTI.INT_PR_REU_ENVIA_MATRI(?,?,?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazOCRRecepcionarConsolidadoOCSCabeceraParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numLoteSTO"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="indOrigen"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
    </parameterMap>

    <procedure id="executeInterfazOCRRecepcionarConsolidadoOCSCabecera" parameterMap="executeInterfazOCRRecepcionarConsolidadoOCSCabeceraParams" >											
		{call GEN_PKG_INTER_ARCHI.OCR_PR_RECEP_CONSO_CABEC(?,?,?,?,?,?,?)}
    </procedure>  

    <procedure id="executeInterfazOCRRecepcionarConsolidadoOCSCabeceraCorporativo"  parameterMap="executeInterfazOCRRecepcionarConsolidadoOCSCabeceraParams" >
		{call INT_PKG_OCCRR.OCR_PR_RECEP_CONSO_CABEC(?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazOCRRecepcionarConsolidadoOCSDetalleParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numLoteSTO"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="indOrigen"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazOCRRecepcionarConsolidadoOCSDetalle" parameterMap="executeInterfazOCRRecepcionarConsolidadoOCSDetalleParams" >											
		{call GEN_PKG_INTER_ARCHI.OCR_PR_RECEP_CONSO_DETAL(?,?,?,?,?,?,?)}												
    </procedure>  
    <procedure id="executeInterfazOCRRecepcionarConsolidadoOCSDetalleCorporativo" parameterMap="executeInterfazOCRRecepcionarConsolidadoOCSDetalleParams" >
		{call INT_PKG_OCCRR.OCR_PR_RECEP_CONSO_DETAL(?,?,?,?,?,?,?)}												
    </procedure>  

    <parameterMap id="executeInterfazOCRProcesarConsolidadoOCSParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

     <parameterMap id="executeInterfazOCRProcesarConsolidadoPostventaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <parameterMap id="executeInterfazOCRProcesarConsolidadoSTOParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numLoteSTO"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <parameterMap id="executeInterfazOCREnviarReclamosPostventaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoDocumento"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="IndicadorSTO"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazOCRProcesarConsolidadoOCS" 
   			  parameterMap="executeInterfazOCRProcesarConsolidadoOCSParams" >
        {call OCR_SOLIC_PEDIDOS.OCR_PR_SOLIC_CONSO_CABEC(?,?) }
    </procedure>

    <parameterMap id="executeInterfazRECProductosReclamadosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaEnvio"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoMovimiento"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="numeroSecuencia"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>									
    </parameterMap>

    <procedure id="executeInterfazRECProductosReclamados" 
   			  parameterMap="executeInterfazRECProductosReclamadosParams" >
		{call INT_PKG_RECLA.INT_PR_REC_ENVIA_PROD(?,?,?,?,?,?,?,?)}												
    </procedure>  

    <parameterMap id="executeInterfazRECProductosReclamadosCabParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazRECProductosReclamadosCab" 
   			  parameterMap="executeInterfazRECProductosReclamadosCabParams" >
		{call INT_PKG_RECLA.INT_PR_REC_CABEC_RECLA(?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazRECProductosReclamadosDetParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazRECProductosReclamadosDet" 
   			  parameterMap="executeInterfazRECProductosReclamadosDetParams" >
		{call INT_PKG_RECLA.INT_PR_REC_OPERA_RECLA(?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazRECProductosReclamadosDetDetParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazRECProductosReclamadosDetDet" 
   			  parameterMap="executeInterfazRECProductosReclamadosDetDetParams" >
		{call INT_PKG_RECLA.INT_PR_REC_LINEA_RECLA(?,?,?,?)}
    </procedure>  


    <parameterMap id="executeInterfazOCREnviarOCSCabeceraParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="periodo"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaFact"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="regiones"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoDespacho"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>
	
    <parameterMap id="executeInterfazOCREnviarOCSDetalleParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="periodo"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaFact"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="regiones"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>


    <procedure id="executeInterfazOCREnviarOCSCabecera" 
   			  parameterMap="executeInterfazOCREnviarOCSCabeceraParams" >
		{call GEN_PKG_INTER_ARCHI.OCR_PR_INTER_SOLIC_CONSO_CABEC(?,?,?,?,?,?,?,?)}
    </procedure>  

    <procedure id="executeInterfazOCREnviarOCSDetalle" 
   			  parameterMap="executeInterfazOCREnviarOCSDetalleParams" >
		{call GEN_PKG_INTER_ARCHI.OCR_PR_INTER_SOLIC_CONSO_DETAL(?,?,?,?,?,?,?)}
    </procedure>  
	
    <parameterMap id="executeInterfazBELEnviarFacturasCabeceraParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoAcceso"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaFacturacion"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazBELEnviarFacturasCabecera" 
   			  parameterMap="executeInterfazBELEnviarFacturasCabeceraParams" >
		{call INT_PKG_BELCE.INT_PR_BEL_FACTU_CABEC(?,?,?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazBELEnviarFacturasDetalleParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoAcceso"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaFacturacion"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazBELEnviarFacturasDetalle" 
   			  parameterMap="executeInterfazBELEnviarFacturasDetalleParams" >
		{call INT_PKG_BELCE.INT_PR_BEL_FACTU_DETAL(?,?,?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazBELEnviarDireccionClientesParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoCliente"	         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaInicioUltimoProceso"	 jdbcType="TIMESTAMP" javaType="java.sql.Timestamp"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazBELEnviarDireccionClientes" 
   			  parameterMap="executeInterfazBELEnviarDireccionClientesParams" >
		{call INT_PKG_BELCE.INT_PR_BEL_DIREC_CLIEN(?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazBELEnviarPorcentajesReferenciaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoAcceso"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaFacturacion"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazBELEnviarPorcentajesReferencia" 
   			  parameterMap="executeInterfazBELEnviarPorcentajesReferenciaParams" >
		{call INT_PKG_BELCE.INT_PR_BEL_PORCE_REFER(?,?,?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazBELEnviarUnidadesAtendidasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoAcceso"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaFacturacion"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazBELEnviarUnidadesAtendidas" 
   			  parameterMap="executeInterfazBELEnviarUnidadesAtendidasParams" >
		{call INT_PKG_BELCE.INT_PR_BEL_UNIDA_ATEND(?,?,?,?,?,?,?,?,?)}
    </procedure>  

    <parameterMap id="executeInterfazBELEnviarUbicacionesGeograficasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaInicioUltimoProceso"	 jdbcType="TIMESTAMP" javaType="java.sql.Timestamp"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazBELEnviarUbicacionesGeograficas" 
   			  parameterMap="executeInterfazBELEnviarUbicacionesGeograficasParams" >
		{call INT_PKG_BELCE.INT_PR_BEL_UBICA_GEOGR(?, ?, ?, ?, ?)}
    </procedure>  

	
	<select id="getInterfazOCRConsolidadoOCSDetalle" parameterClass="java.util.Map" resultMap="interfazOCREnviarConsolidadoOCSDetalleResult">
		<![CDATA[
		SELECT              
      		CONSOLIDADO.* ,    
      		#tipoPosicion# AS TIP_POSI,
		  	' ' AS STA_PROC             
   		FROM          
		   ( SELECT   POS.COD_PAIS,
		         	  POS.CAM_SOLI,
		         	  POS.COD_CLIE,
             		  POS.COD_PROD,
		              SUM (POS.UNI_DEMA) AS UNI_DEMANDADAS 
		    FROM INT_SOLIC_POSIC POS
        	WHERE POS.COD_PAIS || POS.CAM_SOLI || POS.COD_CLIE NOT IN (
                          SELECT CAB.COD_PAIS || CAB.CAM_SOLI || CAB.COD_CLIE 
                          FROM INT_SOLIC_CABEC CAB 
                          WHERE CAB.STA_PROC = 'R' )        
        	GROUP BY POS.COD_PAIS, POS.CAM_SOLI, POS.COD_CLIE , POS.COD_PROD ) CONSOLIDADO
		]]>	
	</select>
	
	<select id="getRecaudosBancarios" parameterClass="java.util.Map" resultMap="recaudosBancariosResult">
		<![CDATA[
		SELECT 
			CB.NUM_LOTE_EXTE, 
			D.CON_TRAN,
			D.NUM_FABO,
			D.FEC_PAGO,
			D.IMP_RECA_GENE,
			CB.COD_CCBA,
			D.NUM_CUPO,
			D.COD_CONS,
			D.DIG_CHEQ,
			D.OFI_RECA,
			D.NOM_OFIC,
			D.TIP_TRAN,
			D.NUM_DOCU,
			D.VAL_HORA,
			D.USU_PROC,
			D.FEC_PROC,
			D.HOR_PROC
		FROM  PER_MOVIM_BANCA_CABEC CB, PER_MOVIM_BANCA_DETAL D
		WHERE CB.PAIS_COD_PAIS = #codigoPais#
			AND CB.TIOR_TIPO_ORIG_DATO = #codigoTipoOrigenDatos#
			AND CB.NUM_LOTE_INTE = #numeroLoteInterno#
			AND D.PAIS_COD_PAIS = CB.PAIS_COD_PAIS
			AND D.TIOR_TIPO_ORIG_DATO = CB.TIOR_TIPO_ORIG_DATO
			AND D.MOCA_NUM_LOTE_INTE = CB.NUM_LOTE_INTE
		]]>	
	</select>
	
	<select id="getInterfazRECProductosReclamadosSubAccesos" parameterClass="java.util.Map" resultMap="baseResult">
		<![CDATA[
		SELECT  S.COD_SBAC AS CODIGO, 
		        VAL_I18N AS DESCRIPCION
		FROM    GEN_I18N_SICC_COMUN P, 
		        SEG_SUBAC S, 
		        SEG_ACCES A, 
		        SEG_IDIOM I 
		WHERE      A.OID_ACCE = S.ACCE_OID_ACCE 
		           AND P.VAL_OID = S.OID_SBAC
		           AND P.IDIO_OID_IDIO = I.OID_IDIO
		           AND P.ATTR_ENTI = 'SEG_SUBAC'
		           AND I.COD_ISO_IDIO = 'es'
		           AND ( (A.COD_ACCE = 'GZ') OR
		                 (A.Cod_Acce = 'BL')                   
		               )
		ORDER BY 2 asc
		]]>	
	</select>	

	<select id="getInterfazDATEnviarControlCierresZonasRegiones" parameterClass="java.util.Map" resultMap="interfazDATEnviarControlCierresResult">
		SELECT DISTINCT
			SEG_PERIO_CORPO.COD_PERI AS CODPERIODO,
			ZZ.COD_ZONA AS CODZONA, 
			ZR.COD_REGI AS CODREGION,			
			#flagImpresion# AS FLAGIMP,
			#flagStatusFacturacion# AS FLAGSTATUSFAC,
			DECODE ( FAC_CONTR_CIERR.VAL_RESU_PROC, 'OK', 0, 1 ) AS RESULTADO
        	          			
		FROM SEG_PAIS, 
			SEG_MARCA, 
			SEG_CANAL, 
			CRA_PERIO, 
			ZON_ZONA, 
			ZON_REGIO, 
			ZON_ZONA ZZ, 
			ZON_REGIO ZR,		
			FAC_CONTR_CIERR, 
			FAC_TIPOS_CIERR,
			SEG_PERIO_CORPO 
		WHERE (( CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI ) 
			AND ( CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC ) 
			AND ( CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA ) 
			AND ( FAC_CONTR_CIERR.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS ) 
			AND ( FAC_CONTR_CIERR.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA (+) ) 
			AND (FAC_CONTR_CIERR.ZORG_OID_REGI = ZON_REGIO.OID_REGI (+) ) 
			AND (FAC_CONTR_CIERR.PERD_OID_PERI = CRA_PERIO.OID_PERI ) 
			AND (FAC_CONTR_CIERR.TCIE_OID_TIPO_CIER = FAC_TIPOS_CIERR.OID_TIPO_CIER) 
			<isEqual compareValue="Z" property="codigoTipoCierre" >
				AND (ZZ.ZORG_OID_REGI = ZR.OID_REGI )
				AND (ZZ.OID_ZONA = ZON_ZONA.OID_ZONA ) 
			</isEqual>			
			<isEqual  compareValue="R" property="codigoTipoCierre">			
				AND (ZZ.ZORG_OID_REGI = ZR.OID_REGI )			
				AND (ZR.OID_REGI = ZON_REGIO.OID_REGI) 
			</isEqual>						
			AND (SEG_PAIS.COD_PAIS = #codigoPais# ) 
			AND (SEG_MARCA.COD_MARC = #codigoMarca# ) 
			AND (SEG_CANAL.COD_CANA = #codigoCanal# ) 
			AND (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo# )
			AND (FAC_TIPOS_CIERR.COD_TIPO_CIER = #codigoTipoCierre# )
           	<isNotEmpty property="codigoZona">  
				<iterate prepend="AND" property="codigoZona" open="(" close=")" conjunction="OR">
				   ZZ.COD_ZONA =  #codigoZona[]#
				</iterate>  
            </isNotEmpty> 
           	<isNotEmpty property="codigoRegion"> 
				<iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
				   ZR.COD_REGI =  #codigoRegion[]#
				</iterate> 
             </isNotEmpty> 
             )
          ORDER BY RESULTADO DESC, CODREGION ASC, CODZONA ASC
		<![CDATA[

		]]>	
	</select>	


	<select id="getInterfazDATEnviarControlCierresPeriodos" parameterClass="java.util.Map" resultMap="interfazDATEnviarControlCierresResult">
		SELECT DISTINCT
			SEG_PERIO_CORPO.COD_PERI AS CODPERIODO,
			'' AS CODZONA, 
			'' AS CODREGION,			
			#flagImpresion# AS FLAGIMP,
			#flagStatusFacturacion# AS FLAGSTATUSFAC,
			DECODE ( FAC_CONTR_CIERR.VAL_RESU_PROC, 'OK', 0, 1 ) AS RESULTADO
        	          			
		FROM SEG_PAIS, 
			SEG_MARCA, 
			SEG_CANAL, 
			CRA_PERIO, 
			FAC_CONTR_CIERR, 
			FAC_TIPOS_CIERR,
			SEG_PERIO_CORPO 
		WHERE (( CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI ) 
			AND ( CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC ) 
			AND ( CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA ) 
			AND ( FAC_CONTR_CIERR.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS ) 
			AND (FAC_CONTR_CIERR.PERD_OID_PERI = CRA_PERIO.OID_PERI ) 
			AND (FAC_CONTR_CIERR.TCIE_OID_TIPO_CIER = FAC_TIPOS_CIERR.OID_TIPO_CIER)
			AND (SEG_PAIS.COD_PAIS = #codigoPais# ) 
			AND (SEG_MARCA.COD_MARC = #codigoMarca# ) 
			AND (SEG_CANAL.COD_CANA = #codigoCanal# ) 
			AND (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo# )
			AND (FAC_TIPOS_CIERR.COD_TIPO_CIER = #codigoTipoCierre# )
             )
          ORDER BY RESULTADO DESC
	</select>	

	<select id="getInterfazDATEnviarControlCierresPeriodosSalida" parameterClass="java.util.Map" resultMap="interfazDATEnviarControlCierresResult">
		SELECT 	#codigoPeriodo# AS CODPERIODO,
				ZON_ZONA.COD_ZONA AS CODZONA,
				ZON_REGIO.COD_REGI AS CODREGION, 
				#flagImpresion# AS FLAGIMP,
				#flagStatusFacturacion# AS FLAGSTATUSFAC,
				'OK' AS RESULTADO				
			FROM ZON_REGIO, 
				ZON_ZONA,
				SEG_PAIS, 
				SEG_MARCA,
				SEG_CANAL,
				CRA_PERIO,
				SEG_PERIO_CORPO
			WHERE ( (CRA_PERIO.OID_PERI = ZON_REGIO.PERD_OID_PERI_INIC)
		          AND (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
		          AND (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)
		          AND (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
		          AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
		          AND (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
		          AND (SEG_PERIO_CORPO.COD_PERI >= #codigoPeriodo#)
		          AND (SEG_CANAL.COD_CANA = #codigoCanal# )
		          AND (SEG_MARCA.COD_MARC = #codigoMarca# )
		          AND (SEG_PAIS.COD_PAIS = #codigoPais#)
		          AND (ZON_REGIO.IND_ACTI = 1)
		          AND (ZON_REGIO.IND_BORR = 0)
		          AND (ZON_ZONA.IND_ACTI = 1)
		          AND (ZON_ZONA.IND_BORR = 0)
	         )
			ORDER BY ZON_REGIO.COD_REGI ASC,
			         ZON_ZONA.COD_ZONA ASC
		
	</select>	

	<select id="getInterfazDATEnviarControlCierresErrorZonasRegiones" parameterClass="java.util.Map" resultMap="interfazDATEnviarControlCierresErrorResult">
		SELECT 	COD_ZONA AS CODZONA, 
				COD_REGI AS CODREGION,				
				#codigoPeriodo# AS CODPERIODO,				
				VAL_RESU_PROC AS RESULTADO,
				TO_CHAR(FEC_CIER, 'YYYYMMDD') AS FECHACIERRE,
				VAL_SECU_CIER AS SECCIERRE 
		
		FROM  	ZON_ZONA , ZON_REGIO, 
				FAC_CONTR_CIERR, FAC_TIPOS_CIERR
		WHERE (( FAC_CONTR_CIERR.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA (+)  )
				AND (FAC_CONTR_CIERR.ZORG_OID_REGI = ZON_REGIO.OID_REGI (+) )
				AND (FAC_CONTR_CIERR.TCIE_OID_TIPO_CIER = FAC_TIPOS_CIERR.OID_TIPO_CIER) 		 
		 		AND (FAC_TIPOS_CIERR.COD_TIPO_CIER = #codigoTipoCierre# )
		 		<![CDATA[  
					AND (VAL_RESU_PROC <> 'OK')
				]]>	
				<isEqual  compareValue="Z" property="codigoTipoCierre">			
		           	<isNotEmpty property="listaCodigosError">  
						<iterate prepend="AND" property="listaCodigosError" open="(" close=")" conjunction="OR">
						   ZON_ZONA.COD_ZONA =  #listaCodigosError[]#
						</iterate>  
		            </isNotEmpty> 
				</isEqual>						
				<isEqual  compareValue="R" property="codigoTipoCierre">					
		           	<isNotEmpty property="listaCodigosError">  
						<iterate prepend="AND" property="listaCodigosError" open="(" close=")" conjunction="OR">
						   ZON_REGIO.COD_REGI =  #listaCodigosError[]#
						</iterate>  
		            </isNotEmpty> 
				</isEqual>						
				) 
	</select>	

	<select id="getInterfazDATEnviarControlCierresErrorCierrePeriodo" parameterClass="java.util.Map" resultMap="interfazDATEnviarControlCierresErrorResult">
		SELECT 	'' AS CODZONA, 
				'' AS CODREGION,				
				#codigoPeriodo# AS CODPERIODO,
				VAL_RESU_PROC AS RESULTADO,
				TO_CHAR(FEC_CIER, 'YYYYMMDD') AS FECHACIERRE,
				VAL_SECU_CIER AS SECCIERRE 
		 FROM    FAC_CONTR_CIERR, 
		 		FAC_TIPOS_CIERR,   
		 		CRA_PERIO, 
		 		SEG_PERIO_CORPO, 
		 		SEG_MARCA, 
		 		SEG_PAIS, 
		 		SEG_CANAL
		 WHERE ((FAC_CONTR_CIERR.TCIE_OID_TIPO_CIER = FAC_TIPOS_CIERR.OID_TIPO_CIER)        
				AND (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI )        
				AND (CRA_PERIO.OID_PERI = FAC_CONTR_CIERR.PERD_OID_PERI)        
				AND (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC )        
				AND (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA )        
				AND (FAC_TIPOS_CIERR.COD_TIPO_CIER = #codigoTipoCierre#  )
		 		<![CDATA[  
				AND (VAL_RESU_PROC <> 'OK')           
				]]>	
				AND ( SEG_PAIS.COD_PAIS = #codigoPais# )
				AND ( SEG_MARCA.COD_MARC = #codigoMarca# )  
				AND ( SEG_CANAL.COD_CANA = #codigoCanal# )
				AND ( SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo# )
				) 
	</select>	

    <parameterMap id="executeInterfazRETEnviarSolicitudesMonetariasCabeceraParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLoteSolicitud"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoOrigenDatos"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoAccesoFisico"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoDespacho"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>
	
    <parameterMap id="executeInterfazRETEnviarSolicitudesMonetariasPosicionParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLoteSolicitud"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoOrigenDatos"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazRETEnviarSolicitudesMonetariasCabecera" 
   			  parameterMap="executeInterfazRETEnviarSolicitudesMonetariasCabeceraParams" >
		{call INT_PKG_PERCE.INT_PR_PER_SOLIC_MONET_CABEC(?,?,?,?,?,?,?,?)}
    </procedure>  
  		
	<procedure id="executeInterfazRETEnviarSolicitudesMonetariasPosicion"
			  parameterMap="executeInterfazRETEnviarSolicitudesMonetariasPosicionParams" >
		{call INT_PKG_PERCE.INT_PR_PER_SOLIC_MONET_POSIC(?,?,?,?,?,?)}
	</procedure>
   

    <parameterMap id="executeInterfazPEREnviarArchivoPDTParams" class="map" >															
		<parameter property="codigoPais" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSistema"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="nombreArchivo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>    
		<parameter property="numeroLote"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="fechaDesde"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>    
		<parameter property="fechaHasta"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>																		
  														
	<procedure id="executeInterfazPEREnviarArchivoPDT"													
			  parameterMap="executeInterfazPEREnviarArchivoPDTParams" >											
		{call INT_PKG_PERCE.INT_PR_PER_ARCHI_PDT(?,?,?,?,?,?,?,?)}												
	</procedure>
														
    <parameterMap id="executeInterfazMYEVentaDirectaCabeceraParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaDesde"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaHasta"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	
    <parameterMap id="executeInterfazMYEVentaDirectaDetalleParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaDesde"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaHasta"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazMYEEnviarVentaDirectaCabecera" 
   			  parameterMap="executeInterfazMYEVentaDirectaCabeceraParams" >
		{call GEN_PKG_INTER_ARCHI.MYE_PR_INTER_VENTA_DIREC_CABEC(?,?,?,?,?,?)}
    </procedure>  
  		
	<procedure id="executeInterfazMYEEnviarVentaDirectaDetalle"
			  parameterMap="executeInterfazMYEVentaDirectaDetalleParams" >
		{call GEN_PKG_INTER_ARCHI.MYE_PR_INTER_VENTA_DIREC_DETAL(?,?,?,?,?,?)}
	</procedure>

    <!--  INTERFAZ PRODUCTOS RECLAMADOS - Actualizar Unidades Devueltas en SICC -->
	<update id="executeProcesoRECActualizaUnidadesDevueltas" parameterClass="java.util.Map">
	
				update rec_linea_opera_recla linea 
				set linea.num_unid_devu = linea.num_unid_recl
				where exists (select null 
							  from int_ret_linea_opera_recla inter 
                                where inter.num_line =  linea.oid_line_oper_recl
                                  AND inter.num_secu_usua = #numeroSecuencia#)														
                              
    </update>

    <!-- OBTIENE LOS PRODUCTOS RECLAMADOS SEGUN LOS CRITERIOS  -->
  <select id="getRECProductosList" parameterClass="java.util.Map" resultMap="productReclamResult">
        SELECT  	 #numeroLote#         NUMLOTE,  
					 #codigoPais#	CODPAIS ,
                     CABREC.OID_CABE_RECL RECCAB, OPEREC.OID_OPER_RECL RECOPER, LINREC.OID_LINE_OPER_RECL LIN, 
                     TO_CHAR(CABREC.FEC_INGR, 'DD/MM/YYYY') FECREC, 
                     cabrec.tiin_oid_tipo_ingr AS TIPING ,
  		   			<isNotEmpty property="subacGZ">
                     INT_PKG_RECLA.GEN_FN_DESC_GENER(PEDCAB.Sbac_Oid_Sbac,'SEG_SUBAC' ) AS SUBAC,
              		</isNotEmpty>	 
  		   			<isNotEmpty property="subacList">
                     	INT_PKG_RECLA.GEN_FN_DESC_GENER(INT_PKG_RECLA.GEN_FN_DEV_ID_SUBAC(cabrec.cod_usua_ingr),'SEG_SUBAC' ) AS SUBAC,
              		</isNotEmpty>	 
                     INT_PKG_RECLA.GEN_FN_REC_COD_OPER(operec.tiop_oid_tipo_oper) AS CODOPER,
                     INT_PKG_RECLA.GEN_FN_CODSAP_PROD(LINREC.PROD_OID_PROD) AS CODSAP ,
                     INT_PKG_RECLA.GEN_FN_DESC_PROD(LINREC.PROD_OID_PROD) AS DESCPROD ,
                     INT_PKG_RECLA.GEN_FN_CAMPANHA(pedcab.perd_oid_peri) AS CAMPREF ,
                     INT_PKG_RECLA.GEN_FN_CAMPANHA(pedcab.perd_oid_peri) AS CODPER , 
                     INT_PKG_RECLA.GEN_FN_TIPO_PERIO(pedcab.perd_oid_peri) AS TIPOPER ,
                     INT_PKG_RECLA.GEN_FN_SUB_ACCESO(PEDCAB.Sbac_Oid_Sbac) AS CODSUBAC ,
                     INT_PKG_RECLA.GEN_FN_ACCESO(pedcab.perd_oid_peri) AS CODACC , 
                     INT_PKG_RECLA.GEN_FN_CANAL(pedcab.perd_oid_peri) AS CODCANAL ,  
                     INT_PKG_RECLA.GEN_FN_MARCA_PROD(LINREC.PROD_OID_PROD) AS MARCA ,
                     INT_PKG_RECLA.GEN_FN_NEGO_PROD(LINREC.PROD_OID_PROD) AS NEGOCIO ,   
                     INT_PKG_RECLA.GEN_FN_COD_CLIE(CABREC.CLIE_OID_CLIE) AS CLIENTE ,                            
                     INT_PKG_RECLA.GEN_FN_COD_VENTA(LINREC.Mafa_Oid_Matr_Fact) AS CODVENT ,
                     INT_PKG_RECLA.GEN_FN_COD_TIPO_OFERT(LINREC.TOFE_OID_TIPO_OFER) AS TIPOFER,
                     INT_PKG_RECLA.GEN_FN_REC_TIPO_MOVI_ALMAC(operec.tiop_oid_tipo_oper) AS TIPOMOV ,                          
                     INT_PKG_RECLA.GEN_FN_REC_COD_ALMAC(operec.tiop_oid_tipo_oper) AS ALMACORIG ,
                     INT_PKG_RECLA.GEN_FN_REC_TIPO_OPER(operec.tiop_oid_tipo_oper ) AS TIPOOPER,
                     INT_PKG_RECLA.GEN_FN_DES_REG(CABREC.CLIE_OID_CLIE, #codigoPais#) REG ,                     
        			       PEDCAB.VAL_NUME_SOLI DOCREF ,             
			               LINREC.PROD_OID_PROD, 
			               LINREC.NUM_UNID_RECL AS UNIDREC, 
                     LINREC.NUM_UNID_RECL AS UNIDADEVOLVREC ,
			               LINREC.NUM_UNID_DEVU AS UNIDDEVU ,
	                   (LINREC.NUM_UNID_RECL - LINREC.NUM_UNID_DEVU ) AS UNIDADEVOLV    ,
                     0               AS  PRECIONETO ,
                     0               AS  PRECIOCONT ,
                     ''                   NUMDOC ,
                     ''                   ALMACDEST ,
                     'I'                   INDICADOR ,
		                 #fechaEnvio#		  FECENVIO 			                     
                     
				FROM 	REC_OPERA_RECLA OPEREC, 
                      	REC_CABEC_RECLA CABREC, REC_LINEA_OPERA_RECLA LINREC,                                    
			            PED_SOLIC_CABEC PEDCAB                                                                                                   
				WHERE 
			            LINREC.OPRE_OID_OPER_RECL = OPEREC.OID_OPER_RECL                  
              					<iterate prepend="AND" property="codigoLineaList" open="(" close=")" conjunction="OR">
              							LINREC.OID_LINE_OPER_RECL=#codigoLineaList[]#
              					</iterate>                                   
                       AND 
			                 OPEREC.CARE_OID_CABE_RECL = CABREC.OID_CABE_RECL AND                                      
                       cabrec.SOCA_OID_SOLI_CABE = PEDCAB.OID_SOLI_CABE AND
			                 LINREC.NUM_UNID_RECL > LINREC.NUM_UNID_DEVU 
  		   			<isNotEmpty prepend="AND" property="errorSacado">
  		   				<isNotEmpty property="subacGZ">
  		      				 LINREC.SOPO_OID_SOLI_POSI IS NOT NULL
              		</isNotEmpty>	 
  		   				<isNotEmpty property="subacList">
							  LINREC.SOPO_OID_SOLI_POSI IS NULL AND
  		      				 LINREC.VAL_PREC  = 0
              		</isNotEmpty>	 
              		</isNotEmpty>	 
  		   			<isNotEmpty prepend="AND" property="subacGZ">
							cabrec.num_aten_inte is null
              		</isNotEmpty>	 
  		   			<isNotEmpty property="subacList">
					  <iterate prepend="AND" property="subacList" open="(" close=")" conjunction="OR">
                         cabrec.cod_usua_ingr = #subacList[]#
                      </iterate>    
					</isNotEmpty>

			           and exists (select ESTOP.OID_ESTA_OPER from REC_ESTAD_OPERA ESTOP where ESTOP.OID_ESTA_OPER = OPEREC.ESOP_OID_ESTA_OPER AND ESTOP.COD_ESTA_OPER = 'F')
			           and exists (select ESTREC.OID_ESTA_RECL from REC_ESTAD_RECLA ESTREC where ESTREC.OID_ESTA_RECL = CABREC.ESRE_OID_ESTA_RECL AND ESTREC.COD_ESTA = 'F')
			           and exists (select tmo.oid_tipo_movi from REC_TIPO_MOVIM TMO where tmo.oid_tipo_movi = linrec.timo_oid_tipo_movi and tmo.cod_tipo_movi = 'D' )
			           and exists (select TING.COD_TIPO_INGR from REC_TIPO_INGRE TING where ting.oid_tipo_ingr = cabrec.tiin_oid_tipo_ingr 
                          		   			<isNotEmpty prepend="AND" property="tipoIngreso">
                          		      				 TING.COD_TIPO_INGR = #tipoIngreso#
                                      </isNotEmpty>	 )
			<!-- 
                 and exists (select sb.oid_sbac from seg_subac sb where sb.oid_sbac = pedcab.sbac_oid_sbac 
                          					<iterate prepend="AND" property="subacList" open="(" close=")" conjunction="OR">
                          					   sb.COD_SBAC=#subacList[]#
                          					</iterate>    )                               
			-->	
                 and exists (select regi.oid_regi from zon_regio regi where regi.oid_regi = INT_PKG_RECLA.GEN_FN_OID_REGIO_BYZON_TERRI(CABREC.ZTAD_OID_TERR_ADMI, #codigoPais#)  
                      					<iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
                      							regi.COD_REGI=#regionList[]#
                      					</iterate>   )
                and exists ( select top.oid_tipo_oper from REC_OPERA OP, REC_TIPOS_OPERA TOP 
                                    where TOP.OID_TIPO_OPER = operec.tiop_oid_tipo_oper and
                                          OP.OID_OPER = TOP.Rope_Oid_Oper 
                      					<iterate prepend="AND" property="operacionList" open="(" close=")" conjunction="OR">
                      							OP.COD_OPER = #operacionList[]#
                      					</iterate>   )
							  AND CABREC.FEC_INGR >= TO_DATE(#fechaInicio#,'DD/MM/YYYY')
						<![CDATA[  
					      AND CABREC.FEC_INGR <= TO_DATE(#fechaFin#,'DD/MM/YYYY')
						 ]]>	

  </select>

    <!-- OBTIENE LOS PRODUCTOS RECLAMADOS SAM7 SEGUN LOS CRITERIOS  -->
  <select id="getRECProductosSAM7List" parameterClass="java.util.Map" resultMap="productReclamSAM7Result">
        SELECT       #numeroLote#         NUMLOTE,  
					 #codigoPais#	CODPAIS ,
                     INT_PKG_RECLA.GEN_FN_CODSAP_PROD(LINREC.PROD_OID_PROD) AS CODSAP ,
                     TO_CHAR(CABREC.FEC_INGR, 'YYYYMMDD') FECREC,                                
					 INT_PKG_RECLA.GEN_FN_REC_COD_OPER(operec.tiop_oid_tipo_oper) AS CODOPER, 
					 INT_PKG_RECLA.GEN_FN_CAMPANHA(pedcab.perd_oid_peri) AS CODPER , 
					 INT_PKG_RECLA.GEN_FN_TIPO_PERIO(pedcab.perd_oid_peri) AS TIPOPER ,
					 INT_PKG_RECLA.GEN_FN_SUB_ACCESO(PEDCAB.Sbac_Oid_Sbac) AS CODSUBAC ,
					 INT_PKG_RECLA.GEN_FN_ACCESO(pedcab.perd_oid_peri) AS CODACC , 
					 INT_PKG_RECLA.GEN_FN_CANAL(pedcab.perd_oid_peri) AS CODCANAL ,  
					 INT_PKG_RECLA.GEN_FN_MARCA_PROD(LINREC.PROD_OID_PROD) AS MARCA ,
					 INT_PKG_RECLA.GEN_FN_NEGO_PROD(LINREC.PROD_OID_PROD) AS NEGOCIO ,
					 INT_PKG_RECLA.GEN_FN_COD_TIPO_OFERT(LINREC.TOFE_OID_TIPO_OFER) AS TIPOFER,
		  <!--       OCR_SOLIC_PEDIDOS.GEN_FN_REC_TIPO_MOVI_ALMAC(operec.tiop_oid_tipo_oper) AS TIPOMOV , -->
					 #tipoMovimiento# 	AS TIPOMOV , 
					 INT_PKG_RECLA.GEN_FN_REC_COD_ALMAC(operec.tiop_oid_tipo_oper) AS ALMACORIG ,
					 INT_PKG_RECLA.GEN_FN_REC_TIPO_OPER(operec.tiop_oid_tipo_oper ) AS TIPOOPER,
                     SUM(LINREC.NUM_UNID_RECL - LINREC.NUM_UNID_DEVU )  UNIDADEVOLV ,
                     SUM(LINREC.NUM_UNID_RECL)  UNIDREC ,
                     SUM(LINREC.NUM_UNID_RECL)  UNIDADEVOLVREC ,
                     0               AS  PRECIONETO ,
                     0               AS  PRECIOCONT ,
                     ''                   NUMDOC ,
                     ''                   ALMACDEST ,
                     'I'                   INDICADOR ,
		                 #fechaEnvio#		  FECENVIO 			                     
           FROM REC_OPERA_RECLA OPEREC, 
                      REC_CABEC_RECLA CABREC, REC_LINEA_OPERA_RECLA LINREC,                                    
	                PED_SOLIC_CABEC PEDCAB                                                                                                   
           WHERE 
			                 LINREC.OPRE_OID_OPER_RECL = OPEREC.OID_OPER_RECL   
          					<iterate prepend="AND" property="codigoLineaList" open="(" close=")" conjunction="OR">
          							LINREC.OID_LINE_OPER_RECL=#codigoLineaList[]#
          					</iterate> 	
							AND OPEREC.CARE_OID_CABE_RECL = CABREC.OID_CABE_RECL 
							AND cabrec.SOCA_OID_SOLI_CABE = PEDCAB.OID_SOLI_CABE 
           group by 
					 INT_PKG_RECLA.GEN_FN_REC_COD_OPER(operec.tiop_oid_tipo_oper),
					 INT_PKG_RECLA.GEN_FN_CODSAP_PROD(LINREC.PROD_OID_PROD)  ,
					 INT_PKG_RECLA.GEN_FN_CAMPANHA(pedcab.perd_oid_peri) , 
					 INT_PKG_RECLA.GEN_FN_TIPO_PERIO(pedcab.perd_oid_peri),
					 INT_PKG_RECLA.GEN_FN_SUB_ACCESO(PEDCAB.Sbac_Oid_Sbac),
					 INT_PKG_RECLA.GEN_FN_ACCESO(pedcab.perd_oid_peri), 
					 INT_PKG_RECLA.GEN_FN_CANAL(pedcab.perd_oid_peri) ,  
					 INT_PKG_RECLA.GEN_FN_MARCA_PROD(LINREC.PROD_OID_PROD),
					 INT_PKG_RECLA.GEN_FN_NEGO_PROD(LINREC.PROD_OID_PROD)  ,     
					 INT_PKG_RECLA.GEN_FN_REC_TIPO_MOVI_ALMAC(operec.tiop_oid_tipo_oper)  ,                          
					 INT_PKG_RECLA.GEN_FN_REC_COD_ALMAC(operec.tiop_oid_tipo_oper)  ,
					 INT_PKG_RECLA.GEN_FN_REC_TIPO_OPER(operec.tiop_oid_tipo_oper ),
                     TO_CHAR(CABREC.FEC_INGR, 'YYYYMMDD') ,                                
					 INT_PKG_RECLA.GEN_FN_COD_TIPO_OFERT(LINREC.TOFE_OID_TIPO_OFER) 

  </select>

    <!-- OBTIENE LOS PRODUCTOS RECLAMADOS XLOTE SEGUN LOS CRITERIOS  -->
  <select id="getRECProductosListxLote" parameterClass="java.util.Map" resultMap="productReclamResultxLote">
        SELECT   TO_CHAR(CABREC.FEC_INGR, 'DD/MM/YYYY') AS FECREC,                                														
       INT_PKG_RECLA.GEN_FN_REC_COD_OPER(OPEREC.TIOP_OID_TIPO_OPER) AS CODOPER,
  		   			<isNotEmpty property="subacGZ">
                     INT_PKG_RECLA.GEN_FN_DESC_GENER(PEDCAB.Sbac_Oid_Sbac,'SEG_SUBAC' ) AS DESCSUBAC,   
              		</isNotEmpty>	 
  		   			<isNotEmpty property="subacList">
         INT_PKG_RECLA.GEN_FN_DESC_GENER(INT_PKG_RECLA.GEN_FN_DEV_ID_SUBAC(CABREC.COD_USUA_INGR),'SEG_SUBAC' ) AS DESCSUBAC,
              		</isNotEmpty>	 
	   REGION.DES_REGI AS DESCREG,
	   ZONA.DES_ZONA   AS DESCZON,
                     SUM(LINREC.NUM_UNID_RECL - LINREC.NUM_UNID_DEVU )  AS UNIDADEVOLV ,
                     SUM(LINREC.NUM_UNID_RECL)  AS UNIDREC ,
                     SUM(LINREC.NUM_UNID_RECL)  AS UNIDADEVOLVREC ,     
       COUNT(DISTINCT PEDCAB.OID_SOLI_CABE) AS TOTALGUIAS
           FROM REC_OPERA_RECLA OPEREC, 
                 REC_CABEC_RECLA CABREC, 
                 REC_LINEA_OPERA_RECLA LINREC,                                    														
	             PED_SOLIC_CABEC PEDCAB, 
	     ZON_REGIO REGION,
	     ZON_ZONA ZONA
 WHERE LINREC.OID_LINE_OPER_RECL IN (SELECT linrec.oid_line_oper_recl
																			 FROM rec_opera_recla operec,
                      											rec_cabec_recla cabrec,
                      											rec_linea_opera_recla linrec,
			            													ped_solic_cabec pedcab
																			WHERE linrec.opre_oid_oper_recl = operec.oid_oper_recl
																			  AND operec.care_oid_cabe_recl = cabrec.oid_cabe_recl
																			  AND cabrec.SOCA_OID_SOLI_CABE = pedcab.oid_soli_cabe
																			  AND linrec.num_unid_recl > linrec.num_unid_devu 
  		   			<isNotEmpty prepend="AND" property="errorSacado">
																				    linrec.sopo_oid_soli_posi is null
																				AND linrec.val_prec = 0
              		</isNotEmpty>	 
  		   			<isNotEmpty prepend="AND" property="subacGZ">
							cabrec.num_aten_inte is null
              		</isNotEmpty>	 
  		   			<isNotEmpty property="subacList">
					  <iterate prepend="AND" property="subacList" open="(" close=")" conjunction="OR">
                         cabrec.cod_usua_ingr = #subacList[]#
                      </iterate>    
					</isNotEmpty>
  		   			<isEmpty prepend="AND" property="subacGZ">
			          	 												  EXISTS (SELECT estop.oid_esta_oper
			          	 												            FROM rec_estad_opera estop
			          	 												           WHERE estop.oid_esta_oper = operec.esop_oid_esta_oper
			          	 												             AND estop.cod_esta_oper = 'F')
			             										  AND EXISTS (SELECT estrec.oid_esta_recl
			             												            FROM rec_estad_recla estrec
			             												           WHERE estrec.oid_esta_recl = cabrec.esre_oid_esta_recl
			             												             AND estrec.cod_esta = 'F')
					</isEmpty>
  		   			<isNotEmpty prepend="AND" property="subacGZ">
					   	 														  EXISTS (SELECT null
					   	 														            FROM rec_solic_opera solope
																							  		 WHERE solope.opre_oid_oper_recl = operec.oid_oper_recl
																								  	   AND exists (SELECT null
																									                   FROM ped_solic_cabec fac
																			                              WHERE fac.oid_soli_cabe = solope.soca_oid_soli_cabe
																			                                AND fac.grpr_oid_grup_proc = 5 )
																			              )
					</isNotEmpty>
			           												AND EXISTS (SELECT tmo.oid_tipo_movi
			           												              FROM rec_tipo_movim tmo
			           												             WHERE tmo.oid_tipo_movi = linrec.timo_oid_tipo_movi
			           												               AND tmo.cod_tipo_movi = 'D' )
			                                  AND EXISTS (SELECT ting.cod_tipo_ingr
			                                                FROM rec_tipo_ingre ting
			                                               WHERE ting.oid_tipo_ingr = cabrec.tiin_oid_tipo_ingr
                          		   			<isNotEmpty prepend="AND" property="tipoIngreso">
                          		      				               ting.cod_tipo_ingr = #tipoIngreso#
                                                 </isNotEmpty>
                                                    )
                                        AND EXISTS (SELECT regi.oid_regi
                 																			FROM zon_regio regi
                                                     WHERE EXISTS ( SELECT zreg.oid_regi
                                            FROM zon_terri_admin zadm,
                                                 zon_secci       zsec,
                                                 zon_zona        zzon,
                                                 zon_regio       zreg,
                                                 seg_pais        pa,
                                                 zon_sub_geren_venta  zsgv
                                                                     WHERE (zsec.oid_secc = zadm.zscc_oid_secc)
                                  																		 AND (zzon.oid_zona = zsec.zzon_oid_zona)
                                  																		 AND (zreg.oid_regi = zzon.zorg_oid_regi)
                                  																		 AND (zsgv.oid_subg_vent = zreg.zsgv_oid_subg_vent)
                                  																		 AND (pa.oid_pais = zadm.pais_oid_pais)
                                  																		 AND (pa.cod_pais = #codigoPais# )
                                  																		 AND zadm.oid_terr_admi = CABREC.ZTAD_OID_TERR_ADMI
                                  																		 AND regi.oid_regi = zreg.oid_regi
                                                                   )
                      					<iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
                      									                   regi.cod_regi = #regionList[]#
              											               </iterate>
                                                    )
                                        AND EXISTS (SELECT zona1.oid_zona
                 																			FROM zon_zona zona1
                                                     WHERE EXISTS ( SELECT zzon.oid_zona
                                                                      FROM zon_terri_admin zadm,
                                      																		 zon_secci       zsec,
                                      																		 zon_zona        zzon,
                                      																		 zon_regio       zreg,
                                      																		 seg_pais        pa,
                                      																	   zon_sub_geren_venta  zsgv
                                                                     WHERE (zsec.oid_secc = zadm.zscc_oid_secc)
                                  																		 AND (zzon.oid_zona = zsec.zzon_oid_zona)
                                  																		 AND (zreg.oid_regi = zzon.zorg_oid_regi)
                                  																		 AND (zsgv.oid_subg_vent = zreg.zsgv_oid_subg_vent)
                                  																		 AND (pa.oid_pais = zadm.pais_oid_pais)
                                  																		 AND (pa.cod_pais = #codigoPais# )
                                  																		 AND zadm.oid_terr_admi = CABREC.ZTAD_OID_TERR_ADMI
                                  																		 AND zona1.zorg_oid_regi = zreg.oid_regi
                                  																		 AND zona1.oid_zona = zzon.oid_zona
                                                                   )
                                                   <iterate prepend="AND" property="zonaList" open="(" close=")" conjunction="OR">
                      									                   zona1.cod_zona = #zonaList[]#
              											               </iterate>
                                                    )
                                        AND EXISTS (SELECT top.oid_tipo_oper
                                                      FROM rec_opera op,
                  		  																	 rec_tipos_opera top
                                                     WHERE top.oid_tipo_oper = operec.tiop_oid_tipo_oper
                                                       AND op.oid_oper = top.rope_oid_oper
                      					<iterate prepend="AND" property="operacionList" open="(" close=")" conjunction="OR">
                   		                                     op.cod_oper = #operacionList[]#
                                                    </iterate>
                                                    )
                                        AND cabrec.fec_ingr >= TO_DATE(#fechaInicio#,'DD/MM/YYYY')
						<![CDATA[  
	                                      AND cabrec.fec_ingr <= TO_DATE(#fechaFin#,'DD/MM/YYYY')
						 ]]>	
    )  
             AND LINREC.OPRE_OID_OPER_RECL = OPEREC.OID_OPER_RECL      
             AND OPEREC.CARE_OID_CABE_RECL = CABREC.OID_CABE_RECL 
   AND CABREC.SOCA_OID_SOLI_CABE = PEDCAB.OID_SOLI_CABE
   AND EXISTS ( SELECT zreg.oid_regi
                  FROM zon_terri_admin zadm,
                       zon_secci       zsec,
                       zon_zona        zzon,
                       zon_regio       zreg,
                       seg_pais        pa,
                       zon_sub_geren_venta  zsgv
                 WHERE (zsec.oid_secc = zadm.zscc_oid_secc)
                   AND (zzon.oid_zona = zsec.zzon_oid_zona)
                   AND (zreg.oid_regi = zzon.zorg_oid_regi)
                   AND (zsgv.oid_subg_vent = zreg.zsgv_oid_subg_vent)
                   AND (pa.oid_pais = zadm.pais_oid_pais)
                   AND (pa.cod_pais = #codigoPais# )
                   AND  zadm.oid_terr_admi = CABREC.ZTAD_OID_TERR_ADMI
                   AND  REGION.OID_REGI = zreg.oid_regi
               )
   AND EXISTS ( SELECT zzon.oid_zona
                  FROM zon_terri_admin zadm,
                                                 zon_secci       zsec,
                                                 zon_zona        zzon,
                                                 zon_regio       zreg,
                                                 seg_pais        pa,
                                                 zon_sub_geren_venta  zsgv
                 WHERE (zsec.oid_secc = zadm.zscc_oid_secc)
                   AND (zzon.oid_zona = zsec.zzon_oid_zona)
                   AND (zreg.oid_regi = zzon.zorg_oid_regi)
                   AND (zsgv.oid_subg_vent = zreg.zsgv_oid_subg_vent)
                   AND (pa.oid_pais = zadm.pais_oid_pais)
                   AND (pa.cod_pais = #codigoPais# )
                   AND  zadm.oid_terr_admi = CABREC.ZTAD_OID_TERR_ADMI
                   AND  REGION.OID_REGI = zreg.oid_regi
                   AND  ZONA.OID_ZONA = zzon.oid_zona
               )
               
             	<isNotEmpty property="parametroMuestraStockFisico">
             		   and ( (operec.tiop_oid_tipo_oper = (
                                                        select RTO.OID_TIPO_OPER 
                                                        from int_rec_oper_homol roh , rec_opera ro,   rec_tipos_opera rto
                                                        where ROH.COD_OPER = RO.COD_OPER
                                                        and RO.OID_OPER = RTO.ROPE_OID_OPER
                                                        and RTO.OID_TIPO_OPER = operec.tiop_oid_tipo_oper 
                                                        and ROH.COD_OPER_HOMOL = 'E' 
                                                       AND linrec.sopo_oid_soli_posi is null
                                                        AND linrec.val_prec = 0
                                                        ) )   
			           or
			             (operec.tiop_oid_tipo_oper not in (
			                                                        select RTO.OID_TIPO_OPER 
			                                                        from int_rec_oper_homol roh , rec_opera ro,   rec_tipos_opera rto
			                                                        where ROH.COD_OPER = RO.COD_OPER
			                                                        and RO.OID_OPER = RTO.ROPE_OID_OPER
			                                                        and RTO.OID_TIPO_OPER = operec.tiop_oid_tipo_oper 
			                                                        and ROH.COD_OPER_HOMOL = 'E' 
			                                                        ) )           
			          )
             		
             	</isNotEmpty>  
               
GROUP BY  CABREC.FEC_INGR,
					OPEREC.TIOP_OID_TIPO_OPER,
  		   			<isNotEmpty property="subacGZ">
            INT_PKG_RECLA.GEN_FN_DESC_GENER(PEDCAB.SBAC_OID_SBAC,'SEG_SUBAC'),
              		</isNotEmpty>	 
  		   			<isNotEmpty property="subacList">
          	INT_PKG_RECLA.GEN_FN_DESC_GENER(INT_PKG_RECLA.GEN_FN_DEV_ID_SUBAC(CABREC.COD_USUA_INGR),'SEG_SUBAC'),
              		</isNotEmpty>	 
					REGION.DES_REGI,
					ZONA.DES_ZONA
  </select>

    <!--  INTERFAZ PRODUCTOS RECLAMADOS - LINEA OPERACION RECLAMO DE SiSICC -->
	<insert id="insertRecLineaOper" parameterClass="java.util.Map">
			INSERT INTO INT_REC_LINEA_OPERA_RECLA  
				 ( SELECT LIN.*, #numeroLote# 
					FROM REC_LINEA_OPERA_RECLA	LIN	
			<!--
					<dynamic prepend="WHERE">
					<iterate prepend="AND" property="codigoLineaList" open="(" close=")" conjunction="OR">
							LIN.OID_LINE_OPER_RECL=#codigoLineaList[]#
					</iterate>
					</dynamic>
			-->
					  where  exists  (select inter.num_line from int_ret_linea_opera_recla inter 
                                  		where inter.num_line =  lin.oid_line_oper_recl )
				)
    </insert>

    <!--  INTERFAZ PRODUCTOS RECLAMADOS - OPERACION NUMERO LOTE SAP DE SiSICC -->
	<insert id="insertRecOperNumLoteSap" parameterClass="java.util.Map">
           INSERT INTO INT_REC_OPERA_NUMER_LOTE_SAP 
                  (NUM_LOTE,NUM_ATEN,NUM_SECU_OPER)
           	SELECT  #numeroLote#	,
                 	RC.NUM_ATEN 		,         
                 	RO.NUM_SECU_OPER 	
            FROM 	REC_OPERA_RECLA RO, REC_CABEC_RECLA RC
           	WHERE 	RC.OID_CABE_RECL = RO.CARE_OID_CABE_RECL 
			<!--
					<iterate prepend="AND" property="codigoOperList" open="(" close=")" conjunction="OR">
							RO.OID_OPER_RECL=#codigoOperList[]#
					</iterate>
			-->
					and exists  (select inter.num_aten from int_ret_linea_opera_recla inter 
                                  where inter.num_secu_oper =  ro.oid_oper_recl ) 

    </insert>

    <!--  INTERFAZ PRODUCTOS RECLAMADOS - HISTORICO DE ENVIO DE SiSICC -->
	<insert id="insertRecHistoricoEnvio" parameterClass="java.util.Map" >
      INSERT INTO INT_REC_HISTO_ENVIO
		SELECT 
                     INT_PKG_RECLA.GEN_FN_REC_COD_TIPO_ING(cabrec.tiin_oid_tipo_ingr) TIPING ,                     
                     INT_PKG_RECLA.GEN_FN_SUB_ACCESO(PEDCAB.Sbac_Oid_Sbac) CODSUBAC ,                     
                     CABREC.FEC_INGR FECREC,                                
                     INT_PKG_RECLA.GEN_FN_REC_COD_OPER(operec.tiop_oid_tipo_oper) CODOPER, 
                     region.cod_regi CODREG ,                                                            
                     SUM(LINREC.NUM_UNID_RECL - LINREC.NUM_UNID_DEVU )  TOTUNIADEV ,
                     COUNT(distinct PEDCAB.OID_SOLI_CABE) TOTALGUIAS ,
         			#numeroLote# ,
         			TO_DATE(#fechaEnvio# ,'YYYYMMDD')
          FROM REC_OPERA_RECLA OPEREC, 
                    REC_CABEC_RECLA CABREC, REC_LINEA_OPERA_RECLA LINREC,                                    
	                PED_SOLIC_CABEC PEDCAB  , ZON_REGIO REGION                                                                                                 
           WHERE 
			                 LINREC.OPRE_OID_OPER_RECL = OPEREC.OID_OPER_RECL   
					  	and exists  (select inter.num_line from int_ret_linea_opera_recla inter 
                                  		where inter.num_line =  linrec.oid_line_oper_recl )
				<!--				
					<iterate prepend="AND" property="codigoLineaList" open="(" close=")" conjunction="OR">
							LINREC.OID_LINE_OPER_RECL=#codigoLineaList[]#
					</iterate>	
				-->
						AND OPEREC.CARE_OID_CABE_RECL = CABREC.OID_CABE_RECL 
						AND cabrec.SOCA_OID_SOLI_CABE = PEDCAB.OID_SOLI_CABE 
						and  region.oid_regi = INT_PKG_RECLA.GEN_FN_OID_REGIO_BYZON_TERRI(CABREC.ZTAD_OID_TERR_ADMI, #codigoPais#)
           group by 
                     INT_PKG_RECLA.GEN_FN_REC_COD_TIPO_ING(cabrec.tiin_oid_tipo_ingr) ,
                     INT_PKG_RECLA.GEN_FN_SUB_ACCESO(PEDCAB.Sbac_Oid_Sbac) ,
                     CABREC.FEC_INGR ,
                    INT_PKG_RECLA.GEN_FN_REC_COD_OPER(operec.tiop_oid_tipo_oper) ,
					 region.cod_regi
    </insert>

    <!-- CONSULTA DE LOS PRODUCTOS RECLAMADOS SEGUN LOS CRITERIOS  -->
  <select id="getConsultaRECProductosList" parameterClass="java.util.Map" resultMap="productReclamResult" >
        SELECT  	 
                     INT_PKG_RECLA.GEN_FN_REC_NUM_LOTE(LINREC.Oid_Line_Oper_Recl) AS NUMLOTE ,
					 #codigoPais#	CODPAIS ,
                     CABREC.OID_CABE_RECL RECCAB, OPEREC.OID_OPER_RECL RECOPER, LINREC.OID_LINE_OPER_RECL LIN,
                     TO_CHAR(CABREC.FEC_INGR, 'DD/MM/YYYY') FECREC,
                     cabrec.tiin_oid_tipo_ingr AS TIPING ,
                     INT_PKG_RECLA.GEN_FN_DESC_GENER(PEDCAB.Sbac_Oid_Sbac,'SEG_SUBAC' ) AS SUBAC,
                     INT_PKG_RECLA.GEN_FN_REC_COD_OPER(operec.tiop_oid_tipo_oper) AS CODOPER,
                     INT_PKG_RECLA.GEN_FN_CODSAP_PROD(LINREC.PROD_OID_PROD) AS CODSAP ,
                     INT_PKG_RECLA.GEN_FN_DESC_PROD(LINREC.PROD_OID_PROD) AS DESCPROD ,
                     INT_PKG_RECLA.GEN_FN_CAMPANHA(pedcab.perd_oid_peri) AS CAMPREF ,
                     INT_PKG_RECLA.GEN_FN_CAMPANHA(pedcab.perd_oid_peri) AS CODPER ,
                     INT_PKG_RECLA.GEN_FN_TIPO_PERIO(pedcab.perd_oid_peri) AS TIPOPER ,
                     INT_PKG_RECLA.GEN_FN_SUB_ACCESO(PEDCAB.Sbac_Oid_Sbac) AS CODSUBAC ,
                     INT_PKG_RECLA.GEN_FN_ACCESO(pedcab.perd_oid_peri) AS CODACC ,
                     INT_PKG_RECLA.GEN_FN_CANAL(pedcab.perd_oid_peri) AS CODCANAL ,
                     INT_PKG_RECLA.GEN_FN_MARCA_PROD(LINREC.PROD_OID_PROD) AS MARCA ,
                     INT_PKG_RECLA.GEN_FN_NEGO_PROD(LINREC.PROD_OID_PROD) AS NEGOCIO ,
                     INT_PKG_RECLA.GEN_FN_COD_CLIE(CABREC.CLIE_OID_CLIE) AS CLIENTE ,
                     INT_PKG_RECLA.GEN_FN_COD_VENTA(LINREC.Mafa_Oid_Matr_Fact) AS CODVENT ,
                     INT_PKG_RECLA.GEN_FN_COD_TIPO_OFERT(LINREC.TOFE_OID_TIPO_OFER) AS TIPOFER,
                     INT_PKG_RECLA.GEN_FN_REC_TIPO_MOVI_ALMAC(operec.tiop_oid_tipo_oper) AS TIPOMOV ,
                     INT_PKG_RECLA.GEN_FN_REC_COD_ALMAC(operec.tiop_oid_tipo_oper) AS ALMACORIG ,
                     INT_PKG_RECLA.GEN_FN_REC_TIPO_OPER(operec.tiop_oid_tipo_oper ) AS TIPOOPER,
                     INT_PKG_RECLA.GEN_FN_DES_REG(CABREC.CLIE_OID_CLIE, #codigoPais#) REG ,
					 PEDCAB.VAL_NUME_SOLI DOCREF ,             
			         LINREC.PROD_OID_PROD, 
			         LINREC.NUM_UNID_RECL AS UNIDREC, 
                     LINREC.NUM_UNID_RECL AS UNIDADEVOLVREC ,
			         LINREC.NUM_UNID_DEVU AS UNIDDEVU ,
	                 (LINREC.NUM_UNID_RECL - LINREC.NUM_UNID_DEVU ) AS UNIDADEVOLV    ,
                     0               AS  PRECIONETO ,
                     0               AS  PRECIOCONT ,
                     ''                   NUMDOC ,
                     ''                   ALMACDEST ,
                     'I'                   INDICADOR ,
		             ''		  FECENVIO
				FROM 	REC_OPERA_RECLA OPEREC, 
                      	REC_CABEC_RECLA CABREC, REC_LINEA_OPERA_RECLA LINREC,                                    
			            PED_SOLIC_CABEC PEDCAB                                                                                                   
				WHERE 
			            LINREC.OPRE_OID_OPER_RECL = OPEREC.OID_OPER_RECL    AND 
			                 OPEREC.CARE_OID_CABE_RECL = CABREC.OID_CABE_RECL AND                                      
                       cabrec.SOCA_OID_SOLI_CABE = PEDCAB.OID_SOLI_CABE 
        			<isEqual prepend="AND" property="indicadorSap"  compareValue="0"> 
			                 LINREC.NUM_UNID_RECL > LINREC.NUM_UNID_DEVU 
        			</isEqual>
        			<isEqual prepend="AND" property="indicadorSap"  compareValue="1"> 
			                 LINREC.NUM_UNID_RECL = LINREC.NUM_UNID_DEVU 
        			</isEqual>

  		   			<isNotEmpty prepend="AND" property="subacGZ">
							cabrec.num_aten_inte is null
              		</isNotEmpty>	 
  		   			<isNotEmpty property="subacList">
					  <iterate prepend="AND" property="subacList" open="(" close=")" conjunction="OR">
                         cabrec.cod_usua_ingr = #subacList[]#
                      </iterate>    
					</isNotEmpty>
			
			           and exists (select ESTOP.OID_ESTA_OPER from REC_ESTAD_OPERA ESTOP where ESTOP.OID_ESTA_OPER = OPEREC.ESOP_OID_ESTA_OPER AND ESTOP.COD_ESTA_OPER = 'F')
			           and exists (select ESTREC.OID_ESTA_RECL from REC_ESTAD_RECLA ESTREC where ESTREC.OID_ESTA_RECL = CABREC.ESRE_OID_ESTA_RECL AND ESTREC.COD_ESTA = 'F')
			           and exists (select tmo.oid_tipo_movi from REC_TIPO_MOVIM TMO where tmo.oid_tipo_movi = linrec.timo_oid_tipo_movi and tmo.cod_tipo_movi = 'D' )
			           and exists (select TING.COD_TIPO_INGR from REC_TIPO_INGRE TING where ting.oid_tipo_ingr = cabrec.tiin_oid_tipo_ingr 
                          		   			<isNotEmpty prepend="AND" property="tipoIngreso">
                          		      				 TING.COD_TIPO_INGR = #tipoIngreso#
                                      		</isNotEmpty>	 
									)
		<!--
                 and exists (select sb.oid_sbac from seg_subac sb where sb.oid_sbac = pedcab.sbac_oid_sbac 
                          					<iterate prepend="AND" property="subacList" open="(" close=")" conjunction="OR">
                          					   sb.COD_SBAC=#subacList[]#
                          					</iterate>    )                               
		-->
                 and exists (select regi.oid_regi from zon_regio regi where regi.oid_regi = INT_PKG_RECLA.GEN_FN_OID_REGIO_BYZON_TERRI(CABREC.ZTAD_OID_TERR_ADMI, #codigoPais#)  
                      					<iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
                      							regi.COD_REGI=#regionList[]#
                      					</iterate>   )
                and exists ( select top.oid_tipo_oper from REC_OPERA OP, REC_TIPOS_OPERA TOP 
                                    where TOP.OID_TIPO_OPER = operec.tiop_oid_tipo_oper and
                                          OP.OID_OPER = TOP.Rope_Oid_Oper 
                      					<iterate prepend="AND" property="operacionList" open="(" close=")" conjunction="OR">
                      							OP.COD_OPER = #operacionList[]#
                      					</iterate>   )


							  AND CABREC.FEC_INGR >= TO_DATE(#fechaInicio#,'DD/MM/YYYY')
						<![CDATA[  
					      AND CABREC.FEC_INGR <= TO_DATE(#fechaFin#,'DD/MM/YYYY')
						 ]]>	

                <isNotEmpty prepend="AND" property="numeroLote">
					INT_PKG_RECLA.GEN_FN_REC_NUM_LOTE(LINREC.Oid_Line_Oper_Recl) LIKE #numeroLote#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="docRef">
        			       PEDCAB.VAL_NUME_SOLI LIKE #docRef#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="cliente">
					INT_PKG_RECLA.GEN_FN_COD_CLIE(CABREC.CLIE_OID_CLIE) LIKE #cliente#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="codSap">
              		INT_PKG_RECLA.GEN_FN_CODSAP_PROD(LINREC.PROD_OID_PROD) LIKE #codSap#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="codVenta">
                    INT_PKG_RECLA.GEN_FN_COD_VENTA(LINREC.Mafa_Oid_Matr_Fact) LIKE #codVenta#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="descProd">
              		INT_PKG_RECLA.GEN_FN_DESC_PROD(LINREC.PROD_OID_PROD) LIKE #descProd#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="campRef">
              		INT_PKG_RECLA.GEN_FN_CAMPANHA(pedcab.perd_oid_peri) = #campRef#
                </isNotEmpty>

  </select>

    <!-- OBTIENE LOS PRODUCTOS RECLAMADOS SEGUN CRITERIOS PARA TIPO INGRESO EN LOTE   -->
  <select id="getRECLoteProductosList" parameterClass="java.util.Map" resultClass="java.lang.String" >
        SELECT  
                 (CABREC.OID_CABE_RECL || '|' || OPEREC.OID_OPER_RECL || '|' || LINREC.OID_LINE_OPER_RECL) AS CODREC
          FROM REC_OPERA_RECLA OPEREC, 
               REC_CABEC_RECLA CABREC, REC_LINEA_OPERA_RECLA LINREC,                                    
               PED_SOLIC_CABEC PEDCAB         
		WHERE                                                                                          
			            LINREC.OPRE_OID_OPER_RECL = OPEREC.OID_OPER_RECL      AND 
			                 OPEREC.CARE_OID_CABE_RECL = CABREC.OID_CABE_RECL AND                                      
                       cabrec.SOCA_OID_SOLI_CABE = PEDCAB.OID_SOLI_CABE AND
			                 LINREC.NUM_UNID_RECL > LINREC.NUM_UNID_DEVU 
			           and exists (select ESTOP.OID_ESTA_OPER from REC_ESTAD_OPERA ESTOP where ESTOP.OID_ESTA_OPER = OPEREC.ESOP_OID_ESTA_OPER AND ESTOP.COD_ESTA_OPER = 'F')
			           and exists (select ESTREC.OID_ESTA_RECL from REC_ESTAD_RECLA ESTREC where ESTREC.OID_ESTA_RECL = CABREC.ESRE_OID_ESTA_RECL AND ESTREC.COD_ESTA = 'F')
			           and exists (select tmo.oid_tipo_movi from REC_TIPO_MOVIM TMO where tmo.oid_tipo_movi = linrec.timo_oid_tipo_movi and tmo.cod_tipo_movi = 'D' )
			           and exists (select TING.COD_TIPO_INGR from REC_TIPO_INGRE TING where ting.oid_tipo_ingr = cabrec.tiin_oid_tipo_ingr 
                          		   			<isNotEmpty prepend="AND" property="tipoIngreso">
                          		      				 TING.COD_TIPO_INGR = #tipoIngreso#
                                      		</isNotEmpty>	 
								 )
                 and exists (select sb.oid_sbac from seg_subac sb where sb.oid_sbac = pedcab.sbac_oid_sbac 
                          					<iterate prepend="AND" property="subacList" open="(" close=")" conjunction="OR">
                          					   sb.COD_SBAC=#subacList[]#
                          					</iterate>    )                               
                 and exists (select regi.oid_regi from zon_regio regi where regi.oid_regi = INT_PKG_RECLA.GEN_FN_OID_REGIO_BYZON_TERRI(CABREC.ZTAD_OID_TERR_ADMI,#codigoPais#)  
                      					<iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
                      							regi.COD_REGI=#regionList[]#
                      					</iterate>   )
                and exists ( select top.oid_tipo_oper from REC_OPERA OP, REC_TIPOS_OPERA TOP 
                                    where TOP.OID_TIPO_OPER = operec.tiop_oid_tipo_oper and
                                          OP.OID_OPER = TOP.Rope_Oid_Oper 
                        		   			<isNotEmpty prepend="AND" property="operacion">
                        		      				(OP.COD_OPER  = #operacion#)
                        		   			</isNotEmpty> )

							  AND CABREC.FEC_INGR >= TO_DATE(#fechaInicio#,'DD/MM/YYYY')
						<![CDATA[  
					      AND CABREC.FEC_INGR <= TO_DATE(#fechaFin#,'DD/MM/YYYY')
						 ]]>	
  </select>
  
  <select id="getInterfazPERArchivoPDT" parameterClass="java.util.Map" resultMap="interfazPERArchivoPDTResult">
	SELECT  *
	FROM	(	
		SELECT
		 (SELECT COD_HOMO FROM PER_TIPO_DOCUM_IDENT_LEGAL B
			   WHERE B.PAIS_COD_PAIS = #codigoPais# AND 
               COD_CLAS = 'DI' AND	  
               COD_AHOM = A.TIP_DOID) TIP_DOID,
		  PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_CAMPO_REEMP(#codigoPais#,'PER','NUM_DOID',NUM_DOID) NUM_DOID,										
          PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_RAZON_SOCIAL(#codigoPais#,'TC', A.TIP_DOLE, A.COD_CLIE) AS RAZ_SOCI,
          PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_NOMBRES(
					#codigoPais#,'TC', A.TIP_DOLE, A.COD_CLIE,'PATERNO', A.APE_PATE) AS APE_PATE,
          PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_NOMBRES(
					#codigoPais#,'TC', A.TIP_DOLE, A.COD_CLIE,'MATERNO', A.APE_MATE) AS APE_MATE,
          PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_NOMBRES(
					#codigoPais#,'TC', A.TIP_DOLE, A.COD_CLIE,'NOMBRE', A.VAL_NOMB) AS VAL_NOMB,
  		  PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_CAMPO_REEMP(#codigoPais#,'PER','SER_COPE',SER_COPE) SER_COPE,
  		  PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_CAMPO_REEMP(#codigoPais#,'PER','NUM_COPE',NUM_COPE) NUM_COPE,								
  		  TO_CHAR(FEC_COPE,'DD/MM/YYYY') AS FEC_COPE,
          PER_PKG_PROCE_PERCE.PER_FN_DEVUE_INDI_DEREC_CREFI(#codigoPais#,'TC', A.TIP_DOLE) AS IND_DCFI,
          '0' AS VEN_MATE_DEST,
          PER_PKG_PROCE_PERCE.PER_FN_DEVUE_INDI_CLIEN_LISTA(#codigoPais#,A.TIP_DOID, A.NUM_DOID) AS IND_CLLI,
          PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_MONTO_PAGO(A.COD_CLIE, A.SER_COPE, A.NUM_COPE, #fechaDesde#, #fechaHasta#) AS MON_PERC,
		  (SELECT COD_HOMO FROM PER_TIPO_DOCUM_IDENT_LEGAL
			   WHERE PAIS_COD_PAIS = #codigoPais#
			    AND   COD_CLAS = 'TC'
			    AND	  COD_AHOM = A.TIP_DOLE) TIP_COPA,
  		  PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_CAMPO_REEMP(#codigoPais#,'PER','SER_DOLE',SER_DOLE) SER_DOLE,
  		  PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_CAMPO_REEMP(#codigoPais#,'PER','NUM_DOLE',NUM_DOLE) NUM_DOLE,												
  		  TO_CHAR(MAX(FEC_DOLE),'DD/MM/YYYY') AS FEC_DOLE,
  		  PER_PKG_PROCE_PERCE.PER_FN_DEVUE_PDT_MONTO_TOTAL(A.COD_CLIE, A.SER_DOLE, A.NUM_DOLE, #fechaDesde#, #fechaHasta#) AS MON_PAGO
		FROM PER_PERCE_CONSO A
		WHERE 
		<![CDATA[
           FEC_COPE >= TO_DATE(#fechaDesde#,'DD/MM/YYYY') AND 
		   FEC_COPE < TO_DATE(#fechaHasta#,'DD/MM/YYYY') + 1 AND
		]]>	   
		   MON_PAGO != 0 AND
		   MON_PERC != 0
		   AND(FLA_CANC IS NULL OR FLA_CANC != '1') 
		   AND(FLA_CANC IS NULL OR FLA_CANC != 'A')
	GROUP BY 												
           TIP_CLIE, COD_CLIE, SER_COPE, NUM_COPE, FEC_COPE,														
		   TIP_DOID, NUM_DOID, TIP_DOLE, SER_DOLE, NUM_DOLE,												
		   A.APE_PATE, A.APE_MATE, A.VAL_NOMB			   
	)	
	ORDER BY 1 NULLS LAST	   																																
	</select>  

  
	<!-- CONSULTA PARA LA INTERFACE SIC VENTA BASE CONSULTORAS   -->
	<select id="getInterfazSICVentaBaseConsultorasList" parameterClass="java.util.Map" resultMap="interfazSICVentaBaseConsultorasResult" >	
		SELECT   
			concursos.NUM_CONC AS COD_CONCURSO,	
			#codigoPeriodo# ,
			#codigoPais# ,
			clientes.COD_CLIE AS COD_CLIENTE,
			case
				when VENTA.IMP_MONTO_VENTA is null then trunc(concursos.IMP_MONT_MINI) 
				else trunc(venta.VAL_META)
			end MONTO_VENTA, 
			' ' AS CODIGO_EMPRESA
		FROM
			(
				SELECT 
					MAE_CLIEN.OID_CLIE,
					MAE_CLIEN.COD_CLIE 
				FROM
					MAE_CLIEN,
					MAE_CLIEN_TIPO_SUBTI, 
					MAE_TIPO_CLIEN, 
					MAE_SUBTI_CLIEN
				WHERE
					MAE_CLIEN.OID_CLIE = MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE
					AND MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE = MAE_TIPO_CLIEN.OID_TIPO_CLIE				
					AND MAE_CLIEN_TIPO_SUBTI.SBTI_OID_SUBT_CLIE = MAE_SUBTI_CLIEN.OID_SUBT_CLIE
					AND MAE_TIPO_CLIEN.OID_TIPO_CLIE  = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE
		<iterate prepend="AND" property="codigoTipoClientes" open="(" close=")" conjunction="OR">
		   			MAE_TIPO_CLIEN.COD_TIPO_CLIE = #codigoTipoClientes[]#    
         </iterate>                                  
		<iterate prepend="AND" property="codigoSubTipoClientes" open="(" close=")" conjunction="OR">
				(MAE_TIPO_CLIEN.COD_TIPO_CLIE || '-' || MAE_SUBTI_CLIEN.COD_SUBT_CLIE)  = #codigoSubTipoClientes[]#    
         </iterate>                                  
       ) CLIENTES ,       
			(
				SELECT 
					concurso.oid_para_gral ,        
					concurso.NUM_CONC,
          rango.imp_mont_mini 
				FROM
					INC_CONCU_PARAM_GENER concurso,
          MAE_ESTAT_CLIEN estcli ,
          INC_ESTAT_VENTA estventa ,
          Inc_Monto_Minim_Rango_Consu rango 
				WHERE
           concurso.oid_para_gral = estventa.copa_oid_para_gral and
           estventa.esta_oid_esta_clie = estcli.oid_esta_clie and
           estcli.cod_esta_clie = '02' and
           estventa.oid_esta_vent = rango.estv_oid_esta_vent and
           concurso.num_conc = #codigoConcurso#
       ) CONCURSOS ,
          
			INC_METAS_TIPO_VENTA VENTA
		WHERE
			clientes.OID_CLIE = VENTA.CLIE_OID_CLIE 
			AND VENTA.COPA_OID_PARA_GRAL = concursos.OID_PARA_GRAL 

	</select>

	<!-- CONSULTA PARA LA INTERFACE SIC ENVIAR PUNTAJES POR CAMPAA   -->
	<select id="getInterfazSICVentasPuntajesXCampanyaList" parameterClass="java.util.Map" resultMap="interfazSICVentasPuntajesXCampanyaResult" >	
	select	cod_pais,
          			num_conc,
			empresa,
			cod_clie,
			campaa,	
			puntos_campaa,
			decode(puntos_campaa,0,0,sum(puntos_campaa) over (partition by cod_clie order by cod_clie, rownum)) puntos_acumulado,
			venta
		from	(
			select clientes.cod_pais,
				   clientes.num_conc,
          			' ' as empresa,
          			clientes.cod_clie,	
					clientes.cod_peri as campaa,	
				<![CDATA[	
			case
				when puntos is not null and puntos < 0 then 0
				else nvl(puntos,0) 
			end as puntos_campaa,
			case
				when venta is not null and venta < 0 then 0
				else nvl(venta,0) 
			end as venta
				]]>
          		from
          			(
          				select
					* 
          				from
					 (SELECT  mae_clien.oid_clie,
          					mae_clien.cod_clie
                  FROM  mae_clien
                  WHERE EXISTS( SELECT *
                                FROM mae_subti_clien st,
                                     mae_tipo_clien tc,
                                     mae_tipo_clasi_clien tcf,
                                     mae_clasi cls ,
                                     mae_clien_tipo_subti  cts,
                                     mae_clien_clasi cc
                              WHERE  mae_clien.oid_clie = cts.clie_oid_clie
                          	   AND cts.oid_clie_tipo_subt = cc.ctsu_oid_clie_tipo_subt
                               AND st.ticl_oid_tipo_clie =tc.oid_tipo_clie
                               AND tcf.sbti_oid_subt_clie =st.oid_subt_clie
                               AND cls.tccl_oid_tipo_clas = tcf.oid_tipo_clas
                               AND cc.clas_oid_clas=cls.oid_clas
								AND tc.cod_tipo_clie = #codigoTipoCliente#	
								<iterate prepend="AND" property="codigoSubTipoCliente" open="(" close=")" conjunction="OR">
		   							COD_TIPO_CLIE || '-' || COD_SUBT_CLIE =  #codigoSubTipoCliente[]#    
         						</iterate>	
								<iterate prepend="AND" property="codigoTipoClasificacion" open="(" close=")" conjunction="OR">
		   							tcf.cod_tipo_clas||tc.cod_tipo_clie||st.cod_subt_clie =  #codigoTipoClasificacion[]#    
         						</iterate>	
								<iterate prepend="AND" property="codigoClasificacion" open="(" close=")" conjunction="OR">
		   							tcf.cod_tipo_clas||tc.cod_tipo_clie||st.cod_subt_clie||cls.cod_clas =  #codigoClasificacion[]#    
         						</iterate>	
                               )
                  ORDER BY	mae_clien.cod_clie
          			) clientes,
          			(
          				select
          					seg_perio_corpo.cod_peri,
							seg_pais.cod_pais,
							num_conc
          				from
          					inc_concu_param_gener,
          					cra_perio per_desde,
          					cra_perio,			
          					seg_perio_corpo,
							seg_pais
						where
							1=1					
							and cra_perio.peri_oid_peri = seg_perio_corpo.oid_peri
							and cra_perio.MARC_OID_MARC = #oidMarca#
							and cra_perio.CANA_OID_CANA = #oidCanal#
							and cra_perio.pais_oid_pais = seg_pais.oid_pais
							and inc_concu_param_gener.oid_para_gral =#oidParametroGeneral#
							and inc_concu_param_gener.perd_oid_peri_desd = per_desde.oid_peri 
							<![CDATA[	
							and cra_perio.fec_inic <= to_date(#fechaActual#, 'dd/mm/yyyy')
							and cra_perio.fec_inic >= per_desde.fec_inic
							]]>
					) per
			) clientes left outer join
          					(
          						select
					INC_SOLIC_CONCU_PUNTA.clie_oid_clie,
					seg_perio_corpo.cod_peri,
					sum(INC_SOLIC_CONCU_PUNTA.IMP_MONT) venta
          						from
					INC_SOLIC_CONCU_PUNTA,
					inc_concu_param_gener,
					cra_perio,			
					seg_perio_corpo
          						where									 
				    1=1					
					and INC_SOLIC_CONCU_PUNTA.perd_oid_peri = cra_perio.oid_peri
          					and cra_perio.peri_oid_peri = seg_perio_corpo.oid_peri
					and inc_concu_param_gener.oid_para_gral = #oidParametroGeneral#
					and INC_SOLIC_CONCU_PUNTA.COPA_OID_PARA_GRAL = inc_concu_param_gener.oid_para_gral
						<![CDATA[
					and (
							(INC_SOLIC_CONCU_PUNTA.IND_ANUL = 0	and INC_SOLIC_CONCU_PUNTA.NUM_PUNT >= 0)
						or (INC_SOLIC_CONCU_PUNTA.IND_ANUL = 1	and INC_SOLIC_CONCU_PUNTA.NUM_PUNT < 0)
						)	
					    ]]>
          				group by
					INC_SOLIC_CONCU_PUNTA.clie_oid_clie,
          					seg_perio_corpo.cod_peri
			) pedidos on (clientes.oid_clie = pedidos.clie_oid_clie and clientes.cod_peri = pedidos.cod_peri) left outer join	
          			(	
          				select						
          					inc_cuent_corri_punto.clie_oid_clie,
          					seg_perio_corpo.cod_peri,
          					sum(inc_cuent_corri_punto.num_punt) puntos			
          				from
          					inc_cuent_corri_punto,			
          					cra_perio,
					seg_perio_corpo
          						where									 
					inc_cuent_corri_punto.copa_oid_para_gral = #oidParametroGeneral#		 
          					and inc_cuent_corri_punto.perd_oid_peri = cra_perio.oid_peri
          					and cra_perio.peri_oid_peri = seg_perio_corpo.oid_peri
          				group by		
          					clie_oid_clie,
          					seg_perio_corpo.cod_peri
			) puntos on (clientes.oid_clie = puntos.clie_oid_clie and clientes.cod_peri = puntos.cod_peri)
          		order by 
          			clientes.cod_clie,
			clientes.cod_peri
          	)
			</select>
	
		<!-- CONSULTA PARA LA INTERFACE SIC ENVIAR INSCRITAS   -->
	<select id="getInterfazSICInscritasList" parameterClass="java.util.Map" resultMap="interfazSICInscritasResult" >	
		select
			COD_PAIS AS CODIGO_PAIS,
			' ' as CODIGO_EMPRESA,		
			clientes.COD_CLIE as CODIGO_CLIENTE,
			inscritas.VAL_APE1 as APELLIDO_PATERNO,
			inscritas.VAL_APE2 as APELLIDO_MATERNO,
			inscritas.VAL_NOM1 || ' ' || VAL_NOM2 as NOMBRE,
			TO_CHAR(MAE_CLIEN_DATOS_ADICI.FEC_NACI, 'YYYYMMDD') as FECHA_NACIMIENTO,
			cliEmail.EMAIL,
			cliTelefono.TELEFONO,
            cliCelular.CELULAR,
            cliCelular.IND_COMU_PPAL,
			(
				select
					SEG_PERIO_CORPO.COD_PERI
				from
					CRA_PERIO,					
					SEG_PERIO_CORPO					
				where
					CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI								 
					and CRA_PERIO.PAIS_OID_PAIS = perActual.Pais
					and CRA_PERIO.MARC_OID_MARC = perActual.Marca
					and CRA_PERIO.CANA_OID_CANA = perActual.Canal
					and SEG_PERIO_CORPO.VAL_ANIO = perActual.Anio
				<![CDATA[  	
					and CRA_PERIO.FEC_INIC <= inscritas.FEC_INGR
					and CRA_PERIO.FEC_FINA >= inscritas.FEC_INGR
					]]>		
					and rownum = 1
			) CODIGO_PERIODO,	
			' ' as FECHA_ENTREGA_CARNET,
			<![CDATA[  
			case			
				when (inscritas.FEC_ULTI_ACTU >= MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU)  
				and (inscritas.FEC_ULTI_ACTU >= NVL(cliTelefono.FEC_ULTI_ACTU,inscritas.FEC_ULTI_ACTU))
				and (inscritas.FEC_ULTI_ACTU >= NVL(cliEmail.FEC_ULTI_ACTU,inscritas.FEC_ULTI_ACTU))
				and (inscritas.FEC_ULTI_ACTU >= NVL(cliCelular.FEC_ULTI_ACTU,inscritas.FEC_ULTI_ACTU)) then TO_CHAR(inscritas.FEC_ULTI_ACTU, 'YYYYMMDD')
				when (MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU >= inscritas.FEC_ULTI_ACTU) 
				and (MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU >= NVL(cliTelefono.FEC_ULTI_ACTU,MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU))
				and (MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU >= NVL(cliEmail.FEC_ULTI_ACTU,MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU))
				and (MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU >= NVL(cliCelular.FEC_ULTI_ACTU,MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU)) then TO_CHAR(MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU, 'YYYYMMDD')
			when (NVL(cliTelefono.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= inscritas.FEC_ULTI_ACTU)
				and (NVL(cliTelefono.FEC_ULTI_ACTU, MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU) >= MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU)
				and (NVL(cliTelefono.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= NVL(cliEmail.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU))
				and (NVL(cliTelefono.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= NVL(cliCelular.FEC_ULTI_ACTU,inscritas.FEC_ULTI_ACTU)) then TO_CHAR(NVL(cliTelefono.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU), 'YYYYMMDD')
			when (NVL(cliEmail.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= inscritas.FEC_ULTI_ACTU)
				and (NVL(cliEmail.FEC_ULTI_ACTU, MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU) >= MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU)
				and (NVL(cliEmail.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= NVL(cliTelefono.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU))
				and (NVL(cliEmail.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= NVL(cliCelular.FEC_ULTI_ACTU,inscritas.FEC_ULTI_ACTU)) then TO_CHAR(NVL(cliEmail.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU), 'YYYYMMDD')
			when (NVL(cliCelular.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= inscritas.FEC_ULTI_ACTU)
				and (NVL(cliCelular.FEC_ULTI_ACTU, MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU) >= MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU)
				and (NVL(cliCelular.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= NVL(cliTelefono.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU))
				and (NVL(cliCelular.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU) >= NVL(cliEmail.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU)) then TO_CHAR(NVL(cliCelular.FEC_ULTI_ACTU, inscritas.FEC_ULTI_ACTU), 'YYYYMMDD')	  	
			end as FECHA_ULTIMA_MODIFICACION,
				]]>	
			TO_CHAR(inscritas.FEC_INGR, 'YYYYMMDD') as FECHA_INGRESO,
			' ' as ULTIMO_USUARIO_ACTUALIZO,
			'C' as ORIGEN_INSCRIPCION,
			' ' as CLAVE_ACCESO_DUPLAWEB	 
			
		from
			MAE_CLIEN inscritas, 
			MAE_CLIEN_DATOS_ADICI,
			MAE_CLIEN_VINCU, 
			MAE_TIPO_VINCU,		
			(
					
				SELECT 
					MAE_CLIEN.OID_CLIE,
					MAE_CLIEN.COD_CLIE			 
				FROM
					MAE_CLIEN,
					MAE_CLIEN_TIPO_SUBTI, 
					MAE_CLIEN_CLASI, 
					MAE_TIPO_CLIEN, 
					MAE_SUBTI_CLIEN, 
					MAE_TIPO_CLASI_CLIEN, 
					MAE_CLASI  
				WHERE
					MAE_CLIEN.OID_CLIE = MAE_CLIEN_TIPO_SUBTI.CLIE_OID_CLIE
					AND MAE_CLIEN_TIPO_SUBTI.OID_CLIE_TIPO_SUBT = MAE_CLIEN_CLASI.CTSU_OID_CLIE_TIPO_SUBT
					AND MAE_CLIEN_TIPO_SUBTI.TICL_OID_TIPO_CLIE = MAE_TIPO_CLIEN.OID_TIPO_CLIE				
					AND MAE_CLIEN_TIPO_SUBTI.SBTI_OID_SUBT_CLIE = MAE_SUBTI_CLIEN.OID_SUBT_CLIE
					AND MAE_CLIEN_CLASI.TCCL_OID_TIPO_CLASI = MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS 
					AND MAE_CLIEN_CLASI.CLAS_OID_CLAS = MAE_CLASI.OID_CLAS
					AND MAE_TIPO_CLIEN.OID_TIPO_CLIE  = MAE_SUBTI_CLIEN.TICL_OID_TIPO_CLIE
					AND MAE_SUBTI_CLIEN.OID_SUBT_CLIE = MAE_TIPO_CLASI_CLIEN.SBTI_OID_SUBT_CLIE
					AND MAE_TIPO_CLASI_CLIEN.OID_TIPO_CLAS = MAE_CLASI.TCCL_OID_TIPO_CLAS
					AND 	MAE_TIPO_CLIEN.COD_TIPO_CLIE  =  #codigoTipoCliente#
					AND 	MAE_SUBTI_CLIEN.COD_SUBT_CLIE = #codigoSubTipoCliente#
					AND 	MAE_TIPO_CLASI_CLIEN.COD_TIPO_CLAS = #codigoTipoClasificacion#
					AND 	MAE_CLASI.COD_CLAS = #codigoClasificacion#
					
			) clientes,	
			(
				select
					MAE_CLIEN_COMUN.CLIE_OID_CLIE,
					MAE_CLIEN_COMUN.VAL_TEXT_COMU telefono,
					MAE_CLIEN_COMUN.FEC_ULTI_ACTU
				from
					MAE_CLIEN_COMUN,
					MAE_TIPO_COMUN
				where
					MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU 
					and MAE_TIPO_COMUN.COD_TIPO_COMU in ('TF')
				order by 1	
			) cliTelefono,
			(
				select
					MAE_CLIEN_COMUN.CLIE_OID_CLIE,
					MAE_CLIEN_COMUN.VAL_TEXT_COMU email,
					MAE_CLIEN_COMUN.FEC_ULTI_ACTU
				from
					MAE_CLIEN_COMUN,
					MAE_TIPO_COMUN
				where
					MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU 
					and MAE_TIPO_COMUN.COD_TIPO_COMU in ('ML')
				order by 1	
			) cliEmail,
            (
                select
                    MAE_CLIEN_COMUN.CLIE_OID_CLIE,
                    MAE_CLIEN_COMUN.VAL_TEXT_COMU celular,
                    MAE_CLIEN_COMUN.FEC_ULTI_ACTU,
                    MAE_CLIEN_COMUN.IND_COMU_PPAL
                from
                    MAE_CLIEN_COMUN,
                    MAE_TIPO_COMUN
                where
                    MAE_CLIEN_COMUN.TICM_OID_TIPO_COMU = MAE_TIPO_COMUN.OID_TIPO_COMU 
                    and MAE_TIPO_COMUN.COD_TIPO_COMU in ('TM')
                order by 1  
			) cliCelular,
			(
				SELECT
					COD_PAIS,
					CRA_PERIO.PAIS_OID_PAIS as Pais,
					CRA_PERIO.MARC_OID_MARC as Marca,
					CRA_PERIO.CANA_OID_CANA as Canal,
					SEG_PERIO_CORPO.COD_PERI,
					SEG_PERIO_CORPO.VAL_ANIO as Anio			
					
				FROM
					CRA_PERIO,
					SEG_PERIO_CORPO,
					SEG_PAIS,
					SEG_MARCA,
					SEG_CANAL 
				WHERE
					CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI
					AND CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS 
					AND CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC
					AND CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA
					AND SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#
					AND 	SEG_PAIS.COD_PAIS =  #codigoPais#
					AND 	SEG_MARCA.COD_MARC = #codigoMarca#
					AND 	SEG_CANAL.COD_CANA = #codigoCanal#
					 
			) perActual
		where	 
			inscritas.OID_CLIE = MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE
			and inscritas.OID_CLIE = MAE_CLIEN_VINCU.CLIE_OID_CLIE_VNDO 
			and MAE_CLIEN_VINCU.TIVC_OID_TIPO_VINC = MAE_TIPO_VINCU.OID_TIPO_VINC
			AND MAE_TIPO_VINCU.PAIS_OID_PAIS =  perActual.Pais
			and inscritas.OID_CLIE = cliTelefono.CLIE_OID_CLIE(+)
			and inscritas.OID_CLIE = cliEmail.CLIE_OID_CLIE(+)
            and inscritas.OID_CLIE = cliCelular.CLIE_OID_CLIE(+)
			AND MAE_TIPO_VINCU.COD_TIPO_VINC = #codigoTipoVinculo# 
			and MAE_CLIEN_VINCU.CLIE_OID_CLIE_VNTE = clientes.OID_CLIE
			<!--
			<![CDATA[  
			AND (   inscritas.FEC_ULTI_ACTU > #fechaInicioUltimoProceso#
		         OR MAE_CLIEN_DATOS_ADICI.FEC_ULTI_ACTU > #fechaInicioUltimoProceso#
		         OR NVL(cliTelefono.FEC_ULTI_ACTU, #fechaInicioUltimoProceso#) > #fechaInicioUltimoProceso# 
		         OR NVL(cliEmail.FEC_ULTI_ACTU, #fechaInicioUltimoProceso#) > #fechaInicioUltimoProceso# 
                 OR NVL(cliCelular.FEC_ULTI_ACTU, #fechaInicioUltimoProceso#) > #fechaInicioUltimoProceso#
		        ) 
		 	]]>	
		-->
	</select>
	
	<parameterMap id="actualizaOCSConsultorasInactivasParams" class="map" >
        <parameter property="codigoPais"   		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
    </parameterMap>

    <procedure id="actualizaOCSConsultorasInactivas" parameterMap="actualizaOCSConsultorasInactivasParams" >
        {call OCR_SOLIC_PEDIDOS.OCR_PR_ACT_IND_CONT_ACT(?)}
    </procedure>

	<!-- Inicio Ejecutivo Virtual -->
	<parameterMap id="mapUpdateInterfazEVIRecepcionarOCSaldoDeudor" class="map" >
        <parameter property="codigoPais"   		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
    </parameterMap>

    <procedure id="updateInterfazEVIRecepcionarOCSaldoDeudor" parameterMap="mapUpdateInterfazEVIRecepcionarOCSaldoDeudor" >
        {call GEN_PKG_GENER.GEN_PR_ACTUA_VALOR_SALDO_DEUDO(?)}
    </procedure>
    
    <parameterMap id="mapInsertInterfazEVIRecepcionarOC" class="map" >
        <parameter property="codigoPais"		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="periodo"			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoCliente" 	jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="tipoOC"	 		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="fecha" 			jdbcType="DATE"    javaType="java.util.Date"   mode="IN"/>
    </parameterMap>
	
	<procedure id="insertInterfazEVIRecepcionarOC" parameterMap="mapInsertInterfazEVIRecepcionarOC">
		{call EVI_PKG_EJECU_VIRTU.EVI_PR_INSER_REGIS_ARCHI_MICA(?, ?, ?, ?, ?)}
	</procedure>

	
	<select id="getInterfazEVIRecepcionarPrimerosPedidos" parameterClass="java.util.Map" resultMap="interfazEVIRecepcionarPrimerosPedidosResult">	
		SELECT T.COD_ZONA,
		       T.FEC_RECE,
		       T.COD_PERI,
               T.NUM_LOTE,
		       T.NUM_PRIM_PEDI,
               #codigoPais# COD_PAIS
		  FROM INT_EVI_RECEP_PRIME_PEDID T
		  <dynamic prepend="WHERE">
			  <isNotEmpty prepend="AND" property="codigoZona">					
			  		T.COD_ZONA = #codigoZona#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="fecha">					
			  		T.FEC_RECE = #fecha#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="periodo">					
			  		T.COD_PERI = #periodo#
			  </isNotEmpty>
              AND T.NUM_LOTE = (SELECT NUM_LOTE 
                                FROM BAS_CTRL_FACT 
                                WHERE COD_PAIS = #codigoPais#
                                  AND COD_PERI = #periodo#)
		  </dynamic>
	</select>
	
	<insert id="insertInterfazEVIRecepcionarPrimerosPedidos" parameterClass="java.util.Map">
		INSERT INTO INT_EVI_RECEP_PRIME_PEDID (
        COD_ZONA, 
        FEC_RECE, 
        COD_PERI,
        NUM_LOTE, 
        NUM_PRIM_PEDI)
		VALUES (
        #codigoZona#, 
        #fecha#, 
        #periodo#, 
        (SELECT NUM_LOTE 
        FROM BAS_CTRL_FACT 
        WHERE COD_PAIS = #codigoPais#
          AND COD_PERI = #periodo#),
        #numeroPrimerosPedidos#)
	</insert>
	
    <update id="updateInterfazEVIRecepcionarPrimerosPedidos" parameterClass="java.util.Map">
		UPDATE INT_EVI_RECEP_PRIME_PEDID
		   SET NUM_PRIM_PEDI = #numeroPrimerosPedidos#
		WHERE COD_ZONA = #codigoZona# 
        AND FEC_RECE = #fecha# 
        AND COD_PERI = #periodo#
        AND NUM_LOTE = (SELECT NUM_LOTE 
                        FROM BAS_CTRL_FACT 
                        WHERE COD_PAIS = #codigoPais#
                          AND COD_PERI = #periodo#)
    </update>
    
    <procedure id="cargarResumenesPrefacturacion">
        {call EVI_PKG_EJECU_VIRTU.EVI_PR_CARGA_RESUM_PRE_FACTU}
    </procedure>

	<parameterMap id="mapCargarFacturacion" class="map" >
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoNuevoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
    </parameterMap>

    <procedure id="cargarFacturacionCabecera" parameterMap="mapCargarFacturacion" >
        {call EVI_PKG_EJECU_VIRTU.EVI_PR_CARGA_FACTU_CABEC(?,?,?,?,?)}
    </procedure>    

    <procedure id="cargarFacturacionDetalle" parameterMap="mapCargarFacturacion" >
        {call EVI_PKG_EJECU_VIRTU.EVI_PR_CARGA_FACTU_DETAL(?,?,?,?,?)}
    </procedure>    

	<select id="getInterfazEVIPrefacturacionCabecera" parameterClass="java.util.Map" resultMap="interfazEVIPrefacturacionCabeceraResult">
		SELECT #codigoPais# as CODIGO_PAIS,
		t1.COD_PERI as CODIGO_PERIODO, 
		t1.COD_REGI as CODIGO_REGION, 
		t1.COD_ZONA as CODIGO_ZONA, 
		t1.NUM_PEDI_REAL as PEDIDOS_RECIBIDOS, 
		t1.VAL_PORC_RECE as PORCENTAJE_RECEPCION,  
		t1.NUM_PRIM_PEDI  as PRIMEROS_PEDIDOS,
		t1.NUM_PEDI_RECH as PEDIDIOS_RETENIDOS, 
		t1.NUM_PEDI_ESTI as ESTIMADOS_PEDIDOS  
        FROM INT_EVI_PERIO_REGIO_ZONA t1
		WHERE t1.COD_PERI = ( 
            SELECT MAX(t2.COD_PERI) FROM INT_EVI_PERIO_REGIO_ZONA t2 
            WHERE t2.COD_ZONA = t1.COD_ZONA 
            AND t2.COD_REGI = t1.COD_REGI 
            AND (t2.COD_PERI =#codigoPeriodo#
            <isNotEmpty prepend="OR" property="codigoNuevoPeriodo">	
                t2.COD_PERI=#codigoNuevoPeriodo#
            </isNotEmpty>)
            )
        ORDER BY COD_PERI, COD_REGI, COD_ZONA		
	</select>	

    <select id="getInterfazEVIPrefacturacionDetalle" parameterClass="java.util.Map" resultMap="interfazEVIPrefacturacionDetalleResult">
        SELECT 
        #codigoPais# as CODIGO_PAIS,
        t1.COD_CLIE as CODIGO_CONSULTORA, 
        t1.VAL_SALD_DEUD as SALDO_CONSULTORA
        FROM INT_SOLIC_CONSO_CABEC t1
        WHERE t1.IND_ERRO_DEUD = '2'	
        AND t1.IND_ERROR_SGPE = '0'
        AND t1.IND_ERRO_REMP = '0'
        AND t1.IND_ADMI_CART != '1'
        AND t1.COD_PERI = ( 
            SELECT MAX(t2.COD_PERI) FROM INT_EVI_PERIO_REGIO_ZONA t2 
            WHERE t2.COD_ZONA = t1.COD_ZONA 
            AND t2.COD_REGI = t1.COD_REGI 
            AND (t2.COD_PERI =#codigoPeriodo#
            <isNotEmpty prepend="OR" property="codigoNuevoPeriodo">	
                t2.COD_PERI=#codigoNuevoPeriodo#
            </isNotEmpty>)
        )
    </select>	


	<select id="getInterfazEVIFacturacionCabecera" parameterClass="java.util.Map" resultMap="interfazEVIFacturacionCabeceraResult">
			SELECT A.COD_PAIS AS CODIGO_PAIS, 
			A.COD_PERI AS CODIGO_PERIODO, 
			A.COD_REGI AS CODIGO_REGION, 
			A.COD_ZONA AS CODIGO_ZONA,  
			A.NUM_PEDI_FACT AS PEDIDOS_FACTURADOS,
			A.NUM_PEDI_RECH AS PEDIDOS_RECHAZADOS, 
			A.NUM_PEDI_ESTI AS ESTIMADO_PEDIDOS, 
			A.VAL_MONT_FACT AS MONTO_FACTURADO,
			A.VAL_MONT_ESTI_VENT AS MONTO_ESTIMADO_VENTA,
			A.VAL_PORC_PEDI_FACT AS PORCENTAJE_PEDIDOS_FACTURADOS	
			FROM 
				INT_EVI_FACTU_CABEC_TEMPO A,
				(				 
					SELECT COD_PAIS, MAX(COD_PERI) PERI, COD_ZONA, COD_REGI
					FROM INT_EVI_FACTU_CABEC_TEMPO  
					GROUP BY COD_PAIS, COD_REGI, COD_ZONA	
				) periodos			 
			WHERE A.COD_PERI = periodos.PERI 
			 	AND A.COD_REGI = periodos.COD_REGI 
			 	AND A.COD_ZONA = periodos.COD_ZONA

	</select>	

    <select id="getInterfazEVIFacturacionDetalle" parameterClass="java.util.Map" resultMap="interfazEVIFacturacionDetalleResult">
	   SELECT A.COD_PAIS AS CODIGO_PAIS, 
	          A.COD_PERI AS CODIGO_PERIODO, 
	          A.COD_CLIE AS CODIGO_CONSULTORA, 
	          A.VAL_SALD AS SALDO_CONSULTORA, 
	          A.COD_MOTI_RECH AS MOTIVO_RECHAZO			
	   FROM INT_EVI_FACTU_DETAL_TEMPO A,
	        (				 
	           SELECT COD_PAIS, MAX(COD_PERI) PERI, COD_CLIE
	           FROM INT_EVI_FACTU_DETAL_TEMPO  
	           GROUP BY COD_PAIS, COD_CLIE	
	        ) periodos			 
	   WHERE A.COD_PERI = periodos.PERI 
	     AND A.COD_CLIE = periodos.COD_CLIE 
	</select>	

    <select id="getInterfazEVIConsultoraCDR" parameterClass="java.util.Map" resultMap="interfazEVIConsultoraCDRResult">
        SELECT 
        COD_PAIS, 
        COD_CLIE, 
        NUM_RECL, 
        RECHAZO_CDR, 
        SUM(SOLES_ACEPTADOS) SOLES_ACEPTADOS FROM (
            SELECT #codigoPais# AS COD_PAIS,
            MAE_CLIEN.COD_CLIE,
            REC_CABEC_RECLA.NUM_RECL,
            CASE
                WHEN (REC_CABEC_RECLA.ESRE_OID_ESTA_RECL = 5)
                THEN ('R')
                ELSE (' ')
                END AS RECHAZO_CDR,
            CASE
    	       WHEN (REC_CABEC_RECLA.ESRE_OID_ESTA_RECL = 5)
    	       THEN (0)
    	       ELSE 
    	       CASE 
    	           <![CDATA[
    	           WHEN (REC_OPERA.COD_OPER <> 'TM')
    	           ]]>
    	           THEN (SUM(REC_LINEA_OPERA_RECLA.IMP_ABON))
    	           ELSE (SUM(REC_LINEA_OPERA_RECLA.IMP_CARG))
    	           END
                END AS SOLES_ACEPTADOS	   
    	   FROM REC_CABEC_RECLA,
    	        MAE_CLIEN,
                MAE_CLIEN_DATOS_ADICI,
    	        REC_OPERA_RECLA,
    	        REC_LINEA_OPERA_RECLA,
    	        SEG_PERIO_CORPO,
    	        CRA_PERIO,
    	        REC_OPERA,
    	        REC_TIPOS_OPERA
    	   WHERE  ((REC_CABEC_RECLA.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
               AND (MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
    	       AND (REC_CABEC_RECLA.OID_CABE_RECL = REC_OPERA_RECLA.CARE_OID_CABE_RECL)
    	       AND (REC_TIPOS_OPERA.OID_TIPO_OPER = REC_OPERA_RECLA.TIOP_OID_TIPO_OPER)
    	       AND (REC_TIPOS_OPERA.ROPE_OID_OPER = REC_OPERA.OID_OPER)
    	       AND (REC_LINEA_OPERA_RECLA.OPRE_OID_OPER_RECL = REC_OPERA_RECLA.OID_OPER_RECL)
    	       AND (REC_CABEC_RECLA.PERD_OID_PERI_RECL = CRA_PERIO.OID_PERI)
    	       AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
               AND (REC_CABEC_RECLA.COD_USUA_INGR != 'CALYPSO')
               AND (REC_CABEC_RECLA.COD_USUA_INGR != 'BELCENTER')
               AND (MAE_CLIEN_DATOS_ADICI.ESTA_OID_ESTA_CLIE != 7)
    	       AND (
    	               (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
    	               <isNotEmpty prepend="OR" property="codigoNuevoPeriodo">					
    	                   (SEG_PERIO_CORPO.COD_PERI = #codigoNuevoPeriodo#)
    	               </isNotEmpty>
    	               )
    	           )
    	   GROUP BY MAE_CLIEN.COD_CLIE, 
                    REC_CABEC_RECLA.NUM_RECL, 
                    REC_CABEC_RECLA.ESRE_OID_ESTA_RECL, 
                    REC_OPERA.COD_OPER
        )
        GROUP BY COD_PAIS, COD_CLIE, NUM_RECL, RECHAZO_CDR
	</select>

	<parameterMap id="mapExecuteInterfazEVIConsultoraPuntaje" class="map" >
		<parameter property="codigoPais"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

	<procedure id="executeInterfazEVIConsultoraPuntaje" parameterMap="mapExecuteInterfazEVIConsultoraPuntaje">
		{call GEN_PKG_INTER_ARCHI.EVI_PR_INTER_CONSU_PUNTA(?, ?, ?, ?, ?)}
	</procedure>	

	<!-- Fin Ejecutivo Virtual -->
	
	<insert id="insertarInterfazRETRecepcionarCOM1" parameterClass="java.util.Map">
	</insert>
	
	<insert id="insertarInterfazRETRecepcionatCOM2" parameterClass="java.util.Map">
	</insert>
	
	<insert id="insertarInterfazRETRecepcionatCOM3" parameterClass="java.util.Map">
	</insert>

   <!-- <parameterMap id="executeInterfazREUEnviarConsultorasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoCliente"		 	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroDiasModificacion"	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="valorPorcentajeDcto"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

	<procedure id="executeInterfazREUEnviarConsultoras"
			  parameterMap="executeInterfazREUEnviarConsultorasParams" >
		{call GEN_PKG_INTER_ARCHI.REU_PR_INTER_CONSU(?,?,?,?,?,?,?)}
	</procedure>
   -->

    <parameterMap id="executeInterfazREUEnviarConsultorasParams" class="map" >
        <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoSistema"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeInterfazREUEnviarConsultoras"
			  parameterMap="executeInterfazREUEnviarConsultorasParams" >
		{call INT_PKG_REUTI.INT_PR_REU_ARCHI_CONSU(?, ?, ?, ?) }
	</procedure>
	
	
    <parameterMap id="executeInterfazREUIdentificarNovedadesParams" class="map" >
		<parameter property="fechaInicioUltimoProceso"   jdbcType="TIMESTAMP"  javaType="java.sql.Timestamp"  mode="IN"/>
    </parameterMap>
	<procedure id="executeInterfazREUIdentificarNovedades"
			  parameterMap="executeInterfazREUIdentificarNovedadesParams" >
		{call INT_PKG_REUTI.INT_PR_REU_CARGA_CONSU_ACTUA(?) }
	</procedure>

    <parameterMap id="executeInterfazREUCargarConsultorasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoMarca"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoCanal"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoTipoCliente"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="valorPorcentajeDcto"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>        
        <parameter property="montoMaximoDeuda"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>        
    </parameterMap>
    
    <procedure id="executeInterfazREUCargarConsultoras"
			  parameterMap="executeInterfazREUCargarConsultorasParams" >
		{call INT_PKG_REUTI.INT_PR_REU_CARGA_CONSU(?, ?, ?, ?, ?, ?) }
	</procedure>

    <parameterMap id="executeInterfazREUCargarConsultorasHistoricoParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoMarca"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoCanal"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoCliente"		 	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="valorPorcentajeDcto"	     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
        <parameter property="montoMaximoDeuda"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>        
    </parameterMap>
    
    <procedure id="executeInterfazREUCargarConsultorasHistorico"
			  parameterMap="executeInterfazREUCargarConsultorasHistoricoParams" >
		{call INT_PKG_REUTI.INT_PR_REU_CARGA_CONSU_HISTO(?, ?, ?, ?, ?, ?) }
    </procedure>

    <update id="updateInterfazREUIndicadorTransferenciaClientes">
        UPDATE INT_REU_CONSU_HISTO
        SET IND_CLIE_TRAN = 1
        WHERE IND_CLIE_TRAN = 0
    </update>

    <parameterMap id="executeInterfazCOBCargarDatosInfocorpParams" class="map" >
        <parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoEntidad"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>     
        <parameter property="campanyaInicial"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="diasVencimiento"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>     
        <parameter property="importe"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>     
    </parameterMap>

    <procedure id="executeInterfazCOBCargarDatosInfocorp"
              parameterMap="executeInterfazCOBCargarDatosInfocorpParams" >
        {call COB_PKG_CLIEN_CASTI.COB_PR_CARGA_CLIEN_CASTI(?, ?, ?, ?, ?)}
    </procedure>
    
    <parameterMap id="executeInterfazCOBEnviarDatosInfocorpParams" class="map" >
		<parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="campanyaInicial"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="diasVencimiento"	 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="importe"	     		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoMovimiento"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoEntidad"	    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoDocTributario"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoPersona"	     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoDeudor"	     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoDocumento"	    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="tipoMoneda"	     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="condicionDeuda"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
    </parameterMap>

	<procedure id="executeInterfazCOBEnviarDatosInfocorp"
			  parameterMap="executeInterfazCOBEnviarDatosInfocorpParams" >
		{call GEN_PKG_INTER_ARCHI.COB_PR_INTER_DATOS_INFOC(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
	</procedure>
	
    <parameterMap id="executeInterfazMYEMovimientosCuentaCorrienteParams" class="map" >
		<parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaInicioUltimoProceso"	 jdbcType="TIMESTAMP" javaType="java.sql.Timestamp"  mode="IN"/>		
    </parameterMap>

	<procedure id="executeInterfazMYEMovimientosCuentaCorriente"
			  parameterMap="executeInterfazMYEMovimientosCuentaCorrienteParams" >
		{call INT_PKG_MYEBE.INT_PR_MYE_MOVIM_CUENT_CORRI(?, ?, ?, ?, ?)}
	</procedure>
	
	<!-- Inicio Proyeccion Parcial -->
  	<resultMap id="interfazPRYEnviarDatosProyeccionParcialResult" class="java.util.HashMap">
		<result property="centroPais" 			column="CEN_PAIS" />
		<result property="codigoPeriodo" 		column="COD_PERI" />
		<result property="fechaFacturacion"		column="FEC_FACT" />
		<result property="codigoRegionZona"		column="COD_REGI_ZONA" />
		<result property="pedidosEstimados"		column="PED_ESTI" />
		<result property="pedidosReales"		column="PED_REAL" />
		<result property="indicadorCierre"		column="IND_CIER" />
  	</resultMap>  
 	
	<select id="getInterfazPRYEnviarDatosProyeccionParcial" parameterClass="java.util.Map" resultMap="interfazPRYEnviarDatosProyeccionParcialResult">	
        SELECT #centroPais# AS CEN_PAIS,
               #codigoPeriodo# AS COD_PERI,
               #fechaS# AS FEC_FACT,														
               <!-- Se cambio la especificacion para que mande solo el COD_ZONA -->
               ZON_ZONA.COD_ZONA AS COD_REGI_ZONA,
               PRY_PKG_PROYE_PARCI.PRY_FN_NUMER_PEDID_ESTIM(#codigoPeriodo#, ZON_REGIO.COD_REGI, ZON_ZONA.COD_ZONA) AS PED_ESTI,
               COUNT(1) AS PED_REAL,
               PRY_PKG_PROYE_PARCI.PRY_FN_INDIC_CIERR(#codigoPeriodo#,
                                                      ZON_REGIO.COD_REGI,
                                                      #codigoPais#) AS IND_CIER
          FROM PED_SOLIC_CABEC,
               PED_ESTAD_SOLIC,
               ZON_ZONA,
               ZON_REGIO,
               CRA_PERIO,
               SEG_MARCA,
               SEG_CANAL,
               PED_TIPO_SOLIC_PAIS,
               PED_TIPO_SOLIC,
               SEG_ACCES
         WHERE PED_SOLIC_CABEC.ESSO_OID_ESTA_SOLI = PED_ESTAD_SOLIC.OID_ESTA_SOLI
           AND PED_SOLIC_CABEC.ZZON_OID_ZONA = ZON_ZONA.OID_ZONA
           AND PED_SOLIC_CABEC.PERD_OID_PERI = CRA_PERIO.OID_PERI
           AND ZON_ZONA.ZORG_OID_REGI = ZON_REGIO.OID_REGI
           AND PED_TIPO_SOLIC_PAIS.OID_TIPO_SOLI_PAIS = PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS
           AND SEG_MARCA.OID_MARC = PED_TIPO_SOLIC.MARC_OID_MARC
           AND PED_TIPO_SOLIC.OID_TIPO_SOLI = PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI
           AND SEG_CANAL.OID_CANA = SEG_ACCES.CANA_OID_CANA
           AND SEG_ACCES.OID_ACCE = PED_TIPO_SOLIC.ACCE_OID_ACCE
           AND PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS IN
               (SELECT OID_TIPO_SOLI FROM INT_PRY_TIPO_SOLIC)
           AND PED_SOLIC_CABEC.PAIS_OID_PAIS = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#)
           AND CRA_PERIO.PERI_OID_PERI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PERIO(#codigoPeriodo#)
           AND PED_SOLIC_CABEC.FEC_FACT = TO_DATE(#fechaFacturacionDate#,'dd/MM/yyyy')														
           AND PED_SOLIC_CABEC.IND_TS_NO_CONSO = 1
           AND PED_SOLIC_CABEC.IND_OC = 1
           AND PED_ESTAD_SOLIC.COD_ESTA_SOLI = 'VA'
           AND SEG_CANAL.COD_CANA = #codigoCanal#
           AND SEG_MARCA.COD_MARC = #codigoMarca#
         GROUP BY COD_REGI,
                  COD_ZONA
        
        UNION
        
        SELECT #centroPais# AS CEN_PAIS,
               #codigoPeriodo# AS COD_PERI,
               #fechaS# AS FEC_FACT,														
               <!-- Se cambio la especificacion para que mande solo el COD_ZONA -->
               ZON_ZONA.COD_ZONA AS COD_REGI_ZONA,
               0 AS PED_ESTI,
               0 AS PED_REAL,
               'X' AS IND_CIER
          FROM FAC_CONTR_CIERR,
               FAC_TIPOS_CIERR,
               PED_SOLIC_CABEC,
               PED_ESTAD_SOLIC,
               ZON_ZONA,
               ZON_REGIO,
               CRA_PERIO,
               SEG_MARCA,
               SEG_CANAL,
               PED_TIPO_SOLIC_PAIS,
               PED_TIPO_SOLIC,
               SEG_ACCES
         WHERE FAC_CONTR_CIERR.TCIE_OID_TIPO_CIER = FAC_TIPOS_CIERR.OID_TIPO_CIER
           AND ZON_ZONA.OID_ZONA = FAC_CONTR_CIERR.ZZON_OID_ZONA
           AND ZON_ZONA.OID_ZONA = PED_SOLIC_CABEC.ZZON_OID_ZONA
           AND ZON_REGIO.OID_REGI = FAC_CONTR_CIERR.ZORG_OID_REGI
           AND ZON_REGIO.OID_REGI = PED_SOLIC_CABEC.ZZON_OID_ZONA
           AND PED_SOLIC_CABEC.ESSO_OID_ESTA_SOLI = PED_ESTAD_SOLIC.OID_ESTA_SOLI
           AND FAC_CONTR_CIERR.PERD_OID_PERI = CRA_PERIO.OID_PERI
           AND PED_TIPO_SOLIC_PAIS.OID_TIPO_SOLI_PAIS = PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS
           AND SEG_MARCA.OID_MARC = PED_TIPO_SOLIC.MARC_OID_MARC
           AND PED_TIPO_SOLIC.OID_TIPO_SOLI = PED_TIPO_SOLIC_PAIS.TSOL_OID_TIPO_SOLI
           AND SEG_CANAL.OID_CANA = SEG_ACCES.CANA_OID_CANA
           AND SEG_ACCES.OID_ACCE = PED_TIPO_SOLIC.ACCE_OID_ACCE
           AND FAC_CONTR_CIERR.PAIS_OID_PAIS = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#)
           AND CRA_PERIO.PERI_OID_PERI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PERIO(#codigoPeriodo#)
           AND FAC_TIPOS_CIERR.COD_TIPO_CIER = 'R'
           AND FAC_CONTR_CIERR.FEC_CIER = TO_DATE(#fechaFacturacionDate#,'dd/MM/yyyy')														
           AND FAC_CONTR_CIERR.VAL_RESU_PROC = 'OK'
           AND PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS IN
               (SELECT OID_TIPO_SOLI FROM INT_PRY_TIPO_SOLIC)
           AND PED_SOLIC_CABEC.IND_TS_NO_CONSO = 0
           AND PED_SOLIC_CABEC.IND_OC = 0
           AND PED_ESTAD_SOLIC.COD_ESTA_SOLI = 'VA'
           AND SEG_CANAL.COD_CANA = #codigoCanal#
           AND SEG_MARCA.COD_MARC = #codigoMarca#
         GROUP BY COD_REGI,
                  COD_ZONA
        
         ORDER BY COD_REGI_ZONA
	 </select>
  
	<resultMap id="interfazPRYEnviarCronogramaFacturacionResult" class="java.util.HashMap">
		<result property="centroPais" 			column="CEN_PAIS" />
		<result property="codigoZona" 			column="COD_ZONA" />
		<result property="codigoPeriodo" 		column="COD_PERI" />
		<result property="fechaFacturacion"		column="FEC_FACT" />
		<result property="fechaProceso"			column="FEC_PROC" />
  	</resultMap>

	<select id="getInterfazPRYEnviarCronogramaFacturacion" parameterClass="java.util.Map" resultMap="interfazPRYEnviarCronogramaFacturacionResult">	
		select #centroPais# AS CEN_PAIS,
			   c.cod_peri COD_PERI,
		       d.cod_zona COD_ZONA,
		       TO_CHAR(a.fec_inic, 'DDMMYYYY') as FEC_FACT,
		       TO_CHAR(SYSDATE, 'DDMMYYYY') as FEC_PROC 
		from cra_crono a, 
		     cra_perio b, 
		     seg_perio_corpo c, 
		     zon_zona d
		where 
		 exists (select null from cra_activ act where act.oid_acti = a.cact_oid_acti and act.cod_acti = 'FA'  )
		and a.perd_oid_peri = b.oid_peri
		and b.peri_oid_peri = c.oid_peri
		and a.zzon_oid_zona = d.oid_zona
		<![CDATA[
		and c.cod_peri >= #codigoPeriodo#
		]]>
		and b.pais_oid_pais = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#)
		and b.marc_oid_marc = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#)
		and b.cana_oid_cana = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#)	
	</select>
	<!-- Fin Proyeccion Parcial -->
	
	<parameterMap id="executeInterfazLLIEnviarVentaPeriodoMap" class="map">
		<parameter property="codigoPais"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="periodo"	     	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazLLIEnviarVentaPeriodo" 
   			  parameterMap="executeInterfazLLIEnviarVentaPeriodoMap" >
		{call INT_PKG_LEADE_LIST.LLI_PR_CARGA_VENTA_PERIO(?,?)}												
    </procedure>
    
    <resultMap id="interfazLLIEnviarVentaPeriodoResult" class="java.util.HashMap">
		<result property="codigoMarca" 			column="COD_MARC" />
		<result property="periodo"	 			column="COD_PERI" />
		<result property="codigoProducto" 		column="COD_PROD" />
		<result property="unidadesVendidas"		column="NUM_UNID_VEND" />
		<result property="ventaNetaReal"		column="IMP_VENT_NETA_ATEN" />
		<result property="unidadesFaltantes"	column="NUM_UNID_FALT" />
		<result property="montoFaltante"		column="IMP_VENT_NETA_FALT" />
		<result property="tipoOferta"			column="COD_TIPO_OFER" />
  	</resultMap>
    
    <select id="getInterfazLLIEnviarVentaPeriodo" parameterClass="java.util.Map" resultMap="interfazLLIEnviarVentaPeriodoResult">	
		SELECT #codigoMarcaLeaderList# AS COD_MARC,
		       #periodo# AS COD_PERI,
		        CASE
                  WHEN LENGTH(T.COD_ANTI) > #numUltimosDigitos# THEN
                    SUBSTR(T.COD_ANTI, LENGTH(T.COD_ANTI) - #numUltimosDigitos# + 1, #numUltimosDigitos#)
                ELSE
                  T.COD_ANTI
                END COD_PROD,
		       T.NUM_UNID_VEND,
		       T.IMP_VENT_NETA_ATEN,
		       T.NUM_UNID_FALT,
		       T.IMP_VENT_NETA_FALT,
		       T.COD_TIPO_OFER
		  FROM INT_LLI_VENTA_PERIO T			
	</select>  
	
    <resultMap id="interfazLAREnviarSecuenciaPedidosResult" class="java.util.HashMap">
        <result property="codigoZona"                column="COD_ZONA" />
        <result property="secuenciaZona"             column="NUM_SECU_ZONA_RUTA" />
        <result property="codigoTerritorio"          column="COD_TERR" />
        <result property="numeroPedido"              column="VAL_NUME_SOLI" />
        <result property="secuenciaPedidoZona"       column="NUM_SECU_FACT_DIAR" />
        <result property="indicadorServicioReclamo"  column="IND_SERV_RECL" />
    </resultMap>
    
    <select id="getInterfazLAREnviarSecuenciaPedidos" parameterClass="java.util.Map" resultMap="interfazLAREnviarSecuenciaPedidosResult">   
	SELECT   ZON_ZONA.COD_ZONA,
			 PED_SOLIC_CABEC_SECUE.NUM_SECU_ZONA_RUTA,
			 ZON_TERRI.COD_TERR,
			 PED_SOLIC_CABEC.VAL_NUME_SOLI,
			 PED_SOLIC_CABEC_SECUE.NUM_SECU_FACT_DIAR,
			 LAR_PKG_LARIS.LAR_FN_IND_SERV_RECL(PED_SOLIC_CABEC.OID_SOLI_CABE, #codigoPeriodo#, #fechaFacturacion#) IND_SERV_RECL
		FROM PED_SOLIC_CABEC,
        	 PED_SOLIC_CABEC_SECUE,
			 ZON_ZONA,
			 ZON_TERRI,
			 CRA_PERIO,
			 SEG_PERIO_CORPO,         
			 INT_LAR_TIPO_SOLICI_PEDIDO_DIS
   	WHERE (  (PED_SOLIC_CABEC.OID_SOLI_CABE = PED_SOLIC_CABEC_SECUE.SOCA_OID_SOLI_CABE)
			  AND (ZON_ZONA.OID_ZONA = PED_SOLIC_CABEC.ZZON_OID_ZONA)
			  AND (ZON_TERRI.OID_TERR = PED_SOLIC_CABEC.TERR_OID_TERR)
			  AND (CRA_PERIO.OID_PERI = PED_SOLIC_CABEC.PERD_OID_PERI)
			  AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
			  AND (PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS = INT_LAR_TIPO_SOLICI_PEDIDO_DIS.TSPA_OID_TIPO_SOLI_PAIS)
			  AND (PED_SOLIC_CABEC.IND_INTE_LARI_GENE = 0)
              AND (PED_SOLIC_CABEC.NUM_UNID_ATEN_TOTA > 0)
			  AND (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
			  AND (PED_SOLIC_CABEC.FEC_FACT IS NOT NULL)
              AND NOT EXISTS (
                  SELECT M.SBTI_OID_SUBT_CLIE
                  FROM MAV_PARAM_GEREN_ZONA M,
                       ZON_ZONA Z
                  WHERE (PED_SOLIC_CABEC.SBTI_OID_SUBT_CLIE = M.SBTI_OID_SUBT_CLIE)
                    AND (PED_SOLIC_CABEC.CLIE_OID_CLIE = Z.CLIE_OID_CLIE)
             )
    )
    UNION ALL
    SELECT   ZON_ZONA.COD_ZONA,
             PED_SOLIC_CABEC_SECUE.NUM_SECU_ZONA_RUTA,
             0 COD_TERR,
             PED_SOLIC_CABEC.VAL_NUME_SOLI,
             PED_SOLIC_CABEC_SECUE.NUM_SECU_FACT_DIAR,
             LAR_PKG_LARIS.LAR_FN_IND_SERV_RECL(PED_SOLIC_CABEC.OID_SOLI_CABE, #codigoPeriodo#, #fechaFacturacion#) IND_SERV_RECL
        FROM PED_SOLIC_CABEC,
             PED_SOLIC_CABEC_SECUE,
             ZON_ZONA,
             CRA_PERIO,
             SEG_PERIO_CORPO,         
             INT_LAR_TIPO_SOLICI_PEDIDO_DIS
       WHERE (  (PED_SOLIC_CABEC.OID_SOLI_CABE = PED_SOLIC_CABEC_SECUE.SOCA_OID_SOLI_CABE)
              AND (PED_SOLIC_CABEC.CLIE_OID_CLIE = ZON_ZONA.CLIE_OID_CLIE)
              AND (CRA_PERIO.OID_PERI = PED_SOLIC_CABEC.PERD_OID_PERI)
              AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
              AND (PED_SOLIC_CABEC.TSPA_OID_TIPO_SOLI_PAIS = INT_LAR_TIPO_SOLICI_PEDIDO_DIS.TSPA_OID_TIPO_SOLI_PAIS)
              AND (PED_SOLIC_CABEC.IND_INTE_LARI_GENE = 0)
              AND (PED_SOLIC_CABEC.NUM_UNID_ATEN_TOTA > 0)
              AND (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
              AND (PED_SOLIC_CABEC.FEC_FACT IS NOT NULL)
              AND EXISTS (
                  SELECT M.SBTI_OID_SUBT_CLIE
                  FROM MAV_PARAM_GEREN_ZONA M,
                       ZON_ZONA Z
                  WHERE (PED_SOLIC_CABEC.SBTI_OID_SUBT_CLIE = M.SBTI_OID_SUBT_CLIE)
                    AND (PED_SOLIC_CABEC.CLIE_OID_CLIE = Z.CLIE_OID_CLIE)
              )
			 )
	ORDER BY 2, 5
    </select> 
	<select id="getCodigoPeriodoByConcurso" parameterClass="java.util.Map" resultClass="string">
	SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_DES_PERIO(calif.perd_oid_peri_desd  ) 
      FROM INC_PARAM_CALIF calif,
      	INC_CONCU_PARAM_GENER concurso
      WHERE
      copa_oid_para_gral =concurso.oid_para_gral AND
      	concurso.num_conc =#codigoConcurso#
	</select>
	<select id="getOidSubTipoClienteByTipoCliente" parameterClass="java.util.Map" resultClass="string">
			select  st.oid_subt_clie 
            from  	mae_subti_clien st                     
            where 	st.cod_subt_clie = #codigoSubTipoCliente# and 
                    st.ticl_oid_tipo_clie =  #oidTipoCliente#
	</select>
	<select id="getOidTipoClienteByTipoCliente" parameterClass="java.util.Map" resultClass="string">
			select tc.oid_tipo_clie 
			  from mae_tipo_clien tc 
		     where tc.cod_tipo_clie = #codigoTipoCliente#
	</select>
	<select id="getOidSubTipoClasificacionByTipoCliente" parameterClass="java.util.Map" resultClass="string">
	select tcf.oid_tipo_clas 
	  from mae_tipo_clasi_clien tcf 
      where tcf.cod_tipo_clas = #codigoTipoClasificacion# and 
            tcf.sbti_oid_subt_clie = #oidSubTipoCliente# and 
            st.ticl_oid_tipo_clie =  #oidTipoCliente#
	</select>
	<select id="getOidTipoClasificacionByTipoCliente" parameterClass="java.util.Map" resultClass="string">
	select  cls.oid_clas 
	from 	mae_clasi cls 
    where cls.cod_clas = #codigoClasificacion# and 
    	  cls.tccl_oid_tipo_clas = #oidSubTipoClasificacion#
	</select>
    <parameterMap id="executeActualizaNumeroLoteMicaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeActualizaNumeroLoteMica" 
   			  parameterMap="executeActualizaNumeroLoteMicaParams" >
		{call GEN_PKG_GENER.GEN_PR_UPD_LOTE_SGTE_MICA(?)}
    </procedure>  
    
	 <parameterMap id="executeInterfazSICEnviarInscritasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"				     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoVinculo"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoClasificacion"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoClasificacion"	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoTipoCliente"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSubTipoCliente"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>
	<procedure id="executeInterfazSICEnviarInscritas" 
   			  parameterMap="executeInterfazSICEnviarInscritasParams" >
		{call INT_PKG_ECOMM.INT_PR_ECO_ENVI_INSC(?,?,?,?,?,?,?,?,?,?,?,?,?)}
    </procedure>  
	
	<select id="getNumeroLoteIntHistoLotes" parameterClass="java.util.Map" resultClass="string">
        select MAX(num_lote)
		from int_histo_lotes t
		WHERE substr(t.cod_inte,0,4)= #prefijoInterfaz#
    </select>
	
	 <parameterMap id="executeInterfazOCREnviarMatrizParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"				 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodoDesde"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodoHasta"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeInterfazOCREnviarMatriz" 
   			  parameterMap="executeInterfazOCREnviarMatrizParams" >
		{call INT_PKG_PEDID.INT_PR_PED_ENVI_MATR(?,?,?,?,?,?,?,?,?)} 
    </procedure> 
	
	<parameterMap id="executeInterfazIVREnviarMaestroClientesParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"				 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoTipoCliente"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoBloqueo"	         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>
	<procedure id="executeInterfazIVREnviarMaestroClientes" 
   			  parameterMap="executeInterfazIVREnviarMaestroClientesParams" >
		{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_MAES_CLIE(?,?,?,?,?,?,?)} 
    </procedure> 
	
	<parameterMap id="executeInterfazIVREnviarConcursosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeInterfazIVREnviarConcursos" 
   			  parameterMap="executeInterfazIVREnviarConcursosParams" >
		{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_CONCU(?,?,?,?)} 
    </procedure> 

	<parameterMap id="executeInterfazIVREnviarBasesIncumplidasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeInterfazIVREnviarBasesIncumplidas" 
   			  parameterMap="executeInterfazIVREnviarBasesIncumplidasParams" >
		{call INT_PKG_IVVRR.INT_PR_IVR_BASE_INCU(?,?,?,?)} 
    </procedure> 

	<parameterMap id="executeInterfazIVREnviarNivelesParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeInterfazIVREnviarNiveles" 
   			  parameterMap="executeInterfazIVREnviarNivelesParams" >
		{call INT_PKG_IVVRR.INT_PR_IVR_NIVE_CONC(?,?,?,?)} 
    </procedure> 

	<parameterMap id="executeInterfazIVREnviarPremiosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeInterfazIVREnviarPremios" 
   			  parameterMap="executeInterfazIVREnviarPremiosParams" >
		{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_PREM_CONC(?,?,?,?)} 
    </procedure> 

	 <parameterMap id="executeInterfazCOMEnviarArchivoAdamParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"				 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoComision"	         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaProcesoInicio"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="fechaProcesoFin"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodoProceso1"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodoProceso2"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="indicador"		             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>				
    </parameterMap>

	<procedure id="executeInterfazCOMEnviarArchivoAdam" 
   			  parameterMap="executeInterfazCOMEnviarArchivoAdamParams" >
		{call INT_PKG_COMIS.INT_PR_COM_ADAM_MODIF(?,?,?,?,?,?,?,?,?,?,?)} 												
    </procedure> 
	
   <parameterMap id="executeInterfazECOEnviarVentaBaseConsultorasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

	<procedure id="executeInterfazECOEnviarVentaBaseConsultoras" 
   			  parameterMap="executeInterfazECOEnviarVentaBaseConsultorasParams" >
		{call INT_PKG_ECOMM.INT_PR_ECO_VENTA_BASE_CONSU(?,?,?,?)} 
    </procedure> 

	<parameterMap id="executeInterfazECOEnviarVentasPuntajesxCampanyaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"				 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoVinculo"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoClasificacion"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoTipoClasificacion"	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoTipoCliente"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSubTipoCliente"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="oidParametroGeneral"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>				
		<parameter property="fechaActual"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>					
    </parameterMap>		 
  
	<procedure id="executeInterfazECOEnviarVentasPuntajesxCampanya" 
   			  parameterMap="executeInterfazECOEnviarVentasPuntajesxCampanyaParams" >
		{call INT_PKG_ECOMM.INT_PR_ECO_VENTA_PUNT_CAMPA(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)} 
    </procedure>

	<select id="getOidConcursoByNumConcursoGenerico" parameterClass="java.util.Map" resultClass="string">
		SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PARA_GRAL(#numeroConcurso#) FROM DUAL
	</select>
	<select id="getFechaActualBycodigoConcurso" parameterClass="java.util.Map" resultClass="string">
		SELECT to_char(cra_perio.fec_inic,'dd/mm/yyyy') FROM cra_perio	WHERE cra_perio.oid_peri = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#)
	</select>
   <!--  INSERCION -PARAMETROS MULTIPLES DE INTERFACES -->
	<delete id="deleteInterGttParametros" parameterClass="java.util.Map">
	    DELETE FROM INT_GTT_PARAM_INTER 
		WHERE 
			 COD_INTE      = #codigoInterfaz# 
			<isNotEmpty prepend="AND" property="codigoParametro">
			COD_PARA  = #codigoParametro# 
			</isNotEmpty> 		
	</delete>
    <insert id="insertInterGttParametros" parameterClass="java.util.Map">
	    INSERT INTO INT_GTT_PARAM_INTER (
		COD_INTE        ,
 		COD_PARA      
		<isNotEmpty  property="parametroString">
		,VAL_PARA_VARC 
		</isNotEmpty> 	
		<isNotEmpty  property="parametroNumerico">
		,VAL_PARA_NUMB  
		</isNotEmpty> 
		) 
	    VALUES 
	    (
		#codigoInterfaz#,
		#codigoParametro#
		<isNotEmpty  property="parametroString">
		,#parametroString#
		</isNotEmpty> 	
		<isNotEmpty  property="parametroNumerico">
		,#parametroNumerico#
		</isNotEmpty> 	
	    )
	</insert>
	
	
	<!--  INSERCION -PARAMETROS MULTIPLES DE INTERFACES -->
	<delete id="deleteInterTmpParametros" parameterClass="java.util.Map">
	    DELETE FROM INT_TMP_PARAM_INTER 
		WHERE 
			 COD_INTE      = #codigoInterfaz# 
			<isNotEmpty prepend="AND" property="codigoParametro">
			COD_PARA  = #codigoParametro# 
			</isNotEmpty> 		
	</delete>
    <insert id="insertInterTmpParametros" parameterClass="java.util.Map">
	    INSERT INTO INT_TMP_PARAM_INTER (
		COD_INTE        ,
 		COD_PARA      
		<isNotEmpty  property="parametroString">
		,VAL_PARA_VARC 
		</isNotEmpty> 	
		<isNotEmpty  property="parametroNumerico">
		,VAL_PARA_NUMB  
		</isNotEmpty> 
		) 
	    VALUES 
	    (
		#codigoInterfaz#,
		#codigoParametro#
		<isNotEmpty  property="parametroString">
		,#parametroString#
		</isNotEmpty> 	
		<isNotEmpty  property="parametroNumerico">
		,#parametroNumerico#
		</isNotEmpty> 	
	    )
	</insert>	

	
  <parameterMap id="interfazLLIEnviarVentaRealDiariaAcumuladaParams" class="map" >
		<parameter property="codigoPais"        		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacionInicial"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacionFinal"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoMarcaLeaderList"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    <parameter property="numUltimosDigitos"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  
   <procedure id="executeInterfazLLIEnviarVentaRealDiariaAcumulada" 
   parameterMap="interfazLLIEnviarVentaRealDiariaAcumuladaParams"  >	  
		{call INT_PKG_LEADE_LIST.INT_PR_LLI_ENVIO_VREAL_DIARI(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
   </procedure>
  
   <!-- INTERFAZ - OCR - ENVIAR RANGOS PERIODO -->
  <select id="getInterfazOCREnviarRangosPeriodo" parameterClass="java.util.Map" resultMap="interfazOCREnviarRangosPeriodoResult">
           SELECT DISTINCT #codigoPais# CODIGOPAIS,
       	     FIRST_VALUE(b.cod_peri) OVER(ORDER BY b.cod_peri ASC ROWS UNBOUNDED PRECEDING) CODIGOPERIODOINICIO,
             FIRST_VALUE(b.cod_peri) OVER(ORDER BY b.cod_peri DESC ROWS UNBOUNDED PRECEDING) CODIGOPERIODOFIN,
      		 SYSDATE FECHA
	       FROM CRA_PERIO A, SEG_PERIO_CORPO B
		   WHERE A.PAIS_OID_PAIS = gen_pkg_gener.gen_fn_devuelve_id_pais(#codigoPais#)
		     AND A.MARC_OID_MARC = gen_pkg_gener.gen_fn_devuelve_id_marca(#codigoMarca#) 
    	     AND A.CANA_OID_CANA = gen_pkg_gener.gen_fn_devuelve_id_canal(#codigoCanal#)
			<![CDATA[
                AND A.FEC_INIC <= TRUNC(SYSDATE)  AND A.FEC_FINA >= TRUNC(SYSDATE)
            ]]>
	        AND B.OID_PERI = A.PERI_OID_PERI			
  </select>
  
  <!-- INTERFAZ - DAT - ENVIAR CANALES DE VENTA -->
  <parameterMap id="executeInterfazDATEnviarCanalesVentaParams" class="map">
	<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoIso"		             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
 </parameterMap>
  <procedure id="executeInterfazDATEnviarCanalesVenta" parameterMap="executeInterfazDATEnviarCanalesVentaParams">
			{call INT_PKG_DATAM.INT_PR_DAT_CANAL_VENTA(?,?,?,?,?,?)}			
  </procedure>
  
   <!-- INTERFAZ - DAT - ENVIAR MAESTRO DE ZONAS -->
   <parameterMap id="executeInterfazDATEnviarMaestroZonasParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroZonas" parameterMap="executeInterfazDATEnviarMaestroZonasParams">
			{call INT_PKG_DATAM.INT_PR_DAT_MAEST_ZONA(?,?,?,?,?,?)}			
  </procedure>

  <!-- INTERFAZ - DAT - ENVIAR MAESTRO DE MARCAS -->
  <parameterMap id="executeInterfazDATEnviarMaestroMarcasProductoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroMarcasProducto" parameterMap="executeInterfazDATEnviarMaestroMarcasProductoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_MAEST_MARCA(?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR IMPUESTOS POR PRODUCTO -->
  <parameterMap id="executeInterfazDATEnviarImpuestosProductoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarImpuestosProducto" parameterMap="executeInterfazDATEnviarImpuestosProductoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_IMPUE_PRODU(?,?,?,?,?,?)}			
  </procedure>
  
 <!-- INTERFAZ - DAT - ENVIAR MAESTROS DE PRODUCTOS -->
  <parameterMap id="executeInterfazDATEnviarMaestroProductosParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoIso"		             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroProductos" parameterMap="executeInterfazDATEnviarMaestroProductosParams">
			{call INT_PKG_DATAM.INT_PR_DAT_MAEST_PRODU(?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR MAESTROS ESTADOS DE COBRANZA -->
  <parameterMap id="executeInterfazDATEnviarMaestroEstadosCobranzaParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroEstadosCobranza" parameterMap="executeInterfazDATEnviarMaestroEstadosCobranzaParams">
			{call INT_PKG_DATAM.INT_PR_DAT_MAEST_ESTAD_COBRA(?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR CDR POR CONSULTORA -->
  <parameterMap id="executeInterfazDATEnviarCDRConsultoraParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoModulo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="estadoOperacion"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarCDRConsultora" parameterMap="executeInterfazDATEnviarCDRConsultoraParams">
			{call INT_PKG_DATAM.INT_PR_DAT_ESTAD_CDRS_CONSU(?,?,?,?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR SALDOS PROMEDIO POR PERIODO -->
  <parameterMap id="executeInterfazDATEnviarSaldoPromedioPeriodoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoModulo"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarSaldoPromedioPeriodo" parameterMap="executeInterfazDATEnviarSaldoPromedioPeriodoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_SALDOS_PROME_CAMPA(?,?,?,?,?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR ESTADOS DE CONSULTORAS AL CIERRE DE PERIODO -->
  <parameterMap id="executeInterfazDATEnviarEstadosConsultoraCierrePeriodoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoModulo"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="oidTipoCliente"		     jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
	<parameter property="oidTipoClasifCliente"       jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
	<parameter property="oidClasifCliente"		     jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
	<parameter property="codigoClasifCyzone"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoTipoClasifCyzone"     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
   
  </parameterMap>
  <procedure id="executeInterfazDATEnviarEstadosConsultoraCierrePeriodo" parameterMap="executeInterfazDATEnviarEstadosConsultoraCierrePeriodoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_ESTAT_CONSU_CIERR(?,?,?,?,?,?,?,?,?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR MAESTRO TIPOS DE DOCUMENTO DE PEDIDO -->
  <parameterMap id="executeInterfazDATEnviarMaestroTiposDocumentoPedidoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>  
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroTiposDocumentoPedido" parameterMap="executeInterfazDATEnviarMaestroTiposDocumentoPedidoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_TIPOS_DOCUM_PEDID(?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR MAESTRO TIPOS DE DOCUMENTO DE PEDIDO -->
  <parameterMap id="executeInterfazDATEnviarMaestroConcursosParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoIso"		             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>  
	<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/> 
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroConcursos" parameterMap="executeInterfazDATEnviarMaestroConcursosParams">
			{call INT_PKG_DATAM.INT_PR_DAT_MAEST_CONCU(?,?,?,?,?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR VENTAS POR SECCIN Y PERIODO -->
  <parameterMap id="executeInterfazDATEnviarVentaSeccionPeriodoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>  
	  </parameterMap>
  <procedure id="executeInterfazDATEnviarVentaSeccionPeriodo" parameterMap="executeInterfazDATEnviarVentaSeccionPeriodoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_VENTA_SECCI_PERIO(?,?,?,?,?,?,?)}			
  </procedure>
  
  <resultMap id="interfazDATEnviarPaisResult" class="java.util.HashMap">
    <result property="codigoPais"           column="COD_PAIS"/>
    <result property="descripcionPais"      column="DES_PAIS"/>
    <result property="flagControl"          column="FLA_CONT"/>
  </resultMap>

  <select id="getInterfazDATEnviarPais" parameterClass="java.util.Map" resultMap="interfazDATEnviarPaisResult">
    SELECT COD_PAIS,
           DES_PAIS,
		   '0' AS FLA_CONT
      FROM BAS_PAIS
	<![CDATA[
      WHERE EST_PAIS <> '9'
    ]]>
      ORDER BY COD_PAIS
  </select>

  <resultMap id="interfazDATEnviarProgramaResult" class="java.util.HashMap">
    <result property="codigoPais"           column="PAIS_COD_PAIS"/>
	<result property="codigoEmpresa"        column="EMCO_COD_EMPR_COME"/>
	<result property="codigoPrograma"       column="COD_PROG_CAPA"/>
    <result property="descripcionPrograma"  column="DES_PROG_CAPA"/>
    <result property="flagControl"          column="FLA_CONT"/>
  </resultMap>

 <select id="getInterfazDATEnviarPrograma" parameterClass="java.util.Map" resultMap="interfazDATEnviarProgramaResult">
    SELECT  PAIS_COD_PAIS,
            EMCO_COD_EMPR_COME,
			COD_PROG_CAPA,
			DES_PROG_CAPA,
		    '0' AS FLA_CONT
      FROM EDU_PARAM_PROGR_CAPAC
	<![CDATA[
      WHERE EST_REGI <> '9'
    ]]>
      ORDER BY PAIS_COD_PAIS, EMCO_COD_EMPR_COME, COD_PROG_CAPA
  </select>

  <resultMap id="interfazDATEnviarEmpresaResult" class="java.util.HashMap">
    <result property="codigoPais"           column="PAIS_COD_PAIS"/>
	<result property="codigoEmpresa"        column="COD_EMPR_COME"/>
    <result property="descripcionEmpresa"   column="DES_EMPR_COME"/>
    <result property="flagControl"          column="FLA_CONT"/>
  </resultMap>

  <select id="getInterfazDATEnviarEmpresa" parameterClass="java.util.Map" resultMap="interfazDATEnviarEmpresaResult">
    SELECT  PAIS_COD_PAIS,
            COD_EMPR_COME,
			DES_EMPR_COME,
		    '0' AS FLA_CONT
      FROM EDU_EMPRE_COMER
	<![CDATA[
      WHERE EST_REGI <> '9'
    ]]>
      ORDER BY PAIS_COD_PAIS, COD_EMPR_COME
  </select>

  <resultMap id="interfazDATEnviarCursosResult" class="java.util.HashMap">
    <result property="codigoPais"           column="PAIS_COD_PAIS"/>
	<result property="desNivelVenta"        column="DES_NIVE_VENT"/>
    <result property="desFrecuencia"   		column="DES_FREC_CALI"/>
    <result property="desAmbitoDictado"   	column="DES_AMBI_DICT"/>
    <result property="desSecuenciaPedido"   column="DES_SECU_PEDI"/>
	<result property="codigoEmpresa"   		column="EMCO_COD_EMPR_COME"/>
	<result property="codigoCurso"   		column="COD_CURS_CAPA"/>
    <result property="descripcionCurso"   	column="NOM_CURS_CAPA"/>
	<result property="siglaCurso"   		column="SIG_CURS_CAPA"/>
    <result property="objetivoCurso"   		column="OBJ_CURS_CAPA"/>
	<result property="annoCampannaInicioCurso"   column="CAM_INIC"/>
    <result property="numCampanna"   		column="NUM_CAMP"/>
	<result property="indicadorAptaPrimerPedido"   column="STA_CLIE"/>													
    <result property="duracionSesion"   	column="DUR_CURS_SESI"/>
	<result property="requisito"   			column="PRE_REQU_CAPA"/>
	<result property="numCampaRequisito"   	column="NUM_CAMP_CUMP_PREQ"/>
	<result property="numCampannaEvaluar"   column="NUM_CAMP_EVAL"/>
	<result property="numPedidoRequisito"   column="NUM_PEDI_REQU"/>
	<result property="indicadorControlMorosidad"   column="IND_CTRL_MORO"/>
	<result property="indicadorExonerada"   column="IND_EXON_ASIS"/>
	<result property="indicadorCostoCurso"  column="IND_COST_CURS"/>
	<result property="numCampaMaxAsistencia" column="NUM_CAMP_MAXI_ASRE"/>
	<result property="indicadorInvitacion"   column="IND_INVI_CURS"/>
    <result property="indicadorExtemporaneo" column="IND_DICT_EXMA"/>
	<result property="numCampaPreviaApta"   column="NUM_CAMP_PREV_CALI"/>
	<result property="estadoCurso"   		column="EST_CURS_CAPA"/>
	<result property="indicadorRegalo"   	column="IND_REGA_ASIS_CURS"/>
	<result property="indicadorCaliCapacitada"   column="IND_CALI_CTDA"/>
	<result property="indicadorCaliCapacitadora" column="IND_CALI_CDRA"/>
    <result property="flagControl"          column="FLA_CONT"/>
  </resultMap>

  <select id="getInterfazDATEnviarCursos" parameterClass="java.util.Map" resultMap="interfazDATEnviarCursosResult">
    SELECT  A.PAIS_COD_PAIS,
            D.DES_NIVE_VENT,          
			C.DES_FREC_CALI,          
			B.DES_AMBI_DICT,          
			E.DES_SECU_PEDI,          
			A.EMCO_COD_EMPR_COME,     
			A.COD_CURS_CAPA,          
			A.NOM_CURS_CAPA,          
			A.SIG_CURS_CAPA,          
			A.OBJ_CURS_CAPA,          
			A.CAM_INIC,               
			A.NUM_CAMP,               
			A.STA_CLIE,											
			A.DUR_CURS_SESI,          
			A.PRE_REQU_CAPA,          
			A.NUM_CAMP_CUMP_PREQ,     
			A.NUM_CAMP_EVAL,          
			A.NUM_PEDI_REQU,          
			A.IND_CTRL_MORO,          
			A.IND_EXON_ASIS,          
			A.IND_COST_CURS,          
			A.NUM_CAMP_MAXI_ASRE,     
			A.IND_INVI_CURS,          
			A.IND_DICT_EXMA,          
			A.NUM_CAMP_PREV_CALI,     
			A.EST_CURS_CAPA,          
			A.IND_REGA_ASIS_CURS,     
			A.IND_CALI_CTDA,          
			A.IND_CALI_CDRA,          
		    '0' AS FLA_CONT
      FROM  EDU_PARAM_CURSO_CAPAC A,
			EDU_AMBIT_DICTA B,
			EDU_FRECU_CALIF C,
			EDU_NIVEL_VENTA D,
			EDU_SECUE_PEDID E
			
	<![CDATA[
      WHERE A.EST_REGI <> '9'
		AND A.PAIS_COD_PAIS = #codigoPais#
		AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
		AND B.COD_AMBI_DICT = A.AMDI_COD_AMBI_DICT
		AND C.COD_FREC_CALI = A.FRCA_COD_FREC_CALI
		AND D.COD_NIVE_VENT = A.NIVE_COD_NIVE_VENT
		AND E.COD_SECU_PEDI = A.SEPE_COD_SECU_PEDI
    ]]>
      ORDER BY A.PAIS_COD_PAIS, A.EMCO_COD_EMPR_COME, A.COD_CURS_CAPA
  </select>


  <resultMap id="interfazDATEnviarInstructorasResult" class="java.util.HashMap">
    <result property="codigoPais"           column="PAIS_COD_PAIS"/>
	<result property="codigoEmpresa"   		column="EMCO_COD_EMPR_COME"/>
	<result property="codigoRegion"         column="COD_REGI"/>
    <result property="codigoInstructora"   	column="COD_INST"/>
    <result property="apellidoPaterno"   	column="APE_PATE"/>
    <result property="apellidoMaterno"   	column="APE_MATE"/>
	<result property="nombre"   			column="PRI_NOMB"/>
    <result property="annoCampannaIngreso"  column="CAM_INGR"/>
	<result property="fechaIngreso"   		column="FEC_INGR"/>
    <result property="annoCampannaRetiro"   column="CAM_RETI"/>
    <result property="fechaRetiro"          column="FEC_RETI"/>
    <result property="estadoInstructora"    column="SIT_INST"/>
	<result property="email"          		column="EMA_INST"/>
	<result property="flagControl"          column="FLA_CONT"/>
  </resultMap>

  <select id="getInterfazDATEnviarInstructoras" parameterClass="java.util.Map" resultMap="interfazDATEnviarInstructorasResult">
    SELECT  PAIS_COD_PAIS,
            EMCO_COD_EMPR_COME,
			EDU_PKG_PROCE_GENER.EDU_FN_DEVUE_REGIO_INSTR(PAIS_COD_PAIS, EMCO_COD_EMPR_COME, COD_INST)  AS COD_REGI,
			COD_INST,
			APE_PATE,
			APE_MATE,
			PRI_NOMB,
			CAM_INGR,
			TO_CHAR(FEC_INGR,'YYYYMMDD'),
			CAM_RETI,
			TO_CHAR(FEC_RETI,'YYYYMMDD'),
			SIT_INST,
			EMA_INST,
		    '0' AS FLA_CONT
      FROM EDU_MAEST_INSTR
	<![CDATA[
      WHERE EST_REGI <> '9'
		AND PAIS_COD_PAIS = #codigoPais#
		AND EMCO_COD_EMPR_COME = #codigoEmpresa#
    ]]>
      ORDER BY PAIS_COD_PAIS, EMCO_COD_EMPR_COME, COD_INST
  </select>

  <resultMap id="interfazDATEnviarInstructoraGeografiaResult" class="java.util.HashMap">
    <result property="codigoPais"           column="PAIS_COD_PAIS"/>
	<result property="codigoEmpresa"   		column="EMCO_COD_EMPR_COME"/>
	<result property="codigoRegion"         column="COD_REGI"/>
    <result property="codigoInstructora"   	column="COD_INST"/>
	<result property="flagControl"          column="FLA_CONT"/>
  </resultMap>

  <select id="getInterfazDATEnviarInstructoraGeografia" parameterClass="java.util.Map" resultMap="interfazDATEnviarInstructoraGeografiaResult">
    SELECT  PAIS_COD_PAIS,
            EMCO_COD_EMPR_COME,
			COD_REGI,
			INST_COD_INST,
		    '0' AS FLA_CONT
      FROM EDU_REGIO
	<![CDATA[
      WHERE EST_REGI <> '9'
		AND PAIS_COD_PAIS = #codigoPais#
		AND EMCO_COD_EMPR_COME = #codigoEmpresa#
    ]]>
      ORDER BY PAIS_COD_PAIS, EMCO_COD_EMPR_COME, COD_REGI
  </select>

  <parameterMap id="executeInterfazDATEnviarPaisParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
  </parameterMap>

  <procedure id="executeInterfazDATEnviarPais" 
   			  parameterMap="executeInterfazDATEnviarPaisParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_PAIS(?, ?, ?, ?, ?)}
  </procedure>  


  <parameterMap id="executeInterfazDATEnviarEmpresaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
  </parameterMap>

  <procedure id="executeInterfazDATEnviarEmpresa" 
   			  parameterMap="executeInterfazDATEnviarEmpresaParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_EMPRE(?, ?, ?, ?, ?)}
  </procedure>  

  <parameterMap id="executeInterfazDATEnviarProgramaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
  </parameterMap>

  <procedure id="executeInterfazDATEnviarPrograma" 
   			  parameterMap="executeInterfazDATEnviarProgramaParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_PROGR(?, ?, ?, ?, ?)}
  </procedure>  	

  <parameterMap id="executeInterfazDATEnviarCursosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCursos" 
   			  parameterMap="executeInterfazDATEnviarCursosParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CURSO(?, ?, ?, ?, ?)}
  </procedure>  

  <parameterMap id="executeInterfazDATEnviarInstructorasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
  </parameterMap>

  <procedure id="executeInterfazDATEnviarInstructoras" 
   			  parameterMap="executeInterfazDATEnviarInstructorasParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_INSTR(?, ?, ?, ?, ?)}
  </procedure>  

  <parameterMap id="executeInterfazDATEnviarInstructoraGeografiaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
  </parameterMap>

  <procedure id="executeInterfazDATEnviarInstructoraGeografia" 
   			  parameterMap="executeInterfazDATEnviarInstructoraGeografiaParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_INSTR_GEOGR(?, ?, ?, ?, ?)}
  </procedure>  


  <parameterMap id="executeInterfazDATEnviarCursoAmbitoParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCursoAmbito" 
   			  parameterMap="executeInterfazDATEnviarCursoAmbitoParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CURSO_AMBIT(?, ?, ?, ?, ?)}
  </procedure>  


  <parameterMap id="executeInterfazDATEnviarClienteGeografiaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
  </parameterMap>

  <procedure id="executeInterfazDATEnviarClienteGeografia" 
   			  parameterMap="executeInterfazDATEnviarClienteGeografiaParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CLIEN_GEOGR(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarClienteGeografiaReenvioParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
  </parameterMap>

  <procedure id="executeInterfazDATEnviarClienteGeografiaReenvio" 
   			  parameterMap="executeInterfazDATEnviarClienteGeografiaReenvioParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CLIEN_GEOGR_REENV(?, ?, ?, ?, ?, ?, ?)}
  </procedure>


  <parameterMap id="executeInterfazDATEnviarCapacitacionAptaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionApta" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionAptaParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_APTAS(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCapacitacionAptaReenvioParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionAptaReenvio" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionAptaReenvioParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_APTAS_REENV(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCapacitacionProgramadaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionProgramada" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionProgramadaParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_PROGR(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCapacitacionProgramadaReenvioParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionProgramadaReenvio" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionProgramadaReenvioParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_PROGR_REENV(?, ?, ?, ?, ?, ?, ?)}
  </procedure>


  <parameterMap id="executeInterfazDATEnviarCursosDictadosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCursosDictados" 
   			  parameterMap="executeInterfazDATEnviarCursosDictadosParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CURSO_DICTA(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCursosDictadosReenvioParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCursosDictadosReenvio" 
   			  parameterMap="executeInterfazDATEnviarCursosDictadosReenvioParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CURSO_DICTA_REENV(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCursosDictadosHistoriaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCursosDictadosHistoria" 
   			  parameterMap="executeInterfazDATEnviarCursosDictadosHistoriaParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CURSO_DICTA_HISTO(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarArchivoControlParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarArchivoControl" 
   			  parameterMap="executeInterfazDATEnviarArchivoControlParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_FILE_CNTRL(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarObjetivoPaisAnualParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarObjetivoPaisAnual" 
   			  parameterMap="executeInterfazDATEnviarObjetivoPaisAnualParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_OBJET_PAIS_ANUAL(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarObjetivoPaisPeriodoParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarObjetivoPaisPeriodo" 
   			  parameterMap="executeInterfazDATEnviarObjetivoPaisPeriodoParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_OBJET_PAIS_PERIO(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarObjetivoRegionAnualParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarObjetivoRegionAnual" 
   			  parameterMap="executeInterfazDATEnviarObjetivoRegionAnualParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_OBJET_REGIO_ANUAL(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarObjetivoRegionPeriodoParams" class="map">
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarObjetivoRegionPeriodo" 
   			  parameterMap="executeInterfazDATEnviarObjetivoRegionPeriodoParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_OBJET_REGIO_PERIO(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarObjetivoZonaAnualParams" class="map">
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarObjetivoZonaAnual" 
   			  parameterMap="executeInterfazDATEnviarObjetivoZonaAnualParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_OBJET_ZONA_ANUAL(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarObjetivoZonaPeriodoParams" class="map">
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarObjetivoZonaPeriodo" 
   			  parameterMap="executeInterfazDATEnviarObjetivoZonaPeriodoParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_OBJET_ZONA_PERIO(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCursosDictadosHistoriaReenvioParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCursosDictadosHistoriaReenvio" 
   			  parameterMap="executeInterfazDATEnviarCursosDictadosHistoriaReenvioParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CURSO_DICTA_HISTO_R(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCapacitacionClienteParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionCliente" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionClienteParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_CLIEN(?, ?, ?, ?, ?, ?, ?)}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCapacitacionClienteReenvioParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionClienteReenvio" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionClienteReenvioParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_CLIEN_REENV(?, ?, ?, ?, ?, ?, ?)}
  </procedure>


  <parameterMap id="executeInterfazDATEnviarCapacitacionCursoClienteParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionCursoCliente" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionCursoClienteParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_CURSO_CLIEN(?, ?, ?, ?, ?, ?, ? )}
  </procedure>

  <parameterMap id="executeInterfazDATEnviarCapacitacionCursoClienteReenvioParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoRegion"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>

  <procedure id="executeInterfazDATEnviarCapacitacionCursoClienteReenvio" 
   			  parameterMap="executeInterfazDATEnviarCapacitacionCursoClienteReenvioParams" >
		{call EDU_PKG_INTER.INT_PR_DAT_CAPAC_CURSO_CLIEN_R(?, ?, ?, ?, ?, ?, ?)}
  </procedure>
	

 <insert id="insertInterfazEDURecepcionarConsultoraDemanda" parameterClass="java.util.Map">
		INSERT EDU_PARAM_CURSO_DEMAN_CLIEN (
				PAIS_COD_PAIS, 
				EMCO_COD_EMPR_COME, 
				CCAP_COD_CURS_CAPA, 
				COD_CAMP_PROC,
				CLIE_COD_CLIE, 
				USU_DIGI, 
				FEC_DIGI,
				EST_REGI
		)
		VALUES (
        #codigoPais#, 
        #codigoEmpresa#, 
        #campanha#, 
        #codigoConsultora#, 
        #codigoCurso#, 
		#auditInfo.createdBy#,
		#auditInfo.created#,
		#estado#
	</insert>

  <!-- INTERFAZ - EVI - HISTORICO DE CONSULTORAS -->
  <parameterMap id="executeInterfazEVIEnviarHistoricoConsultorasParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoIso"		             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazEVIEnviarHistoricoConsultoras" parameterMap="executeInterfazEVIEnviarHistoricoConsultorasParams">
			{call EVI_PKG_EJECU_VIRTU.EVI_PR_INT_HISTO_CONSU(?,?,?,?,?,?,?)}			
  </procedure>
  
   <!-- INTERFAZ - EVI - RESULTADOS DE COBRANZA -->
  <parameterMap id="executeInterfazEVIEnviarResultadosCobranzaParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazEVIEnviarResultadosCobranza" parameterMap="executeInterfazEVIEnviarResultadosCobranzaParams">
			{call EVI_PKG_EJECU_VIRTU.EVI_PR_INT_RESUL_COBRA(?,?,?,?,?,?)}			
  </procedure>
  
   <!-- INTERFAZ - EVI - RESULTADOS DE FACTURACION -->
  <parameterMap id="executeInterfazEVIEnviarResultadosFacturacionParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazEVIEnviarResultadosFacturacion" parameterMap="executeInterfazEVIEnviarResultadosFacturacionParams">
			{call EVI_PKG_EJECU_VIRTU.EVI_PR_INT_RESUL_FACT(?,?,?,?,?,?)}			
  </procedure>
 
   <!-- INTERFAZ - EVI - SALDOS DE CONSULTORAS -->
  <parameterMap id="executeInterfazEVIEnviarSaldosConsultoraParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazEVIEnviarSaldosConsultora" parameterMap="executeInterfazEVIEnviarSaldosConsultoraParams">
			{call EVI_PKG_EJECU_VIRTU.EVI_PR_INT_SALDO_CONSU(?,?,?,?,?,?)}			
  </procedure>
  
  
  <!-- INTERFAZ - DAT - ENVIAR UNIDADES ADMINISTRATIVAS CONCURSO -->
  <parameterMap id="executeInterfazDATEnviarUnidadesAdministrativasConcursoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarUnidadesAdministrativasConcurso" parameterMap="executeInterfazDATEnviarUnidadesAdministrativasConcursoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_UNIDA_ADMIN_CONCU(?,?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR MAESTRO DE NIVELES CONCURSO -->
  <parameterMap id="executeInterfazDATEnviarMaestroNivelesConcursoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroNivelesConcurso" parameterMap="executeInterfazDATEnviarMaestroNivelesConcursoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_MAEST_NIVEL_CONCU(?,?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - DAT - ENVIAR PARAMETRIA DE OPCIONES PREMIO POR CONCURSO -->
  <parameterMap id="executeInterfazDATEnviarParametriaOpcionesPremioConcursoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarParametriaOpcionesPremioConcurso" parameterMap="executeInterfazDATEnviarParametriaOpcionesPremioConcursoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PARAM_OPCIO_PREMI(?,?,?,?,?,?)}			
  </procedure>
  
   <!-- INTERFAZ - DAT - ENVIAR PARTICIPANTES CONCURSO -->
  <parameterMap id="executeInterfazDATEnviarParticipantesConcursoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarParticipantesConcurso" parameterMap="executeInterfazDATEnviarParticipantesConcursoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PARTI_CONCU(?,?,?,?,?,?)}			
  </procedure>  
  
  <!-- INTERFAZ - DAT - ENVIAR PRODUCTOS CONCURSO -->
  <parameterMap id="executeInterfazDATEnviarProductosConcursoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoIso"                  jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarProductosConcurso" parameterMap="executeInterfazDATEnviarProductosConcursoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PRODU_CONCU(?,?,?,?,?,?,?)}			
  </procedure>  
  
   <!-- INTERFAZ - DAT - ENVIAR LISTADO RECOMENDANTES Y RECOMENDADAS CONCURSO -->
  <parameterMap id="executeInterfazDATEnviarRecomendantesRecomendadasConcursoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarRecomendantesRecomendadasConcurso" parameterMap="executeInterfazDATEnviarRecomendantesRecomendadasConcursoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_RECTE_RECDA_CONCU(?,?,?,?,?,?)}			
  </procedure>  
  
  <!-- INTERFAZ - DAT - ENVIAR HISTORICO PREMIOS DESPACHADOS CONCURSO -->
  <parameterMap id="executeInterfazDATEnviarHistoricoPremiosDespachadosConcursoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarHistoricoPremiosDespachadosConcurso" parameterMap="executeInterfazDATEnviarHistoricoPremiosDespachadosConcursoParams">
			{call INT_PKG_DATAM.INT_PR_DAT_HISTO_PREMI_DESPA(?,?,?,?,?,?)}			
  </procedure>  
  
  <!-- INTERFAZ - DAT - ENVIAR PREMIOS SELECCIONADOS -->
  <parameterMap id="executeInterfazDATEnviarPremiosSeleccionadosParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>  
  </parameterMap>
  <procedure id="executeInterfazDATEnviarPremiosSeleccionados" parameterMap="executeInterfazDATEnviarPremiosSeleccionadosParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PREMI_SELEC(?,?,?,?,?,?,?)}			
  </procedure>  
  
    <!-- INTERFAZ - DAT - ENVIAR PREMIOS SOLICITADOS -->
  <parameterMap id="executeInterfazDATEnviarPremiosSolicitadosParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>  
  </parameterMap>
  <procedure id="executeInterfazDATEnviarPremiosSolicitados" parameterMap="executeInterfazDATEnviarPremiosSolicitadosParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PREMI_SOLIC(?,?,?,?,?,?,?)}			
  </procedure>  
  
  
  <!-- INTERFAZ - DAT - ENVIAR PUNTAJE EBELISTAS POR PERIODO Y CONCURSO VIGENTE-->
  <parameterMap id="executeInterfazDATEnviarPuntajePeriodoConcursoVigenteParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarPuntajePeriodoConcursoVigente" parameterMap="executeInterfazDATEnviarPuntajePeriodoConcursoVigenteParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PUNTA_PERIO_CONCU(?,?,?,?,?,?)}			
  </procedure>  
  
  
  <!-- INTERFAZ - DAT - ENVIAR PUNTAJE RESULTADO DE CONCURSO LIDERES-->
  <parameterMap id="executeInterfazDATEnviarResultadoConcursoLideresParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarResultadoConcursoLideres" parameterMap="executeInterfazDATEnviarResultadoConcursoLideresParams">
			{call INT_PKG_DATAM.INT_PR_DAT_RESUL_CONCU_LIDER(?,?,?,?,?,?,?)}			
  </procedure> 
  
   <!-- INTERFAZ - IVR - ENVIAR TABLA DE CLIENTES-->
  <parameterMap id="executeInterfazIVREnviarTablaClientesParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="indProceso"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazIVREnviarTablaClientes" parameterMap="executeInterfazIVREnviarTablaClientesParams">
			{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_TABLA_CLIEN(?,?,?,?,?,?,?,?,?)}			
  </procedure> 
  
  <!-- INTERFAZ - IVR - ENVIAR TABLA DE CONCURSOS-->
  <parameterMap id="executeInterfazIVREnviarTablaConcursosParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="indProceso"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazIVREnviarTablaConcursos" parameterMap="executeInterfazIVREnviarTablaConcursosParams">
			{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_TABLA_CONCU(?,?,?,?,?,?,?)}			
  </procedure> 
  
  <!-- INTERFAZ - IVR - ENVIAR TABLA DE MOTIVOS DE RECHAZO-->
  <parameterMap id="executeInterfazIVREnviarTablaMotivosRechazoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoIso"                  jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazIVREnviarTablaMotivosRechazo" parameterMap="executeInterfazIVREnviarTablaMotivosRechazoParams">
			{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_MOTIV_RECHA(?,?,?,?,?)}			
  </procedure> 
  
  <!-- INTERFAZ - IVR - ENVIAR TABLA DE CONTROL-->
  <parameterMap id="executeInterfazIVREnviarTablaControlParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  
  <!-- INTERFAZ - IVR - ENVIAR TABLA DE POST VENTA-->
  <parameterMap id="executeInterfazIVREnviarTablaPostVentaParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="periodoCorte"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="porcentajePercepcion"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
  </parameterMap>
  <procedure id="executeInterfazIVREnviarTablaPostVenta" parameterMap="executeInterfazIVREnviarTablaPostVentaParams">
			{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_TABL_POST_VENT(?,?,?,?,?,?,?,?,?)}											
  </procedure> 
  
  
  <procedure id="executeInterfazIVREnviarTablaControl" parameterMap="executeInterfazIVREnviarTablaControlParams">
			{call INT_PKG_IVVRR.INT_PR_IVR_ENVI_TABLA_CTRL(?,?,?,?)}			
  </procedure> 
  
  <delete id="deleteTablaControlIVR">
        TRUNCATE TABLE int_ivr_ctrl
  </delete>
  
   <!-- INTERFAZ - REC - GENERAR BOLETA DE RECOJO -->
  <parameterMap id="executeGenerarBoletasRecojoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  
 <procedure id="executeGenerarBoletasRecojo" parameterMap="executeGenerarBoletasRecojoParams">
			{call INT_PKG_RECLA.INT_PR_REC_GENER_BOLET_RECOJ(?,?,?,?)}			
  </procedure> 
  
  <!-- INTERFAZ - IVR - OBTIENE EL NOMBRE DEL ARCHIVO IVR-->
  <select id="getNombreArchivoIVR" parameterClass="java.util.Map" resultClass="java.lang.String">
		<![CDATA[
		SELECT int_pkg_ivvrr.int_fn_devue_nomb_arch_ivr(#nombreArchivo#, #codigoPais#, #infoAdic#) FROM dual
		]]>	
  </select>	
  
  <insert id="insertInterfazRECRecepcionarBoletasRecojoControl" parameterClass="java.util.Map">

    	<![CDATA[
        INSERT INTO int_rec_ctrl_borec_tempo
		  (cod_regi_bore, val_cont_tota_bore, fec_carga, hor_carga)
		VALUES
		  ( #codigoReg#,
			#numTotalReg#,
			#fechaCarga#,
			#horaCarga#           
		  )
	    ]]>
	</insert>
	<!-- INTERFAZ - IVR - Recepcionar Cabecera Boletas Recojo-->
	<delete id="deleteInterfazRECRecepcionarBoletasRecojoCabecera">
        TRUNCATE TABLE INT_REC_CABEC_BOREC_TEMPO
    </delete>
	
	<parameterMap id="executeInterfazRECRecepcionarBoletasRecojoCabeceraParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazRECRecepcionarBoletasRecojoCabecera" 
   			  parameterMap="executeInterfazRECRecepcionarBoletasRecojoCabeceraParams" >
		{call INT_PKG_RECLA.INT_PR_REC_RECEP_BOREC_CABEC(?)}
    </procedure>  
	
	 <insert id="insertInterfazRECRecepcionarBoletasRecojoCabecera" parameterClass="java.util.Map">

    	<![CDATA[
        INSERT INTO int_rec_cabec_borec_tempo
		  (cod_regi_cabe_bore,
		   num_bole_reco,
		   cod_clie,
		   fec_reco,
		   hor_reco,
		   cod_moti,
		   cod_resu,
		   val_nomb_terc)
		VALUES
		  (DECODE(TRIM(#codigoRegistro#),'',NULL,TRIM(#codigoRegistro#)),
		   DECODE(TRIM(#numeroBoleta#),'',NULL,TRIM(#numeroBoleta#)),
		   DECODE(TRIM(#codigoConsultora#),'',NULL,TRIM(#codigoConsultora#)),
		   DECODE(TRIM(#fechaRecojo#),'',NULL,TRIM(#fechaRecojo#)),
		   DECODE(TRIM(#horaRecojo#),'',NULL,TRIM(#horaRecojo#)),
		   DECODE(TRIM(#motivo#),'',NULL,TRIM(#motivo#)),
		   DECODE(TRIM(#resultado#),'',NULL,TRIM(#resultado#)),
		   DECODE(TRIM(#nombreTercero#),'',NULL,TRIM(#nombreTercero#))
		  )
	    ]]>
	</insert>
	
   <!-- INTERFAZ - IVR - Recepcionar Detalle Boletas Recojo-->
	<delete id="deleteInterfazRECRecepcionarBoletasRecojoDetalle">
        TRUNCATE TABLE INT_REC_DETAL_BOREC_TEMPO
    </delete>
	
	<parameterMap id="executeInterfazRECRecepcionarBoletasRecojoDetalleParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    
    </parameterMap>
    
    

    <procedure id="executeInterfazRECRecepcionarBoletasRecojoDetalle" 
   			  parameterMap="executeInterfazRECRecepcionarBoletasRecojoDetalleParams" >
		{call INT_PKG_RECLA.INT_PR_REC_RECEP_BOREC_DETAL(?)}
    </procedure>  
	<insert id="insertInterfazRECRecepcionarBoletasRecojoDetalle" parameterClass="java.util.Map">

    	<![CDATA[
         INSERT INTO int_rec_detal_borec_tempo
		   (cod_regi_deta_bore,
		    num_bore,
		    cod_prod,
		    cod_prod_disc,
		    cod_secu_bore,
		    val_unid,
		    cod_vent)
		 VALUES
		   (DECODE(TRIM(#codigoRegistro#),'',NULL,TRIM(#codigoRegistro#)),
		    DECODE(TRIM(#numeroBoleta#),'',NULL,TRIM(#numeroBoleta#)),
		    DECODE(TRIM(#codigoProducto#),'',NULL,TRIM(#codigoProducto#)),
		    DECODE(TRIM(#codigoProductoDis#),'',NULL,TRIM(#codigoProductoDis#)),
		    DECODE(TRIM(#secuencia#),'',NULL,TRIM(#secuencia#)),
		    DECODE(TRIM(#unidades#),'',NULL,TRIM(#unidades#)),
		    DECODE(TRIM(#codigoVenta#),'',NULL,TRIM(#codigoVenta#))
		   )
	    ]]>
	</insert>
	
	<!-- INTERFAZ - DAT - ENVIAR MAESTRO DE EBELISTAS SESSION EXPERT-->
  <parameterMap id="executeInterfazDATEnviarMaestroEbelistasSessionExpertParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroEbelistasSessionExpert" parameterMap="executeInterfazDATEnviarMaestroEbelistasSessionExpertParams">
			{call INT_PKG_DATAM.INT_PR_DAT_EBELI_SESSI_EXPER(?,?,?,?,?,?,?)}			
  </procedure> 
  
  <!-- INTERFAZ - DAT - ENVIAR MAESTRO DE PRODUCTOS SESSION EXPERT-->
  <parameterMap id="executeInterfazDATEnviarMaestroProductosSessionExpertParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarMaestroProductosSessionExpert" parameterMap="executeInterfazDATEnviarMaestroProductosSessionExpertParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PRODU_SESSI_EXPER(?,?,?,?,?,?,?)}			
  </procedure> 
  
   <!-- INTERFAZ - DAT - ENVIAR PREMIOS ASIGNADOS TOTAL-->
  <parameterMap id="executeInterfazDATEnviarPremiosAsignadosTotalParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarPremiosAsignadosTotal" parameterMap="executeInterfazDATEnviarPremiosAsignadosTotalParams">
			{call INT_PKG_DATAM.INT_PR_DAT_PREMI_ASIGN_TOTAL(?,?,?,?,?,?)}			
  </procedure> 
  
   <!-- INTERFAZ - REC - ENVIAR CABECERA DE BOLETAS DE RECOJO-->
  <parameterMap id="executeInterfazRECEnviarBoletasRecojoCabeceraParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazRECEnviarBoletasRecojoCabecera" parameterMap="executeInterfazRECEnviarBoletasRecojoCabeceraParams">
			{call INT_PKG_RECLA.INT_PR_REC_ENVIA_BOREC_CABEC(?,?,?,?,?,?,?,?)}			
  </procedure> 
  
    <!-- INTERFAZ - IMP - GENERAR BAN2 DOMINICANA-->														
  <parameterMap id="executeInterfazIMPGenerarBanDominicanaParams" class="map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
  </parameterMap>														
  <procedure id="executeInterfazIMPGenerarBanDominicana" parameterMap="executeInterfazIMPGenerarBanDominicanaParams">														
			{call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_BAN_DOMIN(?,?,?,?,?,?,?,?)}											
  </procedure> 														
  			
  
  <!-- INTERFAZ - REC - ENVIAR DETALLE DE BOLETAS DE RECOJO-->
  <parameterMap id="executeInterfazRECEnviarBoletasRecojoDetalleParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazRECEnviarBoletasRecojoDetalle" parameterMap="executeInterfazRECEnviarBoletasRecojoDetalleParams">
			{call INT_PKG_RECLA.INT_PR_REC_ENVIA_BOREC_DETAL(?,?,?,?,?,?,?,?)}			
  </procedure>
  
  <!-- INTERFAZ - REC - ENVIAR CONTROL ENVIO DE BOLETAS DE RECOJO-->
  <parameterMap id="executeInterfazRECEnviarBoletasRecojoControlParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazRECEnviarBoletasRecojoControl" parameterMap="executeInterfazRECEnviarBoletasRecojoControlParams">
			{call INT_PKG_RECLA.INT_PR_REC_ENVIA_BOREC_CTRL(?,?,?,?,?)}			
  </procedure>
  
  
  
  
  <resultMap id="interfazBoletaRecojoCabeceraListResult" class="java.util.HashMap">
    <result property="codigoRegion" column="COD_REGI"/>
    <result property="codigoZona" column="COD_ZONA"/>
    <result property="codigoCabeceraBoletaRecojo" column="COD_CABE_BORE"/>
    <result property="codCliente" column="COD_CLIE"/>
  </resultMap>
  
  <select id="getBoletaRecojoCabeceraList" parameterClass="java.util.Map" resultMap="interfazBoletaRecojoCabeceraListResult">
		<![CDATA[
			SELECT  DISTINCT CB.COD_REGI,
			       CB.COD_ZONA,
			       CB.COD_CABE_BORE,
			       CB.COD_CLIE
			  FROM INT_REC_LINEA_BOREC LB,
			       INT_REC_CABEC_BOREC CB,
			       REC_CABEC_RECLA     RC,
			       CRA_PERIO           CRA,
                   SEG_PERIO_CORPO     SP,
                   INT_REC_CIERR_BOREC       CIE
			WHERE CB.COD_PAIS = #codigoPais#
			   AND LB.COD_PAIS = #codigoPais#
			AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'I')
			AND CB.ESBO_OID_ESTA_BOR2 IS NULL
			   AND CB.NUM_RECO = 1
			   AND CB.IND_REGR_YOBE = 0
			   AND LB.IND_REGR_YOBE = 0
			   AND CB.COD_CABE_BORE = LB.COD_CABE_BORE
			   AND RC.OID_CABE_RECL = LB.CARE_OID_CABE_RECL
			   AND CRA.PERI_OID_PERI = SP.OID_PERI
			   AND CRA.OID_PERI = RC.PERD_OID_PERI_DOCU_REFE
			AND CB.IND_ENVI_YOBE = 1 
		   AND LB.IND_ENVI_YOBE = 1
			AND CB.IND_ENVI_XERO = 0 
			   AND LB.IND_ENVI_XERO = 0 
AND CB.NUM_TOTA_UNID_RECL>0
               AND cie.cod_regi = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_REGI')
               AND cie.cod_zona = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_ZONA')
               AND cie.cod_pais = cb.cod_pais
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) >= trunc(cie.fec_cierr)
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) <= trunc(cie.fec_cie2)
               AND cie.cod_peri = #codigoPeriodo#
			UNION
		SELECT  DISTINCT CB.COD_REGI,
			       CB.COD_ZONA,
			       CB.COD_CABE_BORE,
			       CB.COD_CLIE
		  FROM INT_REC_LINEA_BOREC       LB,
		       INT_REC_CABEC_BOREC       CB,
		       REC_CABEC_RECLA           RC,
		       CRA_PERIO                 CRA,
		       SEG_PERIO_CORPO SP,
			       PED_SOLIC_CABEC     CON,
INT_REC_CIERR_BOREC       CIE
			 WHERE CB.COD_PAIS = #codigoPais#
		   AND LB.COD_PAIS = #codigoPais#
		   AND CB.COD_CABE_BORE = LB.COD_CABE_BORE
			   AND CB.ESBO_OID_ESTA_BOR2 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'NX')											
			   AND CB.NUM_RECO = 2
			   AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'GE')
			AND CB.IND_ENVI_YOBE = 1 
			   AND CB.IND_REGR_YOBE = 1
		   AND LB.IND_ENVI_YOBE = 1
		   AND LB.IND_REGR_YOBE = 1
		   AND RC.OID_CABE_RECL = LB.CARE_OID_CABE_RECL
		   AND CRA.PERI_OID_PERI = SP.OID_PERI
		   AND CRA.OID_PERI = RC.PERD_OID_PERI_DOCU_REFE
			   AND CON.CLIE_OID_CLIE = CB.CLIE_OID_CLIE
			   AND CON.PERD_OID_PERI =  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
			   AND CON.GRPR_OID_GRUP_PROC = INT_PKG_RECLA.GEN_FN_DEVUE_OID_GRUPO_PROCE('GP5')
			   AND CON.SOCA_OID_SOLI_CABE IS NULL
			   AND CON.TSPA_OID_TIPO_SOLI_PAIS IN ( INT_PKG_RECLA.GEN_FN_DEVUE_OID_TIPO_SOLPA('C1'))											
               AND cie.cod_regi = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_REGI')
               AND cie.cod_zona = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_ZONA')
AND cie.cod_pais = cb.cod_pais
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) >= trunc(cie.fec_cierr)
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) <= trunc(cie.fec_cie2)
               AND cie.cod_peri = #codigoPeriodo#
			   AND CB.IND_ENVI_YOB2 = 1
		   AND LB.IND_ENVI_YOB2 = 1
			   AND CB.IND_ENVI_XER2 IS NULL			   	
		   AND LB.IND_ENVI_XER2 IS NULL		
AND CB.NUM_TOTA_UNID_RECL>0		
			UNION
		SELECT  DISTINCT CB.COD_REGI,
			       CB.COD_ZONA,
			       CB.COD_CABE_BORE,
			       CB.COD_CLIE
		  FROM INT_REC_LINEA_BOREC       LB,
				 INT_REC_CABEC_BOREC CB,
				 MAE_CLIEN MC,
				 REC_CABEC_RECLA RC,
				 CRA_PERIO CRA,
				 SEG_PERIO_CORPO SP,
INT_REC_CIERR_BOREC       CIE
			 WHERE CB.COD_PAIS = #codigoPais#
			AND LB.COD_PAIS = #codigoPais#
			   AND CB.ESBO_OID_ESTA_BOR2 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'NX')											
			   AND CB.NUM_RECO = 2
			   AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'GE')
			   AND CB.IND_ENVI_YOBE = 1
			   AND CB.IND_REGR_YOBE = 1
		   AND LB.IND_ENVI_YOBE = 1
		   AND LB.IND_REGR_YOBE = 1
			AND CB.COD_CABE_BORE = LB.COD_CABE_BORE
			AND MC.OID_CLIE = CB.CLIE_OID_CLIE
			AND RC.OID_CABE_RECL = LB.CARE_OID_CABE_RECL
			AND CRA.PERI_OID_PERI = SP.OID_PERI
			AND CRA.OID_PERI = RC.PERD_OID_PERI_DOCU_REFE
			   AND CB.CLIE_OID_CLIE NOT IN
			       (SELECT CLIE_OID_CLIE
			          FROM PED_SOLIC_CABEC
			         WHERE GRPR_OID_GRUP_PROC = INT_PKG_RECLA.GEN_FN_DEVUE_OID_GRUPO_PROCE('GP5')
			           AND PERD_OID_PERI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
			           AND SOCA_OID_SOLI_CABE IS NULL
			           AND TSPA_OID_TIPO_SOLI_PAIS IN ( INT_PKG_RECLA.GEN_FN_DEVUE_OID_TIPO_SOLPA('C1')))											
               AND (GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'OID_ZONA') IN
			       (SELECT ZZON_OID_ZONA
			          FROM FAC_CONTR_CIERR CI
			         WHERE CI.PERD_OID_PERI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
			           AND CI.TCIE_OID_TIPO_CIER = 2)
                    OR
                    GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'OID_REGI') IN (
SELECT ZORG_OID_REGI
FROM fac_contr_cierr ci
WHERE ci.perd_oid_peri =
GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
AND ci.tcie_oid_tipo_cier = 1
)
)
			   AND CB.IND_ENVI_YOB2 = 1
		   AND LB.IND_ENVI_YOB2 = 1
		       AND CB.IND_ENVI_XER2 IS NULL			   
		   AND LB.IND_ENVI_XER2 IS NULL			   
               AND cie.cod_regi = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_REGI')
               AND cie.cod_zona = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_ZONA')
AND cie.cod_pais = cb.cod_pais	   
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) >= trunc(cie.fec_cierr)
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) <= trunc(cie.fec_cie2)
               AND cie.cod_peri = #codigoPeriodo#
               /*in (
                      select cod_peri
                      from bas_ctrl_fact
                      where sta_camp = 0
                      and ind_camp_act = 1
                 )*/
AND CB.NUM_TOTA_UNID_RECL>0
			 ORDER BY COD_REGI,
			          COD_ZONA,
			          COD_CLIE
		]]>	
  </select>
  
  
   <resultMap id="interfazBoletaRecojoLineaListResult" class="java.util.HashMap">
   	    <result property="val_nume_bore"			    column="VAL_NUME_BORE"/>
    	<result property="cod_clie"					    column="COD_CLIE"/>					        
		<result property="fec_ingr"						column="FEC_INGR"/>					        
		<result property="num_reco"						column="NUM_RECO"/>					       
		<result property="num_tota_unid_recl"			column="NUM_TOTA_UNID_RECL"	/>					       
		<result property="cod_regi"						column="COD_REGI"/>					       
		<result property="cod_zona"						column="COD_ZONA"/>					       
		<result property="cod_terr"						column="COD_TERR"/>					       
		<result property="cod_secc"						column="COD_SECC"/>					       
		<result property="val_nume_bole_desp"			column="VAL_NUME_BOLE_DESP"/>					       
		<result property="cod_peri_proc" 				column="COD_PERI_PROC"/>					       
		<result property="cod_prod"						column="COD_PROD"/>					        
		<result property="cod_anti"						column="COD_ANTI"/>					       
		<result property="num_unid_recl"				column="NUM_UNID_RECL"/>					       
		<result property="des_oper"						column="DES_OPER"/>					       
		<result property="num_secu"						column="NUM_SECU"/>					  
		<result property="cod_peri"						column="COD_PERI"/>					 
		<result property="nombre"            	 		column="NOMBRE"/>          		    
		<result property="direccion"         	 		column="DIRECCION"/>          		    
		<result property="telefono"          	 		column="TELEFONO"/>          		    
		<result property="des_urba"          	 		column="DES_URBA"/>
		<result property="des_dist"          	 		column="DES_DIST"/>
		<result property="des_prov"          	 		column="DES_PROV"/>
		<result property="des_dpto"          	 		column="DES_DPTO"/>
		<result property="codigounicoventa"				column="CODIGOUNICOVENTA"/>		
		<result property="des_cort"						column="DES_CORT"/>
  <result property="dir_br1"						column="DIR_BR1"/>
		<result property="dir_br2"						column="DIR_BR2"/>
  </resultMap>
  
  <select id="getBoletaRecojoLineaList" parameterClass="java.util.Map" resultMap="interfazBoletaRecojoLineaListResult">
		<![CDATA[
			SELECT * FROM (SELECT A.*, ROWNUM RNUM FROM (
			SELECT CB.VAL_NUME_BORE, 
				MC.COD_CLIE, 
				DECODE(CB.NUM_RECO,1,CB.FEC_INGR,2,CB.FEC_ING2,null) FEC_INGR, 
			       DECODE(CB.NUM_RECO,1,'PRIMER ',2,'SEGUNDO ','-') NUM_RECO,
				CB.NUM_TOTA_UNID_RECL, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_REGI') as COD_REGI, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_ZONA') as COD_ZONA, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_TERR') as COD_TERR, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_SECC') as COD_SECC,
				NVL(CB.VAL_NUME_BOLE_DESP,'0') VAL_NUME_BOLE_DESP, 
				CB.COD_PERI_PROC, 
				LB.COD_PROD, 
				LB.COD_ANTI, 
			       LB.NUM_UNID_RECL-LB.NUM_UNID_ELIM  NUM_UNID_RECL,											
                (SELECT 
                  (CASE val_param WHEN 'S' THEN LB.DES_OPER || ' (' || LB.cod_moti_devo || ')' ELSE LB.DES_OPER END)      
                  FROM sto_param_gener_occrr WHERE cod_para = 'STO_IMP_MOT_BR') DES_OPER,
				LB.NUM_SECU, 
				SP.COD_PERI, 
			    TRIM(MC.VAL_NOM1) || ' ' || TRIM(MC.VAL_APE1) || ' ' || TRIM(MC.VAL_APE2) AS NOMBRE,
			    NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DIR_CLIE'),'-')DIRECCION,
			       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(CB.CLIE_OID_CLIE, 'TF'),'-') AS TELEFONO,
			       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_URBA'),'-') AS DES_URBA,
			       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_DIST'),'-') AS DES_DIST,
			       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_PROV'),'-') AS DES_PROV,
			       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_DPTO'),'-') AS DES_DPTO,
			       DECODE(#datoEnvioBR#, 'C',
			       NVL(DECODE(LB.COPA_OID_PARA_GRAL, NULL,
			                   INT_PKG_RECLA.GEN_FN_DEVUE_COD_VENTA_MFACT(LB.TOFE_OID_TIPO_OFER,
			                                                             LB.MAFA_OID_MATR_FACT,
			                                                             LB.PROD_OID_PROD),
			                  INT_PKG_RECLA.GEN_FN_DEVUE_COD_VENTA_FICTI(LB.LOPA_OID_LOTE_PREM_ARTI,
			                                                             LB.PANP_OID_PARA_NIVE_PREM,
			                                                             LB.COPA_OID_PARA_GRAL,
				                                                             LB.PROD_OID_PROD)),'-'),
			              RC.NUM_RECL)  AS CODIGOUNICOVENTA,
			       NVL(IMP_PKG_PROCE_LASER.imp_fn_desc_produ_br(#codigoPais#,LB.PROD_OID_PROD),'-') DES_CORT,
			       imp_pkg_proce_laser.imp_fn_obtiene_text_direc(imp_pkg_proce_laser.imp_fn_obtiene_direc_clie(#codigoPais#,MC.OID_CLIE),'') AS DIR_BR1,
			       imp_pkg_proce_laser.imp_fn_obtiene_text2_direc(imp_pkg_proce_laser.imp_fn_obtiene_direc_clie(#codigoPais#,MC.OID_CLIE),'') AS DIR_BR2
			  FROM INT_REC_LINEA_BOREC LB,
			       INT_REC_CABEC_BOREC CB,
			       MAE_CLIEN           MC,
			       REC_CABEC_RECLA     RC,
			       CRA_PERIO           CRA,
                   SEG_PERIO_CORPO     SP,
                   INT_REC_CIERR_BOREC       CIE
			 WHERE CB.COD_PAIS = #codigoPais#
			   AND LB.COD_PAIS = CB.COD_PAIS
			   AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'I')
			   AND CB.ESBO_OID_ESTA_BOR2 IS NULL
			   AND CB.NUM_RECO = 1
			   AND CB.IND_REGR_YOBE = 0
			   AND LB.IND_REGR_YOBE = 0
			   AND CB.COD_CABE_BORE = LB.COD_CABE_BORE
			   AND MC.OID_CLIE = CB.CLIE_OID_CLIE
			   AND RC.OID_CABE_RECL = LB.CARE_OID_CABE_RECL
			   AND CRA.PERI_OID_PERI = SP.OID_PERI
			   AND CRA.OID_PERI = RC.PERD_OID_PERI_DOCU_REFE
		   AND CB.IND_ENVI_YOBE = 1
		   AND LB.IND_ENVI_YOBE = 1
		      AND CB.IND_ENVI_XERO = 0 
			   AND LB.IND_ENVI_XERO = 0 
		    AND CB.COD_CABE_BORE = #codigoCabeceraBoletaRecojo#
               AND cie.cod_regi = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_REGI')
               AND cie.cod_zona = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_ZONA')
               AND cie.cod_pais = cb.cod_pais
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) >= trunc(cie.fec_cierr)
               AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) <= trunc(cie.fec_cie2)
               AND cie.cod_peri = #codigoPeriodo#
		UNION
		SELECT CB.VAL_NUME_BORE,
		       MC.COD_CLIE,
		       DECODE(CB.NUM_RECO,1,CB.FEC_INGR,2,CB.FEC_ING2,null) FEC_INGR,
		       DECODE(CB.NUM_RECO,1,'PRIMER ',2,'SEGUNDO ','-') NUM_RECO,
				(CB.NUM_TOTA_UNID_RECL- (SELECT SUM(LL.NUM_UNID_ELIM) 
                                        FROM INT_REC_LINEA_BOREC LL
                                        WHERE LL.COD_CABE_BORE = CB.COD_CABE_BORE)) NUM_TOTA_UNID_RECL, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_REGI') as COD_REGI, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_ZONA') as COD_ZONA, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_TERR') as COD_TERR, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_SECC') as COD_SECC,
				NVL(CB.VAL_NUME_BOLE_DESP,'0') VAL_NUME_BOLE_DESP, 
				CB.COD_PERI_PROC, 
				LB.COD_PROD, 
				LB.COD_ANTI, 
		       LB.NUM_UNID_RECL-LB.NUM_UNID_ELIM  NUM_UNID_RECL,												
                (SELECT 
                  (CASE val_param WHEN 'S' THEN LB.DES_OPER || ' (' || LB.cod_moti_devo || ')' ELSE LB.DES_OPER END)      
                  FROM sto_param_gener_occrr WHERE cod_para = 'STO_IMP_MOT_BR') DES_OPER, 
				LB.NUM_SECU, 
				SP.COD_PERI, 
		       TRIM(MC.VAL_NOM1) || ' ' || TRIM(MC.VAL_APE1) || ' ' || TRIM(MC.VAL_APE2) AS NOMBRE,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DIR_CLIE') ,'-')DIRECCION,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(CB.CLIE_OID_CLIE, 'TF'),'-') AS TELEFONO,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_URBA'),'-') AS DES_URBA,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_DIST'),'-') AS DES_DIST,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_PROV'),'-') AS DES_PROV,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_DPTO'),'-') AS DES_DPTO,
		       DECODE(#datoEnvioBR#, 'C',
		       NVL(DECODE(LB.COPA_OID_PARA_GRAL, NULL,
		                   INT_PKG_RECLA.GEN_FN_DEVUE_COD_VENTA_MFACT(LB.TOFE_OID_TIPO_OFER,
		                                                             LB.MAFA_OID_MATR_FACT,
			                                                             LB.PROD_OID_PROD),
		                  INT_PKG_RECLA.GEN_FN_DEVUE_COD_VENTA_FICTI(LB.LOPA_OID_LOTE_PREM_ARTI,
		                                                             LB.PANP_OID_PARA_NIVE_PREM,
		                                                             LB.COPA_OID_PARA_GRAL,
				                                                         LB.PROD_OID_PROD)),'-'), 
				      RC.NUM_RECL)  AS CODIGOUNICOVENTA,    
		       NVL(IMP_PKG_PROCE_LASER.imp_fn_desc_produ_br(#codigoPais#,LB.PROD_OID_PROD),'-') DES_CORT,
		       imp_pkg_proce_laser.imp_fn_obtiene_text_direc(imp_pkg_proce_laser.imp_fn_obtiene_direc_clie(#codigoPais#,MC.OID_CLIE),'') AS DIR_BR1,
			   imp_pkg_proce_laser.imp_fn_obtiene_text2_direc(imp_pkg_proce_laser.imp_fn_obtiene_direc_clie(#codigoPais#,MC.OID_CLIE),'') AS DIR_BR2
		  FROM INT_REC_LINEA_BOREC       LB,
		       INT_REC_CABEC_BOREC       CB,
		       MAE_CLIEN                 MC,
		       REC_CABEC_RECLA           RC,
		       CRA_PERIO                 CRA,
		       SEG_PERIO_CORPO SP,
		       PED_SOLIC_CABEC           CON,
                       INT_REC_CIERR_BOREC       CIE
		 WHERE CB.COD_PAIS = #codigoPais#
		   AND LB.COD_PAIS = CB.COD_PAIS
		   AND CB.COD_CABE_BORE = LB.COD_CABE_BORE
		   AND CB.ESBO_OID_ESTA_BOR2 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'NX')												
		   AND CB.NUM_RECO = 2
		   AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'GE')
		   AND CB.IND_ENVI_YOBE = 1
		   AND CB.IND_REGR_YOBE = 1
		   AND LB.IND_ENVI_YOBE = 1
		   AND LB.IND_REGR_YOBE = 1
		   AND MC.OID_CLIE = CB.CLIE_OID_CLIE
		   AND RC.OID_CABE_RECL = LB.CARE_OID_CABE_RECL
		   AND CRA.PERI_OID_PERI = SP.OID_PERI
		   AND CRA.OID_PERI = RC.PERD_OID_PERI_DOCU_REFE
		   AND CON.CLIE_OID_CLIE = CB.CLIE_OID_CLIE
		   AND CON.PERD_OID_PERI =  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
		                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
		                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
		   AND CON.GRPR_OID_GRUP_PROC = INT_PKG_RECLA.GEN_FN_DEVUE_OID_GRUPO_PROCE('GP5')
		   AND CON.SOCA_OID_SOLI_CABE IS NULL
		   AND CON.TSPA_OID_TIPO_SOLI_PAIS IN ( INT_PKG_RECLA.GEN_FN_DEVUE_OID_TIPO_SOLPA('C1'))
           AND cie.cod_regi = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_REGI')
           AND cie.cod_zona = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_ZONA')
                   AND cie.cod_pais = cb.cod_pais
           AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) >= trunc(cie.fec_cierr)
           AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) <= trunc(cie.fec_cie2)
           AND cie.cod_peri = #codigoPeriodo#
		   AND CB.IND_ENVI_YOB2 = 1
		   AND LB.IND_ENVI_YOB2 = 1
		   AND CB.IND_ENVI_XER2 IS NULL
		   AND LB.IND_ENVI_XER2 IS NULL		
		    AND CB.COD_CABE_BORE = #codigoCabeceraBoletaRecojo#
		UNION
		SELECT CB.VAL_NUME_BORE,
		       MC.COD_CLIE,
		       DECODE(CB.NUM_RECO,1,CB.FEC_INGR,2,CB.FEC_ING2,null) FEC_INGR,
		       DECODE(CB.NUM_RECO,1,'PRIMER ',2,'SEGUNDO ','-') NUM_RECO,
				(CB.NUM_TOTA_UNID_RECL- (SELECT SUM(LL.NUM_UNID_ELIM) 
                                        FROM INT_REC_LINEA_BOREC LL
                                        WHERE LL.COD_CABE_BORE = CB.COD_CABE_BORE)) NUM_TOTA_UNID_RECL, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_REGI') as COD_REGI, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_ZONA') as COD_ZONA, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_TERR') as COD_TERR, 
				GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'COD_SECC') as COD_SECC,  
				NVL(CB.VAL_NUME_BOLE_DESP,'0') VAL_NUME_BOLE_DESP, 
				CB.COD_PERI_PROC, 
				LB.COD_PROD, 
				LB.COD_ANTI, 
		       LB.NUM_UNID_RECL-LB.NUM_UNID_ELIM  NUM_UNID_RECL,												
                (SELECT 
                  (CASE val_param WHEN 'S' THEN LB.DES_OPER || ' (' || LB.cod_moti_devo || ')' ELSE LB.DES_OPER END)      
                  FROM sto_param_gener_occrr WHERE cod_para = 'STO_IMP_MOT_BR') DES_OPER, 
				LB.NUM_SECU, 
				SP.COD_PERI, 
		       TRIM(MC.VAL_NOM1) || ' ' || TRIM(MC.VAL_APE1) || ' ' || TRIM(MC.VAL_APE2) AS NOMBRE,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DIR_CLIE') ,'-')DIRECCION,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(CB.CLIE_OID_CLIE, 'TF'),'-') AS TELEFONO,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_URBA'),'-') AS DES_URBA,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_DIST'),'-') AS DES_DIST,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_PROV'),'-') AS DES_PROV,
		       NVL(GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID(CB.CLIE_OID_CLIE,'DES_DPTO'),'-') AS DES_DPTO,
		       DECODE(#datoEnvioBR#, 'C',
		       NVL(DECODE(LB.COPA_OID_PARA_GRAL, NULL,
		                   INT_PKG_RECLA.GEN_FN_DEVUE_COD_VENTA_MFACT(LB.TOFE_OID_TIPO_OFER,
		                                                             LB.MAFA_OID_MATR_FACT,
			                                                             LB.PROD_OID_PROD),
		                  INT_PKG_RECLA.GEN_FN_DEVUE_COD_VENTA_FICTI(LB.LOPA_OID_LOTE_PREM_ARTI,
		                                                             LB.PANP_OID_PARA_NIVE_PREM,
		                                                             LB.COPA_OID_PARA_GRAL,
					                                                         LB.PROD_OID_PROD)),'-'),
			            RC.NUM_RECL)  AS CODIGOUNICOVENTA,                                               
		       NVL(GEN_PKG_GENER.GEN_FN_DEVUELVE_DESCRIPCION(LB.PROD_OID_PROD,'MAE_PRODU','es'),'-') DES_CORT,
		       imp_pkg_proce_laser.imp_fn_obtiene_text_direc(imp_pkg_proce_laser.imp_fn_obtiene_direc_clie(#codigoPais#,MC.OID_CLIE),'') AS DIR_BR1,
			   imp_pkg_proce_laser.imp_fn_obtiene_text2_direc(imp_pkg_proce_laser.imp_fn_obtiene_direc_clie(#codigoPais#,MC.OID_CLIE),'') AS DIR_BR2
		  FROM INT_REC_LINEA_BOREC       LB,
				 INT_REC_CABEC_BOREC CB,
				 MAE_CLIEN MC,
				 REC_CABEC_RECLA RC,
				 CRA_PERIO CRA,
				 SEG_PERIO_CORPO SP,
                       INT_REC_CIERR_BOREC       CIE
			WHERE CB.COD_PAIS = #codigoPais#
			AND LB.COD_PAIS = CB.COD_PAIS
		   AND CB.ESBO_OID_ESTA_BOR2 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'NX')												
		   AND CB.NUM_RECO = 2
		   AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'GE')
		   AND CB.IND_ENVI_YOBE = 1
		   AND CB.IND_REGR_YOBE = 1
		   AND LB.IND_ENVI_YOBE = 1
		   AND LB.IND_REGR_YOBE = 1
			AND CB.COD_CABE_BORE = LB.COD_CABE_BORE
			AND MC.OID_CLIE = CB.CLIE_OID_CLIE
			AND RC.OID_CABE_RECL = LB.CARE_OID_CABE_RECL
			AND CRA.PERI_OID_PERI = SP.OID_PERI
			AND CRA.OID_PERI = RC.PERD_OID_PERI_DOCU_REFE
		   AND CB.CLIE_OID_CLIE NOT IN
		       (SELECT CLIE_OID_CLIE
		          FROM PED_SOLIC_CABEC
		         WHERE GRPR_OID_GRUP_PROC = INT_PKG_RECLA.GEN_FN_DEVUE_OID_GRUPO_PROCE('GP5')
		           AND PERD_OID_PERI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
		                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
		                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
		           AND SOCA_OID_SOLI_CABE IS NULL
		           AND TSPA_OID_TIPO_SOLI_PAIS IN (INT_PKG_RECLA.GEN_FN_DEVUE_OID_TIPO_SOLPA('C1')))
		   AND (
                GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'OID_ZONA') IN (
                        SELECT ZZON_OID_ZONA
		          FROM FAC_CONTR_CIERR CI
                         WHERE CI.PERD_OID_PERI = 
                                GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
		                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
		                                                  GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
                           AND CI.TCIE_OID_TIPO_CIER = 2
                           )
                        OR
                GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(MC.COD_CLIE, 'OID_REGI') IN (
                            SELECT ZORG_OID_REGI
                             FROM fac_contr_cierr ci
                             WHERE ci.perd_oid_peri =
                             GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
                             GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
                             GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#))
                        AND ci.tcie_oid_tipo_cier = 1
                        )
                        )
		   AND CB.IND_ENVI_YOB2 = 1
		   AND LB.IND_ENVI_YOB2 = 1
		   AND CB.IND_ENVI_XER2 IS NULL
		   AND LB.IND_ENVI_XER2 IS NULL	
           AND cie.cod_regi = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_REGI')
           AND cie.cod_zona = GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(CB.COD_CLIE, 'COD_ZONA')
                   AND cie.cod_pais = cb.cod_pais
           AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) >= trunc(cie.fec_cierr)
           AND (
select fec_proc
from bas_ctrl_fact
where sta_camp = 0
and ind_camp_act = 1
) <= trunc(cie.fec_cie2)
           AND cie.cod_peri = #codigoPeriodo#
			AND CB.COD_CABE_BORE = #codigoCabeceraBoletaRecojo#
			)A ]]>	
                    WHERE A.NUM_UNID_RECL>0
                      AND A.NUM_TOTA_UNID_RECL>0
				<isNotEmpty prepend="AND" property="rowHasta">
					<![CDATA[ROWNUM <=#rowHasta#]]>
				</isNotEmpty>
                        ) 
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowDesde">
					RNUM>=#rowDesde#
				</isNotEmpty>
		   </dynamic>

			
  </select>	
  
  <insert id="saveXMLBoletasRecojo" parameterClass="java.util.Map">
    <![CDATA[

        INSERT INTO INT_BOLET_RECOJ_XML 
		  ( COD_CONS
		  , VAL_CORR
		  , XML_BOLE_RECO
		  , COD_CABE_BORE
		  )
		VALUES
		  ( #cod_clie#
		  , #pagina#
		  , #archivoXML#
		  , #codigoCabeceraBoletaRecojo#)
		]]>	
	</insert>
  <procedure id="executeGenerarXMLBoletasRecojo">
		{call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_XML_BOLET_RECOJ()}			
  </procedure>
  
  <parameterMap id="executeGenerarXMLBoletasRecojoORAParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
        <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
  </parameterMap>
  <procedure id="executeGenerarXMLBoletasRecojoORA" parameterMap="executeGenerarXMLBoletasRecojoORAParams">
		{call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_XML_BOREC_ORA(?,?,?,?)}			
  </procedure>
  														
  <parameterMap id="executeEnviarSMSBoletaPrimerRecojoParams" class="map" >														
		<parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
  </parameterMap>
  <procedure id="executeEnviarSMSBoletaPrimerRecojo" parameterMap="executeEnviarSMSBoletaPrimerRecojoParams">
		{call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_CSV_PRIME_REC(?,?,?,?)}			
  </procedure>
  
  <parameterMap id="executeEnviarSMSBoletaSegundoRecojoParams" class="map" >														
		<parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeEnviarSMSBoletaSegundoRecojo" parameterMap="executeEnviarSMSBoletaSegundoRecojoParams">
		{call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_CSV_SEGUN_REC(?,?,?,?)}			
  </procedure>
  
  <parameterMap id="executeEnviarSMSBoletaSegundoRecojoNoExitosoParams" class="map" >														
		<parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeEnviarSMSBoletaSegundoRecojoNoExitoso" parameterMap="executeEnviarSMSBoletaSegundoRecojoNoExitosoParams">
		{call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_CSV_SEGNE_REC(?,?,?,?)}			
  </procedure>
  														
  <delete id="executeTruncateGenerarXMLBoletasRecojo">
        TRUNCATE TABLE INT_BOLET_RECOJ_XML
  </delete> 

  <!-- INTERFAZ - OCR - ENVIAR MAESTRO DE CLIENTES CORPORATIVO-->
  <parameterMap id="executeInterfazOCREnviarMaestroClientesCorporativoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazOCREnviarMaestroClientesCorporativo" parameterMap="executeInterfazOCREnviarMaestroClientesCorporativoParams">
			{call INT_PKG_OCCRR.INT_PR_OCR_ENVI_MAEST_CLIE(?,?,?,?)}			
  </procedure> 
  
  <!-- INTERFAZ - OCR - ENVIAR MATRIZ DE FACTURACION CORPORATIVO-->
  <parameterMap id="executeInterfazOCREnviarMatrizFacturacionCorporativoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"				 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
	<parameter property="codigoPeriodoDesde"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodoHasta"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazOCREnviarMatrizFacturacionCorporativo" parameterMap="executeInterfazOCREnviarMatrizFacturacionCorporativoParams">
			{call INT_PKG_OCCRR.INT_PR_OCR_ENVI_MATRI_FACTU(?,?,?,?,?,?,?,?,?)}			
  </procedure>
  
   <!-- INTERFAZ - OCR - ENVIAR RANGO DE PERIODOS VIGENTE CORPORATIVO -->
  <parameterMap id="executeInterfazOCREnviarRangoPeriodosVigenteCorporativoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodoDesde"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazOCREnviarRangoPeriodosVigenteCorporativo" parameterMap="executeInterfazOCREnviarRangoPeriodosVigenteCorporativoParams">
			{call INT_PKG_OCCRR.INT_PR_OCR_ENVI_RANGO_PERIO(?,?,?,?,?)}			
  </procedure> 
  
  <!-- INTERFAZ - OCR - ENVIAR REGIONES CORPORATIVO -->
  <parameterMap id="executeInterfazOCREnviarRegionesCorporativoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>
  <procedure id="executeInterfazOCREnviarRegionesCorporativo" parameterMap="executeInterfazOCREnviarRegionesCorporativoParams">
			{call INT_PKG_OCCRR.INT_PR_OCR_ENVI_TABLA_REGIO(?,?,?,?,?,?)}			
  </procedure> 

  <!-- INTERFAZ - OCR - ENVIAR ZONAS CORPORATIVO -->
  <parameterMap id="executeInterfazOCREnviarZonasCorporativoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>
  <procedure id="executeInterfazOCREnviarZonasCorporativo" parameterMap="executeInterfazOCREnviarZonasCorporativoParams">
			{call INT_PKG_OCCRR.INT_PR_OCR_ENVI_TABLA_ZONAS(?,?,?,?,?,?)}			
  </procedure>

 
     <!-- INTERFAZ - COMISIONES - ENVIAR CARGA MASIVA EJECUTIVA -->
  <parameterMap id="executeInterfazCOMEnviarCargaMasivaEjecutivaNuevaParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="tipoComisionista"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="anioInicial"          		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoTramo"       		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazCOMEnviarCargaMasivaEjecutivaNueva" parameterMap="executeInterfazCOMEnviarCargaMasivaEjecutivaNuevaParams">
			{call INT_PKG_COMIS.INT_PR_COM_CARGA_MASIV_EJECU(?,?,?,?,?,?,?,?,?,?)}
  </procedure>

     <!-- INTERFAZ - COMISIONES - GENERACION DE ARCHIVO DE EJECUTIVAS NUEVAS O ASPIRANTES -->
  <parameterMap id="executeInterfazCOMEnviarArchivoEjecutivaNuevaAspiranteParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="tipoComisionista"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazCOMEnviarArchivoEjecutivaNuevaAspirante" parameterMap="executeInterfazCOMEnviarArchivoEjecutivaNuevaAspiranteParams">
			{call INT_PKG_COMIS.INT_PR_COM_ARCHI_EJECU_NUEVA(?,?,?,?,?)}
  </procedure>

     <!-- INTERFAZ - ENVIO PAGO DE COMISIONES -->
  <parameterMap id="executeInterfazCOMEnviarFicheroPagoComisionEjecutivaParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="tipoComisionista"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"       		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoComision"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="comisionIngresos"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
  </parameterMap>
  <procedure id="executeInterfazCOMEnviarFicheroPagoComisionEjecutiva" parameterMap="executeInterfazCOMEnviarFicheroPagoComisionEjecutivaParams">
			{call INT_PKG_COMIS.INT_PR_COM_PAGOS_COMIS_EJECU(?,?,?,?,?,?,?,?)}
  </procedure>
  
														
														
  <!-- OBTIENE EL CODIGO DE COMPAIA-->														
  <select id="getCodigoCompania" parameterClass="java.util.Map" resultClass="java.lang.String">														
		<![CDATA[												
		SELECT INT_PKG_OCCRR.INT_FN_OCR_DEVUE_CODIG_COMPA(#codigoPais#) FROM dual												
		]]>												
  </select>	 													
  														
  <!--  INSERCION - OCR - ConsolidadoOCS CORPORATIVO Detalle -->
    <insert id="insertInterfazOCRRecepcionarConsolidadoOCSDetalleCorporativo" parameterClass="java.util.Map" >
    	<![CDATA[
	    INSERT INTO INT_SOLIC_POSIC
		  (OID_POSIC,
		   COD_PAIS,
		   CAM_SOLI,
		   COD_CLIE,
		   TIP_POSI,
		   COD_PROD,
		   UNI_DEMA,
		   NUM_LOTE,
		   STA_PROC)
		  SELECT SEQ_SOLIC_POS.NEXTVAL,
		         #codigoPais#,
		         CAM_SOLI,
		         COD_CLIE,
		         TIP_POSI,
		         COD_PROD,
		         UNI_DEMA,
		         (SELECT BAS.NUM_LOTE
		            FROM BAS_CTRL_FACT BAS
		           WHERE BAS.COD_PAIS = COD_PAIS
		             AND BAS.COD_PERI = CAM_SOLI),
		         DECODE(STA_PROC, '01', 'A', 'R')
		    FROM INT_OCR_SOLIC_POSIC
	    ]]>
	</insert>
    <!--  INSERCION - OCR - CORPORATIVO Cabecera -->
    <insert id="insertInterfazOCRRecepcionarConsolidadoOCSCabeceraCorporativo" parameterClass="java.util.Map" >
    	<![CDATA[
	    INSERT INTO INT_SOLIC_CABEC
		  (COD_PAIS,
		   CAM_SOLI,
		   COD_CLIE,
		   NUM_CLIE,
		   TIP_SOLI,
		   COD_SUBA,
		   COD_ACCE,
		   TIP_DESP,
		   FEC_SOLI,
		   STA_PROC,
		   OID_CAB,
		   NUM_LOTE)
		  SELECT #codigoPais#,
		         CAM_SOLI,
		         COD_CLIE,
		         NUM_CLIE,
		         TIP_SOLI,
		         COD_SUBA,
		         COD_ACCE,
		         TIP_DESP,
		         FEC_SOLI,
		         DECODE(STA_PROC, '01', 'A', 'R'),
		         SEQ_SOLIC_CAB.NEXTVAL,
		         (SELECT BAS.NUM_LOTE
		            FROM BAS_CTRL_FACT BAS
		           WHERE BAS.COD_PAIS = COD_PAIS
		             AND BAS.COD_PERI = CAM_SOLI)		  
		    FROM INT_OCR_SOLIC_CABEC
	    ]]>
	</insert>

  
    

   <!-- INTERFAZ - EVI - ENVIAR CABERECERA DE PEDIDOS DIGITADOS -->
  <parameterMap id="executeInterfazEVIEnviarCabecerasPedidosDigitadosParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>  
	<parameter property="periodo"		  		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
  
  <procedure id="executeInterfazEVIEnviarCabecerasPedidosDigitados" parameterMap="executeInterfazEVIEnviarCabecerasPedidosDigitadosParams">
  			{call EVI_PKG_EJECU_VIRTU.INT_PR_EVI_ENVIA_PEDIG_CABEC(?,?,?,?,?)}			
  </procedure>
  
 	<!-- INTERFAZ - REC - ENVIAR TRANSFERENCIA DE BOLETAS DE RECOJO-->
  <parameterMap id="executeInterfazRECEnviarTransferenciaBoletasRecojoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="indicadorVirtual"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="indicadorAnulacion"		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>									
	<parameter property="boletaCorte"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazRECEnviarTransferenciaBoletasRecojo" parameterMap="executeInterfazRECEnviarTransferenciaBoletasRecojoParams">
			{call INT_PKG_RECLA.INT_PR_REC_ENVIA_TRANS_BOREC(?,?,?,?,?,?,?)}											
  </procedure>
  <delete id="deleteInterfazRECEnviarTransferenciaBoletasRecojo">
        TRUNCATE TABLE INT_TMP_TRANS_BOREC
    </delete>
  
  <select id="getIndicadorAnulacionByCriteria" parameterClass="java.util.Map"  resultClass="string">
		SELECT RO.IND_ANUL
		  FROM INT_MAE_OPER_HOMOL MM, 
		       INT_REC_OPER_HOMOL RR, 
		       REC_OPERA RO
		 WHERE RR.COD_PAIS = RR.COD_PAIS
		   AND RR.COD_PAIS = #codigoPais#
		   AND RR.COD_OPER_HOMOL = MM.COD_OPER_HOMOL
		   AND MM.COD_OPER_HOMOL = #codigoOperacion#
		   AND RR.COD_OPER = RO.COD_OPER
		   AND ROWNUM=1
  </select>
  
  <insert id="insertInterfazRECEnviarTransferenciaBoletasRecojo" parameterClass="java.util.Map" >
    	<![CDATA[
	    INSERT INTO INT_TMP_TRANS_BOREC
		  (NUM_LOTE,
		   COD_PAIS,
		   COD_CANA,
		   COD_ACCE,
		   COD_SUAC,
		   TIP_PERI,
		   COD_PERI,
		   FEC_ENVI,
		   TIP_OFER,
		   TIP_MOVI_ALMA,
		   COD_NEGO,
		   COD_MARC,
		   IND_IST,
		   COD_SAP,
		   COD_PROD_DISC,
		   NUM_UNID_RECO,
		   NUM_UNID_RECL,
		   VAL_PREC_VENT,
		   VAL_PREC_CONT,
		   COD_ALMA_ORIG,
		   COD_ALMA_DEST,
		   VAL_NUM_DOCU,
		   COD_OPER,
		   TIP_OPER,
		   COD_ESTA_BORE,
		   IND_DISC,
		   COD_CABE_BORE,
           COD_LINE_BORE,
           NUM_SECU,
           VAL_NUME_BORE,
           OID_LINE_OPER_RECL,
           IND_ANUL,
                   REFE_COD_LINE_BORE,
                   NUM_UNID_ELIM,
                   COD_OPER_HOMO)														
		SELECT #numeroLote#,
		       CB.COD_PAIS,
		       'VD' CANAL,
		       'GZ' ACCESO,
		       '000' SUBACCESO,
		       'CM' TIPOPERIODO,
		       CB.COD_PERI_PROC,
		   TRUNC(SYSDATE),												
                   '000' COD_TIPO_OFER,														
		   '' COD_MOVI_SAP,												
                   '000' COD_NEGO,														
                   '000' COD_MARC_PROD,														
	           '' IND_MOVIM,												
               OCR_SOLIC_PEDIDOS.GEN_FN_CODSAP_PROD(LB.PROD_OID_PROD) COD_SAP,
               OCR_SOLIC_PEDIDOS.GEN_FN_CODSAP_PROD(LB.PROD_OID_PROD_DISC) COD_PROD_DISC,
		       LB.NUM_UNID_RECO,
		       LB.NUM_UNID_RECL,
		       '000' VAL_PREC,												
		       '000' VAL_PREC_CONT,												
		       AL.COD_ALMA,
		       '',
		       '',
		       LB.COD_OPER,
		       DECODE(PAR.IND_OPER_FIS, 0, NULL, TOP.VAL_TIPO_OPER) VAL_TIPO_OPER,												
		       (    SELECT COD_ESTA_BORE
                    FROM INT_REC_ESTAD_BOREC
                    WHERE OID_ESTA_BORE = CB.ESBO_OID_ESTA_BOR2
                    AND COD_PAIS = #codigoPais#
                    AND NVL_ESTA_BORE = 2
               ) COD_ESTA_BORE,												
		       LB.IND_DISC,												
               CB.COD_CABE_BORE,
               LB.COD_LINE_BORE,
               LB.NUM_SECU,
               CB.VAL_NUME_BORE,
               LB.LOR_OID_LINE_OPER_RECL,														
               '0',
               LB.REFE_COD_LINE_BORE,
               LB.NUM_UNID_ELIM	,
               (SELECT COD_OPER_HOMO FROM REC_HOMOL_OPERA_SAP 
                   WHERE COD_OPER = DECODE(PAR.IND_OPER_FIS, 0, NULL, OP.COD_OPER))													
		  FROM INT_REC_LINEA_BOREC LB,
		       INT_REC_CABEC_BOREC CB,
		       SEG_PERIO_CORPO     SP,
		       REC_OPERA_RECLA     RO,
		       REC_TIPOS_OPERA     TOP,
		       REC_OPERA           OP,
		       BEL_ALMAC           AL,
		       SEG_PAIS            P,
		       (
				 SELECT COD_OPER
				 FROM INT_MAE_OPER_HOMOL MM,
				 	  INT_REC_OPER_HOMOL RR
				 WHERE  RR.COD_PAIS = RR.COD_PAIS
				 AND RR.COD_PAIS = #codigoPais#
				 AND RR.COD_OPER_HOMOL = MM.COD_OPER_HOMOL
				 AND MM.COD_OPER_HOMOL = #codigoOperacion#
				 ) T_OPERA,
				 REC_PARAM_ENVIO_SAP PAR   										
		 WHERE CB.COD_CABE_BORE = LB.COD_CABE_BORE
		   AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'CE')
		   AND CB.IND_PROC_ALMA_FISI = 'V'
		   AND LB.IND_PROC_ALMA_FISI = 'V'
		   AND CB.COD_PAIS = #codigoPais#
		   AND CB.COD_PERI_PROC = SP.COD_PERI
		   AND SP.TIPE_OID_TIPO_PERI IN  (SELECT OID_TIPO_PERI FROM SEG_TIPO_PERIO WHERE COD_TIPO_PERI = 'CM')
		   AND RO.OID_OPER_RECL = LB.OPRE_OID_OPER_RECL
		   AND TOP.OID_TIPO_OPER = RO.TIOP_OID_TIPO_OPER
		   AND TOP.ROPE_OID_OPER = OP.OID_OPER
		   AND OP.ALMC_OID_ALMA = AL.OID_ALMA
		   AND P.COD_PAIS = CB.COD_PAIS
		   AND P.COD_PAIS = PAR.COD_PAIS																						
		   AND T_OPERA.COD_OPER = LB.COD_OPER
		   AND CB.FEC_CIERR <= TO_DATE(#fechaFinal#,'DD/MM/YYYY')
           AND CB.FEC_CIERR >= TO_DATE(#fechaInicial#,'DD/MM/YYYY')
		   ]]>
		   <iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
				 CB.COD_REGI   = #regionList[]#
		   </iterate> 
	</insert>		
		   
	<insert id="insertInterfazRECEnviarTransferenciaBoletasRecojoAnulacion" parameterClass="java.util.Map" >
	   <![CDATA[
		INSERT INTO INT_TMP_TRANS_BOREC
		  (NUM_LOTE,
		   COD_PAIS,
		   COD_CANA,
		   COD_ACCE,
		   COD_SUAC,
		   TIP_PERI,
		   COD_PERI,
		   FEC_ENVI,
		   TIP_OFER,
		   TIP_MOVI_ALMA,
		   COD_NEGO,
		   COD_MARC,
		   IND_IST,
		   COD_SAP,
		   COD_PROD_DISC,
		   NUM_UNID_RECO,
		   NUM_UNID_RECL,
		   VAL_PREC_VENT,
		   VAL_PREC_CONT,
		   COD_ALMA_ORIG,
		   COD_ALMA_DEST,
		   VAL_NUM_DOCU,
		   COD_OPER,
		   TIP_OPER,
		   COD_ESTA_BORE,
		   IND_DISC,
		   COD_CABE_BORE,
		   COD_LINE_BORE,
		   NUM_SECU,
		   VAL_NUME_BORE,
		   OID_LINE_OPER_RECL,
		   IND_ANUL,
           REFE_COD_LINE_BORE,
           COD_OPER_HOMO)           														
		  SELECT #numeroLote#,
		         P.COD_PAIS,
		         'VD',
		         'GZ',
		         '000',
		         'CM',
		         SP.COD_PERI,
                 TRUNC(SYSDATE), 														
                 '000' COD_TIPO_OFER,														
                 '06' COD_MOVI_SAP,
                 '000' COD_NEGO,														
                 '000' COD_MARC_PROD,														
		         'I' IND_MOVIM,
                 OCR_SOLIC_PEDIDOS.GEN_FN_CODSAP_PROD(lor.PROD_OID_PROD) COD_SAP,
		         NULL,
		         LOR.NUM_UNID_DEVU,
		         LOR.NUM_UNID_RECL,
                 '000',														
                 '000',														
		         AL.COD_ALMA,
		         NULL,
		         NULL,
		         OP.COD_OPER,
                 TOP.VAL_TIPO_OPER ,														
		         NULL,
		         NULL,
		         NULL,
		         NULL,
		         NULL,
		         NULL,
		         LOR.OID_LINE_OPER_RECL,
		         '1',
                 NULL,
                 (SELECT COD_OPER_HOMO FROM REC_HOMOL_OPERA_SAP  WHERE COD_OPER = OP.COD_OPER)
		    FROM SEG_PERIO_CORPO       SP,
		         REC_CABEC_RECLA       CR,
		         REC_OPERA_RECLA       RO,
		         REC_LINEA_OPERA_RECLA LOR,
		         REC_TIPOS_OPERA       TOP,
		         REC_OPERA             OP,
		         BEL_ALMAC             AL,
		         CRA_PERIO             CRA,
                 SEG_PAIS              P														
		   WHERE P.COD_PAIS = #codigoPais#
		     AND CR.PERD_OID_PERI_RECL = CRA.OID_PERI
             AND CR.ESRE_OID_ESTA_RECL IN (4,6)
             AND RO.ESOP_OID_ESTA_OPER IN (5,2)
		     AND CRA.PERI_OID_PERI = SP.OID_PERI
		     AND SP.TIPE_OID_TIPO_PERI IN
		         (SELECT OID_TIPO_PERI
		            FROM SEG_TIPO_PERIO
		           WHERE COD_TIPO_PERI = 'CM')
		     AND RO.OID_OPER_RECL = LOR.OPRE_OID_OPER_RECL
		     AND RO.CARE_OID_CABE_RECL = CR.OID_CABE_RECL
		     AND TOP.OID_TIPO_OPER = RO.TIOP_OID_TIPO_OPER
		     AND TOP.ROPE_OID_OPER = OP.OID_OPER
		     AND OP.ALMC_OID_ALMA = AL.OID_ALMA
		     AND LOR.NUM_UNID_DEVU = 0
		     AND LOR.NUM_UNID_RECL<>0
             AND OP.IND_ANUL = 1
		     AND CR.FEC_INGR >= TO_DATE(#fechaInicial#,'DD/MM/YYYY')
		     AND CR.FEC_INGR <= TO_DATE(#fechaFinal#,'DD/MM/YYYY')
		     ]]>
		     AND EXISTS (SELECT REGI.OID_REGI
		            FROM ZON_REGIO REGI
		           WHERE EXISTS (SELECT ZREG.OID_REGI
		                    FROM ZON_TERRI_ADMIN     ZADM,
		                         ZON_SECCI           ZSEC,
		                         ZON_ZONA            ZZON,
		                         ZON_REGIO           ZREG,
		                         SEG_PAIS            PA,
		                         ZON_SUB_GEREN_VENTA ZSGV
		                   WHERE (ZSEC.OID_SECC = ZADM.ZSCC_OID_SECC)
		                     AND (ZZON.OID_ZONA = ZSEC.ZZON_OID_ZONA)
		                     AND (ZREG.OID_REGI = ZZON.ZORG_OID_REGI)
		                     AND (ZSGV.OID_SUBG_VENT = ZREG.ZSGV_OID_SUBG_VENT)
		                     AND (PA.OID_PAIS = ZADM.PAIS_OID_PAIS)
		                     AND (PA.COD_PAIS = #codigoPais#)
		                     AND ZADM.OID_TERR_ADMI = CR.ZTAD_OID_TERR_ADMI
		                     AND REGI.OID_REGI = ZREG.OID_REGI
		                     <iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
		              				 REGI.COD_REGI   = #regionList[]#
		              		   </iterate>                 
		                    )
		      )
	</insert>

  <resultMap id="resultadoDetalleOfertaByPeriodoCUV" class="java.util.HashMap">														
    <result property="codigoVenta"	                   column="val_codi_vent"	/>												
    <result property="codigoTipoEstrategia" 		       column="cod_tipo_estr"	/>											
  </resultMap>														
														
  <select id="getDetalleOfertaByPeriodoCUV" parameterClass="java.util.Map" resultMap="resultadoDetalleOfertaByPeriodoCUV">														
	SELECT ofd.oid_deta_ofer, 													
	       ofe.oid_ofer, 													
	       cmf.oid_cabe, 													
	       cmf.perd_oid_peri,													
	       pco.COD_PERI,													
	       ofd.val_codi_vent, 													
	       ofe.coes_oid_estr, 													
	       tes.cod_tipo_estr													
	  FROM pre_matri_factu_cabec cmf,													
	       pre_ofert ofe,													
	       pre_ofert_detal ofd,													
	       pre_estra est,													
	       pre_tipo_estra tes, 													
	       CRA_PERIO per, 													
	       SEG_PAIS pai,													
	       SEG_CANAL can,													
	       SEG_PERIO_CORPO pco													
	 WHERE ofe.mfca_oid_cabe = cmf.oid_cabe													
	   AND ofd.ofer_oid_ofer = ofe.oid_ofer													
	   AND ofe.coes_oid_estr = est.oid_estr													
	   AND est.ties_oid_tipo_estr = tes.oid_tipo_estr													
	   AND cmf.perd_oid_peri = per.OID_PERI													
	   AND per.PAIS_OID_PAIS = pai.OID_PAIS													
	   AND per.CANA_OID_CANA = can.OID_CANA													
	   AND per.PERI_OID_PERI = pco.OID_PERI													
	   AND pai.COD_PAIS = #codigoPais#													
	   AND can.COD_CANA = #canalDefecto#													
    <isNotEmpty prepend="" property="codigoVenta">														
	   AND ofd.val_codi_vent = #codigoVenta#													
    </isNotEmpty>														
    <isNotEmpty prepend="" property="codigoPeriodo">														
       AND pco.COD_PERI = #codigoPeriodo#														
    </isNotEmpty>														
  </select>	      													
														
	<parameterMap id="paramExportMatriz" class="map" >													
		<parameter property="codPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="codPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="codCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="listaCodMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="listaCodCatalogo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="pagDesde" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="pagHasta" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="listaCUV" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>												
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>												
	</parameterMap>													
														
	<procedure id="procesoExportarMatriz" parameterMap="paramExportMatriz" >													
		{call PRE_PKG_MATRIZ.pre_pr_exportar_matriz_a_lbel(?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}												
	</procedure>													
														
	<parameterMap id="paramCambioCodigoVenta" class="map" >													
		<parameter property="codPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="codPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="codCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="cuvActual" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="cuvNuevo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>												
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>												
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT"/>												
	</parameterMap>													
														
	<procedure id="procesoCambioCodigoVenta" parameterMap="paramCambioCodigoVenta" >													
		{call PRE_PKG_MATRIZ.pre_pr_cambio_codigo_venta(?, ?, ?, ?, ?, ?, ?)}												
	</procedure>													
														
							
	<delete id="deleteInterfazOCRRecepcionarDWHOCR">													
        TRUNCATE TABLE INT_OCR_DWH														
    </delete>														
														
	<parameterMap id="executeInterfazOCRRecepcionarDWHOCRParams" class="map" >													
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>														
														
	<procedure id="executeInterfazOCRRecepcionarDWHOCR"  parameterMap="executeInterfazOCRRecepcionarDWHOCRParams" >													
		{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_DWH_OCR(?,?,?,?)}												
    </procedure>														
														
	<delete id="deleteInterfazOCRRecepcionarFichaInscripcionPrivilege">													
        TRUNCATE TABLE INT_OCR_FICHA_INSCR_PRIVI														
    </delete>														
														
	<parameterMap id="executeInterfazOCRRecepcionarFichaInscripcionPrivilegeParams" class="map" >													
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>														
														
	<procedure id="executeInterfazOCRRecepcionarFichaInscripcionPrivilege"  parameterMap="executeInterfazOCRRecepcionarFichaInscripcionPrivilegeParams" >													
		{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_FICHA_PRIVI(?,?,?,?)}												
    </procedure>														
														
	<delete id="deleteInterfazOCRRecepcionarServiciosPostventasCabec">													
        TRUNCATE TABLE INT_OCR_CABEC_SERVI_POSTV														
    </delete>														
														
	<parameterMap id="executeInterfazOCRRecepcionarServiciosPostventasCabecParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numLoteSTO"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

	<procedure id="executeInterfazOCRRecepcionarServiciosPostventasCabec"  parameterMap="executeInterfazOCRRecepcionarServiciosPostventasCabecParams" >
		{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_POSVE_CABEC(?,?,?,?,?)}
    </procedure>

	<parameterMap id="executeInterfazOCRRecepcionarServiciosPostventasDetalParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numLoteSTO"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

	<procedure id="executeInterfazOCRRecepcionarServiciosPostventasDetal"  parameterMap="executeInterfazOCRRecepcionarServiciosPostventasDetalParams" >
		{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_POSVE_DETAL(?,?,?,?,?)}
    </procedure>

      <parameterMap id="executeInterfazOCRRecepcionarSolicitudPremiosPrivilegeDetalleParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>														
														
    <procedure id="executeInterfazOCRRecepcionarSolicitudPremiosPrivilegeDetalle"														
    			  parameterMap="executeInterfazOCRRecepcionarSolicitudPremiosPrivilegeDetalleParams" >											
				{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_SOLPP_DETAL(?,?,?,?)}										
    </procedure>														
    														
     <parameterMap id="executeInterfazOCRRecepcionarArriboZonasParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>														
														
    <procedure id="executeInterfazOCRRecepcionarArriboZonas"														
    			  parameterMap="executeInterfazOCRRecepcionarArriboZonasParams" >											
				{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_ARRIB_ZONAS(?,?,?,?)}										
    </procedure>														
      														
	<parameterMap id="executeInterfazOCRRecepcionarSeguimientoPedidoParams" class="map" >													
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>														
														
    <procedure id="executeInterfazOCRRecepcionarSeguimientoPedido"														
    			  parameterMap="executeInterfazOCRRecepcionarSeguimientoPedidoParams" >											
				{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_SEGUI_PEDID(?,?,?,?)}										
    </procedure>  														
														
	 													
<delete id="deleteInterfazOCRRecepcionarSolicitudCredito">
        TRUNCATE TABLE INT_OCR_SOLIC_CREDI
    </delete>
    
    <parameterMap id="executeInterfazOCRRecepcionarSolicitudCreditoParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    <parameter property="indicadorOrigen"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazOCRRecepcionarSolicitudCredito"
    			  parameterMap="executeInterfazOCRRecepcionarSolicitudCreditoParams" >
				{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_SOLIC_CREDI(?,?,?,?,?)}										
    </procedure>  
   
	<delete id="deleteInterfazOCRRecepcionarActualizacionDatos">
        TRUNCATE TABLE INT_OCR_ACTUA_DATOS
    </delete>
    
    <parameterMap id="executeInterfazOCRRecepcionarActualizacionDatosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    <parameter property="indicadorOrigen"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

	<procedure id="executeInterfazOCRRecepcionarActualizacionDatos"  parameterMap="executeInterfazOCRRecepcionarActualizacionDatosParams" >
		{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_ACTUA_DATOS(?,?,?,?,?)}												
    </procedure>
 
    <delete id="deleteInterfazOCRRecepcionarPagare">														
        TRUNCATE TABLE INT_OCR_PAGAR														
    </delete>														
    														
    <parameterMap id="executeInterfazOCRRecepcionarPagareParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>

	<procedure id="executeInterfazOCRRecepcionarPagare"  parameterMap="executeInterfazOCRRecepcionarPagareParams" >													
		{call INT_PKG_OCCRR.INT_PR_OCR_RECEP_PAGAR(?,?,?,?)}												
    </procedure>

   <delete id="deleteInterfazOCRRecepcionarSolicitudPremiosPrivilegeCabecera">														
        TRUNCATE TABLE INT_OCR_SOLPP_CABEC														
    </delete>														
    														
    <parameterMap id="executeInterfazOCRRecepcionarSolicitudPremiosPrivilegeCabeceraParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>														
														
	<procedure id="executeInterfazOCRRecepcionarSolicitudPremiosPrivilegeCabecera"  parameterMap="executeInterfazOCRRecepcionarSolicitudPremiosPrivilegeCabeceraParams" >													
		{call INT_PKG_OCCRR.INT_PR_OCR_SOLPP_CABEC(?,?,?,?)}												
    </procedure>														

    <delete id="deleteInterfazOCRRecepcionarTablaControlMultiformato">														
        TRUNCATE TABLE INT_OCR_MULTI_CTRL														
    </delete>

  <parameterMap id="executeInterfazOCRRecepcionarTablaControlMultiformatoParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numLoteArchivo"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"			     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfazCompuesta"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="idProcesoBatch"    	     jdbcType="VARCHAR" javaType="java.lang.Long"    mode="IN"/>		
		<parameter property="codigoUsuario"    			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
    </parameterMap>														
														
	<procedure id="executeInterfazOCRRecepcionarTablaControlMultiformato"  parameterMap="executeInterfazOCRRecepcionarTablaControlMultiformatoParams" >													
		{call INT_PKG_OCCRR.INT_PR_OCR_MULTI_CTRL(?,?,?,?,?,?,?,?,?)}												
    </procedure>

  <parameterMap id="executeInterfazSATEnviarCostosPorCajaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		</parameterMap>
  <procedure id="getInterfazSATEnviarCostosPorCaja"  parameterMap="executeInterfazSATEnviarCostosPorCajaParams" >
		{call INT_PKG_SAT.INT_PR_SAT_CPC(?,?,?,?,?)}
    </procedure>
  
    <parameterMap id="executeInterfazSATEnviarEstibadosAFPParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		</parameterMap>
  <procedure id="getInterfazSATEnviarEstibadosAFP"  parameterMap="executeInterfazSATEnviarEstibadosAFPParams" >
		{call INT_PKG_SAT.INT_PR_SAT_EAFP(?,?,?,?,?)}
    </procedure>
   
    <parameterMap id="executeInterfazSATEnviarVolumenesValorizacionPorSeccionDiaParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		</parameterMap>
  <procedure id="getInterfazSATEnviarVolumenesValorizacionPorSeccionDia"  parameterMap="executeInterfazSATEnviarVolumenesValorizacionPorSeccionDiaParams" >
		{call INT_PKG_SAT.INT_PR_SAT_VVSD(?,?,?,?,?)}
    </procedure>
    
     <!-- INTERFAZ - Hoja de Picking -->  
    <resultMap id="executeFormatoFechaResult" class="java.util.HashMap">
            <result property="formatoFecha"	 				   column="formatoFecha"/>
      </resultMap>
    
    
  <select id="getFormatoFecha" parameterClass="java.util.Map" resultMap="executeFormatoFechaResult">
  <![CDATA[
     (SELECT P.VAL_FORM_FECH formatoFecha FROM SEG_PAIS P WHERE P.COD_PAIS=#codigoPais#)	   

 ]]>
  </select>														
														
     <!-- INTERFAZ - Hoja de Picking -->  														
    <resultMap id="executeInterfazSATEnviarHojaPickingResult" class="java.util.HashMap">
            <result property="cliente"	 				   column="COD_CLIEN"/>
            <result property="lotefact"		               column="NUM_LOTE_FACT"/>
            <result property="fechafacturacion"            column="FEC_FACT"/>
            <result property="expor"			           column="EXPOR"/>
            <result property="consultora"			       column="CONSULTORA"/>
            <result property="numcaja"			           column="NUM_CAJA"/>
            <result property="codigocaja"	               column="CODI_CAJA"/>
            <result property="numesoli"		               column="VAL_NUME_SOLI"/>
            <result property="codigoproducto"	           column="COD_SAP"/>
            <result property="descripcion"			       column="DES_CORT"/>
            <result property="facturadas"		           column="NUM_UNID_CHEQ"/>
            <result property="picadas"			           column="NUM_UNID_PICA"/>
      </resultMap>
    
    
  <select id="getInterfazSATEnviarHojaPicking" parameterClass="java.util.Map" resultMap="executeInterfazSATEnviarHojaPickingResult">
  <![CDATA[
SELECT distinct '0000' || (SELECT ex.cod_clie_expo
                    FROM  sat_param_expor ex
                   WHERE ex.pais_cod_pais = #codigoPais#) cod_clien,sublinea.COD_SUBL_ARMA,
       DECODE(LENGTH(PED.VAL_NUME_SOLI),10,PED.VAL_NUME_SOLI,'0' || PED.VAL_NUME_SOLI) VAL_NUME_SOLI, 			  											
       '00'||TRIM(TO_CHAR(TO_DATE(#fechaFacturacion#,'DD/MM/YYYY'), 'YYYYMMDD')) 
       NUM_LOTE_FACT,														
	    PED.fec_fact ,													
       (SELECT ex.cod_cent_expo
          FROM  sat_param_expor ex
         WHERE ex.pais_cod_pais = #codigoPais#) expor,
       (SELECT    (CASE
                      WHEN LENGTH (c.cod_clie) = 8
                         THEN '00'
                      WHEN LENGTH (c.cod_clie) = 9
                         THEN '0'
                      ELSE ''
                   END
                  )
               || c.cod_clie
          FROM mae_clien c
         WHERE c.oid_clie = CAB.CLIE_OID_CLIE) consultora,
       (SELECT (CASE WHEN LENGTH (de.num_caja) = 1 THEN '00'														
                     WHEN LENGTH (de.num_caja) = 2 THEN '0'														
                     ELSE ''														
               END)|| de.NUM_CAJA 
		 FROM APE_LISTA_PICAD_DETAL de														
         WHERE de.OID_LIST_PICA_DETA = det.OID_LIST_PICA_DETA ) num_caja,														
       (SELECT DISTINCT caja.cod_equi
                   FROM  sat_homol_caja caja
                  WHERE caja.pais_cod_pais = #codigoPais#
                    AND caja.cod_caja IN (
                           SELECT DISTINCT caja.val_tipo_caja
                                      FROM  ape_tipo_caja_embal caja
                                     WHERE caja.oid_tipo_caja_emba =
                                                   det.tcem_oid_tipo_caja_emba))
                                                                    codi_caja,
        producto.cod_sap cod_sap,
       (SELECT seg.val_i18n
          FROM  gen_i18n_sicc_pais seg
         WHERE seg.attr_enti = 'MAE_PRODU'
           AND seg.val_oid = producto.oid_prod) des_cort, det.num_unid_prod num_unid_cheq,
           (SELECT (case when et.estp_oid_esta_pedi = 1 or et.estp_oid_esta_pedi=2 or  et.estp_oid_esta_pedi=6 or et.estp_oid_esta_pedi=7
           then det.num_unid_prod else NVL(det.NUM_UNID_VERI,det.num_unid_prod) end ) from ape_etiqu et where et.lpca_oid_list_pica_cabe= cab.oid_list_pica_cabe														
           and et.num_caja = det.num_caja) num_unid_pica
  FROM  ape_lista_picad_cabec cab INNER JOIN  ape_lista_picad_detal det 
       ON det.lpca_oid_list_pica_cabe = cab.oid_list_pica_cabe
  INNER JOIN PED_SOLIC_CABEC PED ON PED.OID_SOLI_CABE =CAB.SOCA_OID_SOLI_CABE
  INNER JOIN  APE_MAPA_CENTR_DISTR_DETAL MAPA ON MAPA.OID_MAPA_CENT_DIST_DETA = DET.MCDD_OID_MAPA_CENT_DIST_DETA
  INNER JOIN  APP_CONFI_CENTR_DISTR CENTRO ON CAB.CCDI_OID_CONF_CENT_DIST = CENTRO.OID_CONF_CENT_DIST
  AND CENTRO.COD_CENT_DIST=#codigoCentro#
  INNER JOIN  APE_LINEA_ARMAD LINEA ON LINEA.OID_LINE_ARMA = CAB.LIAR_OID_LINE_ARMA
  AND LINEA.NUM_CODI_LINE =#codigoLinea#														
  INNER JOIN  ape_subli_armad sublinea ON sublinea.OID_SUBL_ARMA  = MAPA.SBAR_OID_SUBL_ARMA
       INNER JOIN  mae_produ producto ON producto.oid_prod = det.prod_oid_prod
								   AND CAB.fec_factU = TO_DATE(#fechaFacturacion#,'dd/mm/yyyy')
	   ORDER BY 3						

 ]]>
  </select>
   
    <!-- INTERFAZ - SAT-5 - AFP POR CONSULTORA -->  
    <resultMap id="executeInterfazSATEnviarAFPConsultoraResult" class="java.util.HashMap">
            <result property="compania" 				   column="COMPANIA"/>
            <result property="codigocampana"               column="VAL_NOMB_PERI"/>
            <result property="indicodigoboleta"            column="VAL_NOMB_PERI"/>
            <result property="numboletadespacho"           column="VAL_NUME_SOLI"/>
            <result property="codigotipobolsades"          column="TSPA_OID_TIPO_SOLI_PAIS_CONS"/>
            <result property="codigoacceso"                column="COD_ACCE"/>
            <result property="codigosubacceso"             column="COD_SBAC"/>
            <result property="codigoproducto"              column="CODI_ANTI"/>
            <result property="unidadesatendidas"           column="NUM_UNID_ATEN"/>
            <result property="preciocatalogounitotal"      column="VAL_PREC_CATA_UNIT_LOCA"/>
      </resultMap>
    
    
  <select id="getInterfazSATEnviarAFPConsultora" parameterClass="java.util.Map" resultMap="executeInterfazSATEnviarAFPConsultoraResult">
  <![CDATA[
      SELECT distinct '00' AS COMPANIA, CP.VAL_NOMB_PERI, PSPA.NUM_CONS, PSC.VAL_NUME_SOLI ,PSC.TSPA_OID_TIPO_SOLI_PAIS_CONS, SA.COD_ACCE, SSA.COD_SBAC,
            P.CODI_ANTI, PSPA.NUM_UNID_ATEN, PSPA.VAL_PREC_CATA_UNIT_LOCA
      FROM PED_SECUE_PROCE PSP,
            PED_PROCE PP,
            PED_SOLIC_CABEC PSC,
            PED_SOLIC_POSIC PSPA,
            SEG_PAIS SP,
            CRA_PERIO CP,
            SEG_ACCES SA,
            SEG_SUBAC SSA,
            MAE_PRODU P
   
      WHERE PSP.PROC_OID_PROC = PP.OID_PROC
      AND PP.COD_PROC = 'P523'
      AND PSC.PAIS_OID_PAIS = SP.OID_PAIS AND PSC.FEC_FACT=to_date(#fechaFacturacion#, 'dd/mm/yyyy') 
      AND PSPA.SOCA_OID_SOLI_CABE = PSC.OID_SOLI_CABE
      AND PSC.PAIS_OID_PAIS = SP.OID_PAIS AND SP.COD_PAIS=#codigoPais#
      AND PSC.SBAC_OID_SBAC = SSA.OID_SBAC
      AND SSA.ACCE_OID_ACCE = SA.OID_ACCE
      AND PSPA.PROD_OID_PROD = P.OID_PROD
      AND PSC.PERD_OID_PERI = CP.OID_PERI]]>
  </select>  
   <!-- INTERFAZ - SAT-8 - ENVIAR CRONOGRAMA POR ZONAS -->  
	<resultMap id="executeInterfazSATEnviarCronogramaZonasResult" class="java.util.HashMap">
		<result property="codigopais" 				column="COD_PAIS"/>
		<result property="compania" 				column="COMPANIA"/>
		<result property="codigomarca" 				column="COD_MARC"/>
		<result property="codigocanal" 				column="COD_CANA"/>
		<result property="codigocampana" 			column="COD_PERI"/>
		<result property="codigoactividad" 			column="COD_ACTI"/>
		<result property="codigosgv" 				column="COD_SUBG_VENT"/>
		<result property="codigoregion" 			column="COD_REGI"/>
		<result property="codigozona" 				column="COD_ZONA"/>
		<result property="fecactividadzona"			column="FEC_INIC"/>
    	</resultMap>
    														
 														
														
  	<select id="getInterfazSATEnviarCronogramaZonas" parameterClass="java.util.Map" 			
  	resultMap="executeInterfazSATEnviarCronogramaZonasResult">
  														
  														
  		SELECT  
  			P.COD_PAIS,
  			'00' AS COMPANIA, 
  			M.COD_MARC, 
  			C.COD_CANA, 
  			PERCORP.COD_PERI, 
  			CA.COD_ACTI, 
  			SGV.COD_SUBG_VENT, 
  			R.COD_REGI, 
  			Z.COD_ZONA, 
  			CP.FEC_INIC
    	FROM CRA_PERIO CP,
         	SEG_CANAL C,
		 	SEG_MARCA M,
         	CRA_ACTIV CA,
		 	ZON_SUB_GEREN_VENTA SGV,
		 	ZON_REGIO R, 
		 	SEG_PAIS P,
		 	ZON_ZONA Z, 
			SEG_PERIO_CORPO PERCORP
   		WHERE
   		 P.COD_PAIS=#codigoPais# AND 
		 R.IND_ACTI = 1
		 AND Z.IND_ACTI = 1
		AND CP.PAIS_OID_PAIS= P.OID_PAIS
   		 AND <![CDATA[ROWNUM  < 19 ]]>
   		 AND <![CDATA[CP.FEC_FINA >= TRUNC(SYSDATE)]]>
		 												
		 ORDER BY FEC_INIC
														
  														
   														
   														
  	</select>
<resultMap id="executeInterfazSATEnviarArchControlResult" class="java.util.HashMap">
<result property="com" 									column="COM"/>
		<result property="codigosecuencia" 				column="SECUENCIA"/>
		<result property="nombreArchivo" 				column="NOMBREARCHIVO"/>
		<result property="totales" 							column="REG_PROC"/>
		<result property="codigopais" 						column="PAIS_COD_PAIS"/>
		<result property="codigocompania" 				column="COMPANIA"/>
		<result property="campana" 							column="CAMPANA"/>
		<result property="fechaFacturacion" 			column="FEC_FPRO"/>
    	</resultMap>
	<!-- INTERFAZ - ARCHIVO CONTROL -->  
	<resultMap id="executeInterfazSATEnviarArchivoControlResult" class="java.util.HashMap">
		<result property="com" 									column="COM"/>
		<result property="codigosecuencia" 				column="SECUENCIA"/>
		<result property="nombreArchivo" 				column="NOMBREARCHIVO"/>
		<result property="totales" 							column="REG_PROC"/>
		<result property="codigopais" 						column="PAIS_COD_PAIS"/>
		<result property="codigocompania" 				column="COMPANIA"/>
		<result property="campana" 							column="CAMPANA"/>
		<result property="fechaFacturacion" 			column="FEC_FPRO"/>

    	</resultMap>
    
    
	<resultMap id="executeInterfazSATEnviarArchivoControlDosResult" class="java.util.HashMap">
		
		<result property="com" 									column="COM"/>
		<result property="codigosecuencia" 				column="SECUENCIA"/>
		<result property="nombreArchivo" 				column="NOMBREARCHIVO"/>
		<result property="totales" 							column="REG_PROC"/>
		<result property="codigopais" 							column="PAIS_COD_PAIS"/>
		<result property="codigocompania" 				column="COMPANIA"/>
		<result property="campana" 							column="CAMPANA"/>
		<result property="fechaFacturacion" 			column="FEC_FPRO"/>

    	</resultMap>
														
														
	<resultMap id="executeInterfazSATEnviarACResult" class="java.util.HashMap">
														
		<result property="com" 									column="COM"/>
		<result property="codigosecuencia" 				column="SECUENCIA"/>
		<result property="nombreArchivo" 				column="NOMBREARCHIVO"/>
		<result property="totales" 							column="REG_PROC"/>
		<result property="codigopais" 							column="COMPANIA"/>
		<result property="codigocompania" 				column="COMPANIA"/>
		<result property="campana" 							column="CAMPANA"/>
		<result property="fechaFacturacion" 			column="FEC_FPRO"/>
														
    	</resultMap>
<select id="getInterfazSATEnviarArchivoControlTodo" parameterClass="java.util.Map" 			
  	resultMap="executeInterfazSATEnviarArchivoControlResult">
	<![CDATA[													
	SELECT 'COM' AS com, ROWNUM AS secuencia,
		          inte_cod_inte || num_lote AS nombrearchivo, lotes.reg_proc,
       		      #codigoPais#  PAIS_COD_PAIS, '00' AS compania,
				  SUBSTR(PERIODO.VAL_NOMB_PERI,9,6) CAMPANA
       		      lotes.fec_fpro
  	FROM bas_histo_lotes lotes
 	WHERE sist_cod_sist = 'SAT' 
 	AND ROWNUM =8
	AND INTE_COD_INTE <> 'SAT-10'									
	AND 	INTE_COD_INTE <> 'SAT-11' 	AND	INTE_COD_INTE <> 'SAT-12'	
	AND FEC_INIC < to_date(#fechaFacturacion#, 'dd/mm/yyyy') AND FEC_FINA > to_date(#fechaFacturacion#, 'dd/mm/yyyy') 								
 	AND TRUNC(FEC_FPRO) = to_date(#fechaFacturacion#, 'dd/mm/yyyy') 
 	ORDER BY FEC_FPRO DESC 		
			 ]]>											
  	</select>

     <!-- INTERFAZ - COSTOS X CAJA SELECT -->  
    <resultMap id="executeInterfazSATEnviarCostosCajaResult" class="java.util.HashMap">
            <result property="codigoPais"	 				   column="PAIS"/>
	    	<result property="compania"	 				   column="COMPANIA"/>
            <result property="codigomarca"				   column="codigomarca"/>
            <result property="codigocanal"				   column="codigocanal"/>
            <result property="numconsolidado"			   column="numConsolidado"/>
            <result property="codigoproceso"			   column="TIPOPROCESO"/>
            <result property="fechafacturacion"			   column="fechaprogramadafac"/>
            <result property="campana"					   column="codigocampana"/>
            <result property="codigosgv"					   column="codigosgv"/>
            <result property="codigoregion"			       column="codigoregion"/>
            <result property="codigozona"			       column="codigozona"/>
            <result property="codigoseccion"				   column="codigoseccion"/>
            <result property="territorio"					   column="TERRITORIO"/>
	    	<result property="numcaja"					   column="numeroCaja"/>
            <result property="tipocaja"					   	   column="tipoCaja"/>
	    	<result property="valorlinea"					   column="VALORLINEA"/>
	    	<result property="totalcajas"					   column="totalCaja"/>
      </resultMap>
    
    
  <select id="getInterfazSATEnviarCostosCaja" parameterClass="java.util.Map" resultMap="executeInterfazSATEnviarCostosCajaResult">
  <![CDATA[
SELECT  (SELECT PAIS.COD_PAIS FROM SEG_PAIS PAIS WHERE PAIS.OID_PAIS= SOLICITUD.PAIS_OID_PAIS) PAIS,
		 '00' AS COMPANIA,
		 DECODE(SUBLI.IND_POST_VENT,1,'LC', DECODE(SOLICITUD.TSPA_OID_TIPO_SOLI_PAIS , 
									 (SELECT PAIS.OID_TIPO_SOLI_PAIS 
										FROM PED_TIPO_SOLIC_PAIS PAIS 
 										WHERE PAIS.TSOL_OID_TIPO_SOLI =2034), 'AM', 'LE')) TIPOPROCESO,
     (SELECT CANAL.COD_CANA FROM SEG_CANAL CANAL WHERE CANAL.OID_CANA = ZONA.CANA_OID_CANA AND ZONA.OID_ZONA = CAB.ZZON_OID_ZONA) codigocanal,
     (SELECT MARCA.COD_MARC FROM SEG_MARCA MARCA WHERE MARCA.OID_MARC = ZONA.MARC_OID_MARC AND ZONA.OID_ZONA = CAB.ZZON_OID_ZONA) codigomarca,
     SOLICITUD.VAL_NUME_SOLI numConsolidado,
     CAB.FEC_FACTU fechaprogramadafac,
     substr(PERIODO.VAL_NOMB_PERI,9,6)  codigocampana,
     (SELECT SGV.COD_SUBG_VENT FROM ZON_SUB_GEREN_VENTA SGV WHERE SGV.OID_SUBG_VENT =  REGION.ZSGV_OID_SUBG_VENT) codigosgv,
     REGION.COD_REGI codigoregion,
     ZONA.COD_ZONA codigozona,
     SECCION.COD_SECC codigoseccion,
     TERRITORIO.CODIGO TERRITORIO,
     DETALLE.NUM_CAJA numeroCaja,
     TIPOCAJA.VAL_TIPO_CAJA tipoCaja,
     (SELECT DET.VAL_LINE FROM APE_LISTA_PICAD_DETAL DET WHERE DET.TCEM_OID_TIPO_CAJA_EMBA= TIPOCAJA.OID_TIPO_CAJA_EMBA
     AND DET.OID_LIST_PICA_DETA = DETALLE.OID_LIST_PICA_DETA) VALORLINEA,
     CAB.NUM_TOTA_CAJA totalCaja
FROM PED_SOLIC_CABEC SOLICITUD,
	 APE_LISTA_PICAD_CABEC CAB, 
	 APE_LISTA_PICAD_DETAL DETALLE,
	 APE_LINEA_ARMAD LINEA,
	 APE_SUBLI_ARMAD SUBLI,
   ZON_ZONA ZONA,
   CRA_PERIO PERIODO,
   ZON_REGIO REGION,
   ZON_SECCI SECCION,
   (SELECT TERRITORIO.COD_TERR CODIGO, TERRAD.OID_TERR_ADMI FROM ZON_TERRI TERRITORIO, ZON_TERRI_ADMIN TERRAD WHERE TERRAD.TERR_OID_TERR = TERRITORIO.OID_TERR ) TERRITORIO,
   APE_TIPO_CAJA_EMBAL TIPOCAJA,
   MAE_PRODU PRODUCTO
WHERE CAB.FEC_FACTU=to_date(#fechaFacturacion#,'dd/mm/yyyy')														
AND SOLICITUD.OID_SOLI_CABE = CAB.SOCA_OID_SOLI_CABE
AND DETALLE.LPCA_OID_LIST_PICA_CABE= CAB.OID_LIST_PICA_CABE
AND LINEA.OID_LINE_ARMA= CAB.LIAR_OID_LINE_ARMA
AND SUBLI.LIAR_OID_LINE_ARMA = LINEA.OID_LINE_ARMA
AND SOLICITUD.ZZON_OID_ZONA= ZONA.OID_ZONA
AND PERIODO.OID_PERI = CAB.PERD_OID_PERI
AND ZONA.ZORG_OID_REGI= REGION.OID_REGI
AND ZONA.OID_ZONA = SECCION.ZZON_OID_ZONA
AND TERRITORIO.OID_TERR_ADMI = SOLICITUD.ZTAD_OID_TERR_ADMI
AND DETALLE.TCEM_OID_TIPO_CAJA_EMBA = TIPOCAJA.OID_TIPO_CAJA_EMBA
AND DETALLE.PROD_OID_PROD = PRODUCTO.OID_PROD

 ]]>
  </select>

   <!-- INTERFAZ - AFP ESTIBADOS -->  
    <resultMap id="executeInterfazSATEnviarAFPEstResult" class="java.util.HashMap">
  			<result property="codigoPais"	 				   column="COD_PAIS"/>
	    	<result property="compania"	 				   column="COMPANIA"/>
            <result property="codigomarca"				   column="COD_MARC"/>
            <result property="codigocanal"				   column="COD_CANA"/>
            <result property="fechafacturacion"			   column="FEC_FACTU"/>
            <result property="campana"					   column="PERIODO"/>
            <result property="idagrupacion"				   column="cod_agru"/>
	    	<result property="numeroetiqueta"			   column="NUM_ETIQ"/>
            <result property="volumenpalet"				   column="VOLUMEN"/>
	    	<result property="valpalet"			   			   column="VALORIZACION"/>
	    	<result property="totalcajas"				  	   column="NUM_TOTA_CAJA"/>
	    	<result property="codigosgv"					   column="COD_SUBG_VENT"/>
            <result property="codigoregion"			       column="COD_REGI"/>
            <result property="codigozona"			       column="COD_ZONA"/>
            <result property="codigoseccion"				   column="COD_SECC"/>
      </resultMap>
    

  <select id="getInterfazSATEnviaAFPEst" parameterClass="java.util.Map" resultMap="executeInterfazSATEnviarAFPEstResult">
  <![CDATA[
SELECT (Select p.COD_PAIS from seg_pais p where p.OID_PAIS = pedidosolicitud.PAIS_OID_PAIS) COD_PAIS  ,
       '00' COMPANIA,
	   	  (select m.COD_MARC from seg_marca m where m.OID_MARC IN ( select z.MARC_OID_MARC from zon_zona z where z.OID_ZONA = PEDIDOSOLICITUD.ZZON_OID_ZONA)) COD_MARC,
			  (select c.COD_CANA from seg_canal c where c.OID_CANA IN ( select z.CANA_OID_CANA from zon_zona z where z.OID_ZONA = PEDIDOSOLICITUD.ZZON_OID_ZONA)) COD_CANA,
     		CAB.FEC_FACTU,
     		SUBSTR(PERIODO.VAL_NOMB_PERI,9,6) PERIODO,
        ETIQUETA.NUM_ETIQ,
        (SELECT SGV.COD_SUBG_VENT FROM ZON_SUB_GEREN_VENTA SGV WHERE SGV.OID_SUBG_VENT IN (SELECT RE.ZSGV_OID_SUBG_VENT FROM ZON_REGIO RE WHERE RE.OID_REGI IN (select z.ZORG_OID_REGI from zon_zona z where z.OID_ZONA = PEDIDOSOLICITUD.ZZON_OID_ZONA))) COD_SUBG_VENT,
        (SELECT RE.ZSGV_OID_SUBG_VENT FROM ZON_REGIO RE WHERE RE.OID_REGI IN (select z.ZORG_OID_REGI from zon_zona z where z.OID_ZONA = PEDIDOSOLICITUD.ZZON_OID_ZONA)) COD_REGI,
        (select z.COD_ZONA from zon_zona z where z.OID_ZONA = PEDIDOSOLICITUD.ZZON_OID_ZONA) COD_ZONA,
			  (select SEC.COD_SECC from ZON_SECCI SEC where SEC.ZZON_OID_ZONA IN ( select z.OID_ZONA from zon_zona z where z.OID_ZONA = PEDIDOSOLICITUD.ZZON_OID_ZONA )AND ROWNUM =1) COD_SECC,
       (SELECT (CASE WHEN 1=1 THEN SUM(DETALLE.VAL_LINE) END) FROM
        APE_LISTA_PICAD_CABEC CABECERA, APE_LISTA_PICAD_DETAL DETALLE
        WHERE DETALLE.LPCA_OID_LIST_PICA_CABE = CABECERA.OID_LIST_PICA_CABE AND CABECERA.OID_LIST_PICA_CABE = CAB.OID_LIST_PICA_CABE) VALORIZACION,
        (SELECT (CASE WHEN 1=1 THEN SUM(PRODUC.VAL_VOLU) END) FROM
        APE_LISTA_PICAD_CABEC CABECERA, APE_LISTA_PICAD_DETAL DETALLE, MAE_PRODU PRODUC
        WHERE DETALLE.LPCA_OID_LIST_PICA_CABE = CABECERA.OID_LIST_PICA_CABE AND CABECERA.OID_LIST_PICA_CABE = CAB.OID_LIST_PICA_CABE
        AND PRODUC.OID_PROD = DETALLE.PROD_OID_PROD) VOLUMEN,
	    CAB.NUM_TOTA_CAJA,
		ch.cod_agru,
        CAB.NUM_VOLU
FROM APE_ETIQU ETIQUETA,
     PED_SOLIC_CABEC pedidosolicitud,
     APE_LISTA_PICAD_CABEC CAB,
	APE_PARAM_BALAN_AREA_CHEQU CH,
     CRA_PERIO PERIODO
WHERE ETIQUETA.PAIS_OID_PAIS=(SELECT PAIS.OID_PAIS FROM SEG_PAIS PAIS WHERE PAIS.COD_PAIS=#codigoPais#)
AND ETIQUETA.LPCA_OID_LIST_PICA_CABE = CAB.OID_LIST_PICA_CABE
AND PEDIDOSOLICITUD.OID_SOLI_CABE = CAB.SOCA_OID_SOLI_CABE
AND CH.Ccdi_Oid_Conf_Cent_Dist = CAB.CCDI_OID_CONF_CENT_DIST
AND CAB.FEC_FACTU=TO_DATE(#fechaFacturacion#,'DD-MM-YYYY')
 ]]>
  </select>

     <!-- INTERFAZ - VOLUMEN VALORIZACION -->  
    <resultMap id="executeInterfazSATEnviarVolumenValorizacionResult" class="java.util.HashMap">
            <result property="codigoPais"	 				   column="PAIS"/>
	    	<result property="compania"	 				   column="COMPANIA"/>
            <result property="codigomarca"				   column="COD_MARC"/>
            <result property="codigocanal"				   column="COD_CANA"/>
            <result property="tipomercancia"			   column="TIPOPROCESO"/>
	    	<result property="fechafacturacion"			   column="FEC_PROG_FACT"/>
            <result property="campana"					   column="PERIODO"/>
            <result property="codigosgv"					   column="COD_SUBG_VENT"/>
            <result property="codigoregion"			       column="COD_REGI"/>
            <result property="codigozona"			       column="COD_ZONA"/>
            <result property="codigoseccion"				   column="COD_SECC"/>
            <result property="totalcajas"					   column="NUM_TOTA_CAJA"/>
	    	<result property="totalpedidos"				   column="TOTALPEDIDOS"/>
            <result property="volumen"					   column="NUM_VOLU"/>
	    	<result property="unidadmedida"			   column="COD_UNID_MEDI"/>
	    	<result property="valorizacion"				   column="VALORIZACION"/>
      </resultMap> 
    
           
      <select id="getInterfazSATEnviaVolumenValorizacion" parameterClass="java.util.Map" resultMap="executeInterfazSATEnviarVolumenValorizacionResult">
  <![CDATA[
SELECT DISTINCT 
       (SELECT PAIS.COD_PAIS FROM SEG_PAIS PAIS WHERE PAIS.OID_PAIS= SOLICITUD.PAIS_OID_PAIS) PAIS,
	   '00' COMPANIA,
       CANAL.COD_CANA,
       MARCA.COD_MARC,
       SUBSTR(PERIODO.VAL_NOMB_PERI,9,6) PERIODO,
       ZONA.COD_ZONA,
       SECCION.COD_SECC,
       DECODE(SOLICITUD.TSPA_OID_TIPO_SOLI_PAIS,(SELECT PAIS.OID_TIPO_SOLI_PAIS 
										FROM PED_TIPO_SOLIC_PAIS PAIS 
 										WHERE PAIS.TSOL_OID_TIPO_SOLI =2018),'PL', DECODE(SOLICITUD.TSPA_OID_TIPO_SOLI_PAIS , 
									 (SELECT PAIS.OID_TIPO_SOLI_PAIS 
										FROM PED_TIPO_SOLIC_PAIS PAIS 
 										WHERE PAIS.TSOL_OID_TIPO_SOLI =2034), 'AM', 'PS')) TIPOPROCESO,
       SUBLI.IND_POST_VENT AS indicador,
       SOLICITUD.FEC_PROG_FACT,
       SGV.COD_SUBG_VENT,
       REGION.COD_REGI,
       CAB.NUM_TOTA_CAJA,
       (SELECT COUNT(*)  FROM MAE_PRODU PR, APE_LINEA_ARMAD LI, APE_SUBLI_ARMAD SUB WHERE LI.OID_LINE_ARMA = SUB.LIAR_OID_LINE_ARMA AND  SUB.IND_POST_VENT = 1) AS TOTALPEDIDOS,
       CAB.NUM_VOLU,
       UNIDAD.COD_UNID_MEDI,
       (SELECT SUM(PRODU.VAL_COST_ESTD) FROM MAE_PRODU PRODU WHERE PRODU.OID_PROD = PRODUCTO.OID_PROD) AS VALORIZACION

FROM PED_SOLIC_CABEC SOLICITUD,
APE_LISTA_PICAD_CABEC CAB,
SEG_MARCA MARCA,
SEG_CANAL CANAL,
ZON_ZONA ZONA,
CRA_PERIO PERIODO,
ZON_SUB_GEREN_VENTA SGV,
ZON_SECCI SECCION,
ZON_REGIO REGION,
MAE_UNIDA_MEDID UNIDAD,
MAE_PRODU PRODUCTO,
APE_LISTA_PICAD_DETAL DETALLE,
APE_LINEA_ARMAD LINEA,
APE_SUBLI_ARMAD SUBLI
WHERE SOLICITUD.TSPA_OID_TIPO_SOLI_PAIS IN
      (SELECT PAIS.OID_TIPO_SOLI_PAIS FROM PED_TIPO_SOLIC_PAIS PAIS WHERE PAIS.TSOL_OID_TIPO_SOLI IN
      (SELECT TIPOS.OID_TIPO_SOLI FROM PED_TIPO_SOLIC TIPOS))
      AND CAB.SOCA_OID_SOLI_CABE = SOLICITUD.OID_SOLI_CABE
      AND CAB.FEC_FACTU=to_date(#fechaFacturacion#,'dd-mm-yyyy')
      AND CAB.ZZON_OID_ZONA = ZONA.OID_ZONA
      AND ZONA.MARC_OID_MARC = MARCA.OID_MARC
      AND ZONA.CANA_OID_CANA = CANAL.OID_CANA
      AND CAB.PERD_OID_PERI = PERIODO.OID_PERI
      AND ZONA.ZORG_OID_REGI = REGION.OID_REGI
      AND ZONA.OID_ZONA = SECCION.ZZON_OID_ZONA
      AND CAB.LIAR_OID_LINE_ARMA = LINEA.OID_LINE_ARMA
      AND LINEA.OID_LINE_ARMA = SUBLI.LIAR_OID_LINE_ARMA
      AND DETALLE.LPCA_OID_LIST_PICA_CABE = CAB.OID_LIST_PICA_CABE
      AND DETALLE.PROD_OID_PROD = PRODUCTO.OID_PROD
      AND REGION.ZSGV_OID_SUBG_VENT = SGV.OID_SUBG_VENT
      AND UNIDAD.OID_UNID_MEDI = PRODUCTO.UNMD_OID_UNID_MEDI
GROUP BY CANAL.COD_CANA,
       MARCA.COD_MARC,
       PERIODO.VAL_NOMB_PERI,
       ZONA.COD_ZONA,
       SECCION.COD_SECC,
       SUBLI.IND_POST_VENT,
       SOLICITUD.TSPA_OID_TIPO_SOLI_PAIS,
       SOLICITUD.FEC_PROG_FACT,
       SGV.COD_SUBG_VENT,
       REGION.COD_REGI,
       CAB.NUM_TOTA_CAJA,
       CAB.NUM_VOLU,
       UNIDAD.COD_UNID_MEDI,
       PRODUCTO.OID_PROD,
	  SOLICITUD.PAIS_OID_PAIS
 ]]>
  </select>	
  	<!-- INTERFAZ - SAT-4 - ENVIAR BOLETA DE DESPACHO -->  
      <resultMap id="executeInterfazSATEnviarBoletaDespachoResult" class="java.util.HashMap">
            <result property="codigopais"                        column="COD_PAIS"/>
            <result property="compania"                        	 column="COMPANIA"/>
            <result property="codigomarca"                       column="COD_MARC"/>
            <result property="codigocanal"                       column="COD_CANA"/>
            <result property="codigoacceso"                		 column="COD_ACCE"/>
            <result property="codigosubacceso"             		 column="COD_SBAC"/>
            <result property="codigocampana"              		 column="VAL_NOMB_PERI"/>
            <result property="codigotipobolsades"         		 column="TSOL_OID_TIPO_CONS"/>
            <result property="numboletadespacho"          		 column="VAL_NUME_SOLI"/>
            <result property="codigosgv"                  		 column="COD_SUBG_VENT"/>
            <result property="codigoregion"              		 column="COD_REGI"/>
            <result property="codigozona"                        column="COD_ZONA"/>
            <result property="codigoseccion"              		 column="COD_SECC"/>
            <result property="codigoterritorio"           		 column="COD_TERR"/>
            <result property="fecprogramfac"              		 column="FEC_FACT"/>
            <result property="numerocuenta"               		 column="NUM_CLIEN"/>
            <result property="numerofactura"              		 column="NUM_DOCU_LEGA"/>
            <result property="ordentotalimpresion" 				 column="COD_SECU"/>
            <result property="unidadesfacturadas"         		 column="NUM_UNID_ATEN"/>
            <result property="indfacfuerafecprogram"			 column="COD_SUBE"/>
            <result property="tipocliente"                		 column="COD_TIPO_CLIE"/>
            <result property="indclasificacion"           		 column="COD_SUBE"/>
            <result property="prioridadentrega"          		 column="COD_SUBE"/>
            <result property="primerapellido"            		 column="VAL_APE1"/>
            <result property="segundoapellido"            		 column="VAL_APE2"/>
            <result property="primernombre"               		 column="VAL_NOM1"/>
            <result property="segundonombre"              		 column="VAL_NOM2"/>
            <result property="direccionconsultora"        		 column="COD_SUBE"/>
            <result property="bancoconsultora"            		 column="VAL_OBSE"/>
            <result property="telefono1"                         column="VAL_TEXT_COMU"/>
            <result property="codigogeoreflon"            		 column="VAL_COOR_X"/>
            <result property="codigogeoreflat"            		 column="VAL_COOR_Y"/>
            <result property="idlcientealterno"           		 column="COD_CLIE_ANTI"/>
            <result property="nivelubigeo1"               		 column="UBIGEO1"/>												
            <result property="nivelubigeo2"               		 column="UBIGEO2"/>												
            <result property="nivelubigeo3"               		 column="UBIGEO3"/>												
            <result property="nivelubigeo4"               		 column="UBIGEO4"/>												
            <result property="nivelubigeo5"               		 column="UBIGEO5"/>												
            <result property="nivelubigeo6"               		 column="UBIGEO6"/>												
            <result property="nivelubigeo7"               		 column="UBIGEO7"/>												
            <result property="nivelubigeo8"               		 column="UBIGEO8"/>												
            <result property="nivelubigeo9"               		 column="UBIGEO9"/>												
            <result property="subestructuraubigeo1"       		 column="ORDE_1"/>												
            <result property="subestructuraubigeo2"       		 column="ORDE_2"/>												
            <result property="subestructuraubigeo3"       		 column="ORDE_3"/>												
            <result property="subestructuraubigeo4"       		 column="ORDE_4"/>												
            <result property="subestructuraubigeo5"       		 column="ORDE_5"/>												
            <result property="subestructuraubigeo6"       		 column="ORDE_6"/>												
            <result property="subestructuraubigeo7"       		 column="ORDE_7"/>												
            <result property="subestructuraubigeo8"       		 column="ORDE_8"/>												
            <result property="subestructuraubigeo9"       		 column="ORDE_9"/>												
            
      </resultMap>
    
    
      <select id="getInterfazSATEnviarBoletaDespacho" parameterClass="java.util.Map"       resultMap="executeInterfazSATEnviarBoletaDespachoResult">
      <![CDATA[
          SELECT #codigoPais# COD_PAIS, '00' AS COMPANIA,
       (SELECT C.COD_CANA
          FROM SEG_CANAL C
         WHERE C.OID_CANA = Z.CANA_OID_CANA) COD_CANA,
       (SELECT M.COD_MARC
          FROM SEG_MARCA M
         WHERE M.OID_MARC = MARC_OID_MARC) COD_MARC,
       (SELECT AC.COD_ACCE
          FROM SEG_ACCES AC
         WHERE (SELECT SU.ACCE_OID_ACCE
                  FROM SEG_SUBAC SU
                 WHERE PSC.SBAC_OID_SBAC = SU.OID_SBAC) =
                                                         AC.OID_ACCE)
                                                                     COD_ACCE,
       (SELECT SUB.COD_SBAC
          FROM SEG_SUBAC SUB
         WHERE PSC.SBAC_OID_SBAC = SUB.OID_SBAC) COD_SBAC,
       (SELECT PER.COD_PERI
          FROM SEG_PERIO_CORPO PER
         WHERE PSC.PERD_OID_PERI = PER.OID_PERI) VAL_NOMB_PERI,
       
       (SELECT SOL.COD_TIPO_SOLI FROM PED_TIPO_SOLIC SOL WHERE  PSC.TSPA_OID_TIPO_SOLI_PAIS_CONS = SOL.OID_TIPO_SOLI) TSOL_OID_TIPO_CONS,
       VAL_NUME_SOLI,
       
       (SELECT SGV.COD_SUBG_VENT
          FROM ZON_SUB_GEREN_VENTA SGV
         WHERE SGV.OID_SUBG_VENT =
                          (SELECT R.ZSGV_OID_SUBG_VENT
                             FROM ZON_REGIO R
                            WHERE R.OID_REGI = Z.ZORG_OID_REGI))
                                                                COD_SUBG_VENT,
       (SELECT R.ZSGV_OID_SUBG_VENT
          FROM ZON_REGIO R
         WHERE R.OID_REGI = Z.ZORG_OID_REGI) COD_REGI, Z.COD_ZONA,
         (SELECT SECCION.COD_SECC FROM ZON_SECCI SECCION WHERE SECCION.ZZON_OID_ZONA in Z.OID_ZONA AND ROWNUM=1)
        COD_SECC,
        (SELECT TE.COD_TERR FROM ZON_TERRI TE WHERE TE.PAIS_OID_PAIS =  (SELECT PAIS.OID_PAIS
                                FROM SEG_PAIS PAIS
                               WHERE PAIS.COD_PAIS = #codigoPais#) AND ROWNUM=1) 
          COD_TERR, PSC.FEC_FACT, PSC.NUM_CLIEN,
       DOCUM.NUM_DOCU_LEGA,
       (SELECT PSP.COD_SECU
          FROM PED_SECUE_PROCE PSP
         WHERE PSP.PROC_OID_PROC = PP.OID_PROC AND ROWNUM = 1) COD_SECU,
       PSC.NUM_UNID_ATEN_TOTA NUM_UNID_ATEN, MTC.COD_TIPO_CLIE, MC.VAL_APE1, MC.VAL_APE2,
       MC.VAL_NOM1, MC.VAL_NOM2, MCD.VAL_OBSE, MCC.VAL_TEXT_COMU,
       MCD.VAL_COOR_X, MCD.VAL_COOR_Y, 
       (SELECT CLIENANT.COD_CLIE_ANTI FROM MAE_CODIG_CLIEN_ANTER CLIENANT WHERE CLIENANT.CLIE_OID_CLIE_NUEV= MC.OID_CLIE)
        
       COD_CLIE_ANTI, 
       (SELECT 
       (SELECT TIPOVIA.COD_TIPO_VIA||V.NOM_VIA||V.COD_VIA FROM SEG_TIPO_VIA TIPOVIA,ZON_VIA V WHERE TIPOVIA.OID_TIPO_VIA = DIRECLIEN.TIVI_OID_TIPO_VIA
        AND TIPOVIA.OID_TIPO_VIA = V.TIVI_OID_TIPO_VIA)
       FROM MAE_CLIEN_DIREC DIRECLIEN WHERE DIRECLIEN.OID_CLIE_DIRE =MC.OID_CLIE AND DIRECLIEN.IND_DIRE_PPAL=0)
       COD_SUBE,
	    GEOPO.ORDE_1 UBIGEO1,GEOPO.ORDE_2 UBIGEO2,GEOPO.ORDE_3 UBIGEO3,GEOPO.ORDE_4 UBIGEO4,GEOPO.ORDE_5 UBIGEO5,GEOPO.ORDE_6 UBIGEO6,GEOPO.ORDE_7 UBIGEO7,GEOPO.ORDE_8 UBIGEO8,GEOPO.ORDE_9 UBIGEO9,
      GEOPO1.ORDE_1,GEOPO1.ORDE_2,GEOPO1.ORDE_3,GEOPO1.ORDE_4,GEOPO1.ORDE_5,GEOPO1.ORDE_6,GEOPO1.ORDE_7,GEOPO1.ORDE_8,GEOPO1.ORDE_9
  FROM PED_SOLIC_CABEC PSC INNER JOIN FAC_DOCUM_CONTA_CABEC DOCUM
       ON DOCUM.SOCA_OID_SOLI_CABE = PSC.OID_SOLI_CABE
     AND PSC.PAIS_OID_PAIS = (SELECT PAIS.OID_PAIS
                                FROM SEG_PAIS PAIS
                               WHERE PAIS.COD_PAIS = #codigoPais#)
     AND PSC.FEC_FACT = to_date(#fechaFacturacion#, 'dd/mm/yyyy')
       INNER JOIN PED_PROCE PP ON PP.OID_PROC = PSC.PROC_OID_PROC
       INNER JOIN ZON_ZONA Z ON Z.OID_ZONA = PSC.ZZON_OID_ZONA
       INNER JOIN MAE_CLIEN MC ON PSC.CLIE_OID_CLIE = MC.OID_CLIE
       INNER JOIN MAE_CLIEN_DIREC MCD
       ON PSC.CLDI_OID_CLIE_DIRE = MCD.OID_CLIE_DIRE
       INNER JOIN MAE_CLIEN_COMUN MCC ON MCC.CLIE_OID_CLIE = PSC.CLIE_OID_CLIE
       INNER JOIN MAE_TIPO_CLIEN MTC
      
       ON MTC.OID_TIPO_CLIE = PSC.TICL_OID_TIPO_CLIE
              
	   INNER JOIN ZON_TERRI_ADMIN TERAD ON TERAD.TERR_OID_TERR = PSC.Ztad_Oid_Terr_Admi

	   INNER JOIN ZON_TERRI TERRITORIO ON TERRITORIO.Oid_Terr = TERAD.TERR_OID_TERR
	   INNER JOIN ZON_VALOR_ESTRU_GEOPO GEOPO ON GEOPO.OID_VALO_ESTR_GEOP = TERRITORIO.OID_TERR
     INNER JOIN ZON_VALOR_ESTRU_GEOPO GEOPO1 ON GEOPO1.OID_VALO_ESTR_GEOP = GEOPO.EGEO_OID_ESTR_GEOP
 ]]>  
  </select>


<select id="getInterfazSATEnviarArchivoControlUno" parameterClass="java.util.Map" 			
  	resultMap="executeInterfazSATEnviarArchControlResult">
	 <![CDATA[														
	SELECT 'COM' AS COM, ROWNUM AS SECUENCIA,
		          inte_cod_inte || num_lote AS NOMBREARCHIVO, lotes.reg_proc REG_PROC,
       		      '00' AS COMPANIA,
LOTES.PAIS_COD_PAIS PAIS_COD_PAIS,
       		      SUBSTR(PERIODO.VAL_NOMB_PERI,9,6) CAMPANA,
       		      TRUNC(lotes.fec_fpro) FEC_FPRO
  	FROM bas_histo_lotes lotes,
		 CRA_PERIO PERIODO
 	WHERE sist_cod_sist = 'SAT' 
	AND INTE_COD_INTE <> 'SAT-10'	
	AND INTE_COD_INTE <> 'SAT-11' 	AND	INTE_COD_INTE <> 'SAT-12'											
 	AND  ROWNUM =1
    AND FEC_INIC < to_date(#fechaFacturacion#, 'dd/mm/yyyy') AND FEC_FINA > to_date(#fechaFacturacion#, 'dd/mm/yyyy') 													
 	AND TRUNC(FEC_IPRO) = to_date(#fechaFacturacion#, 'dd/mm/yyyy') 
 	ORDER BY FEC_FPRO DESC 	
   		 ]]>												
  	</select>

	<!-- INTERFAZ - SAT-4 - ENVIAR BOLETA DE DESPACHO -->  
      <resultMap id="executeInterfazSATEnviarBoletaResult" class="java.util.HashMap">
            <result property="codigopais"                        			column="COD_PAIS"/>
            <result property="compania"                        	 		column="COMPANIA"/>
            <result property="codigomarca"                      		column="COD_MARC"/>
            <result property="codigocanal"                       			column="COD_CANA"/>
            <result property="codigoacceso"                		 		column="COD_ACCE"/>
            <result property="codigosubacceso"             		 	column="COD_SBAC"/>
            <result property="codigocampana"              		 	column="VAL_NOMB_PERI"/>
            <result property="codigotipobolsades"         		 	column="TSOL_OID_TIPO_CONS"/>
            <result property="numboletadespacho"          		 	column="VAL_NUME_SOLI"/>
            <result property="codigosgv"                  		 		column="COD_SUBG_VENT"/>
            <result property="codigoregion"              		 		column="COD_REGI"/>
            <result property="codigozona"                        		column="COD_ZONA"/>
            <result property="codigoseccion"              		 		column="COD_SECC"/>
            <result property="codigoterritorio"           				column="COD_TERR"/>
            <result property="fecprogramfac"              		 		column="FEC_FACT"/>
            <result property="numerocuenta"               		 		column="COD_CLIE"/>
            <result property="numerofactura"              		 		column="NUM_DOCU_LEGA"/>
            <result property="ordentotalimpresion" 				 	column="COD_SECU"/>
            <result property="unidadesfacturadas"         		 	column="NUM_UNID_ATEN"/>
            <result property="indfacfuerafecprogram"			 	column="IND_FACT"/>
            <result property="tipocliente"                		 			column="COD_TIPO_CLIE"/>
            <result property="indclasificacion"           		 column="IND_CLAS"/>
            <result property="prioridadentrega"          		 column="PRIORIDAD"/>
            <result property="primerapellido"            		 column="VAL_APE1"/>
            <result property="segundoapellido"            		 column="VAL_APE2"/>
            <result property="primernombre"               		 column="VAL_NOM1"/>
            <result property="segundonombre"              		 column="VAL_NOM2"/>
            <result property="direccionconsultora"        		 column="COD_SUBE"/>
            <result property="bancoconsultora"            		 column="VAL_OBSE"/>
            <result property="telefono1"                         column="VAL_TEXT_COMU"/>
            <result property="codigogeoreflon"            		 column="VAL_COOR_X"/>
            <result property="codigogeoreflat"            		 column="VAL_COOR_Y"/>
            <result property="idlcientealterno"           		 column="COD_CLIE_ANTI"/>
            <result property="nivelubigeo1"               		 column="UBIGEO1"/>
            <result property="nivelubigeo2"               		 column="UBIGEO2"/>
            <result property="nivelubigeo3"               		 column="UBIGEO3"/>
            <result property="nivelubigeo4"               		 column="UBIGEO4"/>
            <result property="nivelubigeo5"               		 column="UBIGEO5"/>
            <result property="nivelubigeo6"               		 column="UBIGEO6"/>
            <result property="nivelubigeo7"               		 column="UBIGEO7"/>
            <result property="nivelubigeo8"               		 column="UBIGEO8"/>
            <result property="nivelubigeo9"               		 column="UBIGEO9"/>
            <result property="subestructuraubigeo1"       		 column="ORDE_1"/>
            <result property="subestructuraubigeo2"       		 column="ORDE_2"/>
            <result property="subestructuraubigeo3"       		 column="ORDE_3"/>
            <result property="subestructuraubigeo4"       		 column="ORDE_4"/>
            <result property="subestructuraubigeo5"       		 column="ORDE_5"/>
            <result property="subestructuraubigeo6"       		 column="ORDE_6"/>
            <result property="subestructuraubigeo7"       		 column="ORDE_7"/>
            <result property="subestructuraubigeo8"       		 column="ORDE_8"/>
            <result property="subestructuraubigeo9"       		 column="ORDE_9"/>
            
      </resultMap>
    
 <select id="getInterfazSATEnviarBoleta" parameterClass="java.util.Map"       resultMap="executeInterfazSATEnviarBoletaResult">
      <![CDATA[
SELECT #codigoPais# COD_PAIS, '00' AS COMPANIA,
       (SELECT C.COD_CANA
          FROM SEG_CANAL C
         WHERE C.OID_CANA = Z.CANA_OID_CANA) COD_CANA,
       (SELECT M.COD_MARC
          FROM SEG_MARCA M
         WHERE M.OID_MARC = MARC_OID_MARC) COD_MARC,
       (SELECT AC.COD_ACCE
          FROM SEG_ACCES AC
         WHERE (SELECT SU.ACCE_OID_ACCE
                  FROM SEG_SUBAC SU
                 WHERE PSC.SBAC_OID_SBAC = SU.OID_SBAC) =
                                                         AC.OID_ACCE)
                                                                     COD_ACCE,
       (SELECT SUB.COD_SBAC
          FROM SEG_SUBAC SUB
         WHERE PSC.SBAC_OID_SBAC = SUB.OID_SBAC) COD_SBAC,
       SUBSTR(PERIODO.VAL_NOMB_PERI,9,6) VAL_NOMB_PERI,
       
       (SELECT SOL.COD_TIPO_SOLI FROM PED_TIPO_SOLIC SOL WHERE  SOL.OID_TIPO_SOLI=(SELECT PAIST.TSOL_OID_TIPO_SOLI FROM PED_TIPO_SOLIC_PAIS PAIST WHERE PAIST.OID_TIPO_SOLI_PAIS = PSC.TSPA_OID_TIPO_SOLI_PAIS ) )TSOL_OID_TIPO_CONS,
       VAL_NUME_SOLI,
       
       (SELECT SGV.COD_SUBG_VENT
          FROM ZON_SUB_GEREN_VENTA SGV
         WHERE SGV.OID_SUBG_VENT =
                          (SELECT R.ZSGV_OID_SUBG_VENT
                             FROM ZON_REGIO R
                            WHERE R.OID_REGI = Z.ZORG_OID_REGI))
                                                                COD_SUBG_VENT,
       (SELECT R.ZSGV_OID_SUBG_VENT
          FROM ZON_REGIO R
         WHERE R.OID_REGI = Z.ZORG_OID_REGI) COD_REGI, Z.COD_ZONA,
         (SELECT SECCION.COD_SECC FROM ZON_SECCI SECCION WHERE SECCION.ZZON_OID_ZONA in Z.OID_ZONA AND ROWNUM=1)
        COD_SECC,
        (SELECT TE.COD_TERR FROM ZON_TERRI TE WHERE TE.PAIS_OID_PAIS =  (SELECT PAIS.OID_PAIS
                                FROM SEG_PAIS PAIS
                               WHERE PAIS.COD_PAIS = #codigoPais#) AND ROWNUM=1) 
          COD_TERR, PSC.FEC_FACT, MC.COD_CLIE ,
       DOCUM.NUM_DOCU_LEGA,
       (SELECT PSP.COD_SECU
          FROM PED_SECUE_PROCE PSP
         WHERE PSP.PROC_OID_PROC = PP.OID_PROC AND ROWNUM = 1) COD_SECU,
       PSC.NUM_UNID_ATEN_TOTA NUM_UNID_ATEN, 
 	   DECODE(PSC.FEC_FACT,FEC_PROG_FACT,0,1) IND_FACT,
	   MTC.COD_TIPO_CLIE,
	   DECODE (SBT.COD_SUBT_CLIE,3,0,COD_SUBT_CLIE ,1,1,NULL) IND_CLAS, 
	   'N' PRIORIDAD,
	   MC.VAL_APE1, MC.VAL_APE2,
       MC.VAL_NOM1, MC.VAL_NOM2, MCD.VAL_OBSE, MCC.VAL_TEXT_COMU,
       MCD.VAL_COOR_X, MCD.VAL_COOR_Y, 
       (SELECT CLIENANT.COD_CLIE_ANTI FROM MAE_CODIG_CLIEN_ANTER CLIENANT WHERE CLIENANT.CLIE_OID_CLIE_NUEV= MC.OID_CLIE)
       
       COD_CLIE_ANTI, 
       (SELECT 
       (SELECT TIPOVIA.COD_TIPO_VIA||V.NOM_VIA||V.COD_VIA FROM SEG_TIPO_VIA TIPOVIA,ZON_VIA V WHERE TIPOVIA.OID_TIPO_VIA = DIRECLIEN.TIVI_OID_TIPO_VIA
        AND TIPOVIA.OID_TIPO_VIA = V.TIVI_OID_TIPO_VIA)
       FROM MAE_CLIEN_DIREC DIRECLIEN WHERE DIRECLIEN.OID_CLIE_DIRE =MC.OID_CLIE AND DIRECLIEN.IND_DIRE_PPAL=0)
       COD_SUBE,
	   GEOPO.ORDE_1 UBIGEO1,
	   GEOPO.ORDE_2 UBIGEO2,
	   GEOPO.ORDE_3 UBIGEO3,
	   GEOPO.ORDE_4 UBIGEO4,
	   GEOPO.ORDE_5 UBIGEO5,
	   GEOPO.ORDE_6 UBIGEO6,
	   GEOPO.ORDE_7 UBIGEO7,
	   GEOPO.ORDE_8 UBIGEO8,
	   GEOPO.ORDE_9 UBIGEO9,
       GEOPO1.ORDE_1,
	   GEOPO1.ORDE_2,
	   GEOPO1.ORDE_3,
	   GEOPO1.ORDE_4,
	   GEOPO1.ORDE_5,
	   GEOPO1.ORDE_6,
	   GEOPO1.ORDE_7,
	   GEOPO1.ORDE_8,
	   GEOPO1.ORDE_9
  FROM PED_SOLIC_CABEC PSC INNER JOIN FAC_DOCUM_CONTA_CABEC DOCUM
       ON DOCUM.SOCA_OID_SOLI_CABE = PSC.OID_SOLI_CABE
     AND PSC.PAIS_OID_PAIS = (SELECT PAIS.OID_PAIS
                                FROM SEG_PAIS PAIS
                               WHERE PAIS.COD_PAIS = #codigoPais#)
     AND PSC.FEC_FACT = to_date(#fechaFacturacion#, 'dd/mm/yyyy')
       INNER JOIN PED_PROCE PP ON PP.OID_PROC = PSC.PROC_OID_PROC
       INNER JOIN ZON_ZONA Z ON Z.OID_ZONA = PSC.ZZON_OID_ZONA
       INNER JOIN MAE_CLIEN MC ON PSC.CLIE_OID_CLIE = MC.OID_CLIE
       INNER JOIN MAE_CLIEN_DIREC MCD
       ON PSC.CLDI_OID_CLIE_DIRE = MCD.OID_CLIE_DIRE
       INNER JOIN MAE_CLIEN_COMUN MCC ON MCC.CLIE_OID_CLIE = PSC.CLIE_OID_CLIE
       INNER JOIN MAE_TIPO_CLIEN MTC      
       ON MTC.OID_TIPO_CLIE = PSC.TICL_OID_TIPO_CLIE
	   INNER JOIN MAE_SUBTI_CLIEN SBT ON SBT.TICL_OID_TIPO_CLIE = MTC.OID_TIPO_CLIE 
	   INNER JOIN MAE_TIPO_CLASI_CLIEN TIPOCLAS ON TIPOCLAS.SBTI_OID_SUBT_CLIE = SBT.OID_SUBT_CLIE 
       INNER JOIN CRA_PERIO PERIODO ON PERIODO.OID_PERI = PSC.PERD_OID_PERI 
	   INNER JOIN ZON_TERRI_ADMIN TERAD ON TERAD.TERR_OID_TERR = PSC.Ztad_Oid_Terr_Admi

	   INNER JOIN ZON_TERRI TERRITORIO ON TERRITORIO.Oid_Terr = TERAD.TERR_OID_TERR
	   INNER JOIN ZON_VALOR_ESTRU_GEOPO GEOPO ON GEOPO.OID_VALO_ESTR_GEOP = TERRITORIO.OID_TERR
     INNER JOIN ZON_VALOR_ESTRU_GEOPO GEOPO1 ON GEOPO1.OID_VALO_ESTR_GEOP = GEOPO.EGEO_OID_ESTR_GEOP
 ]]>
  </select>

    <parameterMap id="executeProcessRegistroAsistenciaParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoEmpresa"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="mensajeError"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT"/>										
    </parameterMap>														
														
	<procedure id="executeProcessRegistroAsistencia"  parameterMap="executeProcessRegistroAsistenciaParams" >													
		{call EDU_PKG_PROCE_GENER.EDU_PR_REGIS_ASIST_CIERR_CAMPA(?,?,?)}												
    </procedure>														
														
	<insert id="insertInterfazEDURecepcionarConsultoraEstablecidas" parameterClass="java.util.Map">													
		INSERT INTO EDU_TMP_RECEP_CLIEN_ESTAB(												
				COD_PAIS, 										
				COD_EMPR_COME, 										
				COD_CLIE, 										
				USU_DIGI, 										
				FEC_DIGI,										
				EST_REGI,										
			    IND_CLIE_TOP											
		)												
		VALUES (												
        #codigoPais#, 														
        #codigoEmpresa#, 														
        #codigoConsultora#,														
		#usuarioLogin#,												
		SYSDATE,												
		#estado#,												
		#indicadorTop#)												
	</insert>													
														
	<delete id="deleteInterfazEDURecepcionarConsultoraEstablecidas" parameterClass="java.util.Map">													
        DELETE FROM EDU_TMP_RECEP_CLIEN_ESTAB														
		WHERE COD_PAIS=#codigoPais#												
          AND COD_EMPR_COME=#codigoEmpresa#														
    </delete>														
    														
    <!-- OBTIENE LA LISTA DE PERIODOS POR PAIS MARCA Y CANAL -->														
    <select id="getCentroDByPaisMarcaCanal" parameterClass="java.util.Map" resultMap="baseResult">														
    SELECT centro.COD_CENT_DIST														
  		FROM app_confi_centr_distr centro												
 		WHERE centro.pais_oid_pais =												
          (SELECT pais.oid_pais														
             FROM  seg_pais pais														
            WHERE pais.cod_pais = #codigoPais#														
                  AND pais.oid_pais = centro.pais_oid_pais)														
														
	  ORDER BY 1 ASC  													
    </select>														
    														
    <procedure id="executeInterfazOCRProcesarConsolidadoOCSCabeceraCorporativo" parameterMap="executeInterfazOCRProcesarConsolidadoOCSParams" >														
        {call INT_PKG_OCCRR.OCR_PR_CONSO_SOLIC_CABEC(?,?) }														
    </procedure>														
    														
    <procedure id="executeInterfazOCRProcesarConsolidadoOCSDetalleCorporativo" parameterMap="executeInterfazOCRProcesarConsolidadoOCSParams" >														
        {call INT_PKG_OCCRR.OCR_PR_CONSO_SOLIC_DETAL(?,?) }														
    </procedure>														
   														
    <procedure id="executeInterfazOCRProcesarConsolidadoPostventaCabecera" parameterMap="executeInterfazOCRProcesarConsolidadoSTOParams" >
        {call INT_PKG_OCCRR.OCR_PR_CONSO_POST_VENTA_CABEC(?,?,?) }
    </procedure>
    

<resultMap id="interfazLAREnviarVisibilidadCronogramaFacturacionResult" class="java.util.HashMap">
        <result property="codigoPais"            column="PAIS" />
        <result property="codigoCia"             column="CIA" />
        <result property="codigoCampana"         column="COD_PERI" />
        <result property="codigoRegion"          column="COD_REGI" />
        <result property="codigoZona"            column="COD_ZONA" />
        <result property="fechaEstimada"         column="FEC_ESTIMADA" />
        <result property="pedidosEstimados"      column="NUM_PEDI" />
        <result property="indicadorCapitalProv"  column="INDCAPPRV" />                
        <result property="unidadesEstimadas" 	 column="UNID_ESTIMADAS" />
    </resultMap>
    <select id="getInterfazLAREnviarVisibilidadCronogramaFacturacion" parameterClass="java.util.Map" resultMap="interfazLAREnviarVisibilidadCronogramaFacturacionResult">   
		SELECT   SUBSTR (COD_PAIS, 1, 2) AS PAIS,
		         DECODE (SUBSTR (COD_PAIS, 3, 1),NULL, 'E',SUBSTR (COD_PAIS, 3, 1)) AS CIA,
		         PEC.COD_PERI, 
				 REG.COD_REGI, 
				 ZON.COD_ZONA,
		         TO_CHAR (CRA.FEC_INIC, 'YYYYMMDD') AS FEC_ESTIMADA, 
		         FVP.NUM_PEDI,
		         DECODE (SUBSTR (COD_ZONA, 2, 1), '0', 'C', 'P') AS INDCAPPRV,
		         FVP.NUM_UNID_VEND AS UNID_ESTIMADAS		         
		    FROM INT_FUENT_VENTA_PREVI_SAP FVP,
		         ZON_REGIO REG,
		         ZON_ZONA ZON,
		         CRA_PERIO PER,
		         SEG_PERIO_CORPO PEC,
		         CRA_CRONO CRA,
		         CRA_ACTIV ACT,
		         SEG_PAIS PAIS,
		         SEG_MARCA MARC,
		         SEG_CANAL CANAL
		   WHERE FVP.ZORG_OID_REGI = REG.OID_REGI
		     AND FVP.ZZON_OID_ZONA = ZON.OID_ZONA
		     AND PEC.COD_PERI >= #codigoPeriodo#												
		     AND FVP.PERD_OID_PERI = PER.OID_PERI
		     AND PER.PERI_OID_PERI = PEC.OID_PERI
		     AND ZON.IND_ACTI = 1
		     AND ZON.IND_BORR = 0
		     AND CRA.PERD_OID_PERI = FVP.PERD_OID_PERI
		     AND CRA.ZZON_OID_ZONA = FVP.ZZON_OID_ZONA
		     AND CRA.CACT_OID_ACTI = OID_ACTI
		     AND COD_PAIS = #codigoPais#
		     AND ACT.PAIS_OID_PAIS = OID_PAIS
		     AND ACT.MARC_OID_MARC = OID_MARC
		     AND COD_MARC = #codigoMarca#
		     AND ACT.CANA_OID_CANA = OID_CANA
		     AND COD_CANA = #codigoCanal#
		     AND COD_ACTI = 'FA'
		ORDER BY COD_REGI, COD_ZONA
    </select> 

	<select id="obtenerSeccionesTrasvaseActuUnidAdmi" parameterClass="java.util.Map" resultMap="baseResult">
		<![CDATA[
		SELECT sec.COD_SECC CODIGO,
		       sec.DES_SECCI DESCRIPCION
		  FROM ZON_SECCI sec, ZON_ZONA zon
		 WHERE sec.ZZON_OID_ZONA = zon.OID_ZONA
           AND zon.pais_oid_pais = (SELECT oid_pais
                                      FROM seg_pais
                                     WHERE cod_pais = #codigoPais#)
           AND zon.marc_oid_marc = (SELECT oid_marc
                                      FROM seg_marca
                                     WHERE cod_marc = #codigoMarca#)
           AND zon.cana_oid_cana = (SELECT oid_cana
                                      FROM seg_canal
                                     WHERE cod_cana = #codigoCanal#)
           AND zon.COD_ZONA = #codigoZona#
           AND zon.IND_ACTI = 1
           AND zon.IND_BORR = 0
           AND zon.PERD_OID_PERI_FINA IS NULL
           AND sec.IND_ACTI = 1
           AND sec.IND_BORR = 0
           AND sec.PERD_OID_PERI_FINA IS NULL
           AND NOT EXISTS (SELECT 1 
                             FROM zon_histo_valid_unadm hvua
                            WHERE hvua.FEC_PROC IS NULL
                              AND hvua.cod_oper = 'B' 
                              AND hvua.cod_nive = 'S'
                              AND hvua.cod_ZONA = #codigoZona#
                              AND hvua.cod_secc = sec.cod_secc
           )
         ORDER BY sec.COD_SECC
		]]>	
	</select>	

	<select id="obtenerTerritoriosTrasvaseActuUnidAdmi" parameterClass="java.util.Map" resultMap="baseResult">
		<![CDATA[
		SELECT ter.COD_TERR CODIGO,
		       ter.COD_TERR DESCRIPCION
		  FROM ZON_TERRI ter,
		       ZON_TERRI_ADMIN tra, 
		       ZON_SECCI sec, 
		       ZON_ZONA zon
		 WHERE ter.OID_TERR = tra.TERR_OID_TERR
		   AND tra.ZSCC_OID_SECC = sec.OID_SECC
		   AND sec.ZZON_OID_ZONA = zon.OID_ZONA
           AND zon.pais_oid_pais = (SELECT oid_pais
                                      FROM seg_pais
                                     WHERE cod_pais = #codigoPais#)
           AND zon.marc_oid_marc = (SELECT oid_marc
                                      FROM seg_marca
                                     WHERE cod_marc = #codigoMarca#)
           AND zon.cana_oid_cana = (SELECT oid_cana
                                      FROM seg_canal
                                     WHERE cod_cana = #codigoCanal#)
           AND zon.COD_ZONA = #codigoZona#
           AND sec.COD_SECC = #codigoSeccion#
           AND zon.IND_ACTI = 1
           AND zon.IND_BORR = 0
           AND zon.PERD_OID_PERI_FINA IS NULL
           AND sec.IND_ACTI = 1
           AND sec.IND_BORR = 0
           AND sec.PERD_OID_PERI_FINA IS NULL
           AND tra.IND_BORR = 0
           AND tra.PERD_OID_PERI_FINA IS NULL
           AND ter.IND_BORR = 0
           AND NOT EXISTS (SELECT 1 
                             FROM zon_histo_valid_unadm hvua
                            WHERE hvua.FEC_PROC IS NULL
                              AND hvua.cod_oper = 'B' 
                              AND hvua.cod_nive = 'T'
                              AND hvua.cod_terr = ter.COD_TERR
           )
		]]>	
	</select>

	<parameterMap id="executeInterfazMYEEnviarInterfacesDiariasParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
    </parameterMap>

    <procedure id="executeInterfazMYEEnviarInterfacesDiarias" 
   			  parameterMap="executeInterfazMYEEnviarInterfacesDiariasParams" >
		{call INT_PKG_MYEBE.INT_PR_MYE_ENVIO_DIARI(?,?,?,?,?,?,?,?)}
    </procedure>  	
	
	<parameterMap id="executeInterfazMYEEnviarCabeceraPedidosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>			
		<parameter property="codigoTipoCliente"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeInterfazMYEEnviarCabeceraPedidos" 
   			  parameterMap="executeInterfazMYEEnviarCabeceraPedidosParams" >
		{call INT_PKG_MYEBE.INT_PR_MYE_CABEC_PEDID(?,?,?,?,?,?,?,?,?)}
    </procedure> 

	<parameterMap id="executeInterfazMYEEnviarArchivoPremiosParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>				
    </parameterMap>

    <procedure id="executeInterfazMYEEnviarArchivoPremios" 
   			  parameterMap="executeInterfazMYEEnviarArchivoPremiosParams" >
		{call INT_PKG_MYEBE.INT_PR_MYE_ARCHI_PREMI(?,?,?,?)}
    </procedure> 	
														
	<parameterMap id="executeInterfazSIAPEnviarAnalisisPreciosParams" class="map" >													
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
    </parameterMap>														
														
    <procedure id="executeInterfazSIAPEnviarAnalisisPrecios" 														
   			  parameterMap="executeInterfazSIAPEnviarAnalisisPreciosParams" >											
		{call INT_PKG_SIAP.INT_PR_SIAP_ANALI_PRECI(?,?,?,?,?,?)}												
    </procedure> 														
														
														
 														
  <procedure id="executeInterfazOCRProcesarConsolidadoSolicitudCredito" parameterMap="executeInterfazOCRProcesarConsolidadoSTOParams" >
        {call INT_PKG_OCCRR.OCR_PR_CONSO_SOLIC_CREDI(?,?,?) }
    </procedure>

	<procedure id="executeInterfazOCRProcesarConsolidadoActualizacionDatos" parameterMap="executeInterfazOCRProcesarConsolidadoSTOParams" >														
        {call INT_PKG_OCCRR.OCR_PR_CONSO_ACTUA_DATOS(?,?,?) }														
    </procedure>	
											
<!-- INTERFAZ - REC - ENVIAR UNIDADES ALMACEN VIRTUAL-->
  <parameterMap id="executeInterfazRECEnviarUnidadesAlmacenVirtualParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="numeroLote"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	
  </parameterMap>
  <procedure id="executeInterfazRECEnviarUnidadesAlmacenVirtual" parameterMap="executeInterfazRECEnviarUnidadesAlmacenVirtualParams">
			{call INT_PKG_RECLA.INT_PR_REC_ENVIA_UNIDA_ALMVI(?,?,?,?,?,?)}											
  </procedure>
  
   <resultMap id="getRECConsolidadoUnidadesAlmacenVirtualResult" class="java.util.HashMap">
        <result property="fecha"            			column="FECHA" />
        <result property="codigoOperacion"             	column="CODIGOOPERACION" />
        <result property="subAcceso"         			column="SUBACCESO" />
        <result property="region"          				column="REGION" />
        <result property="unidadesReclamadas"           column="UNIDADESRECLAMADAS" />
        <result property="totalGuias"         			column="TOTALGUIAS" />
                        
    </resultMap>
  <select id="getRECConsolidadoUnidadesAlmacenVirtual" parameterClass="java.util.Map" resultMap="getRECConsolidadoUnidadesAlmacenVirtualResult">
		<![CDATA[
		SELECT TO_CHAR(R.FEC_INGR, 'DD/MM/YYYY') FECHA,
		       INT_PKG_RECLA.GEN_FN_REC_COD_OPER(O.TIOP_OID_TIPO_OPER) CODIGOOPERACION,
		       INT_PKG_RECLA.GEN_FN_DESC_GENER(SP.SBAC_OID_SBAC, 'SEG_SUBAC') SUBACCESO,
		       RE.DES_REGI REGION,
		       SUM(L.NUM_UNID_RECL) UNIDADESRECLAMADAS,
		       COUNT(DISTINCT R.SOCA_OID_SOLI_CABE) TOTALGUIAS
		  FROM REC_CABEC_RECLA       R,
		       REC_OPERA_RECLA       O,
		       REC_LINEA_OPERA_RECLA L,
		       REC_TIPOS_OPERA       TOP,
		       REC_OPERA             OP,
		       ZON_ZONA              ZO,
		       ZON_REGIO             RE,
		       PED_SOLIC_CABEC       SP
		 WHERE R.SOCA_OID_SOLI_CABE = SP.OID_SOLI_CABE
		   AND R.OID_CABE_RECL = O.CARE_OID_CABE_RECL
		   AND SP.ZZON_OID_ZONA = ZO.OID_ZONA
		   AND ZO.ZORG_OID_REGI = RE.OID_REGI
		   AND R.ESRE_OID_ESTA_RECL IN (6, 4)
		   AND O.ESOP_OID_ESTA_OPER IN (2, 5)
		   AND L.OPRE_OID_OPER_RECL = O.OID_OPER_RECL
		   AND O.TIOP_OID_TIPO_OPER = TOP.OID_TIPO_OPER
		   AND TOP.ROPE_OID_OPER = OP.OID_OPER
		   AND L.TIMO_OID_TIPO_MOVI = 2
		   AND L.NUM_UNID_DEVU = 0
		   AND OP.IND_ANUL <> 1
		   AND L.NUM_UNID_RECL <> 0
		   AND OP.IND_FALT_MERC = decode((select count(*) flag from sto_param_gener_occrr where cod_para = 'IND_ENVI_SAP_FM' and val_param = '1'),0,0,OP.IND_FALT_MERC )
		   AND (OP.IND_DEVU_FISI_FACT = 1 OR (OP.IND_DEVU_FISI_FACT = 0 AND L.SOPO_OID_SOLI_POSI IS NULL))
		   AND R.PERD_OID_PERI_RECL = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#)
		   AND OP.COD_OPER  NOT IN (SELECT cod_oper
	                                FROM int_rec_opera_exclu
	                                WHERE cod_pais = #codigoPais#
	                                AND   IND_ENVI = 0 )
		 GROUP BY TO_CHAR(R.FEC_INGR, 'DD/MM/YYYY'),
		          INT_PKG_RECLA.GEN_FN_REC_COD_OPER(O.TIOP_OID_TIPO_OPER),
		          INT_PKG_RECLA.GEN_FN_DESC_GENER(SP.SBAC_OID_SBAC, 'SEG_SUBAC'),
		          RE.DES_REGI
		]]>	
	</select>		
	
    <procedure id="executeInterfazOCRProcesarConsolidadoPostventaDetalleOCR" parameterMap="executeInterfazOCRProcesarConsolidadoPostventaParams">
        {call INT_PKG_OCCRR.int_pr_ocr_actua_posve_data(?,?) }
    </procedure>
    
    <procedure id="executeInterfazOCREnviarReclamosPostventa" parameterMap="executeInterfazOCREnviarReclamosPostventaParams">
        {call sto_pkg_envio_valid_sicc.sto_pr_spvc_envio_sicc(?,?,?,?) }
    </procedure>

    <resultMap id="getConsolidadoTransferenciaBoletasRecojoResult" class="java.util.HashMap">
        <result property="fechaCierre"            			column="FECHACIERRE" />
        <result property="region"             				column="REGION" />
        <result property="subAcceso"             			column="SUBACCESO" />
        <result property="operacion"          				column="OPERACION" />
        <result property="resultado"         				column="RESULTADO" />
        <result property="unidadesRecogidas"           		column="UNIDADESRECOGIDAS" />
        <result property="totalGuias"           			column="TOTALGUIAS" />        
    </resultMap>
    
     <select id="getConsolidadoTransferenciaBoletasRecojoSinAnulacion" parameterClass="java.util.Map" resultMap="getConsolidadoTransferenciaBoletasRecojoResult">
		<![CDATA[
		SELECT TO_CHAR(CB.FEC_CIERR,'DD/MM/YYYY') FECHACIERRE,
		       R.DES_REGI REGION,
		       ' ' SUBACCESO,
		       LB.COD_OPER OPERACION,
		       INT_PKG_RECLA.GEN_FN_DEVUE_DEEST_BOREC(CB.ESBO_OID_ESTA_BOR2) RESULTADO,
		       SUM(NVL(LB.NUM_UNID_RECO,0)) UNIDADESRECOGIDAS,
		       0 TOTALGUIAS
		  FROM INT_REC_CABEC_BOREC CB,
		       INT_REC_LINEA_BOREC LB,
		       ZON_REGIO           R,
		       INT_REC_MOVIM_BOREC MB
		 WHERE CB.COD_CABE_BORE = LB.COD_CABE_BORE
		   AND CB.COD_REGI = R.COD_REGI
		   AND CB.ESBO_OID_ESTA_BOR1 = INT_PKG_RECLA.GEN_FN_DEVUE_OID_ESTAD_BOREC(#codigoPais#,'CE')
		   AND LB.IND_PROC_ALMA_FISI = 'V'
		   AND LB.COD_OPER IN (SELECT H.COD_OPER
                                 FROM INT_REC_OPER_HOMOL H
                                 WHERE H.COD_OPER_HOMOL=#codigoOperacion#)
           AND CB.FEC_CIERR <= TO_DATE(#fechaFinal#,'dd/MM/yyyy') 
           AND CB.FEC_CIERR >= TO_DATE(#fechaInicial#,'dd/MM/yyyy')		   
		   AND MB.COD_ESTA_BORE IN (SELECT COD_ESTA_BORE
		                              FROM INT_REC_ESTAD_BOREC
		                             WHERE OID_ESTA_BORE = CB.ESBO_OID_ESTA_BOR2
		                               AND COD_PAIS = #codigoPais#
		                               AND NVL_ESTA_BORE = 2)
		   AND MB.COD_PAIS = LB.COD_PAIS
		   AND MB.IND_DISC = LB.IND_DISC
		   AND MB.IND_VIRTU =  (SELECT VAL_PAIN
								  FROM BAS_PARAM_INTER
								 WHERE INTE_COD_INTE = #codigoInterfaz#
								   AND NOM_PAIN = 'indicadorVirtual')		   
		   AND LB.COD_OPER  NOT IN (SELECT cod_oper
	                                FROM int_rec_opera_exclu
	                                WHERE cod_pais = #codigoPais#)
		   ]]>
		   <iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
				 CB.COD_REGI   = #regionList[]#
		   </iterate> 
		 GROUP BY TO_CHAR(CB.FEC_CIERR,'DD/MM/YYYY'),
		          R.DES_REGI,
		          CB.ESBO_OID_ESTA_BOR2,
		          LB.COD_OPER
	</select>
	
	 <select id="getConsolidadoTransferenciaBoletasRecojoConAnulacion" parameterClass="java.util.Map" resultMap="getConsolidadoTransferenciaBoletasRecojoResult">
		 <![CDATA[
		SELECT TO_CHAR(R.FEC_INGR,'DD/MM/YYYY') FECHACIERRE,
		       RE.DES_REGI  REGION,
		       INT_PKG_RECLA.GEN_FN_DESC_GENER(SP.SBAC_OID_SBAC,'SEG_SUBAC') SUBACCESO,
		       INT_PKG_RECLA.GEN_FN_REC_COD_OPER(O.TIOP_OID_TIPO_OPER) OPERACION,
		       ' ' RESULTADO,
               SUM(NVL(L.NUM_UNID_RECL,0)) UNIDADESRECOGIDAS,
		       COUNT(DISTINCT SP.OID_SOLI_CABE) TOTALGUIAS
		  FROM REC_CABEC_RECLA       R,
		       REC_OPERA_RECLA       O,
		       REC_OPERA             OP,
		       REC_TIPOS_OPERA       T,
		       REC_LINEA_OPERA_RECLA L,
		       MAE_CLIEN             C,
		       ZON_REGIO             RE,
		       ZON_ZONA              ZO,
		       CRA_PERIO             E,
		       PED_SOLIC_CABEC       SP	 	
		 WHERE R.CLIE_OID_CLIE = C.OID_CLIE
           AND R.ESRE_OID_ESTA_RECL IN (4,6)
           AND O.ESOP_OID_ESTA_OPER IN (5,2)
		   AND R.SOCA_OID_SOLI_CABE = SP.OID_SOLI_CABE
		   AND R.OID_CABE_RECL = O.CARE_OID_CABE_RECL
           AND SP.ZZON_OID_ZONA = ZO.OID_ZONA
		   AND ZO.ZORG_OID_REGI = RE.OID_REGI
		   AND T.ROPE_OID_OPER = OP.OID_OPER
		   AND O.TIOP_OID_TIPO_OPER = T.OID_TIPO_OPER
		   AND L.OPRE_OID_OPER_RECL = O.OID_OPER_RECL
		   AND E.OID_PERI = R.PERD_OID_PERI_DOCU_REFE
		   AND L.TIMO_OID_TIPO_MOVI = 2
		   AND L.NUM_UNID_DEVU = 0
		   AND OP.IND_ANUL = 1
		   AND L.NUM_UNID_RECL <> 0		  
		   AND R.FEC_INGR >= TO_DATE(#fechaInicial#,'DD/MM/YYYY')
		   AND R.FEC_INGR <= TO_DATE(#fechaFinal#,'DD/MM/YYYY')		   
		   AND OP.COD_OPER  NOT IN (SELECT cod_oper
	                                FROM int_rec_opera_exclu
	                                WHERE cod_pais = #codigoPais#)		   
		   ]]>	
		   <iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
				 RE.COD_REGI   = #regionList[]#
		   </iterate>		   		   
		 GROUP BY TO_CHAR(R.FEC_INGR,'DD/MM/YYYY'),
		          INT_PKG_RECLA.GEN_FN_REC_COD_OPER(O.TIOP_OID_TIPO_OPER),
		          INT_PKG_RECLA.GEN_FN_DESC_GENER(SP.SBAC_OID_SBAC,'SEG_SUBAC'),
		          RE.DES_REGI
		  
	</select>

	 <parameterMap id="executeOCRRecepcionarConsolidadoOCSCargaSTOParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoDocumento"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"		         	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	<procedure id="executeOCRRecepcionarConsolidadoOCSCargaSTO" parameterMap="executeOCRRecepcionarConsolidadoOCSCargaSTOParams" >
		{call STO_PKG_PROCE_GENER.STO_PR_CARGA_OCC(?,?,?)}
    </procedure>
    
    <select id="getProveedorCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
			    SELECT COUNT(1)
					FROM MAE_CLIEN_LIDER M
					WHERE (M.PAIS_COD_PAIS = #codigoPais#)
					AND (M.VAL_RUC = #ruc# )
    </select>
    
  <update id="updateInterfazCOMRecepcionarActualizaCodigoProveedor" parameterClass="RecepcionarActualizaCodigoProveedor">
				UPDATE MAE_CLIEN_LIDER M
				SET M.COD_PROV = #codProveedor#
				WHERE M.VAL_RUC = #ruc#
				      AND M.PAIS_COD_PAIS = #codigoPais#
	</update>

	<!-- Inicio Asistente Virtual -->
	
	 <resultMap id="interfazAVIPrefacturacionCabeceraResult" class="java.util.HashMap">
	    <result property="codigoPais" 		column="CODIGO_PAIS" />
	    <result property="codigoRegion"		column="CODIGO_REGION" />
	    <result property="codigoZona" 	    column="CODIGO_ZONA" />
	    <result property="codigoPeriodo" 	column="CODIGO_PERIODO" />	    
	    <result property="pedidosGestionadosAprobados" 	column="PEDIDOS_GESTIONADOS_APROBADOS" />	    
	    <result property="porcentajeRecepcion" 	column="PORCENTAJE_RECEPCION" />
	    <result property="primerosPedidos" 	    column="PRIMEROS_PEDIDOS" />
	    <result property="pedidosRetenidos" 	column="PEDIDOS_RETENIDOS" /> 
	    <result property="pedidosRecibidos" 	column="PEDIDOS_RECIBIDOS" />
	  </resultMap>

	<select id="getInterfazAVIPrefacturacionCabecera" parameterClass="java.util.Map" resultMap="interfazAVIPrefacturacionCabeceraResult">
		SELECT #codigoPais# as CODIGO_PAIS,
		t1.COD_REGI as CODIGO_REGION, 
		t1.COD_ZONA as CODIGO_ZONA, 
		t1.COD_PERI as CODIGO_PERIODO, 
		(t1.NUM_PEDI_REAL - t1.NUM_PEDI_RECH) as PEDIDOS_GESTIONADOS_APROBADOS,
		DECODE(NUM_PEDI_ESTI, 0, 0, round((t1.NUM_PEDI_REAL - t1.NUM_PEDI_RECH)/NUM_PEDI_ESTI*100)) as PORCENTAJE_RECEPCION,		
		t1.NUM_PRIM_PEDI  as PRIMEROS_PEDIDOS,		
		t1.NUM_PEDI_RECH as PEDIDOS_RETENIDOS, 		
		t1.NUM_PEDI_REAL as PEDIDOS_RECIBIDOS
        FROM INT_EVI_PERIO_REGIO_ZONA t1
		WHERE t1.COD_PERI = ( 
            SELECT MAX(t2.COD_PERI) FROM INT_EVI_PERIO_REGIO_ZONA t2 
            WHERE t2.COD_ZONA = t1.COD_ZONA 
            AND t2.COD_REGI = t1.COD_REGI 
            AND (t2.COD_PERI =#codigoPeriodo#
            <isNotEmpty prepend="OR" property="codigoNuevoPeriodo">	
                t2.COD_PERI=#codigoNuevoPeriodo#
            </isNotEmpty>)
            )
        ORDER BY COD_PERI, COD_REGI, COD_ZONA		
	</select>    

    <resultMap id="interfazAVIPrefacturacionDetalleResult" class="java.util.HashMap">
      <result property="codigoPais" 		column="CODIGO_PAIS" />
      <result property="codigoConsultora" 	column="CODIGO_CONSULTORA" />
      <result property="periodo" 	        column="PERIODO" />      
      <result property="tipoCanal" 	        column="TIPO_CANAL" />            
      <result property="saldoConsultora"	column="SALDO_CONSULTORA" />
      <result property="motivoPedidoObservado"	column="MOTIVO_PEDIDO_OBSERVADO" />      
      <result property="codigoZona"			column="COD_ZONA" />      													      
    </resultMap>

    <select id="getInterfazAVIPrefacturacionDetalle" parameterClass="java.util.Map" resultMap="interfazAVIPrefacturacionDetalleResult">
        SELECT 
	        #codigoPais# as CODIGO_PAIS,
	        t1.COD_CLIE as CODIGO_CONSULTORA,
			t1.COD_PERI as PERIODO,
			'O' as TIPO_CANAL,		 
	        t1.VAL_SALD_DEUD as SALDO_CONSULTORA,
			(CASE WHEN (T1.IND_ERRO_DEUD = '2' AND T1.IND_ERRO_MTMI = '0' AND T1.IND_ERRO_MTMA = '0') THEN 'D'
	        	  WHEN ((T1.IND_ERRO_DEUD = '0' OR T1.IND_ERRO_DEUD = '1') AND T1.IND_ERRO_MTMI = '1' AND T1.IND_ERRO_MTMA = '0') THEN 'N'
	              WHEN ((T1.IND_ERRO_DEUD = '0' OR T1.IND_ERRO_DEUD = '1') AND T1.IND_ERRO_MTMI = '0' AND T1.IND_ERRO_MTMA = '1') THEN 'M'
	              WHEN (T1.IND_ERRO_DEUD = '2' AND T1.IND_ERRO_MTMI = '1' AND T1.IND_ERRO_MTMA = '0') THEN 'A'
	              WHEN ((T1.IND_ERRO_DEUD = '0' OR T1.IND_ERRO_DEUD = '1') AND T1.IND_ERRO_MTMI = '1' AND T1.IND_ERRO_MTMA = '1') THEN 'Z'
	        	  WHEN ((T1.IND_ERRO_DEUD = '0' OR T1.IND_ERRO_DEUD = '1') AND T1.IND_ERROR_SGPE = '0' AND T1.IND_ERRO_REMP = '0'
				        AND T1.IND_ERRO_MTMI = '0' AND T1.IND_ERRO_MTMA = '0') THEN ' '				  			  
				  ELSE ' ' END) AS MOTIVO_PEDIDO_OBSERVADO,
			t1.COD_ZONA	  										
        FROM INT_SOLIC_CONSO_CABEC t1				  
        WHERE ((t1.IND_ERRO_DEUD = '2' AND t1.IND_ERROR_SGPE = '0' AND t1.IND_ERRO_REMP = '0') OR
         	   (t1.IND_ERRO_MTMI = '1' AND t1.IND_ERROR_SGPE = '0' AND t1.IND_ERRO_REMP = '0') OR
               (t1.IND_ERRO_MTMA = '1' AND t1.IND_ERROR_SGPE = '0' AND t1.IND_ERRO_REMP = '0') OR
			   (((t1.IND_ERRO_DEUD = '0') OR (t1.IND_ERRO_DEUD = '1')) AND t1.IND_ERROR_SGPE = '0' AND t1.IND_ERRO_REMP = '0')                
              )			   
        AND t1.IND_ADMI_CART != '1'
        AND t1.COD_PERI = ( 
            SELECT MAX(t2.COD_PERI) FROM INT_EVI_PERIO_REGIO_ZONA t2 
            WHERE t2.COD_ZONA = t1.COD_ZONA 
            AND t2.COD_REGI = t1.COD_REGI 
            AND (t2.COD_PERI =#codigoPeriodo#
            <isNotEmpty prepend="OR" property="codigoNuevoPeriodo">	
                t2.COD_PERI=#codigoNuevoPeriodo#
            </isNotEmpty>)
        )
    </select>	

	<parameterMap id="mapAVICargarFacturacion" class="map" >
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoNuevoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
        <parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>
    </parameterMap>

    <procedure id="cargarAVIFacturacionCabecera" parameterMap="mapAVICargarFacturacion" >
        {call INT_PKG_ASIST_VIRTU.INT_PR_AVI_ENVIO_FACTU_CABEC(?,?,?,?,?)}														
    </procedure>    

    <procedure id="cargarAVIFacturacionDetalle" parameterMap="mapAVICargarFacturacion" >
        {call INT_PKG_ASIST_VIRTU.INT_PR_AVI_ENVIO_FACTU_DETAL(?,?,?,?,?)}														
    </procedure>  

	<resultMap id="interfazAVIFacturacionCabeceraResult" class="java.util.HashMap">
	  <result property="codigoPais" 	column="CODIGO_PAIS" />  
	  <result property="codigoRegion" 	column="CODIGO_REGION" />  
	  <result property="codigoZona" 	column="CODIGO_ZONA" />  
	  <result property="codigoPeriodo" 	column="CODIGO_PERIODO" />  
	  <result property="pedidosFacturados" 	column="PEDIDOS_FACTURADOS" />  
	  <result property="porcentajePedidosFacturados" 	column="PORCENTAJE_PEDIDOS_FACTURADOS" />  
	  <result property="primerosPedidos" 	column="PRIMEROS_PEDIDOS" />  	  
	  <result property="pedidosRechazados" 	column="PEDIDOS_RECHAZADOS" />  
	  <result property="pedidosTotalesPorFacturar" 	column="PEDIDOS_TOTALES_POR_FACTURAR" />  	  
	  <result property="activasFinales" 	column="ACTIVAS_FINALES" />  
	  <result property="porcentajeActivasFinales" 	column="PORCENTAJE_ACTIVAS_FINALES" />  
	  <result property="promedioPedidosFacturados" 	column="PROMEDIO_PEDIDOS_FACTURADOS" />                                      
	</resultMap>
	
	<resultMap id="interfazAVIFacturacionDetalleResult" class="java.util.HashMap">
	  <result property="codigoPais" 	column="CODIGO_PAIS" />  
	  <result property="codigoConsultora" 	column="CODIGO_CONSULTORA" />  
	  <result property="codigoPeriodo" 	column="CODIGO_PERIODO" />  	  
	  <result property="motivoRechazo" 	column="MOTIVO_RECHAZO" />  
	  <result property="codigoZona" 	column="COD_ZONA" />  													  
	</resultMap>

	<select id="getInterfazAVIFacturacionCabecera" parameterClass="java.util.Map" resultMap="interfazAVIFacturacionCabeceraResult">
			SELECT A.COD_PAIS AS CODIGO_PAIS, 
				A.COD_REGI AS CODIGO_REGION, 
				A.COD_ZONA AS CODIGO_ZONA,
				A.COD_PERI AS CODIGO_PERIODO,			  
				A.NUM_PEDI_FACT AS PEDIDOS_FACTURADOS,
				A.VAL_PORC_PEDI_FACT AS PORCENTAJE_PEDIDOS_FACTURADOS,
				A.NUM_PRIM_PEDI AS PRIMEROS_PEDIDOS,			
				A.NUM_PEDI_RECH AS PEDIDOS_RECHAZADOS, 
				A.NUM_PEDI_TOTA AS PEDIDOS_TOTALES_POR_FACTURAR,
				A.NUM_ACTI_FINA AS ACTIVAS_FINALES,
				A.VAL_PORC_ACTI_FINA AS PORCENTAJE_ACTIVAS_FINALES,
				A.VAL_PROM_PEDI_FACT AS PROMEDIO_PEDIDOS_FACTURADOS
			FROM 
				INT_AVI_FACTU_CABEC_TEMPO A,
				(				 
					SELECT COD_PAIS, MAX(COD_PERI) PERI, COD_ZONA, COD_REGI
					FROM INT_AVI_FACTU_CABEC_TEMPO  
					GROUP BY COD_PAIS, COD_REGI, COD_ZONA	
				) periodos			 
			WHERE A.COD_PERI = periodos.PERI 
			 	AND A.COD_REGI = periodos.COD_REGI 
			 	AND A.COD_ZONA = periodos.COD_ZONA

	</select>	

    <select id="getInterfazAVIFacturacionDetalle" parameterClass="java.util.Map" resultMap="interfazAVIFacturacionDetalleResult">
	   SELECT A.COD_PAIS AS CODIGO_PAIS, 
	          A.COD_CLIE AS CODIGO_CONSULTORA, 	   
	          A.COD_PERI AS CODIGO_PERIODO, 
	          A.COD_MOTI_RECH AS MOTIVO_RECHAZO,
	          A.COD_ZONA													
	   FROM INT_AVI_FACTU_DETAL_TEMPO A,
	        (				 
	           SELECT COD_PAIS, MAX(COD_PERI) PERI, COD_CLIE
	           FROM INT_AVI_FACTU_DETAL_TEMPO  
	           GROUP BY COD_PAIS, COD_CLIE	
	        ) periodos			 
	   WHERE A.COD_PERI = periodos.PERI 
	     AND A.COD_CLIE = periodos.COD_CLIE 
	</select>	

    <resultMap id="interfazAVIConsultoraCDRCabeceraResult" class="java.util.HashMap">
      <result property="codigoPais" 		column="CODIGO_PAIS" />
      <result property="guiaCDR" 			column="NUMERO_RECLAMO" />       
      <result property="codigoCliente"	 	column="CODIGO_CLIENTE" />  
	  <result property="codigoPeriodo"   	column="CODIGO_PERIODO" /> 
	  <result property="codigoPeriodoOrigen"  column="CODIGO_PERIODO_ORIGEN" />
	  <result property="codigoPeriodoProceso" column="CODIGO_PERIODO_PROCESO" /> 												
      <result property="estado" 		    column="ESTADO" />  
    </resultMap>

    <select id="getInterfazAVIConsultoraCDRCabecera" parameterClass="java.util.Map" resultMap="interfazAVIConsultoraCDRCabeceraResult">
       SELECT DISTINCT  
            #codigoPais# AS CODIGO_PAIS,
            REC_CABEC_RECLA.NUM_RECL NUMERO_RECLAMO,			
            MAE_CLIEN.COD_CLIE CODIGO_CLIENTE, 
		    SEG_PERIO_CORPO.COD_PERI CODIGO_PERIODO,            
		   (SELECT X.COD_PERI
             FROM SEG_PERIO_CORPO X,                                                    
                  CRA_PERIO Y
             WHERE          
                X.OID_PERI = Y.PERI_OID_PERI
                AND REC_CABEC_RECLA.PERD_OID_PERI_DOCU_REFE = Y.OID_PERI
            )CODIGO_PERIODO_ORIGEN,
		    #codigoPeriodo# CODIGO_PERIODO_PROCESO,	          												
		    ' ' AS ESTADO
	   FROM REC_CABEC_RECLA,
  	        REC_OPERA_RECLA,	
   	        REC_TIPOS_OPERA,			   
   	        REC_OPERA,			
	        MAE_CLIEN,
            MAE_CLIEN_DATOS_ADICI,
	        SEG_PERIO_CORPO,
	        CRA_PERIO
	   WHERE  (REC_CABEC_RECLA.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
   	       AND (REC_CABEC_RECLA.OID_CABE_RECL = REC_OPERA_RECLA.CARE_OID_CABE_RECL)
   	       AND (REC_TIPOS_OPERA.OID_TIPO_OPER = REC_OPERA_RECLA.TIOP_OID_TIPO_OPER)
   	       AND (REC_TIPOS_OPERA.ROPE_OID_OPER = REC_OPERA.OID_OPER)
		   AND (REC_OPERA.COD_OPER IN ('C','TM','TP','DN','DE','FM','FA'))
           AND (MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
	       AND (REC_CABEC_RECLA.PERD_OID_PERI_RECL = CRA_PERIO.OID_PERI)
	       AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
           AND (REC_CABEC_RECLA.COD_USUA_INGR != 'CALYPSO')
           AND (REC_CABEC_RECLA.COD_USUA_INGR != 'BELCENTER')
           AND (MAE_CLIEN_DATOS_ADICI.ESTA_OID_ESTA_CLIE != 7)
	       AND (SEG_PERIO_CORPO.COD_PERI >= #codigoPeriodo#)													
	</select>

    <resultMap id="interfazAVIConsultoraCDRDetalleResult" class="java.util.HashMap">
      <result property="codigoPais" 		column="CODIGO_PAIS" />
      <result property="codigoCliente"	 	column="CODIGO_CLIENTE" />        
      <result property="guiaCDR" 			column="NUMERO_RECLAMO" />       
	  <result property="codigoVenta"    	column="CODIGO_VENTA" /> 
      <result property="monto" 		        column="MONTO" />  
      <result property="codigoOperacion" 	column="CODIGO_OPERACION" />  
      <result property="estado" 		    column="ESTADO" />              
    </resultMap>

    <select id="getInterfazAVIConsultoraCDRDetalle" parameterClass="java.util.Map" resultMap="interfazAVIConsultoraCDRDetalleResult">
       SELECT 
            #codigoPais# AS CODIGO_PAIS,
            MAE_CLIEN.COD_CLIE AS CODIGO_CLIENTE,
            REC_CABEC_RECLA.NUM_RECL AS NUMERO_RECLAMO,
			COD_VENTA.VAL_CODI_VENT AS CODIGO_VENTA,
			(case WHEN REC_TIPO_MOVIM.COD_TIPO_MOVI = 'E' THEN REC_LINEA_OPERA_RECLA.IMP_CARG
			      WHEN REC_TIPO_MOVIM.COD_TIPO_MOVI = 'D' THEN REC_LINEA_OPERA_RECLA.IMP_ABON
			      ELSE 0
		     end) AS MONTO,
            DECODE(REC_OPERA.COD_OPER,'C','C','TM','Q','DN','Q','DE','D','FM','F','FA','F','TP','Q') AS CODIGO_OPERACION,
			(CASE WHEN (REC_CABEC_RECLA.ESRE_OID_ESTA_RECL = 5) THEN 'R'
			      WHEN (REC_TIPO_MOVIM.COD_TIPO_MOVI = 'E') THEN 'E'
				  WHEN (REC_TIPO_MOVIM.COD_TIPO_MOVI = 'D') THEN 'B'
			 END) AS ESTADO  	   	   
    	   FROM REC_CABEC_RECLA,
    	        MAE_CLIEN,
                MAE_CLIEN_DATOS_ADICI,
    	        REC_OPERA_RECLA,
    	        REC_LINEA_OPERA_RECLA,
				REC_TIPO_MOVIM,
    	        SEG_PERIO_CORPO,
    	        CRA_PERIO,
    	        REC_OPERA,
    	        REC_TIPOS_OPERA,
    	        (SELECT Z2.PROD_OID_PROD, Z2.VAL_CODI_VENT,Z1.OID_MATR_FACT, Z2.TOFE_OID_TIPO_OFER
                 FROM PRE_MATRI_FACTU Z1, PRE_OFERT_DETAL Z2, PRE_MATRI_FACTU_CABEC Z3
                 WHERE z3.OID_CABE = Z1.MFCA_OID_CABE
				       AND Z1.OFDE_OID_DETA_OFER = Z2.OID_DETA_OFER
                ) COD_VENTA
    	   WHERE  (REC_CABEC_RECLA.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
               AND (MAE_CLIEN_DATOS_ADICI.CLIE_OID_CLIE = MAE_CLIEN.OID_CLIE)
    	       AND (REC_CABEC_RECLA.OID_CABE_RECL = REC_OPERA_RECLA.CARE_OID_CABE_RECL)
    	       AND (REC_TIPOS_OPERA.OID_TIPO_OPER = REC_OPERA_RECLA.TIOP_OID_TIPO_OPER)
    	       AND (REC_TIPOS_OPERA.ROPE_OID_OPER = REC_OPERA.OID_OPER)
    	       AND (REC_LINEA_OPERA_RECLA.OPRE_OID_OPER_RECL = REC_OPERA_RECLA.OID_OPER_RECL)
    	       AND (REC_CABEC_RECLA.PERD_OID_PERI_RECL = CRA_PERIO.OID_PERI)
    	       AND (SEG_PERIO_CORPO.OID_PERI = CRA_PERIO.PERI_OID_PERI)
               AND (REC_CABEC_RECLA.COD_USUA_INGR != 'CALYPSO')
               AND (REC_CABEC_RECLA.COD_USUA_INGR != 'BELCENTER')
			   AND (REC_OPERA.COD_OPER IN ('C','TM','TP','DN','DE','FM','FA'))
			   AND (REC_TIPO_MOVIM.OID_TIPO_MOVI = REC_LINEA_OPERA_RECLA.TIMO_OID_TIPO_MOVI)
               AND (MAE_CLIEN_DATOS_ADICI.ESTA_OID_ESTA_CLIE != 7)
			   AND REC_LINEA_OPERA_RECLA.PROD_OID_PROD = COD_VENTA.PROD_OID_PROD (+)
			   AND COD_VENTA.TOFE_OID_TIPO_OFER (+) = REC_LINEA_OPERA_RECLA.TOFE_OID_TIPO_OFER
			   AND COD_VENTA.OID_MATR_FACT(+)  = REC_LINEA_OPERA_RECLA.MAFA_OID_MATR_FACT               
	       AND (
	               (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
	               <isNotEmpty prepend="OR" property="codigoNuevoPeriodo">					
	                   (SEG_PERIO_CORPO.COD_PERI = #codigoNuevoPeriodo#)
	               </isNotEmpty>
	           )
	</select>

	<parameterMap id="mapExecuteInterfazAVIConsultoraCDRDetalle" class="map" >
		<parameter property="codigoPais"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoNuevoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>		
    </parameterMap>

	<procedure id="executeInterfazAVIConsultoraCDRDetalle" parameterMap="mapExecuteInterfazAVIConsultoraCDRDetalle">
		{call INT_PKG_ASIST_VIRTU.INT_PR_AVI_ENVIO_CONSU_DECDR(?, ?, ?, ?, ?, ?)}												
	</procedure>	
	
	<parameterMap id="mapExecuteInterfazAVIConsultoraPuntaje" class="map" >
		<parameter property="codigoPais"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoNuevoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN"/>		
    </parameterMap>

	<procedure id="executeInterfazAVIConsultoraPuntaje" parameterMap="mapExecuteInterfazAVIConsultoraPuntaje">
		{call INT_PKG_ASIST_VIRTU.INT_PR_AVI_ENVIO_CONSU_PUNTA(?, ?, ?, ?, ?, ?)}												
	</procedure>	

    <resultMap id="interfazAVITerritorioResult" class="java.util.HashMap">
      <result property="codigoPais" 			column="CODIGO_PAIS" />
      <result property="codigoZona"	 			column="CODIGO_ZONA" />        
      <result property="codigoTerritorio" 		column="CODIGO_TERRITORIO" />       
	  <result property="descripcionTerritorio"  column="DESCRIPCION_TERRITORIO" /> 
    </resultMap>

    <select id="getInterfazAVITerritorio" parameterClass="java.util.Map" resultMap="interfazAVITerritorioResult">
		SELECT #codigoPais# AS CODIGO_PAIS,
			   ZON.COD_ZONA AS CODIGO_ZONA, 
			   TER.COD_TERR AS CODIGO_TERRITORIO,
			   ' ' AS DESCRIPCION_TERRITORIO
		FROM ZON_TERRI_ADMIN TA,
		     ZON_SECCI SEC,
			 ZON_ZONA ZON,
			 ZON_REGIO REG,
			 ZON_TERRI TER
		WHERE TA.IND_BORR = 0 AND TA.ZSCC_OID_SECC = SEC.OID_SECC
		  AND SEC.ZZON_OID_ZONA = ZON.OID_ZONA AND ZON.ZORG_OID_REGI = REG.OID_REGI
		  AND TA.TERR_OID_TERR = TER.OID_TERR
		  ORDER BY REG.COD_REGI, ZON.COD_ZONA, SEC.COD_SECC, TER.COD_TERR
	</select>
	
														
 <!--  MANTENIMIENTO INSERCION - PER - MOVIMIENTOS BANCARIOS CABECERA -->														
    <insert id="insertProductosCM" parameterClass="estimadoProductos">														
    	<![CDATA[													
	   INSERT INTO MAE_PRODU (COD_SAP, DES_CORT, Oid_Prod) VALUES (													
		#codigoSAP#,												
	    #descripcion#,													
	    #oidProducto#													
		)												
	    ]]>													
	</insert>													
														
 <!--  MANTENIMIENTO INSERCION - APE - ESTIMADOS PRODUCTO -->
    <insert id="insertEstimadoProductos" parameterClass="estimadoProductos">
    	<![CDATA[

 			INSERT INTO APE_ESTIM_PRODU 
				(OID_ESTI_PROD, 
 				NUM_UNID_ESTI, 
 				IND_FUER_PEDI, 
 				PRCE_OID_PROC, 
 				LIAR_OID_LINE_ARMA,
 				PERD_OID_PERI, 
 				PROD_OID_PROD
 			) VALUES (
			#codigoEstimado#,
			to_number(trim(#unidades#) ),
			#indicadorFP#,
			#procedencia#,
			#linea#,
			#periodo#,
			#oidProducto#)
	    ]]>
	</insert>
	<!-- OBTIENE LA LISTA DE centro de zona POR centro de distriucion -->
    <select id="getOIDProducto" parameterClass="string" resultClass="java.lang.Integer">
    	SELECT P.OID_PROD FROM MAE_PRODU P WHERE P.COD_SAP=#codigoSAP#
    </select>
	<!-- Fin Asistente Virtual -->

<!-- OBTIENE LA LISTA DE centro de zona POR centro de distriucion -->
    <select id="getOIDPeriodo" parameterClass="string" resultClass="java.lang.Integer">
    	SELECT CR.OID_PERI FROM CRA_PERIO CR WHERE CR.VAL_NOMB_PERI LIKE #periodo#
    </select>
<!-- OBTIENE LA LISTA DE centro de zona POR centro de distriucion -->
    <select id="getOIDLinea" parameterClass="string" resultClass="java.lang.Integer">
    	SELECT LINEA.OID_LINE_ARMA FROM APE_LINEA_ARMAD LINEA WHERE LINEA.NUM_CODI_LINE= #linea#
    </select>
<!-- OBTIENE LA LISTA DE centro de zona POR centro de distriucion -->														
    <select id="getProductoBySAP" parameterClass="string" resultClass="java.lang.Integer">														
    SELECT PRODUCTO.OID_PROD FROM MAE_PRODU PRODUCTO WHERE PRODUCTO.COD_SAP=#codigoSAP#														
    </select>														
														

	<!-- OBTIENE LA LISTA DE centro de zona POR centro de distriucion -->
    <select id="getOIDEstimado" parameterClass="string" resultClass="java.lang.Integer">
	    select APE_ESPR_SEQ.nextval codigo from dual 
    </select>
  <!-- INTERFAZ - COM - RECEPCIONAR CODIGOS DE PLANILLA -->
  <update id="updateEstimadoProductos" parameterClass="estimadoProductos">
       UPDATE APE_ESTIM_PRODU EST SET EST.NUM_UNID_ESTI =to_number(trim(#unidades#) )
		WHERE EST.PROD_OID_PROD = (SELECT P.OID_PROD FROM MAE_PRODU P WHERE P.COD_SAP=#codigoSAP#)
 		and est.PERD_OID_PERI=#periodo# and est.LIAR_OID_LINE_ARMA=#linea#
  </update>

  <!-- INTERFAZ - COM - RECEPCIONAR CODIGOS DE PLANILLA -->
  <update id="updateEstimadoProductosSinM" parameterClass="estimadoProductos">
    <![CDATA[	   
	UPDATE APE_ESTIM_PRODU EST SET EST.NUM_UNID_ESTI =  to_number(trim(#unidades#) )
		WHERE EST.PROD_OID_PROD = (SELECT P.OID_PROD FROM MAE_PRODU P WHERE P.COD_SAP=#codigoSAP#)
		AND EST.PRCE_OID_proc <>1
		and est.PERD_OID_PERI=#periodo# and est.LIAR_OID_LINE_ARMA=#linea#
	]]>
  </update>
<!-- OBTIENE LA LISTA TODOS LOS PRODUCTOS -->
	<resultMap id="seleccionTodos" class="estimadoProductos">
      <result property="codigoEstimado" 			column="codigoEstimado" />
      <result property="unidades"	 			column="UNIDADES" />        
      <result property="procedencia" 		column="procedencia" />       
	  <result property="linea"  column="LINEA" /> 
	  <result property="periodo"  column="PERIODO" /> 
	  <result property="oidProducto"  column="OIDPRODUCTO" /> 
    </resultMap>
    <select id="seleccionListaTodos" parameterClass="java.util.Map" resultMap="seleccionTodos">
    	SELECT ESTIMADO.OID_ESTI_PROD codigoEstimado,
	       ESTIMADO.NUM_UNID_ESTI UNIDADES,
    	   ESTIMADO.IND_FUER_PEDI INDICADORFP,
		   ESTIMADO.PRCE_OID_PROC procedencia,
	       ESTIMADO.LIAR_OID_LINE_ARMA LINEA,
    	   ESTIMADO.PERD_OID_PERI PERIODO,
       	   ESTIMADO.PROD_OID_PROD OIDPRODUCTO
		 FROM APE_ESTIM_PRODU ESTIMADO
			 WHERE ESTIMADO.LIAR_OID_LINE_ARMA =
			(SELECT LINEA.OID_LINE_ARMA FROM APE_LINEA_ARMAD LINEA WHERE LINEA.NUM_CODI_LINE=#linea# AND LINEA.NUM_LINE_AFP=0)
			AND ESTIMADO.PERD_OID_PERI= (SELECT PERIODO.OID_PERI FROM CRA_PERIO PERIODO WHERE PERIODO.VAL_NOMB_PERI LIKE #periodo#)
			AND ESTIMADO.PROD_OID_PROD = (SELECT PRODUCTO.OID_PROD FROM MAE_PRODU PRODUCTO WHERE PRODUCTO.COD_SAP=#codigoSAPI# AND PRODUCTO.COD_IND_DENT_CAJA='C')

    </select>

<!-- OBTIENE LA LISTA TODOS LOS PRODUCTOS  AFP-->
    <select id="seleccionListaTodosAFP" parameterClass="java.util.Map" resultMap="seleccionTodos">
    <![CDATA[	
	SELECT ESTIMADO.OID_ESTI_PROD codigoEstimado,
	       ESTIMADO.NUM_UNID_ESTI UNIDADES,
    	   ESTIMADO.IND_FUER_PEDI INDICADORFP,
		   ESTIMADO.PRCE_OID_PROC procedencia,
	       ESTIMADO.LIAR_OID_LINE_ARMA LINEA,
    	   ESTIMADO.PERD_OID_PERI PERIODO,
       	   ESTIMADO.PROD_OID_PROD OIDPRODUCTO
		 FROM APE_ESTIM_PRODU ESTIMADO
			 WHERE ESTIMADO.LIAR_OID_LINE_ARMA =
			(SELECT LINEA.OID_LINE_ARMA FROM APE_LINEA_ARMAD LINEA WHERE LINEA.NUM_CODI_LINE=#linea# AND LINEA.NUM_LINE_AFP=1)
			AND ESTIMADO.PERD_OID_PERI= (SELECT PERIODO.OID_PERI FROM CRA_PERIO PERIODO WHERE PERIODO.VAL_NOMB_PERI LIKE #periodo#)
			AND ESTIMADO.PROD_OID_PROD = (SELECT PRODUCTO.OID_PROD FROM MAE_PRODU PRODUCTO WHERE PRODUCTO.COD_SAP=#codigoSAPI# AND PRODUCTO.COD_IND_DENT_CAJA<>'C')
    ]]>
    </select>

	<resultMap id="seleccionProductoAFP" class="estimadoProductos">
      <result property="oidProducto" 			column="OID_PROD" />
    </resultMap>
<!-- OBTIENE LA LISTA TODOS LOS PRODUCTOS  AFP-->
    <select id="seleccionListaProductosAFP" parameterClass="string" resultMap="seleccionProductoAFP">
    <![CDATA[	
		SELECT PRODUCTO.OID_PROD FROM MAE_PRODU PRODUCTO WHERE PRODUCTO.COD_SAP=#codigoSAP# AND PRODUCTO.COD_IND_DENT_CAJA<>'C' ]]>
    </select>



<!-- OBTIENE LA LISTA TODOS LOS PRODUCTOS -->
    <select id="seleccionListaTodosSinM" parameterClass="java.util.Map" resultMap="seleccionTodos">
 <![CDATA[	
    	SELECT ESTIMADO.OID_ESTI_PROD codigoEstimado,
	       ESTIMADO.NUM_UNID_ESTI UNIDADES,
    	   ESTIMADO.IND_FUER_PEDI INDICADORFP,
		   ESTIMADO.PRCE_OID_PROC procedencia,
	       ESTIMADO.LIAR_OID_LINE_ARMA LINEA,
    	   ESTIMADO.PERD_OID_PERI PERIODO,
       	   ESTIMADO.PROD_OID_PROD OIDPRODUCTO
		 FROM APE_ESTIM_PRODU ESTIMADO
			 WHERE ESTIMADO.LIAR_OID_LINE_ARMA =
			(SELECT LINEA.OID_LINE_ARMA FROM APE_LINEA_ARMAD LINEA WHERE LINEA.NUM_CODI_LINE=#linea# AND LINEA.NUM_LINE_AFP=0)
			AND ESTIMADO.PERD_OID_PERI= (SELECT PERIODO.OID_PERI FROM CRA_PERIO PERIODO WHERE PERIODO.VAL_NOMB_PERI LIKE #periodo#)
			AND ESTIMADO.PROD_OID_PROD = (SELECT PRODUCTO.OID_PROD FROM MAE_PRODU PRODUCTO WHERE PRODUCTO.COD_SAP=#codigoSAPI# AND PRODUCTO.COD_IND_DENT_CAJA='C')
			AND ESTIMADO.IND_FUER_PEDI <>1
	]]>
    </select>

<!-- OBTIENE LA LISTA TODOS LOS PRODUCTOS  AFP-->
	<resultMap id="lineaAFP" class="java.lang.String">
      <result property="lineaAfp" 			column="valor" />
    </resultMap>
    <select id="consultaLineaAFP" parameterClass="java.util.Map" resultMap="lineaAFP">
    <![CDATA[	
		SELECT DECODE(LINEA.NUM_LINE_AFP,1,'TRUE', 'FALSE') VALOR 
		FROM APE_LINEA_ARMAD LINEA WHERE LINEA.NUM_CODI_LINE=#linea#
    ]]>
    </select>



<!-- OBTIENE LA LISTA TODOS LOS PRODUCTOS  AFP-->
    <select id="seleccionListaTodosAFPSinM" parameterClass="java.util.Map" resultMap="seleccionTodos">
    <![CDATA[	
	SELECT ESTIMADO.OID_ESTI_PROD codigoEstimado,
	       ESTIMADO.NUM_UNID_ESTI UNIDADES,
    	   ESTIMADO.IND_FUER_PEDI INDICADORFP,
		   ESTIMADO.PRCE_OID_PROC procedencia,
	       ESTIMADO.LIAR_OID_LINE_ARMA LINEA,
    	   ESTIMADO.PERD_OID_PERI PERIODO,
       	   ESTIMADO.PROD_OID_PROD OIDPRODUCTO
		 FROM APE_ESTIM_PRODU ESTIMADO
			 WHERE ESTIMADO.LIAR_OID_LINE_ARMA =
			(SELECT LINEA.OID_LINE_ARMA FROM APE_LINEA_ARMAD LINEA WHERE LINEA.NUM_CODI_LINE=#linea# AND LINEA.NUM_LINE_AFP=1)
			AND ESTIMADO.PERD_OID_PERI= (SELECT PERIODO.OID_PERI FROM CRA_PERIO PERIODO WHERE PERIODO.VAL_NOMB_PERI LIKE #periodo#)
			AND ESTIMADO.PROD_OID_PROD = (SELECT PRODUCTO.OID_PROD FROM MAE_PRODU PRODUCTO WHERE PRODUCTO.COD_SAP=#codigoSAPI# AND PRODUCTO.COD_IND_DENT_CAJA<>'C')
         AND ESTIMADO.IND_FUER_PEDI <>1
    ]]>
    </select>

 <update id="deleteEstimadoProductos" parameterClass="estimadoProductos">

<![CDATA[
			DELETE FROM APE_ESTIM_PRODU ESTIMADO 
			WHERE ESTIMADO.OID_ESTI_PROD = #codigoEstimado#
 ]]>
  </update>
 	<!-- Actualiza Estimados de Yobel -->
 	
 	<delete id="deleteInterfazLLIRecepcionarActualizaEstimadosYobel">
        TRUNCATE TABLE LAR_ESTIM_YOBEL
    </delete>
 	
 	
	<insert id="insertInterfazLLIRecepcionarActualizaEstimadosYobel" parameterClass="java.util.Map">
    	<![CDATA[
			INSERT INTO LAR_ESTIM_YOBEL
			(
			  COD_CAMP,     
			  COD_FECH,     
			  NUM_LOTE,     
			  COD_TIPO_PERI,
			  COD_PERI,     
			  COD_SAP,
			  DES_PROD,     
			  COD_UNID     
			)
			VALUES
			(
			#codCamp#,		
			#codFecha#,
			#numLote#,
			#codTipoPeriodo#,
			#codPeriodo#,
			#codSat#,
			#desProducto#,
			#codUnidades#
			)
	    ]]>
    </insert>
	<!-- Actualiza Estimados de Yobel -->

    <!-- LAR RecepcionarActualizaResultadoChequeo -->
    <select id="getOidPaisInterfazLARRecepcionarActualizaResultadoChequeo" parameterClass="string" resultClass="java.lang.Integer">
      			SELECT gen_pkg_gener.gen_fn_devuelve_id_pais(#value#)
			    FROM DUAL
    </select>
    
    <update id="updateInterfazLARRecepcionarActualizaResultadoChequeo" parameterClass="java.util.Map" >
    <![CDATA[
		UPDATE PED_SOLIC_CABEC PS
		   SET PS.RECQ_OID_RESU_CHEQ = (SELECT RR.OID_RESU_CHEQ
		                                  FROM REC_RESUL_CHEQU RR
		                                 WHERE RR.PAIS_OID_PAIS = #OIDcodPais#
		                                   AND RR.COD_RESU_CHEQ = #codResultadoChequeo#),
		    PS.VAL_OBSE_REVI      = #obsChequeo#,
		       PS.INRE_OID_INDI_REVI = 
		       (CASE 
		       WHEN(PS.INRE_OID_INDI_REVI IS NULL) THEN 
		       (SELECT RI.OID_INDI_ENTR_MERC FROM REC_INDIC_ENTRE_MERCA RI WHERE RI.COD_INDI = #indMarcaChequeo#) 
		       WHEN(PS.INRE_OID_INDI_REVI <> (SELECT RI.OID_INDI_ENTR_MERC FROM REC_INDIC_ENTRE_MERCA RI WHERE RI.COD_INDI = #indMarcaChequeo#)) THEN
		        (SELECT RI.OID_INDI_ENTR_MERC FROM REC_INDIC_ENTRE_MERCA RI WHERE RI.COD_INDI = #indMarcaChequeo#) 
		        ELSE PS.INRE_OID_INDI_REVI 
		        END)
		WHERE PS.PAIS_OID_PAIS = #OIDcodPais#
		      AND PS.VAL_NUME_SOLI = #numPedido#
		   AND PS.SBAC_OID_SBAC =
		       (SELECT a.oid_sbac
		          FROM seg_subac a, seg_acces b
		         WHERE a.cod_sbac = #codigoSubacceso#
		           AND b.oid_acce = a.acce_oid_acce)
			]]>
  	</update>
	<!-- LAR RecepcionarActualizaResultadoChequeo -->

	<!-- LAR-14 RecepcionarActualizaSecuenciacionzonas -->
    <update id="updateInterfazLARRecepcionarActualizaSecuenciacionzonas" parameterClass="java.util.Map" >
    <![CDATA[
			      UPDATE APP_RUTAS_TRANS AR
				      SET AR.NUM_SECU = to_number(#numSecuencia#)
				      WHERE AR.PAIS_OID_PAIS = #OIDcodPais#
				      AND AR.COD_RUTA = #codZona#
			]]>
  	</update>
	<!-- LAR-14 RecepcionarActualizaSecuenciacionzonas -->

<select id="getCodigoDocumento" parameterClass="java.util.Map" resultClass="string">
		SELECT STO_PKG_GENER.sto_fn_devue_codi_docu(#codigoPais#,#codigoInterfaz#) FROM DUAL
	</select>

<select id="getNumLoteSTO" parameterClass="java.util.Map" resultClass="string">
		SELECT STO_PKG_GENER.sto_fn_devue_nume_lote(#codigoPais#,#codigoDocumento#) FROM DUAL
	</select>
 <parameterMap id="updateNumLoteParams" class="map" >
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoDocumento"		     jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

<procedure id="updateNumLote" parameterMap="updateNumLoteParams">
		{call STO_PKG_GENER.sto_pr_updat_nume_lote(?,?)}
	</procedure>




														
<parameterMap id="executeInterfazReuConsUtmProParams" class="map" >
		<parameter property="codigoPais" 		         jdbcType="VARCHAR"    javaType="java.lang.String"    mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR"    javaType="java.lang.String"    mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR"    javaType="java.lang.String"    mode="IN"/>
</parameterMap>

<parameterMap id="executeInterfazDatAdicionalesParams" class="map" >
		<parameter property="codigoPais" 		         jdbcType="VARCHAR"    javaType="java.lang.String"    mode="IN"/>
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR"    javaType="java.lang.String"    mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR"    javaType="java.lang.String"    mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR"    javaType="java.lang.String"    mode="IN"/>
</parameterMap>

<procedure id="executeInterfazReuConsUtmPro" 
   			  parameterMap="executeInterfazReuConsUtmProParams" >
		{call INT_PKG_REUTI.INT_PR_REU_CONSS_UTMPR(?,?,?)}
</procedure>  

<procedure id="executeInterfazDatAdicionales" 
   			  parameterMap="executeInterfazDatAdicionalesParams" >
		{call INT_PKG_DATAM.INT_PR_DAT_ADICI_EBELI(?,?,?,?)}
</procedure> 

  	<resultMap id="interfazPRYEnviarInformacionVentaProyeccionParcialResult" class="java.util.HashMap">
		<result property="codigoPais" 			column="PAIS"/>
		<result property="codigoSociedad" 			column="SOCIEDAD"/> 
		<result property="codigoCentro" 			column="CENTRO"/>
		<result property="codigoMaterial" 			column="MATERIAL"/> 
		<result property="Periodo" 			column="PERIODO" /> 
		<result property="tipoOferta" 			column="TIPO_OFERTA" /> 
		<result property="fechaFacturacion" 			column="FECHA_FACTURACION" />
		<result property="unidadesVendidas" 			column="UNIDADES_VENDIDAS" />
		<result property="unidadesFaltantes" 			column="UNIDADES_FALTANTES"/>
		<result property="unidadesProyectadas" 			column="UNIDADES_PROYECTADAS"/>
		<result property="ventaNeta" 			column="VENTA_NETA"/>
		<result property="ventaNetaFaltante" 			column="VENTA_NETA_FALTANTE" /> 
  	</resultMap>  
 	
	<select id="getInterfazPRYEnviarInformacionVentaProyeccionParcial" parameterClass="java.util.Map" resultMap="interfazPRYEnviarInformacionVentaProyeccionParcialResult">	
        SELECT PAIS,
		       SOCIEDAD,
		       CENTRO,
		       MATERIAL,
		       PERIODO,
		       TIPO_OFERTA,
		       TO_CHAR(FECHA, 'YYYYMMDD') FECHA_FACTURACION,
		       SUM(UNIDADES_VENDIDAS) UNIDADES_VENDIDAS,
		       SUM(UNIDADES_FALTANTES)UNIDADES_FALTANTES,
		       SUM(UNIDADES_PROYECTADAS)UNIDADES_PROYECTADAS,
		       SUM(VENTA_NETA) VENTA_NETA,
		       SUM(VENTA_NETA_FALTANTE) VENTA_NETA_FALTANTE
		  FROM ( 
		        SELECT #codigoPais# PAIS,
		               D.COD_SOCI SOCIEDAD,
		               #codigoCentro# CENTRO,
		               E.COD_SAP MATERIAL,
		               I.COD_PERI PERIODO,
		               G.COD_TIPO_OFER TIPO_OFERTA,
		               A.FEC_FACT FECHA,
		               B.NUM_UNID_ATEN UNIDADES_VENDIDAS,
		               B.NUM_UNID_DEMA_REAL - B.NUM_UNID_ATEN UNIDADES_FALTANTES,
		               0 UNIDADES_PROYECTADAS,
		               DECODE(B.VAL_PREC_CATA_UNIT_LOCA, 0, 0,B.VAL_PREC_NETO_UNIT_LOCA)*B.NUM_UNID_ATEN VENTA_NETA,
		               DECODE(B.VAL_PREC_CATA_UNIT_LOCA, 0, 0, B.VAL_PREC_NETO_UNIT_LOCA)*(B.NUM_UNID_DEMA_REAL - B.NUM_UNID_ATEN) VENTA_NETA_FALTANTE
		          FROM PED_SOLIC_CABEC A,
		               PED_SOLIC_POSIC B,
		               SEG_PAIS        C,
		               SEG_SOCIE       D,
		               MAE_PRODU       E,
		               PRE_OFERT_DETAL F,
		               PRE_TIPO_OFERT  G,
		               CRA_PERIO       H,
		               SEG_PERIO_CORPO I
		         WHERE A.OID_SOLI_CABE = B.SOCA_OID_SOLI_CABE
		           AND A.IND_OC = 1
		           AND A.FEC_FACT = #fechaFacturacionDate# 
				   AND B.ESPO_OID_ESTA_POSI != 2	
		           AND A.SOCI_OID_SOCI = D.OID_SOCI
		           AND A.PAIS_OID_PAIS = C.OID_PAIS
		           AND B.PROD_OID_PROD = E.OID_PROD
		           AND B.OFDE_OID_DETA_OFER = F.OID_DETA_OFER
		           AND F.TOFE_OID_TIPO_OFER = G.OID_TIPO_OFER
		           AND B.NUM_UNID_ATEN >= 0
		           AND A.PERD_OID_PERI = H.OID_PERI
		           AND H.PERI_OID_PERI = I.OID_PERI
                   AND B.ESPO_OID_ESTA_POSI != 2
		           AND I.Cod_Peri = #codigoPeriodo#)
		 GROUP BY PAIS,
		          SOCIEDAD,
		          CENTRO,
		          MATERIAL,
		          PERIODO,
		          TIPO_OFERTA,
		          FECHA
	 </select>

        <select id="getIndicadorActivoSTO" parameterClass="java.util.Map" resultClass="string">
		SELECT STO_PKG_GENER.sto_fn_devue_indic_activ_sto(#codigoPais#,#codigoDocumento#) FROM DUAL
	</select>

	<resultMap id="interfazDATEnviarIncentivosTipoClienteDirigidoConcursoResult" class="java.util.HashMap">
		<result property="codTipoDirA" column="CODIGO" />
		<result property="desTipoDirA" column="DESCRIPCION" />
	</resultMap>
	
	<select id="getInterfazDATEnviarIncentivosTipoClienteDirigidoConcurso" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosTipoClienteDirigidoConcursoResult">	
        SELECT COD_DIRI CODIGO,
		       DES_DIRI DESCRIPCION
		  FROM INT_DAT_INC_DIRIG
	 </select>
	
	<resultMap id="interfazDATEnviarIncentivosTipoAgrupacion1ConcursoResult" class="java.util.HashMap">
		<result property="codTipoAgr" column="CODIGO" />
		<result property="desTipoAgr" column="DESCRIPCION" />
	</resultMap>
	<select id="getInterfazDATEnviarIncentivosTipoAgrupacion1Concurso" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosTipoAgrupacion1ConcursoResult">	
        SELECT COD_AGRU CODIGO,
		       DES_AGRU DESCRIPCION
		  FROM INT_DAT_INC_AGRU1
	 </select>
	
	<resultMap id="interfazDATEnviarIncentivosTipoAgrupacion2ConcursoResult" class="java.util.HashMap">
		<result property="codTipoAgr" column="CODIGO" />
		<result property="desTipoAgr" column="DESCRIPCION" />
	</resultMap>
	<select id="getInterfazDATEnviarIncentivosTipoAgrupacion2Concurso" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosTipoAgrupacion2ConcursoResult">	
       SELECT COD_CLAS_CONC CODIGO,														
		      DES_CLAS_CONC DESCRIPCION												
		 FROM inc_clasi_concu												
	 </select>
	
	<resultMap id="interfazDATEnviarIncentivosEstadoConcursoResult" class="java.util.HashMap">
		<result property="codTipoEst" column="CODIGO" />
		<result property="desTipoEst" column="DESCRIPCION" />
	</resultMap>
	<select id="getInterfazDATEnviarIncentivosEstadoConcurso" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosEstadoConcursoResult">	
        SELECT COD_ESTA CODIGO,
		       DES_ESTA DESCRIPCION
		  FROM INT_DAT_INC_ESTAD
	 </select>
	<resultMap id="interfazDATEnviarIncentivosTipoEfectividadResult" class="java.util.HashMap">
		<result property="codTipoEfectividad" column="CODIGO" />
		<result property="desTipoEfectividad" column="DESCRIPCION" />
	</resultMap>
	<select id="getInterfazDATEnviarIncentivosTipoEfectividad" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosTipoEfectividadResult">	
        SELECT COD_TIPO_EFEC CODIGO,
		       DES_TIPO_EFEC DESCRIPCION
		  FROM INT_DAT_INC_TIPO_EFECT
  
	 </select>
	<resultMap id="interfazDATEnviarIncentivosTipoUnidadMedidaResult" class="java.util.HashMap">
		<result property="codTipoUUMed" column="CODIGO" />
		<result property="desTipoUUMed" column="DESCRIPCION" />
	</resultMap>
	<select id="getInterfazDATEnviarIncentivosTipoUnidadMedida" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosTipoUnidadMedidaResult">	
        SELECT COD_TIPO_UNID_MEDI CODIGO,
		       DES_TIPO_UNID_MEDI DESCRIPCION
		  FROM INT_DAT_INC_UNIDA_MEDID
	 </select>

	 <resultMap id="interfazPRYEnviarPedidosDiaPedidosAcumuladosResult" class="java.util.HashMap">
		<result property="codigoPais" 			column="CODIGOPAIS"/>
		<result property="codigoCentro" 			column="CODIGOCENTRO"/> 
		<result property="codigoPeriodo" 			column="CODIGOPERIODO"/>
		<result property="fechaFacturacion" 			column="FECHAFACTURACION"/> 
		<result property="pedidosDia" 			column="PEDIDOSDIA" /> 
		<result property="pedidosAcumulados" 			column="PEDIDOSACUMULADOS" />		 
  	</resultMap>
	 
	 <select id="getInterfazPRYEnviarPedidosDiaPedidosAcumulados" parameterClass="java.util.Map" resultMap="interfazPRYEnviarPedidosDiaPedidosAcumuladosResult">
	 
		 SELECT #codigoPais# CODIGOPAIS,
		       #codigoCentro# CODIGOCENTRO,
		       #codigoPeriodo# CODIGOPERIODO,
		       #fechaStr# FECHAFACTURACION,												
		       PRY_PKG_PROYE_PARCI.PRY_FN_NUMER_PEDID_BYDIA(#codigoPais#, #codigoMarca#,#codigoCanal#,#codigoPeriodo#,#fechaStr#) PEDIDOSDIA,												
		       PRY_PKG_PROYE_PARCI.PRY_FN_NUMER_PEDID_ACUMU(#codigoPais#, #codigoMarca#,#codigoCanal#,#codigoPeriodo#,#fechaStr#) PEDIDOSACUMULADOS		       										
		  FROM DUAL
   </select>

    <select id="getIVRCompania" parameterClass="string" resultClass="string">
		SELECT COD_COMP
		  FROM INT_IVR_PARAM_COMPA
		 WHERE COD_PAIS = #value#    
	</select>
	
    <resultMap id="interfazACCConcursoPremioResult" class="java.util.HashMap">
      <result property="codigoPais" 			column="CODIGO_PAIS" />
      <result property="codigoCompania"	 		column="CODIGO_COMPANIA" />        
      <result property="codigoConcurso" 		column="NUMERO_CONCURSO" />       
	  <result property="versionConcurso"  		column="NUMERO_VERSION" /> 
	  <result property="descripcionConcurso"	column="NOMBRE_CONCURSO" /> 
	  <result property="numeroPremio"  			column="NUMERO_PREMIO" /> 
	  <result property="numeroNivel"  			column="NUMERO_NIVEL" /> 
	  <result property="periodoInicioConcurso"  column="PERIODO_INICIO" /> 	  	  	  	  
	  <result property="periodoFinConcurso"  	column="PERIODO_FIN" /> 	  	  	  	  
	  <result property="descripcionPremio"  	column="DESCRIPCION_PREMIO" /> 	  	  	  	  	  	  
    </resultMap>

    <select id="getInterfazACCConcursoPremio" parameterClass="java.util.Map" resultMap="interfazACCConcursoPremioResult">
		SELECT #codigoPais# as CODIGO_PAIS, 
		       #codigoCompania# as CODIGO_COMPANIA,
		       A.NUM_CONC as NUMERO_CONCURSO, 
			   A.NUM_VERS as NUMERO_VERSION, 
			   A.VAL_NOMB as NOMBRE_CONCURSO, 
			   E.NUM_PREM as NUMERO_PREMIO, 
			   C.NUM_NIVE as NUMERO_NIVEL,
		       SI.COD_PERI as PERIODO_INICIO, 
			   SF.COD_PERI as PERIODO_FIN, 
			   E.VAL_DESC_LOTE_PREM_ARTI as DESCRIPCION_PREMIO
		  FROM INC_CONCU_PARAM_GENER A,
		       INC_PARAM_GENER_PREMI B,
		       INC_PARAM_NIVEL_PREMI C,
		       INC_PREMI_ARTIC D,
		       INC_LOTE_PREMI_ARTIC E,
			   CRA_PERIO CC,
			   CRA_PERIO CI,
			   CRA_PERIO CF,
			   SEG_PERIO_CORPO SS,
			   SEG_PERIO_CORPO SI,
			   SEG_PERIO_CORPO SF
		WHERE  A.BCAL_OID_BASE_CALC = 4
		   AND CC.OID_PERI = A.PERD_OID_PERI_DESD
		   AND CC.PERI_OID_PERI = SS.OID_PERI
		   AND SS.COD_PERI = #codigoPeriodo#
		   AND A.OID_PARA_GRAL = B.COPA_OID_PARA_GRAL
		   AND B.OID_PARA_GENE_PREM = C.PAGP_OID_PARA_GENE_PREM
		   AND C.OID_PARA_NIVE_PREM = D.PANP_OID_PARA_NIVE_PREM
		   AND D.OID_PREM_ARTI = E.PRAR_OID_PREM_ARTI
		   AND CI.OID_PERI = A.PERD_OID_PERI_DESD
		   AND CF.OID_PERI = A.PERD_OID_PERI_HAST
		   AND SI.OID_PERI = CI.PERI_OID_PERI
		   AND SF.OID_PERI = CF.PERI_OID_PERI   
 		 ORDER BY A.NUM_CONC   
	</select>

    <select id="getACCLongitudDocumento" parameterClass="java.util.Map" resultClass="string">
		SELECT LNG_DOCU_IDEN
		  FROM INT_ACC_PARAM_DOCUM
		 WHERE COD_PAIS = #codigoPais#
		   AND TIP_DOCU_IDEN = #tipoDocumento#   
	</select>

    <!--  MANTENIMIENTO INSERCION - ACC - RECEPCIONAR RECOMENDANTE PREMIO -->
    <insert id="insertInterfazACCRecepcionarRecomendantePremio" parameterClass="interfazACCRecepcionarRecomendantePremio">
    	<![CDATA[
	    INSERT INTO INT_ACC_RCDTE_PREMI
	    (
	    COD_PAIS,
		COD_COMP,
		COD_CLIE_RETE,
		TIP_DOCU_IDEN,
		NUM_DOCU_IDEN,
		NUM_CONC,
		NUM_VERS,
		NUM_PREM,
		NUM_NIVE,
		COD_CAMP_SOLI,
		IND_ASIG_PREM,
		COD_CLIE_RECO,
		FEC_INGR,
		HOR_INGR,
		USU_PROC,
		IND_PROC
		) 
	    VALUES 
	    (
	    #codigoPais#,
		#codigoCompania#,
		#codigoRecomendante#,
		#tipoDocIdentidad#,
		#numeroDocIdentidad#,
		#numeroConcurso#,
		#versionConcurso#,
		#numeroPremio#,
		#nivel#,
		#campanaSolicitud#,
		#indicadorAsignacionPremio#,
		#codigoRecomendada#,
		TO_DATE(#fecha#,'YYYYMMDD'),
		#hora#,
		#usuario#,
		#indicadorProcesado#
	    )
	    ]]>
	</insert>
	
	<parameterMap id="paramValidarACCInterfazRecomendantePremio" class="map">
		<parameter property="codigoRecomendante" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="tipoDocIdentidad" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="numeroConcurso" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="versionConcurso" jdbcType="NUMBER" mode="IN" />
		<parameter property="nivel" jdbcType="NUMBER" mode="IN" />		
		<parameter property="numeroPremio" jdbcType="NUMBER" mode="IN" />
		<parameter property="campanaSolicitud" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />				
		<parameter property="resultado" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="mensajeResultado" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
			
	<procedure id="validarACCInterfazRecomendantePremio" parameterMap="paramValidarACCInterfazRecomendantePremio">
		{call INT_PKG_ACACE.ACC_PR_VALID_RECOM_PREMI(?, ?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>

	<resultMap id="interfazDATEnviarIncentivosProductosAlcanceResult" class="java.util.HashMap">
		<result property="codTipoProdAlcance" column="CODIGO" />
		<result property="desTipoProdAlcance" column="DESCRIPCION" />
	</resultMap>

     <select id="getInterfazDATEnviarIncentivosProductosAlcance" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosProductosAlcanceResult">	
        SELECT COD_TIPO_PROD_ALCA CODIGO,
		       DES_TIPO_PROD_ALCA DESCRIPCION
		  FROM INT_DAT_INC_PRODU_ALCAN
	 </select>

	<resultMap id="interfazDATEnviarIncentivosTipoTiempoResult" class="java.util.HashMap">
		<result property="codTipoTiempo" column="CODIGO" />
		<result property="desTipoTiempo" column="DESCRIPCION" />
	</resultMap>

     <select id="getInterfazDATEnviarIncentivosTipoTiempo" parameterClass="java.util.Map" resultMap="interfazDATEnviarIncentivosTipoTiempoResult">	
        SELECT COD_TIPO_TIEM CODIGO,
		       DES_TIPO_TIEM DESCRIPCION
		  FROM INT_DAT_INC_TIPO_TIEMP
	 </select>

	 <!-- INTERFAZ - DAT - ENVIAR INCENTIVOS TIEMPO-->
  <parameterMap id="executeInterfazDATEnviarIncentivosTiempoParams" class="map">
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>
  <procedure id="executeInterfazDATEnviarIncentivosTiempo" parameterMap="executeInterfazDATEnviarIncentivosTiempoParams" >
		{call INT_PKG_DATAM.INT_PR_DAT_INCEN_TIEMP(?,?,?,?,?,?)}
</procedure> 

  	<parameterMap id="paramValidarACCInterfazActualizaConcursoRecomendacion" class="map">													
		<parameter property="codigoPais"			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />									
		<parameter property="codigoPeriodo"			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />									
		<parameter property="resultado"				jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />								
		<parameter property="mensajeResultado"		jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />										
	</parameterMap>	
														
  	<procedure id="procesarInterfazACCActualizaConcursoRecomendacion" parameterMap="paramValidarACCInterfazActualizaConcursoRecomendacion">													
		{call INT_PKG_ACACE.ACC_PR_ACTUA_CONCU_RECOM(?, ?, ?, ?) }												
	</procedure>													
		
<parameterMap id="paramValidarACCEnviarTablasClientes" class="map">
	    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="tipoEnvio"		         	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>

	<procedure id="executeInterfazACCEnviarTablasClientes" parameterMap="paramValidarACCEnviarTablasClientes">
		{call INT_PKG_ACACE.INT_PR_ACC_ENVIO_CLIEN(?, ?, ?, ?, ?) }												
	</procedure>
  
	<procedure id="executeInterfazACCEnviarTablasClientesAct" parameterMap="paramValidarACCEnviarTablasClientes">
		{call INT_PKG_ACACE.INT_PR_ACC_ENVIO_CLIEN_NOVED(?, ?, ?, ?) }												
	</procedure>

	<parameterMap id="paramValidarACCEnviarTablasCDR" class="map">
	    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"				 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />				
	<parameter property="fechaFacturacion"			 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	</parameterMap>	

	<procedure id="executeInterfazACCEnviarTablasCDR" parameterMap="paramValidarACCEnviarTablasCDR">
		{call INT_PKG_ACACE.INT_PR_ACC_ENVIO_CDR(?, ?, ?, ?, ?, ?) }												
	</procedure>

	<parameterMap id="executeInterfazMYEEnviarTipoProductoCatalogoParams" class="map" >													
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>														
														
    <procedure id="executeInterfazMYEEnviarTipoProductoCatalogo" 														
   			  parameterMap="executeInterfazMYEEnviarTipoProductoCatalogoParams" >											
		{call INT_PKG_MYEBE.INT_PR_MYE_PRODU_CATAL(?,?,?,?,?,?)}												
    </procedure> 					

	<parameterMap id="executeInterfazMYEEnviarFaltantesAnunciadosParams" class="map" >													
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>		
		<parameter property="codigoPeriodo"				 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />										
    </parameterMap>														
														
    <procedure id="executeInterfazMYEEnviarFaltantesAnunciados" 														
   			  parameterMap="executeInterfazMYEEnviarFaltantesAnunciadosParams" >											
		{call INT_PKG_MYEBE.INT_PR_MYE_FALTA_ANUNC(?,?,?,?,?)}												
    </procedure> 					

	<resultMap id="getWebServiceLAREnvioSecuenciacionzonasResult"  class="java.util.HashMap">
		<result property="zona"	    	column="ZONA"/>
		<result property="descripcion"  column="DESCRIPCION"/>
		<result property="secuencia"    column="SECUENCIA"/>
  </resultMap>

    <select id="getWebServiceLAREnvioSecuenciacionzonasList" parameterClass="java.util.Map" resultMap="getWebServiceLAREnvioSecuenciacionzonasResult">
		SELECT COD_ZONA AS ZONA,DES_ZONA AS DESCRIPCION,TO_CHAR(NUM_SECU) AS SECUENCIA 
		FROM APP_RUTAS_TRANS,ZON_ZONA 
		WHERE COD_RUTA=COD_ZONA 
		ORDER BY NUM_SECU 		                                       
	</select>

	<parameterMap id="executeInterfazACCRecepcionarRecomendantePremioParams" class="map">
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCompania"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoRecomendante"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoDocIdentidad"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroDocIdentidad"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroConcurso"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="VersionConcurso"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroPremio"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="nivel"                      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="campanaSolicitud"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="indicadorAsignacionPremio"  jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoRecomendada"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fecha"                      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="hora"                       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario"                    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="indicadorProcesado"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
														
  <procedure id="executeInterfazACCRecepcionarRecomendantePremio" parameterMap="executeInterfazACCRecepcionarRecomendantePremioParams">														
			{call INT_PKG_ACACE.INT_PR_ACC_RECEP_RECTE_RECDA(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)}
  </procedure>


  <!-- INTERFAZ - DAT 96 - ENVIAR TIPO CLASIFICACION PROGRAMA -->														
  <parameterMap id="executeInterfazDATEnviarTipoClasificacionProgramaParams" class="java.util.Map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarTipoClasificacionPrograma" parameterMap="executeInterfazDATEnviarTipoClasificacionProgramaParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_TIPO_CLASIF_PROGR(?,?,?,?,?,?,?)}											
  </procedure> 	


<!-- INTERFAZ - DAT 97 - ENVIAR LOS RESPONSABLES POR SECCION  -->														
  <parameterMap id="executeInterfazDATEnviarResponsablesSeccionParams" class="java.util.Map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarResponsablesSeccion" parameterMap="executeInterfazDATEnviarResponsablesSeccionParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_RESPO_SECCI(?,?,?,?,?,?,?)}											
  </procedure>
  
  
  <!-- INTERFAZ - DAT 98 - ENVIAR EL RANKING DE LAS LIDERES  -->														
  <parameterMap id="executeInterfazDATEnviarRankingLideresParams" class="java.util.Map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
	<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarRankingLideres" parameterMap="executeInterfazDATEnviarRankingLideresParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_RANKI_LIDER(?,?,?,?,?,?,?)}											
  </procedure>
  
 <update id="updateInterfazProcesoBatch" parameterClass="java.util.Map" >
    UPDATE BAS_PROCE_BATCH
       SET COD_INTE = #codigoInterfaz#
     WHERE SIST_COD_SIST = SUBSTR(#codigoInterfaz#,1,3)
       AND COD_PROC_BATC = #codigoProcesoBatch#
  	</update>
  
  <parameterMap id="interfazRETEnviarInformacionVentaParams" class="map" >														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
        <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
  </parameterMap>														
														
  <procedure id="executeInterfazRETEnviarInformacionVenta" parameterMap="interfazRETEnviarInformacionVentaParams" >														
		{call INT_PKG_RETAI.INT_PR_RET_INFOR_VENTA(?, ?, ?, ?, ?, ?)}												
  </procedure>
    
  <parameterMap id="executeInterfazDATEnviarControlParams" class="map">														
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoEmpresa"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>									
		<parameter property="codigoPeriodo"	     		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>									
		<parameter property="indicadorSistema"	         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>									
		<parameter property="indicadorCierre"	     	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>														
														
  <procedure id="executeInterfazDATEnviarControl" 														
   			  parameterMap="executeInterfazDATEnviarControlParams" >											
		{call EDU_PKG_INTER.INT_PR_DAT_CNTRL(?, ?, ?, ?, ?, ?, ?, ?)}												
  </procedure>	
    
	<resultMap id="getPeriodoFechaProcesoActualResult" class="java.util.HashMap">													
		<result property="cod_peri" column="cod_peri" />												
		<result property="fec_proc" column="fec_proc" />												
	</resultMap>													
														
	<select id="getPeriodoFechaProcesoActual" parameterClass="java.util.Map" resultMap="getPeriodoFechaProcesoActualResult">														
		SELECT    cod_peri,
		          to_char(fec_proc,'dd/mm/yyyy') as fec_proc
		FROM      BAS_CTRL_FACT       
		WHERE     COD_PAIS  = #codigoPais# 
		AND       STA_CAMP = '0' 
		AND       IND_CAMP_ACT = '1'
	</select>													
  
	<select id="getPeriodoFechaProceso" parameterClass="java.util.Map" resultMap="getPeriodoFechaProcesoActualResult">														
		SELECT    cod_peri,
		          to_char(fec_proc,'dd/mm/yyyy') as fec_proc
		FROM      BAS_CTRL_FACT       
		WHERE     COD_PAIS  = #codigoPais# 
		AND       cod_peri  = #codigoPeriodo# 
	</select>														
  
    <parameterMap id="executeInterfazMYEEnviarHistoricoPegsParams" class="map" >													
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	    <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>																								
    </parameterMap>														
														
    <procedure id="executeInterfazMYEEnviarHistoricoPegs" 														
   			  parameterMap="executeInterfazMYEEnviarHistoricoPegsParams" >											
		{call INT_PKG_MYEBE.INT_PR_MYE_ENVIO_HISTO_PEGS(?,?,?,?,?,?,?)}												
    </procedure>  		  
    
	<select id="getEquivalenciasCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">														
		select count(1)
		  from pre_matri_factu_cabec a,
		       pre_ofert             b,
		       pre_ofert_detal       c,
		       pre_matri_factu       d,
		       cra_perio             e,
		       seg_perio_corpo       f,
		       pre_ofert_detal       g,
		       pre_matri_factu       h,
		       pre_matri_codig_alter i,
		       mae_produ             j,
		       mae_produ             k,
		       gen_i18n_sicc_pais    l,
		       gen_i18n_sicc_pais    m,
		       pre_tipo_ofert        t,
		       pre_tipo_ofert        u,
		       pre_prod_alter_ice    equi
		 where a.OID_CABE = b.MFCA_OID_CABE
		   and b.OID_OFER = c.OFER_OID_OFER
		   and c.OID_DETA_OFER = d.OFDE_OID_DETA_OFER
		   and a.PERD_OID_PERI = e.OID_PERI
		   and i.MAFA_OID_COD_PPAL = d.OID_MATR_FACT
		   and i.MAFA_OID_COD_ALTE = h.OID_MATR_FACT
		   and h.OFDE_OID_DETA_OFER = g.OID_DETA_OFER
		   and f.OID_PERI = e.PERI_OID_PERI
		   and c.PROD_OID_PROD = j.OID_PROD
		   and j.OID_PROD = l.VAL_OID
		   and l.ATTR_ENTI = 'MAE_PRODU'
		   and g.PROD_OID_PROD = k.OID_PROD
		   and k.OID_PROD = m.VAL_OID
		   and m.ATTR_ENTI = 'MAE_PRODU'
		   and g.tofe_oid_tipo_ofer = t.oid_tipo_ofer
		   and c.tofe_oid_tipo_ofer = u.oid_tipo_ofer
		   and j.COD_SAP = equi.COD_SAP_PPAL									
    </select>

	<parameterMap id="executeInterfazLLIEnviarVentaPeriodoEquivalenciaMap" class="map">													
		<parameter property="codigoPais"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="periodo"	     	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
    </parameterMap>														
														
    <procedure id="executeInterfazLLIEnviarVentaPeriodoEquivalencia" parameterMap="executeInterfazLLIEnviarVentaPeriodoEquivalenciaMap" >											
		{call INT_PKG_LEADE_LIST.LLI_PR_EQUIV_VENTA_PERIO(?,?)}												
    </procedure>

	<parameterMap id="interfazLLIEnviarVentaRealDiariaAcumuladaEquivalenciaParams" class="map" >														
		<parameter property="codigoPais"        		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
        <parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>										
		<parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="fechaFacturacionInicial"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="fechaFacturacionFinal"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
        <parameter property="codigoMarcaLeaderList"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
    	<parameter property="numUltimosDigitos"      	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>														
  														
   <procedure id="executeInterfazLLIEnviarVentaRealDiariaAcumuladaEquivalencia" parameterMap="interfazLLIEnviarVentaRealDiariaAcumuladaEquivalenciaParams" >	  													
		{call INT_PKG_LEADE_LIST.INT_PR_LLI_ENVIO_VREAL_DEQUI(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
   </procedure>	
    

	  <parameterMap id="executeInterfazDATEnviarTablaClientesParams" class="java.util.Map">														
	    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>														
		<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
		<parameter property="codigoCanal"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	  </parameterMap>														
	  <procedure id="executeInterfazDATEnviarTablaClientes" parameterMap="executeInterfazDATEnviarTablaClientesParams">														
				{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_CLIEN(?,?,?,?,?,?,?)}											
	  </procedure>
    
	<resultMap id="getValidaExistenciaProductosResult"  class="java.util.HashMap">
		<result property="codigo"	    	column="CODIGO"/>
    </resultMap>

    <select id="getValidaExistenciaProductos" parameterClass="java.util.Map" resultMap="getValidaExistenciaProductosResult">
		SELECT TRIM(x.num_bore) || '-' || TRIM(x.cod_prod_disc) CODIGO
		  FROM int_rec_detal_borec_tempo x
		 WHERE x.cod_prod_disc IS NOT NULL
		   AND int_pkg_recla.gen_fn_devue_oid_produ_discr(TRIM(COD_PROD_DISC)) IS NULL
	</select>
    
	<select id="getIndicadorEquivalencia" parameterClass="java.util.Map" resultClass="java.lang.String">		
		select nvl(bp.ind_equi,'0')
		  from bas_pais bp
		 where bp.cod_pais = #codigoPais#
    </select>
    
    <select id="getListaProcesosIncentivos" parameterClass="java.util.Map" resultMap="baseResult">
   		SELECT 	A.COD_INTE CODIGO,
       			A.DES_INTE DESCRIPCION
  	      FROM 	BAS_INTER A,
       			BAS_COMPO_PAQUE C
 		 WHERE 	A.PAIS_COD_PAIS = #codigoPais#
   		   AND A.SIST_COD_SIST = #codigoSistema#
   		   AND A.FLA_HABI = 'S'
   		   AND A.est_inte != 9
   		   AND C.INTE_COD_INPA = #codigoInterfaz#
   		   AND A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
   		   AND A.SIST_COD_SIST = C.SIST_COD_SIST
   		   AND A.COD_INTE = C.INTE_COD_INTE
      ORDER BY c.ord_ejec
	</select>
	
	<select id="getListaProcesosCierreFacturacion" parameterClass="java.util.Map" resultMap="baseResult">
   		SELECT 	A.COD_INTE CODIGO,
       			A.DES_INTE DESCRIPCION
  	      FROM 	BAS_INTER A,
       			BAS_COMPO_PAQUE C
 		 WHERE 	A.PAIS_COD_PAIS = #codigoPais#
   		   AND A.SIST_COD_SIST = #codigoSistema#
   		   AND A.FLA_HABI = 'S'
   		   AND A.est_inte != 9
   		   AND C.INTE_COD_INPA = #codigoInterfaz#
   		   AND A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
   		   AND A.SIST_COD_SIST = C.SIST_COD_SIST
   		   AND A.COD_INTE = C.INTE_COD_INTE
      ORDER BY C.NIV_HILO, C.ORD_EJEC_MULT_HILO, C.ORD_EJEC, A.COD_INTE
	</select>
	
	<select id="getListaProcesosLet" parameterClass="java.util.Map" resultMap="baseResult">
   		SELECT 	A.COD_INTE CODIGO,
       			A.DES_INTE DESCRIPCION
  	      FROM 	BAS_INTER A,
       			BAS_COMPO_PAQUE C
 		 WHERE 	A.PAIS_COD_PAIS = #codigoPais#
   		   AND A.SIST_COD_SIST = #codigoSistema#
   		   AND A.FLA_HABI = 'S'
   		   AND A.est_inte != 9
   		   AND C.INTE_COD_INPA = #codigoInterfaz#
   		   AND A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
   		   AND A.SIST_COD_SIST = C.SIST_COD_SIST
   		   AND A.COD_INTE = C.INTE_COD_INTE
      ORDER BY c.ord_ejec
	</select>
	
	<select id="getInterfazPERActualizarPercepcionesConsolidadoCantidad" parameterClass="consolidadosOtrosCanales" resultClass="java.lang.String">
		select    count(1)
		from      PER_PERCE_CONSO
		where     pais_cod_pais = #codigoPais#
		  and     cod_soci = #codigoSociedad#
		  and     cod_cana = #codigoCanal#
		  and     cod_acce = #codigoAcceso#
		  and     cod_sbac = #codigoSubacceso#
		  and     tip_clie = #tipoCliente#
		  <isNotEmpty property="codigoCliente">
		  and     cod_clie = #codigoCliente#
		  </isNotEmpty>
		  <isEmpty  property="codigoCliente">
		  and     cod_clie is null
		  </isEmpty>			
		  and     ser_cope = #serieComprobantePercepcion#
		  and     num_cope = #numeroComprobantePercepcion#
		  and     sec_cope = #secuenciaComprobantePercepcion#
	</select>			

	<update id="updateInterfazPERActualizarPercepcionesConsolidado" parameterClass="consolidadosOtrosCanales">
		update    PER_PERCE_CONSO
		   set    tip_dole = #tipoDocumentoLegal#,
		          fec_dole = #fechaEmisionDocumentoLegal#,
		          ser_dole = #serieDocumentoLegal#,
		          num_dole = #numeroDocumentoLegal#,
		          mon_pago = TO_NUMBER(TRIM(#montoPago#),'999999.9999'),
		          mon_perc = TO_NUMBER(TRIM(#montoPercepcion#),'999999.9999'),
				  por_perc = TO_NUMBER(TRIM(#porcentajePercepcion#),'999999.9999'),								
				  mon_todl = TO_NUMBER(TRIM(#montoTotalDocumentoLegal#),'999999.9999'),								
				  fec_cope = #fechaEmisionComprobantePercepcion#,									
				  fla_proc = #flagProceso#,			
				  fla_canc = #flagCancelacion#,										
				  usu_modi = #auditInfo.createdBy#,									
				  fec_modi = #auditInfo.created#,									
				  est_peco = #estado#,
				  ape_pate = #apellidoPaterno#,								
				  ape_mate = #apellidoMaterno#,									
				  val_nomb = #nombres#
		where     pais_cod_pais = #codigoPais#
		  and     cod_soci = #codigoSociedad#
		  and     cod_cana = #codigoCanal#
		  and     cod_acce = #codigoAcceso#
		  and     cod_sbac = #codigoSubacceso#
		  and     tip_clie = #tipoCliente#
		  <isNotEmpty prepend="AND" property="codigoCliente">														
           cod_clie = #codigoCliente#									
     	  </isNotEmpty>
     	  <isEmpty prepend="AND" property="codigoCliente">														
           cod_clie is null									
     	  </isEmpty>										
		  and     ser_cope = #serieComprobantePercepcion#
		  and     num_cope = #numeroComprobantePercepcion#
		  and     sec_cope = #secuenciaComprobantePercepcion#
	</update>			
	
	<select id="getListaProcesosGenCierreCampania" parameterClass="java.util.Map" resultMap="baseResult">
   		SELECT 	A.COD_INTE CODIGO,
       			A.DES_INTE DESCRIPCION
  	      FROM 	BAS_INTER A,
       			BAS_COMPO_PAQUE C
 		 WHERE 	A.PAIS_COD_PAIS = #codigoPais#
   		   AND A.SIST_COD_SIST = #codigoSistema#
   		   AND A.FLA_HABI = 'S'
   		   AND A.est_inte != 9
   		   AND C.INTE_COD_INPA = #codigoInterfaz#
   		   AND A.PAIS_COD_PAIS = C.PAIS_COD_PAIS
   		   AND A.SIST_COD_SIST = C.SIST_COD_SIST
   		   AND A.COD_INTE = C.INTE_COD_INTE
      ORDER BY C.NIV_HILO, C.ORD_EJEC_MULT_HILO, C.ORD_EJEC, A.COD_INTE   		   
	</select>
	
	<select id="getContCierreCampaByCodigoPeriodo" parameterClass="string" resultClass="java.lang.Integer">
		SELECT COUNT(1)
		FROM  fac_contr_cierr 
		WHERE tcie_oid_tipo_cier = 3
		AND  perd_oid_peri = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#value#) 
	</select>
	
	<select id="getListaAlmacen" parameterClass="java.util.Map" resultMap="baseResult">													
		<![CDATA[																								
		SELECT a.oid_alma as CODIGO, b.val_i18n as DESCRIPCION 
		FROM bel_almac a, gen_i18n_sicc_pais b
		WHERE 
			a.oid_alma=b.val_oid and 
			b.attr_enti='BEL_ALMAC' and 
			a.CCDI_OID_CONFI_CENTR_DISTR is not null												
			]]>												
	</select>	

	<parameterMap id="executeInterfazDATEnviarMaestroProgramaNuevasParams" class="map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
    <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>																					
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarMaestroProgramaNuevas" parameterMap="executeInterfazDATEnviarMaestroProgramaNuevasParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_MAEST_PRNVS(?,?,?,?,?,?,?,?)}											
  </procedure>
  
  <parameterMap id="executeInterfazDATEnviarCuponesPremiosKitsProgramaNuevasParams" class="map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
    <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>																					
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarCuponesPremiosKitsProgramaNuevas" parameterMap="executeInterfazDATEnviarCuponesPremiosKitsProgramaNuevasParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_CUPON_PRNVS(?,?,?,?,?,?,?,?)}											
  </procedure>	
  
  <parameterMap id="executeInterfazDATEnviarCuponesPremiosKitsCuvProgramaNuevasParams" class="map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
    <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>																					
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarCuponesPremiosKitsCuvProgramaNuevas" parameterMap="executeInterfazDATEnviarCuponesPremiosKitsCuvProgramaNuevasParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_CUVPR_PRNVS(?,?,?,?,?,?,?,?)}											
  </procedure>
  
  <parameterMap id="executeInterfazDATEnviarUnidadesAdministrativasProgramaNuevasParams" class="map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
    <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	<parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	<parameter property="codigoAcceso"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>																					
	<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarUnidadesAdministrativasProgramaNuevas" parameterMap="executeInterfazDATEnviarUnidadesAdministrativasProgramaNuevasParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_UNADM_PRNVS(?,?,?,?,?,?,?,?)}											
  </procedure>
  
  <parameterMap id="executeInterfazDATEnviarCuponesUsadosProgramaNuevasParams" class="map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
    <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    <parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
	<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  </parameterMap>														
  <procedure id="executeInterfazDATEnviarCuponesUsadosProgramaNuevas" parameterMap="executeInterfazDATEnviarCuponesUsadosProgramaNuevasParams">														
			{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_CUPON_USADO(?,?,?,?,?,?)}											
  </procedure>

	<procedure id="executeInterfazOCRRecepcionarConsolidadoOCSFlexipago" parameterMap="executeInterfazOCRRecepcionarConsolidadoOCSCabeceraParams" >														
		{call INT_PKG_OCCRR.ocr_pr_recep_conso_cabec_flexi(?,?,?,?,?,?,?)}
    </procedure>	

 	<!-- Juan Carlos Prez -->
      
   	<select id="getOidArchivoControl" parameterClass="java.util.Map" resultClass="long">
			SELECT OID_ARCN 
			FROM BAS_INTER ,INT_ARCHI_CNTRL
			WHERE PAIS_COD_PAIS =#codigoPais#
			  AND    SIST_COD_SIST   =#codigoSistema# 
			  <isNotEmpty prepend="AND" property="preNomArchivo">	
			     NOM_ARCH = #preNomArchivo#
			  </isNotEmpty>
			  AND PAIS_COD_PAIS = COD_PAIS
			  AND COD_TIPO_DOCU = COD_HOMO
			   <isNotEmpty prepend="AND" property="numLoteArchivo">	
			     NUM_LOTE_ARCH = #numLoteArchivo#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="numLote">	
			  	 NUM_LOTE_INTE = #numLote#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="numLineas">
			     NUM_REGI = #numLineas#
			  </isNotEmpty>
			  <isNotEmpty prepend="AND" property="idProcesoBatch">
			     ID_PROC_BATC = #idProcesoBatch#
			  </isNotEmpty>			 
			  <isNotEmpty prepend="AND" property="codigoPaquete">
			     COD_INTE in (select INTE_COD_INTE FROM bas_compo_paque 
			     					where PAIS_COD_PAIS=#codigoPais# 
			     						AND SIST_COD_SIST=#codigoSistema#  
			     						AND INTE_COD_INPA = #codigoPaquete#)
			  </isNotEmpty>
			  
			   <isNotEmpty prepend="AND" property="codigoPaquete">
			      <![CDATA[	 ROWNUM  <=1   ]]>
			  </isNotEmpty>
			  
			   <isNotEmpty prepend="AND" property="codigoInterfaz">
			     COD_INTE =#codigoInterfaz#
			  </isNotEmpty>
			   	
			  AND IND_CARG='0'
	</select>
   
     <update id="updateEstadoArchivoControl" parameterClass="java.util.Map" >
	    UPDATE INT_ARCHI_CNTRL
	       SET IND_CARG = #estadoPendiente#,
	           fec_modi = sysdate ,
	           usu_modi = #codigoUsuario#,
	           ID_PROC_BATC = #idProcesoBatch#
	     WHERE IND_CARG='0'
	       <isNotEmpty prepend="AND" property="numLoteArchivo">
	        	NUM_LOTE_ARCH = #numLoteArchivo#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="codigoInterfazEjecucion">
	        	COD_TIPO_DOCU = (select cod_homo from bas_inter where pais_cod_pais=#codigoPais# and sist_cod_sist = #codigoSistema# and cod_inte = #codigoInterfazEjecucion#) 
	       </isNotEmpty>	        	       
  	</update>

	<parameterMap id="paramInterfazIMPEnviarDocumentosElectronicos" class="java.util.Map">
	    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="codigoSistema"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
	    <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="fechaFacturacion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="nombreArchivo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	
	<procedure id="executeInterfazIMPEnviarFacturasCabecera" parameterMap="paramInterfazIMPEnviarDocumentosElectronicos">
		{call IMP_PKG_PROCE_ELECT.IMP_PR_PROCE_FACTU_ELECT_EC(?, ?, ?, ?, ?, ?) }
	</procedure>	
	
	<procedure id="executeInterfazIMPEnviarFacturasDetalle" parameterMap="paramInterfazIMPEnviarDocumentosElectronicos">
		{call IMP_PKG_PROCE_ELECT. IMP_PR_PROCE_FACTU_ELECT_ECDET(?, ?, ?, ?, ?, ?) }
	</procedure>

	<procedure id="executeInterfazIMPEnviarNotasCreditoCabecera" parameterMap="paramInterfazIMPEnviarDocumentosElectronicos">
		{call IMP_PKG_PROCE_ELECT.IMP_PR_PROCE_NOCRE_ELECT_EC(?, ?, ?, ?, ?, ?) }
	</procedure>

	<procedure id="executeInterfazIMPEnviarNotasCreditoDetalle" parameterMap="paramInterfazIMPEnviarDocumentosElectronicos">
		{call IMP_PKG_PROCE_ELECT.IMP_PR_PROCE_NOCRE_ELECT_ECDET(?, ?, ?, ?, ?, ?) }
	</procedure>

	<procedure id="executeInterfazIMPEnviarProductos" parameterMap="paramInterfazIMPEnviarDocumentosElectronicos">
		{call IMP_PKG_PROCE_ELECT.IMP_PR_PROCE_DETAL_ELECT_EC(?, ?, ?, ?, ?, ?) }
	</procedure>	

	 <select id="getPaisByCia" parameterClass="java.util.Map" resultClass="string">
			SELECT COD_PAIS 
			FROM BAS_PAIS_COMPA
			WHERE COD_PAIS_OCR =#codigoPaisOcr#
			 AND COD_COMP =#codigoCompania#			
	</select>
			
    <select id="getCodigoProcesoBatch" parameterClass="java.util.Map" resultClass="string">
			SELECT COD_PROC_BATC 
			FROM bas_proce_batch
			WHERE PAIS_COD_PAIS =#codigoPais#
			 AND SIST_COD_SIST =#codigoSistema#		
			 AND COD_INTE =#codigoInterfaz#	
	</select>


	<parameterMap id="paramInterfazDATEnviarEjecucionResultados" class="java.util.Map">
	    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
	    <parameter property="codigoMarca"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"	             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
		<parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="codigoSistema"            	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="nombreArchivo"          	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="codigoIso"		         	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	<!-- DAT-125 -->
	<procedure id="executeInterfazDATEnviarEjecucionNivel" parameterMap="paramInterfazDATEnviarEjecucionResultados">
		{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_EJECU_NIVEL(?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>	
	<!-- DAT-126 -->
	<procedure id="executeInterfazDATEnviarCicloEjecucion" parameterMap="paramInterfazDATEnviarEjecucionResultados">
		{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_CICLO_EJECU(?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	<!-- DAT-127 -->
	<procedure id="executeInterfazDATEnviarResultadoEjecucion" parameterMap="paramInterfazDATEnviarEjecucionResultados">
		{call INT_PKG_DATAM.INT_PR_DAT_ENVIO_RESUL_EJECU(?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<select id="getActualDireccionBR" parameterClass="java.util.Map" resultClass="integer">
		SELECT TO_NUMBER(VAL_PARAM) FROM STO_PARAM_GENER_OCCRR WHERE COD_PAIS = #codigoPais# 
				AND COD_PARA = 'STO_ACTUA_DIREC_BR'
	</select>
	
	<select id="getContCierreZonaByCodigoPeriodoOidZona" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
		FROM  fac_contr_cierr 
		WHERE tcie_oid_tipo_cier = 2
		AND  perd_oid_peri = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#)
		AND ZZON_OID_ZONA = #oidZona#
	</select>

	<select id="getContCierreRegionByCodigoPeriodoOidRegion" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(1)
		FROM  fac_contr_cierr 
		WHERE tcie_oid_tipo_cier = 1
		AND  perd_oid_peri = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(#codigoPeriodo#)
		AND ZORG_OID_REGI = #oidRegion#
	</select>
	
	<select id="getCorrelativoACCReferidas" resultClass="integer">
		SELECT MAX(COR_REGI)+1 FROM INT_ACC_REFER 
	</select>
	
	<insert id="insertReferidas" parameterClass="java.util.Map">
		INSERT INTO INT_ACC_REFER
			(COR_REGI, PAIS_COD_PAIS, COD_COMP, NUM_DOCU_RECDA, NUM_DOCU_RECTE, CAM_REGI, IND_PROC, USU_CREA, FEC_CREA)
		VALUES
			(#codigoCorrelativo#,#codigoPais#, #codigoCompanya#,
			#numeroDocumentoIdentidadRecomendada#,#numeroDocumentoIdentidadRecomendante#,#campanyaRegistro#,#indicadorRegistro#,
			#usuarioLogin#, sysdate)
	</insert>	
	
	<resultMap id="paramInterfazArchivosPendientesByFechaResult" class="java.util.HashMap">
		<result property="nombreArchivo"         column="NOM_ARCH_INTE"/>
		<result property="totalRegistros"        column="TOT_REG"/>
	</resultMap>
	
	<select id="getContRegistrosAsociadosCargaArchivosBolVent" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(*)
		  FROM PED_BOLET_ELECT A
		 WHERE A.NOM_ARCH_INTE = #nombreArchivo#
	</select>
	
	<select id="getArchivosPendientesBolVent" parameterClass="java.util.Map" resultMap="paramInterfazArchivosPendientesByFechaResult">
		SELECT A.NOM_ARCH_INTE, COUNT(1) TOT_REG
		  FROM PED_BOLET_ELECT A
		 WHERE A.FEC_PROC = TO_DATE(#fechaProceso#, 'DD/MM/YYYY')
		 GROUP BY A.NOM_ARCH_INTE		 
	</select>
	
	<select id="getContRegistrosAsociadosCargaArchivosNotasCred" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(*)
		  FROM PED_NOTA_CREDI_ELECT A
		 WHERE A.NOM_ARCH_INTE = #nombreArchivo#
	</select>
	
	<select id="getArchivosPendientesNotasCred" parameterClass="java.util.Map" resultMap="paramInterfazArchivosPendientesByFechaResult">
		SELECT A.NOM_ARCH_INTE, COUNT(1) TOT_REG
		  FROM PED_NOTA_CREDI_ELECT A
		 WHERE A.FEC_PROC = TO_DATE(#fechaProceso#, 'DD/MM/YYYY')
		 GROUP BY A.NOM_ARCH_INTE
	</select>
	
	<update id="updateEstadoCargadasArchivoControl" parameterClass="java.util.Map" >
	    UPDATE INT_ARCHI_CNTRL
	       SET IND_CARG = '0',
	           fec_modi = sysdate ,
	           usu_modi = #codigoUsuario#
	     WHERE IND_CARG='1'
	       AND ID_PROC_BATC = #idProcesoBatch# 
	       AND COD_TIPO_DOCU in (select COD_HOMO
		                           FROM bas_compo_paque com, bas_inter ine
		                          where com.PAIS_COD_PAIS = #codigoPais#
		                            AND com.SIST_COD_SIST = #codigoSistema# 
		                            AND com.INTE_COD_INPA = #codigoPaquete#
		                            AND com.PAIS_COD_PAIS = ine.PAIS_COD_PAIS
		                            AND com.SIST_COD_SIST = ine.SIST_COD_SIST
		                            AND com.INTE_COD_INTE = ine.COD_INTE)
  	</update>
  	
  	<select id="getDescripcionArchivoControl" parameterClass="java.util.Map" resultClass="string">
		SELECT DES_INFO_CTRL
		  FROM BAS_HISTO_LOTES
		 WHERE ID_PROC_BATC = #idProcesoBatch# 
		   AND SIST_COD_SIST = #codigoSistema# 
		   AND INTE_COD_INTE = #codigoInterfaz#
		   
		   <isNotEmpty prepend="AND" property="tipoLoteCierre">
		   		DES_INFO_CTRL LIKE '%tipoLote=C%'
		   </isNotEmpty>  
		   <isEmpty prepend="AND" property="tipoLoteCierre">
		   		DES_INFO_CTRL LIKE '%tipoLote=L%'
		   </isEmpty>
		    
	</select>
	
    <parameterMap id="executeInterfazMAEEnviarConsultorasBloqueadasDesbloquedasParams" class="map" >											
		<parameter property="codigoPais"                   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoSistema"	            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"		        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaInicio"                   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaFin"                       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroLote"			     	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	
    <procedure id="executeInterfazMAEEnviarConsultorasBloqueadasDesbloquedas"  parameterMap="executeInterfazMAEEnviarConsultorasBloqueadasDesbloquedasParams" >											
		{call INT_PKG_MAE.MAE_PR_ENVIO_CONSU_BLOQ_DESB(?,?,?,?,?,?,?)}
    </procedure>
    
  	<select id="getExisteSolicitudesCabecera" resultClass="java.lang.String">
		  SELECT COUNT (1) FROM int_tmp_gener_solic_cabec
  	</select>
  	
  	<insert id="insertAsistenciaConferencia" parameterClass="map">
		insert into INT_MAE_ASIST_CONFE
                    (PAIS_COD_PAIS, COD_CAMP, COD_CLIEN, FEC_CREA, USU_CREA)
                  values
                    (#codigoPais#, #codigoCampanha#, #codigoCliente#, sysdate, #usuario#)
	</insert>
	
	<select id="getExisteAsistenciaConferencia" parameterClass="map" resultClass="integer">
		SELECT count(1)
                FROM INT_MAE_ASIST_CONFE imac
                where imac.cod_clien=#codigoCliente#
                and imac.pais_cod_pais=#codigoPais#
	</select>
	
	<update id="updateAsistenciaConferencia" parameterClass="map">
		update INT_MAE_ASIST_CONFE c                                                         
           set c.COD_CAMP= #codigoCampanha#,
               c.fec_modi= sysdate,
               c.usu_modi= #usuario#                                                         
         where c.cod_clien=#codigoCliente#
           and c.pais_cod_pais=#codigoPais#
	</update>
  	<parameterMap id="executeEvaluarExigenciasDescuentosParams" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
  	
	<procedure id="executeEvaluarExigenciasDescuentos" parameterMap="executeEvaluarExigenciasDescuentosParams">
		{call NVS_PKG_PROGR_NUEVA.NVS_PR_EVALU_DCTO_NUEVA(?,?,?,?,?)}
	</procedure>

	<select id="getOidClienteByCodigoCliente" parameterClass="map" resultClass="string">
		SELECT OID_CLIE
          FROM MAE_CLIEN
         WHERE COD_CLIE = #codigoCliente#
	</select>
		
     <update id="updateIndicadorPaqueteDocumentario" parameterClass="java.util.Map" >
	    UPDATE MAE_CLIEN_DATOS_ADICI
	       SET IND_IMPR_PDOC = #indicadorImpresion#,
	           fec_ulti_actu = sysdate,
	           usu_modi = #codigoUsuario#
	     WHERE CLIE_OID_CLIE = #oidCliente#	        	       
  	</update>
  		
  	
  	<parameterMap id="executeReestructurarUnidadAdministrativaParams" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
	
	<procedure id="executeReestructurarUnidadAdministrativa" parameterMap="executeReestructurarUnidadAdministrativaParams">
		{call zon_pkg_unida_admin.ZON_PR_ACTUA_UADMI(?,?,?)}
	</procedure>
  		
 	<delete id="deleteInterfazLLIRecepcionarCargaProductosPlanit">
        TRUNCATE TABLE PED_DESCR_PRODU
    </delete>
    
	<insert id="insertInterfazLLIRecepcionarCargaProductosPlanit" parameterClass="java.util.Map">
			INSERT INTO PED_DESCR_PRODU 
			(
			  COD_CENT, 
			  COD_SAP, 
			  DES_COM 
			)
			VALUES
			(
			#codCent#,
			#codSap#,
			#desCome#
			)
    </insert>	
    
	<parameterMap id="executeGenerarAtencionesInteligentesParams" class="map">
  		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  	</parameterMap>
  
	<procedure id="executeGenerarAtencionesInteligentes" parameterMap="executeGenerarAtencionesInteligentesParams">
			{call INT_PKG_RECLA.INT_PR_REC_GENER_ATEN_INTE(?,?,?,?)}			
	</procedure>
    
    <parameterMap id="executeEliminarAtencionesInteligentesParams" class="map">
  		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"		         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
  	</parameterMap>
  
	<procedure id="executeEliminarAtencionesInteligentes" parameterMap="executeEliminarAtencionesInteligentesParams">
			{call INT_PKG_RECLA.INT_PR_REC_ELIMI_ATEN_INTE(?,?,?,?)}			
	</procedure>
	
	<parameterMap id="executeEliminarDespachosConsultorasNoConstantesParams" class="map">
		<parameter property="codigoPeriodo"    jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaFacturacion" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
	<procedure id="executeEliminarDespachosConsultorasNoConstantes" parameterMap="executeEliminarDespachosConsultorasNoConstantesParams">
		{call CUP_PKG_PROG_NUEVAS.CUP_PR_ELIMI_DESPA_NOCON_CRUCE(?,?)}
	</procedure>
	
	<!-- INTERFAZ - IMP - PROGRAMA PUNTOS-->														
  <parameterMap id="executeInterfazIMPProgramaPuntoParams" class="map">														
    <parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
    <parameter property="codigoPeriodo"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>												
  </parameterMap>														
  <procedure id="executeInterfazIMPProgramaPunto" parameterMap="executeInterfazIMPProgramaPuntoParams">														
			{call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_PROGR_PUNTO(?,?)}											
  </procedure>	  
	  
	<parameterMap id="executeInterfazEnviarResumenDiarioPercepcionesSunatParams" class="map" >															
		<parameter property="codigoPais" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSistema"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>													
		<parameter property="nombreArchivo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>    
		<parameter property="numeroLote"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	
		<parameter property="fechaDesde"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>											
    </parameterMap>																		
  														
	<procedure id="executeInterfazEnviarResumenDiarioPercepcionesSunat" parameterMap="executeInterfazEnviarResumenDiarioPercepcionesSunatParams" >											
		{call INT_PKG_PERCE.INT_PR_PER_ENVIO_RESUM_PERCE(?,?,?,?,?,?,?)}												
	</procedure>
	  
 </sqlMap>