<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">


<sqlMap namespace="scsicc.GraficosSQL">
       <typeAlias alias="graficoPie"          type="biz.belcorp.ssicc.dao.scsicc.model.GraficoPie"/>  
	   <typeAlias alias="graficoBar"          type="biz.belcorp.ssicc.dao.scsicc.model.GraficoBar"/>  

	   <resultMap id="graficoPieResult" class="graficoPie">
		 <result property="leyenda"    	column="LEYENDA"/>
		 <result property="serie"    	column="SERIE"/>		
      </resultMap>	      

	   <resultMap id="graficoBarResult" class="graficoBar">
		 <result property="leyendaCategoria"	column="LEY_CATE"/>
		 <result property="leyendaSerie"        column="LEY_SERI"/>
		 <result property="serie"    	        column="SERIE"/>		
      </resultMap>	      
      
	  <select id="getResumenConsultorasxEstadoPieSituacionDemas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = #situacion#
			  AND B.COD_REGI = #codigoRegion#	
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI
	  </select>	


 	  <select id="getResumenConsultorasxEstadoPieSituacionCapacitada" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = 'CP'

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI
	  </select>	

	  <select id="getResumenConsultorasxEstadoPieRegion" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT E.DES_ESTA_CAPA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			  AND A.EST_CAPA <> 'CP'
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND B.COD_REGI = #codigoRegion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
				
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY E.DES_ESTA_CAPA

			UNION

			SELECT E.DES_ESTA_CAPA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			  AND A.EST_CAPA = 'CP'
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND B.COD_REGI = #codigoRegion#
	
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
				
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND E.COD_ESTA_CAPA = A.EST_CAPA 
			GROUP BY E.DES_ESTA_CAPA	
	  </select>	

	  <select id="getResumenConsultorasxEstadoPieZonaDemas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT B.COD_ZONA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = #situacion#
			  AND B.COD_REGI = #codigoRegion#
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_ZONA
	  </select>		

	  <select id="getResumenConsultorasxEstadoPieZonaCapacitada" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT B.COD_ZONA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = 'CP'
			  AND B.COD_REGI = #codigoRegion#
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_ZONA
	  </select>		


      <select id="getResumenConsultorasxEstadoPie" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI ||' ('||  a.EST_CAPA || ')' AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#
			  AND A.EST_CAPA <> 'CP'	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI, A.EST_CAPA	
            UNION
            SELECT b.COD_REGI || '-' ||d.DES_REGI ||' ('||  a.EST_CAPA || ')' AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#
			  AND A.EST_CAPA = 'CP'	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI

			GROUP BY B.COD_REGI, D.DES_REGI, A.EST_CAPA		
	  </select>	
	  

      <select id="getResumenConsultorasxEstadoBarSituacionDemas" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = #situacion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA	
	  </select>	

	  <select id="getResumenConsultorasxEstadoBarSituacionCapacitada" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = 'CP'
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA	
	  </select>	
	

	  <select id="getResumenConsultorasxEstadoBarRegion" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI
				AND B.COD_REGI = #codigoRegion#
			  AND E.COD_ESTA_CAPA = 'CP'
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA	

			UNION

			SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
				   
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D	,
				 EDU_ESTAD_CAPAC E		   				   

			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  AND B.COD_REGI = #codigoRegion#
			  AND E.COD_ESTA_CAPA = 'PR'
			  
			GROUP BY E.DES_ESTA_CAPA ,B.COD_REGI, D.DES_REGI

			UNION

			SELECT E.DES_ESTA_CAPA AS LEY_CATE,
                   j.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI,  
                   COUNT (0) AS serie
		    FROM edu_empre_comer a,
        		 edu_param_curso_capac b,
		         edu_maest_clien j,
		         edu_histo_calif_aptas l,
        		 edu_param_progr_capac ppc,
				 edu_regio d,
				 EDU_ESTAD_CAPAC E
		   WHERE b.pais_cod_pais = #codigoPais#
		     AND a.pais_cod_pais = b.pais_cod_pais
		     AND a.cod_empr_come = b.emco_cod_empr_come
		     AND ppc.pais_cod_pais = b.pais_cod_pais
		     AND ppc.emco_cod_empr_come = b.emco_cod_empr_come
		     AND ppc.cod_prog_capa = '01'
		     AND l.pais_cod_pais = b.pais_cod_pais
		     AND l.emco_cod_empr_come = b.emco_cod_empr_come
		     AND l.ccap_cod_curs_capa = b.cod_curs_capa
		     AND l.est_regi != '9'
	    	 AND j.pais_cod_pais = l.pais_cod_pais
    	 	 AND j.emco_cod_empr_come = l.emco_cod_empr_come
		     AND j.cod_clie = l.clie_cod_clie
		     AND l.num_invi > 0
		     AND b.emco_cod_empr_come = #codigoEmpresa#
		     AND b.cod_curs_capa = #codigoCurso#
		     AND TO_NUMBER (l.cam_proc) >= TO_NUMBER (#campanhaProceso#)
  			<![CDATA[
		     AND TO_NUMBER (l.cam_proc) <= TO_NUMBER (#campanhaProcesoFin#)
			]]>
		 	 and d.pais_cod_pais = b.pais_cod_pais
			 and d.emco_cod_empr_come = b.emco_cod_empr_come
			 and d.cod_regi = j.cod_regi
       	 	 AND D.COD_REGI =#codigoRegion#
             AND E.COD_ESTA_CAPA = l.EST_CAPA
		   GROUP BY  E.DES_ESTA_CAPA,j.COD_REGI, D.DES_REGI	

			UNION
			
			SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = #situacion#
			  AND B.COD_REGI = #codigoRegion#
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
             AND B.COD_REGI not in ('CP','PC','PR')
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA

	  </select>				

      <select id="getResumenConsultorasxEstadoBarZonaDemas" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = #situacion#
			  AND B.COD_REGI = #codigoRegion#
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA
	  </select>  

      <select id="getResumenConsultorasxEstadoBarZonaCapacitada" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  
			  AND B.COD_REGI = #codigoRegion#
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA
	  </select>  
 
    <select id="getResumenConsultorasxEstadoBar" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_CAPA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#			  
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA

			UNION
	
			SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY b.COD_REGI,d.DES_REGI,B.COD_ZONA

			UNION

			SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_CALIF_APTAS A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY b.COD_REGI,d.DES_REGI,B.COD_ZONA
			
			UNION
	
			SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA not in ('CP','PC','PR')
			  
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE

			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA

	  </select>	

	 <select id="getResumenConsultorasxEstadoPieHistoricoSituacionAptas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		  SELECT   j.cod_regi|| '-' || d.des_regi AS leyenda, COUNT (0) AS serie
		    FROM edu_empre_comer a,
        		 edu_param_curso_capac b,
		         edu_maest_clien j,
		         edu_histo_calif_aptas l,
        		 edu_param_progr_capac ppc,
				 edu_regio d
		   WHERE b.pais_cod_pais = #codigoPais#
		     AND a.pais_cod_pais = b.pais_cod_pais
		     AND a.cod_empr_come = b.emco_cod_empr_come
		     AND ppc.pais_cod_pais = b.pais_cod_pais
		     AND ppc.emco_cod_empr_come = b.emco_cod_empr_come
		     AND ppc.cod_prog_capa = '01'
		     AND l.pais_cod_pais = b.pais_cod_pais
		     AND l.emco_cod_empr_come = b.emco_cod_empr_come
		     AND l.ccap_cod_curs_capa = b.cod_curs_capa
		     AND l.est_regi != '9'
	    	 AND j.pais_cod_pais = l.pais_cod_pais
    	 	 AND j.emco_cod_empr_come = l.emco_cod_empr_come
		     AND j.cod_clie = l.clie_cod_clie
		     AND l.num_invi > 0
		     AND b.emco_cod_empr_come = #codigoEmpresa#
		     AND b.cod_curs_capa = #codigoCurso#
		     AND TO_NUMBER (l.cam_proc) >= TO_NUMBER (#campanhaProceso#)
  			<![CDATA[
		     AND TO_NUMBER (l.cam_proc) <= TO_NUMBER (#campanhaProcesoFin#)
			]]>
		 	 and d.pais_cod_pais = b.pais_cod_pais
			 and d.emco_cod_empr_come = b.emco_cod_empr_come
			 and d.cod_regi = j.cod_regi
  			
		group by j.cod_regi, d.des_regi
			
	  </select>

      <select id="getResumenConsultorasxEstadoPieHistoricoSituacionProgramadas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI
	  </select>

      <select id="getResumenConsultorasxEstadoPieHistoricoSituacionCapacitadas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI
	  </select>

    	
<select id="getResumenConsultorasxEstadoPieHistoricoRegion" parameterClass="java.util.Map" resultMap="graficoPieResult">
			SELECT   E.DES_ESTA_CAPA AS leyenda, COUNT (0) AS serie
		    FROM edu_empre_comer a,
        		 edu_param_curso_capac b,
		         edu_maest_clien j,
		         edu_histo_calif_aptas l,
        		 edu_param_progr_capac ppc,
				 edu_regio d,
				 EDU_ESTAD_CAPAC E
		   WHERE b.pais_cod_pais = #codigoPais#
		     AND a.pais_cod_pais = b.pais_cod_pais
		     AND a.cod_empr_come = b.emco_cod_empr_come
		     AND ppc.pais_cod_pais = b.pais_cod_pais
		     AND ppc.emco_cod_empr_come = b.emco_cod_empr_come
		     AND ppc.cod_prog_capa = '01'
		     AND l.pais_cod_pais = b.pais_cod_pais
		     AND l.emco_cod_empr_come = b.emco_cod_empr_come
		     AND l.ccap_cod_curs_capa = b.cod_curs_capa
		     AND l.est_regi != '9'
	    	 AND j.pais_cod_pais = l.pais_cod_pais
    	 	 AND j.emco_cod_empr_come = l.emco_cod_empr_come
		     AND j.cod_clie = l.clie_cod_clie
		     AND l.num_invi > 0
		     AND b.emco_cod_empr_come = #codigoEmpresa#
		     AND b.cod_curs_capa = #codigoCurso#
		     AND TO_NUMBER (l.cam_proc) >= TO_NUMBER (#campanhaProceso#)
  			<![CDATA[
		     AND TO_NUMBER (l.cam_proc) <= TO_NUMBER (#campanhaProcesoFin#)
			]]>
		 	 and d.pais_cod_pais = b.pais_cod_pais
			 and d.emco_cod_empr_come = b.emco_cod_empr_come
			 and d.cod_regi = j.cod_regi
			  AND D.COD_REGI =#codigoRegion#
    	     AND E.COD_ESTA_CAPA = l.EST_CAPA

			group by E.DES_ESTA_CAPA

			UNION

            SELECT E.DES_ESTA_CAPA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI				
			  AND e.cod_esta_capa='PR'
			GROUP BY E.DES_ESTA_CAPA

			UNION

            SELECT E.DES_ESTA_CAPA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI	
			  AND e.cod_esta_capa='CP'		  
			GROUP BY E.DES_ESTA_CAPA

			UNION

			SELECT F.DES_ESTA_CAPA AS LEYENDA,
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E,
				 EDU_ESTAD_CAPAC F
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#  	
			 <![CDATA[		
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			 ]]>				
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
 		      AND D.COD_REGI =#codigoRegion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  
			  AND F.COD_ESTA_CAPA = A.EST_CAPA
			  AND f.cod_esta_capa not in ('CP','PC','PR')
			GROUP BY F.DES_ESTA_CAPA
	
     </select>	 

	 <select id="getResumenConsultorasxEstadoPieHistoricoZonaAptas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT B.COD_ZONA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_CALIF_APTAS A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_ZONA
	  </select>

      <select id="getResumenConsultorasxEstadoPieHistoricoZonaProgramadas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT B.COD_ZONA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_ZONA
	  </select>

      <select id="getResumenConsultorasxEstadoPieHistoricoZonaCapacitadas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT B.COD_ZONA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI

			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_ZONA
	  </select>

     <select id="getResumenConsultorasxEstadoPieHistorico" parameterClass="java.util.Map" resultMap="graficoPieResult">
			SELECT  j.COD_REGI || '-' ||d.DES_REGI ||' ('||  l.EST_CAPA || ')' AS LEYENDA, 
				  count(0) AS SERIE
			  FROM EDU_EMPRE_COMER       A,
			       EDU_PARAM_CURSO_CAPAC B,
			       EDU_MAEST_CLIEN       J,
			       EDU_HISTO_CALIF_APTAS L,
			       EDU_PARAM_PROGR_CAPAC PPC,
			       EDU_ESTAD_CAPAC E,
				 EDU_REGIO D
			 WHERE B.PAIS_COD_PAIS = #codigoPais#
			   AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			   AND A.COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			   AND PPC.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			   AND PPC.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			   AND PPC.COD_PROG_CAPA = '01'
			   AND L.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			   AND L.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			   AND L.CCAP_COD_CURS_CAPA = B.COD_CURS_CAPA
			   AND L.EST_REGI != '9'
			   AND J.PAIS_COD_PAIS = L.PAIS_COD_PAIS
			   AND J.EMCO_COD_EMPR_COME = L.EMCO_COD_EMPR_COME
			   AND J.COD_CLIE = L.CLIE_COD_CLIE
			   AND L.NUM_INVI > 0
			   AND B.EMCO_COD_EMPR_COME = #codigoEmpresa#
			   AND B.COD_CURS_CAPA = #codigoCurso#
			   AND TO_NUMBER(L.CAM_PROC) >= TO_NUMBER(#campanhaProceso#)
  			<![CDATA[
			   AND TO_NUMBER(L.CAM_PROC) <= TO_NUMBER(#campanhaProcesoFin#)
			]]>
			   AND E.COD_ESTA_CAPA = 'PC'   
			   AND D.PAIS_COD_PAIS = B.PAIS_COD_PAIS
		 	   AND D.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
		 	   AND D.COD_REGI = J.COD_REGI   
			GROUP BY j.COD_REGI,d.DES_REGI,l.EST_CAPA

			UNION

            SELECT b.COD_REGI || '-' ||d.DES_REGI ||' ('||  'PR' || ')' AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI

			UNION

            SELECT b.COD_REGI || '-' ||d.DES_REGI ||' ('||  'CP' || ')' AS LEYENDA,  
				  count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D

			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
  			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI
						
			UNION

			SELECT b.COD_REGI || '-' ||d.DES_REGI||' (' || a.est_capa
			     || ')' AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA not in ('CP','PC','PR')

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			GROUP BY B.COD_REGI, D.DES_REGI,a.est_capa		

     </select>

	 <select id="getResumenConsultorasxEstadoBarHistoricoSituacionAptas" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_HISTO_CALIF_APTAS A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA	
	  </select>

      <select id="getResumenConsultorasxEstadoBarHistoricoSituacionProgramadas" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA	
	  </select>

      <select id="getResumenConsultorasxEstadoBarHistoricoSituacionCapacitadas" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA	
	  </select>

	 <select id="getResumenConsultorasxEstadoBarHistoricoRegion" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI AS LEY_CATE,
				   E.DES_ESTA_CAPA AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_HISTO_CALIF_APTAS A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
  			  AND D.COD_REGI =#codigoRegion#
			 
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA
			
		UNION
			
		    SELECT b.COD_REGI || '-' ||d.DES_REGI AS LEY_CATE,
				   E.DES_ESTA_CAPA AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA
			
		 UNION
		 	
		    SELECT b.COD_REGI || '-' ||d.DES_REGI AS LEY_CATE,
				   E.DES_ESTA_CAPA AS LEY_SERI, 
				   count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ESTAD_CAPAC E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#
			 
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND E.COD_ESTA_CAPA = A.EST_CAPA
			GROUP BY B.COD_REGI, D.DES_REGI, E.DES_ESTA_CAPA
	  </select>

     <select id="getResumenConsultorasxEstadoBarZonaHistoricoAptas" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_CALIF_APTAS A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
  			  AND D.COD_REGI =#codigoRegion#
			 
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA
       </select>

 			
       <select id="getResumenConsultorasxEstadoBarZonaHistoricoProgramadas" parameterClass="java.util.Map" resultMap="graficoBarResult">			
		    SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA
     </select>			

     <select id="getResumenConsultorasxEstadoBarZonaHistoricoCapacitadas" parameterClass="java.util.Map" resultMap="graficoBarResult">			
		    SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_CAPAC_DETAL A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_CAPA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_CAPA <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#
			 
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = D.COD_REGI

			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY B.COD_REGI, D.DES_REGI, B.COD_ZONA
       </select>

	<select id="getResumenConsultorasxEstadoPieHistoricoZonaDemas" parameterClass="java.util.Map" resultMap="graficoPieResult">
		    SELECT B.COD_ZONA AS LEYENDA, 
				  count(0) AS SERIE
			FROM EDU_HISTO_APTAS A, 
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#  	
			 <![CDATA[		
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			 ]]>				
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.EST_CAPA = #situacion#
 		      AND D.COD_REGI =#codigoRegion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  
			GROUP BY B.COD_ZONA
	  </select> 

	<select id="getResumenConsultorasxEstadoBarSituacionProgramada" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   b.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
				   
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D	,
				 EDU_ESTAD_CAPAC E		   				   

			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND E.COD_ESTA_CAPA = 'PR'
			  
			GROUP BY E.DES_ESTA_CAPA ,B.COD_REGI, D.DES_REGI
	  </select>	

	  <select id="getResumenConsultorasxEstadoBarSituacionAptas" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT E.DES_ESTA_CAPA AS LEY_CATE,
				   j.COD_REGI || '-' ||d.DES_REGI AS LEY_SERI, 
				   count(0) AS SERIE
			  FROM EDU_EMPRE_COMER       A,
			       EDU_PARAM_CURSO_CAPAC B,
			       EDU_MAEST_CLIEN       J,
			       EDU_HISTO_CALIF_APTAS L,
			       EDU_PARAM_PROGR_CAPAC PPC,
			       EDU_ESTAD_CAPAC E,
			       EDU_REGIO D
			 WHERE B.PAIS_COD_PAIS = #codigoPais#
			   AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			   AND A.COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			   AND PPC.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			   AND PPC.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			   AND PPC.COD_PROG_CAPA = '01'
			   AND L.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			   AND L.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			   AND L.CCAP_COD_CURS_CAPA = B.COD_CURS_CAPA
			   AND L.EST_REGI != '9'
			   AND J.PAIS_COD_PAIS = L.PAIS_COD_PAIS
			   AND J.EMCO_COD_EMPR_COME = L.EMCO_COD_EMPR_COME
			   AND J.COD_CLIE = L.CLIE_COD_CLIE
			   AND L.NUM_INVI > 0
			   AND B.EMCO_COD_EMPR_COME = #codigoEmpresa#
			   AND B.COD_CURS_CAPA = #codigoCurso#
			   AND TO_NUMBER(L.CAM_PROC) >= TO_NUMBER(#campanhaProceso#)
  			<![CDATA[
			   AND TO_NUMBER(L.CAM_PROC) <= TO_NUMBER(#campanhaProcesoFin#)
			]]>
			   AND E.COD_ESTA_CAPA = 'PC'
  			
    		   AND D.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			   AND D.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			   AND D.COD_REGI = J.COD_REGI
			
			GROUP BY  E.DES_ESTA_CAPA,j.COD_REGI, D.DES_REGI
	  </select>	

	  <select id="getResumenConsultorasxEstadoBarZonaProgramada" parameterClass="java.util.Map" resultMap="graficoBarResult">
		    SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_PLANI_PROGR_CURSO A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_PROC >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_PROC <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#
			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY b.COD_REGI,d.DES_REGI,B.COD_ZONA
	  </select>

	  <select id="getResumenConsultorasxEstadoBarZonaAptas" parameterClass="java.util.Map" resultMap="graficoBarResult">
			SELECT b.COD_REGI || '-' ||d.DES_REGI  AS LEY_CATE, 
				   B.COD_ZONA   AS LEY_SERI, 	
				  count(0) AS SERIE
			FROM EDU_HISTO_CALIF_APTAS A,
				 EDU_MAEST_CLIEN B, 
				 EDU_REGIO D,
				 EDU_ZONA  E 
			WHERE A.PAIS_COD_PAIS = #codigoPais#
              AND A.EMCO_COD_EMPR_COME = #codigoEmpresa#
			  AND A.CCAP_COD_CURS_CAPA = #codigoCurso#
			  AND A.CAM_ULTI_CALI_APTA >= #campanhaProceso#
  			<![CDATA[
			  AND A.CAM_ULTI_CALI_APTA <= #campanhaProcesoFin#	
			]]>
			  AND D.COD_REGI =#codigoRegion#

			  AND A.PAIS_COD_PAIS = B.PAIS_COD_PAIS
			  AND A.EMCO_COD_EMPR_COME = B.EMCO_COD_EMPR_COME
			  AND A.CLIE_COD_CLIE = B.COD_CLIE
			
			  AND B.PAIS_COD_PAIS = D.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = D.EMCO_COD_EMPR_COME
			  AND B.COD_REGI = D.COD_REGI
			  
			  AND B.PAIS_COD_PAIS = E.PAIS_COD_PAIS
			  AND B.EMCO_COD_EMPR_COME = E.EMCO_COD_EMPR_COME	
			  AND B.COD_REGI = E.REGI_COD_REGI	
			  AND B.COD_ZONA = E.COD_ZONA
			  	
			GROUP BY b.COD_REGI,d.DES_REGI,B.COD_ZONA		
	  </select>

</sqlMap>