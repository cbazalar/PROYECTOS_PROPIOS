<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="edu.GenericoEDUComercialFOXSQL">

    <resultMap id="resultPedidosConsultoraMap" class="java.util.HashMap">
        <result property="codigoPais" column="EDCODPAI"/>
        <result property="codigoEmpresa" column="EDCODEMP"/>
        <result property="codigoPeriodo" column="EDCAMPRC"/>
        <result property="codigoCliente" column="EDCODCLI"/>
        <result property="indicadorFacturacion" column="EDINDFAC"/>
        <result property="indicadorPedido" column="EDINDPED"/>
        <result property="fechaRecepcion" column="EDFECREC"/>
        <result property="fechafacturacion" column="EDFECFAC"/>
        <result property="codRegion" column="ACOCODREG"/>
        <result property="codZona" column="ACOCODZON"/>
        <result property="codPra" column="ACODSCPRA"/>
        <result property="codSea" column="ACODSCSEA"/>
        <result property="codPrn" column="ACODSCPRN"/>
        <result property="codSen" column="ACODSCSEN"/>
        <result property="fecha" column="FECHA"/> 
        <result property="codCotel" column="ACOTEL1CO"/>
        <result property="codMor" column="ACOINDMOR"/>
        <result property="codSac" column="ACOVLRSAC"/>
        <result property="codSeccion" column="ACOCODSEC"/>
        <result property="codTerritorio" column="ACOCODTER"/>
        <result property="telefono" column="NUMTEL"/>
		<result property="campIngresoComercial" 	column="EDCMPING"/>	
    </resultMap>

    <resultMap id="resultPedidosConsultoraNombreCompletoMap" class="java.util.HashMap">
        <result property="codigoPais" column="EDCODPAI"/>
        <result property="codigoEmpresa" column="EDCODEMP"/>
        <result property="codigoPeriodo" column="EDCAMPRC"/>
        <result property="codigoCliente" column="EDCODCLI"/>
        <result property="indicadorFacturacion" column="EDINDFAC"/>
        <result property="indicadorPedido" column="EDINDPED"/>
        <result property="fechaRecepcion" column="EDFECREC"/>
        <result property="fechafacturacion" column="EDFECFAC"/>
        <result property="codRegion" column="ACOCODREG"/>
        <result property="codZona" column="ACOCODZON"/>
        <result property="nombreCompleto" column="ACNOMCOM"/>
        <result property="fecha" column="FECHA"/> 
        <result property="codCotel" column="ACOTEL1CO"/>
        <result property="codMor" column="ACOINDMOR"/>
        <result property="codSac" column="ACOVLRSAC"/>
        <result property="codSeccion" column="ACOCODSEC"/>
        <result property="codTerritorio" column="ACOCODTER"/>
        <result property="telefono" column="NUMTEL"/>
		<result property="campIngresoComercial" 	column="EDCMPING"/>	
    </resultMap>

    <resultMap id="resultPedidosMap" class="java.util.HashMap">
        <result property="codigoPais" column="EDCODPAI"/>
        <result property="codigoEmpresa" column="EDCODEMP"/>
        <result property="codigoPeriodo" column="EDCAMPRC"/>
        <result property="codigoCliente" column="EDCODCLI"/>
        <result property="indicadorFacturacion" column="EDINDFAC"/>
        <result property="indicadorPedido" column="EDINDPED"/>
        <result property="fechaRecepcion" column="EDFECREC"/>
        <result property="fechafacturacion" column="EDFECFAC"/>
    </resultMap>

    <resultMap id="resultPedidosCursosMap" class="java.util.HashMap">
        <result property="codigoPeriodo" column="EDCAMPRC"/>
        <result property="codigoCliente" column="EDCODCLI"/>
        <result property="indicadorCompra" column="EDINDCMP"/>
        <result property="fechafacturacion" column="EDFECFAC"/>
        <result property="codigoCurso" column="EDCODCUR"/>
    </resultMap>

    <resultMap id="resultArchivoControl" class="java.util.HashMap">
        <result property="codigoPeriodo"        column="CAMPA"/>
        <result property="fechafacturacion"     column="FECFA"/>
        <result property="estado"     			column="EST"/>
        <result property="indicadorActivo"     column="INDACT"/>
    </resultMap>

    <resultMap id="resultRegiones" class="java.util.HashMap">
        <result property="codigoRegion"           column="ODRCODREG"/>
        <result property="descRegion"        column="ODRDSCREG"/>
        <result property="nomGerenteRegional"     column="ODRNOMGEREREGI"/>
        <result property="emailGerenteRegional"   column="ODREMAGEREREGI"/>
		<result property="codigoGerenteRegional"  column="ODRCODGEREREGI"/>
    </resultMap>

    <resultMap id="resultZonas" class="java.util.HashMap">
        <result property="codigoRegion"           column="ODRCODREG"/>
        <result property="codigoZona"        column="ODZCODZON"/>
        <result property="descZona"        column="ODZDSCEBE"/>
        <result property="correoGZ"        column="OPDDESDIR"/>
		<result property="status"        column="ODSTATUS"/>
    </resultMap>

    <resultMap id="resultMantenimientoCapacitadas" class="java.util.HashMap">
        <result property="codigoClasificacion" column="EDCODCLA"/>
        <result property="nombreClasificacion" column="EDDESCLA"/>
    </resultMap>

    <resultMap id="resultBeneficiosCapacitadas" class="java.util.HashMap">
        <result property="codigoClasificacion" column="EDBCODCLA"/>
        <result property="codigoPeriodo" column="EDBCODCTA"/>
    </resultMap>

    <resultMap id="resultMatrizProducto" class="matrizProducto">
        <result property="codigoPeriodo"         column="MMCAMP"/>
        <result property="codigoVenta"           column="MMMCOD"/>
        <result property="codigoProducto"        column="MMCPRO"/>
        <result property="descripcionProducto"        column="KNMPRD"/>
        <result property="valorUnitario"         column="MMVLUN"/>
    </resultMap>

    <select id="getPedidosConsultora" parameterClass="java.util.Map" resultMap="resultPedidosConsultoraMap">
			SELECT EP.EDCODPAI,
					EP.EDCODEMP,
					EP.EDCAMPA as EDCAMPRC, 
					EP.EDCODCON as EDCODCLI, 
					EP.EDINDFAC, 
					EP.EDINDPED, 
			     	'' as ACODSCSEN	,
					'' as ACOINDMOR          ,
          	   dtos(ep.edfecfac) as EDFECFAC , 
               IIF(ep.edfecrec IS NULL,NULL,right(dtos(ep.edfecrec),2) + '/' + substr(dtos(ep.edfecrec),5,2) + '/' + left(dtos(ep.edfecrec),4)) AS EDFECREC,
               IIF(ep.ebifenac IS NULL,NULL,right(dtos(ep.ebifenac),2) + '/' + substr(dtos(ep.ebifenac),5,2) + '/' + left(dtos(ep.ebifenac),4)) AS FECHA,
			   substr(ep.ebinombr,at(#valorDelimitadorNombreCompleto#,ep.ebinombr)+1,at(#valorDelimitadorNombreCompleto#,ep.ebinombr,2)-at(#valorDelimitadorNombreCompleto#,ep.ebinombr)-1 ) as ACODSCSEA  ,
			   left(ep.ebinombr,at(#valorDelimitadorNombreCompleto#,ep.ebinombr)-1) as ACODSCPRA , 
			   right(ep.ebinombr,len(ebinombr)- at(#valorDelimitadorNombreCompleto#,ebinombr,2)) as ACODSCPRN , 
               left(ep.ebiterri,2) as ACOCODREG , 
               substr(ep.ebiterri,3,4) as ACOCODZON, 
               substr(ep.ebiterri,7,1) as ACOCODSEC, 
               right(ep.ebiterri,2)  as ACOCODTER,  
               ep.ebinrtlf as ACOTEL1CO, 
               ep.ebislebe as ACOVLRSAC,  
               ep.ebitlf2 as NUMTEL,                
			   EP.EDCMPING
			FROM "$servidorPais$$libEducacion$".EDPEDCNS EP 
			WHERE EP.EDCODPAI = #codigoPais# and 
				  EP.EDCODEMP = #codigoEmpresa# and 
				  EP.EDCAMPA = #codigoPeriodo# and 
				  EP.EDINDFAC = '0' and 
				  (EP.EDINDPED = '1' or EP.EDINDPED = '2')

	</select>

    <select id="getPedidosConsultoraNombreCompleto" parameterClass="java.util.Map" resultMap="resultPedidosConsultoraNombreCompletoMap">
			SELECT EP.EDCODPAI,
					EP.EDCODEMP,
					EP.EDCAMPA as EDCAMPRC, 
					EP.EDCODCON as EDCODCLI, 
					EP.EDINDFAC, 
					EP.EDINDPED, 
					'' as ACOINDMOR          ,
          	   dtos(ep.edfecfac) as EDFECFAC , 
               IIF(ep.edfecrec IS NULL,NULL,right(dtos(ep.edfecrec),2) + '/' + substr(dtos(ep.edfecrec),5,2) + '/' + left(dtos(ep.edfecrec),4)) AS EDFECREC,
               IIF(ep.ebifenac IS NULL,NULL,right(dtos(ep.ebifenac),2) + '/' + substr(dtos(ep.ebifenac),5,2) + '/' + left(dtos(ep.ebifenac),4)) AS FECHA,
			   ep.ebinombr as ACNOMCOM ,
               left(ep.ebiterri,2) as ACOCODREG , 
               substr(ep.ebiterri,3,4) as ACOCODZON, 
               substr(ep.ebiterri,7,1) as ACOCODSEC, 
               right(ep.ebiterri,2)  as ACOCODTER,  
               ep.ebinrtlf as ACOTEL1CO, 
               ep.ebislebe as ACOVLRSAC,  
               ep.ebitlf2 as NUMTEL,                
			   EP.EDCMPING
			FROM "$servidorPais$$libEducacion$".EDPEDCNS EP 
			WHERE EP.EDCODPAI = #codigoPais# and 
				  EP.EDCODEMP = #codigoEmpresa# and 
				  EP.EDCAMPA = #codigoPeriodo# and 
				  EP.EDINDFAC = '0' and 
				  (EP.EDINDPED = '1' or EP.EDINDPED = '2')
	</select>

   <resultMap id="resultMigracionComercialConsultoraMap" class="java.util.HashMap">
        <result property="codigoPais" column="EBCODPAI"/>
        <result property="codigoEmpresa" column="EBCODEMP"/>
        <result property="codigoPeriodo" column="EBCAMPRC"/>
        <result property="codigoCliente" column="EBCODCLI"/>
        <result property="fechaNacimiento" column="EBFECNAC"/>
		<result property="apellidoPaterno" column="EBAPEPAT"/>
		<result property="apellidoMaterno" column="EBAPEMAT"/>
		<result property="primerNombre" column="EBPRINOM"/>
		<result property="segundoNombre" column="EBSEGNOM"/>
		<result property="indicadorMorosidad" column="EBINDMOR"/>
        <result property="codigoRegion" column="EBCODREG"/>
        <result property="codigoZona" column="EBCODZON"/>
        <result property="codigoSeccion" column="EBCODSEC"/>
        <result property="codigoTerritorio" column="EBCODTER"/>
		<result property="telefono" column="EBNUMTEL"/>
		<result property="telefonoCelular" column="EBNUMCEL"/>
		<result property="saldoCliente" column="EBSALCLI"/>
   </resultMap>

   <select id="getMigracionComercialConsultora" parameterClass="java.util.Map" resultMap="resultMigracionComercialConsultoraMap">
			SELECT 
                #codigoPais# AS EBCODPAI,
				#codigoEmpresa# AS EBCODEMP,
				#codigoPeriodo# AS EBCAMPRC, 
				EBICODEB AS EBCODCLI, 
				IIF(ebifenac IS NULL,NULL,right(dtos(ebifenac),2) + '/' + substr(dtos(ebifenac),5,2) + '/' + left(dtos(ebifenac),4)) AS EBFECNAC,
				left(ebinombr,at(#valorDelimitadorNombreCompleto#, ebinombr)-1) AS EBAPEPAT , 
			    substr(ebinombr,at(#valorDelimitadorNombreCompleto#, ebinombr)+1,at(#valorDelimitadorNombreCompleto#, ebinombr,2)-at(#valorDelimitadorNombreCompleto#, ebinombr)-1 ) AS EBAPEPAT ,
				right(ebinombr,len(ebinombr)- at(#valorDelimitadorNombreCompleto#, ebinombr, 2)) AS EBPRINOM , 
				'' as EBSEGNOM	,
				'' as EBINDMOR ,
                left(ebiterri,2) AS EBCODREG , 
                substr(ebiterri,3,4) AS EBCODZON, 
                substr(ebiterri,7,1) AS EBCODSEC, 
                right(ebiterri,2) AS EBCODTER,  
                ebinrtlf AS EBNUMTEL, 
                ebislebe AS EBSALCLI,  
                ebinrtlf AS EBNUMCEL
			FROM "$servidorPais$$libEducacion$".EBIDENT EP 
			WHERE 
			<![CDATA[
				EP.EBISITUA <> #codigoEstado#
			]]>
	</select>

    <select id="getPedidosConsultoraFacturados" parameterClass="java.util.Map" resultMap="resultPedidosMap">
            SELECT CN.EDCODPAI, 
					CN.EDCODEMP, 
					CN.EDCAMPA as EDCAMPRC, 
					CN.EDCODCON as EDCODCLI, 
					CN.EDINDFAC, 
					CN.EDINDPED, 
               		right(dtos(cn.edfecrec),2) + '/' + substr(dtos(cn.edfecrec),5,2) + '/' + left(dtos(cn.edfecrec),4) AS EDFECREC,            
               		right(dtos(cn.edfecfac),2) + '/' + substr(dtos(cn.edfecfac),5,2) + '/' + left(dtos(cn.edfecfac),4) AS EDFECFAC
			FROM    "$servidorPais$$libEducacion$".EDPEDCNS CN
            WHERE   CN.EDCODPAI = #codigoPais#  and
					CN.EDCODEMP = #codigoEmpresa# and
					CN.EDCAMPA =  #codigoPeriodo# and
					CN.EDFECFAC IN (SELECT ct.CTFFECHA FROM "$servidorPais$$libEducacion$".EDCTRLFA ct)
    </select>

    <select id="getPedidosCursosFacturados" parameterClass="java.util.Map" resultMap="resultPedidosCursosMap">
            SELECT  DISTINCT
					CN.EDCMPLIM as EDCAMPRC, 
					CN.EDCODCON as EDCODCLI, 
					CN.EDCODCUR , 
					CN.EDINDCMP , 
               		right(dtos(cn.edfecfac),2) + '/' + substr(dtos(cn.edfecfac),5,2) + '/' + left(dtos(cn.edfecfac),4) AS EDFECFAC
			FROM    "$servidorPais$$libEducacion$".EDCURCST  CN
            WHERE   
					CN.EDCMPLIM =  #codigoPeriodo# and
					CN.EDFECFAC IN (SELECT ct.CTFFECHA FROM "$servidorPais$$libEducacion$".EDCTRLFA ct)
    </select>

    <select id="getPedidosCursosNoFacturados" parameterClass="java.util.Map" resultMap="resultPedidosCursosMap">
            SELECT  DISTINCT
					CN.EDCMPLIM as EDCAMPRC, 
					CN.EDCODCON as EDCODCLI, 
					CN.EDCODCUR , 
					CN.EDINDCMP ,
					'' AS EDFECFAC
			FROM    "$servidorPais$$libEducacion$".EDCURCST  CN
            WHERE   
					CN.EDCMPLIM =  #codigoPeriodo# and
					CN.EDINDCMP = '0'
    </select>

    <select id="getControlFacturacionComercial" parameterClass="java.util.Map" resultMap="resultArchivoControl">
					SELECT  
							CTFCAMPA as CAMPA, 
							left(dtos(CTFFECHA),4) + substr(dtos(CTFFECHA),5,2) +  right(dtos(CTFFECHA),2)  AS FECFA , 
							'1' as EST,
							'1' as INDACT
					from "$servidorPais$$libEducacion$".EDCTRLFA
	</select>	

    <select id="getRegionesComercial" parameterClass="java.util.Map" resultMap="resultRegiones">
						  select STCDAREA as ODRCODREG , 
								 STDESCRI as ODRDSCREG,
								 STNOMBRE as ODRNOMGEREREGI,
								 STDIREMA as ODREMAGEREREGI,
								 '' 	  as ODRCODGEREREGI	
							from "$servidorPais$$libEducacion$".EDREGION
	</select>	

    <select id="getZonasComercial" parameterClass="java.util.Map" resultMap="resultZonas">
						select  left(stcdzona,2) as ODRCODREG,  
								right(stcdzona,4) as ODZCODZON,  
								stdescri as ODZDSCEBE ,
								stdirema as OPDDESDIR,
								stzstats as ODSTATUS 
						from "$servidorPais$$libEducacion$".EDZONA
	</select>	

    <update id="reindexAptas" parameterClass="java.util.Map" >
		REINDEX ALL ON "$servidorPais$$libEducacion$".EDINVITA
	</update>

	<update id="lockAptas" parameterClass="java.util.Map" >
		LOCK TABLE "$servidorPais$$libEducacion$".EDINVITA
	</update>

    <update id="unlockAptas" parameterClass="java.util.Map" >
		UNLOCK TABLE "$servidorPais$$libEducacion$".EDINVITA
	</update>

    <insert id="insertarAptas" parameterClass="java.util.Map">
					INSERT INTO  "$servidorPais$$libEducacion$".EDINVITA ( 
								EDCODCON , 
								EDCODCUR , 
								EDCODINV ,
								EDCODMSE , 
								EDCODMSG , 
								EDCODLOT ,
							    EDFLADIN
							) VALUES (
								#codigoCliente# ,
								#codigoCurso#	, 
								#codigoClasificacion# ,
								#codigoMensajeEsp# ,
								#codigoMensajeGen# ,
								#numeroLote# ,
								#indicadorEnviaInvit#
							)
	</insert>

    <insert id="insertarAptasCosto" parameterClass="java.util.Map">
					INSERT INTO  "$servidorPais$$libEducacion$".EDCURCST  ( 
								EDCODCON, 
       							EDCODCUR, 
       							EDCMPINI, 
       							EDCODEST, 
       							EDINDCMP, 
       							EDCMPLIM, 
       							EDCMPULT, 
       							EDCODMSE ,
							    EDCODMSG ,
								EDCODINV
							) VALUES (
								#codigoCliente# ,
								#codigoCurso#	, 
								#campIni# ,
								#estadoCompra# ,
								'0' ,
								#campLim# ,
								#campIni# ,
								#codigoMensajeEsp# ,
								#codigoMensajeGen# ,
								#codigoClasificacion#	
							)
	</insert>

    <select id="getMatrizProducto" parameterClass="java.util.Map" resultMap="resultMatrizProducto">
					select 	mat.cmmcampa as MMCAMP ,
							mat.cmmmcodi as MMMCOD ,
							mat.cmmcprod as MMCPRO ,
							''  as KNMPRD ,
							mat.cmmvluni as MMVLUN 
				    from "$servidorPais$$libEducacion$".EDtimtri mat  			 
					where mat.cmmcampa = #codigoPeriodo# 
						  and mat.cmmcuv = #codigoVenta#						    						  
	</select>	

	<insert id="insertParametrosCursoCapacitacion" parameterClass="java.util.Map">
				INSERT INTO "$servidorPais$$libEducacion$".EDDESCUR (
									 EDCODCUR, 
									 EDCURDES
								        ) 
									 VALUES (
									 #codigoCurso#, 
									 #nombreCurso#
													)
	</insert>

	<update id="updateParametrosCursoCapacitacion" parameterClass="java.util.Map">
				UPDATE "$servidorPais$$libEducacion$".EDDESCUR SET 
								EDCURDES = #nombreCurso#
					   WHERE    
								ALLTRIM(EDCODCUR) = ALLTRIM(#codigoCurso#)

				
	</update>

    <delete id="deleteAptasCierreFacturacion" parameterClass="java.util.Map" >
					DELETE  FROM    EDHISEDU 
	</delete>

    <delete id="deleteAptasCosto" parameterClass="java.util.Map">
					DELETE  FROM   "$servidorPais$$libEducacion$".EDCURCST 
					WHERE  EDCODEST IN ('E','C') 
					<isNotEmpty property="listCursos">	
				    	<iterate prepend="AND" property="listCursos" open=" EDCODCUR IN (" close=")" conjunction=",">
        	 					#listCursos[]#
		        		</iterate>    
					</isNotEmpty>		
	</delete>

    <insert id="insertarResultCierreFacturacion" parameterClass="java.util.Map" >
					INSERT INTO "$servidorPais$$libEducacion$".EDHISEDU 
								(EDHNROCTA, 
								EDHNIVALC, 
								EDHESTINV, 
								EDHSIGNIV) 
						   VALUES (
								#codigoCliente#, 
								#nivelCapacitacion#, 
								#estadoCapacitacion#, 
								#valorCapacitacion#)	
	</insert>

    <select id="getBeneficiosCapacitadas" parameterClass="java.util.Map" resultMap="resultBeneficiosCapacitadas">
			SELECT 
					EDBCODCLA,
					EDBCODCTA
            FROM  "$servidorPais$$libEducacion$".EDBENEF 
	<dynamic prepend="where">                                    
		<isNotEmpty prepend="AND" property="codigoClasificacion">           
				EDBCODCLA = #codigoClasificacion#                             
    	</isNotEmpty>                                            
		<isNotEmpty prepend="AND" property="codigoCliente">        
			  	EDBCODCTA = #codigoCliente#                          
    	</isNotEmpty>                                            
	</dynamic>                                                   
    </select>

    <insert id="insertarBeneficiosCapacitadas" parameterClass="java.util.Map" >
					INSERT INTO "$servidorPais$$libEducacion$".EDBENEF 
								(EDCODCLA, 
								 EDCODCON,
								 EDCODCUR,
								 EDCODMSG,
								 EDCODMSE ) 
						   VALUES (
								#codigoClasificacion#, 
								#codigoCliente#,
								#codigoCurso#,
								#codigoMensajeGral#,
								#codigoMensajeEspecifico#)	
	</insert>

	<update id="updateBeneficiosCapacitadas" parameterClass="java.util.Map">
				UPDATE "$servidorPais$$libEducacion$".EDBENEF 
								SET 
								EDBCODCLA = #codigoClasificacion#, 
								EDBCODCTA = #codigoCliente#
					   WHERE    EDBCODCLA = #codigoClasificacion# AND 
								EDBCODCTA = #codigoCliente#
	</update>

    <select id="getMantenimientoClasificacion" parameterClass="java.util.Map" resultMap="resultMantenimientoCapacitadas">
			SELECT 
					EDCODCLA ,
					EDDESCLA 
            FROM  "$servidorPais$$libEducacion$".EDCLASIF 
	<dynamic prepend="where">                                    
		<isNotEmpty prepend="AND" property="codigoClasificacion">           
			EDCODCLA = #codigoClasificacion#                             
    	</isNotEmpty>                                            
	</dynamic>                                                   
    </select>

    <select id="getMantenimientoClasificacionInvi" parameterClass="java.util.Map" resultMap="resultMantenimientoCapacitadas">
			SELECT 
					EDCODINV as EDCODCLA,
					EDDESINV as EDDESCLA
            FROM "$servidorPais$$libEducacion$".EDINVTA 
	<dynamic prepend="where">                                    
		<isNotEmpty prepend="AND" property="codigoClasificacion">           
			EDCODINV = #codigoClasificacion#                             
    	</isNotEmpty>                                            
	</dynamic>                                                   
    </select>

    <insert id="insertMantenimientoClasificacion" parameterClass="java.util.Map" >
					INSERT INTO "$servidorPais$$libEducacion$".EDCLASIF 
								(
									EDCODCLA ,
									EDDESCLA 
											) 
						   VALUES (
								#codigoClasificacion# , 
								#nombreClasificacion# )
	</insert>

    <insert id="insertMantenimientoCodVenta" parameterClass="java.util.Map" >
					INSERT INTO "$servidorPais$$libEducacion$".EDCODVTA  
								(
									EDCODVTA ,
									EDCODCUR , 
									EDCODCMP
											) 	
						   VALUES (
								#codigoVenta# , 
								#codigoCurso# ,
								#codigoPeriodo# 

							)	
	</insert>

    <insert id="insertMantenimientoClasificacionInvi" parameterClass="java.util.Map" >
					INSERT INTO "$servidorPais$$libEducacion$".EDINVTA 
								(
									EDCODINV ,
									EDDESINV 
											) 
						   VALUES (
								#codigoClasificacion# , 
								#nombreClasificacion# )
	</insert>

	<update id="updateMantenimientoClasificacion" parameterClass="java.util.Map">
				UPDATE "$servidorPais$$libEducacion$".EDCLASIF 
								SET 
								EDCODCLA = #codigoClasificacion# , 
								EDDESCLA = #nombreClasificacion#
					   WHERE    EDCODCLA = #codigoClasificacion# 
 	</update>

	<update id="updateMantenimientoClasificacionInvi" parameterClass="java.util.Map">
				UPDATE "$servidorPais$$libEducacion$".EDINVTA 
								SET 
								EDCODINV = #codigoClasificacion# , 
								EDDESINV = #nombreClasificacion#
					   WHERE    EDCODINV = #codigoClasificacion# 
 	</update>

	<delete id="deleteMantenimientoClasificacion" parameterClass="java.util.Map">
				DELETE FROM "$servidorPais$$libEducacion$".EDCLASIF 
					   WHERE    EDCODCLA = #codigoClasificacion# 
 	</delete>

	<delete id="deleteMantenimientoClasificacionInvi" parameterClass="java.util.Map">
				DELETE FROM "$servidorPais$$libEducacion$".EDINVTA 
					   WHERE    EDCODINV = #codigoClasificacion# 
 	</delete>

    <select id="getExisteEmpresaComercializadora" parameterClass="java.util.Map" resultClass="int">
		SELECT  COUNT(1)
		FROM  "$servidorPais$$libEducacion$".EDEMPRES
		WHERE EDCODPAI = #codigoPais#
          AND EDCODEMP = #codigoEmpresa#
	</select>

    <insert id="insertEmpresaComercializadora" parameterClass="java.util.Map" >
		INSERT INTO "$servidorPais$$libEducacion$".EDEMPRES(EDCODPAI, EDCODEMP, EDDESEMP) 
		   VALUES (
					#codigoPais#, 
					#codigoEmpresa#,
					#descripcion#)	
	</insert>

    <update id="updateEmpresaComercializadora" parameterClass="java.util.Map">
		UPDATE "$servidorPais$$libEducacion$".EDEMPRES 
		SET 
			EDDESEMP = #descripcion#
		WHERE EDCODPAI = #codigoPais#
		  AND EDCODEMP = #codigoEmpresa#
 	</update>

    <delete id="deleteEmpresaComercializadora" parameterClass="java.util.Map">
		DELETE FROM "$servidorPais$$libEducacion$".EDEMPRES  
        WHERE EDCODPAI = #codigoPais#
	      AND EDCODEMP = #codigoEmpresa#
 	</delete>

	<select id="getExisteMensajeEducacion" parameterClass="java.util.Map" resultClass="int">
		SELECT  COUNT(1)
		FROM  "$servidorPais$$libEducacion$".EDMENSA
		WHERE EDCODCUR = #codigoCurso#
          AND EDCODMEN = #codigoMensaje#
	</select>	

   <insert id="insertMensajeEducacion" parameterClass="java.util.Map" >
		INSERT INTO "$servidorPais$$libEducacion$".EDMENSA(EDCODCUR, EDCODMEN, EDDESMEN) 
		   VALUES (
					#codigoCurso#, 
					#codigoMensaje#,
					#descripcionMensaje#)	
	</insert>

	<update id="updateMensajeEducacion" parameterClass="java.util.Map">
				UPDATE "$servidorPais$$libEducacion$".EDMENSA 
				SET 
					EDDESMEN = #descripcionMensaje#
				WHERE 
                    EDCODCUR = #codigoCurso# AND
					EDCODMEN = #codigoMensaje# 
 	</update>

	<delete id="deleteMensajeEducacion" parameterClass="java.util.Map">
				DELETE FROM "$servidorPais$$libEducacion$".EDMENSA 
				WHERE 
                    EDCODCUR= #codigoCurso# AND
					EDCODMEN = #codigoMensaje# 
 	</delete>

    <insert id="insertBloqueoConsultora" parameterClass="java.util.Map">
				INSERT INTO "$servidorPais$$libEducacion$".EDBLQCON ( 
						EDCODCON, 
       					EDBLQCMP,
						EDINDPRO
				) VALUES (
						#codigoCliente# ,
						#codigoPeriodo#,
						'0'	
				)
	</insert>

    <select id="getExisteCronogramaDictado" parameterClass="java.util.Map" resultClass="int">
		SELECT  COUNT(1)
		FROM  "$servidorPais$$libEducacion$".EDCRONO
		WHERE EDIDCRON = #oidCronograma#
	</select>

    <update id="reindexEnvioCronogramaDictado" parameterClass="java.util.Map" >
		REINDEX ALL ON "$servidorPais$$libEducacion$".EDCRONO
	</update>

	<update id="packCronogramaDictado" parameterClass="java.util.Map" >
		PACK TABLE "$servidorPais$$libEducacion$".EDCRONO
	</update>

	<update id="lockCronogramaDictado" parameterClass="java.util.Map" >
		LOCK TABLE "$servidorPais$$libEducacion$".EDCRONO
	</update>

    <update id="unlockCronogramaDictado" parameterClass="java.util.Map" >
		UNLOCK TABLE "$servidorPais$$libEducacion$".EDCRONO
	</update>

    <insert id="insertCronogramaDictado" parameterClass="java.util.Map" >
		INSERT INTO "$servidorPais$$libEducacion$".EDCRONO(
			EDIDCRON,
            EDCODCUR,
			EDCAMCRO,
			EDREGION,
			EDFECDIC,
			EDHORINI,
			EDHORFIN,
			EDDESLOC,
            EDDIRLOC,
            EDDESALA,
			EDESTACT,
			EDZONA) 
		 VALUES (
			#oidCronograma#,
			#codigoCurso#, 
			#campannaCronograma#,
			#codigoRegion#,
			#fechaDictado#,
			#horaInicial#,
			#horaFin#,
			#descripcionLocal#,
			#direccion#,
			#descripcionSala#,
			#estadoActividad#,
			#codigoZona#)	
	</insert>

    <update id="updateCronogramaDictado" parameterClass="java.util.Map">
		UPDATE "$servidorPais$$libEducacion$".EDCRONO
		SET 
			EDCODCUR = #codigoCurso#,
			EDCAMCRO = #campannaCronograma#,
			EDREGION = #codigoRegion#,
			EDFECDIC = #fechaDictado#,
			EDHORINI = #horaInicial#,
			EDHORFIN = #horaFin#,
			EDDESLOC = #descripcionLocal#,
            EDDIRLOC = #direccion#,
            EDDESALA = #descripcionSala#,	
			EDESTACT = #estadoActividad#
		WHERE EDIDCRON = #oidCronograma#
 	</update>

   <delete id="deleteEnvioCronogramaDictado" parameterClass="java.util.Map">
		DELETE FROM "$servidorPais$$libEducacion$".EDCRONO
		WHERE EDCAMCRO = #codigoPeriodo#
		<isNotNull property="regionList">
		  <iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
               EDREGION = #regionList[]#
		 </iterate>
        </isNotNull>  	
 	</delete>

    <delete id="deleteCronogramaDictadoZona" parameterClass="java.util.Map">
		DELETE FROM "$servidorPais$$libEducacion$".EDCROZON
		WHERE EDIDCRON = #oidCronograma#
 	</delete>

    <delete id="deleteCronogramaDictado" parameterClass="java.util.Map">
		DELETE FROM "$servidorPais$$libEducacion$".EDCRONO
		WHERE EDIDCRON = #oidCronograma#
 	</delete>


    <insert id="insertCronogramaDictadoZona" parameterClass="java.util.Map">
		INSERT INTO "$servidorPais$$libEducacion$".EDCROZON (EDIDCRON, EDREGION, EDZONA)
		VALUES (#oidCronograma#, #codigoRegion#, #codigoZona#)
 	</insert>

    <delete id="deleteGenerarPlanillaProgramacion" parameterClass="java.util.Map">
		DELETE FROM "$servidorPais$$libEducacion$".EDCONPRG
		WHERE 
		  <iterate property="regionList" open="(" close=")" conjunction="OR">
               EDREGION = #regionList[]#
		 </iterate>  	
 	</delete>
	
    <insert id="insertGenerarPlanillaProgramacion" parameterClass="java.util.Map">
		INSERT INTO "$servidorPais$$libEducacion$".EDCONPRG
			(EDCODCON, EDCODCUR, EDCODCMP, EDREGION)
		VALUES 
            (#codigoCliente#, #codigoCurso#, #codigoPeriodoSgte#, #codigoRegion# )
 	</insert>

	<select id="getExisteStatusConsultora" parameterClass="java.util.Map" resultClass="int">
		SELECT  COUNT(1)
		FROM  "$servidorPais$$libEducacion$".EDCONSTA
		WHERE EDCODCON = #codigoCliente#
	</select>

    <insert id="insertEnvioStatusConsultora" parameterClass="java.util.Map">
		INSERT INTO "$servidorPais$$libEducacion$".EDCONSTA
			(EDCODCON, EDNIVEL, EDESTADO, EDSIGNIV,EDCODCMP,EDREGION)
		VALUES 
            (#codigoCliente#, #nivelActual#, #descripcionEstado#, #nivelSiguiente#,#codigoPeriodo#,#codigoRegion# )
 	</insert>

    <update id="updateEnvioStatusConsultora" parameterClass="java.util.Map">
		UPDATE "$servidorPais$$libEducacion$".EDCONSTA
	    SET EDNIVEL  = #nivelActual#, 
            EDESTADO = #descripcionEstado#, 
            EDSIGNIV = #nivelSiguiente#
		WHERE EDCODCON = #codigoCliente#
 	</update>

    <update id="reindexEnvioStatusConsultora" parameterClass="java.util.Map" >
		REINDEX ALL ON "$servidorPais$$libEducacion$".EDCONSTA
	</update>

    <update id="lockStatusConsultora" parameterClass="java.util.Map" >
		LOCK TABLE "$servidorPais$$libEducacion$".EDCONSTA
	</update>

    <update id="unlockStatusConsultora" parameterClass="java.util.Map" >
		UNLOCK TABLE  "$servidorPais$$libEducacion$".EDCONSTA
	</update>

	<select id="getExisteCursoCapacitacion" parameterClass="java.util.Map" resultClass="int">
		SELECT  COUNT(1)
		FROM  "$servidorPais$$libEducacion$".EDDESCUR
		WHERE ALLTRIM(EDCODCUR) = ALLTRIM(#codigoCurso#)
         
	</select>	


   <update id="lockGenerarPlanillaProgramacion" parameterClass="java.util.Map" >
		LOCK TABLE "$servidorPais$$libEducacion$".EDCONPRG
	</update>

    <update id="unlockGenerarPlanillaProgramacion" parameterClass="java.util.Map" >
		UNLOCK TABLE "$servidorPais$$libEducacion$".EDCONPRG
	</update>

    <update id="packGenerarPlanillaProgramacion" parameterClass="java.util.Map" >
		PACK TABLE "$servidorPais$$libEducacion$".EDCONPRG
	</update>

	<update id="reindexGenerarPlanillaProgramacion" parameterClass="java.util.Map" >
		REINDEX ALL ON "$servidorPais$$libEducacion$".EDCONPRG
	</update>

  	<update id="packAptasCosto" parameterClass="java.util.Map" >
		PACK TABLE "$servidorPais$$libEducacion$".EDCURCST
	</update>


    <insert id="insertarConfirmacionCursoCosto" parameterClass="java.util.Map">
					INSERT INTO  "$servidorPais$$libEducacion$".EDCURCST  ( 
								EDCODCON, 
       							EDCODCUR, 
       							EDCMPINI, 
       							EDCODEST, 
       							EDINDCMP, 
       							EDCMPLIM, 
       							EDCMPULT, 
       							EDCODMSE ,
							    EDCODMSG ,
								EDCODINV 
							) VALUES (
								#codigoCliente# ,
								#codigoCurso#	, 
								#campIni# ,
								'C' ,
								'0' ,
								#campLim# ,
								#codigoPeriodo# ,
								#codigoMensajeEsp# ,
								#codigoMensajeGen# ,
								#codigoClasificacion#
							)
	</insert>

   <delete id="deleteStatusConsultora" parameterClass="java.util.Map" >
		DELETE  FROM "$servidorPais$$libEducacion$".EDCONSTA
		WHERE (1=1)
		<isNotNull property="regionList">
		  <iterate prepend="AND" property="regionList" open="(" close=")" conjunction="OR">
               EDREGION = #regionList[]#
		 </iterate>
        </isNotNull>  	
		
	</delete>

	<update id="packStatusConsultora" parameterClass="java.util.Map" >
		PACK TABLE "$servidorPais$$libEducacion$".EDCONSTA
	</update>

    <select id="getPedidosConsultoraCUV" parameterClass="java.util.Map" resultMap="resultPedidosConsultoraMap">
					SELECT EP.EDCODPAI,
					EP.EDCODEMP,
					EP.EDCAMPA as EDCAMPRC, 
					EP.EDCODCON as EDCODCLI, 
					EP.EDINDFAC, 
					EP.EDINDPED, 
			     	'' as ACODSCSEN	,
					'' as ACOINDMOR          ,
          	   dtos(ep.edfecfac) as EDFECFAC , 
               IIF(ep.edfecrec IS NULL,NULL,right(dtos(ep.edfecrec),2) + '/' + substr(dtos(ep.edfecrec),5,2) + '/' + left(dtos(ep.edfecrec),4)) AS EDFECREC,
               IIF(ep.ebifenac IS NULL,NULL,right(dtos(ep.ebifenac),2) + '/' + substr(dtos(ep.ebifenac),5,2) + '/' + left(dtos(ep.ebifenac),4)) AS FECHA,
			   substr(ep.ebinombr,at(#valorDelimitadorNombreCompleto#,ep.ebinombr)+1,at(#valorDelimitadorNombreCompleto#,ep.ebinombr,2)-at(#valorDelimitadorNombreCompleto#,ep.ebinombr)-1 ) as ACODSCSEA  ,
			   left(ep.ebinombr,at(#valorDelimitadorNombreCompleto#,ep.ebinombr)-1) as ACODSCPRA , 
			   right(ep.ebinombr,len(ebinombr)- at(#valorDelimitadorNombreCompleto#,ebinombr,2)) as ACODSCPRN , 
               left(ep.ebiterri,2) as ACOCODREG , 
               substr(ep.ebiterri,3,4) as ACOCODZON, 
               substr(ep.ebiterri,7,1) as ACOCODSEC, 
               right(ep.ebiterri,2)  as ACOCODTER,  
               ep.ebinrtlf as ACOTEL1CO, 
               ep.ebislebe as ACOVLRSAC,  
               '' as NUMTEL,
			   EP.EDCMPING
			FROM "$servidorPais$$libEducacion$".EDPEDCNS EP 
			WHERE EP.EDCODPAI = #codigoPais# and 
				  EP.EDCODEMP = #codigoEmpresa# and 
				  EP.EDCAMPA = #codigoPeriodo# and 
				  EP.EDINDFAC = '0' and 
				  EP.EDINDPED = '2' and
				  EP.EDINDCCUR = '1'	
   </select>

   <select id="getPedidosConsultoraNombreCompletoCUV" parameterClass="java.util.Map" resultMap="resultPedidosConsultoraNombreCompletoMap">
					SELECT EP.EDCODPAI,
					EP.EDCODEMP,
					EP.EDCAMPA as EDCAMPRC, 
					EP.EDCODCON as EDCODCLI, 
					EP.EDINDFAC, 
					EP.EDINDPED, 
					'' as ACOINDMOR          ,
          	   dtos(ep.edfecfac) as EDFECFAC , 
               IIF(ep.edfecrec IS NULL,NULL,right(dtos(ep.edfecrec),2) + '/' + substr(dtos(ep.edfecrec),5,2) + '/' + left(dtos(ep.edfecrec),4)) AS EDFECREC,
               IIF(ep.ebifenac IS NULL,NULL,right(dtos(ep.ebifenac),2) + '/' + substr(dtos(ep.ebifenac),5,2) + '/' + left(dtos(ep.ebifenac),4)) AS FECHA,
			   ep.ebinombr as ACNOMCOM ,
               left(ep.ebiterri,2) as ACOCODREG , 
               substr(ep.ebiterri,3,4) as ACOCODZON, 
               substr(ep.ebiterri,7,1) as ACOCODSEC, 
               right(ep.ebiterri,2)  as ACOCODTER,  
               ep.ebinrtlf as ACOTEL1CO, 
               ep.ebislebe as ACOVLRSAC,  
               '' as NUMTEL,
			   EP.EDCMPING
			FROM "$servidorPais$$libEducacion$".EDPEDCNS EP 
			WHERE EP.EDCODPAI = #codigoPais# and 
				  EP.EDCODEMP = #codigoEmpresa# and 
				  EP.EDCAMPA = #codigoPeriodo# and 
				  EP.EDINDFAC = '0' and 
				  EP.EDINDPED = '2' and
				  EP.EDINDCCUR = '1'	
	</select>
	
	
    <resultMap id="resultZONRegiones" class="java.util.HashMap">
        <result property="codigoPais"             column="COD_PAIS"/>
        <result property="codigoRegion"           column="COD_REGI"/>
        <result property="descripcionRegion"      column="DES_REGI"/>
        <result property="codigoCliente"     	  column="CODCLIENT"/>
        <result property="indicadorActividad"     column="IND_ACTI"/>
		<result property="usuarioCreacion"        column="USU_CREA"/>
		<result property="fechaCreacion"          column="FEC_CREA"/>
		<result property="usuarioModificacion"    column="USU_MODI"/>
		<result property="fechaModificacion"      column="FEC_MODI"/>
		<result property="estadoRegistro"         column="EST_REGI"/>
		
    </resultMap>

    <select id="getZONRegionesComercial" parameterClass="java.util.Map" resultMap="resultZONRegiones">
	  select 
	        COD_PAIS,	
			COD_REGI,	
			DES_REGI,	
			CODCLIENT,	
			IND_ACTI,	
			USU_CREA,	
			IIF(FEC_CREA IS NULL,NULL,right(dtos(FEC_CREA),2) + '/' + substr(dtos(FEC_CREA),5,2) + '/' + left(dtos(FEC_CREA),4)) AS FEC_CREA,
			USU_MODI,	
			IIF(FEC_MODI IS NULL,NULL,right(dtos(FEC_MODI),2) + '/' + substr(dtos(FEC_MODI),5,2) + '/' + left(dtos(FEC_MODI),4)) AS FEC_MODI,
			EST_REGI
		from "$servidorPais$$libEducacion$".DCVREGIO
	</select>	

    
    
    <resultMap id="resultZONZonas" class="java.util.HashMap">
        <result property="codigoPais"             column="COD_PAIS"/>
        <result property="codigoRegion"           column="COD_REGI"/>
        <result property="codigoZona"             column="COD_ZONA"/>
        <result property="descripcionZona"        column="DES_ZONA"/>
        <result property="codigoCliente"     	  column="CODCLIENT"/>
        <result property="indicadorActividad"     column="IND_ACTI"/>
		<result property="usuarioCreacion"        column="USU_CREA"/>
		<result property="fechaCreacion"          column="FEC_CREA"/>
		<result property="usuarioModificacion"    column="USU_MODI"/>
		<result property="fechaModificacion"      column="FEC_MODI"/>
		<result property="estadoRegistro"         column="EST_REGI"/>
    </resultMap>
    
    <select id="getZONZonasComercial" parameterClass="java.util.Map" resultMap="resultZONZonas">
		select  
		    COD_PAIS,	
			COD_REGI,	
			COD_ZONA,
			DES_ZONA,	
			CODCLIENT,	
			IND_ACTI,	
			USU_CREA,	
			IIF(FEC_CREA IS NULL,NULL,right(dtos(FEC_CREA),2) + '/' + substr(dtos(FEC_CREA),5,2) + '/' + left(dtos(FEC_CREA),4)) AS FEC_CREA,
			USU_MODI,	
			IIF(FEC_MODI IS NULL,NULL,right(dtos(FEC_MODI),2) + '/' + substr(dtos(FEC_MODI),5,2) + '/' + left(dtos(FEC_MODI),4)) AS FEC_MODI,
			EST_REGI
		from "$servidorPais$$libEducacion$".DCVZONA
	</select>	
	
	 <resultMap id="resultZONCampanha" class="java.util.HashMap">
        <result property="codigoPais"             column="COD_PAIS"/>
        <result property="codigoPeriodo"          column="COD_CAMP"/>
        <result property="fechaInicio"            column="FEC_INIC"/>
        <result property="fechaFin"               column="FEC_FINA"/>
		<result property="usuarioCreacion"        column="USU_CREA"/>
		<result property="fechaCreacion"          column="FEC_CREA"/>
		<result property="usuarioModificacion"    column="USU_MODI"/>
		<result property="fechaModificacion"      column="FEC_MODI"/>
		<result property="estadoRegistro"         column="EST_REGI"/>
    </resultMap>
    
	<select id="getZONCampanhaComercial" parameterClass="java.util.Map" resultMap="resultZONCampanha">
			SELECT  
					COD_PAIS,	
					COD_CAMP,	
					IIF(FEC_INIC IS NULL,NULL,right(dtos(FEC_INIC),2) + '/' + substr(dtos(FEC_INIC),5,2) + '/' + left(dtos(FEC_INIC),4)) AS FEC_INIC,
					IIF(FEC_FINA IS NULL,NULL,right(dtos(FEC_FINA),2) + '/' + substr(dtos(FEC_FINA),5,2) + '/' + left(dtos(FEC_FINA),4)) AS FEC_FINA,
					USU_CREA,	
					IIF(FEC_CREA IS NULL,NULL,right(dtos(FEC_CREA),2) + '/' + substr(dtos(FEC_CREA),5,2) + '/' + left(dtos(FEC_CREA),4)) AS FEC_CREA,
					USU_MODI,	
			        IIF(FEC_MODI IS NULL,NULL,right(dtos(FEC_MODI),2) + '/' + substr(dtos(FEC_MODI),5,2) + '/' + left(dtos(FEC_MODI),4)) AS FEC_MODI,
					EST_REGI
			from "$servidorPais$$libEducacion$".DCCAMPA
	</select>	
	
	<resultMap id="resultZONControlFacturacion" class="java.util.HashMap">
        <result property="codigoPais"             column="COD_PAIS"/>
        <result property="codigoPeriodo"          column="CAM_PROC"/>
        <result property="fechaProceso"           column="FEC_PROC"/>
        <result property="estadoPeriodo"          column="EST_CAMP"/>
        <result property="indicadorActividad"     column="IND_ACTI"/>
		<result property="usuarioCreacion"        column="USU_CREA"/>
		<result property="fechaCreacion"          column="FEC_CREA"/>
		<result property="usuarioModificacion"    column="USU_MODI"/>
		<result property="fechaModificacion"      column="FEC_MODI"/>
		<result property="estadoRegistro"         column="EST_REGI"/>
    </resultMap>
    
	<select id="getZONControlFacturacionComercial" parameterClass="java.util.Map" resultMap="resultZONControlFacturacion">
			SELECT  
					COD_PAIS,	
					CAM_PROC,	
					IIF(FEC_PROC IS NULL,NULL,right(dtos(FEC_PROC),2) + '/' + substr(dtos(FEC_PROC),5,2) + '/' + left(dtos(FEC_PROC),4)) AS FEC_PROC,
					EST_CAMP,	
					IND_ACTI,	
					USU_CREA,	
					IIF(FEC_CREA IS NULL,NULL,right(dtos(FEC_CREA),2) + '/' + substr(dtos(FEC_CREA),5,2) + '/' + left(dtos(FEC_CREA),4)) AS FEC_CREA,
					USU_MODI,	
			        IIF(FEC_MODI IS NULL,NULL,right(dtos(FEC_MODI),2) + '/' + substr(dtos(FEC_MODI),5,2) + '/' + left(dtos(FEC_MODI),4)) AS FEC_MODI,
					EST_REGI
			from "$servidorPais$$libEducacion$".DCCTRFAC
	</select>	
	
	<resultMap id="resultZONConsultora" class="java.util.HashMap">
        <result property="codigoPais"             column="COD_PAIS"/>
		<result property="codigoCliente"          column="CODCLIENT"/>
		<result property="apellidoPaterno"        column="APE_PATE"/>
		<result property="apellidoMaterno"        column="APE_MATE"/>
		<result property="nombre1"                column="VAL_NOM1"/>
		<result property="nombre2"                column="VAL_NOM2"/>
		<result property="numeroDocumento"        column="NUM_DOCU"/>
		<result property="telefonoCasa"           column="TELFCASA"/>
		<result property="celular"                column="TELFCELU"/>
		<result property="mail"                   column="DIR_MAIL"/>
		<result property="direccion"              column="DIR_DOMI"/> 	
		<result property="ubigeo"                 column="UBI_DOMI"/> 	
		<result property="direccionEntrega"       column="DIR_ENTR"/> 	
		<result property="ubigeoEntrega"          column="UBI_ENTR"/> 	
		<result property="fechaNacimiento"        column="FEC_NACI"/> 	
		<result property="fechaIngreso"           column="FEC_INGR"/> 	
		<result property="campanhaIngreso"        column="CAM_INGR"/> 	
		<result property="indicadorActivo"        column="IND_ACTI"/> 	
		<result property="usuarioCreacion"        column="USU_CREA"/> 	
		<result property="fechaCreacion"          column="FEC_CREA"/> 	
		<result property="usuarioModificacion"    column="USU_MODI"/> 	
		<result property="fechaModificacion"      column="FEC_MODI"/> 	
		<result property="estadoRegistro"         column="EST_REGI"/> 	
		<result property="codigoCUB"              column="COD_CUB"/>   
		<result property="codigoEmpleado"         column="COD_EMPL"/>   
		
		<result property="codigoTipoCliente"      column="CODTIPCL"/>   
		<result property="codigoSubTipoCliente"   column="CODSTIPC"/>   
		<result property="codigoGrupoFuncional"              column="CODGRPFUN"/>   
		<result property="descripcionGrupoFuncional"         column="DSCGRPFUN"/>   
		<result property="codigoJefeCUB"          column="CODJEFCUB"/>   
		<result property="relacionContractual"    column="VALRELCON"/>   
		<result property="usuarioRed"             column="USURED"/>   
		<result property="nombreJefeDirecto"      column="NOMJEFDIR"/>   
		<result property="puestoOrganizacional"   column="VALPUEORG"/>   
		<result property="mailBelcorp"            column="MAILBELC"/>   
	
    </resultMap>
    
	<select id="getZONConsultoraComercial" parameterClass="java.util.Map" resultMap="resultZONConsultora">
			SELECT  COD_PAIS	,
					CODCLIENT	,
					APE_PATE	,
					APE_MATE	,
					VAL_NOM1	,
					VAL_NOM2	,
					NUM_DOCU	,
					TELFCASA	,
					TELFCELU	,
					DIR_MAIL	,
					DIR_DOMI	,
					UBI_DOMI	,
					DIR_ENTR	,
					UBI_ENTR	,
					IIF(FEC_NACI IS NULL,NULL,right(dtos(FEC_NACI),2) + '/' + substr(dtos(FEC_NACI),5,2) + '/' + left(dtos(FEC_NACI),4)) AS FEC_NACI,
					IIF(FEC_INGR IS NULL,NULL,right(dtos(FEC_INGR),2) + '/' + substr(dtos(FEC_INGR),5,2) + '/' + left(dtos(FEC_INGR),4)) AS FEC_INGR,
					CAM_INGR	,
					IND_ACTI	,
					USU_CREA	,
					IIF(FEC_CREA IS NULL,NULL,right(dtos(FEC_CREA),2) + '/' + substr(dtos(FEC_CREA),5,2) + '/' + left(dtos(FEC_CREA),4)) AS FEC_CREA,
					USU_MODI	,
			        IIF(FEC_MODI IS NULL,NULL,right(dtos(FEC_MODI),2) + '/' + substr(dtos(FEC_MODI),5,2) + '/' + left(dtos(FEC_MODI),4)) AS FEC_MODI,
					EST_REGI	,
					COD_CUB	  ,
					CODTIPCL ,
					CODSTIPC ,
					COD_EMPL  ,
					CODGRPFUN ,
					DSCGRPFUN ,
					CODJEFCUB ,
					VALRELCON ,
					USURED ,
					NOMJEFDIR ,
					VALPUEORG ,
					MAILBELC 
					
			from "$servidorPais$$libEducacion$".DCCLIENT
	</select>	
	
	<delete id="deleteZONRegionesComercial" parameterClass="java.util.Map" >
			DELETE  FROM  "$servidorPais$$libEducacion$".DCREGIO 
	</delete>
	
	<delete id="deleteZONRZonasComercial" parameterClass="java.util.Map" >
			DELETE  FROM  "$servidorPais$$libEducacion$".DCZONA
	</delete>
	
	<delete id="deleteZONHistorialGerentesComercial" parameterClass="java.util.Map" >
			DELETE  FROM  "$servidorPais$$libEducacion$".DCGEREN
	</delete>
	
	<insert id="insertZONRegionesComercial" parameterClass="java.util.Map" >
	  insert into "$servidorPais$$libEducacion$".DCREGIO (
	        COD_PAIS,	
			COD_REGI,	
			DES_REGI,	
			CODCLIENT,	
			IND_ACTI,	
			USU_CREA,	
			FEC_CREA,	
			USU_MODI,	
			FEC_MODI,	
			EST_REGI
	  )
	  values (
	  	#codigoPais#,           
		#codigoRegion#,         
		#descripcionRegion#,    
		#codigoCliente#,    	  
		#indicadorActividad#,   
		#codigoUsuario#,      
		#fecha#,        
		null,  
		null,    
		#estadoRegistro#
	  )
	</insert>	
	
	<insert id="insertZONZonasComercial" parameterClass="java.util.Map" >
	  insert into "$servidorPais$$libEducacion$".DCZONA (
	        COD_PAIS,	
			COD_REGI,	
			COD_ZONA,
			DES_ZONA,	
			CODCLIENT,	
			IND_ACTI,	
			USU_CREA,	
			FEC_CREA,	
			USU_MODI,	
			FEC_MODI,	
			EST_REGI
	  )
	  values (
	 	#codigoPais#,             
		#codigoRegion#,           
		#codigoZona#,             
		#descripcionZona#,        
		#codigoCliente#,     	    
		#indicadorActividad#,     
		#codigoUsuario#,      
		#fecha#,        
		null,  
		null,    
		#estadoRegistro#
	  )
	</insert>	
	
	<insert id="insertZONHistorialGerentesComercial" parameterClass="java.util.Map" >
	  insert into "$servidorPais$$libEducacion$".DCGEREN (
	        COD_PAIS     ,
			COD_HIST,
			UNI_ADMI,
			COD_REGI,
			COD_ZONA,
			COD_CLIE,
			FEC_DESD,
			FEC_HAST,
			CAM_DESD,
			CAM_HAST,
			USU_CREA,
			FEC_CREA,
			USU_MODI,
			FEC_MODI,
			EST_REGI
	  )
	  values (
	 	#codigoPais#,             
		#correlativo#,           
		#codigoUnidadAdmin#,             
		#codigoRegion#,     
		#codigoZona#,  
		#codigoCliente#,     	    
		#fechaDesde#,       
		#fechaHasta#,    
		#periodoDesde#,       
		#periodoHasta#,    
		#codigoUsuario#,      
		#fecha#,        
		null,  
		null,    
		#estadoRegistro#
	  )
	</insert>	
	
	
</sqlMap>
