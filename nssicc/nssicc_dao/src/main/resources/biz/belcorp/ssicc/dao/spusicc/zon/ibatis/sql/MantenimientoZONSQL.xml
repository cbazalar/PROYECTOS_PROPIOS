<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.zon.MantenimientoZONSQL">

   <typeAlias alias="clienteBasico" type="biz.belcorp.ssicc.dao.spusicc.mae.model.Cliente"/>	
   <typeAlias alias="baseCargo" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
   <typeAlias alias="baseGenericoMAE" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
   <typeAlias alias="baseGenericoZON" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
   <typeAlias alias="seccionNoApta" type="biz.belcorp.ssicc.dao.spusicc.zon.model.SeccionNoApta"/>
   <typeAlias alias="zona" type="biz.belcorp.ssicc.dao.scdf.model.Zona"/>
   <typeAlias alias="unidadGeografica" type="biz.belcorp.ssicc.dao.spusicc.zon.model.UnidadGeografica"/>
   <typeAlias alias="estructuraGeopolitica" type="biz.belcorp.ssicc.dao.spusicc.zon.model.EstructuraGeopolitica"/>
   <typeAlias alias="perfilDirectorio" type="biz.belcorp.ssicc.dao.spusicc.zon.model.PerfilDirectorio"/>
   <typeAlias alias="rolDirectorio" type="biz.belcorp.ssicc.dao.spusicc.zon.model.RolDirectorio"/>
   <typeAlias alias="historicoDirectorioVenta" type="biz.belcorp.ssicc.dao.spusicc.zon.model.HistoricoDirectorioVenta"/>
    	
   <resultMap id="baseZonResult" class="baseCargo">
      <result property="codigo" 		column="CODIGO" 	/>
      <result property="descripcion" 	column="DESCRIPCION"/>
   </resultMap>

	<resultMap id="baseResult"          class="baseGenericoMAE">
    	<result property="codigo" 		column="CODIGO" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>
	
	 <resultMap id="tipoCargoResult" class="java.util.HashMap">
	      <result property="codigoCargo" 			    	column="COD_TIPO_CARG" 	/>
	      <result property="descripcion" 					column="DES_TIPO_CARG" 	/>
	      <result property="tipoUnidadAdministrativa" 		column="VAL_TIPO_UNID_ADMI" 	/>
	      <result property="cantidadUnidadAdministrativa" 	column="VAL_CANT_UNID_ADMI" 	/>
	      <result property="titular" 						column="VAL_TITU" 	/>	
	 </resultMap>

	 <resultMap id="tipoCargoFuturasResult" class="java.util.HashMap">
	      <result property="codigoCargo" 			    	column="COD_TIPO_CARG" 	/>
	      <result property="codigoRol" 				    	column="ROL_COD_ROL" 	/>
	      <result property="codigoPerfil" 				    column="PERF_COD_PERF" 	/>
	 </resultMap>

	 <resultMap id="getTipoCargoRolPerfilResult" class="java.util.HashMap">
	 	  <result property="codigoCargo" 			    column="COD_TIPO_CARG"/>
	 	  <result property="descripcionCargo" 			column="DES_TIPO_CARG"/>
	      <result property="rol" 				    	column="ROL"/>
	      <result property="perfil" 				    column="PERFIL"/>
	 </resultMap>

	<resultMap id="estructuraGeopoliticaResult" class="estructuraGeopolitica">
		<result property="oid" 			    	column="OID_ESTR_GEOP"/>
		<result property="codigoOrden" 			column="COD_ORDE"/>
		<result property="indicadorBorrado" 	column="IND_BORR"/>
		<result property="oidPais" 			    column="PAIS_OID_PAIS"/>
		<result property="oidDivisionPolitica" 	column="DIPO_OID_DIVI_POLI"/>
		<result property="fechaActualizacion" 	column="FEC_ACTU"/>
		<result property="descripcion" 			column="DESCRIPCION"/>
    </resultMap>
	         
    <resultMap id="perfilResult" class="perfilDirectorio">
        <result property="codigo" column="COD_PERF"/>
        <result property="descripcion" column="DES_PERF"/>
        <result property="indicadorActivo" column="IND_ACTI"/>
        <result property="auditInfo.createdBy" column="USU_CREA"/>
        <result property="auditInfo.created" column="FEC_CREA"/>
        <result property="auditInfo.updatedBy" column="USU_MODI"/>
        <result property="auditInfo.lastUpdated" column="FEC_MODI"/>
        <result property="estado" column="EST_REGI"/>
	</resultMap>

    <resultMap id="rolResult" class="rolDirectorio">
        <result property="codigo" column="COD_ROL"/>
        <result property="descripcion" column="DES_ROL"/>
        <result property="indicadorActivo" column="IND_ACTI"/>
        <result property="auditInfo.createdBy" column="USU_CREA"/>
        <result property="auditInfo.created" column="FEC_CREA"/>
        <result property="auditInfo.updatedBy" column="USU_MODI"/>
        <result property="auditInfo.lastUpdated" column="FEC_MODI"/>
        <result property="estado" column="EST_REGI"/>
        <result property="codigoTipoUniAdmi" column="VAL_TIPO_UNID_ADMI"/>
	</resultMap>
	
	<resultMap id="detalleDatosClienteMapResult" class="java.util.HashMap">
		<result property="codigoPais" column="COD_PAIS"/>
		<result property="codigoCliente" column="COD_CLIE"/>
		<result property="apellidoPaterno" column="VAL_APE1"/>
		<result property="apellidoMaterno" column="VAL_APE2"/>
		<result property="primerNombre" column="VAL_NOM1"/>
		<result property="segundoNombre" column="VAL_NOM2"/>
		<result property="codigoBelcorp" column="COD_CUB"/>
		<result property="oidTipoDocumentoIdentidad" column="OID_TIPO_DOCU"/>
		<result property="numeroDocumentoIdentidad" column="NUM_DOCU_IDEN"/>
		<result property="fechaNacimiento" column="FEC_NACI"/>
		<result property="codigoRegion" column="COD_REGI"/>
		<result property="codigoZona" column="COD_ZONA"/>
		<result property="numeroCelularEmpresa" column="CEL_EMPR"/>
		<result property="numeroCelularPersonal" column="CEL_PERS"/>
		<result property="direccionDomicilio" column="DIR_DOMI"/>
		<result property="numeroTelefonoCasa" column="TEL_CASA"/>
		<result property="email" column="EMA_CLIE"/>
	</resultMap>
	
	<resultMap id="historicoDirectorioVentaMapResult" class="historicoDirectorioVenta">
		<result property="oid" column="OID_HIST_AUDI"/>
		<result property="codigoPais" column="COD_PAIS"/>
		<result property="codigoCliente" column="COD_CLIE"/>
		<result property="apellidoPaterno" column="VAL_APE1"/>
		<result property="apellidoMaterno" column="VAL_APE2"/>
		<result property="primerNombre" column="VAL_NOM1"/>
		<result property="segundoNombre" column="VAL_NOM2"/>
		<result property="codigoBelcorp" column="COD_CUB"/>
		<result property="oidTipoDocumentoIdentidad" column="TDOC_OID_TIPO_DOCU"/>
		<result property="numeroDocumentoIdentidad" column="NUM_DOCU_IDEN"/>
		<result property="fechaNacimiento" column="FEC_NACI"/>
		<result property="codigoRegion" column="COD_REGI"/>
		<result property="codigoZona" column="COD_ZONA"/>
		<result property="numeroCelularEmpresa" column="NUM_CELU_EMPR"/>
		<result property="numeroCelularPersonal" column="NUM_CELU_PERS"/>
		<result property="direccionDomicilio" column="DIR_DOMI"/>
		<result property="numeroTelefonoCasa" column="NUM_TELE_CASA"/>
		<result property="email" column="EMA_CLIE"/>
		<result property="oidPadre" column="OID_PADR_HIAU"/>
		<result property="auditInfo.ipMaquinaRemota" column="NUM_IPMO"/>
		<result property="auditInfo.created" column="FEC_REGI"/>
		<result property="auditInfo.createdBy" column="USU_REGI"/>
		<result property="auditInfo.lastUpdated" column="FEC_MODI"/>
		<result property="auditInfo.updatedBy" column="USU_MODI"/>
	</resultMap>
	
     <select id="getTipoCargo"  parameterClass="java.util.Map" resultMap="tipoCargoResult">
					SELECT 
						X.COD_TIPO_CARG,
						X.DES_TIPO_CARG,
						X.VAL_TIPO_UNID_ADMI,
						X.VAL_CANT_UNID_ADMI,
						X.VAL_TITU						
					FROM ZON_TIPO_CARGO X 
					<dynamic prepend="WHERE">
						<isNotEmpty prepend="AND" property="codigoCargo">
					 		X.COD_TIPO_CARG=#codigoCargo#
						</isNotEmpty>						 
						<isNotEmpty prepend="AND" property="descripcion">
					 		UPPER(X.DES_TIPO_CARG) LIKE UPPER('%$descripcion$%')
						</isNotEmpty>	
						<isNotEmpty prepend="AND" property="tipoUnidadAdministrativa">
							X.VAL_TIPO_UNID_ADMI=#tipoUnidadAdministrativa#
						</isNotEmpty>
					    <isNotEmpty prepend="AND" property="cantidadUnidadAdministrativa">
							X.VAL_CANT_UNID_ADMI=#cantidadUnidadAdministrativa#
						</isNotEmpty>							
						<isNotEmpty prepend="AND" property="titular">
							X.VAL_TITU=#titular#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="estado">
							X.EST_REGI = #estado#
						</isNotEmpty>
						 <isNotEmpty prepend="AND" property="indCargoNoFuturo">
						    X.COD_TIPO_CARG_BASE IS NULL
						 </isNotEmpty>
						 <isNotEmpty prepend="AND" property="indCargoFuturo">
						    X.COD_TIPO_CARG_BASE IS NOT NULL
						 </isNotEmpty>
					</dynamic>
					order by X.DES_TIPO_CARG
	</select>  
 		
	<select id="getTipoCargoFuturas" parameterClass="java.util.Map" resultMap="tipoCargoFuturasResult">
		select ztc.cod_tipo_carg, ztc.rol_cod_rol, ztc.perf_cod_perf 
		from zon_tipo_cargo ztc
		WHERE ztc.rol_cod_rol in ('GZ','GR')
			and ztc.perf_cod_perf = 'TI'
			and ztc.est_regi = 1
			and cod_tipo_carg = #codigoCargo#
	</select>
 		
	<select id="getTipoCargoRolPerfil" parameterClass="java.util.Map" resultMap="getTipoCargoRolPerfilResult">
		select ztc.cod_tipo_carg, 
		       ztc.des_tipo_carg, 
		       ztc.rol_cod_rol||'-'||r.des_rol ROL, 
		       ztc.perf_cod_perf||'-'||p.des_perf PERFIL 
		from zon_tipo_cargo ztc,zon_direc_rol r, zon_direc_perfi p 
		WHERE  ztc.perf_cod_perf = p.cod_perf
			and ztc.rol_cod_rol = r.cod_rol
      		and ztc.est_regi = 1
			and cod_tipo_carg = #codigoCargo#
	</select>
 		
    <delete id="deleteCargo" parameterClass="java.util.Map">
		DELETE FROM  ZON_TIPO_CARGO
		WHERE  COD_TIPO_CARG  = #codigoCargo#
    </delete>
	
	<delete id="deleteLicenciaCab" parameterClass="java.util.Map">
		DELETE FROM ZON_DIREC_VENTA_CABEC 
		WHERE  COD_CLIE = #codigoCliente#
		AND TIOP_COD_TIPO_OPER=#codigoOperacion#
		AND TICA_COD_TIPO_CARG=#codigoCargo#
		AND FEC_REGI=#fechaOperacion#
	</delete>	
	
	<delete id="deleteLicenciaDet" parameterClass="java.util.Map">	
		DELETE FROM ZON_DIREC_VENTA_DETAL 
		WHERE  COD_CLIE = #codigoCliente#
		AND TIOP_COD_TIPO_OPER=#codigoOperacion#
		AND TICA_COD_TIPO_CARG=#codigoCargo#
		AND DICA_FEC_REGI=#fechaOperacion#
    </delete>
	
	
	
	<resultMap id="descripcionCargoResult" class="java.util.HashMap">
	      <result property="descripcion" 			    	column="DES_TIPO_CARG" 	/>
	</resultMap>	  
	
	<select id="getDescripcionCargo"  parameterClass="java.util.Map" resultMap="descripcionCargoResult">
		SELECT DES_TIPO_CARG FROM ZON_TIPO_CARGO
		WHERE  COD_TIPO_CARG  = #codigoCargo#
	</select>	
    	  

	 <resultMap id="directorioVentasResult" class="java.util.HashMap">
	      <result property="codigoCliente" 			    	column="COD_CLIE" 	/>
	      <result property="nombreCliente" 			    	column="NOM_CLIE" 	/>
	      <result property="codigoCargo" 					column="COD_CARG" 	/>
	      <result property="nombreCargo" 					column="NOM_CARG" 	/>
	      <result property="fechaOperacion" 				column="FEC_OPER" 	/>
	      <result property="codigoOperacion" 				column="COD_DIRE_OPER" 	/>
	      <result property="nombreOperacion" 				column="NOM_DIRE_OPER" 	/>
	      <result property="codigoEstatusCargo" 			column="COD_ESTA_CARG" 	/>
	      <result property="motivo" 						column="COD_MOTI_LICE" 	/>
	      <result property="nombreMotivo" 					column="NOM_MOTI_LICE" 	/>
	      <result property="codigoReemplazo" 				column="COD_REEM" 	/>
	      <result property="nombreReemplazo" 				column="NOM_REEM" 	/>
	      <result property="fechaRegreso" 					column="FEC_REGR" 	/>
	      <result property="telefonoFijo" 					column="TEL_FIJO" 	/>
	      <result property="telefonoCelular" 				column="TEL_CELE" 	/>
	      <result property="mail"		 					column="VAL_MAIL" 	/>
	      <result property="domicilio"		 			    column="VAL_DOMI" 	/>
	      <result property="direccionEntregaMaterial"		column="VAL_DOMI_ENTR" 	/>
	      <result property="fechaCumpleanhos"		 	    column="FEC_NACI" 	/>
	      <result property="documentoIdentidad"		 	    column="NUM_DOCU_IDEN" 	/>
	      <result property="tipoCutis"		 			    column="TIP_CUTI" 	/>	      
	 </resultMap>

     <select id="getDirectorioVentas"  parameterClass="java.util.Map" resultMap="directorioVentasResult">
					SELECT 
						X.COD_CLIE,
						GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(X.COD_CLIE, 'NOM_CLIE') NOM_CLIE,
						X.TICA_COD_TIPO_CARG COD_CARG,
						( SELECT Z.DES_TIPO_CARG
						  FROM ZON_TIPO_CARGO Z						  
						  WHERE Z.COD_TIPO_CARG =  X.TICA_COD_TIPO_CARG
						 )NOM_CARG,
						TO_CHAR(X.FEC_REGI,'dd/MM/yyyy') FEC_OPER,
						X.TIOP_COD_TIPO_OPER COD_DIRE_OPER,
						(SELECT Z.DES_TIPO_OPER
						 FROM ZON_TIPO_OPERA Z
						 WHERE Z.COD_TIPO_OPER = X.TIOP_COD_TIPO_OPER 
						)NOM_DIRE_OPER,
						X.ESCA_COD_ESTA_CARG COD_ESTA_CARG,
						X.MOTI_COD_MOTI_LICE COD_MOTI_LICE,
						(SELECT M.DES_MOTI_LICE
				          FROM ZON_MOTIV_LICEN M
				           WHERE M.COD_MOTI_LICE= X.MOTI_COD_MOTI_LICE) NOM_MOTI_LICE,
						X.COD_CLIE_REEM COD_REEM,
						GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(X.COD_CLIE_REEM, 'NOM_CLIE') NOM_REEM,
						TO_CHAR(X.FEC_REGR,'dd/MM/yyyy') FEC_REGR,
						GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(X.COD_CLIE),'TF') TEL_FIJO,
						GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(X.COD_CLIE),'TM') TEL_CELE,
						GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(X.COD_CLIE),'ML') VAL_MAIL,
						(  SELECT (NVL(TRIM(D.DES_ABRV_TIPO_VIA),' ') ||' '|| 
					        NVL(TRIM(A.VAL_NOMB_VIA),' ') ) ||' '||
					        TRIM(A.NUM_PPAL)||' '||
					        TRIM(A.VAL_OBSE)
								 FROM ZON_VIA C,
								 SEG_TIPO_VIA D,
								 MAE_CLIEN_DIREC A,
								 MAE_TIPO_DIREC B
								 WHERE  A.clie_oid_clie = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(X.COD_CLIE)
									 AND C.OID_VIA = A.TIVI_OID_TIPO_VIA
									 AND D.OID_TIPO_VIA = A.TIVI_OID_TIPO_VIA
									 AND B.OID_TIPO_DIRE = A.TIDC_OID_TIPO_DIRE
									 AND B.COD_TIPO_DIRE = '01'
									 AND IND_ELIM = 0) VAL_DOMI,
						(  SELECT (NVL(TRIM(D.DES_ABRV_TIPO_VIA),' ') ||' '|| 
					        NVL(TRIM(A.VAL_NOMB_VIA),' ') ) ||' '||
					        TRIM(A.NUM_PPAL)||' '||
					        TRIM(A.VAL_OBSE)
								 FROM ZON_VIA C,
								 SEG_TIPO_VIA D,
								 MAE_CLIEN_DIREC A,
								 MAE_TIPO_DIREC B
								 WHERE  A.clie_oid_clie = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(X.COD_CLIE)
									 AND C.OID_VIA = A.TIVI_OID_TIPO_VIA
									 AND D.OID_TIPO_VIA = A.TIVI_OID_TIPO_VIA
									 AND B.OID_TIPO_DIRE = A.TIDC_OID_TIPO_DIRE
									 AND B.COD_TIPO_DIRE = '07'
									 AND IND_ELIM = 0) VAL_DOMI_ENTR,
						( SELECT TO_CHAR(FEC_NACI,'dd/MM/yyyy')
 						  FROM MAE_CLIEN_DATOS_ADICI
 						  WHERE CLIE_OID_CLIE=GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(X.COD_CLIE)) FEC_NACI,		
 						 (SELECT NUM_DOCU_IDEN
  			  			  FROM MAE_CLIEN_IDENT
  			  				WHERE CLIE_OID_CLIE=GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(X.COD_CLIE) 
   							AND VAL_IDEN_DOCU_PRIN=1) NUM_DOCU_IDEN, 	 						
						'' TIP_CUTI						
					FROM ZON_DIREC_VENTA_CABEC X 
					WHERE 
					<![CDATA[
						X.IND_ESTA<>'R'
										]]>		
						<isNotEmpty prepend="AND" property="codigoCliente">
					 		X.COD_CLIE=#codigoCliente#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="codigoCargo">
					 		X.TICA_COD_TIPO_CARG=#codigoCargo#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="fechaOperacion">
					 		TRUNC(X.FEC_REGI)=TO_DATE(#fechaOperacion#,'dd/MM/yyyy')
						</isNotEmpty>																		 
						<isNotEmpty prepend="AND" property="codigoOperacion">
							X.TIOP_COD_TIPO_OPER=#codigoOperacion#
						</isNotEmpty>
					    <isNotEmpty prepend="AND" property="codigoEstatusCargo">
							X.ESCA_COD_ESTA_CARG=#codigoEstatusCargo#
						</isNotEmpty>							
						<isNotEmpty prepend="AND" property="motivo">
							X.MOTI_COD_MOTI_LICE=#motivo#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="codigoReemplazo">
							X.COD_CLIE_REEM=#codigoReemplazo#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="fechaRegreso">
							TRUNC(X.FEC_REGR)=TO_DATE(#fechaRegreso#,'dd/MM/yyyy')
						</isNotEmpty>					
					
					ORDER BY FEC_OPER DESC
	</select>
	
	<insert id="insertCargo" parameterClass="java.util.Map">
		INSERT INTO ZON_TIPO_CARGO (
		   COD_TIPO_CARG, 
		   DES_TIPO_CARG, 
		   VAL_TIPO_UNID_ADMI, 
		   VAL_CANT_UNID_ADMI, 
		   VAL_TITU, 
		   USU_CREA, 
		   FEC_CREA,
		   EST_REGI,
		   ROL_COD_ROL,
		   PERF_COD_PERF,
		   IND_ADMI,
		   COD_TIPO_CARG_BASE) 
		VALUES (  #codigoCargo#,
				 #descripcion#,
				 #tipoUnidadAdministrativa#,
				 #cantidadUnidadAdministrativa#,
				 #titular#,
				 #login#,				 				 				 				 				 
		   		 SYSDATE,
		   		 '1',
		   		 #codigoRol#,
		   		 #codigoPerfil#,
		   		 #indicadorAdmin#,
		   		 #codigoCargoBase#)
    </insert>
    
    
     <update id="updateDireccionCliente" parameterClass="java.util.Map">
		UPDATE MAE_CLIEN_DIREC
		SET    VAL_NOMB_VIA = #descripcionVia#,
		       FEC_ULTI_ACTU = SYSDATE
		WHERE  ZCAL_COR_ZCAL = to_number(#correVia#)
		       AND TIVI_OID_TIPO_VIA  = to_number(#tipoVia#)
		       AND COD_UNID_GEOG = #codigoUnidadGeo#
		
    </update>	
    
       <update id="updateCargo" parameterClass="java.util.Map">
		UPDATE ZON_TIPO_CARGO
		SET    DES_TIPO_CARG      = #descripcion#,
		       VAL_TIPO_UNID_ADMI = #tipoUnidadAdministrativa#,
		       VAL_CANT_UNID_ADMI = #cantidadUnidadAdministrativa#,
		       VAL_TITU           = #titular#,
		       USU_MODI           = #login#,
		   	   ROL_COD_ROL 		  = #codigoRol#,
		   	   PERF_COD_PERF 	  = #codigoPerfil#,
		       FEC_MODI			  = SYSDATE,
		       IND_ADMI			  = #indicadorAdmin#,
		       COD_TIPO_CARG_BASE = #codigoCargoBase#
		       <isNotEmpty property="estado" >
		       , EST_REGI 		  = #estado#
		       </isNotEmpty>
		WHERE  COD_TIPO_CARG      = #codigoCargo#
		
    </update>	
    
     <parameterMap id="paramExecuteValidacionDirectorio" class="map">
		<parameter property="codigoPais" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargo" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoClienteBuscar" 	jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaIngreso" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegion" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoZona" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="usuario" 				jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fila"                  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="mensajeError" 			jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<procedure id="executeValidacionDirectorio" parameterMap="paramExecuteValidacionDirectorio">
		{call zon_pkg_unida_admin.ZON_PR_VALID_INGRE_DIREC(?, ?, ?, ?, ?, ?, ?, ? ,?) }
	</procedure>


	 <resultMap id="directorioVentasDetalleResult" class="java.util.HashMap">
	 	  <result property="oid" 			    			column="OID_DIREC_VENTA_DETAL" 	/>
	      <result property="codigoCliente" 			    	column="COD_CLIE" 	/>
	      <result property="nombreCliente" 			    	column="NOM_CLIE" 	/>
	      <result property="codigoCargo" 					column="COD_CARG" 	/>
	      <result property="fechaOperacion" 				column="FEC_OPER" 	/>
	      <result property="codigoOperacion" 				column="COD_DIRE_OPER" 	/>
	      <result property="codigoSubGerencia" 				column="COD_SUBG" 	/>
	      <result property="codigoRegion" 					column="COD_REGI" 	/>
	      <result property="codigoZona" 					column="COD_ZONA" 	/>
		  <result property="codigoRegion2" 					column="COD_REGI2" 	/>
	      <result property="nombreCargo" 					column="DES_TIPO_CARG" 	/>
	      <result property="nombreOperacion" 				column="DES_DIRE_OPER" 	/>
	      <result property="codigoEstatusCargo" 			column="COD_ESTA_CARG" 	/>
	      <result property="codigoLicencia" 				column="COD_MOTI_LICE" 	/>
	      <result property="nombreLicencia" 				column="DES_MOTI_LICE" 	/>
	      <result property="fechaSalida" 				    column="FEC_SALI_LICE" 	/>
	      <result property="codigoReemplazo" 				column="COD_CLIE_REEM" 	/>
	      <result property="nombreReemplazo" 				column="NOM_CLIE_REEM" 	/>	
	 </resultMap>

     <select id="getDirectorioVentasDetalle"  parameterClass="java.util.Map" resultMap="directorioVentasDetalleResult">
					SELECT 
						X.COR_DIVE_DETA OID_DIREC_VENTA_DETAL,
						X.COD_CLIE,

				       	<isEqual property="codigoConexionExterna" compareValue="FOX">
				       (SELECT mc.APE_PATE||' '||mc.APE_MATE||' '||MC.VAL_NOM1||' '||MC.VAL_NOM2
						FROM ZON_DIREC_CLIEN mc
						WHERE mc.pais_cod_pais = Y.pais_cod_pais 
						AND mc.cod_clie = Y.cod_clie) NOM_CLIE,
				       	</isEqual>
				       	
						<isNotEqual property="codigoConexionExterna" compareValue="FOX">
						GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(X.COD_CLIE, 'NOM_CLIE') NOM_CLIE,
						</isNotEqual>	
												
						X.TICA_COD_TIPO_CARG COD_CARG,
						TO_CHAR(X.DICA_FEC_REGI,'dd/MM/yyyy') FEC_OPER,
						X.TIOP_COD_TIPO_OPER COD_DIRE_OPER,
						X.COD_SUBG,					
						
						<isEqual property="codigoConexionExterna" compareValue="FOX">
						(SELECT R.COD_REGI||' '||R.DES_REGI 
						FROM ZON_DIREC_REGIO R 
						WHERE R.PAIS_COD_PAIS = X.pais_cod_pais 
						AND R.COD_REGI = X.cod_regi) COD_REGI,
						</isEqual>
						
						<isNotEqual property="codigoConexionExterna" compareValue="FOX">
						(SELECT O.COD_REGI||' '||O.DES_REGI FROM ZON_REGIO O WHERE O.COD_REGI=X.COD_REGI) AS COD_REGI,
						</isNotEqual>
						
						X.COD_ZONA,
						X.COD_REGI AS COD_REGI2,
						(SELECT A.DES_TIPO_CARG
				          FROM ZON_TIPO_CARGO A
				          WHERE A.COD_TIPO_CARG=x.TICA_COD_TIPO_CARG) DES_TIPO_CARG,
			           (SELECT B.DES_TIPO_OPER
				          FROM  ZON_TIPO_OPERA B
				          WHERE B.COD_TIPO_OPER = x.TIOP_COD_TIPO_OPER) DES_DIRE_OPER,
				         Y.ESCA_COD_ESTA_CARG COD_ESTA_CARG,
				         Y.MOTI_COD_MOTI_LICE COD_MOTI_LICE,
				         (SELECT M.DES_MOTI_LICE
				          FROM ZON_MOTIV_LICEN M
				           WHERE M.COD_MOTI_LICE= Y.MOTI_COD_MOTI_LICE) DES_MOTI_LICE,
				         TO_CHAR(Y.FEC_REGI,'dd/MM/yyyy') FEC_SALI_LICE,	
				         Y.COD_CLIE_REEM COD_CLIE_REEM,
				         GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(Y.COD_CLIE_REEM, 'NOM_CLIE') NOM_CLIE_REEM 					
					FROM ZON_DIREC_VENTA_DETAL X ,
					     ZON_DIREC_VENTA_CABEC Y
					WHERE X.DICA_COR_DIRE_VENT = Y.COR_DIRE_VENT
						AND X.PAIS_COD_PAIS = Y.PAIS_COD_PAIS
						AND X.COD_CLIE= Y.COD_CLIE
					    AND X.TICA_COD_TIPO_CARG= Y.TICA_COD_TIPO_CARG
					    AND X.DICA_FEC_REGI = Y.FEC_REGI
					    AND X.TIOP_COD_TIPO_OPER = Y.TIOP_COD_TIPO_OPER
					    AND X.PAIS_COD_PAIS = #codigoPais#
						<isNotEmpty prepend="AND" property="codigoCliente">
					 		X.COD_CLIE=#codigoCliente#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="codigoCargo">
					 		X.TICA_COD_TIPO_CARG=#codigoCargo#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="fechaOperacion">
					 		TRUNC(X.DICA_FEC_REGI)=TO_DATE(#fechaOperacion#,'dd/MM/yyyy')
						</isNotEmpty>																		 
						<isNotEmpty prepend="AND" property="codigoOperacion">
							X.TIOP_COD_TIPO_OPER=#codigoOperacion#
						</isNotEmpty>
					    <isNotEmpty prepend="AND" property="codigoSubGerencia">
							X.COD_SUBG=#codigoSubGerencia#
						</isNotEmpty>							
						<isNotEmpty prepend="AND" property="codigoRegion">
							X.COD_REGI=#codigoRegion#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="codigoZona">
							X.COD_ZONA=#codigoZona#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="estadoRegistro">
							Y.IND_ESTA=#estadoRegistro#
						</isNotEmpty>
						<isNotEmpty prepend="AND" property="estatusCargo">
							Y.ESCA_COD_ESTA_CARG=#estatusCargo#
						</isNotEmpty>										
						
				       <isNotEmpty property="codigoRegionArray">	
					   		<iterate prepend="AND" property="codigoRegionArray" open=" X.COD_REGI IN (" close=")" conjunction=",">
			        	 		#codigoRegionArray[]#
			        		</iterate>    
					  </isNotEmpty>

				       <isNotEmpty property="codigoZonaArray">	
					   		<iterate prepend="AND" property="codigoZonaArray" open=" X.COD_ZONA IN (" close=")" conjunction=",">
			        	 		#codigoZonaArray[]#
			        		</iterate>    
					  </isNotEmpty>
						
					ORDER BY COD_REGI ASC
	</select>

     <parameterMap id="paramExecuteValidacionDirectorioNombramiento" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoClienteBuscar" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaNombramiento" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegion" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoZona" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="usuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fila"    jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="mensajeError" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
     <procedure id="executeValidacionDirectorioNombramiento" parameterMap="paramExecuteValidacionDirectorioNombramiento">
		{call zon_pkg_unida_admin.ZON_PR_VALID_NOMBR_DIREC(?, ?, ?, ?, ?, ?, ? , ? ,?) }
	</procedure>

	 <resultMap id="responsableRegionZonaResult" class="java.util.HashMap">
	      <result property="codigoCliente" 			    	column="GERE" 	/>
	      <result property="nombreCliente" 					column="NOM_CLIE" 	/>
	 </resultMap>
	
	 <select id="getResponsableRegionZona" parameterClass="java.util.Map" resultMap="responsableRegionZonaResult">
		SELECT  GER.GERE ,
		        GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(ger.gere, 'NOM_CLIE') NOM_CLIE
         FROM ZON_HISTO_GEREN ger, SEG_MARCA mar, 
         	  SEG_CANAL can, SEG_PAIS pai
        WHERE ger.PAIS_OID_PAIS = pai.OID_PAIS
          AND ger.MARC_OID_MARC = mar.OID_MARC
          AND ger.CANA_OID_CANA = can.OID_CANA
          AND pai.COD_PAIS = #codigoPais#
          AND mar.COD_MARC = #codigoMarca#
          AND can.COD_CANA = #codigoCanal#
          AND UA = #unidadAdministrativa#
          AND ger.FEC_HAST IS NULL
		  AND
		  ROWNUM=1
		  ORDER BY FEC_DESD DESC
	</select>
	
     <select id="getSubgerenciaRegion" parameterClass="java.util.Map" resultClass="string">
          SELECT COD_SUBG_VENT ||B.COD_REGI 
          FROM ZON_REGIO B,ZON_SUB_GEREN_VENTA C
          WHERE C.OID_SUBG_VENT = B.ZSGV_OID_SUBG_VENT
            AND B.COD_REGI=#codigoRegion#
	</select>
	
	 <select id="getSubgerenciaZona" parameterClass="java.util.Map" resultClass="string">
              SELECT COD_SUBG_VENT ||B.COD_REGI||A.COD_ZONA
              FROM ZON_ZONA A, 
                   ZON_REGIO B,
                   ZON_SUB_GEREN_VENTA C
              WHERE A.ZORG_OID_REGI = B.OID_REGI
                AND C.OID_SUBG_VENT = B.ZSGV_OID_SUBG_VENT
                AND A.COD_ZONA=#codigoZona#
	</select>
	
	 <parameterMap id="paramExecuteRotacionDirectorio" class="map">
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargo"               jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCliente"             jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaRotacion"             jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegionAnterior"      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegionNuevo"         jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoZonaAnterior"        jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoZonaNuevo"           jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="usuario"                   jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fila"                      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="mensajeError"              jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
     <procedure id="executeRotacionDirectorio" parameterMap="paramExecuteRotacionDirectorio">
		{call zon_pkg_unida_admin.ZON_PR_ROTAC_PERSO_DIREC(?, ?, ?, ?, ?, ?, ?,?,?,?,?) }
	</procedure>
	     
     <select id="getMotivoLicencia"  parameterClass="java.util.Map" resultMap="baseZonResult">
					SELECT 
						X.COD_MOTI_LICE CODIGO,
						X.DES_MOTI_LICE DESCRIPCION					
					FROM ZON_MOTIV_LICEN X 
					<dynamic prepend="WHERE">
						<isNotEmpty prepend="AND" property="codigoLicencia">
					 		X.COD_MOTI_LICE=#codigoCargo#
						</isNotEmpty>						 
						<isNotEmpty prepend="AND" property="descripcionLicencia">
					 		UPPER(X.DES_MOTI_LICE) LIKE UPPER('%$descripcion$%')
						</isNotEmpty>	
					</dynamic>
	</select>  
	
	  <parameterMap id="paramExecuteValidacionLicencia" class="map">
		<parameter property="codigoPais"              		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargo"             		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoLicencia"           		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoMotivoLicencia"     		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoClienteBuscar"     		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoClienteBuscarReemplazo"  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargoReemplazo"  		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoRegionReemplazado" 		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoZonaReemplazado" 		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegionReemplazo" 		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoZonaReemplazo" 		 	jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaSalida" 		      		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaRegreso" 		      		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="usuario"                 		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fila"                    		jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="mensajeError"            		jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
     <procedure id="executeLicenciaPersona" parameterMap="paramExecuteValidacionLicencia">
		{call zon_pkg_unida_admin.ZON_PR_LICEN_DIREC(?, ?, ?, ?, ?, ?,?, ?, ?, ? , ? , ? ,? ,?,?,?) }
	</procedure>
	
	
     <procedure id="executeReactivacionLicenciaPersona" parameterMap="paramExecuteValidacionLicencia">
		{call zon_pkg_unida_admin.ZON_PR_REACT_LICEN_DIREC(?, ?, ?, ?,?, ?, ?, ?,?,?,?,?,?) }
	</procedure>

	  <parameterMap id="paramExecuteRetiroDirectorio" class="map">
		<parameter property="codigoPais"              jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargo"             jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoClienteBuscar"     jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoRegion" 			  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoZona" 			  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />				
		<parameter property="fechaRetiro" 		      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="usuario"                 jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fila"                   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="mensajeError"            jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	  <procedure id="executeRetiroDirectorio" parameterMap="paramExecuteRetiroDirectorio">
		{call zon_pkg_unida_admin.ZON_PR_RETIR_DIREC(?, ?, ?, ?, ?, ?, ?,?, ?) }
	</procedure>
	
	     <select id="getOperaciones"  parameterClass="java.util.Map" resultMap="baseZonResult">
					SELECT 
						X.COD_TIPO_OPER CODIGO,
						X.DES_TIPO_OPER DESCRIPCION					
					FROM ZON_TIPO_OPERA X 
					<dynamic prepend="WHERE">
						<isNotEmpty prepend="AND" property="codigoOperacion">
					 		X.COD_TIPO_OPER=#codigoOperacion#
						</isNotEmpty>						 
						<isNotEmpty prepend="AND" property="descripcionOperacion">
					 		UPPER(X.DES_TIPO_OPER) LIKE UPPER('%$descripcionOperacion$%')
						</isNotEmpty>	
					</dynamic>
	</select>  
	
	<resultMap id="getParametrosRutasListResult" class="java.util.HashMap">	    
		<result property="codigoPais" 			     column="cod_pais"/>
		<result property="codigoNovedad" 			 column="cod_dire_oper"/>
		<result property="descripcionNovedad" 		 column="des_dire_oper"/>
		<result property="correoUsuarioAprobador" 	 column="val_emai_usua_apro"/>
		<result property="correosDestinatarios" 	 column="val_emai_list_dest"/>		
		<result property="asunto" 					 column="val_asun"/>
		<result property="mensaje" 					 column="val_mens"/>
		<result property="emailOrigen" 				 column="val_emai_orig"/>
		<result property="indicadorDesactivarEnvio"  column="ind_desa_envi"/>
	</resultMap>
	
	<select id="getParametrosRutasList" parameterClass="java.util.Map" resultMap="getParametrosRutasListResult">
		select a.pais_cod_pais cod_pais,
		       a.tiop_cod_tipo_oper cod_dire_oper,
		       b.DES_TIPO_OPER des_dire_oper,
		       a.val_emai_usua_apro,
		       a.val_emai_list_dest,
		       a.val_asun,
           	   a.val_mens,
               a.val_emai_orig,
               a.ind_desa_envi		       
		  from zon_direc_param_rutas a,
		       ZON_TIPO_OPERA b 
		 where a.tiop_cod_tipo_oper = b.COD_TIPO_OPER
		   <isNotEmpty prepend="AND" property="codigoPais"> 
		       a.pais_cod_pais = #codigoPais#
		   </isNotEmpty>    
		   <isNotEmpty prepend="AND" property="codigoNovedad">
		       a.tiop_cod_tipo_oper = #codigoNovedad#
		   </isNotEmpty>		   
		   and a.est_regi = 1
	</select>
	
	<delete id="deleteParametroRuta" parameterClass="java.util.Map">
		 delete zon_direc_param_rutas		   
		 where pais_cod_pais = #codigoPais#
		 AND tiop_cod_tipo_oper = #codigoNovedad#
    </delete>			   
		
	<update id="updateParametroRutaDirectorio" parameterClass="java.util.Map">
		update zon_direc_param_rutas
		   set tiop_cod_tipo_oper = #codigoNovedad#,
		       val_emai_usua_apro = #emailAprobador#,
		       val_emai_list_dest = #emailDestinatarios#,
		       val_asun = #asunto#,
		       val_mens = #mensaje#,
		       val_emai_orig = #emailOrigen#,
		       ind_desa_envi = #indicadorDesactivaEnvio#,
		       usu_modi = #codigoUsuario#,
		       fec_modi = SYSDATE
		 where pais_cod_pais = #codigoPais#
		 AND tiop_cod_tipo_oper = #codigoNovedad#		 
    </update>
	
	<update id="updateParametroRutaEnvioCorreo" parameterClass="java.util.Map">
		update zon_direc_param_rutas a
		   set a.ind_acti_envi_dest = 0
		 where a.tiop_cod_tipo_oper = #tipoOperacion#
		   and a.pais_cod_pais = #codigoPais#
		   and a.ind_acti_envi_dest = 1	
	</update>	
    
    <insert id="insertParametroRutaDirectorio" parameterClass="java.util.Map">
    	insert into zon_direc_param_rutas
			  (pais_cod_pais,
			   tiop_cod_tipo_oper,
			   val_emai_usua_apro,
			   val_emai_list_dest,
			   val_asun,
			   val_mens,
			   val_emai_orig,
			   ind_desa_envi,
			   IND_ACTI_ENVI_DEST,
			   usu_crea,
			   fec_crea,
			   est_regi)
			values
			  (#codigoPais#,
			   #codigoNovedad#,
			   #emailAprobador#,
			   #emailDestinatarios#,
			   #asunto#,
			   #mensaje#,
			   #emailOrigen#,
			   #indicadorDesactivaEnvio#,
			   '0',
			   #codigoUsuario#,
			   SYSDATE,
			   '1')
	</insert>
	
	<resultMap id="licenciasActivasResult" class="java.util.HashMap">
	      <result property="codigoLicencia" 			    	column="COD_MOTI_LICE" 	/>
	      <result property="descripcionLicencia" 			    column="DES_MOTI_LICE" 	/>
		  <result property="cantidad" 			                column="CANTIDAD" 	/>
	 </resultMap>

     <select id="getLicenciasActivas"  parameterClass="java.util.Map" resultMap="licenciasActivasResult">
					SELECT b.cod_moti_lice as COD_MOTI_LICE,
					       b.des_moti_lice as DES_MOTI_LICE,
					       count(a.MOTI_COD_MOTI_LICE) as CANTIDAD
					  FROM zon_direc_venta_cabec a, zon_motiv_licen b
					 WHERE a.MOTI_COD_MOTI_LICE = b.cod_moti_lice
					   and a.TIOP_COD_TIPO_OPER = 'LI'
					   and a.ESCA_COD_ESTA_CARG = 'IT'
					   and a.IND_ESTA = 'A'
					    and a.FEC_REGR between (select fec_proc
					                             from bas_ctrl_fact
					                            where cod_peri = #periodoActivo#
					                              AND cod_pais = #codigoPais#)+1
					   and #fechaProceso#
					 GROUP BY a.MOTI_COD_MOTI_LICE, b.cod_moti_lice, b.des_moti_lice				
	</select>
	
	<parameterMap id="paramReactivacionLicencia" class="map">
		<parameter property="codigoPais"              jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaProceso" 			  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoUsuario" 	      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
	
	<procedure id="executeReactivacionLicencia" parameterMap="paramReactivacionLicencia">
		{call zon_pkg_unida_admin.zon_pr_react_licen_direc(?, ?, ?) }
	</procedure>
	
	<procedure id="executeReactivacionLicenciaFOX" parameterMap="paramReactivacionLicencia">
		{call zon_pkg_unida_admin.zon_pr_react_licen_direc_fox(?, ?, ?) }
	</procedure>
	
	<!-- OBTIENE LISTA DE CLIENTES QUE CUMPLAN CON EL FILTRO DE BUSQUEDA -->
    <select id="getClientesByCriteria" parameterClass="java.util.Map" resultClass="clienteBasico">
		SELECT codigo, 
		       nombre1, 
			   nombre2, 
			   apellido1, 
			   apellido2, 
			   OID			   
		  FROM  (SELECT ROWNUM, codigo, nombre1, nombre2, apellido1, apellido2, OID
		          FROM (SELECT DISTINCT c.cod_clie codigo, 
		          						c.val_nom1 nombre1,
		                                c.val_nom2 nombre2, 
		                                c.val_ape1 apellido1,
		                                c.val_ape2 apellido2, 
		                                c.oid_clie OID										
									FROM ZON_TIPO_CARGO t,
										 MAE_CLIEN c, 
										 MAE_CLIEN_IDENT i,
                     				     ZON_DIREC_VENTA_CABEC a,ZON_DIREC_VENTA_DETAL d
									WHERE a.cor_dire_vent = d.dica_cor_dire_vent
									  AND c.PAIS_OID_PAIS = #oidPais#
									  AND i.CLIE_OID_CLIE = c.OID_CLIE
                    				  AND a.Cod_Clie=c.COD_CLIE
									  AND a.TICA_COD_TIPO_CARG=t.Cod_Tipo_Carg
									  AND t.val_titu=1
									  AND a.TICA_COD_TIPO_CARG=d.TICA_COD_TIPO_CARG
									  AND a.COD_CLIE=d.COD_CLIE
							      	  AND a.FEC_REGI=d.DICA_FEC_REGI
							      	  AND a.TIOP_COD_TIPO_OPER=d.TIOP_COD_TIPO_OPER
							      	  AND a.TICA_COD_TIPO_CARG=d.TICA_COD_TIPO_CARG									  
									  AND a.ESCA_COD_ESTA_CARG='A'							  								 
									  <![CDATA[
										AND a.TIOP_COD_TIPO_OPER <> 'RZ'
										]]>									  
									  AND a.IND_ESTA='A'									
									  <isNotEmpty prepend="AND" property="codigoCliente">        
										c.COD_CLIE LIKE #codigoCliente#
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre1">        
										UPPER(c.VAL_NOM1) LIKE UPPER(#nombre1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre2">        
										UPPER(c.VAL_NOM2) LIKE UPPER(#nombre2#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido1">        
										UPPER(c.VAL_APE1) LIKE UPPER(#apellido1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido2">        
										UPPER(c.VAL_APE2) LIKE UPPER(#apellido2#)
									  </isNotEmpty>  
									  <isNotEmpty prepend="AND" property="criterioBusqueda1">        
										UPPER(c.VAL_CRIT_BUS1) LIKE UPPER(#criterioBusqueda1#)
									  </isNotEmpty> 
									  <isNotEmpty prepend="AND" property="criterioBusqueda2">        
										UPPER(c.VAL_CRIT_BUS2) LIKE UPPER(#criterioBusqueda2#)
									  </isNotEmpty>             
									  <isNotEmpty prepend="AND" property="documentoIdentidad">        
										UPPER(i.NUM_DOCU_IDEN) LIKE UPPER(#documentoIdentidad#)
									  </isNotEmpty>									  																			  		
						)
				)
	   	<![CDATA[				
		WHERE ROWNUM < 501									         
	    ]]>
    </select>
	
	
	<!-- OBTIENE LISTA DE CLIENTES QUE CUMPLAN CON EL FILTRO DE BUSQUEDA -->
    <select id="getClientesReemplazoByCriteria" parameterClass="java.util.Map" resultClass="clienteBasico">
		SELECT codigo, 
		       nombre1, 
			   nombre2, 
			   apellido1, 
			   apellido2, 
			   OID
		  FROM  (SELECT ROWNUM, codigo, nombre1, nombre2, apellido1, apellido2, OID
		          FROM (SELECT DISTINCT c.cod_clie codigo, 
		          						c.val_nom1 nombre1,
		                                c.val_nom2 nombre2, 
		                                c.val_ape1 apellido1,
		                                c.val_ape2 apellido2, 
		                                c.oid_clie OID
									FROM ZON_TIPO_CARGO t,
										 MAE_CLIEN c, 
										 MAE_CLIEN_IDENT i,
                     				     ZON_DIREC_VENTA_CABEC a,ZON_DIREC_VENTA_DETAL d
									WHERE a.cor_dire_vent = d.dica_cor_dire_vent
									  AND c.PAIS_OID_PAIS = #oidPais#
									  AND i.CLIE_OID_CLIE = c.OID_CLIE
                    				  AND a.Cod_Clie=c.COD_CLIE
									  AND a.TICA_COD_TIPO_CARG=t.Cod_Tipo_Carg									
									  AND a.TICA_COD_TIPO_CARG=d.TICA_COD_TIPO_CARG
									  AND a.COD_CLIE=d.COD_CLIE
							      	  AND a.FEC_REGI=d.DICA_FEC_REGI
							      	  AND a.TIOP_COD_TIPO_OPER=d.TIOP_COD_TIPO_OPER
							      	  AND a.TICA_COD_TIPO_CARG=d.TICA_COD_TIPO_CARG									  
									  AND a.ESCA_COD_ESTA_CARG='A'
									  AND a.IND_ESTA='A'								  								 
									  <![CDATA[
										AND a.TIOP_COD_TIPO_OPER <> 'RZ'
										]]>									  
									  <isNotEmpty prepend="AND" property="codigoCliente">        
										c.COD_CLIE LIKE #codigoCliente#
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre1">        
										UPPER(c.VAL_NOM1) LIKE UPPER(#nombre1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="nombre2">        
										UPPER(c.VAL_NOM2) LIKE UPPER(#nombre2#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido1">        
										UPPER(c.VAL_APE1) LIKE UPPER(#apellido1#)
									  </isNotEmpty>
									  <isNotEmpty prepend="AND" property="apellido2">        
										UPPER(c.VAL_APE2) LIKE UPPER(#apellido2#)
									  </isNotEmpty>  
									  <isNotEmpty prepend="AND" property="criterioBusqueda1">        
										UPPER(c.VAL_CRIT_BUS1) LIKE UPPER(#criterioBusqueda1#)
									  </isNotEmpty> 
									  <isNotEmpty prepend="AND" property="criterioBusqueda2">        
										UPPER(c.VAL_CRIT_BUS2) LIKE UPPER(#criterioBusqueda2#)
									  </isNotEmpty>             
									  <isNotEmpty prepend="AND" property="documentoIdentidad">        
										UPPER(i.NUM_DOCU_IDEN) LIKE UPPER(#documentoIdentidad#)
									  </isNotEmpty>									  																			  		
						)
				)
	   	<![CDATA[				
		WHERE ROWNUM < 501									         
	    ]]>
    </select>
	
	
	<resultMap id="getLicenciaListResult" class="java.util.HashMap">
		<result property="codigoCliente"	 			     column="COD_CLIE"/>
		<result property="oidCliente"	 			     	 column="OID_CLIE"/>
		<result property="codigoCargo" 			 			 column="COD_CARG"/>		
		<result property="codigoOperacion" 		 			 column="COD_DIRE_OPER"/>
		<result property="nombreConsultora" 			     column="NOMBRE"/>
		<result property="codigoLicencia" 			         column="COD_MOTI_LICE"/>
		<result property="descripcionLicencia" 			     column="DES_MOTI_LICE"/>
		<result property="codigoClienteReemplazo" 			 column="COD_REEM"/>
		<result property="oidClienteReemplazo" 			 	 column="OIDCLIENREEMPLAZO"/>
		<result property="nombreConsultoraReemplazo" 		 column="NOMBREREEMPLAZO"/>
		<result property="fechaSalida" 	 					 column="FECHASALIDA"/>
		<result property="fechaRegreso" 	 				 column="FECHAREGRESO"/>		
		<result property="estado" 							 column="ESTADO"/>		
	</resultMap>
	
	<select id="getLicenciaList" parameterClass="java.util.Map" resultMap="getLicenciaListResult">
			  SELECT A.COD_CLIE,
			  B.OID_CLIE,
              A.TICA_COD_TIPO_CARG COD_CARG,
              A.TIOP_COD_TIPO_OPER COD_DIRE_OPER,              			 
              TRIM(B.val_ape1) || ' ' || TRIM(B.val_ape2) || ' ' ||
              TRIM(B.VAL_NOM1) || ' ' || TRIM(B.VAL_NOM2) AS NOMBRE,
			  C.COD_MOTI_LICE,
              C.DES_MOTI_LICE,
			  A.COD_CLIE_REEM COD_REEM,
			  (SELECT 
			  		  D.OID_CLIE
                 FROM MAE_CLIEN D
                WHERE A.COD_CLIE_REEM = D.COD_CLIE) as OIDCLIENREEMPLAZO,
              (SELECT 
			  		  TRIM(D.val_ape1) || ' ' || TRIM(D.val_ape2) || ' ' ||
                      TRIM(D.VAL_NOM1) || ' ' || TRIM(D.VAL_NOM2) 
                 FROM MAE_CLIEN D
                WHERE A.COD_CLIE_REEM = D.COD_CLIE) as NOMBREREEMPLAZO,
                TO_CHAR(A.FEC_REGI,'dd/MM/yyyy') AS FECHASALIDA,
                TO_CHAR(A.FEC_REGR,'dd/MM/yyyy') AS FECHAREGRESO,
                CASE A.IND_ESTA 
                     WHEN 'A' THEN 'APROBADO'
                     WHEN 'R' THEN 'RECHAZADO'
                     WHEN 'G' THEN 'GRAVADO'
                END AS ESTADO     
         FROM ZON_DIREC_VENTA_CABEC A, MAE_CLIEN B, ZON_MOTIV_LICEN C
        WHERE A.TIOP_COD_TIPO_OPER = 'LI'
          AND A.IND_ESTA IN ('A', 'G', 'R')
          AND A.COD_CLIE = B.COD_CLIE
          AND A.MOTI_COD_MOTI_LICE = C.COD_MOTI_LICE
		   <isNotEmpty prepend="AND" property="codigoMotivoLicencia">
		       A.MOTI_COD_MOTI_LICE = #codigoMotivoLicencia#
		   </isNotEmpty>
		   <isNotEmpty prepend="AND" property="codigoCliente">
		       A.COD_CLIE = #codigoCliente#
		   </isNotEmpty>		   		   
	</select>
	
	<resultMap id="aprobarOperacionINResult" class="java.util.HashMap">
	      <result property="codigoConsultora" 			    	column="COD_CLIE" 	/>
	      <result property="codigoCargo" 			            column="COD_CARG" 	/>
		  <result property="codigoOperacion"					column="COD_DIRE_OPER" />
		  <result property="fechaOperacion"						column="FEC_OPER" />			  
		  <result property="reemplazo"						    column="COD_REEM" />
		  <result property="titular"							column="TITULAR"/>
		  <result property="unidadAdministrativa"				column="UNIDAD_ADMINISTRATIVA"/>
		  <result property="ua"									column="UA"/>		  		 
	 </resultMap>

     <select id="getAprobarOperacionIN"  parameterClass="java.util.Map" resultMap="aprobarOperacionINResult">
					SELECT A.COD_CLIE,
				       A.TICA_COD_TIPO_CARG COD_CARG,
					   A.TIOP_COD_TIPO_OPER COD_DIRE_OPER,
					   A.FEC_REGI FEC_OPER,
				       A.COD_CLIE_REEM COD_REEM,
				       CASE C.VAL_TITU
				         WHEN '1' THEN
				          'Titular'
				         WHEN '0' THEN
				          'No Titular'
				       END AS TITULAR,
		               D.COD_REGI,
		               D.COD_ZONA,
		               E.DES_REGI,
		               F.DES_ZONA,
		              CASE  C.VAL_TIPO_UNID_ADMI
					  	 WHEN 'Z' THEN
						 	F.DES_ZONA ||' '||F.COD_ZONA
						 WHEN 'R' THEN
						 	E.DES_REGI ||' '||E.COD_REGI
						ELSE DECODE(F.COD_ZONA,NULL,E.DES_REGI ||' '||E.COD_REGI,F.DES_ZONA ||' '||F.COD_ZONA)		
					    END AS UNIDAD_ADMINISTRATIVA,
					  D.COD_SUBG||D.COD_REGI||D.COD_ZONA AS UA					  					  	
				  	  FROM ZON_DIREC_VENTA_CABEC A,ZON_TIPO_CARGO C,ZON_DIREC_VENTA_DETAL D,ZON_REGIO E,ZON_ZONA F
				 	  WHERE A.COR_DIRE_VENT = D.DICA_COR_DIRE_VENT
				   	  AND A.TICA_COD_TIPO_CARG = C.COD_TIPO_CARG
					  AND A.TIOP_COD_TIPO_OPER='IN'
					  AND A.IND_ESTA='G'
					  AND A.COD_CLIE=D.COD_CLIE
			            AND A.TICA_COD_TIPO_CARG=D.TICA_COD_TIPO_CARG
			            AND A.FEC_REGI=D.DICA_FEC_REGI
			            AND A.TIOP_COD_TIPO_OPER=D.TIOP_COD_TIPO_OPER
			            AND E.COD_REGI(+)=D.COD_REGI
			            AND F.COD_ZONA(+)=D.COD_ZONA
			            
			            <isNotEmpty prepend="AND" property="codigoRegion">
			            	D.COD_REGI = #codigoRegion#
			            </isNotEmpty>

			            <isNotEmpty prepend="AND" property="codigoZona">
			            	D.COD_ZONA = #codigoZona#
			            </isNotEmpty>

			            <isNotEmpty prepend="AND" property="fechaProceso">
			            	trunc(A.FEC_REGI)=trunc(to_date(#fechaProceso#,'dd/MM/yyyy'))
			            </isNotEmpty>
			            
						ORDER BY A.COD_CLIE											
	</select>
	
	<resultMap id="aprobarOperacionREResult" class="java.util.HashMap">
	      <result property="codigoConsultora" 			    	column="COD_CLIE" 	/>
	      <result property="codigoCargo" 			            column="COD_CARG" 	/>
		  <result property="codigoOperacion"					column="COD_DIRE_OPER" />
		  <result property="fechaRetiro"						column="FEC_OPER" />
		  <result property="ua"							        column="UA"/>		  
	 </resultMap>

     <select id="getAprobarOperacionRE"  parameterClass="java.util.Map" resultMap="aprobarOperacionREResult">
					SELECT A.COD_CLIE,
					       A.TICA_COD_TIPO_CARG COD_CARG,
						   A.TIOP_COD_TIPO_OPER AS COD_DIRE_OPER,						   
					       B.COD_SUBG||B.COD_REGI||B.COD_ZONA AS UA,
					       TO_CHAR(A.FEC_REGI,'dd/MM/yyyy') AS FEC_OPER            
					  FROM ZON_DIREC_VENTA_CABEC A,ZON_DIREC_VENTA_DETAL B
					 WHERE A.COR_DIRE_VENT = B.DICA_COR_DIRE_VENT
					   AND A.TIOP_COD_TIPO_OPER = 'RE'
					   AND A.IND_ESTA = 'G'
					   AND A.COD_CLIE=B.COD_CLIE
					   AND A.TICA_COD_TIPO_CARG=B.TICA_COD_TIPO_CARG
					   AND A.TIOP_COD_TIPO_OPER=B.TIOP_COD_TIPO_OPER
					   AND A.FEC_REGI=B.DICA_FEC_REGI											
			            <isNotEmpty prepend="AND" property="codigoRegion">
			            	B.COD_REGI = #codigoRegion#
			            </isNotEmpty>

			            <isNotEmpty prepend="AND" property="codigoZona">
			            	B.COD_ZONA = #codigoZona#
			            </isNotEmpty>

			            <isNotEmpty prepend="AND" property="fechaProceso">
			            	trunc(A.FEC_REGI)=trunc(to_date(#fechaProceso#,'dd/MM/yyyy'))
			            </isNotEmpty>
	</select>
	
	<resultMap id="aprobarOperacionLIResult" class="java.util.HashMap">
	      <result property="codigoConsultora" 			    	column="COD_CLIE" 	/>
		  <result property="codigoOperacion" 			        column="COD_DIRE_OPER" 	/>
		  <result property="codigoCargo" 			            column="COD_CARG" 	/>
	      <result property="licencia" 			            	column="DES_MOTI_LICE" 	/>
		  <result property="codigoLicencia" 			        column="COD_MOTI_LICE" 	/>
		  <result property="reemplazo"							column="COD_REEM"/>
		  <result property="fechaSalida"						column="FEC_OPER" />
		  <result property="fechaRegreso"						column="FEC_REGR" />
		  <result property="titular"							column="TITULAR" />
		  <result property="ua"									column="UA" />
	 </resultMap>

     <select id="getAprobarOperacionLI"  parameterClass="java.util.Map" resultMap="aprobarOperacionLIResult">
					 SELECT   distinct(A.COD_CLIE) COD_CLIE,
						     A.TIOP_COD_TIPO_OPER COD_DIRE_OPER,
							 A.TICA_COD_TIPO_CARG COD_CARG,
					         L.DES_MOTI_LICE,
							 L.COD_MOTI_LICE,
			                 A.COD_CLIE_REEM COD_REEM,
			                 TO_CHAR(A.FEC_REGI,'dd/MM/yyyy') FEC_OPER,
			                 TO_CHAR(A.FEC_REGR,'dd/MM/yyyy') FEC_REGR,
			                 CASE T.VAL_TITU
			                      WHEN '1' THEN 'Si'                 
			                      WHEN '0' THEN 'No'
			                 END AS TITULAR,
                        B.COD_SUBG||B.COD_REGI||B.COD_ZONA AS UA                                
								  FROM ZON_DIREC_VENTA_CABEC A,ZON_MOTIV_LICEN L,ZON_TIPO_CARGO T,ZON_DIREC_VENTA_DETAL B
					WHERE A.COR_DIRE_VENT = B.DICA_COR_DIRE_VENT 
					AND A.TIOP_COD_TIPO_OPER = 'LI'
								   AND A.IND_ESTA = 'G'
			             AND A.MOTI_COD_MOTI_LICE = L.COD_MOTI_LICE
			             AND A.TICA_COD_TIPO_CARG = T.COD_TIPO_CARG
                     AND A.COD_CLIE=B.COD_CLIE
					   AND A.TICA_COD_TIPO_CARG=B.TICA_COD_TIPO_CARG
					   AND A.TIOP_COD_TIPO_OPER=B.TIOP_COD_TIPO_OPER
					   AND A.FEC_REGI=B.DICA_FEC_REGI	
					   
			            <isNotEmpty prepend="AND" property="codigoRegion">
			            	B.COD_REGI = #codigoRegion#
			            </isNotEmpty>

			            <isNotEmpty prepend="AND" property="codigoZona">
			            	B.COD_ZONA = #codigoZona#
			            </isNotEmpty>

			            <isNotEmpty prepend="AND" property="fechaProceso">
			            	trunc(A.FEC_REGI)=trunc(to_date(#fechaProceso#,'dd/MM/yyyy'))
			            </isNotEmpty>
	</select>
	
	<resultMap id="aprobarOperacionNMResult" class="java.util.HashMap">
	      <result property="codigoConsultora" 			    	column="COD_CLIE" 	/>
		  <result property="codigoOperacion" 			    	column="COD_DIRE_OPER" 	/>
		  <result property="fechaOperacion" 			    	column="FEC_OPER" 	/>
	      <result property="cargoActual" 			            column="CARGO_ACTUAL" 	/>
		  <result property="nuevoCargo"							column="CARGO_NUEVO"/>
		  <result property="uaActual"							column="UA_ACTUAL"/>
		  <result property="uaNueva"							column="UA_NUEVA"/>		  		  
	 </resultMap>

     <select id="getAprobarOperacionNM"  parameterClass="java.util.Map" resultMap="aprobarOperacionNMResult">
		WITH TEMPORAL AS (
        SELECT *
                FROM ZON_DIREC_VENTA_CABEC T
                WHERE 
                T.ESCA_COD_ESTA_CARG='A'                 
                ORDER BY T.FEC_REGI DESC
   )
   SELECT A.COD_CLIE,
   		  A.TIOP_COD_TIPO_OPER COD_DIRE_OPER,
		  A.FEC_REGI FEC_OPER,
		          (SELECT X.TICA_COD_TIPO_CARG FROM TEMPORAL X WHERE X.COD_CLIE = A.COD_CLIE
		          AND X.ESCA_COD_ESTA_CARG='A'
          AND ROWNUM=1) AS CARGO_ACTUAL,          
          A.TICA_COD_TIPO_CARG AS CARGO_NUEVO,
          (SELECT Y.COD_SUBG || Y.COD_REGI || Y.COD_ZONA FROM TEMPORAL X,ZON_DIREC_VENTA_DETAL Y WHERE X.COD_CLIE = A.COD_CLIE
          AND X.COD_CLIE=Y.COD_CLIE
		          AND X.FEC_regi=Y.DICA_FEC_REGI
		          AND X.TIOP_COD_TIPO_OPER=Y.TIOP_COD_TIPO_OPER
		          AND X.TICA_COD_TIPO_CARG=Y.TICA_COD_TIPO_CARG
		          AND X.ESCA_COD_ESTA_CARG='A' 
		          AND X.IND_ESTA='A'   
          AND ROWNUM=1) AS UA_ACTUAL,
          (B.COD_SUBG||B.COD_REGI||B.COD_ZONA) AS UA_NUEVA		  		  		 
     FROM ZON_DIREC_VENTA_CABEC A, ZON_DIREC_VENTA_DETAL B
		    WHERE A.COR_DIRE_VENT = B.DICA_COR_DIRE_VENT
		      AND A.COD_CLIE = B.COD_CLIE
      AND A.TICA_COD_TIPO_CARG = B.TICA_COD_TIPO_CARG
      AND A.FEC_REGI = B.DICA_FEC_REGI
      AND A.TIOP_COD_TIPO_OPER = B.TIOP_COD_TIPO_OPER
      AND A.TIOP_COD_TIPO_OPER = 'NM'
      AND A.IND_ESTA = 'G'
		      
            <isNotEmpty prepend="AND" property="codigoRegion">
            	B.COD_REGI = #codigoRegion#
            </isNotEmpty>

            <isNotEmpty prepend="AND" property="codigoZona">
            	B.COD_ZONA = #codigoZona#
            </isNotEmpty>
            
            <isNotEmpty prepend="AND" property="fechaProceso">
            	trunc(A.FEC_REGI)=trunc(to_date(#fechaProceso#,'dd/MM/yyyy'))
            </isNotEmpty>
		      
	</select>
	
	<resultMap id="aprobarOperacionROResult" class="java.util.HashMap">
	      <result property="codigoConsultora" 			    	column="COD_CLIE" 	/>
		  <result property="codigoOperacion" 			    	column="COD_DIRE_OPER" 	/>
		  <result property="fechaOperacion" 			    	column="FEC_OPER" 	/>
		  <result property="nuevoCargo"							column="CARGO_NUEVO"/>
		  <result property="uaActual"							column="UA_ACTUAL"/>
		  <result property="uaRotacion"							column="UA_ROTACION"/>			  
	 </resultMap>

     <select id="getAprobarOperacionRO"  parameterClass="java.util.Map" resultMap="aprobarOperacionROResult">
					WITH TEMPORAL2 AS (
        SELECT *
      FROM ZON_HISTO_GEREN
     WHERE FEC_HAST IS NULL       
     ORDER BY OID_HIST_GERE DESC
   )
   SELECT A.COD_CLIE,
   		  A.TIOP_COD_TIPO_OPER COD_DIRE_OPER,
		  A.FEC_REGI FEC_OPER,                 
          A.TICA_COD_TIPO_CARG AS CARGO_NUEVO,
          (SELECT T.UA FROM TEMPORAL2 T WHERE T.GERE=A.COD_CLIE AND ROWNUM=1) AS UA_ACTUAL,
          (B.COD_SUBG||B.COD_REGI||B.COD_ZONA) AS UA_ROTACION		  		  		 
     FROM ZON_DIREC_VENTA_CABEC A, ZON_DIREC_VENTA_DETAL B
		    WHERE A.COR_DIRE_VENT = B.DICA_COR_DIRE_VENT
		      AND A.COD_CLIE = B.COD_CLIE
      AND A.TICA_COD_TIPO_CARG = B.TICA_COD_TIPO_CARG
      AND A.FEC_REGI = B.DICA_FEC_REGI
      AND A.TIOP_COD_TIPO_OPER = B.TIOP_COD_TIPO_OPER
      AND A.TIOP_COD_TIPO_OPER = 'RO'
      AND A.IND_ESTA = 'G'
	  								
            <isNotEmpty prepend="AND" property="codigoRegion">
            	B.COD_REGI = #codigoRegion#
            </isNotEmpty>

            <isNotEmpty prepend="AND" property="codigoZona">
            	B.COD_ZONA = #codigoZona#
            </isNotEmpty>
            
            <isNotEmpty prepend="AND" property="fechaProceso">
            	trunc(A.FEC_REGI)=trunc(to_date(#fechaProceso#,'dd/MM/yyyy'))
            </isNotEmpty>
	</select>
		
	<parameterMap id="paramAprobarOperacion" class="java.util.Map">
		<parameter property="codigoPais"                 jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario"              jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoConsultora"           jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoConsultoraReemplazo"  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargo"           	 jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoOperacion"            jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />						
		<parameter property="fechaProceso"               jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoSubgerencia"          jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegion"               jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoZona"                 jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoSubgerenciaActual"    jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegionActual"         jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoZonaActual"           jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaSalida"                jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaRegreso"               jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoLicencia"             jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoError" 			     jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />				
	</parameterMap>
	
	<procedure id="executeAprobarOperacion" parameterMap="paramAprobarOperacion">
		{call zon_pkg_unida_admin.ZON_PR_APROB_OPERA(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? ,? ,? ,? ,?) }
	</procedure>
	
	<select id="getRegionesDirectorioNoTitular" parameterClass="java.util.Map" resultMap="baseResult">
		     SELECT NVL(zr.COD_REGI, ' ') AS CODIGO, 	   
				    NVL(zr.DES_REGI, ' ') AS DESCRIPCION,
				    NVL(zr.COD_REGI, 'ZZ')
			 from zon_regio zr				  				 							
			 WHERE	
			   zr.IND_ACTI = 1 					   		     
			 ORDER BY 3
    </select>
	
	<select id="getRegionesDirectorioTitular" parameterClass="java.util.Map" resultMap="baseResult">
		     SELECT NVL(zr.COD_REGI, ' ') AS CODIGO, 	   
				    NVL(zr.DES_REGI, ' ') AS DESCRIPCION,
				    NVL(zr.COD_REGI, 'ZZ')
			 from zon_regio zr				  				 							
			 WHERE	
			   zr.IND_ACTI = 1 AND
			   zr.CLIE_OID_CLIE IS NULL 		   		      
			 ORDER BY 3
    </select>
	
	<select id="getRegionesZonasDirectorioID" parameterClass="java.util.Map" resultMap="baseResult">
		       SELECT DISTINCT(NVL(zr.COD_REGI, ' ')) AS CODIGO, 	   
				    NVL(zr.DES_REGI, ' ') AS DESCRIPCION,
				    NVL(zr.COD_REGI, 'ZZ')
			 from zon_regio zr,
				  zon_zona   zz
				where zr.OID_REGI = zz.ZORG_OID_REGI
				and zr.IND_ACTI = 1
				and zz.IND_ACTI = 1
				and zz.CLIE_OID_CLIE is null	   		      
			 ORDER BY 3
    </select>
	
	<!-- VALIDA SI EL CODIGO CLIENTE EXISTE -->
    <select id="getExisteCodigoClienteDirectorioByCodPais" parameterClass="java.util.Map" resultClass="clienteBasico">
		SELECT  DISTINCT(M.COD_CLIE) AS codigo,
				M.VAL_NOM1 nombre1, 
				M.VAL_NOM2 nombre2, 
				M.VAL_APE1 apellido1, 
				M.VAL_APE2 apellido2,
				M.OID_CLIE oid,
				T.DES_TIPO_CARG descripcionCargo,
				CASE T.COD_TIPO_CARG
                         WHEN 'GZ' THEN
                          S.DES_ZONA
                         WHEN 'GR' THEN
                          R.DES_REGI
                         ELSE
                          DECODE(D.COD_ZONA,
                                NULL,
                                R.DES_REGI,
                                S.DES_ZONA)
                         END unidadAdministrativa,  
		        (SELECT COUNT (*) FROM MAE_CLIEN_TIPO_SUBTI S , MAE_TIPO_CLIEN T
		          WHERE S.CLIE_OID_CLIE = M.OID_CLIE
		            AND S.TICL_OID_TIPO_CLIE = T.OID_TIPO_CLIE
		            AND T.COD_TIPO_CLIE = '02') oidFormaPago
		  FROM MAE_CLIEN M,ZON_DIREC_VENTA_CABEC Z,ZON_TIPO_CARGO T,ZON_DIREC_VENTA_DETAL D,ZON_REGIO R,ZON_ZONA S
		  		
		WHERE Z.COR_DIRE_VENT = D.DICA_COR_DIRE_VENT  
		  AND	M.PAIS_OID_PAIS = #oidPais#
		  AND  M.COD_CLIE = #codigoCliente#
		  AND  T.VAL_TITU=1
		  AND  Z.TICA_COD_TIPO_CARG=T.Cod_Tipo_Carg
		  AND  Z.COD_CLIE=D.COD_CLIE
      	  AND  Z.FEC_REGI=D.DICA_FEC_REGI
      	  AND  Z.TIOP_COD_TIPO_OPER=D.TIOP_COD_TIPO_OPER
      	  AND  Z.TICA_COD_TIPO_CARG=D.TICA_COD_TIPO_CARG		 				
		  AND  M.COD_CLIE=Z.COD_CLIE	
		  AND  R.COD_REGI(+)=D.COD_REGI
          AND  S.COD_ZONA(+)=D.COD_ZONA	  
		  <![CDATA[
			AND Z.TIOP_COD_TIPO_OPER <> 'RZ'
		  ]]>
		  <![CDATA[
			AND Z.TIOP_COD_TIPO_OPER <> 'LI'
		  ]]>									  
	      AND Z.IND_ESTA='A'
    </select>
	
	<!-- VALIDA SI EL CODIGO CLIENTE EXISTE -->
    <select id="getExisteCodigoClienteDirectorioReemplazoByCodPais" parameterClass="java.util.Map" resultClass="clienteBasico">
		SELECT  DISTINCT(M.COD_CLIE) AS codigo,
				M.VAL_NOM1 nombre1, 
				M.VAL_NOM2 nombre2, 
				M.VAL_APE1 apellido1, 
				M.VAL_APE2 apellido2,
				M.OID_CLIE oid,
				T.DES_TIPO_CARG descripcionCargo,
				CASE T.COD_TIPO_CARG
                         WHEN 'GZ' THEN
                          S.DES_ZONA
                         WHEN 'GR' THEN
                          R.DES_REGI
                         ELSE
                          DECODE(D.COD_ZONA,
                                NULL,
                                R.DES_REGI,
                                S.DES_ZONA)
                         END unidadAdministrativa,  
		        (SELECT COUNT (*) FROM MAE_CLIEN_TIPO_SUBTI S , MAE_TIPO_CLIEN T
		          WHERE S.CLIE_OID_CLIE = M.OID_CLIE
		            AND S.TICL_OID_TIPO_CLIE = T.OID_TIPO_CLIE
		            AND T.COD_TIPO_CLIE = '02') oidFormaPago
		  FROM MAE_CLIEN M,ZON_DIREC_VENTA_CABEC Z,ZON_TIPO_CARGO T,ZON_DIREC_VENTA_DETAL D,ZON_REGIO R,ZON_ZONA S
		  		
		WHERE  Z.COR_DIRE_VENT = D.DICA_COR_DIRE_VENT
		  AND  M.PAIS_OID_PAIS = #oidPais#
		  AND  M.COD_CLIE = #codigoCliente#	
		  AND  Z.TICA_COD_TIPO_CARG=T.Cod_Tipo_Carg
		  AND  Z.COD_CLIE=D.COD_CLIE
      	  AND  Z.FEC_REGI=D.DICA_FEC_REGI
      	  AND  Z.TIOP_COD_TIPO_OPER=D.TIOP_COD_TIPO_OPER
      	  AND  Z.TICA_COD_TIPO_CARG=D.TICA_COD_TIPO_CARG		 				
		  AND  M.COD_CLIE=Z.COD_CLIE	
		  AND  R.COD_REGI(+)=D.COD_REGI
          AND  S.COD_ZONA(+)=D.COD_ZONA	  
		  <![CDATA[
			AND Z.TIOP_COD_TIPO_OPER <> 'RZ'
		  ]]>
		  <![CDATA[
			AND Z.TIOP_COD_TIPO_OPER <> 'LI'
		  ]]>									  
	      AND Z.IND_ESTA='A'
    </select>  
	  
	
	<select id="getListaZonasDirectorioNoTitular" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZON_ZONA.COD_ZONA, ' ') AS CODIGO, 	   
		    NVL(ZON_ZONA.DES_ZONA, ' ') AS DESCRIPCION,
		    NVL(ZON_ZONA.COD_ZONA, 'ZZ')		
	 FROM  ZON_ZONA,
	       ZON_REGIO
	 WHERE (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)	 		
	       <isNotEmpty property="codigoRegion">	
		    <iterate prepend="AND" property="codigoRegion" open=" ZON_REGIO.COD_REGI IN (" close=")" conjunction=",">
        	 	#codigoRegion[]#
        	</iterate>    
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="indicadorActivo">
					ZON_ZONA.IND_ACTI =#indicadorActivo#
		   </isNotEmpty>		   	      
	 ORDER BY 3
    </select>
	
	<select id="getListaZonasDirectorioTitular" parameterClass="java.util.Map" resultMap="baseResult">
     SELECT NVL(ZON_ZONA.COD_ZONA, ' ') AS CODIGO, 	   
		    NVL(ZON_ZONA.DES_ZONA, ' ') AS DESCRIPCION,
		    NVL(ZON_ZONA.COD_ZONA, 'ZZ')		
	 FROM  ZON_ZONA,
	       ZON_REGIO
	 WHERE (ZON_REGIO.OID_REGI = ZON_ZONA.ZORG_OID_REGI)
	 		AND ZON_ZONA.CLIE_OID_CLIE IS NULL
	       <isNotEmpty property="codigoRegion">	
		    <iterate prepend="AND" property="codigoRegion" open=" ZON_REGIO.COD_REGI IN (" close=")" conjunction=",">
        	 	#codigoRegion[]#
           </iterate>    
		  </isNotEmpty>
		  <isNotEmpty prepend="AND" property="indicadorActivo">
					ZON_ZONA.IND_ACTI =#indicadorActivo#
		   </isNotEmpty>		  		      
	 ORDER BY 3
    </select>
	
	<select id="getDescripcionCargoZON" parameterClass="string" resultClass="string">
			     SELECT B.DES_TIPO_CARG FROM ZON_DIREC_VENTA_CABEC A,ZON_TIPO_CARGO B,MAE_CLIEN C
        		 WHERE C.OID_CLIE=#oidCliente#
				 AND C.COD_CLIE=A.COD_CLIE
				 AND A.IND_ESTA='A' AND A.ESCA_COD_ESTA_CARG='A'        		
        	     AND A.TICA_COD_TIPO_CARG=B.COD_TIPO_CARG
   </select>
   				 	
  <resultMap id="unidadAdministrativaResult" class="java.util.HashMap">
	      <result property="ua" 			    	column="UA" 	/>		  	 
	 </resultMap>
	 
   <select id="getUnidadAdministrativaZON" parameterClass="java.util.Map" resultMap="unidadAdministrativaResult">
		 SELECT (CASE D.DES_TIPO_CARG WHEN 'Z' THEN Z.COD_ZONA||' '||Z.DES_ZONA
                ELSE R.COD_REGI||' '||R.DES_REGI END) AS UA
          FROM ZON_DIREC_VENTA_CABEC A,
               ZON_DIREC_VENTA_DETAL B,
               MAE_CLIEN             C,
               ZON_TIPO_CARGO        D,
               ZON_ZONA              Z,
               ZON_REGIO             R
         WHERE A.COR_DIRE_VENT = B.DICA_COR_DIRE_VENT
           AND A.COD_CLIE = B.COD_CLIE
           AND A.TIOP_COD_TIPO_OPER = B.TIOP_COD_TIPO_OPER
           AND A.TICA_COD_TIPO_CARG = B.TICA_COD_TIPO_CARG
           AND A.FEC_REGI = B.DICA_FEC_REGI
           AND A.IND_ESTA = 'A'
           AND A.ESCA_COD_ESTA_CARG = 'A'
           AND A.COD_CLIE = C.COD_CLIE
           AND C.OID_CLIE = #oidCliente#
           AND A.TICA_COD_TIPO_CARG=D.COD_TIPO_CARG
           AND B.COD_REGI=R.COD_REGI(+)
           AND B.COD_ZONA=Z.COD_ZONA(+)
   </select>

   <resultMap id="getRegionesResult" class="java.util.HashMap">
   	<result property="oidRegion" column="OID_REGI"/>
   	<result property="codigoRegion" column="COD_REGI"/>
   	<result property="descripcion" column="DES_REGI"/>
   </resultMap>
	
   <select id="getRegionesList" parameterClass="java.util.Map" resultMap="getRegionesResult">   	
   		select OID_REGI,
   		       COD_REGI,
   		       DES_REGI
   		from ZON_REGIO
   		where ZSGV_OID_SUBG_VENT = (SELECT OID_SUBG_VENT 
   		                            FROM ZON_SUB_GEREN_VENTA 
   		                            WHERE pais_oid_pais = Gen_Pkg_Gener.gen_fn_devuelve_id_pais(#codigoPais#)
   		                            AND  cod_subg_vent = #codigoSubGerencia#)
   		<isNotEmpty property="codigoRegion">
   			and cod_regi = #codigoRegion#
   		</isNotEmpty>
   		and IND_ACTI = 1
   		and IND_BORR = 0
   		order by COD_REGI   	
   </select>	
   
   <update id="deleteRegion" parameterClass="java.util.Map">
   		UPDATE ZON_REGIO
   		SET IND_ACTI = 0,
   		    IND_BORR = 1,
   		    PERD_OID_PERI_FINA = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodo#)
   		WHERE OID_REGI = #oidRegion#
   </update>
   
   <select id="getZonasIndActivasByOidRegion" parameterClass="integer" resultClass="integer">
	   	select IND_ACTI
		from ZON_ZONA
		where ZORG_OID_REGI = #value#
   </select>
   
   <resultMap id="getRegionResult" class="java.util.HashMap">
	   	<result property="codigoSubGerencia" column="COD_SUBG_VENT"/>
	   	<result property="oidRegion"         column="OID_REGI"/>
	   	<result property="codigoRegion"      column="COD_REGI"/>
	   	<result property="descripcion"       column="DES_REGI"/>
   </resultMap>
   
   <select id="getRegion" parameterClass="integer" resultMap="getRegionResult">
   		SELECT a.COD_SUBG_VENT,
   		       b.OID_REGI,
   		       b.COD_REGI,
   		       b.DES_REGI
   		FROM zon_sub_geren_venta a,
   		     zon_regio b
   		where a.OID_SUBG_VENT = b.ZSGV_OID_SUBG_VENT
   		and b.OID_REGI = #value#   		
   </select>
   
   <select id="getEncuentraRegionByCodigoRegion" parameterClass="string" resultClass="integer">
   		SELECT COUNT(1)
   		FROM ZON_REGIO
   		WHERE COD_REGI = #value#
   </select>
   
   <insert id="insertRegion" parameterClass="java.util.Map">
   		INSERT INTO ZON_REGIO(OID_REGI,COD_REGI,IND_ACTI,IND_BORR,ZSGV_OID_SUBG_VENT,DES_REGI,CANA_OID_CANA,MARC_OID_MARC,PAIS_OID_PAIS,PERD_OID_PERI_INIC)
   		VALUES(zon_zorg_seq.nextval,
   		       #codigoRegion#,
   		       1,
   		       0,
   		       GEN_PKG_GENER.gen_fn_devuelve_id_sub_geren(#codigoSubGerencia#),
   		       #descripcion#,
   		       GEN_PKG_GENER.gen_fn_devuelve_id_canal(#codigoCanal#),
   		       GEN_PKG_GENER.gen_fn_devuelve_id_marca(#codigoMarca#),
   		       GEN_PKG_GENER.gen_fn_devuelve_id_pais(#codigoPais#),
   		       GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodo#))
   </insert>
   
   <update id="updateRegion" parameterClass="java.util.Map">
   		UPDATE ZON_REGIO
   		SET DES_REGI = #descripcion#,
   		    USU_MODI = #login#
   		WHERE OID_REGI = #oidRegion#
   </update>
   
   <delete id="deleteRegionFisicamente" parameterClass="integer">
   	DELETE FROM ZON_REGIO WHERE OID_REGI = #value#
   </delete>
   
   <select id="getZonaByRegionZona" parameterClass="map" resultMap="baseResult">
		select 
		zz.cod_zona CODIGO, 
		zz.des_zona DESCRIPCION
		from zon_regio zr, zon_zona zz
		where zr.oid_regi = zz.zorg_oid_regi
		and zr.ind_Acti = '1'
		and zz.ind_Acti = '1'
		and zr.cod_regi = #codigoRegion#
		and zz.cod_zona = #codigoZona#
   </select>
   
   <select id="getSeccionByRegionZonaSeccion" parameterClass="map" resultMap="baseResult">
		select 
		zs.cod_secc CODIGO, 
		zs.des_secci DESCRIPCION
		from zon_regio zr, zon_zona zz, zon_secci zs
		where zr.oid_regi = zz.zorg_oid_regi
		and zz.oid_zona = zs.zzon_oid_zona
		and zr.ind_Acti = '1'
		and zz.ind_Acti = '1'
		and zs.ind_Acti = '1'
		and zr.cod_regi = #codigoRegion#
		and zz.cod_zona = #codigoZona#
		and zs.cod_secc = #codigoSeccion#
   </select>
   
   <insert id="insertSeccionNoApta" parameterClass="seccionNoApta">
   		INSERT INTO ZON_SECCI_NAPT(
   			COD_REGI,
   			COD_ZONA,
   			COD_SECC,
   			FEC_REGI,
   			USU_REGI)
   		VALUES(
   			#codigoRegion#,
   			#codigoZona#,
   			#codigoSeccion#,
        	#auditInfo.created#,
        	#auditInfo.createdBy#)
   </insert>
   
   <select id="getSeccionesByRegionZona" parameterClass="map" resultMap="baseResult">
		select 
		zs.cod_secc CODIGO, 
		zs.des_secci DESCRIPCION
		from zon_regio zr, zon_zona zz, zon_secci zs
		where zr.oid_regi = zz.zorg_oid_regi
		and zz.oid_zona = zs.zzon_oid_zona
		and zr.ind_Acti = '1'
		and zz.ind_Acti = '1'
		and zs.ind_Acti = '1'
		and zr.cod_regi = #codigoRegion#
		and zz.cod_zona = #codigoZona#
   </select>
   
   <delete id="deleteSeccionNoApta">
   		delete from ZON_SECCI_NAPT	
   </delete>
   
   <resultMap id="seccionNoAptaResult" class="seccionNoApta">
      <result property="codigoRegion" 		column="COD_REGI"/>
      <result property="codigoZona" 		column="COD_ZONA" 	/>
      <result property="codigoSeccion" 		column="COD_SECC"/>
      <result property="auditInfo.created" 	column="FEC_REGI"/>
	  <result property="auditInfo.createdBy" column="USU_REGI"/>
   </resultMap>
   
   <select id="getSeccionNoApta" parameterClass="map" resultMap="seccionNoAptaResult">
   		SELECT 
   			COD_REGI,
   			COD_ZONA,
   			COD_SECC,
   			FEC_REGI,
   			USU_REGI
   		FROM ZON_SECCI_NAPT
   		WHERE COD_REGI = #codigoRegion#
   		AND COD_ZONA = #codigoZona#
   		AND COD_SECC = #codigoSeccion#
   </select>
   
   <resultMap id="seccionNoAptaMapResult" class="java.util.HashMap">
      <result property="flagNoApta" 		column="FLAG_NAPT"/>
      <result property="codigoRegion" 		column="COD_REGI"/>
      <result property="codigoZona" 		column="COD_ZONA" 	/>
      <result property="codigoSeccion" 		column="COD_SECC"/>
      <result property="descripcionSeccion"	column="DES_SECCI"/>
   </resultMap>
   
   <select id="getSeccionesAptasNoAptasByCriteria" parameterClass="map" resultMap="seccionNoAptaMapResult">
        select
        (
            select 1 
            from zon_secci_napt zn
            where zn.cod_regi = zr.cod_regi
            and zn.cod_zona = zz.cod_zona        
            and zn.cod_secc = zs.cod_secc
        ) FLAG_NAPT,
        zr.cod_regi,
        zz.cod_zona, 
        zs.cod_secc, 
        zs.des_secci
        from zon_regio zr, zon_zona zz, zon_secci zs 
        where zr.oid_regi = zz.zorg_oid_regi
        and zz.oid_zona = zs.zzon_oid_zona
        and zr.ind_acti = '1'
        and zz.ind_acti = '1'
        and zs.ind_acti = '1'
        and zr.cod_regi = #codigoRegion#
        and zz.cod_zona = #codigoZona#
        order by zs.cod_secc
   </select>
   
   <delete id="deleteSeccionNoAptaById" parameterClass="map">
   		delete from ZON_SECCI_NAPT 
   		where cod_regi = #codigoRegion#
        and cod_zona = #codigoZona# 
        and cod_secc = #codigoSeccion# 
   </delete>
   
   <resultMap id="getRegionesZonasResult" class="java.util.HashMap">
   	<result property="oidRegion" column="OID_REGI"/>
   	<result property="oidZona" column="OID_ZONA"/>
   	<result property="codigoRegion" column="COD_REGI"/>
   	<result property="descRegion" column="DES_REGI"/>
   	<result property="codigoZona" column="COD_ZONA"/>
   	<result property="descZona" column="DES_ZONA"/>
   	<result property="poblacion" column="VAL_POBL"/>
   	<result property="accesoInternet" column="IND_ACCE_INTT"/>
   </resultMap>
	
   <select id="getRegionesZonasList" parameterClass="java.util.Map" resultMap="getRegionesZonasResult">   	
   		select zr.OID_REGI,
   			   zz.OID_ZONA,
   		       zr.COD_REGI,
   		       zr.DES_REGI,
   		       zz.COD_ZONA,
   		       zz.DES_ZONA,
   		       zz.VAL_POBL,
   		       zz.IND_ACCE_INTT
   		from ZON_REGIO zr, ZON_ZONA zz
   		where ZSGV_OID_SUBG_VENT = (SELECT OID_SUBG_VENT 
   		                            FROM ZON_SUB_GEREN_VENTA 
   		                            WHERE pais_oid_pais = Gen_Pkg_Gener.gen_fn_devuelve_id_pais(#codigoPais#)
   		                            AND  cod_subg_vent = #codigoSubGerencia#)
   		<isNotEmpty property="codigoRegion">
   			and zr.cod_regi = #codigoRegion#
   		</isNotEmpty>
   		<isNotEmpty property="codigoZona">
   			and zz.cod_zona = #codigoZona#
   		</isNotEmpty>
   		and zr.oid_regi = zz.zorg_oid_regi
   		and zr.IND_ACTI = 1
   		and zr.IND_BORR = 0
   		and zz.IND_ACTI = 1
		and zz.IND_BORR = 0
   		order by COD_REGI, COD_ZONA   	
   </select>
   	
   <select id="getEncuentraZonaByCodigoZona" parameterClass="java.util.Map" resultClass="integer">
   		SELECT COUNT(1)
		FROM ZON_ZONA
		WHERE ZORG_OID_REGI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_REGION(#codigoPais#,'T','VD', #codigoRegion#)
		AND COD_ZONA = #codigoZona#
   </select>
   
   <insert id="insertZona" parameterClass="java.util.Map">
   		INSERT INTO ZON_ZONA(
   			OID_ZONA,
   			ZORG_OID_REGI,
   			COD_ZONA,
   			IND_ACTI,
   			DES_ZONA,
   			PAIS_OID_PAIS,
   			PERD_OID_PERI_INIC,
   			CANA_OID_CANA,
   			MARC_OID_MARC,
   			IND_BORR,
   			IND_ACCE_INTT
   			)
   		VALUES(
   			ZON_ZZON_SEQ.nextval,
   		    GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_REGION(#codigoPais#,'T','VD', #codigoRegion#),
   		    #codigoZona#,
   		    1,
   		    #descripcionZona#,
   		    GEN_PKG_GENER.gen_fn_devuelve_id_pais(#codigoPais#),
   		    GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodo#),
   		    GEN_PKG_GENER.gen_fn_devuelve_id_canal('VD'),
   		    GEN_PKG_GENER.gen_fn_devuelve_id_marca('T'),
   		    0,
		<isNotEmpty property="accesoInternet">
   		    #accesoInternet#
		</isNotEmpty>
		<isEmpty property="accesoInternet">
   		    0
		</isEmpty>
   		    )
   </insert>
   
   <update id="updateZona" parameterClass="java.util.Map">
   		UPDATE ZON_ZONA
   			SET DES_ZONA = #descripcionZona#,
   			    USU_MODI = #login#
   		<isNotEmpty property="accesoInternet">
			,IND_ACCE_INTT = #accesoInternet#
		</isNotEmpty>
   		<isNotEmpty property="poblacion">
   			,val_pobl = #poblacion#
   		</isNotEmpty>
   		WHERE OID_ZONA = #oidZona#
   </update>
   
   <select id="getUltimoCodigoZona" parameterClass="java.util.Map" resultClass="integer">
   		SELECT NVL(MAX(TO_NUMBER(COD_ZONA)), 0)
			FROM ZON_ZONA
			WHERE ZORG_OID_REGI = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_REGION(#codigoPais#,'T','VD', #codigoRegion#)
   </select>
   
   <select id="getIndicadorEliminarRegion" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(0) 
		FROM ZON_ZONA
		WHERE ZORG_OID_REGI = #oidRegion#
		AND IND_ACTI = '1'
   </select>
   
	<select id="getIndicadorEliminarZona" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(0) 
		FROM ZON_SECCI
		WHERE ZZON_OID_ZONA = #oidZona#
		AND IND_ACTI = '1'	
	</select>
   
   <update id="removeRegion" parameterClass="java.util.Map">
		UPDATE ZON_REGIO
		SET IND_ACTI = '0',
		PERD_OID_PERI_FINA = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodo#)
		WHERE OID_REGI = #oidRegion#
    </update>
   
   <update id="removeZona" parameterClass="java.util.Map">
		UPDATE ZON_ZONA
		SET IND_ACTI = '0',
		PERD_OID_PERI_FINA = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(#codigoPeriodo#)
		WHERE OID_ZONA = #oidZona#
    </update>
   
   <resultMap id="getZonaResult" class="java.util.HashMap">
	   	<result property="oidZona"         		column="OID_ZONA"/>
	   	<result property="codigoSubGerencia"     column="COD_SUBG_VENT"/>
	   	<result property="regionList"    		column="COD_REGI"/>
	   	<result property="codigoZona"      		column="COD_ZONA"/>
	   	<result property="descripcionZona"     	column="DES_ZONA"/>
	   	<result property="accesoInternet"     	column="IND_ACCE_INTT"/>
   </resultMap>
   
   <select id="getZona" parameterClass="integer" resultMap="getZonaResult">
		SELECT
		ZZ.OID_ZONA, 
		SG.COD_SUBG_VENT,
		RG.COD_REGI,
		ZZ.COD_ZONA,
		ZZ.DES_ZONA,
		ZZ.IND_ACCE_INTT 
		FROM ZON_SUB_GEREN_VENTA SG, ZON_REGIO RG, ZON_ZONA ZZ
		WHERE SG.OID_SUBG_VENT = RG.ZSGV_OID_SUBG_VENT 
		AND RG.OID_REGI = ZZ.ZORG_OID_REGI
		AND ZZ.OID_ZONA = #value# 
   </select>
   
   <resultMap id="getDirectorioVentasListResult" class="java.util.HashMap">
	   	<result property="nombre"       column="NOMBRE"/>
	   	<result property="cargo"    	column="desc_tipo"/>
	   	<result property="region"    	column="des_reg"/>
	   	<result property="zona"      	column="des_zona"/>
	   	<result property="campana"     	column="campana_proceso"/>
	   	<result property="fechaIngreso" column="fecha_ingreso"/>
	   	<result property="fechaRegiFin" 				column="fecha_regi_fin"/>
	   	<result property="estado"     	column="estado"/>
	   	<result property="codigoOperacion"     	column="TIOP_COD_TIPO_OPER"/>
	   	<result property="codigoCargo"     		column="TICA_COD_TIPO_CARG"/>
	   	<result property="codigoCliente"     	column="cod_clie"/>
	   	<result property="oidDirecVentDetal"    column="COR_DIVE_DETA"/>
	   	<result property="codigoEstadoCargo"    column="COD_ESTA_CARG"/>
	   	<result property="valorTitular"       	column="VAL_TITU"/>
	   	<result property="estadoLicenciaVigente"       column="est_lice_vige"/>
	   	<result property="estadoReemplazoPorLicencia"  column="est_reem_lice"/>
	   	<result property="aprobacion"  column="APROBACION"/>
	   	<result property="novedad"  column="NOVEDAD"/>
	   	<result property="estadoRegistro"  column="ind_esta"/>
	   	<result property="codigoRegion"  			column="COD_REGI"/>
	   	<result property="codigoZona"  				column="COD_ZONA"/>
	   	<result property="codigoClienteReemplazo"  	column="COD_CLIE_REEM"/>
	   	<result property="fechaRegreso"  			column="fecha_regreso"/>
	   	<result property="codigoSubGerencia"		column="COD_SUBG"/>
	   	<result property="correlativoCabecera"		column="COR_DIRE_VENT"/>
	   	<result property="cantidadUnidadAdministrativa"		column="VAL_CANT_UNID_ADMI"/>
	   	<result property="codigoUnicoBelcorp"    		column="CUB"/>
	   	<result property="rol"							column="ROL"/>
	   	<result property="perfil"						column="PERFIL"/>
	   	<result property="indicadorCargoFuturo"			column="IND_FUTU"/>
   </resultMap>

	<select id="getDirectorioVentasList" parameterClass="java.util.Map" resultMap="getDirectorioVentasListResult">
		SELECT TAB.* FROM (SELECT c.tiop_cod_tipo_oper, c.tica_cod_tipo_carg, c.cod_clie,
		       c.cam_proc campana_proceso,
		       TO_CHAR (d.dica_fec_regi, 'yyyy/mm/dd') fecha_ingreso,
		       k.des_tipo_carg desc_tipo,
		       
		       <isEqual property="codigoConexionExterna" compareValue="FOX">
		       (SELECT TRIM(zdc.val_nom1)||' '||TRIM(zdc.val_nom2)||' '||TRIM(zdc.ape_pate)||' '||TRIM(zdc.ape_mate) 
		        FROM ZON_DIREC_CLIEN zdc
				WHERE zdc.pais_cod_pais = c.pais_cod_pais 
				AND zdc.cod_clie = c.cod_clie) nombre,
				
				(SELECT Z.DES_ZONA
				FROM ZON_DIREC_ZONA Z, ZON_DIREC_REGIO R
				WHERE Z.PAIS_COD_PAIS = R.PAIS_COD_PAIS
				AND Z.REGI_COD_REGI = R.COD_REGI
				AND R.PAIS_COD_PAIS = d.pais_cod_pais
				AND R.COD_REGI = d.cod_regi
				AND Z.COD_ZONA = d.cod_zona) des_zona,
				
				(SELECT R.DES_REGI 
				FROM ZON_DIREC_REGIO R 
				WHERE R.PAIS_COD_PAIS = d.pais_cod_pais 
				AND R.COD_REGI = d.cod_regi) des_reg,
		       </isEqual>
		       
		       <isNotEqual property="codigoConexionExterna" compareValue="FOX">
		       (SELECT TRIM(mc.VAL_NOM1)||' '||TRIM(mc.VAL_NOM2)||' '||TRIM(mc.VAL_APE1)||' '||TRIM(mc.VAL_APE2)
		          FROM mae_clien mc
		         WHERE mc.cod_clie = c.cod_clie) nombre,
		         
		       (SELECT z.des_zona
		          FROM zon_zona z, zon_regio r
		         WHERE z.zorg_oid_regi = r.oid_regi
		           AND r.cod_regi = d.cod_regi
		           AND z.cod_zona = d.cod_zona) des_zona,
		           
		       (SELECT des_regi
		          FROM zon_regio
		         WHERE cod_regi = d.cod_regi) des_reg, 		       
		       </isNotEqual>

		       e.des_esta_carg estado,
		       d.cor_dive_deta,
		       e.cod_esta_carg,
		       k.val_titu,
		       (SELECT COUNT (1)
		          FROM zon_direc_venta_cabec lv
		         WHERE lv.tiop_cod_tipo_oper = 'LI'
		           AND lv.esca_cod_esta_carg = 'IT'
		           AND lv.cod_clie = c.cod_clie
		           AND TO_CHAR (lv.fec_regr, 'yyyymmdd') > TO_CHAR (SYSDATE, 'yyyymmdd')
		           AND lv.est_regi = '1') est_lice_vige,
		       (SELECT COUNT (1)
		          FROM zon_direc_venta_cabec er
		         WHERE er.tiop_cod_tipo_oper = 'RZ'
		           AND er.esca_cod_esta_carg = 'A'
		           AND er.cod_clie = c.cod_clie
		           AND er.est_regi = '1') est_reem_lice,
		           DECODE(c.ind_esta, 'A', 'APROBADO', 'R', 'RECHAZADO', 'G', 'GRABADO') APROBACION,
		           t.des_tipo_oper NOVEDAD,
		           c.ind_esta,
		           d.COD_REGI,
		           d.COD_ZONA,
		           c.COD_CLIE_REEM,
		           TO_CHAR (c.FEC_REGR, 'yyyy/mm/dd') fecha_regreso,
		           d.COD_SUBG,
		           c.cor_dire_vent,
		           k.VAL_CANT_UNID_ADMI,
		           <isEqual property="codigoConexionExterna" compareValue="FOX">
		           	 (SELECT mc.cod_cub 
		           	  FROM ZON_DIREC_CLIEN mc
					  WHERE mc.pais_cod_pais = c.pais_cod_pais
					  AND mc.cod_clie = c.cod_clie) CUB, 
					 (SELECT r.des_rol
                  	  FROM zon_tipo_cargo tcar, zon_direc_rol r
                 	  WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
	                   AND r.cod_rol = tcar.rol_cod_rol
	                   AND c.cor_dire_vent = d.dica_cor_dire_vent
	                   AND c.est_regi = 1) ROL,
               		 (SELECT p.des_perf
                  	  FROM zon_tipo_cargo tcar, zon_direc_perfi p
                 	  WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
	                   AND p.cod_perf = tcar.perf_cod_perf
	                   AND c.cor_dire_vent = d.dica_cor_dire_vent
	                   AND c.est_regi = 1) PERFIL,
		           </isEqual>
		           <isNotEqual property="codigoConexionExterna" compareValue="FOX">
		           (SELECT DA.COD_CUB  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) CUB,
		           (SELECT r.des_rol FROM zon_tipo_cargo tcar, zon_direc_rol r
	 				WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                      and r.cod_rol = tcar.rol_cod_rol) ROL,
               	   (SELECT p.des_perf FROM zon_tipo_cargo tcar, zon_direc_perfi p
	 				WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                      and p.cod_perf = tcar.perf_cod_perf) PERFIL,
		           </isNotEqual>
                   TO_CHAR (c.fec_regi_fin, 'yyyy/mm/dd') fecha_regi_fin,
                   nvl2(k.cod_tipo_carg_base, 'F', 'N') IND_FUTU
		  FROM zon_direc_venta_cabec c, zon_direc_venta_detal d, zon_estat_cargo e, zon_tipo_cargo k, ssicc_comun.zon_tipo_opera t
         WHERE c.pais_cod_pais = d.pais_cod_pais(+)
           AND c.cor_dire_vent = d.dica_cor_dire_vent(+)
           AND c.tiop_cod_tipo_oper = d.tiop_cod_tipo_oper(+)
           AND c.tica_cod_tipo_carg = d.tica_cod_tipo_carg(+)
           AND c.cod_clie = d.cod_clie(+)
           AND TO_CHAR (c.fec_regi, 'dd/mm/yyyy') = TO_CHAR (d.dica_fec_regi(+), 'dd/mm/yyyy')
		   AND c.esca_cod_esta_carg = e.cod_esta_carg
		   AND k.cod_tipo_carg = c.tica_cod_tipo_carg
           AND t.cod_tipo_oper = c.tiop_cod_tipo_oper
           AND (d.est_regi = '1' or d.est_regi is null)    
           AND (c.EST_REGI = '1' or c.est_regi is null)
           and c.pais_cod_pais = #codigoPais#
		 <isNotEmpty property="codigoClienteBuscar" prepend="and">
		 	c.cod_clie = #codigoClienteBuscar#
		 </isNotEmpty>
		 <isNotEmpty property="codigoCargo" prepend="and">
		 	c.tica_cod_tipo_carg = #codigoCargo#
		 </isNotEmpty>
		 <isNotEmpty property="codigoPeriodo" prepend="and">
		 	c.cam_proc = #codigoPeriodo#
		 </isNotEmpty>
		 <isNotEmpty property="codigoRegion" prepend="and">
		 	d.cod_regi = #codigoRegion#
		 </isNotEmpty>
		 <isNotEmpty property="codigoZona" prepend="and">
		 	d.cod_zona = #codigoZona#
		 </isNotEmpty>
		 <isNotEmpty property="indicadorCargoTitular" prepend="and">
		 	k.VAL_TITU = #indicadorCargoTitular#
		 </isNotEmpty>
		 <isNotEmpty property="codigoEstadoRegistro" prepend="and">
		 	c.ESCA_COD_ESTA_CARG = #codigoEstadoRegistro#
		 </isNotEmpty>
		 <isNotEmpty property="codigoNovedad" prepend="and">
		 	t.cod_tipo_oper = #codigoNovedad# 
		 </isNotEmpty>
		 <isNotEmpty property="fechaIngresoDesde" prepend="and">
		 	<![CDATA[
		 	TO_DATE(TO_CHAR(d.dica_fec_regi, 'dd/mm/yyyy'),'dd/mm/yyyy') >= TO_DATE(#fechaIngresoDesde#,'dd/mm/yyyy')
		 	]]>	
		 </isNotEmpty>
		 <isNotEmpty property="fechaIngresoHasta" prepend="and">
		 	<![CDATA[
		 	TO_DATE(TO_CHAR(d.dica_fec_regi, 'dd/mm/yyyy'),'dd/mm/yyyy') <= TO_DATE(#fechaIngresoHasta#,'dd/mm/yyyy')
		 	]]>	
		 </isNotEmpty>
		 <isNotEmpty property="codigoRol" prepend="and">
		 	k.rol_cod_rol = #codigoRol#
		 </isNotEmpty>
		 <isNotEmpty property="codigoPerfil" prepend="and">
		 	k.perf_cod_perf = #codigoPerfil#
		 </isNotEmpty>
		 
		  ) TAB
    	 where 1=1
    	 <isNotEmpty property="cub" prepend="and">
                  TAB.CUB = #cub#
		 </isNotEmpty>
     
		 ORDER BY TAB.COR_DIVE_DETA DESC
   </select>

   <resultMap id="getCargosListResult" class="java.util.HashMap">
	   	<result property="codigoCargo"        			column="COD_TIPO_CARG"/>
	   	<result property="descripcion"    	  			column="DES_TIPO_CARG"/>
	   	<result property="tipoUnidadAdministrativa"    	column="VAL_TIPO_UNID_ADMI"/>
	   	<result property="cantidadUnidadAdministrativa" column="VAL_CANT_UNID_ADMI"/>
	   	<result property="titular"     					column="VAL_TITU"/>
	   	<result property="descripTipoUnidades" 			column="DESC_TIPO_UNI"/>
	   	<result property="descripCantUnidades"     		column="DESC_CANT_UNID_ADMI"/>
	   	<result property="descripCodTitular"     		column="DESC_TITU"/>
	   	<result property="posicion"     		column="rownum"/>
	   	<result property="codigoRol"     				column="ROL_COD_ROL"/>
	   	<result property="codigoPerfil"    				column="PERF_COD_PERF"/>
	   	<result property="indicadorAdmin"    			column="IND_ADMI"/>
	   	<result property="codigoCargoBase"    			column="COD_TIPO_CARG_BASE"/>
   </resultMap>

   <select id="getCargosList" parameterClass="java.util.Map" resultMap="getCargosListResult">
		select 
		rownum, 
		COD_TIPO_CARG, 
		DES_TIPO_CARG,         
		VAL_TIPO_UNID_ADMI,
             DESC_TIPO_UNI,
            VAL_CANT_UNID_ADMI,
             DESC_CANT_UNID_ADMI,
            VAL_TITU,
        DESC_TITU,
		ROL_COD_ROL,
        PERF_COD_PERF,
        IND_ADMI,
        COD_TIPO_CARG_BASE        
        from 
	            (
                select TC.COD_TIPO_CARG,
                        TC.DES_TIPO_CARG,
                        TC.VAL_TIPO_UNID_ADMI,
                        ZR.DES_ROL DESC_TIPO_UNI,
                        TC.VAL_CANT_UNID_ADMI,
                        decode(TC.VAL_CANT_UNID_ADMI, 'U', 'UNO', 'V', 'VARIOS') DESC_CANT_UNID_ADMI,
                        TC.VAL_TITU,
                        ZP.DES_PERF DESC_TITU,
                        TC.ROL_COD_ROL,
                        TC.PERF_COD_PERF,
                        TC.IND_ADMI,
                        TC.COD_TIPO_CARG_BASE
                  from ZON_TIPO_CARGO TC, ZON_DIREC_ROL ZR, ZON_DIREC_PERFI ZP
                  where TC.ROL_COD_ROL = ZR.COD_ROL
                  AND TC.PERF_COD_PERF = ZP.COD_PERF
                  AND TC.EST_REGI = '1'
	            
			      <isNotEmpty property="descripcionCargo">
					AND TC.des_tipo_carg = #descripcionCargo#
			      </isNotEmpty>
			      order by TC.COD_TIPO_CARG)
   </select>
   
   <select id="getCodigoCargosList" parameterClass="java.util.Map" resultMap="baseResult">
   		select ztc.cod_tipo_carg as codigo, 
   			   ztc.cod_tipo_carg||'-'||ztc.des_tipo_carg as descripcion
		from zon_tipo_cargo ztc
		where ztc.cod_tipo_carg_base is null
		and ztc.est_regi = #estado#
		order by cod_tipo_carg, des_tipo_carg asc
   </select>
   
   <resultMap id="getZonDirecVentaCabecResult" 	class="java.util.HashMap">
	   	<result property="codigoOperacion"     	column="TIOP_COD_TIPO_OPER"/>
	   	<result property="codigoCargo"    	   	column="TICA_COD_TIPO_CARG"/>
	   	<result property="codigoCliente"     	column="COD_CLIE"/>
	   	<result property="fechaRegistro" 				column="FEC_REGI"/>
	   	<result property="campanaProceso"     	column="CAM_PROC"/>
	   	<result property="estadoCargo" 			column="ESCA_COD_ESTA_CARG"/>
	   	<result property="motivoLicencia"     	column="MOTI_COD_MOTI_LICE"/>
	   	<result property="codClienteReemplazo"  column="COD_CLIE_REEM"/>
	   	<result property="fecRegreso"     		column="FEC_REGR"/>
	   	<result property="indEstado"     		column="IND_ESTA"/>
	   	<result property="estRegi"     		column="EST_REGI"/>
   </resultMap>
	
	<select id="getZonDirecVentaCabecList" parameterClass="java.util.Map" resultMap="getZonDirecVentaCabecResult">
	            select c.TIOP_COD_TIPO_OPER,
				       c.TICA_COD_TIPO_CARG,
				       c.COD_CLIE,
				       to_char(c.FEC_REGI, 'dd/mm/yyyy') FEC_REGI,
				       c.CAM_PROC,
				       c.ESCA_COD_ESTA_CARG,
				       c.MOTI_COD_MOTI_LICE,
				       c.COD_CLIE_REEM,
				       c.FEC_REGR,
				       c.IND_ESTA,
				       c.EST_REGI
 				from zon_direc_venta_cabec c
 				where c.TIOP_COD_TIPO_OPER = #codigoOperacion#
 				and c.pais_cod_pais = #codigoPais#
				and c.TICA_COD_TIPO_CARG = #codigoCargo#
         		and c.cod_clie = #codigoCliente#
         		and to_char(c.fec_regi, 'yyyy/mm/dd')= #fechaRegistro#
         		
         		<isNotEmpty property="correlativoCabecera">
		 			and   c.cor_dire_vent = #correlativoCabecera#
		 		</isNotEmpty>
         		
   </select>
   
   
      <resultMap id="getZonDirecVentaDetalSoloResult" 	class="java.util.HashMap">
	   	<result property="codigoOperacion"        	column="TIOP_COD_TIPO_OPER"/>
	   	<result property="codigoCargo"    	  		column="TICA_COD_TIPO_CARG"/>
	   	<result property="codigoCliente"    			column="COD_CLIE"/>
	   	<result property="fechaRegistro" 					column="DICA_FEC_REGI"/>
	   	<result property="campanaProceso"     		column="DICA_CAM_PROC"/>
	   	<result property="oidDirecVentDetal" 		column="COR_DIVE_DETA"/>
	   	<result property="codigoSubgerencia"     	column="COD_SUBG"/>
	   	<result property="codigoRegion"     		column="COD_REGI"/>
	   	<result property="codigoZona"     			column="COD_ZONA"/>
	   	<result property="estRegi"     				column="EST_REGI"/>
   </resultMap>
	<select id="getZonDirecVentaDetalSoloList" parameterClass="java.util.Map" resultMap="getZonDirecVentaDetalSoloResult">
	            select d.TIOP_COD_TIPO_OPER,
       				   d.TICA_COD_TIPO_CARG,
       				   d.COD_CLIE,
      				   to_char(d.dica_fec_regi, 'dd/mm/yyyy') DICA_FEC_REGI,
     				   d.DICA_CAM_PROC,
       				   d.COR_DIVE_DETA,
				       d.COD_SUBG,
				       d.COD_REGI,
				       d.COD_ZONA,
				       d.EST_REGI
 				from zon_direc_venta_detal d
                where 1=1
         		<isNotEmpty property="codigoCliente">
		 			and   d.cod_clie = #codigoCliente#
		 		</isNotEmpty>
         		<isNotEmpty property="codigoCargo">
		 			and   d.TICA_COD_TIPO_CARG = #codigoCargo#
		 		</isNotEmpty>
         		
         		<isNotEmpty property="codigoOperacion">
		 			and d.TIOP_COD_TIPO_OPER = #codigoOperacion#
		 		</isNotEmpty>
         		
         		<isNotEmpty property="fechaRegistro">
		 			and to_char(d.dica_fec_regi, 'dd/mm/yyyy')= #fechaRegistro#
		 		</isNotEmpty>
		 		
		 		<isNotEmpty property="campana">
		 			and DICA_CAM_PROC= #campana#
		 		</isNotEmpty>
        </select> 		

	   
      <resultMap id="getZonDirecVentaDetalResult" 	class="java.util.HashMap">
	   	<result property="codigoOperacion"        	column="TIOP_COD_TIPO_OPER"/>
	   	<result property="codigoCargo"    	  		column="TICA_COD_TIPO_CARG"/>
	   	<result property="codigoCliente"    		column="COD_CLIE"/>
	   	<result property="fechaRegistro" 			column="DICA_FEC_REGI"/>
	   	<result property="campanaProceso"     		column="DICA_CAM_PROC"/>
	   	<result property="oidDirecVentDetal" 		column="COR_DIVE_DETA"/>
	   	<result property="codigoSubgerencia"     	column="COD_SUBG"/>
	   	<result property="codigoRegion"     		column="COD_REGI"/>
	   	<result property="codigoZona"     			column="COD_ZONA"/>
	   	<result property="estRegi"     				column="EST_REGI"/>
	   	<result property="descZona"     			column="des_zona"/>
	   	<result property="descRegi"     			column="des_reg"/>
	   	<result property="descCargo"     			column="DES_TIPO_CARG"/>
	    <result property="nombre"    				column="NOMBRE"/>
	   	<result property="docCliente"    			column="descTipDoc"/>
	   	<result property="tipoUnidAdmi"    			column="VAL_TIPO_UNID_ADMI"/>	   	
	   	<result property="correlativoCabecera"    	column="COR_DIRE_VENT"/>	   	
   </resultMap>
	<select id="getZonDirecVentaDetalList" parameterClass="java.util.Map" resultMap="getZonDirecVentaDetalResult">
	            select d.TIOP_COD_TIPO_OPER,
       				   d.TICA_COD_TIPO_CARG,
       				   (SELECT COD_TIPO_CARG || ' - ' || DES_TIPO_CARG	FROM ZON_TIPO_CARGO where COD_TIPO_CARG = d.TICA_COD_TIPO_CARG ) DES_TIPO_CARG ,
       				   d.COD_CLIE,
       				   
       				   <isEqual property="codigoConexionExterna" compareValue="FOX">
				       (SELECT ZDC.APE_PATE||' '||ZDC.APE_MATE||' '||ZDC.VAL_NOM1||' '||ZDC.VAL_NOM2
						FROM ZON_DIREC_CLIEN ZDC
							WHERE ZDC.PAIS_COD_PAIS = c.pais_cod_pais 
							AND ZDC.COD_CLIE = c.cod_clie) NOMBRE,
				       (SELECT ZDC.NUM_DOCU
							FROM ZON_DIREC_CLIEN ZDC
							WHERE ZDC.PAIS_COD_PAIS = c.pais_cod_pais 
							AND ZDC.COD_CLIE = c.cod_clie) descTipDoc,
       				   </isEqual>

       				   <isNotEqual property="codigoConexionExterna" compareValue="FOX">
       				   (select TRIM(MC.VAL_NOM1) || ' ' || TRIM(MC.VAL_APE1) || ' '||TRIM(MC.VAL_APE2) from mae_clien mc where mc.COD_CLIE = d.cod_clie) NOMBRE,
       				   (select i.NUM_DOCU_IDEN from MAE_CLIEN c, MAE_CLIEN_IDENT i  where i.CLIE_OID_CLIE = c.OID_CLIE and c.COD_CLIE = d.cod_clie and i.val_iden_docu_prin = 1) descTipDoc,
       				   </isNotEqual>
       				          				   
      				   to_char(d.dica_fec_regi, 'dd/mm/yyyy') DICA_FEC_REGI,
     				   d.DICA_CAM_PROC,
       				   d.COR_DIVE_DETA,
				       d.COD_SUBG,
				       d.COD_REGI,
				       d.COD_ZONA,
				       d.EST_REGI,

       				   <isEqual property="codigoConexionExterna" compareValue="FOX">
						(SELECT Z.DES_ZONA
						FROM ZON_DIREC_ZONA Z, ZON_DIREC_REGIO R
						WHERE Z.PAIS_COD_PAIS = R.PAIS_COD_PAIS
						AND Z.REGI_COD_REGI = R.COD_REGI
						AND R.PAIS_COD_PAIS = d.pais_cod_pais
						AND R.COD_REGI = d.cod_regi
						AND Z.COD_ZONA = d.cod_zona) des_zona,
						
						(SELECT R.DES_REGI 
						FROM ZON_DIREC_REGIO R 
						WHERE R.PAIS_COD_PAIS = d.pais_cod_pais 
						AND R.COD_REGI = d.cod_regi) des_reg,
       				   </isEqual>

       				   <isNotEqual property="codigoConexionExterna" compareValue="FOX">				       
				        (SELECT z.des_zona
		                  FROM zon_zona z, 
		                       zon_regio r
		                 WHERE z.zorg_oid_regi = r.oid_regi
		                   AND r.cod_regi = d.cod_regi
		                   AND z.cod_zona = d.cod_zona) des_zona,
              		   (select    des_regi from zon_regio where cod_regi = d.cod_regi) des_reg,
              		   </isNotEqual>
              		   
              		   tc.VAL_TIPO_UNID_ADMI,
              		   c.cor_dire_vent
			    FROM zon_direc_venta_cabec c, zon_direc_venta_detal d, zon_tipo_cargo tc
			   WHERE c.cor_dire_vent = d.dica_cor_dire_vent
			   	 AND c.pais_cod_pais = d.pais_cod_pais
			     AND c.tiop_cod_tipo_oper = d.tiop_cod_tipo_oper
			     AND c.tica_cod_tipo_carg = d.tica_cod_tipo_carg
			     AND c.cod_clie = d.cod_clie
			     AND c.fec_regi = d.dica_fec_regi
			     AND c.cam_proc = d.dica_cam_proc
			     AND d.tica_cod_tipo_carg = tc.cod_tipo_carg
         		and  d.est_regi = '1'
				 and c.pais_cod_pais = #codigoPais#

         		<isNotEmpty property="codigoCliente">
		 			and   d.cod_clie = #codigoCliente#
		 		</isNotEmpty>
         		<isNotEmpty property="codigoCargo">
		 			and   d.TICA_COD_TIPO_CARG = #codigoCargo#
		 		</isNotEmpty>
         		
         		<isNotEmpty property="codigoOperacion">
		 			and d.TIOP_COD_TIPO_OPER = #codigoOperacion#
		 		</isNotEmpty>
         		
         		<isNotEmpty property="fechaRegistro">
		 			and to_char(d.dica_fec_regi, 'yyyy/mm/dd')= #fechaRegistro#
		 		</isNotEmpty>
         		
				<isNotEmpty property="oidVentDetal">
		 			and d.COR_DIVE_DETA = #oidVentDetal#
		 		</isNotEmpty>
		 		
		 		<isNotEmpty property="codigoRegion">
		 			and d.COD_REGI = #codigoRegion#
		 		</isNotEmpty>
		 		
		 		<isNotEmpty property="codigoZona">
		 			and d.COD_ZONA = #codigoZona#
		 		</isNotEmpty>

		 		<isNotEmpty property="codigoEstadoCargoRetirarPersonal">
		 			and c.esca_cod_esta_carg = #codigoEstadoCargoRetirarPersonal#
		 		</isNotEmpty>
		 		
         		<isNotEmpty property="correlativoCabecera">
		 			and   c.cor_dire_vent = #correlativoCabecera#
		 		</isNotEmpty>
		 		
		 		order by d.COR_DIVE_DETA desc
   </select>
   
   <resultMap id="getHistoricoListResult" 	class="java.util.HashMap">
	   	<result property="codigoRegion"     		column="COD_REGI"/>
	   	<result property="codigoZona"     			column="COD_ZONA"/>
	   	<result property="descRegi"     			column="des_regi"/>
	   	<result property="descZona"     			column="des_zona"/>
	    <result property="nombre"    				column="NOM_CLIE"/>
	    <result property="codigoCliente"    		column="COD_CLIE"/>
	    <result property="fechaRegistro"    		column="FEC_REGI"/>   
   </resultMap>

   <select id="getHistoricoList" parameterClass="java.util.Map" resultMap="getHistoricoListResult">
        select 
        #codigoRegion# cod_regi, 
        #codigoZona# cod_zona,
        (select r.DES_REGI from zon_regio r where r.pais_oid_pais = z.pais_oid_pais and r.cod_regi = #codigoRegion#) des_regi,
        (
            select n.des_zona from zon_regio r, zon_zona n
            where r.oid_regi = n.ZORG_OID_REGI
            and r.cod_regi = #codigoRegion#
            and n.COD_ZONA = #codigoZona#
        ) des_zona,
        TRIM(M.VAL_NOM1) || ' ' || TRIM(M.VAL_NOM2) || ' ' || TRIM(M.VAL_APE1) || ' ' || TRIM(M.VAL_APE2) AS NOM_CLIE,
        m.cod_clie,
        TO_CHAR(Z.FEC_DESD,'dd/MM/yyyy') FEC_REGI
        from ZON_HISTO_GEREN Z, MAE_CLIEN M
        WHERE z.PAIS_OID_PAIS = m.PAIS_OID_PAIS
        and m.PAIS_OID_PAIS = GEN_PKG_GENER.gen_fn_devuelve_id_pais(#codigoPais#)    
        and Z.GERE = M.COD_CLIE 
        and z.UA = #codigoUA#
        and perd_oid_peri_hast is null
        and rownum = 1   
    </select>

	<select id="getHistoricoListFOX" parameterClass="java.util.Map" resultMap="getHistoricoListResult">
   
		SELECT 
		#codigoRegion# COD_REGI, 
		#codigoZona# COD_ZONA,
		(SELECT R.DES_REGI 
		    FROM ZON_DIREC_REGIO R 
		    WHERE R.PAIS_COD_PAIS = Z.PAIS_COD_PAIS 
		    AND R.COD_REGI = Z.REGI_COD_REGI
		    AND R.COD_REGI = #codigoRegion#) DES_REGI,
		(SELECT ZZ.DES_ZONA
		    FROM ZON_DIREC_ZONA ZZ, ZON_DIREC_REGIO R
		    WHERE ZZ.PAIS_COD_PAIS = R.PAIS_COD_PAIS
		    AND ZZ.REGI_COD_REGI = Z.REGI_COD_REGI
		    AND R.PAIS_COD_PAIS = Z.PAIS_COD_PAIS
		    AND R.COD_REGI = Z.REGI_COD_REGI
		    AND ZZ.COD_ZONA = Z.ZONA_COD_ZONA
		    AND R.COD_REGI = #codigoRegion#
		    AND ZZ.COD_ZONA = #codigoZona# ) DES_ZONA,    
		    M.APE_PATE||' '||M.APE_MATE||' '||M.VAL_NOM1||' '||M.VAL_NOM2 NOM_CLIE,
		    M.COD_CLIE,
		    TO_CHAR(Z.FEC_DESD,'dd/MM/yyyy') FEC_REGI
		FROM ZON_DIREC_HISTO_GEREN Z, ZON_DIREC_CLIEN M
		WHERE Z.PAIS_COD_PAIS = M.PAIS_COD_PAIS
		AND Z.CLIE_COD_CLIE = M.COD_CLIE
		AND Z.PAIS_COD_PAIS = #codigoPais#
		AND Z.UNI_ADMI = #codigoUA#
		AND Z.CAM_HAST IS NULL
		AND ROWNUM = 1
   
   </select>

	<resultMap id="getRegionDisponibleResult" 	class="java.util.HashMap">
	   	<result property="codigo"        	column="cod_regi"/>
	   	<result property="descripcion"    	  		column="des_regi"/>
   </resultMap>

	<select id="getRegionesDisp" resultMap="getRegionDisponibleResult" parameterClass="java.util.Map">	
		SELECT zr.cod_regi
			<isEqual property="codigoCargo" compareValue="GR">
               ,DECODE (zr.clie_oid_clie, NULL, zr.des_regi || ' Disponible',zr.des_regi) des_regi 
			</isEqual>	
			<isEqual property="codigoCargo" compareValue="MVR">
               ,DECODE (zr.clie_oid_clie, NULL, zr.des_regi || ' Disponible',zr.des_regi) des_regi 
			</isEqual>
			<isEqual property="codigoCargo" compareValue="EE">
               ,DECODE (zr.clie_oid_clie, NULL, zr.des_regi || ' Disponible',zr.des_regi) des_regi 
			</isEqual>	
			<isEqual property="codigoCargo" compareValue="GZ">
		       ,decode(nvl(zr.clie_oid_clie, 0)+(select count(*) from zon_zona zz where zz.ZORG_OID_REGI = zr.OID_REGI and zz.CLIE_OID_CLIE is null and zz.IND_ACTI = '1' ), 0, zr.des_regi, zr.des_regi || ' Disponible') des_regi
			</isEqual>
			<isEqual property="codigoCargo" compareValue="MVZ">
		       ,decode(nvl(zr.clie_oid_clie, 0)+(select count(*) from zon_zona zz where zz.ZORG_OID_REGI = zr.OID_REGI and zz.CLIE_OID_CLIE is null and zz.IND_ACTI = '1' ), 0, zr.des_regi, zr.des_regi || ' Disponible') des_regi
			</isEqual>
		  FROM zon_regio zr
		 WHERE zr.ind_acti = 1
		 
		<isNotEmpty property="codigosRegionesAsignadas">	
			<iterate prepend="AND" property="codigosRegionesAsignadas" open=" zr.cod_regi NOT IN (" close=")" conjunction=",">
				#codigosRegionesAsignadas[]#
			</iterate>    
		</isNotEmpty>
		 
         order by zr.cod_regi
	</select>
	
	<select id="getRegionesDispFOX" resultMap="getRegionDisponibleResult" parameterClass="java.util.Map">	
		SELECT zr.cod_regi
			<isEqual property="codigoCargo" compareValue="GR">
               ,DECODE (zr.CLIE_COD_CLIE, NULL, zr.des_regi || ' Disponible',zr.des_regi) des_regi 
			</isEqual>	
			<isEqual property="codigoCargo" compareValue="GZ">
		       ,decode(nvl(zr.CLIE_COD_CLIE, 0)+(select count(*) from ZON_DIREC_ZONA zz where zz.PAIS_COD_PAIS = zr.PAIS_COD_PAIS AND zz.REGI_COD_REGI = zr.COD_REGI and zz.CLIE_COD_CLIE is null and zz.IND_ACTI = '1' ), 0, zr.des_regi, zr.des_regi || ' Disponible') des_regi
			</isEqual>
		  FROM ZON_DIREC_REGIO zr
		 WHERE zr.PAIS_COD_PAIS = #codigoPais#
		 AND zr.ind_acti = '1'
		 
		<isNotEmpty property="codigosRegionesAsignadas">	
			<iterate prepend="AND" property="codigosRegionesAsignadas" open=" zr.cod_regi NOT IN (" close=")" conjunction=",">
				#codigosRegionesAsignadas[]#
			</iterate>    
		</isNotEmpty>
		 
         order by zr.cod_regi
	</select>
	
	<resultMap id="getZonaDisponibleResult" 	class="java.util.HashMap">
	   	<result property="codigo"        			column="cod_zona"/>
	   	<result property="descripcion"    	  		column="des_zona"/>
   </resultMap>
	
	<select id="getZonaDisp" resultMap="getZonaDisponibleResult" parameterClass="java.util.Map">
		SELECT zz.cod_zona,
		       DECODE (zz.clie_oid_clie,
		               NULL, zz.des_zona || ' Disponible',
		               zz.des_zona
		              ) des_zona
		  FROM zon_regio zr, zon_zona zz
		 WHERE zr.oid_regi = zz.zorg_oid_regi
		   AND zz.ind_acti = '1'
		   AND zr.cod_regi = #codigoRegion#
		   
		<isNotEmpty property="codigosZonasAsignadas">	
			<iterate prepend="AND" property="codigosZonasAsignadas" open=" zz.cod_zona NOT IN (" close=")" conjunction=",">
				#codigosZonasAsignadas[]#
			</iterate>    
		</isNotEmpty>
		   
		   ORDER BY zz.cod_zona
   	</select>

   <select id="getZonaDispFOX" resultMap="getZonaDisponibleResult" parameterClass="java.util.Map">
        SELECT 
        ZZ.COD_ZONA,
        DECODE (zz.CLIE_COD_CLIE, NULL, zz.des_zona || ' Disponible', zz.des_zona) DES_ZONA
        FROM ZON_DIREC_REGIO ZR, ZON_DIREC_ZONA ZZ
        WHERE ZR.PAIS_COD_PAIS = ZZ.PAIS_COD_PAIS
        AND ZR.COD_REGI = ZZ.REGI_COD_REGI
        AND ZR.PAIS_COD_PAIS = #codigoPais#
        AND ZR.COD_REGI = #codigoRegion#
        AND ZZ.IND_ACTI = '1'

        <isNotEmpty property="codigosZonasAsignadas">    
            <iterate prepend="AND" property="codigosZonasAsignadas" open=" ZZ.COD_ZONA NOT IN (" close=")" conjunction=",">
                #codigosZonasAsignadas[]#
            </iterate>    
        </isNotEmpty>
           
		ORDER BY ZZ.COD_ZONA
   	</select>

   <resultMap id="unidadesGeograficasResult" class="unidadGeografica">
   	<result property="oidValorEstructuraGeo" column="OID_VALO_ESTR_GEOP"/>
   	<result property="descripcion" column="DES_GEOG"/>
   	<result property="nivel1" column="ORDE_1"/>
   	<result property="nivel2" column="ORDE_2"/>
   	<result property="nivel3" column="ORDE_3"/>
   	<result property="nivel4" column="ORDE_4"/>
   	<result property="estado" column="IND_ACTI"/>
   	<result property="indicadorGeoreferencia" column="IND_GEOR"/>
   </resultMap>
	
   <select id="getUnidadesGeograficasList" parameterClass="java.util.Map" resultMap="unidadesGeograficasResult">   	
   		SELECT OID_VALO_ESTR_GEOP, 
   			   DES_GEOG,
   			   ORDE_1,
   			   ORDE_2,
   			   ORDE_3,
   			   ORDE_4,
   			   IND_ACTI,
   			   IND_GEOR
   		FROM   ZON_VALOR_ESTRU_GEOPO
   		WHERE IND_ACTI = '1'
   		AND IND_BORR = '0'
		<isEmpty prepend="AND" property="orde1" >
		   orde_2 IS NULL AND orde_3 IS NULL AND orde_4 IS NULL
		</isEmpty>
	    <isNotEmpty prepend="AND" property="indicadorDepa">
	       orde_1 = #orde1# AND orde_2 IS NOT NULL AND ORDE_3 IS NULL AND ORDE_4 IS NULL
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="indicadorProv">  
			orde_1 = #orde1# AND orde_2 = #orde2# AND ORDE_3 IS NOT NULL AND ORDE_4 IS NULL
	    </isNotEmpty>
	    <isNotEmpty prepend="AND" property="indicadorDist">
   			orde_1 = #orde1# AND orde_2 = #orde2# AND orde_3 = #orde3# AND ORDE_4 IS NOT NULL
	    </isNotEmpty>
	    ORDER BY DES_GEOG
   </select>   
   
   <select id="getUnidadesGeograficasByCriteria" parameterClass="java.util.Map" resultMap="unidadesGeograficasResult">
   		SELECT OID_VALO_ESTR_GEOP, 
   			   DES_GEOG,
   			   ORDE_1,
   			   ORDE_2,
   			   ORDE_3,
   			   ORDE_4,
   			   IND_ACTI,
               IND_GEOR
   		FROM   ZON_VALOR_ESTRU_GEOPO
   		WHERE OID_VALO_ESTR_GEOP IS NOT NULL
   			<isNotEmpty prepend="AND" property="estado">
   				IND_ACTI = #estado#
   			</isNotEmpty>
			<isNotEmpty prepend="AND" property="oid" >
	   			OID_VALO_ESTR_GEOP = #oid#
	   		</isNotEmpty>
	   		<isNotEmpty prepend="AND" property="orde1" >
	   			ORDE_1 = #orde1#
	   		</isNotEmpty>
	   		<isNotEmpty prepend="AND" property="orde2" >
	   			ORDE_2 = #orde2#
	   		</isNotEmpty>
	   		<isNotEmpty prepend="AND" property="orde3" >
	   			ORDE_3 = #orde3#
	   		</isNotEmpty>
	   		<isNotEmpty prepend="AND" property="orde4" >
	   			ORDE_4 = #orde4#
	   		</isNotEmpty>
	   		<isNotEmpty property="descripcionNivel1" >
				AND ORDE_1 IS NOT NULL
				AND ORDE_2 IS NULL
				AND ORDE_3 IS NULL
				AND ORDE_4 IS NULL
	   			AND DES_GEOG = #descripcionNivel1#
	   		</isNotEmpty>
	   		<isNotEmpty property="descripcionNivel2" >
				AND ORDE_1 IS NOT NULL
				AND ORDE_2 IS NOT NULL
				AND ORDE_3 IS NULL
				AND ORDE_4 IS NULL
	   			AND DES_GEOG = #descripcionNivel2#
	   		</isNotEmpty>
	   		<isNotEmpty property="descripcionNivel3" >
				AND ORDE_1 IS NOT NULL
				AND ORDE_2 IS NOT NULL
				AND ORDE_3 IS NOT NULL
				AND ORDE_4 IS NULL
	   			AND DES_GEOG = #descripcionNivel3#
	   		</isNotEmpty>
	   		<isNotEmpty property="descripcionNivel4" >
				AND ORDE_1 IS NOT NULL
				AND ORDE_2 IS NOT NULL
				AND ORDE_3 IS NOT NULL
				AND ORDE_4 IS NOT NULL
	   			AND DES_GEOG = #descripcionNivel4#
	   		</isNotEmpty>
	   		<isNotEmpty property="indicadorActualizar" prepend="AND">
				<![CDATA[
						OID_VALO_ESTR_GEOP <> #oidUnidadGeografica#
				]]>	
	   		</isNotEmpty>
        ORDER BY 
        ORDE_1 NULLS FIRST ,
        ORDE_2 NULLS FIRST ,
        ORDE_3 NULLS FIRST ,
        ORDE_4 NULLS FIRST
   
   </select>
   
   <select id="getUnidadesGeograficasValidar" parameterClass="java.util.Map" resultMap="unidadesGeograficasResult">
   		SELECT OID_VALO_ESTR_GEOP, 
   			   DES_GEOG,
   			   ORDE_1,
   			   ORDE_2,
   			   ORDE_3,
   			   ORDE_4,
   			   IND_ACTI,
               IND_GEOR
   		FROM   ZON_VALOR_ESTRU_GEOPO
   		WHERE OID_VALO_ESTR_GEOP IS NOT NULL
   			<isNotEmpty property="descripcionNivel1" >
				AND ORDE_1 = #nivel1#
	   			AND DES_GEOG = #descripcionNivel1#
	   		</isNotEmpty>
	   		<isNotEmpty property="descripcionNivel2" >
				AND ORDE_1 = #nivel1#
				AND ORDE_2 IS NOT NULL
	   			AND DES_GEOG = #descripcionNivel2#
	   		</isNotEmpty>
	   		<isNotEmpty property="descripcionNivel3" >
				AND ORDE_1 = #nivel1#
				AND ORDE_2 = #nivel2#
				AND ORDE_3 IS NOT NULL
				AND DES_GEOG = #descripcionNivel3#
	   		</isNotEmpty>
	   		<isNotEmpty property="descripcionNivel4" >
				AND ORDE_1 = #nivel1#
				AND ORDE_2 = #nivel2#
				AND ORDE_3 = #nivel3#
				AND ORDE_4 IS NOT NULL
				AND DES_GEOG = #descripcionNivel4#
	   		</isNotEmpty>
	   
   </select>
   
   <select id="getEstructuraGeopoliticaList" resultMap="estructuraGeopoliticaResult">
        SELECT
        EG.OID_ESTR_GEOP,
        EG.COD_ORDE,
        EG.IND_BORR,
        EG.PAIS_OID_PAIS,
        EG.DIPO_OID_DIVI_POLI,
        TO_CHAR(EG.FEC_ACTU, 'DD/MM/YYYY') FEC_ACTU,
        SC.VAL_I18N DESCRIPCION
        FROM ZON_ESTRU_GEOPO EG, GEN_I18N_SICC_COMUN SC 
        WHERE EG.DIPO_OID_DIVI_POLI = SC.VAL_OID
        AND SC.ATTR_ENTI = 'ZON_NIVEL_GEOGR'
        ORDER BY COD_ORDE
   </select>
   
    <select id="getCodigoSiguienteUnidadGeografica" resultClass="java.lang.Integer">
    	SELECT NVL(MAX(COD_UNID_GEOG), 1) + 1 
    	FROM  ZON_VALOR_ESTRU_GEOPO
	</select>
   
   <insert id="insertUnidadGeografica" parameterClass="unidadGeografica">
		INSERT INTO ZON_VALOR_ESTRU_GEOPO(
		    OID_VALO_ESTR_GEOP,
		    COD_UNID_GEOG,
		    DES_GEOG,
		    IND_ACTI,
		    IND_BORR,
		    ORDE_1,
		    ORDE_2,
		    ORDE_3,
		    ORDE_4,
		    EGEO_OID_ESTR_GEOP,
		    PAIS_OID_PAIS,
		    SGEO_OID_SUBE_GEOP,
		    IND_GEOR,
		    USU_MODI,
		    FEC_ACTU)
		VALUES(
		    ZON_VEPO_SEQ.NEXTVAL,
		    #codigoOrdenEstruGeopo#,
		    #descripcion#,
		    '1',
		    '0',
		    #nivel1#,
		    #nivel2#,
		    #nivel3#,
		    #nivel4#,
		    #oidEstruGeopo#,
		    GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#),
		    (SELECT oid_sube_geop FROM ZON_SUBES_GEOPO WHERE egeo_oid_estr_geop = #oidEstruGeopo# and rownum = 1),
		    #indicadorGeoreferencia#,
        	#auditInfo.createdBy#, 
        	#auditInfo.created#)
   </insert>
   
   <update id="updateUnidadGeografica" parameterClass="unidadGeografica">
   		UPDATE ZON_VALOR_ESTRU_GEOPO
   		SET DES_GEOG = #descripcion#,
   		IND_GEOR = #indicadorGeoreferencia#,
        USU_MODI = #auditInfo.updatedBy#, 
        FEC_ACTU = #auditInfo.lastUpdated#    		
   		WHERE OID_VALO_ESTR_GEOP = #oidValorEstructuraGeo#
   </update>
	
	<resultMap  id="getCantidadTerritoriosByUnidadGeograficaResult" class="baseGenericoZON">
		<result property="codigo" 		column="COD_TERR" 	 />
		<result property="descripcion" 	column="IND_BORR" />
	</resultMap>
	<select id="getCantidadTerritoriosByUnidadGeografica" parameterClass="string" resultMap="getCantidadTerritoriosByUnidadGeograficaResult">
		SELECT COD_TERR, IND_BORR FROM ZON_TERRI 
		WHERE VEPO_OID_VALO_ESTR_GEOP = #value# 
	</select>

	<select id="getCantidadUnidadesGeograficasByNivel" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(*)
		FROM zon_valor_estru_geopo
		WHERE ind_acti = '1'
		AND IND_BORR = '0'
		
		<isEqual property="nivel" compareValue="2">
		   AND orde_1 = #nivel1#       
		   AND orde_2 IS NOT NULL 
		</isEqual>
		<isEqual property="nivel" compareValue="3">
		   AND orde_1 = #nivel1#       
		   AND orde_2 = #nivel2#
		   AND orde_3 IS NOT NULL
		</isEqual>
		<isEqual property="nivel" compareValue="4">
		   AND orde_1 = #nivel1#       
		   AND orde_2 = #nivel2#
		   AND orde_3 = #nivel3#
		   AND orde_4 IS NOT NULL
		</isEqual>
		<isEqual property="nivel" compareValue="5">
		   AND orde_1 = #nivel1#       
		   AND orde_2 = #nivel2#
		   AND orde_3 = #nivel3#
		   AND orde_4 = #nivel4#
		   AND orde_5 IS NOT NULL
		</isEqual>
		
	</select>

   	<update id="removeUnidadGeografica" parameterClass="unidadGeografica">
   		UPDATE ZON_VALOR_ESTRU_GEOPO
   		SET IND_ACTI = '0',
   		IND_BORR = '1' 
   		WHERE OID_VALO_ESTR_GEOP = #oidValorEstructuraGeo#
   	</update>

   	<update id="deleteUnidadGeografica" parameterClass="unidadGeografica">
   		DELETE FROM ZON_VALOR_ESTRU_GEOPO
   		WHERE OID_VALO_ESTR_GEOP = #oidValorEstructuraGeo#
   	</update>

   <!-- RCR -->
	<select id="obtenerDatosConsultora" parameterClass="java.util.Map" resultClass="string">
		SELECT c.VAL_NOM1 || ' '|| c.VAL_NOM2||' '|| c.VAL_APE1 ||' '|| c.VAL_APE2||'_'|| ci.NUM_DOCU_IDEN 
			FROM MAE_CLIEN c, MAE_CLIEN_IDENT ci
			where C.OID_CLIE = ci.CLIE_OID_CLIE 
			and ci.VAL_IDEN_DOCU_PRIN = 1 
			AND c.COD_CLIE = #codigoConsultora#	
	</select>
	
	<select id="obtenerDatosConsultoraFOX" parameterClass="java.util.Map" resultClass="string">
		SELECT  
        	C.APE_PATE||' '||C.APE_MATE||' '||C.VAL_NOM1||' '||C.VAL_NOM2||'_'||C.NUM_DOCU
		FROM ZON_DIREC_CLIEN C
        WHERE C.PAIS_COD_PAIS = #codigoPais#
        AND C.COD_CLIE = #codigoConsultora#
	</select>
	
	<select id="obtenerDatosConsultoraAsignarCargo" parameterClass="java.util.Map" resultMap="baseResult">
			SELECT  '' CODIGO, 
					 c.val_nom1
			       || ' '
			       || c.val_nom2
			       || ' '
			       || c.val_ape1
			       || ' '
			       || c.val_ape2
			       || '_'
			       || ci.num_docu_iden
			       || '_'
			       || d.ind_esta
			       || '_'
			       || d.esca_cod_esta_carg 
				   || '_' 
				   || d.est_regi DESCRIPCION
			  FROM mae_clien c, mae_clien_ident ci, zon_direc_venta_cabec d, mae_clien_datos_adici da
			 WHERE c.oid_clie = ci.clie_oid_clie
			   AND c.cod_clie = d.cod_clie(+)
			   AND ci.val_iden_docu_prin = 1
			   AND c.cod_clie = #codigoConsultora#
			   AND c.pais_oid_pais = Gen_Pkg_Gener.gen_fn_devuelve_id_pais(#codigoPais#)
			   AND (d.est_regi = '1' OR d.est_regi = '1' OR d.est_regi IS NULL)
			   AND c.oid_clie = da.clie_oid_clie
         	   AND da.ind_acti = 1
			   ORDER BY LENGTH(d.esca_cod_esta_carg) DESC, d.esca_cod_esta_carg
	</select>

	<select id="obtenerDatosConsultoraAsignarCargoFOX" parameterClass="java.util.Map" resultMap="baseResult">	
			SELECT  '' CODIGO, 
					 c.ape_pate||' '||c.ape_mate||' '||c.val_nom1||' '||c.val_nom2
			       || '_'
			       || c.num_docu
			       || '_'
			       || d.ind_esta
			       || '_'
			       || d.esca_cod_esta_carg
				   || '_'
             	   || d.est_regi DESCRIPCION	
			    FROM ZON_DIREC_CLIEN c, ZON_DIREC_VENTA_CABEC d
			    WHERE c.PAIS_COD_PAIS = d.pais_cod_pais(+)
                AND c.cod_clie = d.cod_clie(+)             
			    AND c.cod_clie = #codigoConsultora#
                AND c.pais_cod_pais = #codigoPais#               
                AND c.ind_acti =1               
			    AND (d.est_regi = '1' OR d.est_regi = '9' OR d.est_regi IS NULL)
			   ORDER BY LENGTH(d.esca_cod_esta_carg) DESC, d.esca_cod_esta_carg
	</select>
	
	<select id="getVerificarCargoTitular" parameterClass="java.util.Map" resultClass="string">
		SELECT VAL_CANT_UNID_ADMI || '|'||VAL_TITU|| '|'||VAL_TIPO_UNID_ADMI
		FROM ZON_TIPO_CARGO 
			WHERE COD_TIPO_CARG = #codigoCargo# 
			AND EST_REGI = '1' 
	</select>
		
	<select id="getObtenerGerentexTipo" parameterClass="java.util.Map" resultClass="string">
		SELECT mae.CLIE_OID_CLIE
		  FROM MAE_CLIEN_TIPO_SUBTI mae, MAE_TIPO_CLIEN tipo, mae_clien a, MAE_SUBTI_CLIEN stip
			WHERE mae.TICL_OID_TIPO_CLIE= tipo.OID_TIPO_CLIE
           AND mae.SBTI_OID_SUBT_CLIE = stip.OID_SUBT_CLIE
           and mae.TICL_OID_TIPO_CLIE = stip.TICL_OID_TIPO_CLIE
		   AND mae.CLIE_OID_CLIE = a.oid_clie           
		   AND a.PAIS_OID_PAIS = Gen_Pkg_Gener.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#)            
		   AND a.cod_clie = #codigoConsultora#
			AND tipo.COD_TIPO_CLIE = '04'
		   <isNotEmpty prepend="AND" property="codigoSubTipoCliente">
           		stip.COD_SUBT_CLIE = #codigoSubTipoCliente#		   
		   </isNotEmpty>
	</select>
	
	<select id="getObtenerGerentexTipoFOX" parameterClass="java.util.Map" resultClass="string">	
		SELECT c.COD_CLIE
		  FROM ZON_DIREC_CLIEN c
		WHERE c.PAIS_COD_PAIS = #codigoPais#
            AND c.COD_CLIE = #codigoConsultora#
			AND c.COD_TIPO_CLIE = '04'
			<isNotEmpty prepend="AND" property="codigoSubTipoCliente">
				c.COD_SUBT_CLIE = #codigoSubTipoCliente#
			</isNotEmpty>
	</select>
	
	<select id="getExisteUsuarioDirectorioVenta" parameterClass="java.util.Map" resultClass="string">
		SELECT COR_DIRE_VENT 
		FROM ZON_DIREC_VENTA_CABEC
			WHERE TICA_COD_TIPO_CARG = #codigoTipoCargo#
			AND COD_CLIE = #codigoConsultora#
			AND FEC_REGI = TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')
	</select>
	
	<resultMap id="obtenerDirectorioVentaCabeceraResult" class="java.util.HashMap">
		<result property="pais"							column="pais_cod_pais"/>
	   	<result property="codigoTipoOper"				column="tiop_cod_tipo_oper"/>
	   	<result property="codigoTipoCargo"    			column="tica_cod_tipo_carg"/>
	   	<result property="codigoClie"				    column="cod_clie"/>
	   	<result property="fechaRegistro"				column="fec_regi"/>
	   	<result property="campaniaProc"				    column="cam_proc"/>
	   	<result property="estadoCargo"				    column="esca_cod_esta_carg"/>
	   	<result property="motivoLicen"				    column="moti_cod_moti_lice"/>
	   	<result property="codigoClieReem"				column="cod_clie_reem"/>
	   	<result property="fechaRegreso"				    column="fec_regr"/>
	   	<result property="fechaVenta"				    column="fec_vent"/>
	   	<result property="fechaFactu"				    column="fec_fact"/>
	   	<result property="fechaRegiFin"				    column="fec_regi_fin"/>
	   	<result property="indNovedad"				    column="ind_nove"/>
    </resultMap>
    
	<select id="obtenerDirectorioVentaCabecera" parameterClass="java.util.Map" resultMap="obtenerDirectorioVentaCabeceraResult">
		select  zc.pais_cod_pais, zc.tiop_cod_tipo_oper, zc.tica_cod_tipo_carg, zc.cod_clie, zc.fec_regi, zc.cam_proc,
				zc.esca_cod_esta_carg, zc.moti_cod_moti_lice, zc.cod_clie_reem, 
				zc.fec_regr, zc.fec_vent, zc.fec_fact, zc.fec_regi_fin, zc.ind_nove
				from zon_direc_venta_cabec zc
				where  zc.cor_dire_vent = #correlativoCabecera#
				and zc.est_regi = #estadoRegistro#
				and zc.ind_esta = #indicadorEstado#
	</select>
	
	<insert id="insertDirectorioVentaCabecera" parameterClass="java.util.Map">
		INSERT INTO ZON_DIREC_VENTA_CABEC(
			PAIS_COD_PAIS,
			TIOP_COD_TIPO_OPER,
			TICA_COD_TIPO_CARG,
			COD_CLIE,
			FEC_REGI,
			CAM_PROC,
			ESCA_COD_ESTA_CARG,
			MOTI_COD_MOTI_LICE,
			COD_CLIE_REEM,
			FEC_REGR,
			IND_ESTA,
			USU_CREA,
			FEC_CREA,
			EST_REGI,
			COR_DIRE_VENT,
			FEC_VENT,
			FEC_FACT,
			FEC_REGI_FIN
			)VALUES(
			#codigoPais#,
			#tipoOperacion#,
			#codigoTipoCargo#,
			#codigoConsultora#,
			TO_DATE(#fechaIngreso#, 'DD/MM/YYYY'),
			
			<isEqual property="codigoConexionExterna" compareValue="FOX">
				GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#,TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')),
			</isEqual>
			
			<isNotEqual property="codigoConexionExterna" compareValue="FOX">
				GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA2(#codigoPais#,'T','VD', #fechaIngreso#),
			</isNotEqual>

			#codigoEstadoCargo#,
			<isNotEmpty property="tipoLicencia">
				#tipoLicencia#,
			</isNotEmpty>
			<isEmpty property="tipoLicencia">
				NULL,
			</isEmpty>
			<isNotEmpty property="codigoConsultoraReemplazante">
				#codigoConsultoraReemplazante#,
			</isNotEmpty>
			<isEmpty property="codigoConsultoraReemplazante">
				NULL,
			</isEmpty>
			<isNotEmpty property="fechaRegreso">
				TO_DATE(#fechaRegreso#, 'DD/MM/YYYY'),
			</isNotEmpty>
			<isEmpty property="fechaRegreso">
				NULL,
			</isEmpty>
			'A',
			#usuarioLogin#,
			SYSDATE,
			#estadoRegistro#,
			#correlativoCabecera#,
			<isNotEmpty property="fechaVenta">
			TO_DATE(#fechaVenta#, 'DD/MM/YYYY'),
			</isNotEmpty>
			<isEmpty property="fechaVenta">
				NULL,
			</isEmpty>
			<isNotEmpty property="fechaFacturacion">
			TO_DATE(#fechaFacturacion#, 'DD/MM/YYYY'),
			</isNotEmpty>
			<isEmpty property="fechaFacturacion">
				NULL,
			</isEmpty>
			<isNotEmpty property="fechaIngresoHasta">
			TO_DATE(#fechaIngresoHasta#, 'DD/MM/YYYY'))	
			</isNotEmpty>
			<isEmpty property="fechaIngresoHasta">
				NULL)
			</isEmpty>
	</insert>
	
	<insert id="insertDirectorioVentaDetalle" parameterClass="java.util.Map">
		INSERT INTO ZON_DIREC_VENTA_DETAL(
			PAIS_COD_PAIS,
			TIOP_COD_TIPO_OPER,
			TICA_COD_TIPO_CARG,
			COD_CLIE,
			DICA_FEC_REGI,
			DICA_CAM_PROC,
			COR_DIVE_DETA,
			COD_SUBG,
			COD_REGI,
			COD_ZONA,
			USU_CREA,
			FEC_CREA,
			EST_REGI,
			DICA_COR_DIRE_VENT)
			VALUES(
			#codigoPais#,
			#tipoOperacion#,
			#codigoTipoCargo#,
			#codigoConsultora#,
			TO_DATE(#fechaIngreso#, 'DD/MM/YYYY'),
			
			<isEqual property="codigoConexionExterna" compareValue="FOX">
				GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#,TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')),
			</isEqual>

			<isNotEqual property="codigoConexionExterna" compareValue="FOX">
				GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA2(#codigoPais#,'T','VD', #fechaIngreso#),
			</isNotEqual>
			
			ZON_SEQ_DIREC_VENTA_DETAL.nextval,
			#codigoSubGerencia#,
			#codigoRegion#,
			#codigoZona#,
			#usuarioLogin#,
			SYSDATE,
			#estadoRegistro#,
			#correlativoCabecera#)
	</insert>
	
	<update id="updateDirectorioVentaCabecera" parameterClass="java.util.Map">
		UPDATE ZON_DIREC_VENTA_CABEC
		SET USU_MODI = #usuarioLogin#,
			FEC_MODI = SYSDATE
			<isNotEmpty property="estadoRegistro">
				,EST_REGI = #estadoRegistro#
			</isNotEmpty>		    
			<isNotEmpty property="codigoEstadoCargo">
				,ESCA_COD_ESTA_CARG = #codigoEstadoCargo#
			</isNotEmpty>		    
			<isNotEmpty property="codigoConsultoraReemplazanteLicencia">
				,COD_CLIE_REEM = #codigoConsultoraReemplazanteLicencia#
			</isNotEmpty>
			<isNotEmpty property="tipoLicencia">
				,MOTI_COD_MOTI_LICE = #tipoLicencia#
			</isNotEmpty>
			<isNotEmpty property="tipoOperacionLicencia">
				,TIOP_COD_TIPO_OPER = #tipoOperacionLicencia#
			</isNotEmpty>	
			<isNotEmpty property="fechaRegreso">
				,FEC_REGR = TO_DATE(#fechaRegreso#,'DD/MM/YYYY')
			</isNotEmpty>
			<isNotEmpty property="fechaIngresoHasta">
				,FEC_REGI_FIN = TO_DATE(#fechaIngresoHasta#,'DD/MM/YYYY')
			</isNotEmpty>
		WHERE COD_CLIE = #codigoConsultora#
		AND PAIS_COD_PAIS = #codigoPais#
			<isNotEmpty property="correlativoCabecera">
				AND COR_DIRE_VENT = #correlativoCabecera#
			</isNotEmpty>		
		    <isNotEmpty property="fechaIngreso">
		      	AND TO_CHAR(FEC_REGI, 'DD/MM/YYYY') = #fechaIngreso#
		    </isNotEmpty>
		      	AND TICA_COD_TIPO_CARG = #codigoTipoCargo#
		<isNotEmpty property="tipoOperacion">
		 AND TIOP_COD_TIPO_OPER =#tipoOperacion#
		 </isNotEmpty>
	</update>
	
	<resultMap  id="getDirectorioVentaCabeceraActivoResult" class="java.util.HashMap">
		<result property="codigoCliente" 		column="COD_CLIE"/>
		<result property="codigoTipoCargo" 		column="TICA_COD_TIPO_CARG" />
		<result property="estadoTipoCargo" 		column="ESCA_COD_ESTA_CARG" />
		<result property="fechaRegistro" 		column="FEC_REGI" />
		<result property="correlativoCabecera" 	column="COR_DIRE_VENT" />
		<result property="fechaRegistroFin" 	column="FEC_REGI_FIN" />
	</resultMap>
	
	<select id="getDirectorioVentaCabeceraActivo" parameterClass="java.util.Map" resultMap="getDirectorioVentaCabeceraActivoResult">
		SELECT COD_CLIE	,
			   TICA_COD_TIPO_CARG,
			   ESCA_COD_ESTA_CARG,
			   FEC_REGI,
			   COR_DIRE_VENT,
			   FEC_REGI_FIN	
		FROM ZON_DIREC_VENTA_CABEC				    
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND COD_CLIE = #codigoConsultora#		      
		      AND TICA_COD_TIPO_CARG = #codigoTipoCargo#
		      
			<isNotEmpty property="correlativoCabecera">
				AND COR_DIRE_VENT = #correlativoCabecera#
			</isNotEmpty>
					
		      AND ESCA_COD_ESTA_CARG IN ('A', 'IT')
		ORDER BY FEC_REGI DESC
	</select>
	
	<update id="updateDirectorioVentaDetalle" parameterClass="java.util.Map">
		UPDATE ZON_DIREC_VENTA_DETAL set
				<isNotEmpty property="codigoRegion">
				COD_REGI = #codigoRegion#,
				</isNotEmpty>
				<isNotEmpty property="codigoZona">
				COD_ZONA = #codigoZona#,
				</isNotEmpty>
				USU_MODI = #usuarioLogin#,
				FEC_MODI = SYSDATE,
				EST_REGI = #estadoRegistro#
		WHERE 
				TICA_COD_TIPO_CARG = #codigoTipoCargo#
				AND COD_CLIE = #codigoConsultora#
				AND TO_char(DICA_FEC_REGI, 'DD/MM/YYYY') = #fechaIngreso#
				AND DICA_CAM_PROC = #campanyaProceso#
				<isNotEmpty property="codigoDetalle">
				AND COR_DIVE_DETA = #codigoDetalle#
				</isNotEmpty>
				AND TIOP_COD_TIPO_OPER =#tipoOperacion#  
				AND DICA_COR_DIRE_VENT = #correlativoCabecera#
	</update>
	
	<select id="getValidaRegionxZona" parameterClass="java.util.Map" resultClass="integer" >
		SELECT COUNT(1) FROM ZON_ZONA zz 
			WHERE zz.ZORG_OID_REGI = (SELECT zr.OID_REGI FROM ZON_REGIO zr WHERE zr.COD_REGI = #codigoRegion#) 
			AND zz.COD_ZONA = #codigoZona#
	</select>
	
	<select id="getValidaRegionxZonaFOX" parameterClass="java.util.Map" resultClass="integer" >
		SELECT COUNT(1)
		FROM ZON_DIREC_REGIO ZR, ZON_DIREC_ZONA ZZ
		WHERE ZR.PAIS_COD_PAIS = ZZ.PAIS_COD_PAIS
		AND ZR.COD_REGI = ZZ.REGI_COD_REGI
		AND ZR.PAIS_COD_PAIS = #codigoPais#
		AND ZR.COD_REGI = #codigoRegion#
		AND ZZ.COD_ZONA = #codigoZona#
	</select>
	
	<select id="getValidarRegistroExiste" parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT (1) 
        FROM ZON_DIREC_VENTA_DETAL
        WHERE TIOP_COD_TIPO_OPER = 'IN'
			AND COD_CLIE = #codigoConsultora#
			AND DICA_FEC_REGI = TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')
			AND DICA_CAM_PROC = #campanyaProceso#
			AND COR_DIVE_DETA = #codigoDetalle#
		AND DICA_COR_DIRE_VENT = #correlativoCabecera#
			AND ROWNUM = 1
	</select>
	
	<resultMap  id="getValidaEstadoCargoResult" class="java.util.HashMap">
		<result property="codigoEstadoCargo" 	column="ESCA_COD_ESTA_CARG"/>
		<result property="estadoRegistro" 		column="IND_ESTA" />
	</resultMap>
	<select id="getValidaEstadoCargo" parameterClass="java.util.Map" resultMap="getValidaEstadoCargoResult">
		SELECT 
		ESCA_COD_ESTA_CARG,
		IND_ESTA 
		FROM ZON_DIREC_VENTA_CABEC
			WHERE COD_CLIE = #codigoConsultora#
			AND PAIS_COD_PAIS = #codigoPais#
			AND ROWNUM = 1
			ORDER BY FEC_REGI DESC
	</select>
	
	<resultMap id="getObtenerDatosCorreosResult" class="java.util.HashMap">
	   	<result property="emailUsuarioAprobado" 		column="VAL_EMAI_USUA_APRO"/>
	   	<result property="emailOrigen"    	  			column="VAL_EMAI_ORIG"/>
	   	<result property="emailListDestino"    			column="VAL_EMAI_LIST_DEST"/>
	   	<result property="valorAsunto" 					column="VAL_ASUN"/>
	   	<result property="ValorMensaje"					column="VAL_MENS"/>
   </resultMap>
	
	<select id="getObtenerDatosCorreos" parameterClass="java.util.Map" resultMap="getObtenerDatosCorreosResult">
		SELECT VAL_EMAI_USUA_APRO, 
			   VAL_EMAI_ORIG, 
			   VAL_EMAI_LIST_DEST, 
			   VAL_ASUN,  
			   VAL_MENS 
			FROM ZON_DIREC_PARAM_RUTAS 
			WHERE PAIS_COD_PAIS = #codigoPais# 
			AND TIOP_COD_TIPO_OPER = #tipoOperacion#
			AND EST_REGI = '1'
	</select>
	
	<resultMap id="obtenerDirectorioVentaDetalleResult" class="java.util.HashMap">
	   	<result property="codigoCliente" 		column="COD_CLIE"/>
	   	<result property="codigoCargo"    	  	column="COD_CARGO"/>
	   	<result property="fechaRegistro"    	column="DICA_FEC_REGI"/>
	   	<result property="unidadAdministrativa" column="UA_ZONA"/>
	   	<result property="codigoSubGerencia"	column="COD_SUBG"/>
	   	<result property="codigoZona" 			column="COD_ZONA"/>
	   	<result property="codigoRegion" 		column="COD_REGI"/>
	   	<result property="descripcionRegion" 	column="des_regi"/>
   </resultMap>
	
	<select id="obtenerDirectorioVentaDetalle" parameterClass="java.util.Map" resultMap="obtenerDirectorioVentaDetalleResult">
		SELECT 
		d.cod_clie, 
		c.cod_tipo_carg || ' - ' || c.des_tipo_carg cod_cargo,
		       TO_CHAR (d.dica_fec_regi, 'dd/mm/yyyy') dica_fec_regi,
		
		<isEqual property="codigoConexionExterna" compareValue="FOX">
			(SELECT Z.DES_ZONA
			FROM ZON_DIREC_ZONA Z, ZON_DIREC_REGIO R
			WHERE Z.PAIS_COD_PAIS = R.PAIS_COD_PAIS
			AND Z.REGI_COD_REGI = R.COD_REGI
			AND R.PAIS_COD_PAIS = d.pais_cod_pais
			AND R.COD_REGI = d.cod_regi
			AND Z.COD_ZONA = d.cod_zona) ua_zona,
			d.cod_subg, 
			d.cod_regi, 
			d.cod_zona,
			(SELECT R.DES_REGI 
			FROM ZON_DIREC_REGIO R 
			WHERE R.PAIS_COD_PAIS = d.pais_cod_pais 
			AND R.COD_REGI = d.cod_regi) des_regi
		</isEqual>

		<isNotEqual property="codigoConexionExterna" compareValue="FOX">
		       (SELECT zz.des_zona
		          FROM zon_zona zz, zon_regio zr
		         WHERE zz.zorg_oid_regi = zr.oid_regi
		           AND zz.cod_zona = d.cod_zona) ua_zona,
			d.cod_subg, 
			d.cod_regi, 
			d.cod_zona,
		       (SELECT zr.des_regi
		          FROM zon_regio zr
		         WHERE zr.cod_regi = d.cod_regi) des_regi
		</isNotEqual>

			FROM ZON_DIREC_VENTA_DETAL d, ZON_TIPO_CARGO c
			WHERE d.TICA_COD_TIPO_CARG = c.COD_TIPO_CARG
		AND d.PAIS_COD_PAIS = #codigoPais#
			AND d.TIOP_COD_TIPO_OPER = #tipoOperacion#
			AND d.TICA_COD_TIPO_CARG = #codigoCargo#
			AND d.COD_CLIE = #codigoCliente#
			AND to_char(d.DICA_FEC_REGI, 'yyyy/mm/dd') = #fechaRegistro#
			AND d.DICA_CAM_PROC = #campanaProceso#
			AND d.COR_DIVE_DETA = #numDetalle#
			AND d.dica_cor_dire_vent = #correlativoCabecera#
	</select>
	
	<select id="getTipoLicenciaList"  parameterClass="java.util.Map" resultMap="baseZonResult">
		  SELECT COD_MOTI_LICE  CODIGO,
		   COD_MOTI_LICE || ' - ' || DES_MOTI_LICE DESCRIPCION
		   FROM ZON_MOTIV_LICEN
		   WHERE EST_REGI = '1'
	</select>
	
	<select id="getDatosConsultoraReemplazo" parameterClass="java.util.Map" resultClass="string">
	<!-- Se agrego mas filtros al query -->
		SELECT c.VAL_NOM1 || ' '|| c.VAL_NOM2||' '|| c.VAL_APE1 ||' '|| c.VAL_APE2||'_'|| ci.NUM_DOCU_IDEN 
			FROM MAE_CLIEN c, MAE_CLIEN_IDENT ci, zon_direc_venta_cabec d, mae_clien_datos_adici da
			where c.oid_clie = ci.clie_oid_clie
              AND c.cod_clie = d.cod_clie(+)
              AND ci.val_iden_docu_prin = 1
			  AND c.cod_clie = #codigoConsultora#
			  AND c.pais_oid_pais = Gen_Pkg_Gener.gen_fn_devuelve_id_pais(#codigoPais#)
              AND (d.est_regi = '1' OR d.est_regi IS NULL)
              AND c.oid_clie = da.clie_oid_clie
              AND da.ind_acti = 1
			AND ROWNUM = 1	
         ORDER BY LENGTH(d.esca_cod_esta_carg) DESC, d.esca_cod_esta_carg
	</select>
	
	
<select id="getDatosConsultoraReemplazoFOX" parameterClass="java.util.Map" resultClass="string">
		SELECT  
        	c.ape_pate||' '||c.ape_mate||' '||c.val_nom1||' '||c.val_nom2
            || '_'
            || c.num_docu
		FROM ZON_DIREC_CLIEN c
        WHERE c.PAIS_COD_PAIS = #codigoPais#
        AND c.cod_clie = #codigoConsultora#
        AND ROWNUM = 1
	</select>
	
	<resultMap id="getDatosUnidaddesAdministrativasConsultoraResult" class="java.util.HashMap">
	   	<result property="codigoCargo"		 		column="TICA_COD_TIPO_CARG"/>
	   	<result property="descripcionCargo"    	  	column="DES_TIPO_CARG"/>
	   	<result property="codigoRegion"    			column="cod_regi"/>
	   	<result property="desRegion"    			column="des_regi"/>
	   	<result property="codigoZona"    			column="cod_zona"/>
	   	<result property="desZona"    				column="des_zona"/>
	   	<result property="correlativoCabecera"    	column="cor_dire_vent"/>	   	
   </resultMap>
	
	<select id="getDatosUnidaddesAdministrativasConsultora" parameterClass="java.util.Map" 
			resultMap="getDatosUnidaddesAdministrativasConsultoraResult">
			SELECT DISTINCT 
				det.tica_cod_tipo_carg, 
				tic.des_tipo_carg, 
				det.cod_regi,
				det.cod_zona,
				cab.cor_dire_vent,
				
				<isEqual property="codigoConexionExterna" compareValue="FOX">
				(SELECT R.DES_REGI 
				FROM ZON_DIREC_REGIO R 
				WHERE R.PAIS_COD_PAIS = det.pais_cod_pais 
				AND R.COD_REGI = det.cod_regi) des_regi,
				(SELECT Z.DES_ZONA
				FROM ZON_DIREC_ZONA Z, ZON_DIREC_REGIO R
				WHERE Z.PAIS_COD_PAIS = R.PAIS_COD_PAIS
				AND Z.REGI_COD_REGI = R.COD_REGI
				AND R.PAIS_COD_PAIS = det.pais_cod_pais
				AND R.COD_REGI = det.cod_regi
				AND Z.COD_ZONA = det.cod_zona) des_zona
				</isEqual>
			
				<isNotEqual property="codigoConexionExterna" compareValue="FOX">
				       (SELECT zr.des_regi
				          FROM zon_regio zr
			         WHERE zr.cod_regi = det.cod_regi) des_regi, 
				       (SELECT zz.des_zona
				          FROM zon_zona zz, zon_regio zr
				         WHERE zz.zorg_oid_regi = zr.oid_regi
			           AND zz.cod_zona = det.cod_zona) des_zona
				</isNotEqual>
			
			  FROM zon_direc_venta_cabec cab,
			       zon_direc_venta_detal det,
			       zon_tipo_cargo tic
			 WHERE cab.cor_dire_vent = det.dica_cor_dire_vent
			 		AND cab.pais_cod_pais = det.pais_cod_pais
			        AND cab.tiop_cod_tipo_oper = det.tiop_cod_tipo_oper
			        AND cab.tica_cod_tipo_carg = det.tica_cod_tipo_carg
			        AND cab.cod_clie = det.cod_clie
			        AND cab.fec_regi = det.dica_fec_regi
			        AND cab.cam_proc = det.dica_cam_proc
			        AND tic.cod_tipo_carg = cab.tica_cod_tipo_carg
			        AND cab.pais_cod_pais = #codigoPais#
			        AND cab.cod_clie = #codigoConsultora#
			        <isEmpty property="considerarTodosEstadosCargos">
			        	AND cab.esca_cod_esta_carg = 'A'
			        </isEmpty>	
			        <isNotEmpty property="considerarSoloGerentes">
			        	AND tic.cod_tipo_carg IN('GR', 'GZ')
			        </isNotEmpty>	
			        <isNotEmpty property="considerarSoloAlternas">
			        	AND tic.cod_tipo_carg IN('MVR', 'MVZ')
			        </isNotEmpty>	
			        <isNotEmpty property="considerarSoloCapacitadoras">
			        	AND tic.cod_tipo_carg = 'EE'
			        </isNotEmpty>	
	</select>
	
	<resultMap id="getDatosCargoConsultoraReemplazoResult" class="java.util.HashMap">
	   	<result property="codigoCargo"		 		column="TICA_COD_TIPO_CARG"/>
	   	<result property="descripcionCargo"    	  	column="DES_TIPO_CARG"/>
   </resultMap>
   
	<select id="getDatosCargoConsultoraReemplazo" parameterClass="java.util.Map" 
			resultMap="getDatosCargoConsultoraReemplazoResult">
		SELECT DISTINCT d.TICA_COD_TIPO_CARG,  
			d.TICA_COD_TIPO_CARG ||' - '|| c.DES_TIPO_CARG DES_TIPO_CARG
			FROM ZON_DIREC_VENTA_DETAL d ,ZON_TIPO_CARGO  c 
			WHERE d.COD_CLIE = #codigoConsultora#
			AND d.TICA_COD_TIPO_CARG = c.COD_TIPO_CARG
	</select>
	
	<select id="getValidacionConsultoraAptoLicencia" parameterClass="java.util.Map"
			resultClass="string">
		SELECT SUM(VAL_CONSU.validacion)
			FROM 
			 (
			SELECT COUNT(DISTINCT(c.TICA_COD_TIPO_CARG)) validacion
			FROM ZON_DIREC_VENTA_CABEC c, ZON_TIPO_CARGO tc
			WHERE c.TICA_COD_TIPO_CARG = tc.COD_TIPO_CARG
			AND c.COD_CLIE = #codigoConsultora#
			AND c.EST_REGI = '1'
			AND tc.VAL_TITU = '1'
			UNION ALL
			SELECT COUNT(DISTINCT(COD_CLIE)) validacion
			FROM ZON_DIREC_VENTA_CABEC
			WHERE COD_CLIE = #codigoConsultora#
			AND MOTI_COD_MOTI_LICE IS NOT NULL
			AND EST_REGI = '1'
			UNION ALL
			SELECT COUNT(DISTINCT(COD_CLIE_REEM)) validacion
			FROM ZON_DIREC_VENTA_CABEC
			WHERE COD_CLIE_REEM = #codigoConsultora#
			AND EST_REGI = '1') VAL_CONSU
	</select>
	
		<resultMap id="paramMaeCliente"    class="java.util.HashMap">
   		<result property="numDocumentoIdentidad" 	column="NUM_DOCU_IDEN"/>
    	<result property="nombreCliente" 			column="nombreDoc"/>
	</resultMap>  
   
	  
	  <select id="getMaeCliente"  parameterClass="java.util.Map" resultMap="paramMaeCliente">
	  SELECT c.VAL_NOM1 || ' '|| c.VAL_NOM2||' '|| c.VAL_APE1 ||' '|| c.VAL_APE2 nombreDoc, ci.NUM_DOCU_IDEN 
			FROM MAE_CLIEN c, MAE_CLIEN_IDENT ci
			where C.OID_CLIE = ci.CLIE_OID_CLIE			
			<isNotEmpty property="codigoCliente" prepend="and">
			 c.cod_clie=#codigoCliente#
			</isNotEmpty>
	  </select>
	  
	  <resultMap id="paramResponsableUA"    class="java.util.HashMap">
	    <result property="oid" 	column="oid"/>
	  	<result property="codigo" 	column="codigo"/>
	  	<result property="descripcion" 	column="descripcion"/>
   		<result property="codigoLider" 	column="COD_CLIE"/>
    	<result property="nombreResponsable" 			column="nombre"/>
	  </resultMap>  
	  
	  <select id="getResponsableUA"  parameterClass="java.util.Map" resultMap="paramResponsableUA">
	 <isEqual property="tipo" compareValue="R"> 
			  select r.OID_REGI oid, r.cod_regi codigo, r.DES_REGI descripcion, 
			   (SELECT c1.COD_CLIE from mae_clien c1 where r.CLIE_OID_CLIE = c1.OID_CLIE) COD_CLIE,
			   (SELECT c2.val_ape1 || ' ' || c2.val_ape2 || ' ' || c2.val_nom1 from mae_clien c2 where r.CLIE_OID_CLIE = c2.OID_CLIE) nombre
				from zon_regio r 
		where r.IND_ACTI = 1
			  <isNotEmpty property="codigoRegion" prepend="and">
			  	r.cod_regi = #codigoRegion#
			  </isNotEmpty>	 
			  ORDER BY r.cod_regi
	  </isEqual>	
		  
	  <isEqual property="tipo" compareValue="Z">
		  select z.OID_ZONA oid, z.cod_zona codigo, z.DES_ZONA descripcion, 
		  (SELECT c1.COD_CLIE from mae_clien c1 where z.CLIE_OID_CLIE = c1.OID_CLIE) COD_CLIE,
		  (SELECT c2.val_ape1 || ' ' || c2.val_ape2 || ' ' || c2.val_nom1 from mae_clien c2 where z.CLIE_OID_CLIE = c2.OID_CLIE) nombre
			from zon_zona z , zon_regio r
		where z.IND_ACTI = 1
		   	AND z. ZORG_OID_REGI = r.OID_REGI
		     <isNotEmpty property="codigoRegion" prepend="and">
	  	r.cod_regi = #codigoRegion#
	  </isNotEmpty>
		     <isNotEmpty property="codigoZona" prepend="and">
		  		z.cod_zona = #codigoZona#
		  	 </isNotEmpty>
		  	ORDER BY z.cod_zona
		  </isEqual>
	  </select>
	
	<resultMap id="getDirectorioHistorioNovedadesResult" class="java.util.HashMap">
	   	<result property="descripcionRegion"	column="DES_REGION"/>
	   	<result property="descripcionZona"    	column="DES_ZONA"/>
	   	<result property="tipoOperacion"    	column="DES_TIPO_OPER"/>
	   	<result property="tipoCargo"    		column="DES_TIPO_CARGO"/>
	   	<result property="fechaRegistro"    	column="DICA_FEC_REGI"/>
	   	<result property="fechaRegistroFin"    	column="FEC_REGI_FIN"/>
	   	<result property="campanyaProceso"    	column="DICA_CAM_PROC"/>
	   	<result property="codigoConsultora"    	column="COD_CLIE"/>
	   	<result property="estadoRegistro"    	column="DES_ESTA_CARG"/>
	   	<result property="rol"					column="ROL"/>
	   	<result property="perfil"				column="PERFIL"/>
   </resultMap>
	
	<select id="getDirectorioHistorioNovedades" parameterClass="java.util.Map" resultMap="getDirectorioHistorioNovedadesResult">
		SELECT   
			<isEqual property="codigoConexionExterna" compareValue="FOX">
			 (SELECT rzon.cod_regi || ' - ' || rzon.des_regi FROM zon_direc_regio rzon WHERE d.cod_regi = rzon.cod_regi) DES_REGION,
	         (
               	SELECT ZO.COD_ZONA || ' - ' || ZO.DES_ZONA
				FROM ZON_DIREC_REGIO RO, ZON_DIREC_ZONA ZO 
                WHERE RO.PAIS_COD_PAIS = ZO.PAIS_COD_PAIS
                AND RO.COD_REGI = ZO.REGI_COD_REGI
                AND RO.COD_REGI = D.COD_REGI 
                AND ZO.COD_ZONA = D.COD_ZONA                        
	         ) DES_ZONA,  	
			</isEqual>
			<isNotEqual property="codigoConexionExterna" compareValue="FOX">
			 (SELECT rzon.cod_regi || ' - ' || rzon.des_regi FROM zon_regio rzon WHERE d.cod_regi = rzon.cod_regi) DES_REGION,
	         (SELECT zzon.cod_zona || ' - ' || zzon.des_zona FROM zon_zona zzon WHERE zzon.cod_zona = d.cod_zona) DES_ZONA,
	        </isNotEqual>
	         (SELECT top.des_tipo_oper FROM ssicc_comun.zon_tipo_opera top WHERE top.cod_tipo_oper = c.tiop_cod_tipo_oper) DES_TIPO_OPER,
	         (SELECT    tcar.cod_tipo_carg || ' - ' || tcar.des_tipo_carg FROM zon_tipo_cargo tcar WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg) DES_TIPO_CARGO,
	          TO_CHAR (d.dica_fec_regi, 'yyyy/mm/dd') DICA_FEC_REGI,
	          TO_CHAR (c.fec_regi_fin, 'yyyy/mm/dd') FEC_REGI_FIN,
		          c.cam_proc DICA_CAM_PROC,
		          c.cod_clie,
		          (SELECT zec.des_esta_carg FROM zon_estat_cargo zec WHERE zec.cod_esta_carg = c.esca_cod_esta_carg) DES_ESTA_CARG,
		          r.des_rol ROL,
                  p.des_perf PERFIL
		   FROM zon_direc_venta_cabec c, zon_direc_venta_detal d, zon_tipo_cargo tcar, zon_direc_rol r, zon_direc_perfi p
		   WHERE c.cor_dire_vent = d.dica_cor_dire_vent(+)
		   	 AND c.tiop_cod_tipo_oper = d.tiop_cod_tipo_oper(+)
		     AND c.tica_cod_tipo_carg = d.tica_cod_tipo_carg(+)
		     AND c.cod_clie = d.cod_clie(+)
		     AND TO_CHAR (c.fec_regi, 'DD/MM/YYYY') = TO_CHAR (d.dica_fec_regi(+), 'DD/MM/YYYY')
		AND c.IND_ESTA = 'A'
		     AND (d.EST_REGI = '1' or d.EST_REGI is null)
		     AND (c.est_regi = '1' or c.est_regi is null) 
		     AND tcar.cod_tipo_carg = c.tica_cod_tipo_carg
         	 AND r.cod_rol = tcar.rol_cod_rol
         	 AND p.cod_perf = tcar.perf_cod_perf
		<isNotEmpty property="codigoOperacion" prepend="and">
		  		c.TIOP_COD_TIPO_OPER = #codigoOperacion#
		</isNotEmpty>
		<isNotEmpty property="codigoCliente" prepend="and">
		  		c.COD_CLIE = #codigoCliente#
		</isNotEmpty>
		<isNotEmpty property="codigoRegion" prepend="and">
		  		d.COD_REGI = #codigoRegion#
		</isNotEmpty>
		<isNotEmpty property="codigoZona" prepend="and">
		  		d.COD_ZONA = #codigoZona#
		</isNotEmpty>
		<isNotEmpty property="estado" prepend="and">
		  		c.ESCA_COD_ESTA_CARG = #estado#
		</isNotEmpty>
		<isNotEmpty property="codigoCargo" prepend="and">
                c.tica_cod_tipo_carg = #codigoCargo#
        </isNotEmpty>
        <isNotEmpty property="codigoRol" prepend="and">
                tcar.rol_cod_rol = #codigoRol#
        </isNotEmpty>
        <isNotEmpty property="codigoPerfil" prepend="and">
                tcar.perf_cod_perf = #codigoPerfil#
        </isNotEmpty>
		ORDER BY c.fec_crea
	</select>
	
	<resultMap id="getConsultaDirectorioVentasResult" class="java.util.HashMap">
		<result property="pais"							column="PAIS"/>
	   	<result property="codigoSubGerencia"			column="COD_SUBG"/>
	   	<result property="codigoRegion"    				column="COD_REGI"/>
	   	<result property="descripcionRegion"    		column="DES_REGI"/>
	   	<result property="descripcionZona"    			column="DES_ZONA"/>
	   	<result property="descripcionTipoCargo"    		column="DES_TIPO_CARGO"/>
	   	<result property="codigoCliente"    			column="COD_CLIE"/>
	   	<result property="nombreCliente"    			column="NOM_CLIE"/>
	   	<result property="numeroDocumentoIdentidad"    	column="NUM_DOCU_IDEN"/>
	   	<result property="telefonoFijo"    				column="TEL_FIJO"/>
	   	<result property="telefonoCelular"    			column="TEL_CELE"/>
	   	<result property="telefonoAdicional"   			column="TEL_ADIC"/>
	   	<result property="email"    					column="VAL_MAIL"/>
	   	<result property="emailBelcorp" 				column="VAL_MAIL_BELCORP"/>
	   	
	   	<result property="domicilio"    				column="VAL_DOMI"/>
	   	<result property="ubigeoDom"    				column="UBI_DOMI"/>
	   	<result property="domicilioEntrega"    			column="VAL_DOMI_ENTR"/>
	   	<result property="ubigeoDomEntrega"    			column="UBI_DOMI_ENTR"/>
	   	<result property="fechaNacimiento"    			column="FEC_NACI"/>
	   	<result property="codigYDescripcionRegion"    	column="COD_DES_REGI"/>
	   	<result property="codigoZona"    				column="COD_ZONA"/>
	   	<result property="estadoRegistro"    			column="DES_ESTA_CARG"/>
	   	<result property="fechaRegistro"    			column="FEC_REGI"/>
	   	<result property="fechaRegistroFin"    			column="FEC_REGI_FIN"/>
	   	<result property="barrio"						column="VAL_BARR"/>
	   	<result property="tipoCargo"					column="TICA_COD_TIPO_CARG"/>
	   	
	   	<result property="codigoUnicoBelcorp"    		column="CUB"/>
	   	<result property="grupoFuncional"    			column="DES_GRUP_FUNC"/>
	   	<result property="cubJefeDirecto"    			column="COD_CUB_JEFE"/>
	   	<result property="nombreJefeDirecto"    		column="VAL_NOM_JEFE"/>
	   	<result property="puesto"    					column="VAL_PUE_ORG"/>
	   	<result property="relacionContrac"    			column="VAL_RELA_CONT"/>
	   	<result property="usuarioRed"    				column="VAL_USUA_RED"/>
	   	<result property="fechaVenta"    				column="FEC_VENT"/>
	   	<result property="fechaFactu"    				column="FEC_FACT"/>
	   	<result property="fechaIngreso"    				column="FEC_INGR"/>
	   	<result property="codPlanilla"    				column="COD_PLANILLA"/>
	   	
	   	<result property="rol"							column="ROL"/>
	   	<result property="perfil"						column="PERFIL"/>
   </resultMap>
	
	<select id="getConsultarDirectorioVentas" parameterClass="java.util.Map" resultMap="getConsultaDirectorioVentasResult">
        SELECT TAB.*
        FROM (
		 	SELECT (select bp.val_nomb_comp from bas_pais bp where bp.cod_pais = c.pais_cod_pais) AS PAIS,
            d.COD_SUBG, 
            d.COD_REGI, 
				(SELECT O.DES_REGI FROM ZON_REGIO O WHERE O.COD_REGI = d.COD_REGI) AS DES_REGI, 
                    (SELECT O.DES_ZONA FROM ZON_ZONA O WHERE O.COD_ZONA = d.COD_ZONA) AS DES_ZONA,
            (SELECT tcar.cod_tipo_carg || ' - ' || tcar.des_tipo_carg FROM zon_tipo_cargo tcar
           WHERE tcar.cod_tipo_carg = d.tica_cod_tipo_carg) DES_TIPO_CARGO,
            (SELECT tcar.cod_tipo_carg_base FROM zon_tipo_cargo tcar
                WHERE tcar.cod_tipo_carg = d.tica_cod_tipo_carg) CARGO_BASE,  	
           c.COD_CLIE, 
		 	(SELECT TRIM(mae.VAL_NOM1)||' '||TRIM(mae.VAL_NOM2)||' '||TRIM(mae.VAL_APE1)||' '||TRIM(mae.VAL_APE2) FROM MAE_CLIEN mae WHERE mae.COD_CLIE =  d.COD_CLIE) NOM_CLIE,
           (SELECT maid.NUM_DOCU_IDEN FROM MAE_CLIEN_IDENT maid 
               WHERE maid.CLIE_OID_CLIE = GEN_PKG_GENER.gen_fn_devuelve_id_cliente(c.COD_CLIE)
               AND maid.VAL_IDEN_DOCU_PRIN = '1') NUM_DOCU_IDEN,
           GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'TF') TEL_FIJO,
           GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'TM') TEL_CELE,
           	GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'TA') TEL_ADIC,
           GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'ML') VAL_MAIL,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'MB') VAL_MAIL_BELCORP,
               ZON_PKG_UNIDA_GEOGR.ZON_FN_DEVUE_DIREC_CONSU(d.COD_CLIE, '1') VAL_DOMI,
               ZON_PKG_UNIDA_GEOGR.fn_retu_ubi_domi(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE)) UBI_DOMI,                                     
               ZON_PKG_UNIDA_GEOGR.ZON_FN_DEVUE_DIREC_CONSU(d.COD_CLIE, '2') VAL_DOMI_ENTR,
               ZON_PKG_UNIDA_GEOGR.fn_retu_ubi_domi_entr(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE)) UBI_DOMI_ENTR,                                     
            (SELECT TO_CHAR(FEC_NACI,'yyyy/mm/dd') FROM MAE_CLIEN_DATOS_ADICI WHERE CLIE_OID_CLIE=GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE)) FEC_NACI,
                               (SELECT O.COD_REGI||' '||O.DES_REGI FROM ZON_REGIO O WHERE O.COD_REGI = d.COD_REGI) AS COD_DES_REGI,
                               d.COD_ZONA,
            (SELECT ZEC.DES_ESTA_CARG FROM ZON_ESTAT_CARGO ZEC WHERE ZEC.COD_ESTA_CARG = c.ESCA_COD_ESTA_CARG) DES_ESTA_CARG,
            TO_CHAR(c.fec_regi, 'yyyy/mm/dd') FEC_REGI,
            TO_CHAR(c.fec_regi_fin, 'yyyy/mm/dd') FEC_REGI_FIN,
            (SELECT A.VAL_BARR  
            		FROM ZON_VIA C, SEG_TIPO_VIA D, MAE_CLIEN_DIREC A, MAE_TIPO_DIREC B
                                 WHERE  A.clie_oid_clie = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE)
                                     AND C.OID_VIA = A.TIVI_OID_TIPO_VIA
                                     AND D.OID_TIPO_VIA = A.TIVI_OID_TIPO_VIA
                                     AND B.OID_TIPO_DIRE = A.TIDC_OID_TIPO_DIRE
                                     AND B.COD_TIPO_DIRE = '01'
                                         AND IND_ELIM = 0) VAL_BARR,
                d.TICA_COD_TIPO_CARG,
               (SELECT DA.COD_CUB  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) CUB,
            (SELECT DA.DES_GRUP_FUNC FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) DES_GRUP_FUNC,
            (SELECT DA.COD_CUB_JEFE  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) COD_CUB_JEFE,
            (SELECT DA.VAL_NOM_JEFE  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_NOM_JEFE,
            (SELECT DA.VAL_PUE_ORG FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_PUE_ORG,
            (SELECT DA.VAL_RELA_CONT FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_RELA_CONT,
            (SELECT DA.VAL_USUA_RED FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_USUA_RED,
            (SELECT DA.COD_EMPL FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) COD_PLANILLA,
           	(SELECT TO_CHAR(cl.fec_ingr, 'yyyy/mm/dd')  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND cl.COD_CLIE = c.COD_CLIE) FEC_INGR,
            TO_CHAR(c.FEC_VENT, 'yyyy/mm/dd') FEC_VENT,
            TO_CHAR(c.FEC_FACT, 'yyyy/mm/dd') FEC_FACT, 
            (SELECT r.des_rol FROM zon_tipo_cargo tcar, zon_direc_rol r
 				WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND r.cod_rol = tcar.rol_cod_rol
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.est_regi = 1) ROL,
            (SELECT p.des_perf FROM zon_tipo_cargo tcar, zon_direc_perfi p
 				WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND p.cod_perf = tcar.perf_cod_perf
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.est_regi = 1) PERFIL
            FROM zon_direc_venta_cabec c, zon_direc_venta_detal d, zon_tipo_cargo k, ssicc_comun.zon_tipo_opera t
                 WHERE c.PAIS_COD_PAIS = #codigoPais#
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.tiop_cod_tipo_oper = d.tiop_cod_tipo_oper
                 AND c.tica_cod_tipo_carg = d.tica_cod_tipo_carg
                 AND c.cod_clie = d.cod_clie
                 AND c.fec_regi = d.dica_fec_regi
                 AND c.esca_cod_esta_carg in ('A','I','IT')
                 AND k.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND t.cod_tipo_oper = c.tiop_cod_tipo_oper
                 AND c.IND_ESTA = 'A'
                 AND d.EST_REGI = '1'
                 AND c.EST_REGI = '1'
                 
           UNION
                 
	           SELECT 
				 null, 
	           	 null, 
	           	 null, 
	           	 null, 
	           	 null, 
	           	 null, 
	           	 null, 
	           	 cl.COD_CLIE, 
			 	TRIM(cl.VAL_NOM1)||' '||TRIM(cl.VAL_NOM2)||' '||TRIM(cl.VAL_APE1)||' '||TRIM(cl.VAL_APE2) NOM_CLIE,
             maid.num_docu_iden,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(cl.oid_clie,'TF') TEL_FIJO,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(cl.oid_clie,'TM') TEL_CELE,
			 	GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(cl.oid_clie,'TA') TEL_ADIC,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(cl.oid_clie,'ML') VAL_MAIL,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(cl.oid_clie,'MB') VAL_MAIL_BELCORP,
             ZON_PKG_UNIDA_GEOGR.ZON_FN_DEVUE_DIREC_CONSU(cl.cod_clie, '1') VAL_DOMI,
             ZON_PKG_UNIDA_GEOGR.fn_retu_ubi_domi(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(cl.cod_clie)) UBI_DOMI,                                     
             ZON_PKG_UNIDA_GEOGR.ZON_FN_DEVUE_DIREC_CONSU(cl.cod_clie, '2') VAL_DOMI_ENTR,
             ZON_PKG_UNIDA_GEOGR.fn_retu_ubi_domi_entr(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(cl.cod_clie)) UBI_DOMI_ENTR, 
                TO_CHAR(da.FEC_NACI, 'yyyy/mm/dd') FEC_NACI,
	             null, 
	             null, 
             'NO ASIGNADA' DES_ESTA_CARG,
	             null, 
	             null, 
             (SELECT A.VAL_BARR  FROM ZON_VIA C, SEG_TIPO_VIA D, MAE_CLIEN_DIREC A, MAE_TIPO_DIREC B
                       WHERE  A.clie_oid_clie = cl.oid_clie
                                     AND C.OID_VIA = A.TIVI_OID_TIPO_VIA
                                     AND D.OID_TIPO_VIA = A.TIVI_OID_TIPO_VIA
                                     AND B.OID_TIPO_DIRE = A.TIDC_OID_TIPO_DIRE
                           AND B.COD_TIPO_DIRE = '01'
                           AND IND_ELIM = 0) VAL_BARR,
             NULL,              
             da.COD_CUB CUB, 
             da.DES_GRUP_FUNC,
             da.COD_CUB_JEFE,
             da.VAL_NOM_JEFE,
             da.VAL_PUE_ORG,
             da.VAL_RELA_CONT,
             da.VAL_USUA_RED,
             da.cod_empl COD_PLANILLA,
             	 TO_CHAR(cl.fec_ingr, 'yyyy/mm/dd') FEC_INGR,
	             NULL, 
	             NULL, 
	             NULL,  
	             NULL  
           FROM MAE_CLIEN_TIPO_SUBTI CTS, mae_clien cl, mae_clien_datos_adici da, mae_clien_ident maid
             WHERE cl.oid_clie = da.clie_oid_clie
              and cl.oid_clie = cts.clie_oid_clie
              and cl.oid_clie = maid.CLIE_OID_CLIE
              and maid.VAL_IDEN_DOCU_PRIN = '1'
              and CTS.TICL_OID_TIPO_CLIE =2
              and CTS.SBTI_OID_SUBT_CLIE IN (21) 
              and CL.COD_CLIE NOT IN (SELECT DISTINCT DIR.COD_CLIE FROM ZON_DIREC_VENTA_CABEC DIR )
              and DA.COD_CUB IS NOT NULL     
              
                  ) TAB WHERE 1 = 1

            <isNotEmpty property="codigoCliente" prepend="and">
                  TAB.COD_CLIE = #codigoCliente#
            </isNotEmpty>      
            <isNotEmpty property="codigoRegion" prepend="and">
                  <!--d.COD_REGI = #codigoRegion#-->
                  TAB.COD_REGI = #codigoRegion#
            </isNotEmpty>
            <isNotEmpty property="codigoZona" prepend="and">
                  <!--d.COD_ZONA = #codigoZona#-->
                  TAB.COD_ZONA = #codigoZona#
            </isNotEmpty>
            <isNotEmpty property="cargo" prepend="and">
                  <!--d.TICA_COD_TIPO_CARG = #cargo#-->
                  TAB.TICA_COD_TIPO_CARG = #cargo#
            </isNotEmpty>
            <isNotEmpty property="tipoCargoVigente" prepend="and">
                  TAB.CARGO_BASE IS NULL
            </isNotEmpty>
            <isNotEmpty property="tipoCargoFuturo" prepend="and">
                  TAB.CARGO_BASE IS NOT NULL
            </isNotEmpty>
            <iterate prepend="AND" property="estadoList" open="(" close=")" conjunction="OR">
			 	  <!-- c.ESCA_COD_ESTA_CARG = #estadoList[]#-->
			 	  TAB.DES_ESTA_CARG = #estadoList[]#
			</iterate>
			<isNotEmpty property="codigoRol" prepend="and">
                  <!-- k.rol_cod_rol = #codigoRol# -->
                  TAB.ROL = (SELECT DES_ROL FROM ZON_DIREC_ROL WHERE COD_ROL = #codigoRol#)
            </isNotEmpty>
            <isNotEmpty property="codigoPerfil" prepend="and">
                  <!-- k.perf_cod_perf = #codigoPerfil# -->
                  TAB.PERFIL = (SELECT DES_PERF FROM ZON_DIREC_PERFI WHERE COD_PERF = #codigoPerfil#)
            </isNotEmpty>      
            <isNotEmpty property="email" prepend="and">
                  UPPER(TAB.VAL_MAIL) LIKE UPPER('%$email$%')
            </isNotEmpty>
            <isNotEmpty property="barrio" prepend="and">
                  UPPER(TAB.VAL_BARR) LIKE UPPER('%$barrio$%')
            </isNotEmpty>
            <isNotEmpty property="cub" prepend="and">
                  TAB.CUB = #cub#
            </isNotEmpty>
            
            ORDER BY TAB.COD_REGI, TAB.COD_ZONA ASC
	</select>
	
	<select id="getConsultarDirectorioVentasFOX" parameterClass="java.util.Map" resultMap="getConsultaDirectorioVentasResult">
		SELECT TAB.*
		  FROM (
		  SELECT (select bp.val_nomb_comp from bas_pais bp where bp.cod_pais = c.pais_cod_pais) AS PAIS,
		   d.COD_SUBG,
		   d.COD_REGI,
		   (SELECT O.DES_REGI FROM ZON_DIREC_REGIO O WHERE O.PAIS_COD_PAIS = d.PAIS_COD_PAIS AND O.COD_REGI = d.COD_REGI) AS DES_REGI,
		   (SELECT ZO.DES_ZONA
            FROM ZON_DIREC_REGIO RO, ZON_DIREC_ZONA ZO 
            WHERE RO.PAIS_COD_PAIS = ZO.PAIS_COD_PAIS
            AND RO.COD_REGI = ZO.REGI_COD_REGI
            AND RO.COD_REGI = D.COD_REGI 
            AND ZO.PAIS_COD_PAIS= d.PAIS_COD_PAIS  
            AND ZO.COD_ZONA =   D.COD_ZONA) AS DES_ZONA,
		   (SELECT tcar.cod_tipo_carg || ' - ' || tcar.des_tipo_carg FROM zon_tipo_cargo tcar WHERE tcar.cod_tipo_carg = d.tica_cod_tipo_carg) DES_TIPO_CARGO,
		   (SELECT tcar.cod_tipo_carg_base FROM zon_tipo_cargo tcar WHERE tcar.cod_tipo_carg = d.tica_cod_tipo_carg) CARGO_BASE, 
		   (SELECT zdc.cod_clie FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) COD_CLIE,
		   (SELECT TRIM(zdc.val_nom1) || ' ' || TRIM(zdc.val_nom2) || ' ' || TRIM(zdc.ape_pate) || ' ' || TRIM(zdc.ape_mate) FROM ZON_DIREC_CLIEN zdc 
		   WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) NOM_CLIE,
		   (SELECT zdc.num_docu FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) NUM_DOCU_IDEN,
		   (SELECT zdc.num_telf_casa FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) TEL_FIJO,
		   (SELECT zdc.num_telf_celu FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) TEL_CELE,
		   '' TEL_ADIC,
		   (SELECT zdc.dir_mail FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_MAIL,
		   (SELECT zdc.dir_mail_belc FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_MAIL_BELCORP,
		   (SELECT zdc.dir_domi FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_DOMI,
		   (SELECT zdc.ubi_domi FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) UBI_DOMI,
		   (SELECT zdc.dir_entr FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_DOMI_ENTR,
		   (SELECT zdc.ubi_entr FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) UBI_DOMI_ENTR,
		   (SELECT TO_CHAR(zdc.fec_naci, 'yyyy/mm/dd') FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) FEC_NACI,
		   (SELECT O.COD_REGI || ' ' || O.DES_REGI FROM ZON_DIREC_REGIO O 
		   	WHERE O.PAIS_COD_PAIS = d.PAIS_COD_PAIS AND O.COD_REGI = d.COD_REGI) AS COD_DES_REGI,
                           d.COD_ZONA,
		   (SELECT ZEC.DES_ESTA_CARG FROM ZON_ESTAT_CARGO ZEC WHERE ZEC.COD_ESTA_CARG = c.ESCA_COD_ESTA_CARG) DES_ESTA_CARG,
		   TO_CHAR(c.fec_regi, 'yyyy/mm/dd') FEC_REGI,
		   TO_CHAR(c.fec_regi_fin, 'yyyy/mm/dd') FEC_REGI_FIN,
		   '' VAL_BARR,
		   d.TICA_COD_TIPO_CARG,
		   (SELECT zdc.cod_cub FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) CUB,
		   (SELECT zdc.des_grup_func FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) DES_GRUP_FUNC,
		   (SELECT zdc.cod_cub_jefe FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) COD_CUB_JEFE,
		   (SELECT zdc.val_nom_jefe FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_NOM_JEFE,
		   (SELECT zdc.val_pues_org FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_PUE_ORG,
		   (SELECT zdc.val_rela_cont FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_RELA_CONT,
		   (SELECT zdc.val_usua_red FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) VAL_USUA_RED,
		   (SELECT zdc.cod_empl FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais AND zdc.cod_clie = c.cod_clie) COD_PLANILLA,
		   (SELECT TO_CHAR(zdc.fec_ingr, 'yyyy/mm/dd') FROM ZON_DIREC_CLIEN zdc WHERE zdc.pais_cod_pais = c.pais_cod_pais 
		   AND zdc.cod_clie = c.cod_clie) FEC_INGR,
		   TO_CHAR(c.FEC_VENT, 'yyyy/mm/dd') FEC_VENT,
		   TO_CHAR(c.FEC_FACT, 'yyyy/mm/dd') FEC_FACT,
		   (SELECT r.des_rol FROM zon_tipo_cargo tcar, zon_direc_rol r WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
		       AND r.cod_rol = tcar.rol_cod_rol AND c.cor_dire_vent = d.dica_cor_dire_vent AND c.est_regi = 1) ROL,
		   (SELECT p.des_perf FROM zon_tipo_cargo tcar, zon_direc_perfi p WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
		       AND p.cod_perf = tcar.perf_cod_perf AND c.cor_dire_vent = d.dica_cor_dire_vent AND c.est_regi = 1) PERFIL
		      FROM zon_direc_venta_cabec      c,
		           zon_direc_venta_detal      d,
		           zon_tipo_cargo             k,
		           ssicc_comun.zon_tipo_opera t
		     WHERE c.PAIS_COD_PAIS = #codigoPais#
		       AND c.cor_dire_vent = d.dica_cor_dire_vent
		       AND c.tiop_cod_tipo_oper = d.tiop_cod_tipo_oper
             AND c.tica_cod_tipo_carg = d.tica_cod_tipo_carg
             AND c.cod_clie = d.cod_clie
             AND c.fec_regi = d.dica_fec_regi
		       AND c.esca_cod_esta_carg in ('A', 'I', 'IT')
		       AND k.cod_tipo_carg = c.tica_cod_tipo_carg
		       AND t.cod_tipo_oper = c.tiop_cod_tipo_oper
             AND c.IND_ESTA = 'A'
             AND d.EST_REGI = '1'
             AND c.EST_REGI = '1'
		    UNION
		      SELECT null,
		     null,
		     null,
		     null,
		     null,
		     null,
		     null,
		     zdc.cod_clie,
		     TRIM(zdc.val_nom1) || ' ' || TRIM(zdc.val_nom2) || ' ' || TRIM(zdc.ape_pate) || ' ' || TRIM(zdc.ape_mate) NOM_CLIE,
		     zdc.num_docu AS num_docu_iden,
		     zdc.num_telf_casa AS TEL_FIJO,
		     zdc.num_telf_celu AS TEL_CELE,
		     '' TEL_ADIC,
		     zdc.dir_mail AS VAL_MAIL,
		     zdc.dir_mail_belc VAL_MAIL_BELCORP,
		     zdc.dir_domi VAL_DOMI,
		     zdc.ubi_domi UBI_DOMI,
		     zdc.dir_entr VAL_DOMI_ENTR,
		     zdc.ubi_entr UBI_DOMI_ENTR,
		     TO_CHAR(zdc.fec_naci, 'yyyy/mm/dd') FEC_NACI,
		     null,
		     null,
		     'NO ASIGNADA' DES_ESTA_CARG,
		     null,
		     null,
		     '' VAL_BARR,
		     NULL, 
		     zdc.cod_cub CUB,
		     zdc.des_grup_func DES_GRUP_FUNC,
		     zdc.cod_cub_jefe COD_CUB_JEFE,
		     zdc.val_nom_jefe VAL_NOM_JEFE,
		     zdc.val_pues_org VAL_PUE_ORG,
		     zdc.val_rela_cont VAL_RELA_CONT,
		     zdc.val_usua_red VAL_USUA_RED,
		     zdc.cod_empl COD_PLANILLA,
		     TO_CHAR(zdc.fec_ingr, 'yyyy/mm/dd') FEC_INGR,  
		     NULL, 
		     NULL, 
		     NULL,
		     NULL 
		    FROM zon_direc_clien zdc
		    WHERE zdc.pais_cod_pais = #codigoPais#
		    AND zdc.cod_clie NOT IN (SELECT DISTINCT DIR.COD_CLIE FROM ZON_DIREC_VENTA_CABEC DIR)
		) TAB WHERE 1 = 1

            <isNotEmpty property="codigoCliente" prepend="and">
                  TAB.COD_CLIE = #codigoCliente#
            </isNotEmpty>      
             <isNotEmpty property="codigoRegion" prepend="and">
                  <!--d.COD_REGI = #codigoRegion#-->
                  TAB.COD_REGI = #codigoRegion#
            </isNotEmpty>
            <isNotEmpty property="codigoZona" prepend="and">
                  <!--d.COD_ZONA = #codigoZona#-->
                  TAB.COD_ZONA = #codigoZona#
            </isNotEmpty>
            <isNotEmpty property="cargo" prepend="and">
                  <!--d.TICA_COD_TIPO_CARG = #cargo#-->
                  TAB.TICA_COD_TIPO_CARG = #cargo#
            </isNotEmpty>
            <isNotEmpty property="tipoCargoVigente" prepend="and">
                  TAB.CARGO_BASE IS NULL
            </isNotEmpty>
            <isNotEmpty property="tipoCargoFuturo" prepend="and">
                  TAB.CARGO_BASE IS NOT NULL
            </isNotEmpty>
            <iterate prepend="AND" property="estadoList" open="(" close=")" conjunction="OR">
			 	  <!-- c.ESCA_COD_ESTA_CARG = #estadoList[]#-->
			 	  TAB.DES_ESTA_CARG = #estadoList[]#
			</iterate>
			<isNotEmpty property="codigoRol" prepend="and">
                  <!-- k.rol_cod_rol = #codigoRol# -->
                  TAB.ROL = (SELECT DES_ROL FROM ZON_DIREC_ROL WHERE COD_ROL = #codigoRol#)
            </isNotEmpty>
            <isNotEmpty property="codigoPerfil" prepend="and">
                  <!-- k.perf_cod_perf = #codigoPerfil# -->
                  TAB.PERFIL = (SELECT DES_PERF FROM ZON_DIREC_PERFI WHERE COD_PERF = #codigoPerfil#)
            </isNotEmpty>      
            <isNotEmpty property="email" prepend="and">
                  UPPER(TAB.VAL_MAIL) LIKE UPPER('%$email$%')
			</isNotEmpty>
            <isNotEmpty property="barrio" prepend="and">
                  UPPER(TAB.VAL_BARR) LIKE UPPER('%$barrio$%')
            </isNotEmpty>
            <isNotEmpty property="cub" prepend="and">
                  TAB.CUB = #cub#
			</isNotEmpty>

            ORDER BY TAB.COD_REGI, TAB.COD_ZONA ASC
	</select>
	
	<select id="getTipoCargoList" resultMap="baseResult">
		SELECT COD_TIPO_CARG codigo, DES_TIPO_CARG descripcion FROM ZON_TIPO_CARGO WHERE EST_REGI = '1' ORDER BY 2 ASC	
	</select>
	
	<select id="getValidarTipoCargoDirectorioVenta" parameterClass="java.util.Map" resultClass="integer">
		SELECT COUNT(1)
		  FROM ZON_DIREC_VENTA_CABEC ZDVC, ZON_TIPO_CARGO ZTP
		 WHERE ZDVC.TICA_COD_TIPO_CARG = ZTP.COD_TIPO_CARG
		   AND ZTP.EST_REGI = 1
		   AND ZDVC.ESCA_COD_ESTA_CARG = 'A'
		   AND ZTP.COD_TIPO_CARG = #tipoCargo#
	</select>
	
	<update id="updateGerenciaZona" parameterClass="java.util.Map">
		UPDATE ZON_ZONA
		SET    CLIE_OID_CLIE	  = #oidCliente#,
		       FEC_ULTI_ACTU	  = SYSDATE		       
		WHERE  COD_ZONA      = #codigoZona#		
    </update>	
    
    <update id="updateGerenciaZonaFOX" parameterClass="java.util.Map">
		UPDATE ZON_DIREC_ZONA
		SET 
		CLIE_COD_CLIE = #codigoConsultora#,
		USU_MODI = #usuarioLogin#,
		FEC_MODI = SYSDATE
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND REGI_COD_REGI = #codigoRegion#
		AND COD_ZONA = #codigoZona#
    </update>	
    
    <update id="updateGerenciaRegion" parameterClass="java.util.Map">
		UPDATE ZON_REGIO
		SET    CLIE_OID_CLIE	  = #oidCliente#,
		       FEC_ULTI_ACTU	  = SYSDATE		       
		WHERE  COD_REGI     = #codigoRegion#		
    </update>
        	        
	<update id="updateGerenciaRegionFOX" parameterClass="java.util.Map">
		UPDATE ZON_DIREC_REGIO
		SET 
		CLIE_COD_CLIE = #codigoConsultora#,
		USU_MODI = #usuarioLogin#,
		FEC_MODI = SYSDATE
		WHERE PAIS_COD_PAIS = #codigoPais#
		AND COD_REGI = #codigoRegion#
    </update>
        	        
	<insert id="insertHistoricoGerenteZonaRegion" parameterClass="java.util.Map">
		INSERT INTO ZON_HISTO_GEREN
		  (OID_HIST_GERE,
		   MARC_OID_MARC,
		   CANA_OID_CANA,
		   UA,
		   GERE,
		   FEC_DESD,
		   FEC_HAST,
		   PAIS_OID_PAIS,
		   PERD_OID_PERI_DESD,
		   PERD_OID_PERI_HAST,
		   COD_LIDE_CLAS,
		   ACFI_EXIG_SECC_NOMB,
		   NUM_ACTI_FINA_SECC,
		   ACFI_EXIG_ZONA_NOMB,
		   NUM_ACTI_FINA_ZONA,
		   USU_MODI,
		   FEC_MODI,
		   COD_SUBG,
		   COD_REGI,
		   COD_ZONA
		   )
		VALUES
		  (ZON_HGER_SEQ.NEXTVAL,
		   GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
		   GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#),
		   #unidadAdministrativa#,
		   #codigoConsultora#,
		   to_date(#fechaIngreso#,'dd/mm/yyyy'),
		   NULL,
		   GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_PAIS(#codigoPais#),
		   GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA(#codigoPais#,'T','VD',TO_DATE(#fechaIngreso#, 'DD/MM/YYYY'))),	   
		   NULL,
		   NULL,
		   NULL,
	 	   NULL,
	 	   NULL, 
	 	   NULL,
	 	   #usuarioLogin#,
	 	   SYSDATE,
	 	   #codigoSubGerencia#,
	 	   #codigoRegion#,
	 	   #codigoZona#  
	 	   )  	
    </insert>
    
   <insert id="insertHistoricoGerenteZonaRegionFOX" parameterClass="java.util.Map">
		INSERT INTO ZON_DIREC_HISTO_GEREN
		  (COR_HIST_GERE,
		   UNI_ADMI,
		   CLIE_COD_CLIE,
		   FEC_DESD,
		   FEC_HAST,
		   PAIS_COD_PAIS,
		   CAM_DESD,
		   CAM_HAST,
		   USU_CREA,
		   FEC_CREA,
		   USU_MODI,
		   FEC_MODI,
		   REGI_COD_REGI,
		   ZONA_COD_ZONA,
		   EST_REGI
		   )
		VALUES
		  (ZON_DIREC_HGER_SEQ.NEXTVAL,
		   #unidadAdministrativa#,
		   #codigoConsultora#,
		   to_date(#fechaIngreso#,'dd/mm/yyyy'),
		   NULL,
		   #codigoPais#,
		   GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#, TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')),	   
		   NULL,
	 	   #usuarioLogin#,
	 	   SYSDATE,
		   NULL,
		   NULL,
	 	   #codigoRegion#,
	 	   #codigoZona#,
	 	   #estadoRegistro#  
	 	   )  	
    </insert>
    
   <resultMap id="getLastHistoricoGerenteByClienteResult" class="java.util.HashMap">
	   	<result property="oidHistoricoGerente"	column="OID_HIST_GERE"/>	   	
	   	<result property="fechaDesde"			column="FEC_DESD"/>
	   	<result property="fechaHasta"			column="FEC_HAST"/>
	   	<result property="oidPeriodoDesde"		column="PERD_OID_PERI_DESD"/>
	   	<result property="oidPeriodoHasta"		column="PERD_OID_PERI_HAST"/>
   </resultMap>
   
   <select id="getLastHistoricoGerenteByCliente" parameterClass="java.util.Map" resultMap="getLastHistoricoGerenteByClienteResult">
		   SELECT TO_CHAR(ZHG.OID_HIST_GERE) OID_HIST_GERE,
		   		  TO_CHAR(ZHG.FEC_DESD,'DD/MM/YYYY') FEC_DESD, 
		   		  TO_CHAR(ZHG.FEC_HAST,'DD/MM/YYYY') FEC_HAST, 
		   		  ZHG.PERD_OID_PERI_DESD, 
		   		  ZHG.PERD_OID_PERI_HAST
		    FROM ZON_HISTO_GEREN ZHG
		   WHERE ZHG.GERE = #codigoConsultora#
		     AND ZHG.UA = #unidadAdministrativa#
		     AND ZHG.FEC_HAST IS NULL
		     AND ZHG.PERD_OID_PERI_HAST IS NULL		     
		   ORDER BY ZHG.OID_HIST_GERE DESC
	</select>
	
	<resultMap id="getLastHistoricoGerenteByClienteResultFOX" class="java.util.HashMap">
	   	<result property="corHistoricoGerente"	column="COR_HIST_GERE"/>	   	
	   	<result property="fechaDesde"			column="FEC_DESD"/>
	   	<result property="fechaHasta"			column="FEC_HAST"/>
	   	<result property="campDesde"			column="CAM_DESD"/>
	   	<result property="campHasta"			column="CAM_HAST"/>
   </resultMap>
	
	<select id="getLastHistoricoGerenteByClienteFOX" parameterClass="java.util.Map" resultMap="getLastHistoricoGerenteByClienteResultFOX">
		  SELECT TO_CHAR(ZDHG.COR_HIST_GERE) COR_HIST_GERE, ZDHG.FEC_DESD, ZDHG.FEC_HAST, ZDHG.CAM_DESD, ZDHG.CAM_HAST
		    FROM ZON_DIREC_HISTO_GEREN ZDHG
		   WHERE ZDHG.PAIS_COD_PAIS = #codigoPais# 
		   	 AND ZDHG.CLIE_COD_CLIE = #codigoConsultora#
		     AND ZDHG.UNI_ADMI = #unidadAdministrativa#
		     AND ZDHG.FEC_HAST IS NULL
		     AND ZDHG.CAM_HAST IS NULL		     
		   ORDER BY ZDHG.COR_HIST_GERE DESC
	</select>
	
	<update id="updateLastHistoricoGerenteByCliente" parameterClass="java.util.Map">
		UPDATE ZON_HISTO_GEREN ZHG
		   SET    
		   <isEmpty property="indicadorResta1">
			   	<isNotEmpty property="fechaIngreso">
					ZHG.FEC_HAST = to_date(#fechaIngreso#,'dd/mm/yyyy'),
					ZHG.PERD_OID_PERI_HAST = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA(#codigoPais#,'T','VD',TO_DATE(#fechaIngreso#, 'DD/MM/YYYY'))),
				</isNotEmpty>
				<isNotEmpty property="fechaIngresoLicencia">
					ZHG.FEC_HAST = to_date(#fechaIngresoLicencia#,'dd/mm/yyyy'),
					ZHG.PERD_OID_PERI_HAST = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA(#codigoPais#,'T','VD',TO_DATE(#fechaIngresoLicencia#, 'DD/MM/YYYY'))),
				</isNotEmpty>					
		   </isEmpty>
		   <isNotEmpty property="indicadorResta1">
			<isNotEmpty property="fechaIngreso">
				ZHG.FEC_HAST = to_date(#fechaIngreso#,'dd/mm/yyyy'),
				ZHG.PERD_OID_PERI_HAST = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(GEN_PKG_GENER.GEN_FN_PERIO_NSIGU(#codigoPais#,GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA(#codigoPais#,'T','VD',TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')), -1)),
			</isNotEmpty>
			<isNotEmpty property="fechaIngresoLicencia">
					ZHG.FEC_HAST = to_date(#fechaIngresoLicencia#,'dd/mm/yyyy'),
					ZHG.PERD_OID_PERI_HAST = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(GEN_PKG_GENER.GEN_FN_PERIO_NSIGU(#codigoPais#,GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA(#codigoPais#,'T','VD',TO_DATE(#fechaIngresoLicencia#, 'DD/MM/YYYY')), -1)),
				</isNotEmpty>
			</isNotEmpty>
				ZHG.USU_MODI = #usuarioLogin#,
				ZHG.FEC_MODI = SYSDATE
		 WHERE  ZHG.OID_HIST_GERE = #oidHistoricoGerencia#
    </update>
    
    <update id="updateLastHistoricoGerenteByClienteFOX" parameterClass="java.util.Map">
		UPDATE ZON_DIREC_HISTO_GEREN ZDHG
		   SET    
		   <isEmpty property="indicadorResta1">
			<isNotEmpty property="fechaIngreso">
					ZDHG.FEC_HAST = to_date(#fechaIngreso#,'dd/mm/yyyy'),
					ZDHG.CAM_HAST = GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#, TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')),
			</isNotEmpty>
			<isNotEmpty property="fechaIngresoLicencia">
					ZDHG.FEC_HAST = to_date(#fechaIngresoLicencia#,'dd/mm/yyyy'),
					ZDHG.CAM_HAST = GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#, TO_DATE(#fechaIngresoLicencia#, 'DD/MM/YYYY')), 
			</isNotEmpty>
		   </isEmpty>
		   <isNotEmpty property="indicadorResta1">
		   		<isNotEmpty property="fechaIngreso">
					ZDHG.FEC_HAST = to_date(#fechaIngreso#,'dd/mm/yyyy'),
					ZDHG.CAM_HAST = GEN_PKG_GENER.GEN_FN_PERIO_NSIGU(#codigoPais#, GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#, TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')), -1),
				</isNotEmpty>
				<isNotEmpty property="fechaIngresoLicencia">
					ZDHG.FEC_HAST = to_date(#fechaIngresoLicencia#,'dd/mm/yyyy'),
					ZDHG.CAM_HAST = GEN_PKG_GENER.GEN_FN_PERIO_NSIGU(#codigoPais#, GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#, TO_DATE(#fechaIngresoLicencia#, 'DD/MM/YYYY')), -1), 
				</isNotEmpty>
		   </isNotEmpty>    
			
				ZDHG.USU_MODI = #usuarioLogin#,
				ZDHG.FEC_MODI = SYSDATE,
				ZDHG.EST_REGI = '1'
		 WHERE  ZDHG.COR_HIST_GERE = #corHistoricoGerente#
    </update>
    
    <delete id="deleteHistoricoGerenteByCliente" parameterClass="java.util.Map">
			DELETE FROM  ZON_HISTO_GEREN		
			WHERE  MARC_OID_MARC  = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#)
			AND CANA_OID_CANA = GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#)
			AND UA = #unidadAdministrativa#
			AND perd_oid_peri_desd = GEN_PKG_GENER.gen_fn_devuelve_id_cra_perio2(GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA(#codigoPais#,'T','VD',TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')))
    </delete>
    
    <delete id="deleteHistoricoGerenteByClienteFOX" parameterClass="java.util.Map">
			DELETE FROM  ZON_DIREC_HISTO_GEREN
			WHERE  PAIS_COD_PAIS = #codigoPais#
			AND UNI_ADMI = #unidadAdministrativa#
			AND CAM_DESD = #campDesde#
			<!-- AND camp_desd = GEN_PKG_GENER.GEN_FN_DEVU_PERIO_FECH_PFOX(#codigoPais#, TO_DATE(#fechaIngreso#, 'DD/MM/YYYY')) -->
    </delete>
    
    <select id="getCorrelativoCabeceraDirectorio" resultClass="long">
    	SELECT ZON_SEQ_DIREC_VENTA_CABEC.NEXTVAL FROM DUAL
    </select>
    	    
    <select id="getPerfil" parameterClass="string" resultMap="perfilResult">
    	SELECT
    	COD_PERF,
		DES_PERF,
		IND_ACTI,
		USU_CREA,
		FEC_CREA,
		USU_MODI,
		FEC_MODI,
		EST_REGI
    	FROM ZON_DIREC_PERFI
    	WHERE COD_PERF = #value#
    </select>
    
    <select id="getPerfilesByCriteria" parameterClass="map" resultMap="perfilResult">
    	SELECT
    	COD_PERF,
		DES_PERF,
		DECODE(IND_ACTI, '1', 'SI', 'NO') IND_ACTI,
		USU_CREA,
		FEC_CREA,
		USU_MODI,
		FEC_MODI,
		EST_REGI
    	FROM ZON_DIREC_PERFI
    	WHERE EST_REGI = '1' 
    	
    	<isNotEmpty prepend="AND" property="descripcion">
    		DES_PERF LIKE #descripcion#
    	</isNotEmpty>
    	
    	<isNotEmpty prepend="AND" property="indicadorActivo">
    		IND_ACTI = #indicadorActivo#
    	</isNotEmpty>
    	
    	ORDER BY COD_PERF
    </select>
    
    <update id="updatePerfil" parameterClass="perfilDirectorio">
    	UPDATE ZON_DIREC_PERFI SET
		DES_PERF = #descripcion#,
		IND_ACTI = #indicadorActivo#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#,
		EST_REGI = #estado#
    	WHERE COD_PERF = #codigo#
    </update>
    
    <select id="getRol" parameterClass="string" resultMap="rolResult">
    	SELECT
    	COD_ROL,
		DES_ROL,
		IND_ACTI,
		USU_CREA,
		FEC_CREA,
		USU_MODI,
		FEC_MODI,
		EST_REGI,
		VAL_TIPO_UNID_ADMI
    	FROM ZON_DIREC_ROL
    	WHERE COD_ROL = #value#
    </select>
    
    <select id="getRolesByCriteria" parameterClass="map" resultMap="rolResult">
    	SELECT
    	COD_ROL,
		DES_ROL,
		DECODE(IND_ACTI, '1', 'SI', 'NO') IND_ACTI,
		USU_CREA,
		FEC_CREA,
		USU_MODI,
		FEC_MODI,
		EST_REGI,
		DECODE(VAL_TIPO_UNID_ADMI, 'Z', 'ZONA', DECODE(VAL_TIPO_UNID_ADMI, 'R','REGION','')) VAL_TIPO_UNID_ADMI
    	FROM ZON_DIREC_ROL
    	WHERE EST_REGI = '1' 
    	<isNotEmpty prepend="AND" property="descripcion">
    		DES_ROL LIKE #descripcion#
    	</isNotEmpty>
    	<isNotEmpty prepend="AND" property="indicadorActivo">
    		IND_ACTI = #indicadorActivo#
    	</isNotEmpty>
    	ORDER BY COD_ROL
	</select>
	
    <update id="updateRol" parameterClass="rolDirectorio">
    	UPDATE ZON_DIREC_ROL SET
		DES_ROL = #descripcion#,
		IND_ACTI = #indicadorActivo#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#,
		EST_REGI = #estado#,
		VAL_TIPO_UNID_ADMI = #codigoTipoUniAdmi#
    	WHERE COD_ROL = #codigo#
    </update>
    
    <insert id="insertPerfil" parameterClass="perfilDirectorio">
    	INSERT INTO ZON_DIREC_PERFI(
	    	COD_PERF,
			DES_PERF,
			IND_ACTI,
			USU_CREA,
			FEC_CREA,
			EST_REGI)
		VALUES(
			#codigo#,
			#descripcion#,
			#indicadorActivo#,
			#auditInfo.createdBy#,
			#auditInfo.created#,
			#estado#)
    </insert>

    <insert id="insertRol" parameterClass="rolDirectorio">
    	INSERT INTO ZON_DIREC_ROL(
	    	COD_ROL,
			DES_ROL,
			IND_ACTI,
			USU_CREA,
			FEC_CREA,
			EST_REGI,
			VAL_TIPO_UNID_ADMI)
		VALUES(
			#codigo#,
			#descripcion#,
			#indicadorActivo#,
			#auditInfo.createdBy#,
			#auditInfo.created#,
			#estado#,
			#codigoTipoUniAdmi#)
    </insert>

	<select id="getDetalleDatosCliente" parameterClass="map" resultMap="detalleDatosClienteMapResult">
		SELECT
		P.COD_PAIS,
		A.COD_CLIE,
		A.VAL_APE1,
		A.VAL_APE2,
		A.VAL_NOM1,
		A.VAL_NOM2,
		D.COD_CUB,
		B.TDOC_OID_TIPO_DOCU OID_TIPO_DOCU,
		B.NUM_DOCU_IDEN,
		TO_CHAR(D.FEC_NACI, 'DD/MM/YYYY') FEC_NACI,
		GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(A.COD_CLIE, 'COD_REGI') COD_REGI,
		GEN_PKG_GENER.GEN_FN_CLIEN_DATOS(A.COD_CLIE, 'COD_ZONA')  COD_ZONA,
		(SELECT com.val_text_comu 
		                 FROM MAE_CLIEN_COMUN com, MAE_TIPO_COMUN tip
		                WHERE com.ticm_oid_tipo_comu = tip.oid_tipo_comu 
		                  AND com.clie_oid_clie = a.oid_clie
		                  AND tip.cod_tipo_comu = 'TT') CEL_EMPR,
		(SELECT com.val_text_comu 
		                 FROM MAE_CLIEN_COMUN com, MAE_TIPO_COMUN tip
		                WHERE com.ticm_oid_tipo_comu = tip.oid_tipo_comu 
		                  AND com.clie_oid_clie = a.oid_clie
		                  AND tip.cod_tipo_comu = 'TM') CEL_PERS,
		(SELECT TV.DES_ABRV_TIPO_VIA ||  ' ' || CD.VAL_NOMB_VIA ||  ' ' || CD.NUM_PPAL
		    FROM MAE_CLIEN_DIREC CD, SEG_TIPO_VIA TV, MAE_TIPO_DIREC TD
		    WHERE CD.TIVI_OID_TIPO_VIA = TV.OID_TIPO_VIA
		    AND CD.TIDC_OID_TIPO_DIRE = TD.OID_TIPO_DIRE
		    AND TD.COD_TIPO_DIRE = '01'
		    AND CD.CLIE_OID_CLIE = A.OID_CLIE   
		    AND CD.IND_ELIM = '0'
		) DIR_DOMI,
		(SELECT com.val_text_comu 
		                 FROM MAE_CLIEN_COMUN com, MAE_TIPO_COMUN tip
		                WHERE com.ticm_oid_tipo_comu = tip.oid_tipo_comu 
		                  AND com.clie_oid_clie = a.oid_clie
		                  AND tip.cod_tipo_comu = 'TF') TEL_CASA,
		(SELECT com.val_text_comu 
		                 FROM MAE_CLIEN_COMUN com, MAE_TIPO_COMUN tip
		                WHERE com.ticm_oid_tipo_comu = tip.oid_tipo_comu 
		                  AND com.clie_oid_clie = a.oid_clie
		                  AND tip.cod_tipo_comu = 'ML') EMA_CLIE
		FROM SEG_PAIS P, MAE_CLIEN A, MAE_CLIEN_IDENT B, MAE_CLIEN_DATOS_ADICI D
		WHERE P.OID_PAIS = A.PAIS_OID_PAIS
		AND b.CLIE_OID_CLIE = a.OID_CLIE
		AND d.CLIE_OID_CLIE = a.OID_CLIE
		AND b.VAL_IDEN_DOCU_PRIN = 1
		AND A.COD_CLIE = #codigoCliente#
		AND P.COD_PAIS = #codigoPais#
	</select>
	
	<select id="getHistoricoDirectorioVenta" parameterClass="map" resultMap="historicoDirectorioVentaMapResult">
		SELECT
			OID_HIST_AUDI,
			COD_PAIS,
			COD_CLIE,
			VAL_APE1,
			VAL_APE2,
			VAL_NOM1,
			VAL_NOM2,
			COD_CUB,
			TDOC_OID_TIPO_DOCU,
			NUM_DOCU_IDEN,
			TO_CHAR(FEC_NACI, 'DD/MM/YYYY') FEC_NACI,
			COD_REGI,
			COD_ZONA,
			NUM_CELU_EMPR,
			NUM_CELU_PERS,
			DIR_DOMI,
			NUM_TELE_CASA,
			EMA_CLIE,
			OID_PADR_HIAU,
			NUM_IPMO,
			FEC_REGI,
			USU_REGI,
			FEC_MODI,
			USU_MODI
		FROM ZON_DIREC_HISTO_AUDIT
		WHERE COD_PAIS = #codigoPais#
		AND COD_CLIE = #codigoCliente#
		AND OID_PADR_HIAU IS NULL
	</select>
	
	<insert id="insertHistoricoDirectorioVenta" parameterClass="historicoDirectorioVenta">
		INSERT INTO ZON_DIREC_HISTO_AUDIT
		(
			OID_HIST_AUDI,
			COD_PAIS,
			COD_CLIE,
			VAL_APE1,
			VAL_APE2,
			VAL_NOM1,
			VAL_NOM2,
			COD_CUB,
			TDOC_OID_TIPO_DOCU,
			NUM_DOCU_IDEN,
			FEC_NACI,
			COD_REGI,
			COD_ZONA,
			NUM_CELU_EMPR,
			NUM_CELU_PERS,
			DIR_DOMI,
			NUM_TELE_CASA,
			EMA_CLIE,
			OID_PADR_HIAU,
			NUM_IPMO,
			FEC_REGI,
			USU_REGI)
		VALUES(
			DIREC_HISTO_AUDIT_SEQ.NEXTVAL,
			#codigoPais#,
			#codigoCliente#,
			#apellidoPaterno#,
			#apellidoMaterno#,
			#primerNombre#,
			#segundoNombre#,
			#codigoBelcorp#,
			#oidTipoDocumentoIdentidad#,
			#numeroDocumentoIdentidad#,
			TO_DATE(#fechaNacimiento#, 'DD/MM/YYYY'),
			#codigoRegion#,
			#codigoZona#,
			#numeroCelularEmpresa#,
			#numeroCelularPersonal#,
			#direccionDomicilio#,
			#numeroTelefonoCasa#,
			#email#,
			#oidPadre#,
			#auditInfo.ipMaquinaRemota#,
			#auditInfo.created#,
			#auditInfo.createdBy#)
	</insert>
	
	
	
	<parameterMap id="paramActualizarEnviosMav" class="java.util.Map">
		<parameter property="oidCliente"           jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoPais"           jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegion"         jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
		<parameter property="codigoZona"           jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoEnvio"          jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoAlta"           jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCargo"          jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="usuarioLogin"         jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />	
	</parameterMap>
	
	<procedure id="actualizarEnviosMav" parameterMap="paramActualizarEnviosMav">
		{call mav_pkg_proce.MAV_PR_ACTUA_ENVIO(?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<select id="getValidarFechaIngreso" parameterClass="java.util.Map"  resultClass="string">
		SELECT zon_pkg_unida_admin.ZON_FN_VALID_FECHA_INGRE(#tipoCargo#,#codigoPais#,#fechaIngreso#,#codigoRegion#,#codigoZona#) FROM DUAL
	</select>   
	
	<select id="getValidarCruceFechaGeren" parameterClass="java.util.Map"  resultClass="string">
		SELECT zon_pkg_unida_admin.ZON_FN_VALID_CRUCE_FECHA_GEREN(#codigoPais#,#fechaIngresoInicio#,#fechaIngresoFin#,#codigoRegion#,#codigoZona#,#tipoCargo#,#tipoOperacion#) FROM DUAL
	</select> 
	
	<parameterMap id="paramReactivacionGerentesFuturas" class="map">
		<parameter property="codigoPais"              jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="fechaProceso" 			  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />	
		<parameter property="codigoUsuario" 	      jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>
	
	<procedure id="executeReactivacionGerentesFuturas" parameterMap="paramReactivacionGerentesFuturas">
		{call zon_pkg_unida_admin.zon_pr_react_gere_futur(?, ?, ?) }
	</procedure>
	
	<procedure id="executeReactivacionGerentesFuturasFOX" parameterMap="paramReactivacionGerentesFuturas">
		{call zon_pkg_unida_admin.zon_pr_react_gere_futur_fox(?, ?, ?) }
	</procedure>
	
	<select id="getVerificaClienteSSiCC" parameterClass="java.util.Map" resultClass="string">
	   	select cl.cod_clie
	    FROM MAE_CLIEN CL, MAE_CLIEN_DATOS_ADICI DA
		WHERE CL.OID_CLIE = DA.CLIE_OID_CLIE
		   <isNotEmpty prepend="AND" property="codigoCUB">
		   	   DA.COD_CUB = #codigoCUB#
		   </isNotEmpty>
		   <isNotEmpty prepend="AND" property="usuarioRed">
		   	   DA.VAL_USUA_RED = #usuarioRed#
		   </isNotEmpty>
     </select>
     
     <select id="getVerificaClienteFOX" parameterClass="java.util.Map" resultClass="string">
	   	select x.cod_clie
	    FROM zon_direc_clien x
		WHERE 1=1
		   <isNotEmpty prepend="AND" property="codigoCUB">
		   	   X.COD_CUB = #codigoCUB#
		   </isNotEmpty>
		   <isNotEmpty prepend="AND" property="usuarioRed">
		   	   X.VAL_USUA_RED = #usuarioRed#
		   </isNotEmpty>
     </select>
     
     
     <resultMap id="getObtenerAsignacionesConsultoraSSiCCResult" class="java.util.HashMap">
		<result property="codCliente"    		column="COD_CLIE"/>
		<result property="CUB"    				column="CUB"/>
	   	<result property="nombres"    			column="NOM_CLIE"/>
	   	<result property="apePat"    			column="APE_PAT"/>
	   	<result property="apeMat"    			column="APE_MAT"/>
	   	<result property="genero"    			column="COD_SEXO"/>
		<result property="nroDoc"    			column="NUM_DOCU_IDEN"/>
		<result property="mailBelcorp" 			column="VAL_MAIL_BELCORP"/>
		<result property="telefCasa"    		column="TEL_FIJO"/>
	   	<result property="telefMovil"    		column="TEL_CELE"/>
		<result property="usuarioRed"    		column="VAL_USUA_RED"/>
		<result property="codRol"				column="COD_ROL"/>
		<result property="rol"					column="ROL"/>
		<result property="codPerfil"			column="COD_PERFIL"/>
		<result property="perfil"				column="PERFIL"/>
		<result property="codCargo"				column="TICA_COD_TIPO_CARG"/>
		<result property="cargo"    			column="DES_TIPO_CARGO"/>
		<result property="codNovedad"    		column="tiop_cod_tipo_oper"/>
		<result property="fechaInicio"    		column="FEC_REGI"/>
		<result property="fechaFin"    			column="FEC_REGI_FIN"/>
		<result property="codRegion"    		column="COD_REGI"/>
	   	<result property="desRegion"    		column="DES_REGI"/>
	   	<result property="codZona"    			column="COD_ZONA"/>
	   	<result property="desZona"    			column="DES_ZONA"/>
	   	<result property="codGrupoFuncional"    column="COD_GRUP_FUNC"/>
		<result property="desGrupoFuncional"    column="DES_GRUP_FUNC"/>
		<result property="CUBJefe"    			column="COD_CUB_JEFE"/>
		<result property="desRelContractual"    column="VAL_RELA_CONT"/>
		<result property="codPais"				column="PAIS"/>
		<result property="codPlanilla"    		column="COD_PLANILLA"/>
		<result property="estado"    			column="DES_ESTA_CARG"/>
		<result property="puestoOrg"    		column="VAL_PUE_ORG"/>
		<result property="fecIngreso"    		column="FEC_INGR"/>
		<result property="jefeDirecto"          column="VAL_NOM_JEFE"/>
		<result property="estadoCargo"    		column="ESCA_COD_ESTA_CARG"/>
		<result property="codigoPeriodo"    	column="CAM_PROC"/>
		
   </resultMap>
	
	<select id="getObtenerAsignacionesConsultoraSSiCC" parameterClass="java.util.Map" resultMap="getObtenerAsignacionesConsultoraSSiCCResult">
        SELECT TAB.*
        FROM (
            SELECT 
            c.pais_cod_pais AS PAIS,
            d.COD_REGI, 
            (SELECT O.DES_REGI FROM ZON_REGIO O WHERE O.COD_REGI = d.COD_REGI) AS DES_REGI, 
            D.COD_ZONA,
            (SELECT O.DES_ZONA FROM ZON_ZONA O WHERE O.COD_ZONA = d.COD_ZONA) AS DES_ZONA,
            (SELECT tcar.cod_tipo_carg || ' - ' || tcar.des_tipo_carg FROM zon_tipo_cargo tcar
               WHERE tcar.cod_tipo_carg = d.tica_cod_tipo_carg) DES_TIPO_CARGO,
            c.COD_CLIE, 
            (SELECT mae.VAL_NOM1||' '||mae.VAL_NOM2 FROM MAE_CLIEN mae WHERE mae.COD_CLIE =  d.COD_CLIE) NOM_CLIE,
            (SELECT mae.VAL_APE1 FROM MAE_CLIEN mae WHERE mae.COD_CLIE =  d.COD_CLIE) APE_PAT,
            (SELECT mae.VAL_APE2 FROM MAE_CLIEN mae WHERE mae.COD_CLIE =  d.COD_CLIE) APE_MAT,
            (SELECT mae.COD_SEXO FROM MAE_CLIEN mae WHERE mae.COD_CLIE =  d.COD_CLIE) COD_SEXO,
            (SELECT maid.NUM_DOCU_IDEN FROM MAE_CLIEN_IDENT maid 
                    WHERE maid.CLIE_OID_CLIE = GEN_PKG_GENER.gen_fn_devuelve_id_cliente(c.COD_CLIE)
                    AND maid.VAL_IDEN_DOCU_PRIN = '1') NUM_DOCU_IDEN,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'TF') TEL_FIJO,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'TM') TEL_CELE,
             GEN_PKG_GENER.GEN_FN_CLIEN_TEXTO_COMUN(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CLIENTE(d.COD_CLIE),'MB') VAL_MAIL_BELCORP,
             (SELECT ZEC.DES_ESTA_CARG FROM ZON_ESTAT_CARGO ZEC WHERE ZEC.COD_ESTA_CARG = C.ESCA_COD_ESTA_CARG) DES_ESTA_CARG,
            TO_CHAR(c.fec_regi, 'dd/mm/yyyy') FEC_REGI,
            TO_CHAR(c.fec_regi_fin, 'dd/mm/yyyy') FEC_REGI_FIN,
         
            d.TICA_COD_TIPO_CARG,
            (SELECT DA.COD_CUB  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) CUB,
            
            (SELECT DA.COD_GRUP_FUNC FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) COD_GRUP_FUNC,
            (SELECT DA.DES_GRUP_FUNC FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) DES_GRUP_FUNC,
            (SELECT DA.COD_CUB_JEFE  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) COD_CUB_JEFE,
            (SELECT DA.VAL_NOM_JEFE  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_NOM_JEFE,
            (SELECT DA.VAL_PUE_ORG FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_PUE_ORG,
            (SELECT DA.VAL_RELA_CONT FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_RELA_CONT,
            (SELECT DA.VAL_USUA_RED FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) VAL_USUA_RED,
            (SELECT TO_CHAR(cl.fec_ingr, 'dd/mm/yyyy')  FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND cl.COD_CLIE = c.COD_CLIE) FEC_INGR,
            (SELECT DA.COD_EMPL FROM mae_clien cl, mae_clien_datos_adici da WHERE cl.oid_clie =da.clie_oid_clie AND CL.COD_CLIE = c.COD_CLIE) COD_PLANILLA,
            
            (SELECT r.COD_ROL FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_rol r
                 WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND r.cod_rol = tcar.rol_cod_rol
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.est_regi = 1) COD_ROL,
            
            (SELECT r.des_rol FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_rol r
                 WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND r.cod_rol = tcar.rol_cod_rol
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.est_regi = 1) ROL,
                 
             (SELECT p.cod_perf FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_perfi p
                 WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND p.cod_perf = tcar.perf_cod_perf
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.est_regi = 1) COD_PERFIL,
                 
            (SELECT p.des_perf FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_perfi p
                 WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND p.cod_perf = tcar.perf_cod_perf
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.est_regi = 1) PERFIL,
            c.tiop_cod_tipo_oper,
            C.ESCA_COD_ESTA_CARG,
            C.CAM_PROC
                 
            FROM zon_direc_venta_cabec c, zon_direc_venta_detal d, zon_tipo_cargo k, ssicc_comun.zon_tipo_opera t
                 WHERE c.PAIS_COD_PAIS = #codigoPais#
                 AND LENGTH(c.cod_clie) = #longitudCodigoCliente#
                 AND c.cor_dire_vent = d.dica_cor_dire_vent
                 AND c.tiop_cod_tipo_oper = d.tiop_cod_tipo_oper
                 AND c.tica_cod_tipo_carg = d.tica_cod_tipo_carg
                 AND c.cod_clie = d.cod_clie
                 AND c.fec_regi = d.dica_fec_regi
                 AND c.esca_cod_esta_carg in ('A','I','IT')
                 AND k.cod_tipo_carg = c.tica_cod_tipo_carg
                 AND t.cod_tipo_oper = c.tiop_cod_tipo_oper
                 AND c.IND_ESTA = 'A'
                 AND d.EST_REGI = '1'
                 AND c.EST_REGI = '1'
           ) TAB WHERE 1 = 1

            <isNotEmpty property="codigoCliente" prepend="and">
                  TAB.COD_CLIE = #codigoCliente#
            </isNotEmpty>   
            
            <isNotEmpty property="validarFechaRegiFin" prepend="and">
                  (TAB.fec_regi_fin IS NULL OR TO_DATE(TAB.fec_regi_fin,'dd/mm/yyyy') >= TRUNC(SYSDATE))
            </isNotEmpty>
               
            <isNotEmpty property="codigoRegion" prepend="and">
                  TAB.COD_REGI = #codigoRegion#
            </isNotEmpty>
            <isNotEmpty property="codigoZona" prepend="and">
                  TAB.COD_ZONA = #codigoZona#
            </isNotEmpty>
            
            <isNotEmpty property="codigoTipoCargo" >
               <iterate prepend="AND" property="codigoTipoCargo" open="(" close=")" conjunction="OR">
	            	TAB.TICA_COD_TIPO_CARG = #codigoTipoCargo[]#
			   </iterate>  
            </isNotEmpty>
            
            <isNotEmpty property="estadoCargo" >
               <iterate prepend="AND" property="estadoCargo" open="(" close=")" conjunction="OR">
	            	TAB.ESCA_COD_ESTA_CARG = #estadoCargo[]#
			   </iterate>  
            </isNotEmpty>
            
            <isNotEmpty property="codigoPeriodo" prepend="and">
              	<![CDATA[  
                  ((TAB.CAM_PROC <= #codigoPeriodo# AND TAB.fec_regi_fin IS NULL) OR 
                   (TAB.CAM_PROC <= #codigoPeriodo# AND #codigoPeriodo#<= GEN_PKG_GENER.gen_fn_devuelve_perio_fecha2(#codigoPais#, 'T', 'VD', TAB.fec_regi_fin) ))
                ]]>	
            </isNotEmpty>
            
			<isNotEmpty property="codigoRol" prepend="and">
                  TAB.ROL = (SELECT DES_ROL FROM ZON_DIREC_ROL WHERE COD_ROL = #codigoRol#)
            </isNotEmpty>
            <isNotEmpty property="codigoPerfil" prepend="and">
                  TAB.PERFIL = (SELECT DES_PERF FROM ZON_DIREC_PERFI WHERE COD_PERF = #codigoPerfil#)
            </isNotEmpty>      
            <isNotEmpty property="email" prepend="and">
                  UPPER(TAB.VAL_MAIL) LIKE UPPER('%$email$%')
            </isNotEmpty>
            <isNotEmpty property="barrio" prepend="and">
                  UPPER(TAB.VAL_BARR) LIKE UPPER('%$barrio$%')
            </isNotEmpty>
            <isNotEmpty property="codigoCUB" prepend="and">
                  TAB.CUB = #codigoCUB#
            </isNotEmpty>

            ORDER BY TAB.COD_REGI, TAB.COD_ZONA, TAB.COD_CLIE ASC
	</select>
	
	
	<resultMap id="getObtenerAsignacionesConsultoraFOXResult" class="java.util.HashMap">
	   <result property="codCliente"    		column="COD_CLIE"/>
		<result property="CUB"    				column="CUB"/>
	   	<result property="nombres"    			column="NOMBRE"/>
	   	<result property="apePat"    			column="APE_PATE"/>
	   	<result property="apeMat"    			column="APE_MATE"/>
	   	<result property="genero"    			column="COD_SEXO"/>
		<result property="nroDoc"    			column="NUM_DOCU"/>
		<result property="mailBelcorp" 			column="VAL_MAIL_BELCORP"/>
		<result property="telefCasa"    		column="TEL_FIJO"/>
	   	<result property="telefMovil"    		column="NUM_CELU"/>
		<result property="usuarioRed"    		column="VAL_USUA_RED"/>
		<result property="codRol"				column="COD_ROL"/>
		<result property="rol"					column="ROL"/>
		<result property="codPerfil"			column="COD_PERFIL"/>
		<result property="perfil"				column="PERFIL"/>
		<result property="codCargo"				column="cod_tipo_carg"/>
		<result property="cargo"    			column="desc_tipo"/>
		<result property="codNovedad"    		column="NOVEDAD"/>
    	<result property="fechaInicio"    		column="FEC_REGI"/>
		<result property="fechaFin"    			column="FEC_REGI_FIN"/>
		<result property="codRegion"    		column="COD_REGI"/>
	   	<result property="desRegion"    		column="DES_REGI"/>
	   	<result property="codZona"    			column="COD_ZONA"/>
	   	<result property="desZona"    			column="DES_ZONA"/>
	   	<result property="codGrupoFuncional"    column="COD_GRUP_FUNC"/>
		<result property="desGrupoFuncional"    column="DES_GRUP_FUNC"/>
		<result property="CUBJefe"    			column="COD_CUB_JEFE"/>
		<result property="desRelContractual"    column="VAL_RELA_CONT"/>
		<result property="codPais"				column="pais_cod_pais"/>
		<result property="codPlanilla"    		column="COD_EMPL"/>
		<result property="estado"    			column="estado"/>
		<result property="puestoOrg"    		column="VAL_PUES_ORG"/>
		<result property="fecIngreso"    		column="fec_ingreso"/>
		<result property="jefeDirecto"          column="VAL_NOM_JEFE"/>
		<result property="estadoCargo"    		column="COD_ESTA_CARG"/>
		<result property="codigoPeriodo"    	column="CAM_PROC"/>  	
   </resultMap>

	<select id="getObtenerAsignacionesConsultoraFOX" parameterClass="java.util.Map" resultMap="getObtenerAsignacionesConsultoraFOXResult">
		SELECT TAB.* FROM (
		     SELECT 
		       c.CAM_PROC,
		       c.pais_cod_pais,
		       c.tiop_cod_tipo_oper, 
		       c.tica_cod_tipo_carg, 
		       c.cod_clie,
		       cli.cod_cub CUB,
		       c.cam_proc campana_proceso,
		       TO_CHAR (d.dica_fec_regi, 'dd/mm/yyyy') fec_ingreso,
		       TO_CHAR (c.fec_regi, 'dd/mm/yyyy') fec_regi,
		       TO_CHAR (c.fec_regi_fin, 'dd/mm/yyyy') fec_regi_fin,
		       k.cod_tipo_carg, 
		       k.des_tipo_carg desc_tipo,
		       
		        TRIM(CLI.VAL_NOM1) || ' ' || TRIM(CLI.VAL_NOM2) nombre,
				CLI.APE_PATE,
		        CLI.APE_MATE,
				'' COD_SEXO,
		        CLI.NUM_DOCU,
		        CLI.DIR_MAIL_BELC VAL_MAIL_BELCORP,
		        CLI.NUM_TELF_CASA TEL_FIJO,
		        CLI.NUM_TELF_CELU NUM_CELU,
		        CLI.VAL_USUA_RED,
				
				(SELECT R.COD_REGI 
				FROM ZON_DIREC_REGIO R 
				WHERE R.PAIS_COD_PAIS = d.pais_cod_pais 
				AND R.COD_REGI = d.cod_regi) cod_regi,
				
				(SELECT R.DES_REGI 
				FROM ZON_DIREC_REGIO R 
				WHERE R.PAIS_COD_PAIS = d.pais_cod_pais 
				AND R.COD_REGI = d.cod_regi) des_regi,
		    		    
				(SELECT Z.COD_ZONA
				FROM ZON_DIREC_ZONA Z, ZON_DIREC_REGIO R
				WHERE Z.PAIS_COD_PAIS = R.PAIS_COD_PAIS
				AND Z.REGI_COD_REGI = R.COD_REGI
				AND R.PAIS_COD_PAIS = d.pais_cod_pais
				AND R.COD_REGI = d.cod_regi
				AND Z.COD_ZONA = d.cod_zona) cod_zona,
				
				(SELECT Z.DES_ZONA
				FROM ZON_DIREC_ZONA Z, ZON_DIREC_REGIO R
				WHERE Z.PAIS_COD_PAIS = R.PAIS_COD_PAIS
				AND Z.REGI_COD_REGI = R.COD_REGI
				AND R.PAIS_COD_PAIS = d.pais_cod_pais
				AND R.COD_REGI = d.cod_regi
				AND Z.COD_ZONA = d.cod_zona) des_zona,
				
			   cli.COD_GRUP_FUNC,
			   cli.DES_GRUP_FUNC,
			   cli.COD_CUB_JEFE,
			   cli.VAL_RELA_CONT,
			   cli.COD_EMPL,
			   cli.VAL_NOM_JEFE,
		       e.des_esta_carg estado,
		       cli.VAL_PUES_ORG,
		       d.cor_dive_deta,
		       e.COD_ESTA_CARG,
		       k.VAL_TITU,
		       (SELECT COUNT (1)
		          FROM zon_direc_venta_cabec lv
		         WHERE lv.tiop_cod_tipo_oper = 'LI'
		           AND lv.esca_cod_esta_carg = 'IT'
		           AND lv.cod_clie = c.cod_clie
		           AND TO_CHAR (lv.fec_regr, 'yyyymmdd') > TO_CHAR (SYSDATE, 'yyyymmdd')
		           AND lv.est_regi = '1') est_lice_vige,
		       (SELECT COUNT (1)
		          FROM zon_direc_venta_cabec er
		         WHERE er.tiop_cod_tipo_oper = 'RZ'
		           AND er.esca_cod_esta_carg = 'A'
		           AND er.cod_clie = c.cod_clie
		           AND er.est_regi = '1') est_reem_lice,
		           DECODE(c.ind_esta, 'A', 'APROBADO', 'R', 'RECHAZADO', 'G', 'GRABADO') APROBACION,
		           c.tiop_cod_tipo_oper NOVEDAD,
		           c.ind_esta,
		           c.COD_CLIE_REEM,
		           TO_CHAR (c.FEC_REGR, 'dd/mm/yyyy') fecha_regreso,
		           d.COD_SUBG,
		           c.cor_dire_vent,
		           k.VAL_CANT_UNID_ADMI,
		           
		           (SELECT r.cod_rol FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_rol r
                	WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                      and r.cod_rol = tcar.rol_cod_rol
                      and c.cor_dire_vent = d.dica_cor_dire_vent
                      and c.est_regi = 1) COD_ROL,
		           
		           (SELECT r.des_rol FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_rol r
                	WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                      and r.cod_rol = tcar.rol_cod_rol
                      and c.cor_dire_vent = d.dica_cor_dire_vent
                      and c.est_regi = 1) ROL,
                      
                   (SELECT p.cod_perf FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_perfi p
                	WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                      and p.cod_perf = tcar.perf_cod_perf
                      and c.cor_dire_vent = d.dica_cor_dire_vent
                      and c.est_regi = 1) COD_PERFIL,
                      
               	   (SELECT p.des_perf FROM zon_tipo_cargo tcar, zon_direc_venta_cabec c, zon_direc_perfi p
                	WHERE tcar.cod_tipo_carg = c.tica_cod_tipo_carg
                      and p.cod_perf = tcar.perf_cod_perf
                      and c.cor_dire_vent = d.dica_cor_dire_vent
                      and c.est_regi = 1) PERFIL
		  FROM zon_direc_venta_cabec c, zon_direc_venta_detal d, zon_estat_cargo e, zon_tipo_cargo k, zon_tipo_opera t,
               zon_direc_clien cli
         WHERE c.pais_cod_pais = d.pais_cod_pais(+)
           AND c.cor_dire_vent = d.dica_cor_dire_vent(+)
           AND c.tiop_cod_tipo_oper = d.tiop_cod_tipo_oper(+)
           AND c.tica_cod_tipo_carg = d.tica_cod_tipo_carg(+)
           AND c.cod_clie = d.cod_clie(+)
           AND TO_CHAR (c.fec_regi, 'dd/mm/yyyy') = TO_CHAR (d.dica_fec_regi(+), 'dd/mm/yyyy')
           AND c.esca_cod_esta_carg = e.cod_esta_carg
           AND k.cod_tipo_carg = c.tica_cod_tipo_carg
           AND t.cod_tipo_oper = c.tiop_cod_tipo_oper
           AND (d.est_regi = '1' or d.est_regi is null)    
           AND (c.EST_REGI = '1' or c.est_regi is null)
           and c.pais_cod_pais = #codigoPais#
           AND c.pais_cod_pais = cli.pais_cod_pais
           AND c.cod_clie = cli.cod_clie
           AND LENGTH(c.cod_clie) = #longitudCodigoCliente#
		 <isNotEmpty property="codigoCliente" prepend="and">
		 	c.cod_clie = #codigoCliente#
		 </isNotEmpty>
		 
		 <isNotEmpty property="validarFechaRegiFin" prepend="and">
		      (c.fec_regi_fin IS NULL OR c.fec_regi_fin >= TRUNC(SYSDATE))
          </isNotEmpty>
		 
		 <isNotEmpty property="codigoTipoCargo" >
		 	   <iterate prepend="AND" property="codigoTipoCargo" open="(" close=")" conjunction="OR">
	            	c.tica_cod_tipo_carg = #codigoTipoCargo[]#
			   </iterate>  
		 	    
		 </isNotEmpty>
		 
		 <isNotEmpty property="estadoCargo">
              <iterate prepend="AND" property="estadoCargo" open="(" close=")" conjunction="OR">
	            	c.ESCA_COD_ESTA_CARG = #estadoCargo[]#
				</iterate>  
          </isNotEmpty>
            
		 <isNotEmpty property="codigoPeriodo" prepend="and">
		   	<![CDATA[
		 	 ((c.cam_proc <= #codigoPeriodo# AND c.fec_regi_fin IS NULL) OR 
              (c.cam_proc <= #codigoPeriodo# AND #codigoPeriodo# <= GEN_PKG_GENER.gen_fn_devuelve_perio_fecha2(#codigoPais#, 'T', 'VD', TO_CHAR(c.fec_regi_fin, 'DD/MM/YYYY')) ))
            ]]>	
		 </isNotEmpty>
		 
		 <isNotEmpty property="codigoRegion" prepend="and">
		 	d.cod_regi = #codigoRegion#
		 </isNotEmpty>
		 
		 <isNotEmpty property="codigoZona" prepend="and">
		 	d.cod_zona = #codigoZona#
		 </isNotEmpty>
		 
		  ) TAB
    	 where 1=1
    	 <isNotEmpty property="codigoCUB" prepend="and">
                  TAB.CUB = #codigoCUB#
         </isNotEmpty>
         
		 ORDER BY TAB.COD_REGI, TAB.COD_ZONA, TAB.cod_clie  DESC
   </select>
	<resultMap id="getDireccionesClientesListResult"   class="java.util.HashMap">
		<result property="oidCalle" 						  column="OID_CALLE"/>
		<result property="nivel1" 							  column="NIVEL1"/>
		<result property="nivel2" 							  column="NIVEL2"/>
		<result property="nivel3" 							  column="NIVEL3"/>
		<result property="nivel4" 							  column="NIVEL4"/>
		<result property="nivel5" 							  column="NIVEL5"/>
		<result property="nivel6" 							  column="NIVEL6"/>
	    <result property="tipoVia" 							  column="TIPO_VIA"/>
		<result property="nombreVia" 						  column="NOMBRE_VIA"/>		
		<result property="usuModi" 						  column="USU_MODI"/>	
		<result property="fecModi" 						  column="FEC_MODI"/>		
 	</resultMap>
    <select id="getDireccionesClientesList" parameterClass="java.util.Map" resultMap="getDireccionesClientesListResult">
     	SELECT 
     	 	ZN.COR_ZCAL OID_CALLE,
       		(SELECT DES_GEOG FROM ZON_VALOR_ESTRU_GEOPO WHERE ORDE_1 = ZG.ORDE_1 AND ORDE_2 IS NULL ) NIVEL1,
       		(SELECT DES_GEOG FROM ZON_VALOR_ESTRU_GEOPO WHERE ORDE_1 = ZG.ORDE_1 AND ORDE_2 = ZG.ORDE_2 AND ORDE_3 IS NULL ) NIVEL2,
       		(SELECT DES_GEOG FROM ZON_VALOR_ESTRU_GEOPO WHERE ORDE_1 = ZG.ORDE_1 AND ORDE_2 = ZG.ORDE_2 AND ORDE_3 = ZG.ORDE_3 AND ORDE_4 IS NULL ) NIVEL3,
       		(SELECT DES_GEOG FROM ZON_VALOR_ESTRU_GEOPO WHERE ORDE_1 = ZG.ORDE_1 AND ORDE_2 = ZG.ORDE_2 AND ORDE_3 = ZG.ORDE_3 AND ORDE_4 = ZG.ORDE_4 AND ORDE_5 IS NULL ) NIVEL4,
       		(SELECT DES_GEOG FROM ZON_VALOR_ESTRU_GEOPO WHERE ORDE_1 = ZG.ORDE_1 AND ORDE_2 = ZG.ORDE_2 AND ORDE_3 = ZG.ORDE_3 AND ORDE_4 = ZG.ORDE_4 AND ORDE_5 = ZG.ORDE_5 AND ORDE_6 IS NULL ) NIVEL5,
       		(SELECT DES_GEOG FROM ZON_VALOR_ESTRU_GEOPO WHERE ORDE_1 = ZG.ORDE_1 AND ORDE_2 = ZG.ORDE_2 AND ORDE_3 = ZG.ORDE_3 AND ORDE_4 = ZG.ORDE_4 AND ORDE_5 = ZG.ORDE_5 AND ORDE_6 = ZG.ORDE_6 AND ORDE_7 IS NULL ) NIVEL6,
       		I18N.VAL_I18N TIPO_VIA, 
       		ZN.NOM_CALL NOMBRE_VIA,
       		ZN.USU_MODI USU_MODI, 
       		TO_CHAR(ZN.FEC_MODI,'dd/mm/yyyy') FEC_MODI
     	FROM ZON_CALLE ZN, ZON_VALOR_ESTRU_GEOPO ZG, V_GEN_I18N_SICC I18N
			WHERE 
			ZN.VEPO_OID_VALO_ESTR_GEOP = ZG.OID_VALO_ESTR_GEOP
			AND I18N.ATTR_ENTI = 'SEG_TIPO_VIA'
			AND ZN.TIVI_OID_TIPO_VIA = I18N.VAL_OID
			AND I18N.IDIO_OID_IDIO = 1
			AND ZG.IND_ACTI = 1
			AND ZN.EST_REGI = 1
			AND ZN.PAIS_COD_PAIS = #codPais#
			<isNotEmpty prepend="AND" property="nivel1"> ZG.ORDE_1 = #nivel1# </isNotEmpty>
			<isNotEmpty prepend="AND" property="nivel2"> ZG.ORDE_2 = #nivel2# </isNotEmpty>
			<isNotEmpty prepend="AND" property="nivel3"> ZG.ORDE_3 = #nivel3# </isNotEmpty>
			<isNotEmpty prepend="AND" property="nivel4"> ZG.ORDE_4 = #nivel4# </isNotEmpty>
			<isNotEmpty prepend="AND" property="nivel5"> ZG.ORDE_5 = #nivel5# </isNotEmpty>
			<isNotEmpty prepend="AND" property="nivel6"> ZG.ORDE_6 = #nivel6# </isNotEmpty>			
			<isNotEmpty prepend="AND" property="tipoVia"> ZN.TIVI_OID_TIPO_VIA = #tipoVia# </isNotEmpty>
			<isNotEmpty prepend="AND" property="nombreVia"> LOWER(ZN.NOM_CALL) LIKE '%'||LOWER(#nombreVia#)||'%' </isNotEmpty>
			<isNotEmpty prepend="AND" property="nombreViaB"> LOWER(ZN.NOM_CALL) LIKE LOWER(#nombreViaB#) </isNotEmpty>
     		ORDER BY 2, 3, 4, I18N.VAL_I18N,  ZN.NOM_CALL
     </select>
     <select id="getIdSgteZonCalle" parameterClass="java.util.Map" resultClass="long">
		SELECT
		zon_calle_seq.nextval
		FROM
		DUAL
	</select>
	<select id="getOidValoEstrGeop" parameterClass="java.util.Map" resultClass="long">
		SELECT 
     	 ZG.OID_VALO_ESTR_GEOP
		FROM
		ZON_VALOR_ESTRU_GEOPO ZG
		WHERE
		 ZG.PAIS_OID_PAIS = #oidPais#
		 AND ZG.ORDE_1 = #nivel1#
		 AND ZG.ORDE_2 = #nivel2#
		 AND ZG.ORDE_3 = #nivel3#
		<isEmpty property="nivel4">
		   AND ZG.ORDE_4 IS NULL
		</isEmpty> 
		<isEmpty property="nivel5">
		   AND ZG.ORDE_5 IS NULL
		</isEmpty > 
		<isEmpty property="nivel6">
	   	   AND ZG.ORDE_6 IS NULL
		</isEmpty> 
		<isNotEmpty prepend="AND" property="nivel4"> ZG.ORDE_4 = #nivel4# </isNotEmpty>
		<isNotEmpty prepend="AND" property="nivel5"> ZG.ORDE_5 = #nivel5# </isNotEmpty>
		<isNotEmpty prepend="AND" property="nivel6"> ZG.ORDE_6 = #nivel6# </isNotEmpty>
		AND ZG.IND_ACTI = 1
	</select>
	<insert id="insertZonCalle" parameterClass="map">
		INSERT INTO ZON_CALLE(
			COR_ZCAL,
			PAIS_COD_PAIS,
			VEPO_OID_VALO_ESTR_GEOP,
			TIVI_OID_TIPO_VIA,
			NOM_CALL,
			USU_CREA,
			FEC_CREA,
			USU_MODI,
			FEC_MODI,
			EST_REGI
		)VALUES(
			#oidCalle#,
			#codPais#,
			#oidValoEstrGeop#,
			#tipoVia#,
			#nombreViaB#,
			#usuario#,
			SYSDATE,
			#usuario#,
			SYSDATE,
			'1'
		)
	</insert>
	<resultMap id="getZonCalleResult"   class="java.util.HashMap">
		<result property="oidCalle" 						  column="OID_CALLE"/>
		<result property="valNivel1" 							  column="NIVEL1"/>
		<result property="valNivel2" 							  column="NIVEL2"/>
		<result property="valNivel3" 							  column="NIVEL3"/>
		<result property="valNivel4" 							  column="NIVEL4"/>
		<result property="valNivel5" 							  column="NIVEL5"/>
		<result property="valNivel6" 							  column="NIVEL6"/>
	    <result property="tipoVia" 							  column="TIPO_VIA"/>
		<result property="nombreVia" 						  column="NOMBRE_VIA"/>		
 	</resultMap>
	<select id="getZonCalle" parameterClass="long" resultMap="getZonCalleResult">
     	SELECT 
     	 	ZN.COR_ZCAL OID_CALLE,
       		ZG.ORDE_1  NIVEL1,
       		ZG.ORDE_1 || ZG.ORDE_2  NIVEL2,
       		ZG.ORDE_1 || ZG.ORDE_2||ZG.ORDE_3  NIVEL3,
       		NVL2(ZG.ORDE_4,ZG.ORDE_1 || ZG.ORDE_2||ZG.ORDE_3||ZG.ORDE_4,NULL)  NIVEL4,
            NVL2(ZG.ORDE_5,ZG.ORDE_1 || ZG.ORDE_2||ZG.ORDE_3||ZG.ORDE_4||ZG.ORDE_5,NULL)  NIVEL5,
       		NVL2(ZG.ORDE_6,ZG.ORDE_1 || ZG.ORDE_2||ZG.ORDE_3||ZG.ORDE_4||ZG.ORDE_5||ZG.ORDE_6,NULL)  NIVEL6,     		
       		ZN.TIVI_OID_TIPO_VIA TIPO_VIA, 
       		ZN.NOM_CALL NOMBRE_VIA
     	FROM ZON_CALLE ZN, ZON_VALOR_ESTRU_GEOPO ZG
			WHERE 
			ZN.VEPO_OID_VALO_ESTR_GEOP = ZG.OID_VALO_ESTR_GEOP
			AND ZG.IND_ACTI = 1
			AND ZN.EST_REGI = 1			
     		AND ZN.COR_ZCAL = #oidCalle#
     </select>
     <update id="updateZonCalle" parameterClass="map">     	
		UPDATE ZON_CALLE
		SET			
			PAIS_COD_PAIS = #codPais#,
			VEPO_OID_VALO_ESTR_GEOP = #oidValoEstrGeop#,
			TIVI_OID_TIPO_VIA = #tipoVia#,
			NOM_CALL = #nombreViaB#,
			USU_MODI = #usuario#,
			FEC_MODI = SYSDATE
		WHERE
			COR_ZCAL = #oidCalle#
	</update>
	
	<update id="deleteZonCalle" parameterClass="map">     	
		UPDATE ZON_CALLE
		SET			
			EST_REGI = '9',
			USU_MODI = #usuario#,
			FEC_MODI = SYSDATE
		WHERE
			COR_ZCAL = #oidCalle#
	</update>
	
	<select id="getValidarFechaIngresoFOX" parameterClass="java.util.Map"  resultClass="string">
		SELECT zon_pkg_unida_admin.ZON_FN_VALID_FECHA_INGRE_FOX(#tipoCargo#,#codigoPais#,#fechaIngreso#,#codigoRegion#,#codigoZona#) FROM DUAL
	</select>  
	
	<select id="getPeriodoByFecha" parameterClass="java.util.Map" resultClass="java.lang.String">
		SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECHA2(#codigoPais#,#codigoMarca#,#codigoCanal#,#fecha#) FROM DUAL
   	</select>
   	
   	<select id="getPeriodoByFechaFox" parameterClass="java.util.Map" resultClass="java.lang.String">
		SELECT GEN_PKG_GENER.GEN_FN_DEVUELVE_PERIO_FECFOX(#codigoPais#,#fecha#) FROM DUAL
   	</select>
   	
   <resultMap id="controlFacturacionByCriteriaFOXResult" class="java.util.HashMap">       
    
    <result property="codigoPais"			column="PAIS_COD_PAIS"            			/> 
    <result property="codigoPeriodo"		column="CAM_PROC"            			/> 
    <result property="fechaProceso"			column="FEC_PROC"             				/> 
    <result property="estadoCampanha"		column="EST_CAMP"             /> 
    <result property="campaniaActiva" 	column="IND_CAMP_ACTI"	/>
    <result property="createdBy" 	column="USU_CREA"		/>       
    <result property="created" 	column="FEC_CREA"	/>       
    <result property="updatedBy" 	column="USU_MODI"	/>       
    <result property="lastUpdated" 	column="FEC_MODI"	/>   
	<result property="estadoRegistro" 	column="EST_REGI"	/>   

  </resultMap>  
   	
   	<select id="getControlFacturacionByCriteriaFOX" parameterClass="java.util.Map" resultMap="controlFacturacionByCriteriaFOXResult">
		SELECT CTRL.PAIS_COD_PAIS,
              CTRL.CAM_PROC,
              TO_CHAR(CTRL.FEC_PROC,'dd/mm/yyyy') FEC_PROC,
              CTRL.EST_CAMP,
              CTRL.IND_CAMP_ACTI,
              CTRL.USU_CREA,
              TO_CHAR(CTRL.FEC_CREA,'dd/mm/yyyy') FEC_CREA,
              CTRL.USU_MODI,
              TO_CHAR(CTRL.FEC_MODI,'dd/mm/yyyy') FEC_MODI,
              CTRL.EST_REGI
       FROM zon_direc_cntrl_factu  CTRL                                    
	<dynamic prepend="where">                                    
		<isNotEmpty prepend="AND" property="codigoPais">           
			CTRL.PAIS_COD_PAIS = #codigoPais#                             
    	</isNotEmpty>                                            
		<isNotEmpty prepend="AND" property="codigoPeriodo">        
			CTRL.CAM_PROC = #codigoPeriodo#                          
    	</isNotEmpty>                                            
		<isNotEmpty prepend="AND" property="estadoCampanha">        
			CTRL.EST_CAMP = #estadoCampanha#                          
    	</isNotEmpty>                                            
		<isNotEmpty prepend="AND" property="indicadorActiva">        
			CTRL.IND_CAMP_ACTI = #indicadorActiva#                          
    	</isNotEmpty>                                            
	</dynamic>                                                   
		ORDER BY CTRL.CAM_PROC DESC                                         
  </select>
   	
   	<select id="getValidaConsultoraCalle" parameterClass="java.util.Map" resultClass="string">
   	       select decode(count(*),0,'T','F') 
   	       from MAE_CLIEN_DIREC 
   	       where ZCAL_COR_ZCAL = #oidCalle#
   	</select>
   	
   	<update id="updateEstadoDirectotioVenta" parameterClass="java.util.Map">
		update ZON_DIREC_VENTA_CABEC z 
		   set z.est_regi = #estadoRegistro# 
		 where z.cod_clie = #codigoCliente#
		   and z.pais_cod_pais = #codigoPais#
		   and z.tica_cod_tipo_carg = #codigoCargo#
		   and z.cor_dire_vent = #correlativoCabecera#
		   and z.tiop_cod_tipo_oper = #codigoOperacion#
		   and z.cam_proc = #campanaProceso#
    </update>
    
    <update id="updateEstadoCargoDirectotioVenta" parameterClass="java.util.Map">
		update ZON_DIREC_VENTA_CABEC z 
	       set z.est_regi = #estadoRegistro#,
	           z.esca_cod_esta_carg = #estadoInactivo#,
	           z.fec_modi = sysdate,
	           z.usu_modi = #usuarioLogin#
	     where z.cod_clie = #codigoCliente#
	       and z.pais_cod_pais = #codigoPais#
	       and z.tica_cod_tipo_carg = #codigoCargo#
	       and z.cor_dire_vent = #correlativoCabecera#
	       and z.tiop_cod_tipo_oper = #codigoOperacion#
			   and z.cam_proc = #campanaProceso#
    </update>
</sqlMap>