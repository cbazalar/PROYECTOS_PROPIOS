<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="spusicc.zon.ProcesosZONSQL">

	<typeAlias alias="unidadGeografica" type="biz.belcorp.ssicc.dao.spusicc.zon.model.UnidadGeografica" />
	<typeAlias alias="estructuraGeografica" type="biz.belcorp.ssicc.dao.spusicc.zon.model.EstructuraGeografica" />
	<typeAlias alias="unidadAdministrativa" type="biz.belcorp.ssicc.dao.spusicc.zon.model.UnidadAdministrativa" />
	<typeAlias alias="helperUniAdmCrear" type="biz.belcorp.ssicc.dao.spusicc.zon.model.UnidadAdministrativaACrear" />
	<typeAlias alias="helperConsultoraATrasvasar" type="biz.belcorp.ssicc.dao.spusicc.zon.model.ConsultoraATrasvasar" />

	<resultMap id="unidadResult" class="unidadGeografica">
		<result property="oidEstruGeopo" column="OIDESTRU" />
		<result property="codigoOrdenEstruGeopo" column="COD_ORDE" />
		<result property="descripcionEstruGeopo" column="DESESTRU" />
		<result property="codigoSubEstruGeopo" column="CODSUBES" />
		<result property="descripcionSubEstruGeopo" column="DESSUBES" />
		<result property="codigoSubEstruGeopoColArchivo" column="CODSUBES" />
	</resultMap>
	
	<resultMap id="unidadAdministrativaCrear" class="helperUniAdmCrear">
		<result property="clave" column="CLAVE" />
		<result property="codigo" column="CODIGO" />
		<result property="descripcion" column="DESCRIPCION" />
	</resultMap>
	
	<resultMap id="consultoraATrasvasar" class="helperConsultoraATrasvasar">
		<result property="clave" column="CLAVE" />
		<result property="codigo" column="COD_CLIE" />
		<result property="nombre" column="NOM_CLIE" />
		<result property="codigoPais" column="COD_PAIS" />
		<result property="codigoMarca" column="COD_MARC" />
		<result property="codigoCanal" column="COD_CANA" />
		<result property="codigoSGV" column="COD_SUBG_VENT" />
		<result property="codigoRegion" column="COD_REGI" />
		<result property="codigoZona" column="COD_ZONA" />
		<result property="codigoSeccion" column="COD_SECC" />
		<result property="codigoTerritorio" column="COD_TERR" />
		<result property="nuevoCodigoSGV" column="COD_SUBG_VENT_NUEV" />
		<result property="nuevoCodigoRegion" column="COD_REGI_NUEV" />
		<result property="nuevoCodigoZona" column="COD_ZONA_NUEV" />
		<result property="nuevoCodigoSeccion" column="COD_SECC_NUEV" />
		<result property="nuevoCodigoTerritorio" column="COD_TERR_NUEV" />
	</resultMap>

    <resultMap id="baseResult"          class="baseGenerico">
    	<result property="codigo" 		column="CODIGO" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>

	<!-- OBTIENE LAS ESTRUCTURAS GEOPOLITICAS -->
	<select id="getPathUpload" parameterClass="string" resultClass="string">
		SELECT val_ruta_zoni FROM bas_pais WHERE cod_pais = #value#
	</select>

	<!-- OBTIENE LAS ESTRUCTURAS GEOPOLITICAS -->
	<select id="getEstructurasGeopoliticas" parameterClass="java.lang.String" resultMap="unidadResult">
		SELECT oid_estr_geop oidestru, cod_orde,
		pq_apl_aux.valor_gen_i18n_sicc (1, niv.OID_DIVI_POLI,
		'ZON_NIVEL_GEOGR' ) desestru,
		zon_pkg_unida_geogr.zon_fn_devue_cod_subes (oid_estr_geop)
		codsubes, zon_pkg_unida_geogr.zon_fn_devue_des_subes
		(oid_estr_geop) dessubes FROM zon_estru_geopo est,
		zon_nivel_geogr niv WHERE est.pais_oid_pais =
		gen_pkg_gener.GEN_FN_DEVUELVE_ID_PAIS(#value#) AND
		est.dipo_oid_divi_poli = niv.oid_divi_poli ORDER BY cod_orde
	</select>

	<insert id="insertEstructuraGeografica" parameterClass="estructuraGeografica">
		<![CDATA[
	        INSERT INTO ZON_TMP_ESTRU_GEOGR (
	        COD_NIV1, 
			COD_NIV2,
			COD_NIV3,
			COD_NIV4,
			COD_NIV5,
			COD_NIV6,
			COD_NIV7,
			COD_NIV8,
			COD_NIV9,	
			DES_NIV1,
			DES_NIV2,
			DES_NIV3,
			DES_NIV4,
			DES_NIV5,
			DES_NIV6,
			DES_NIV7,
			DES_NIV8,
			DES_NIV9,
			COD_SUBE_NIV1,
			COD_SUBE_NIV2,
			COD_SUBE_NIV3,
			COD_SUBE_NIV4,
			COD_SUBE_NIV5,
			COD_SUBE_NIV6,
			COD_SUBE_NIV7,
			COD_SUBE_NIV8,
			COD_SUBE_NIV9,
			IND_GEOR,
			VAL_FILA) 
	        VALUES ( 
	        #codigoNivel1#, 
	        #codigoNivel2#, 
	        #codigoNivel3#, 
	        #codigoNivel4#, 
	        #codigoNivel5#,
	        #codigoNivel6#,
	        #codigoNivel7#,
	        #codigoNivel8#, 
	        #codigoNivel9#, 
	        #descripcionNivel1#, 
	        #descripcionNivel2#, 
	        #descripcionNivel3#,
	        #descripcionNivel4#,
	        #descripcionNivel5#,
	        #descripcionNivel6#, 
	        #descripcionNivel7#, 
	        #descripcionNivel8#, 
	        #descripcionNivel9#, 
	        #codigoSubEstructuraNivel1#,
	        #codigoSubEstructuraNivel2#,
	        #codigoSubEstructuraNivel3#,
	        #codigoSubEstructuraNivel4#,
	        #codigoSubEstructuraNivel5#,
	        #codigoSubEstructuraNivel6#,
	        #codigoSubEstructuraNivel7#,
	        #codigoSubEstructuraNivel8#,
	        #codigoSubEstructuraNivel9#,
	        #indicadorGeoreferencia#,
	        #fila#
	        )
	    ]]>
	</insert>

	<procedure id="deleteTablasUnidadesGeograficas">
		{call zon_pkg_unida_geogr.ZON_PR_ELIMI_TABLA_GEOGR }
	</procedure>

	<parameterMap id="paramEstructurasGeograficas" class="java.util.Map">
		<parameter property="error" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>

	<procedure id="executeValidarEstructurasGeograficas" parameterMap="paramEstructurasGeograficas">
		{call zon_pkg_unida_geogr.ZON_PR_VALID_ESTRU_GEOGR(?) }
	</procedure>

	<parameterMap id="paramValidarDatosGeograficos" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>

	<procedure id="executeValidarDatosGeograficos" parameterMap="paramValidarDatosGeograficos">
		{call zon_pkg_unida_geogr.ZON_PR_VALID_DATOS_GEOGR(?) }
	</procedure>

	<parameterMap id="paramActualizarUnidadesGeograficas" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>

	<procedure id="executeActualizarUnidadesGeograficas" parameterMap="paramActualizarUnidadesGeograficas">
		{call zon_pkg_unida_geogr.ZON_PR_ACTUA_UNIDA_GEOGR(?, ?) }
	</procedure>

	<procedure id="iniciarTablasActualizaUnidadAdministrativa">
		{call zon_pkg_unida_admin.ZON_PR_ELIMI_TABLA_UNADM }
	</procedure>

	<parameterMap id="paramValidarRegionesActualizaUnidadAdministrativa" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegion" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	
	<procedure id="validarRegionCerradaActUniAdm" parameterMap="paramValidarRegionesActualizaUnidadAdministrativa">
		{call zon_pkg_unida_admin.ZON_PR_VALID_REGIO_CIERR_UNADM(?, ?, ?, ?, ?, ?, ?) }
	</procedure>

	<procedure id="validarRegionFacturadaActUniAdm" parameterMap="paramValidarRegionesActualizaUnidadAdministrativa">
		{call zon_pkg_unida_admin.ZON_PR_VALID_REGIO_FACTU_UNADM(?, ?, ?, ?, ?, ?, ?) }
	</procedure>
	
	<parameterMap id="paramValidarZonasActualizaUnidadAdministrativa" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoZona" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />		
	</parameterMap>
	
	<procedure id="validarZonaCerradaActUniAdm" parameterMap="paramValidarZonasActualizaUnidadAdministrativa">
		{call zon_pkg_unida_admin.zon_pr_valid_zonas_cierr_unadm(?, ?, ?, ?, ?, ?) }
	</procedure>

	<procedure id="validarZonaFacturadaActUniAdm" parameterMap="paramValidarZonasActualizaUnidadAdministrativa">
		{call zon_pkg_unida_admin.zon_pr_valid_zonas_factu_unadm(?, ?, ?, ?, ?, ?) }
	</procedure>

	<insert id="insertarUnidadAdministrativaTmp"
		parameterClass="unidadAdministrativa">
		<![CDATA[
	        INSERT INTO ZON_TMP_UNIDA_ADMIN (
		        NOM_ARCH, 
				COD_MARC,
				COD_CANA,
				COD_PERI,
				COD_PAIS,
				COD_SUBG_VENT,
				COD_REGI,
				COD_ZONA,
				COD_SECC,
				COD_TERR,	
				COD_UBIG,
				COD_NSE1
			) VALUES ( 
		        #nombreArchivo#, 
		        #codigoMarca#, 
		        #codigoCanal#, 
		        #codigoPeriodo#, 
		        #codigoPais#,
		        #codigoSGV#,
		        #codigoRegion#,
		        #codigoZona#,
		        #codigoSeccion#,
		        #codigoTerritorio#,
		        #ubigeo#,
		        #codigoNSE#
	        )
	    ]]>
	</insert>

	<insert id="eliminarRegionesTmp" parameterClass="list">
		DELETE ZON_TMP_UNIDA_ADMIN 
		WHERE COD_REGI IS NULL
		<iterate prepend="OR " open="(" close=")" conjunction="AND">
			COD_REGI != #[]#
		</iterate>
	</insert>
	
	<insert id="eliminarZonasTmp" parameterClass="list">
		DELETE ZON_TMP_UNIDA_ADMIN 
		WHERE cod_zona IS NULL
		<iterate prepend="OR " open="(" close=")" conjunction="AND">
			cod_zona != #[]#
		</iterate>
	</insert>

	<insert id="completarSGV">
		<![CDATA[
        UPDATE zon_tmp_unida_admin tuad
           SET tuad.cod_subg_vent =
                  (SELECT sgv.cod_subg_vent
                     FROM zon_regio reg,
                          cra_perio cper,
                          seg_perio_corpo sper,
                          zon_sub_geren_venta sgv
                    WHERE reg.pais_oid_pais = (SELECT oid_pais
                                                 FROM seg_pais
                                                WHERE cod_pais = tuad.cod_pais)
                      AND reg.marc_oid_marc = (SELECT oid_marc
                                                 FROM seg_marca
                                                WHERE cod_marc = tuad.cod_marc)
                      AND reg.cana_oid_cana = (SELECT oid_cana
                                                 FROM seg_canal
                                                WHERE cod_cana = tuad.cod_cana)
                      AND reg.cod_regi = tuad.cod_regi
                      AND cper.oid_peri = reg.perd_oid_peri_inic
                      AND sper.oid_peri = cper.peri_oid_peri
                      AND sper.cod_peri =
                             (SELECT MAX (sper1.cod_peri)
                                FROM zon_regio reg1,
                                     cra_perio cper1,
                                     seg_perio_corpo sper1
                               WHERE reg1.pais_oid_pais =
                                                     (SELECT oid_pais
                                                        FROM seg_pais
                                                       WHERE cod_pais = tuad.cod_pais)
                                 AND reg1.marc_oid_marc =
                                                     (SELECT oid_marc
                                                        FROM seg_marca
                                                       WHERE cod_marc = tuad.cod_marc)
                                 AND reg1.cana_oid_cana =
                                                     (SELECT oid_cana
                                                        FROM seg_canal
                                                       WHERE cod_cana = tuad.cod_cana)
                                 AND reg1.cod_regi = tuad.cod_regi
                                 AND cper1.oid_peri = reg1.perd_oid_peri_inic
                                 AND sper1.oid_peri = cper1.peri_oid_peri
                                 AND sper1.cod_peri <= tuad.cod_peri)
                      AND sgv.oid_subg_vent = reg.zsgv_oid_subg_vent
                      AND sgv.ind_acti = 1
                      AND sgv.ind_borr = 0
                      AND ROWNUM = 1)
         WHERE tuad.cod_subg_vent IS NULL
	    ]]>
	</insert>

	<parameterMap id="paramSoloSalidaActuUnidAdmi" class="map">
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>

	<procedure id="ejecutarPrimeraValidacionActuUnidAdmi" parameterMap="paramSoloSalidaActuUnidAdmi">
		{call zon_pkg_unida_admin.ZON_PR_PRIME_VALID_UNADM(?, ?) }
	</procedure>

	<parameterMap id="paramValidUnidAdmi" class="map">
	    <parameter property="indicadorNivelSocioEconomico" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>

	<procedure id="ejecutarValidacionActuUnidAdmi" parameterMap="paramValidUnidAdmi">
		{call zon_pkg_unida_admin.ZON_PR_SEGUN_VALID_UNADM(?, ?, ?) }
	</procedure>

	<select id="getUnidadesAdministrativasACrear" resultMap="unidadAdministrativaCrear">
		SELECT TO_CHAR(VAL_FILA) CLAVE, 
		       COD_ZONA CODIGO, 
		       DES_UNID_ADMI DESCRIPCION
		FROM ZON_HISTO_VALID_UNADM
		WHERE COD_OPER = 'A'
		  AND COD_NIVE = 'Z'
		  AND FEC_PROC IS NULL
	</select>

	<select id="getConsultorasATrasvasarActUniAdm" resultMap="consultoraATrasvasar">
		SELECT TO_CHAR(VAL_FILA) CLAVE, COD_CLIE, NOM_CLIE, COD_PAIS, COD_MARC, COD_CANA, 
		    COD_SUBG_VENT, COD_REGI, COD_ZONA, COD_SECC, COD_TERR,
		    NULL COD_SUBG_VENT_NUEV, NULL COD_REGI_NUEV, NULL COD_ZONA_NUEV, 
		    NULL COD_SECC_NUEV, NULL COD_TERR_NUEV
		  FROM zon_histo_error_elimi_unadm heeu
		 WHERE heeu.fec_proc IS NULL 
		   AND heeu.cod_nive = 'T'
		 ORDER BY COD_ZONA, COD_SECC, COD_TERR, COD_CLIE 
	</select>
	
	<insert id="grabaDescripcionUniAdmACrear" parameterClass="helperUniAdmCrear">
		UPDATE ZON_HISTO_VALID_UNADM
		SET DES_UNID_ADMI = #descripcion#
		WHERE VAL_FILA = TO_NUMBER(#clave#)
	</insert>

	<insert id="grabaCodigoTerritorioNuevoConsultoraTrasvasada" parameterClass="helperConsultoraATrasvasar">
		UPDATE zon_histo_error_elimi_unadm
		SET COD_TERR_NUEV = #nuevoCodigoTerritorio#
		WHERE VAL_FILA = TO_NUMBER(#clave#)
	</insert>

	<parameterMap id="paramEjecutarActualizacionUnidadesAdministrativas" class="map">
		<parameter property="operacion" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>

	<procedure id="ejecutarActualizacionUnidadesAdministrativas" parameterMap="paramEjecutarActualizacionUnidadesAdministrativas">
		{call zon_pkg_unida_admin.ZON_PR_ACTUA_UNIDA_ADMIN(?, ?, ?, ?) }
	</procedure>

	<parameterMap id="paramEjecutarTrasvaseConsErroElim" class="map">
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>

	<procedure id="ejecutarTrasvaseConsErroElim" parameterMap="paramEjecutarTrasvaseConsErroElim">
		{call zon_pkg_unida_admin.ZON_PR_TRASV_CONSU_ERROR_ELIMI(?, ?, ?) }
	</procedure>

	<select id="obtenerZonasDefinitivas" resultMap="baseResult">
  		SELECT zon.COD_ZONA AS CODIGO, 
  		       NVL(zon.DES_ZONA, zon.COD_ZONA) AS DESCRIPCION
		  FROM ZON_ZONA zon
         WHERE zon.pais_oid_pais = (SELECT oid_pais
                                      FROM seg_pais
                                     WHERE cod_pais = #codigoPais#)
           AND zon.marc_oid_marc = (SELECT oid_marc
                                      FROM seg_marca
                                     WHERE cod_marc = #codigoMarca#)
           AND zon.cana_oid_cana = (SELECT oid_cana
                                      FROM seg_canal
                                     WHERE cod_cana = #codigoCanal#)
           AND NOT EXISTS (SELECT 1 
                             FROM zon_histo_valid_unadm hvua
                            WHERE FEC_PROC IS NULL
                              AND cod_oper = 'B' 
                              AND cod_nive = 'Z'
                              AND cod_zona = zon.cod_zona
           )
           AND zon.IND_ACTI = 1
           AND zon.IND_BORR = 0
           AND zon.PERD_OID_PERI_FINA IS NULL
         ORDER BY COD_ZONA
	</select>

	<select id="obtenerCantidadRegistrosOperacion"  parameterClass="java.util.Map" resultClass="string">
		SELECT COUNT(*)
		  FROM ZON_HISTO_VALID_UNADM hvua
		 WHERE hvua.Cod_Pais = #codigoPais#
		   AND hvua.Cod_Oper = #operacion#
		   AND hvua.FEC_PROC IS NULL
	</select>

	<insert id="deleteTerritorioConsultoraTmp">
		DELETE FROM ZON_TMP_TERRI_CONSU
	</insert>
		  
	<insert id="insertTerritorioConsultoraTmp" parameterClass="java.util.Map">
		<![CDATA[
	        INSERT INTO ZON_TMP_TERRI_CONSU (
	        COD_PAIS,
	        COD_CLIE, 
			COD_TERR_DEST,
			VAL_FILA,
			COD_USUA_PROC) 
	        VALUES ( 
	        #codigoPais#,
	        #codigoCliente#, 
	        #codigoTerritorio#,
	        #numeroFila#,
	        #codigoUsuario#
	        )
	    ]]>
	</insert>

	<parameterMap id="paramExecValidacionesModTerritorioConsultoras" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegiones" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
		<parameter property="msgRetorno" jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>

	<procedure id="execValidacionesModTerritorioConsultoras" parameterMap="paramExecValidacionesModTerritorioConsultoras">
		{call zon_pkg_unida_admin.ZON_PR_VALID_MODIF_TERRI_CONSU(?, ?, ?, ?, ?, ?, ?, ?) }
	</procedure>

	<parameterMap id="paramExecActualizarModTerritorioConsultoras" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoPeriodo" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoUsuario" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>

	<procedure id="execActualizarModTerritorioConsultoras" parameterMap="paramExecActualizarModTerritorioConsultoras">
		{call zon_pkg_unida_admin.ZON_PR_ACTUA_MODIF_TERRI_CONSU(?, ?, ?, ?, ?) }
	</procedure>
		 
	<select id="obtenerRegionProcesar" parameterClass="string" resultClass="string">
		SELECT COUNT(*) 
		  FROM zon_tmp_unida_admin z 
		 WHERE z.cod_regi = #value#
	</select>
	
	<select id="obtenerZonaProcesar" parameterClass="string" resultClass="string">
		SELECT COUNT(*) 
		  FROM zon_tmp_unida_admin z 
		 WHERE z.cod_zona = #value#
	</select>
	
	<insert id="insertarUnidadAdministrativaDemandaTmp" parameterClass="java.util.Map">
        INSERT INTO ZON_TMP_UNIDA_ADMIN_DEMAN (
	        NOM_ARCH,
  		    COD_MARC,
			COD_CANA,
			COD_PERI,
			COD_SUBG_VENT,
			COD_REGI,
			COD_ZONA,
			COD_SECC,
			COD_TERR,
			COD_UBIG,
			COD_PAIS,
			USU_CREA,
			FEC_CREA,
			VAL_FILA
		) VALUES ( 
	        #nombreArchivo#, 
	        #codigoMarca#, 
	        #codigoCanal#, 
	        #codigoPeriodo#, 
	        #0#,
	        #1#,
	        #2#,
	        #3#,
	        #4#,
	        #6#,
	        #codigoPais#,
	        #codigoUsuario#,
	        SYSDATE,
	        #fila#
        )
   </insert>

	<insert id="deleteUnidadAdministrativaDemandaTmp">
		DELETE FROM ZON_TMP_UNIDA_ADMIN_DEMAN
	</insert>

    <select id="getRegionesDemandaByPais" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT DISTINCT
			   ZON_REGIO.COD_REGI AS CODIGO, 
		   	   UPPER(NVL(ZON_REGIO.DES_REGI, ' ')) AS DESCRIPCION
	  	FROM 	SEG_PAIS,
	       		SEG_MARCA,
	       		SEG_CANAL,
	       		ZON_REGIO,
	       		ZON_REGIO_DEMAN
	 	WHERE (	(ZON_REGIO.IND_ACTI = 1)
		  		<isNotEmpty prepend="AND" property="codigoPais">
          	  		(SEG_PAIS.COD_PAIS = #codigoPais#) 
    	  		</isNotEmpty>
	        AND (SEG_PAIS.OID_PAIS = ZON_REGIO.PAIS_OID_PAIS)
	        AND (SEG_MARCA.OID_MARC = ZON_REGIO.MARC_OID_MARC)
	        AND (SEG_CANAL.OID_CANA = ZON_REGIO.CANA_OID_CANA)
	        AND (ZON_REGIO.COD_REGI = ZON_REGIO_DEMAN.COD_REGI)
	        AND (ZON_REGIO_DEMAN.IND_ACTI = 1)
	        )
	    ORDER BY 2 ASC
    </select>

    <resultMap id="baseUnidadAdministrativaDemandaResult"    class="java.util.HashMap">
    	<result property="codigoSubGerencia"    column="COD_SUBG_VENT"/>		
    	<result property="codigoRegion"         column="COD_REGI"/>		
    	<result property="codigoZona"           column="COD_ZONA"/>		
    	<result property="codigoSeccion"        column="COD_SECC"/>
    	<result property="codigoTerritorio"     column="COD_TERR"/>
    	<result property="codigoUbigeo"         column="COD_UBIG"/>
    </resultMap>
      
    <select id="getUnidadAdministrativaDemanda" parameterClass="java.util.Map" resultMap="baseUnidadAdministrativaDemandaResult">
		SELECT COD_SUBG_VENT,
		       COD_REGI,
		       COD_ZONA,
		       COD_SECC,
		       COD_TERR,
		       COD_UBIG
		  FROM ZON_TMP_UNIDA_ADMIN_DEMAN     
		 WHERE COD_PAIS = #codigoPais#
		 ORDER BY VAL_FILA
    </select>
    
    <resultMap id="getUnidadAdministrativaConsultoraResult"  class="java.util.HashMap">
    	<result property="fila"                 column="VAL_FILA"/>		
    	<result property="codigoConsultora"     column="COD_CLIE"/>
    	<result property="codigoTerritorio"     column="COD_TERR_DEST"/>
    	<result property="estadoValidacion"     column="EST_VALI"/>		
    	<result property="indicadorAplicado"    column="IND_APLI"/>		
    	<result property="mensajeError"         column="MEN_ERRO"/>		
    </resultMap>
   
    <select id="getUnidadAdministrativaConsultora" parameterClass="java.util.Map" resultMap="getUnidadAdministrativaConsultoraResult">
		SELECT VAL_FILA,
		       COD_CLIE,
		       COD_TERR_DEST,
		       EST_VALI,
		       IND_APLI,
		       MEN_ERRO
		  FROM ZON_TMP_TERRI_CONSU     
		 WHERE COD_PAIS = #codigoPais#
		 AND MEN_ERRO IS NOT NULL
		 ORDER BY VAL_FILA
    </select>
   
   
   <select id="getUnidadAdministrativaConsultoraTotal" parameterClass="java.util.Map" resultClass="integer">
		SELECT count(1)
		FROM ZON_TMP_TERRI_CONSU   
	</select>   
    
    <select id="getUnidadAdministrativaConsultoraTotalError" parameterClass="java.util.Map" resultClass="integer">
		SELECT count(1)
		FROM ZON_TMP_TERRI_CONSU   
		WHERE MEN_ERRO IS NOT NULL
	</select>  
    
    <select id="getUnidadAdministrativaConsultoraTotalOK" parameterClass="java.util.Map" resultClass="integer">
		SELECT count(1)
		FROM ZON_TMP_TERRI_CONSU   
		WHERE MEN_ERRO IS NULL
	</select>  
    
    <select id="getErroresUnidadAdministrativaDemanda" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT VAL_OBSE AS CODIGO,
		       COUNT(1) AS DESCRIPCION
		  FROM ZON_TMP_UNIDA_ADMIN_DEMAN
		<![CDATA[
		 WHERE EST_VALI <> 'OK'
	    ]]>
		 GROUP BY EST_VALI, VAL_OBSE
    </select>
    
	<parameterMap id="paramValidarUnidadAdministrativaDemanda" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="codigoRegiones" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />		
	</parameterMap>

	<procedure id="executeValidarUnidadAdministrativaDemanda" parameterMap="paramValidarUnidadAdministrativaDemanda">
		{call ZON_PKG_UNIDA_ADMIN.ZON_PR_VALID_CREAR_TERRI_DEMAN(?, ?) }
	</procedure>

	<parameterMap id="paramProcesarUnidadAdministrativaDemanda" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
	</parameterMap>

	<procedure id="executeProcesarUnidadAdministrativaDemanda" parameterMap="paramProcesarUnidadAdministrativaDemanda">
		{call ZON_PKG_UNIDA_ADMIN.ZON_PR_PROCE_CREAR_TERRI_DEMAN(?) }
	</procedure>

    <resultMap id="subgerenciasMapResult" class="java.util.HashMap">
    	<result property="codigoPais" column="COD_PAIS"/>
    	<result property="oidSubgerencia" column="OID_SUBG_VENT"/>
    </resultMap>

	<select id="getSubgerencias" resultMap="subgerenciasMapResult">
		select sp.cod_pais, sg.oid_subg_vent 
		from zon_sub_geren_venta sg, seg_pais sp
		where sg.pais_oid_pais = sp.oid_pais
	</select>

    <resultMap id="territoriosMapResult" class="java.util.HashMap">
		<result property="codigoPais" column="COD_PAIS"/>
		<result property="codigoCompania" column="COD_EMP"/>
		<result property="codigoRegion" column="COD_REGI"/>
		<result property="codigoZona" column="COD_ZONA"/>
		<result property="codigoSeccion" column="COD_SECC"/>
		<result property="codigoTerritorio" column="COD_TERR"/>
		<result property="codigoDepartamento" column="ORDE_1"/>
		<result property="codigoMunicipio" column="ORDE_2"/>
		<result property="codigoCentPoblado" column="ORDE_3"/>    	
    </resultMap>
	
	<select id="getTerritoriosByCriteria" parameterClass="map" resultMap="territoriosMapResult">
		SELECT
		    #codigoPais# COD_PAIS,
		    #codigoCompania# COD_EMP,   
		    R.COD_REGI,
		    Z.COD_ZONA,
		    S.COD_SECC,
		    ZT.COD_TERR,
            to_number(G.ORDE_1) ORDE_1,
            to_number(G.ORDE_2) ORDE_2,
            to_number(G.ORDE_3) ORDE_3
		    FROM ZON_REGIO R, ZON_ZONA Z, ZON_SECCI S, ZON_TERRI_ADMIN T, ZON_TERRI ZT, ZON_VALOR_ESTRU_GEOPO G
		    WHERE R.ZSGV_OID_SUBG_VENT = #oidSubgerencia#
		    AND R.OID_REGI = Z.ZORG_OID_REGI 
		    AND Z.OID_ZONA = S.ZZON_OID_ZONA
		    AND S.OID_SECC = T.ZSCC_OID_SECC
		    AND T.TERR_OID_TERR = ZT.OID_TERR 
		    AND G.OID_VALO_ESTR_GEOP = ZT.VEPO_OID_VALO_ESTR_GEOP
		    AND R.IND_ACTI = '1'
		    AND R.IND_BORR = '0'                
		    AND Z.IND_ACTI = '1'
		    AND Z.IND_BORR = '0'                
		    AND S.IND_ACTI = '1'
		    AND S.IND_BORR = '0'
		    AND T.IND_BORR = '0'                
		    AND ZT.IND_BORR = '0'
		    AND G.IND_ACTI = '1'
		    AND G.IND_BORR = '0'
	</select>

    <resultMap id="ubigeosMapResult" class="java.util.HashMap">
		<result property="codigoPais" column="COD_PAIS"/>
		<result property="codigoCompania" column="COD_EMP"/>
		<result property="codigoDepartamento" column="COD_DPTO"/>
		<result property="codigoMunicipio" column="COD_MUNI"/>
		<result property="codigoCentPoblado" column="COD_CPOB"/>    	
		<result property="descriCentPoblado" column="NOM_CPOB"/>
		<result property="descriDepartamento" column="NOM_DPTO"/>
		<result property="descriMunicipio" column="NOM_MUNI"/>
		<result property="estadoGeoreferenc" column="IND_GEOR"/>
    </resultMap>
	
	<select id="getUbigeosByCriteria" parameterClass="map" resultMap="ubigeosMapResult">
	    SELECT 
	    #codigoPais# COD_PAIS,
	    #codigoCompania# COD_EMP,   
	    to_number(ORDE_1) COD_DPTO, 
	    to_number(ORDE_2) COD_MUNI,
	    to_number(ORDE_3) COD_CPOB,
	    (
	        SELECT DP.DES_GEOG CPOB
	        FROM ZON_VALOR_ESTRU_GEOPO DP 
	        WHERE DP.ORDE_1 = TBL.ORDE_1
	        AND DP.ORDE_2 IS NULL
	        AND DP.ORDE_3 IS NULL
	        AND DP.IND_ACTI = '1'
	        AND DP.IND_BORR = '0'  
	        AND ROWNUM = 1              
	    ) NOM_DPTO,
	    (
	        SELECT MU.DES_GEOG CPOB
	        FROM ZON_VALOR_ESTRU_GEOPO MU 
	        WHERE MU.ORDE_1 = TBL.ORDE_1
	        AND MU.ORDE_2 = TBL.ORDE_2
	        AND MU.ORDE_3 IS NULL
	        AND MU.IND_ACTI = '1'
	        AND MU.IND_BORR = '0'
	        AND ROWNUM = 1    
	    ) NOM_MUNI,
	    TBL.DES_GEOG NOM_CPOB,
	    DECODE(TBL.IND_GEOR, '1', 'S', 'N') IND_GEOR
	    FROM ZON_VALOR_ESTRU_GEOPO TBL
	    WHERE IND_ACTI = '1'
	    AND IND_BORR = '0'
	    AND tbl.orde_3  is not null
	    
   	</select>
   	
   	<delete id="deleteTemporalRegiones">
       DELETE FROM ZON_TMP_DIREC_REGIO
    </delete>
   	
   	<delete id="deleteTemporalZonas">
       DELETE FROM ZON_TMP_DIREC_ZONA
    </delete>
    
    <delete id="deleteTemporalCampanha">
       DELETE FROM ZON_TMP_DIREC_CAMPA
    </delete>
    
    <delete id="deleteTemporalControlFacturacion">
       DELETE FROM ZON_TMP_DIREC_CNTRL_FACTU
    </delete>
    
    <delete id="deleteTemporalConsultoras">
       DELETE FROM ZON_TMP_DIREC_CLIEN
    </delete>
    
    <insert id="insertTemporalRegiones" parameterClass="java.util.Map">
				INSERT INTO ZON_TMP_DIREC_REGIO (
							PAIS_COD_PAIS, 
							COD_REGI, 
							DES_REGI, 
							CLIE_COD_CLIE, 
							IND_ACTI, 
							USU_CREA, 
							FEC_CREA, 
							USU_MODI, 
							FEC_MODI, 
							EST_REGI
							) 
						VALUES ( 
							#codigoPais#	, 
							#codigoRegion#  ,
							#descripcionRegion# ,
							#codigoCliente#,
							#indicadorActividad#, 
							NVL(#codigoUsuario#, USER),
							NVL(to_date(#fechaCreacion#, 'dd/mm/yyyy'), SYSDATE),
							#usuarioModificacion#,
							to_date(#fechaModificacion#, 'dd/mm/yyyy'),
							#estadoRegistro#
							 )                      
	</insert>
	
	<insert id="insertTemporalZonas" parameterClass="java.util.Map">
				INSERT INTO ZON_TMP_DIREC_ZONA (
							PAIS_COD_PAIS, 
							REGI_COD_REGI, 
							COD_ZONA, 
							DES_ZONA, 
							CLIE_COD_CLIE, 
							IND_ACTI, 
							USU_CREA, 
							FEC_CREA, 
							USU_MODI, 
							FEC_MODI, 							
							EST_REGI) 
						VALUES ( 
							#codigoPais#	, 
							#codigoRegion#  ,
							#codigoZona# ,
							#descripcionZona#,
							#codigoCliente#,
							#indicadorActividad#,
							NVL(#codigoUsuario#, USER),
							NVL(to_date(#fechaCreacion#, 'dd/mm/yyyy'), SYSDATE),
							#usuarioModificacion#,
							to_date(#fechaModificacion#, 'dd/mm/yyyy'),
							#estadoRegistro#
							 )                      
	</insert>
	
	<insert id="insertTemporalCampanha" parameterClass="java.util.Map">

				INSERT INTO ZON_TMP_DIREC_CAMPA (
							PAIS_COD_PAIS, 
							COD_CAMP, 
							FEC_INIC, 
							FEC_FINA, 
							USU_CREA, 
							FEC_CREA, 
							USU_MODI, 
							FEC_MODI, 
							EST_REGI) 
						VALUES ( 
							#codigoPais#	, 
							#codigoPeriodo#  ,
							to_date(#fechaInicio# , 'dd/mm/yyyy'),
							to_date(#fechaFin# , 'dd/mm/yyyy'),
							NVL(#codigoUsuario#, USER),
							NVL(to_date(#fechaCreacion#, 'dd/mm/yyyy'), SYSDATE),
							#usuarioModificacion#,
							to_date(#fechaModificacion#, 'dd/mm/yyyy'),
							#estadoRegistro#
							 )                      
	</insert>
	
	<insert id="insertTemporalControlFacturacion" parameterClass="java.util.Map">

				INSERT INTO ZON_TMP_DIREC_CNTRL_FACTU (
							COD_PAIS, 
							CAM_PROC, 
							FEC_PROC, 
							EST_CAMP, 
							IND_CAMP_ACTI, 
							USU_CREA, 
							FEC_CREA, 
							USU_MODI, 
							FEC_MODI, 
							EST_REGI) 
						VALUES ( 
							#codigoPais#	, 
							#codigoPeriodo#  ,
							to_date(#fechaProceso# , 'dd/mm/yyyy'),
							#estadoPeriodo# ,
							#indicadorActividad# ,
							NVL(#codigoUsuario#, USER),
							NVL(to_date(#fechaCreacion#, 'dd/mm/yyyy'), SYSDATE),
							#usuarioModificacion#,
							to_date(#fechaModificacion#, 'dd/mm/yyyy'),
							#estadoRegistro#
							 )                      
	</insert>
	
	<insert id="insertTemporalConsultoras" parameterClass="java.util.Map">

				INSERT INTO ZON_TMP_DIREC_CLIEN (
							PAIS_COD_PAIS, 
							COD_CLIE, 
							APE_PATE, 
							APE_MATE, 
							APE_CASA, 
							VAL_NOM1, 
							VAL_NOM2, 
							NUM_DOCU, 
							NUM_TELF_CASA, 
							NUM_TELF_CELU, 
							DIR_MAIL, 
							DIR_DOMI, 
							UBI_DOMI, 
							DIR_ENTR, 
							UBI_ENTR, 
							FEC_NACI, 
							FEC_INGR, 
							CAM_INGR, 
							IND_ACTI, 
							USU_CREA, 
							FEC_CREA, 
							USU_MODI, 
							FEC_MODI, 
							EST_REGI, 
							COD_CUB, 
							COD_EMPL, 
							
							COD_GRUP_FUNC, 
							DES_GRUP_FUNC, 
							COD_CUB_JEFE, 
							VAL_RELA_CONT, 
							VAL_USUA_RED, 
							VAL_NOM_JEFE, 
							VAL_PUE_ORG, 
							DIR_MAIL_BELC, 
							COD_TIPO_CLIE, 
							COD_SUBT_CLIE) 
						VALUES ( 
							#codigoPais#	, 
							#codigoCliente# , 
							#apellidoPaterno#  ,
							#apellidoMaterno# ,
							NULL,
							#nombre1#,
							#nombre2# , 
							#numeroDocumento#  ,
							#telefonoCasa# ,
							#celular#,
							#mail# , 
							#direccion#  ,
							#ubigeo# ,
							#direccionEntrega#,
							#ubigeoEntrega# , 
							to_date(#fechaNacimiento# , 'dd/mm/yyyy'),
							to_date(#fechaIngreso# , 'dd/mm/yyyy'),
							#campanhaIngreso#,
							#indicadorActivo# , 
							NVL(#codigoUsuario#, USER),
							NVL(to_date(#fechaCreacion#, 'dd/mm/yyyy'), SYSDATE),
							#usuarioModificacion#,
							to_date(#fechaModificacion#, 'dd/mm/yyyy'),
							#estadoRegistro#,
							#codigoCUB#, 
							#codigoEmpleado#,
							
							#codigoGrupoFuncional#,
							#descripcionGrupoFuncional#,
							#codigoJefeCUB#, 
							#relacionContractual#,
							#usuarioRed#,
							#nombreJefeDirecto#,
							#puestoOrganizacional#,
							#mailBelcorp#,
							#codigoTipoCliente#,
							#codigoSubTipoCliente#
							 )                      
	</insert>
	
	<parameterMap id="updateMaestroRegionesParams" class="map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="updateMaestroRegiones"   parameterMap="updateMaestroRegionesParams" >
		{call zon_pkg_unida_admin.ZON_PR_CARGA_REGIO(?, ?)}
    </procedure>  
    
    
    <parameterMap id="updateMaestroZonasParams" class="map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="updateMaestroZonas"   parameterMap="updateMaestroZonasParams" >
		{call zon_pkg_unida_admin.ZON_PR_CARGA_ZONAS(?, ?)}
    </procedure>  
    
    
    <parameterMap id="updateMaestroCampanhaParams" class="map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="updateMaestroCampanha"   parameterMap="updateMaestroCampanhaParams" >
		{call zon_pkg_unida_admin.ZON_PR_CARGA_CAMPA(?, ?)}
    </procedure>  
    
    
    <parameterMap id="updateMaestroControlFacturacionParams" class="map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="updateMaestroControlFacturacion"   parameterMap="updateMaestroControlFacturacionParams" >
		{call zon_pkg_unida_admin.ZON_PR_CARGA_CNTRL_FACTU(?, ?)}
    </procedure>  
    
    
    <parameterMap id="updateMaestroConsultorasParams" class="map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="updateMaestroConsultoras"   parameterMap="updateMaestroConsultorasParams" >
		{call zon_pkg_unida_admin.ZON_PR_CARGA_CONSU(?, ?)}
    </procedure>  
    
   	
    <resultMap id="getZONRegionesDirectorioVentasResult" class="java.util.HashMap">
		<result property="codigoPais"             column="PAIS_COD_PAIS"/>
        <result property="codigoRegion"           column="COD_REGI"/>
        <result property="descripcionRegion"      column="DES_REGI"/>
        <result property="codigoCliente"     	  column="CLIE_COD_CLIE"/>
        <result property="indicadorActividad"     column="IND_ACTI"/>
		<result property="usuarioCreacion"        column="USU_CREA"/>
		<result property="fechaCreacion"          column="FEC_CREA"/>
		<result property="usuarioModificacion"    column="USU_MODI"/>
		<result property="fechaModificacion"      column="FEC_MODI"/>
		<result property="estadoRegistro"         column="EST_REGI"/>
    </resultMap>
	
	<select id="getZONRegionesDirectorioVentas" parameterClass="map" resultMap="getZONRegionesDirectorioVentasResult">
	    SELECT 
	    	PAIS_COD_PAIS, 
			COD_REGI, 
			DES_REGI, 
			CLIE_COD_CLIE, 
			IND_ACTI, 
			USU_CREA, 
			FEC_CREA, 
			USU_MODI, 
			FEC_MODI, 
			EST_REGI
		FROM ZON_DIREC_REGIO
		WHERE 
		   PAIS_COD_PAIS = #codigoPais#
	</select>
	
	<resultMap id="getZONZonasDirectorioVentasResult" class="java.util.HashMap">
		<result property="codigoPais"             column="PAIS_COD_PAIS"/>
        <result property="codigoRegion"           column="REGI_COD_REGI"/>
        <result property="codigoZona"             column="COD_ZONA"/>
        <result property="descripcionZona"        column="DES_ZONA"/>
        <result property="codigoCliente"     	  column="CLIE_COD_CLIE"/>
        <result property="indicadorActividad"     column="IND_ACTI"/>
		<result property="usuarioCreacion"        column="USU_CREA"/>
		<result property="fechaCreacion"          column="FEC_CREA"/>
		<result property="usuarioModificacion"    column="USU_MODI"/>
		<result property="fechaModificacion"      column="FEC_MODI"/>
		<result property="estadoRegistro"         column="EST_REGI"/>
    </resultMap>
	
	<select id="getZONZonasDirectorioVentas" parameterClass="map" resultMap="getZONZonasDirectorioVentasResult">
	    SELECT 
	    	PAIS_COD_PAIS, 
			REGI_COD_REGI, 
			COD_ZONA, 
			DES_ZONA, 
			CLIE_COD_CLIE, 
			IND_ACTI, 
			USU_CREA, 
			FEC_CREA, 
			USU_MODI, 
			FEC_MODI, 
			EST_REGI
		FROM ZON_DIREC_ZONA
		WHERE 
		   PAIS_COD_PAIS = #codigoPais#
	</select>
	
	<resultMap id="getZONHistorialGerentesDirectorioVentasResult" class="java.util.HashMap">
		<result property="codigoPais"             column="PAIS_COD_PAIS"/>
        <result property="correlativo"            column="COR_HIST_GERE"/>
        <result property="codigoUnidadAdmin"      column="UNI_ADMI"/>
        <result property="codigoRegion"           column="REGI_COD_REGI"/>
        <result property="codigoZona"             column="ZONA_COD_ZONA"/>
        <result property="codigoCliente"     	  column="CLIE_COD_CLIE"/>
        <result property="fechaDesde"             column="FEC_DESD"/>
        <result property="fechaHasta"             column="FEC_HAST"/>
        <result property="periodoDesde"           column="CAM_DESD"/>
        <result property="periodoHasta"           column="CAM_HAST"/>
		<result property="usuarioCreacion"        column="USU_CREA"/>
		<result property="fechaCreacion"          column="FEC_CREA"/>
		<result property="usuarioModificacion"    column="USU_MODI"/>
		<result property="fechaModificacion"      column="FEC_MODI"/>
		<result property="estadoRegistro"         column="EST_REGI"/>
    </resultMap>
	
	<select id="getZONHistorialGerentesDirectorioVentas" parameterClass="map" resultMap="getZONHistorialGerentesDirectorioVentasResult">
	    SELECT 
	    	PAIS_COD_PAIS, 
			COR_HIST_GERE, 
			UNI_ADMI, 
			REGI_COD_REGI, 
			ZONA_COD_ZONA, 
			CLIE_COD_CLIE, 
			FEC_DESD, 
			FEC_HAST, 
			CAM_DESD, 
			CAM_HAST, 
			USU_CREA, 
			FEC_CREA, 
			USU_MODI, 
			FEC_MODI, 
			EST_REGI
		FROM ZON_DIREC_HISTO_GEREN
		WHERE 
		   PAIS_COD_PAIS = #codigoPais#
	</select>
    
    <delete id="deleteCargarTerritorioUnidadGeografica" parameterClass="string">
    	DELETE FROM ZON_TEMPO_TERRI_GEOPO WHERE COD_USUA = #value#
    </delete>
    
    <insert id="insertCargarTerritorioUnidadGeografica" parameterClass="map">
    	INSERT INTO ZON_TEMPO_TERRI_GEOPO(
    		NUM_FILA,
			COD_TERR,
			COD_GEOG,
			COD_USUA)
    	VALUES(
    		#numeroFila#,
    		#codigoTerritorio#,
    		#codigoGeografia#,
    		#codigoUsuario#
    	)
    </insert>
    
	<resultMap id="cargarTerritorioUnidadGeograficaMapResult" class="java.util.HashMap">
		<result property="numeroFila" column="NUM_FILA" />
		<result property="codigoTerritorio" column="COD_TERR" />
		<result property="codigoGeografia" column="COD_GEOG" />
		<result property="mensajeError" column="MEN_ERRO" />
	</resultMap>    
    <select id="getCargarTerritorioUnidadGeografica" parameterClass="string" resultMap="cargarTerritorioUnidadGeograficaMapResult">
    	SELECT
    		NUM_FILA,
			COD_TERR,
			COD_GEOG,
			MEN_ERRO
    	FROM ZON_TEMPO_TERRI_GEOPO
    	WHERE COD_USUA = #value#
    	AND EST_REGI = '0'
    	ORDER BY NUM_FILA
    </select>   	
   	
    <parameterMap id="validarCargaTerritorioUnidadGeograficaParams" class="map">
		<parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeValidarCargaTerritorioUnidadGeografica"   parameterMap="validarCargaTerritorioUnidadGeograficaParams" >
		{call ZON_PKG_UNIDA_ADMIN.ZON_PR_VALIDAR_TERRI_UNGEO(?)}
    </procedure>  
   	
    <parameterMap id="procesarCargaTerritorioUnidadGeograficaParams" class="map">
		<parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    
    <procedure id="executeProcesarCargaTerritorioUnidadGeografica"   parameterMap="procesarCargaTerritorioUnidadGeograficaParams" >
		{call ZON_PKG_UNIDA_ADMIN.ZON_PR_CARGAR_TERRI_UNGEO(?)}
    </procedure>  
   	
</sqlMap>