<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="sisicc.ProcesosCOMSQL">
  	<typeAlias alias="bloqueoLider"	    type="biz.belcorp.ssicc.dao.sisicc.model.BloqueoLider"/>
    <typeAlias alias="bloqueoLiderPK" 	type="biz.belcorp.ssicc.dao.sisicc.model.BloqueoLiderPK"/>
    <typeAlias alias="libretaAhorro"    type="biz.belcorp.ssicc.dao.sisicc.model.LibretaAhorro"/>
    <typeAlias alias="comisionGerenteZona"     type="biz.belcorp.ssicc.dao.spusicc.comision.model.ComisionPeriodoGerenteZona"/>
    <typeAlias alias="comisionLideres"         type="biz.belcorp.ssicc.dao.spusicc.comision.model.ComisionPeriodoLideres"/>
	<typeAlias alias="parametroTramoComision"  type="biz.belcorp.ssicc.dao.spusicc.comision.model.ParametroTramoComision"/>
	<typeAlias alias="baseGenericoCom"         type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>
    <typeAlias alias="datosComision"     type="biz.belcorp.ssicc.dao.spusicc.comision.model.DatosComision"/>

    <resultMap id="baseResultCom" class="baseGenericoCom">
    	<result property="codigo" 		column="CODIGO" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>  
    
  	<resultMap id="bloqueoLiderResult"              class="bloqueoLider">
    	<result property="nombreApellidos"			column="NOMBREAPELLIDOS"/>
    	<result property="codigo" 					column="COD_CLIB"/>
    	<result property="codigoPais" 				column="PAIS_COD_PAIS"/>
    	<result property="periodoInicial" 			column="PER_INIC"/>
	    <result property="periodoFinal" 		 	column="PER_FINA"/>
        <result property="estado" 				    column="EST_CLIB"/>	    
        <result property="auditInfo.createdBy" 		column="USU_DIGI"/>
        <result property="auditInfo.created" 		column="FEC_DIGI"/>
        <result property="auditInfo.updatedBy" 		column="USU_MODI"/>
        <result property="auditInfo.lastUpdated" 	column="FEC_MODI"/>    	    	
	</resultMap>
   
    <resultMap id="libretaAhorroResult"          class="libretaAhorro">
		<result property="codigoLider" 			 column="CODIGOLIDER"/>
		<result property="codigoPlanilla" 		 column="CODIGOPLANILLA"/>
		<result property="nombreApellidos"       column="NOMBREAPELLIDOS"/>
		<result property="centroCosto" 			 column="CENTROCOSTO"/>
		<result property="documentoIdentidad" 	 column="DOCUMENTOIDENTIDAD"/>
		<result property="numeroLibretaAhorro" 	 column="NUMEROLIBRETAAHORRO"/>
		<result property="codCcci"			 	 column="CODCCCI"/>
		<result property="periodoIngreso" 		 column="PERIODOINGRESO"/>
		<result property="codigoPais" 			 column="CODIGOPAIS"/>
		<result property="razonSocial" 		     column="RAZONSOCIAL"/>						
		<result property="tipoRegimen" 		     column="TIPOREGIMEN"/>
    </resultMap>
       
    <resultMap id="libretaAhorroBeanResult"      class="libretaAhorro">
		<result property="codigoLider" 			 column="CODIGOLIDER"/>
		<result property="codigoPais" 			 column="CODIGOPAIS"/>
		<result property="codigoPlanilla" 		 column="CODIGOPLANILLA"/>
		<result property="centroCosto" 			 column="CENTROCOSTO"/>
		<result property="documentoIdentidad" 	 column="DOCUMENTOIDENTIDAD"/>
		<result property="numeroLibretaAhorro" 	 column="NUMEROLIBRETAAHORRO"/>
		<result property="codCcci"			 	 column="CODCCCI"/>		
		<result property="periodoIngreso" 		 column="PERIODOINGRESO"/>
		<result property="paterno"      		 column="PATERNO"/>
		<result property="materno" 		         column="MATERNO"/>
		<result property="nombre" 		         column="NOMBRE"/>
		<result property="ruc" 		         	 column="RUC"/>
		<result property="razonSocial" 		     column="RAZONSOCIAL"/>				
		<result property="tipoRegimen" 		     column="TIPOREGIMEN"/>
    <result property="cuentaDetraccion" 	 column="CUENTADETRACCION"/>
    </resultMap>
    
    <resultMap id="comisionGerenteZonaResult"      class="comisionGerenteZona">
		<result property="codigoPeriodo"                   column="PERI_COD_PERI"/>	   
		<result property="codigoComision"                  column="COD_COMI"/>	       
		<result property="codigoLiderZona"                 column="COD_LIDE_ZONA"/>	   
		<result property="nombreLiderZona"                 column="NOM_LIDE_ZONA"/>	  
		<result property="codigoRegion"                    column="COD_REGI"/>	
		<result property="codigoZona"                      column="COD_ZONA"/>	
		<result property="tipoComision"                    column="COD_TIPO_COMI"/>	
		<result property="fechaCalculo"                    column="FEC_CALC"/>	
		<result property="importeNetoSinReclamo"           column="IMP_NETO_SREC"/>	
		<result property="importeAntesLimiteTramo1"        column="IMP_PAGO_ANTE_LIMI"/>
		<result property="importeAntesLimiteTramo2"        column="IMP_PAGO_ANTE_LIMI_TRA2"/>	
		<result property="porcentajeRecuperacionTramo1"    column="POR_RECU"/>	
		<result property="porcentajeRecuperacionTramo2"    column="POR_RECU_TRA2"/>	
		<result property="importeComisionTramo1"           column="IMP_COMI_TRA1"/>	
		<result property="importeComisionTramo2"           column="IMP_COMI_TRA2"/>	
		<result property="codigoPlanilla"                  column="COD_EMPL"/>	
		<result property="descripcionRegion"               column="DES_REGI"/>	
		<result property="descripcionZona"                 column="DES_ZONA"/>
		<result property="importeSumaComision"             column="SUM_COMI"/>
		<result property="importeComisionActividad"        column="IMP_COMI_ACTI"/>
		<result property="valorPorcentajeActividad"        column="VAL_PORC_ACTI"/>
		<result property="valorPorcentajeComisionTramo1"   column="VAL_PORC_COMI_TRA1"/>
		<result property="valorPorcentajeComisionTramo2"   column="VAL_PORC_COMI_TRA2"/>
    </resultMap>

<resultMap id="comisionGerenteZonaEscalonadaResult"      class="comisionGerenteZona">
		<result property="codigoPeriodo"                   column="PERI_COD_PERI"/>	   
		<result property="codigoComision"                  column="COD_COMI"/>	       
		<result property="codigoLiderZona"                 column="COD_LIDE_ZONA"/>	   
		<result property="nombreLiderZona"                 column="NOM_LIDE_ZONA"/>	  
		<result property="codigoRegion"                    column="COD_REGI"/>	
		<result property="codigoZona"                      column="COD_ZONA"/>	
		<result property="tipoComision"                    column="COD_TIPO_COMI"/>	
		<result property="fechaCalculo"                    column="FEC_CALC"/>	
		<result property="numeroDocumentoIdentidad"        column="NUM_DOCU_IDEN"/>
		<result property="porcentajeRecuperacionTramo1"    column="POR_RECU"/>	
		<result property="simporteAntesLimiteTramo1"        column="IMP_PAGO_ANTE_LIMI"/>
		<result property="simporteNetoSinReclamo"           column="IMP_NETO_SREC"/>
		<result property="smontoFacturado"                  column="IMP_NETO_CIMP"/>			
		<result property="scargoFraccionado"                column="CAR_FRAC"/>	
		<result property="sfacturadoTotal"                  column="FAC_TOTA"/>	
		<result property="simporteImpuesto"                 column="VAL_IMPU"/>
		<result property="simporteReclamo"                  column="IMP_RECL"/>	
		<result property="ssaldo"                           column="VAL_SALD"/>	
		<result property="sventaNetaEfectiva"               column="VEN_NETA_EFEC"/>
		<result property="sdiferenciaVentaNetaEfectiva"     column="DIF_VENT_NETA_EFEC"/>		
		<result property="escalaInicial"                   column="POR_RECU_INIC"/>	
		<result property="escalaFinal"                     column="POR_RECU_FINA"/>
		<result property="porcentajeComisionParametrizado" column="POR_COMI"/>
		<result property="porcentajeIncremento"            column="POR_ADIC"/>
		<result property="simporteComisionTramo1"           column="IMP_COMI_TRA1"/>
		<result property="vencimiento"			           column="FEC_VENC"/>
		<result property="demandaAnticipada"	           column="DEM_ANTI"/>
		
    </resultMap>					

    <resultMap id="comisionLideresResult"      class="comisionLideres">
		<result property="codigoPeriodo"                   column="PERI_COD_PERI"/>	   
		<result property="codigoComision"                  column="COD_COMI"/>	       
		<result property="codigoComisionIngreso"           column="COD_COMI_INGR"/>	       
		<result property="codigoLiderSeccion"              column="COD_LIDE_SECC"/>	   
		<result property="nombreLiderSeccion"              column="NOM_LIDE_SECC"/>	  
		<result property="codigoRegion"                    column="COD_REGI"/>	
		<result property="codigoZona"                      column="COD_ZONA"/>	
		<result property="codigoSeccion"                   column="COD_SECC"/>	
		<result property="importeNetoSinReclamo"           column="IMP_NETO_SREC"/>	
		<result property="importeAntesLimiteTramo1"        column="IMP_PAGO_ANTE_LIMI"/>
		<result property="importeAntesLimiteTramo2"        column="IMP_PAGO_ANTE_LIMI_TRA2"/>	
		<result property="porcentajeRecuperacionTramo1"    column="POR_RECU"/>	
		<result property="porcentajeRecuperacionTramo2"    column="POR_RECU_TRA2"/>	
		<result property="importeComisionTramo1"           column="IMP_COMI_TRA1"/>	
		<result property="importeComisionTramo2"           column="IMP_COMI_TRA2"/>	
		<result property="descripcionRegion"               column="DES_REGI"/>	
		<result property="descripcionZona"                 column="DES_ZONA"/>
		<result property="importeRetribucionTotal"         column="SUM_COMI"/>
		<result property="importeVentaIngreso"             column="IMP_VENT_INGR"/>
		<result property="importeComisionIngreso"          column="IMP_COMI_INGR"/>
		<result property="importeComisionIngresoAnterior"  column="IMP_COMI_INGR_ANTE"/>
		<result property="importeComisionTotal"            column="IMP_COMI_TOTA"/>
    </resultMap>

    <resultMap id="parametrosTramoComisionResult"  class="parametroTramoComision">
		<result property="numeroDiasComision"      column="NUM_DIAS_COMI"/>	   
		<result property="porcentajeRecuperacion"  column="VAL_PORC_RECU"/>	       
		<result property="porcentajeComision"      column="VAL_PORC_COMI"/>	   
    </resultMap>

    <select id="getCantidadLibretaAhorrobyDNI"  parameterClass="string" resultClass="string">
      	SELECT COUNT(*) FROM MAE_CLIEN_LIDER WHERE NUM_DNI=#value#
    </select>
  	
	<!-- MANTENIMIENTO ACTULIZACION  - COM - LIBRETA AHORRO -->
    <update id="updateLibretaAhorro" parameterClass="java.util.Map">
      UPDATE MAE_CLIEN_LIDER 
	  SET MAE_CLIEN_LIDER.COD_CCCI = #codCcci#, 
	  		MAE_CLIEN_LIDER.NUM_LIAH = #numeroLibretaAhorro#, 
             VAL_RUC = #ruc#,
             VAL_RAZO_SOCI = #razonSocial#,             
			 TRGI_COD_RGIM = #tipoRegimen#,
			 VAL_CUEN_DETR = #cuentaDetraccion#,
		     USU_MODI = #updatedBy#,
		     FEC_MODI = #lastUpdated#
	  WHERE (COD_CLID = #codigoLider# 
	  AND	 PAIS_COD_PAIS = #codigoPais#	
		    ) 
	</update>	
	
	<!-- MANTENIMIENTO - COM - LIBRETA AHORRO BUSCAR -->
	<select id="getLibretaAhorroByCriteria" parameterClass="java.util.Map" resultMap="libretaAhorroResult">
  		SELECT
			MAE_CLIEN_LIDER.COD_CLID AS CODIGOLIDER, 
			MAE_CLIEN_LIDER.COD_PLAN AS CODIGOPLANILLA, 
			MAE_CLIEN.VAL_NOM1 || ' ' || MAE_CLIEN.VAL_APE1 || ' ' || MAE_CLIEN.VAL_APE2 AS NOMBREAPELLIDOS,
	        MAE_CLIEN_LIDER.CEN_COST AS CENTROCOSTO, 
			MAE_CLIEN_LIDER.NUM_DNI  AS DOCUMENTOIDENTIDAD,	
			MAE_CLIEN_LIDER.NUM_LIAH AS NUMEROLIBRETAAHORRO,
			MAE_CLIEN_LIDER.COD_CCCI AS CODCCCI,
			MAE_CLIEN_LIDER.PER_INGR AS PERIODOINGRESO,
			MAE_CLIEN_LIDER.PAIS_COD_PAIS AS CODIGOPAIS, 
			MAE_CLIEN_LIDER.VAL_RAZO_SOCI AS RAZONSOCIAL,
     		(select DES_RGIM from COM_TIPO_REGIM R WHERE R.COD_RGIM = MAE_CLIEN_LIDER.TRGI_COD_RGIM) TIPOREGIMEN
		FROM MAE_CLIEN_LIDER,
		     MAE_CLIEN
		WHERE  (       (MAE_CLIEN_LIDER.PAIS_COD_PAIS = #codigoPais#)
			      AND  (MAE_CLIEN_LIDER.COD_CLID      =  MAE_CLIEN.COD_CLIE)
			         <isNotEmpty prepend="AND" property="codigoLider">
			    	  (   MAE_CLIEN_LIDER.COD_CLID LIKE #codigoLider# )
	             	 </isNotEmpty>
	           		)
			ORDER BY 1
	</select>
	
	<!-- MANTENIMIENTO ACTULIZACION  - COM - LIBRETA AHORRO BUSCAR -->
	<select id="getLibretaAhorro" parameterClass="java.util.Map" resultMap="libretaAhorroBeanResult">
  	    SELECT  MAE_CLIEN_LIDER.COD_CLID AS CODIGOLIDER, 
				MAE_CLIEN_LIDER.PAIS_COD_PAIS AS CODIGOPAIS, 
				MAE_CLIEN_LIDER.COD_PLAN AS CODIGOPLANILLA, 
				MAE_CLIEN_LIDER.CEN_COST AS CENTROCOSTO, 
				MAE_CLIEN_LIDER.NUM_DNI  AS DOCUMENTOIDENTIDAD,	
				MAE_CLIEN_LIDER.NUM_LIAH AS NUMEROLIBRETAAHORRO,
				MAE_CLIEN_LIDER.COD_CCCI AS CODCCCI,				
				MAE_CLIEN_LIDER.PER_INGR AS PERIODOINGRESO,
				MAE_CLIEN.VAL_APE1 AS PATERNO,
				MAE_CLIEN.VAL_APE2 AS MATERNO,
				MAE_CLIEN.VAL_NOM1 || MAE_CLIEN.VAL_NOM2  AS NOMBRE,
				MAE_CLIEN_LIDER.VAL_RUC AS RUC,
				MAE_CLIEN_LIDER.VAL_RAZO_SOCI AS RAZONSOCIAL,				
				MAE_CLIEN_LIDER.TRGI_COD_RGIM AS TIPOREGIMEN,
				MAE_CLIEN_LIDER.VAL_CUEN_DETR AS CUENTADETRACCION
	    FROM  	MAE_CLIEN_LIDER, MAE_CLIEN, SEG_PAIS
	  	WHERE (			(MAE_CLIEN_LIDER.PAIS_COD_PAIS = #codigoPais#)
	  			AND 	(MAE_CLIEN_LIDER.COD_CLID = #codigoLider#)
            	AND     (SEG_PAIS.COD_PAIS = #codigoPais#)		
	  			AND	    (MAE_CLIEN.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
	            AND 	(MAE_CLIEN_LIDER.COD_CLID = MAE_CLIEN.COD_CLIE)
	          ) 
	</select>
	
	<!-- MANTENIMIENTO - COM - BLOQUEO LIDER BUSCAR -->
	<select id="getBloqueoLidersByCriteria" parameterClass="java.util.Map" resultMap="bloqueoLiderResult">
     SELECT MAE_CLIEN.VAL_NOM1 || ' ' || MAE_CLIEN.VAL_APE1 || ' ' || MAE_CLIEN.VAL_APE2 AS NOMBREAPELLIDOS,
	    	MAE_CLIEN_LIDER_BLOQU.COD_CLIB AS COD_CLIB, 
			MAE_CLIEN_LIDER_BLOQU.PAIS_COD_PAIS AS PAIS_COD_PAIS, 
			MAE_CLIEN_LIDER_BLOQU.PER_INIC AS PER_INIC, 
			MAE_CLIEN_LIDER_BLOQU.PER_FINA AS PER_FINA,	
			MAE_CLIEN_LIDER_BLOQU.EST_CLIB AS EST_CLIB, 
			MAE_CLIEN_LIDER_BLOQU.USU_DIGI AS USU_DIGI, 
			MAE_CLIEN_LIDER_BLOQU.FEC_DIGI AS FEC_DIGI, 
			MAE_CLIEN_LIDER_BLOQU.USU_MODI AS USU_MODI, 
			MAE_CLIEN_LIDER_BLOQU.FEC_MODI AS FEC_MODI
	   FROM MAE_CLIEN_LIDER_BLOQU,
		    MAE_CLIEN,
			SEG_PAIS
	   WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
	   AND	 (SEG_PAIS.COD_PAIS = MAE_CLIEN_LIDER_BLOQU.PAIS_COD_PAIS)
	   AND	 (SEG_PAIS.OID_PAIS = MAE_CLIEN.PAIS_OID_PAIS)
	   AND	 (MAE_CLIEN_LIDER_BLOQU.COD_CLIB = MAE_CLIEN.COD_CLIE)
		     <isNotEmpty prepend="AND" property="codigo">
		       (MAE_CLIEN_LIDER_BLOQU.COD_CLIB = #codigo# )
		     </isNotEmpty>
		     <isNotEmpty prepend="AND" property="estado">
		       (MAE_CLIEN_LIDER_BLOQU.EST_CLIB = #estado# )
		     </isNotEmpty>
		     ) 
		ORDER BY 1
	</select>

	<!-- MANTENIMIENTO - COM - BLOQUEO LIDER MODIFICACION -->
	<select id="getBloqueoLider" parameterClass="bloqueoLiderPK" resultMap="bloqueoLiderResult">
	   SELECT 
	        MAE_CLIEN.VAL_NOM1 || ' ' || MAE_CLIEN.VAL_APE1 || ' ' || MAE_CLIEN.VAL_APE2 AS NOMBREAPELLIDOS,
	    	MAE_CLIEN_LIDER_BLOQU.COD_CLIB AS COD_CLIB, 
			MAE_CLIEN_LIDER_BLOQU.PAIS_COD_PAIS AS PAIS_COD_PAIS, 
			MAE_CLIEN_LIDER_BLOQU.PER_INIC AS PER_INIC, 
			MAE_CLIEN_LIDER_BLOQU.PER_FINA AS PER_FINA,	
			MAE_CLIEN_LIDER_BLOQU.EST_CLIB AS EST_CLIB, 
			MAE_CLIEN_LIDER_BLOQU.USU_DIGI AS USU_DIGI, 
			MAE_CLIEN_LIDER_BLOQU.FEC_DIGI AS FEC_DIGI, 
			MAE_CLIEN_LIDER_BLOQU.USU_MODI AS USU_MODI, 
			MAE_CLIEN_LIDER_BLOQU.FEC_MODI AS FEC_MODI
		FROM MAE_CLIEN_LIDER_BLOQU, MAE_CLIEN
		WHERE  (  	 (MAE_CLIEN_LIDER_BLOQU.PAIS_COD_PAIS = #codigoPais# )
		         AND (MAE_CLIEN_LIDER_BLOQU.COD_CLIB      =  MAE_CLIEN.COD_CLIE)
		         AND (MAE_CLIEN_LIDER_BLOQU.COD_CLIB = #codigo# )
		       ) 
		ORDER BY 1
	</select>
  
    <!-- CONSULTA - COM - Consulta Responsables UA -->                                                                                 
    <resultMap id="consultaResponsablesUAResult"  class="java.util.HashMap"  >                                                                       
    	<result property="codigoSubgerencia"		column="COD_SUBG_VENT"/>                                                                 
    	<result property="descripcionSubgerencia" 	column="DES_SUBG_VENT"/>                                                             
    	<result property="codigoRegion" 			column="COD_REGI"/>                                                                        
    	<result property="descripcionRegion" 		column="DES_REGI"/>                                                                      
	    <result property="codigoZona" 		 	    column="COD_ZONA"/>                                                                      
        <result property="descripcionZona" 			column="DES_ZONA"/>	                                                                   
        <result property="codigoSeccion" 		    column="COD_SECC"/>                                                                    
        <result property="descripcionSeccion" 		column="DES_SECC"/>                                                                  
        <result property="codigoCliente" 		    column="COD_CLIE"/>                                                                    
        <result property="descripcionCliente" 	    column="NOM_CLIE"/>    	    	                                                     
        <result property="telefonoCliente" 	        column="TEL_CLIE"/>    	    	                                                     
		<result property="numeroActivasIniciales"   column="NUM_ACTI_INIC"/>
		<result property="numeroActivasFinales"     column="NUM_ACTI_FINA"/>
		<result property="promedioActivasFinales"     column="PRO_ACTI_FINA"/>
		<result property="numeroDocumentoIdentidad" column="NUM_DOCU_IDEN"/>
		<result property="fechaNacimiento"          column="FEC_NACI"/>
		<result property="direccion"                column="DIERC"/>
	<result property="telefonoMovil" 	        column="TEL_MOVI"/>
		<result property="telefonoTrabajo" 	        column="TEL_TRAB"/>
		<result property="correoElectronico"        column="VAL_EMAI"/>
		<result property="campoUa"        			column="CAMPO_UA"/>
		<result property="fecDesd"       			 column="FEC_DESD"/>
		<result property="perdOidPeriDesd"        column="PERD_OID_PERI_DESD"/>
	</resultMap>                                                                                                                         
                                                                                                                                       
    <select id="getConsultaResponsablesUA" parameterClass="java.util.Map" resultMap="consultaResponsablesUAResult">                    
       SELECT                                                                                                                          
         COD_SUBG_VENT ,                                                                                                               
         DES_SUBG_VENT ,                                                                                                               
         COD_REGI ,                                                                                                                    
         DES_REGI ,                                                                                                                    
         COD_ZONA ,                                                                                                                    
         DES_ZONA ,                                                                                                                    
         COD_SECC ,                                                                                                                    
         DES_SECC ,                                                                                                                    
         COD_CLIE ,                                                                                                                    
         NOM_CLIE ,
         TEL_CLIE ,
         NUM_ACTI_INIC,
         NUM_ACTI_FINA,
         substr(PRO_ACTI_FINA,3) PRO_ACTI_FINA,
         NUM_DOCU_IDEN,
		 FEC_NACI,
		 DIERC,
		 TEL_MOVI,
		 TEL_TRAB,
		 VAL_EMAI,
		 CAMPO_UA,
		 to_char(FEC_DESD,'dd/mm/yyyy') FEC_DESD,
		 PERD_OID_PERI_DESD		 
       FROM TABLE(com_pkg_repor_recup.COM_FN_OBTIE_RESPO_UA(#codigoPais#, #codigoCanal#, #codigoMarca#, #tipoUnidad#, #codigoPeriodo#, #codigoZona#, #tipoConsulta#))
    </select>        

  	<!-- MANTENIMIENTO INSERTAR  - COM - BLOQUEO LIDER -->
    <insert id="insertBloqueoLider" parameterClass="bloqueoLider">
	    INSERT INTO MAE_CLIEN_LIDER_BLOQU (
		COD_CLIB, 
		PAIS_COD_PAIS, 
		PER_INIC, 
		PER_FINA,
		EST_CLIB,
		USU_DIGI, 
		FEC_DIGI) 
	    VALUES (
	    #codigo#,
	    #codigoPais#,
	    #periodoInicial#,
	    #periodoFinal#,
	    #estado#,
	    #auditInfo.createdBy#,
	    #auditInfo.created#
	    )
	</insert>

 	<!-- MANTENIMIENTO ACTUALIZAR  - COM - BLOQUEO LIDER -->
 	<update id="updateBloqueoLider" parameterClass="bloqueoLider">
        UPDATE MAE_CLIEN_LIDER_BLOQU SET
		PER_INIC = #periodoInicial#, 
		PER_FINA = #periodoFinal#,
		EST_CLIB = #estado#,
		USU_MODI = #auditInfo.updatedBy#,
		FEC_MODI = #auditInfo.lastUpdated#
	    WHERE    COD_CLIB = #codigo#
		     AND PAIS_COD_PAIS = #codigoPais#	
	</update>

 	<!-- MANTENIMIENTO ELIMINAR  - COM - BLOQUEO LIDER -->
	<delete id="removeBloqueoLider" parameterClass="bloqueoLiderPK">
        DELETE FROM MAE_CLIEN_LIDER_BLOQU
	    WHERE COD_CLIB = #codigo#
	    AND PAIS_COD_PAIS = #codigoPais#
	</delete>

 	<!-- MANTENIMIENTO - COM - BLOQUEO LIDER, VERIFICAR QUE EXISTE EL CLIENTE -->
    <select id="getCantidadClientesByPK" parameterClass="java.util.Map" resultClass="java.lang.String">
		SELECT COUNT(*)
		FROM MAE_CLIEN 
		WHERE MAE_CLIEN.COD_CLIE=#codigoCliente#
	</select>	

	<!-- MANTENIMIENTO - COM - BLOQUEO LIDER, VERIFICAR QUE EXISTE EL PERIODO -->
    <select id="getCantidadPeriodosByPK" parameterClass="java.util.Map" resultClass="java.lang.String">
		SELECT COUNT(*) 
		FROM  SEG_PERIO_CORPO
		WHERE SEG_PERIO_CORPO.COD_PERI=#codigoPeriodo#
	</select>	
	
    <insert id="insertGenerarLideresNuevas" parameterClass="java.util.Map">
	<![CDATA[
		INSERT INTO MAE_CLIEN_LIDER (PAIS_COD_PAIS, COD_CLID, CEN_COST, NUM_DNI, 
			   						 PER_INGR, USU_DIGI, FEC_DIGI, EST_CLID)
SELECT GRAN_TABLA.COD_PAIS, GRAN_TABLA.COD_GERE, GRAN_TABLA.CEN_COST, GRAN_TABLA.NUM_DNI, GRAN_TABLA.PER_INGR,
       GRAN_TABLA.USU_DIGI, GRAN_TABLA.FEC_DIGI, GRAN_TABLA.EST_CLID
FROM (			   						 
		SELECT DISTINCT
               SEG_PAIS.COD_PAIS AS COD_PAIS,
			   ZON_HISTO_GEREN.GERE AS COD_GERE,
			   
			   (CASE  SUBSTR(SUBSTR(ZON_HISTO_GEREN.UA,3,2),1,1)
				  WHEN '0' THEN '1211' || '2' || SUBSTR(ZON_HISTO_GEREN.UA,4,1)
				  ELSE  '1211' || '1' || SUBSTR(ZON_HISTO_GEREN.UA,3,1)
				END) AS CEN_COST,

			   COM_PKG_REPOR.COM_FN_DOCUM_IDENT_LIDER_NUEV(MAE_CLIEN.OID_CLIE, SEG_PAIS.OID_PAIS, '01') AS NUM_DNI, 
			   TEMP_PERI1.COD_PERI AS PER_INGR,
			   #usuario# AS USU_DIGI,
			   SYSDATE AS FEC_DIGI,
			   '1' AS EST_CLID
          FROM ZON_HISTO_GEREN,
          	   SEG_PAIS,
        	   SEG_MARCA,
        	   SEG_CANAL,
			   (SELECT SEG_PERIO_CORPO.COD_PERI, CRA_PERIO.FEC_INIC, CRA_PERIO.FEC_FINA
                  FROM CRA_PERIO,
                  	   SEG_PAIS,
                	   SEG_MARCA,
                	   SEG_CANAL,
                	   SEG_PERIO_CORPO
                  WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
                  AND   (SEG_MARCA.COD_MARC = #codigoMarca#)
                  AND   (SEG_CANAL.COD_CANA = #codigoCanal#)
                  AND   (SEG_PERIO_CORPO.COD_PERI = #codigoPeriodo#)
                  AND   (CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
                  AND   (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
                  AND   (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
                  AND   (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
                  	    )
     		   ) TEMP_PERI1,
			   (SELECT SEG_PERIO_CORPO.COD_PERI, CRA_PERIO.FEC_INIC, CRA_PERIO.FEC_FINA
                  FROM CRA_PERIO,
                  	   SEG_PAIS,
                	   SEG_MARCA,
                	   SEG_CANAL,
                	   SEG_PERIO_CORPO
                  WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
                  AND   (SEG_MARCA.COD_MARC = #codigoMarca#)
                  AND   (SEG_CANAL.COD_CANA = #codigoCanal#)
                  AND   (SEG_PERIO_CORPO.COD_PERI = GEN_FN_CALCU_PERIO(#codigoPeriodo#, 1))
                  AND   (CRA_PERIO.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
                  AND   (CRA_PERIO.MARC_OID_MARC = SEG_MARCA.OID_MARC)
                  AND   (CRA_PERIO.CANA_OID_CANA = SEG_CANAL.OID_CANA)
                  AND   (CRA_PERIO.PERI_OID_PERI = SEG_PERIO_CORPO.OID_PERI)
                  	    )
     		   ) TEMP_PERI2,
			   MAE_CLIEN
          WHERE ((SEG_PAIS.COD_PAIS = #codigoPais#)
          AND	(SEG_MARCA.COD_MARC = #codigoMarca#)
          AND	(SEG_CANAL.COD_CANA = #codigoCanal#) 
          AND   (LENGTH(UA) = 9)
          AND	(ZON_HISTO_GEREN.PAIS_OID_PAIS = SEG_PAIS.OID_PAIS)
          AND	(ZON_HISTO_GEREN.MARC_OID_MARC = SEG_MARCA.OID_MARC)
          AND	(ZON_HISTO_GEREN.CANA_OID_CANA = SEG_CANAL.OID_CANA)
		  AND	(ZON_HISTO_GEREN.FEC_DESD >= TEMP_PERI1.FEC_INIC)
		  AND	(ZON_HISTO_GEREN.FEC_DESD <  TEMP_PERI2.FEC_INIC)
		  AND	(MAE_CLIEN.COD_CLIE = ZON_HISTO_GEREN.GERE)
		  AND	NOT EXISTS (SELECT * FROM MAE_CLIEN_LIDER
						      WHERE (SEG_PAIS.COD_PAIS = MAE_CLIEN_LIDER.PAIS_COD_PAIS)
							  AND	(MAE_CLIEN.COD_CLIE = MAE_CLIEN_LIDER.COD_CLID)
						   )
   		  		)
    ) GRAN_TABLA
WHERE GRAN_TABLA.NUM_DNI IS NOT NULL   		  		
   		  ]]>
	</insert>

	<select id="getExisteComision" parameterClass="java.util.Map"
    		resultClass="string">
    	SELECT TRIM(TO_CHAR(NVL(COUNT(1),0)))
		FROM COM_COMIS_PERIO_CALCU
		WHERE PERI_COD_PERI = #codigoPeriodo#
		  AND COD_COMI = #codigoComision#
          AND IND_COMI = #indicadorComision#
	</select>

		<select id="getExisteComisionRecuperacionEjecutiva" parameterClass="java.util.Map"
    		resultClass="integer">
    	SELECT NVL(COUNT(1),0)
		FROM COM_COMIS_PERIO_CALCU
		WHERE PERI_COD_PERI = #codigoPeriodo#
		  AND COD_COMI = #codigoComision#
          AND IND_COMI = #indicadorComision#
	</select>
	
	<select id="getExisteComisionRecuperacionRegion" parameterClass="java.util.Map"
    		resultClass="integer">
    	SELECT NVL(COUNT(1),0)
		FROM COM_COMIS_PERIO_CALCU_REGIO
		WHERE COD_PERI = #codigoPeriodo#
		  AND COD_COMI = #codigoComision#
	</select>
	
	<select id="getExisteComisionRecuperacionZona" parameterClass="java.util.Map"
    		resultClass="integer">
    	SELECT NVL(COUNT(1),0)
		FROM COM_COMIS_PERIO_CALCU_ZONA
		WHERE PERI_COD_PERI = #codigoPeriodo#
		  AND COD_COMI = #codigoComision#
	</select>
	

	<select id="getExisteComisionComercializacion" parameterClass="java.util.Map"
    		resultClass="string">
    	SELECT TRIM(TO_CHAR(NVL(COUNT(1),0)))
		FROM COM_COMIS_PERIO_CALCU_COMER
		WHERE FEC_INIC = TO_DATE(#fechaDesde#,'DD/MM/YYYY')
		  AND FEC_FINA = TO_DATE(#fechaHasta#,'DD/MM/YYYY')
		  AND COD_COMI = #codigoComision#
	</select>
	
   <parameterMap id="paramComisionIngreso" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoComision"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="anioInicTramo"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codTramo"       			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codTipoCalculo"   			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeComisionIngreso" parameterMap="paramComisionIngreso" >
		{call COM_PKG_REPOR.COM_PR_GENER_LISTA_COMIS_INGRE(?, ?, ?, ?, ?, ?, ? , ?)}
    </procedure>

	<parameterMap id="paramComisionRecuperacion" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoComision"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoComision"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="anioInicTramo"    			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codTramo"       			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codTipoCalculo"   			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoGerenteBase07"   	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoRegionBase07"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoZonaBase07"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="fechaRetiroBase07"   		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeComisionRecuperacion" parameterMap="paramComisionRecuperacion" >
		{call COM_PKG_REPOR.COM_PR_GENER_LISTA_COMIS_RECUP(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}
    </procedure>	

   <parameterMap id="paramComisionRecuperacionGZona" class="java.util.Map" >
	    <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoComision"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeComisionRecuperacionGZona" parameterMap="paramComisionRecuperacionGZona" >
		{call COM_PKG_REPOR_RECUP.COM_PR_OBTIE_COMIS_RECUP_GZONA(?, ?)}
    </procedure>	
	
   <parameterMap id="paramComisionComercializacion" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoComision"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="fechaDesde"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="fechaHasta"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		
    </parameterMap>

    <procedure id="executeComisionComercializacion" parameterMap="paramComisionComercializacion" >
		{call COM_PKG_REPOR.COM_PR_GENER_LISTA_COMIS_COMER(?, ?, ?, ?, ?, ?, ? )}
    </procedure>
	
	<parameterMap id="paramDevuelvePorcentajeTramoComision" class="java.util.Map" >
		<parameter property="codigoComision"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="numeroDias"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
		<parameter property="porcentajeRecu"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
		<parameter property="porcentajeComi"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
		<parameter property="numeroDiasTramo2"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
		<parameter property="porcentajeRecuTramo2"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
		<parameter property="porcentajeComiTramo2"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
    </parameterMap>

    <procedure id="devuelvePorcentajeTramoComision" parameterMap="paramDevuelvePorcentajeTramoComision" >
		{call COM_PKG_REPOR.COM_PR_DEVUE_PORCEN_COMIS(?, ?, ?, ?, ?, ?, ? )}
    </procedure>

    <select id="getComisionPeriodoGerenteZona" parameterClass="comisionGerenteZona" resultMap="comisionGerenteZonaResult">
			SELECT
				A.PERI_COD_PERI,	   
				A.COD_COMI,	       
				A.COD_LIDE_ZONA,	   
				A.NOM_LIDE_ZONA,	  
				A.COD_REGI,	
				A.COD_ZONA,	
				A.TIP_COMI AS COD_TIPO_COMI,	
				A.FEC_CALC,	
				A.IMP_NETO_SIN_RECL IMP_NETO_SREC,	
				A.IMP_PAGO_ANTE_LIMI,
				A.IMP_PAGO_ANTE_LIMI_TRA2,	
				A.POR_RECU,	
				A.POR_RECU_TRA2,	
				A.IMP_COMI_TRA1,	
				A.IMP_COMI_TRA2,	
				A.COD_EMPL,
                C.DES_REGI,
				B.DES_ZONA,
 				NVL(A.IMP_COMI_TRA1,0) +  NVL(A.IMP_COMI_TRA2,0) AS SUM_COMI,
 				 A.IMP_COMI_ACTI,
           		A.VAL_PORC_ACTI,
           		A.VAL_PORC_COMI_TRA1,
           		A.VAL_PORC_COMI_TRA2
			FROM COM_COMIS_PERIO_CALCU_ZONA A,
				 ZON_ZONA B,
                 ZON_REGIO C
			WHERE  A.PERI_COD_PERI = #codigoPeriodo# 
			   AND A.COD_COMI = #codigoComision# 
			   AND A.COD_REGI = #codigoRegion#
			   AND A.COD_ZONA = #codigoZona#		
			   AND A.COD_LIDE_ZONA = #codigoLiderZona#
			   AND B.COD_ZONA = A.COD_ZONA
			   AND C.COD_REGI = A.COD_REGI
    </select>


    <select id="getMantenimientoComisionPeriodoGerenteZonaByCriteria" parameterClass="java.util.Map" resultMap="comisionGerenteZonaResult">
			SELECT
				A.PERI_COD_PERI,	   
				A.COD_COMI,	       
				A.COD_LIDE_ZONA,	   
				A.NOM_LIDE_ZONA,	  
				A.COD_REGI,	
				A.COD_ZONA,	
				A.TIP_COMI AS COD_TIPO_COMI,	
				A.FEC_CALC,	
				A.IMP_NETO_SIN_RECL IMP_NETO_SREC,	
				A.IMP_PAGO_ANTE_LIMI,
				A.IMP_PAGO_ANTE_LIMI_TRA2,                                       			
				A.POR_RECU,	
				A.POR_RECU_TRA2,	
				A.IMP_COMI_TRA1,	
				A.IMP_COMI_TRA2,	
				A.COD_EMPL,
				C.DES_REGI,
				B.DES_ZONA,
	            NVL(A.IMP_COMI_TRA1,0) +  NVL(A.IMP_COMI_TRA2,0) AS SUM_COMI,
	             A.IMP_COMI_ACTI,
           		A.VAL_PORC_ACTI,
           		A.VAL_PORC_COMI_TRA1,
           		A.VAL_PORC_COMI_TRA2
			FROM COM_COMIS_PERIO_CALCU_ZONA A,
				 ZON_ZONA B,
                 ZON_REGIO C
			WHERE
			   A.PERI_COD_PERI = #codigoPeriodo#
			   AND A.COD_COMI = #codigoComision# 
			  <isNotEmpty prepend="AND" property="tipoComision">
                  A.TIP_COMI = #tipoComision# 
			   </isNotEmpty>
               <isNotEmpty prepend="AND" property="codigoRegion">
                  A.COD_REGI = #codigoRegion# 
			   </isNotEmpty>
			   AND B.COD_ZONA = A.COD_ZONA
			   AND C.COD_REGI = A.COD_REGI	
           ORDER BY  A.COD_REGI, A.COD_ZONA, A.COD_LIDE_ZONA
     </select>

    <select id="getComisionPeriodoGerenteZonaByCriteria" parameterClass="java.util.Map" resultMap="comisionGerenteZonaResult">
			SELECT
				A.PERI_COD_PERI,	   
				A.COD_COMI,	       
				A.COD_LIDE_ZONA,	   
				A.NOM_LIDE_ZONA,	  
				A.COD_REGI,	
				A.COD_ZONA,	
				A.TIP_COMI AS COD_TIPO_COMI,	
				A.FEC_CALC,	
				DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.IMP_NETO_SIN_RECL,A.IMP_NETO_SREC_CIMP) IMP_NETO_SREC,	
     			DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.IMP_PAGO_ANTE_LIMI,A.IMP_PAGO_ANTE_LIMI_CIMP) IMP_PAGO_ANTE_LIMI,
                DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.IMP_PAGO_ANTE_LIMI_TRA2,A.IMP_PAGO_ANTE_LIMI_TRA2_CIMP) IMP_PAGO_ANTE_LIMI_TRA2,   				
				A.POR_RECU,	
				A.POR_RECU_TRA2,	
				A.IMP_COMI_TRA1,	
				A.IMP_COMI_TRA2,	
				A.COD_EMPL,
				C.DES_REGI,
				B.DES_ZONA,
	            NVL(A.IMP_COMI_TRA1,0) + NVL(A.IMP_COMI_TRA2,0) + NVL(A.IMP_COMI_ACTI,0) AS SUM_COMI,
	            A.IMP_COMI_ACTI,
           		A.VAL_PORC_ACTI,
           		A.VAL_PORC_COMI_TRA1,
           		A.VAL_PORC_COMI_TRA2
			FROM COM_COMIS_PERIO_CALCU_ZONA A,
				 ZON_ZONA B,
                 ZON_REGIO C
			WHERE
			   <![CDATA[ 
			   A.PERI_COD_PERI >= #codigoPeriodoIni# AND A.PERI_COD_PERI <= #codigoPeriodoFin#
			  		 ]]>	    
			   AND A.COD_COMI = #codigoComision# 
			  <isNotEmpty prepend="AND" property="tipoComision">
                  A.TIP_COMI = #tipoComision# 
			   </isNotEmpty>
               <isNotEmpty prepend="AND" property="codigoRegion">
                  A.COD_REGI = #codigoRegion# 
			   </isNotEmpty>
			   AND B.COD_ZONA = A.COD_ZONA
			   AND C.COD_REGI = A.COD_REGI	
           ORDER BY  A.COD_REGI, A.COD_ZONA, A.COD_LIDE_ZONA
     </select>


<select id="getComisionPeriodoGerenteZonaEscalonadaByCriteria" parameterClass="java.util.Map" resultMap="comisionGerenteZonaEscalonadaResult">
			SELECT
				A.PERI_COD_PERI,	   
				A.COD_COMI,	       
				A.COD_LIDE_ZONA,	   
				A.NOM_LIDE_ZONA,	  
				A.COD_REGI,	
				A.COD_ZONA,	
				A.TIP_COMI AS COD_TIPO_COMI,	
				A.FEC_CALC,	
                           (select NUM_DOCU_IDEN from mae_clien_ident where clie_oid_clie = B.OID_CLIE and val_iden_docu_prin = 1) AS NUM_DOCU_IDEN,
				A.POR_RECU POR_RECU,
				TO_CHAR(DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.IMP_PAGO_ANTE_LIMI,A.IMP_PAGO_ANTE_LIMI_CIMP),'9999999990.00') IMP_PAGO_ANTE_LIMI,
                TO_CHAR(DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.IMP_NETO_SIN_RECL,A.IMP_NETO_SREC_CIMP),'9999999990.00') IMP_NETO_SREC,
                TO_CHAR(DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.IMP_NETO,A.IMP_NETO_CIMP),'9999999990.00') IMP_NETO_CIMP,
                TO_CHAR(DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.CAR_FRAC_SIMP,A.CAR_FRAC_CIMP),'9999999990.00') CAR_FRAC,
                TO_CHAR(DECODE((SELECT X.IND_DESC_IMPO_VENT_PAGO FROM COM_COMIS X WHERE  X.COD_COMI=A.COD_COMI),1,A.IMP_NETO + A.CAR_FRAC_SIMP,A.IMP_NETO_CIMP+A.CAR_FRAC_CIMP),'9999999990.00') AS FAC_TOTA,
				TO_CHAR(VAL_IMPU,'9999999990.00') VAL_IMPU,
				TO_CHAR(A.IMP_RECL,'9999999990.00') IMP_RECL,
				TO_CHAR(VAL_SALD,'9999999990.00') VAL_SALD,
				TO_CHAR(VEN_NETA_EFEC,'9999999990.00') VEN_NETA_EFEC,
				TO_CHAR(DIF_VENT_NETA_EFEC,'9999999990.00') DIF_VENT_NETA_EFEC,
				A.POR_RECU_INIC,
				A.POR_RECU_FINA,
				A.VAL_PORC_COMI_TRA1 POR_COMI,
				POR_ADIC,
				TO_CHAR(IMP_COMI_TRA1,'9999999990.00') IMP_COMI_TRA1,
				COM_PKG_REPOR.COM_FN_DEVUE_FECHA_VENCI(#codigoPais#, A.PERI_COD_PERI, A.COD_ZONA) FEC_VENC,
				DECODE((SELECT count(1) FROM COM_ZONA_DEMAN_ANTIC X WHERE  X.COD_ZONA=A.COD_ZONA),0,'N','S') DEM_ANTI				
				
			FROM COM_COMIS_PERIO_CALCU_ZONA A,
                           MAE_CLIEN B,
                 ZON_REGIO C
            WHERE
			   <![CDATA[ 
			   A.PERI_COD_PERI >= #codigoPeriodoIni# AND A.PERI_COD_PERI <= #codigoPeriodoFin#
			  		 ]]>	    
			   AND A.COD_COMI = #codigoComision# 
			  <isNotEmpty prepend="AND" property="tipoComision">
                  A.TIP_COMI = #tipoComision# 
			   </isNotEmpty>
               <isNotEmpty prepend="AND" property="codigoRegion">
                  A.COD_REGI = #codigoRegion# 
			   </isNotEmpty>
                       AND B.COD_CLIE = A.COD_LIDE_ZONA
			   AND C.COD_REGI = A.COD_REGI	
           ORDER BY  A.COD_REGI, A.COD_ZONA, A.COD_LIDE_ZONA           			
     </select>

    <select id="getComisionPeriodoLideresByCriteria" parameterClass="java.util.Map" resultMap="comisionLideresResult">
			SELECT
				#codigoPeriodo# as PERI_COD_PERI,	   
				#codigoComision# as COD_COMI,	
				#codigoComisionIngreso# as COD_COMI_INGR,	       
				A.COD_REGI,	
				A.COD_ZONA,	
				A.COD_SECC,
				A.COD_LIDE_SECC,	   
				A.NOM_LIDE_SECC,	  
				DECODE(#indicadorDsctoImpuesto#,1,A.IMP_NETO, A.IMP_NETO_SREC_CIMP) IMP_NETO_SREC,	
     			DECODE(#indicadorDsctoImpuesto#,1,A.IMP_RECU, A.IMP_RECU_CIMP) IMP_PAGO_ANTE_LIMI,
                DECODE(#indicadorDsctoImpuesto#,1,A.IMP_RECU_TRA2, A.IMP_RECU_TRA2_CIMP) IMP_PAGO_ANTE_LIMI_TRA2,
				A.POR_RECU,	
				A.POR_RECU_TRA2,	
				A.IMP_COMI_TRA1,	
				A.IMP_COMI_TRA2,	
				C.DES_REGI,
				B.DES_ZONA,
	            NVL(A.IMP_COMI_TRA1,0) +  NVL(A.IMP_COMI_TRA2,0) AS SUM_COMI,
				A.IMP_VENT_INGR,
				A.IMP_COMI_INGR,
				A.IMP_COMI_INGR_ANTE,
				NVL(A.IMP_COMI_TRA1,0) +  NVL(A.IMP_COMI_TRA2,0) + NVL(A.IMP_COMI_INGR,0) - NVL(A.IMP_COMI_INGR_ANTE,0) AS IMP_COMI_TOTA
			FROM COM_TEMPO_COMIS_RECUP_SECCI A,
				 ZON_ZONA B,
                 ZON_REGIO C
			WHERE  B.COD_ZONA = A.COD_ZONA
			   AND C.COD_REGI = A.COD_REGI	
               <isNotEmpty prepend="AND" property="codigoRegion">
                  A.COD_REGI = #codigoRegion# 
			   </isNotEmpty>
			   <isNotEmpty prepend="AND" property="codigoZona">
                  A.COD_ZONA = #codigoZona# 
			   </isNotEmpty>
           ORDER BY  A.COD_REGI, A.COD_ZONA, A.COD_SECC
     </select>

     <update id="updateComisionPeriodoGerenteZona" parameterClass="comisionGerenteZona">
		UPDATE COM_COMIS_PERIO_CALCU_ZONA A
		SET USU_MODI = #auditInfo.updatedBy#,
        	FEC_MODI = #auditInfo.lastUpdated#,
			IMP_COMI_TRA1 = #importeComisionTramo1#,
			IMP_COMI_TRA2 = #importeComisionTramo2#
		WHERE  A.PERI_COD_PERI = #codigoPeriodo# 
			   AND A.COD_COMI = #codigoComision# 
			   AND A.COD_REGI = #codigoRegion#
			   AND A.COD_ZONA = #codigoZona#		
			   AND A.COD_LIDE_ZONA = #codigoLiderZona#
     </update>

	<select id="getDevuelveIDComision" parameterClass="java.util.Map"
    		resultClass="int">
		SELECT COM_PKG_REPOR.COM_FN_DEVUE_ULTI_OID_COMI(#codigoComision#) 
		FROM DUAL
	</select>
    
   <select id="getParametrosTramoComision" parameterClass="java.util.Map" resultMap="parametrosTramoComisionResult">
	    SELECT  NVL(TRIM(TO_CHAR(B.NUM_DIAS_COMI)),' ') AS NUM_DIAS_COMI, 
				NVL(TRIM(TO_CHAR(B.VAL_PORC_RECU)),' ') AS VAL_PORC_RECU, 
				NVL(TRIM(TO_CHAR(B.VAL_PORC_COMI)),' ') AS VAL_PORC_COMI
	    FROM
	       COM_COMIS_COBRA A,
	       COM_COMIS_COBRA_TIPO_PARTI B
	    WHERE  A.COMI_OID_COMI = #idComision#
	       AND A.OID_COMI_COBR = B.COCO_OID_COMI_COBR
	       AND B.VAL_NIVE_TRAM = #numeroTramo#
	</select>
	
	<!-- OBTIENE LOS TIPOS DE COMISIONISTAS-->
	<select id="getTiposComisionistas" parameterClass="string" resultMap="baseResultCom">
		SELECT COD_TIPO_COMI AS CODIGO,
		       DES_COMI AS DESCRIPCION
		  FROM COM_TIPOS_COMIS
		 WHERE COD_PAIS = #value#	
		 AND   EST_REGI = 1
  		 ORDER BY 2 ASC		    			 
	</select>
		
	<!-- OBTIENE LOS TRAMOS POR PAIS  -->
	<select id="getTramos" parameterClass="string" resultMap="baseResultCom">
		SELECT COD_RANG AS CODIGO, 
		       COD_RANG || '  (' || CAM_INIC || ' - ' || CAM_FINA || ')'AS DESCRIPCION
		  FROM COM_TRAMO_EJECU
		 WHERE COD_PAIS = #value#	
   		 ORDER BY 2 ASC		    	
	</select>	

    <parameterMap id="paramExecuteCalculoCalificacionTramo" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="anioInicial" jdbcType="NUMBER" mode="IN"/>        
        <parameter property="codigoTramo" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="tipoComisionista" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                        
    </parameterMap>
    
	<procedure id="executeCalculoCalificacionTramo" parameterMap="paramExecuteCalculoCalificacionTramo" >
		{call COM_PKG_PROCE.COM_PR_CALCU_CALIF_EJECU_TRAMO( ?, ?, ?, ?, ?, ? )}
	</procedure>	
	
	<parameterMap id="paramExecuteCalculoVariablesNivelSeccionCampania" class="map">
		<parameter property="codigoPais" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoMarca" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoCanal" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" javaType="java.lang.String"	mode="IN"/>        
        <parameter property="tipoComisionista" 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                        
    </parameterMap>
    
	<procedure id="executeCalculoVariablesNivelSeccionCampania" parameterMap="paramExecuteCalculoVariablesNivelSeccionCampania" >
		{call COM_PKG_PROCE.COM_PR_CALC_VARI_NIVE_SECA( ?, ?, ?, ?,?)}
	</procedure>
		
    <parameterMap id="paramExecuteSeguimientoCalificacionCampana" class="map">
		<parameter property="codigoPais" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoMarca" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoCanal" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="anioInicial" jdbcType="NUMBER" mode="IN"/>        
        <parameter property="codigoTramo" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="tipoComisionista" jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>                        
    </parameterMap>
    
	<procedure id="executeSeguimientoCalificacionCampana" parameterMap="paramExecuteSeguimientoCalificacionCampana" >
		{call COM_PKG_PROCE.COM_PR_OBTIE_SEGUI_CALIF_CAMPA( ?, ?, ?, ?, ?, ? )}
	</procedure>	

	<!-- OBTIENE LA CAMPAÑA INICIO Y FIN DEL TRAMO  -->
	<select id="getCampanasTramo" parameterClass="java.util.Map" resultMap="baseResultCom">
		SELECT CAM_INIC AS CODIGO, CAM_FINA AS DESCRIPCION
		  FROM COM_TRAMO_EJECU
		 WHERE COD_PAIS = #codigoPais#	
  		   <isEmpty prepend="AND" property="codigoTramoMayor">
             COD_RANG = #codigoTramo#	
           </isEmpty>             
  		   <isNotEmpty prepend="AND" property="codigoTramoMayor">           
  			   <![CDATA[    	  		   
        	     COD_RANG <= #codigoTramoMayor#	  		   
          		  ]]>				           
           </isNotEmpty>
        ORDER BY COD_RANG                                       
	</select>	

	<!-- OBTIENE EL PERIODO ANTERIOR Y LOS PERIODOS DENTRO DEL RANGO PARA EL REPORTE DE SEGUIMIENTO DE CALIFICACION POR CAMPAÑA -->
	<select id="getPeriodosSeguimientoCalificacionCampana" parameterClass="java.util.Map" resultMap="baseResultCom">
		<![CDATA[
			(SELECT 0 AS CODIGO, gen_fn_calcu_perio (#campanaInicio#, -1) AS DESCRIPCION
			   FROM DUAL)
			UNION
			(SELECT 0, cod_peri
			   FROM seg_perio_corpo
			  WHERE cod_peri >= #campanaInicio# AND cod_peri <= #campanaFin#)
			ORDER BY 2
		  ]]>			
	</select>	
	
	<procedure id="executeResumenEvaluacionSeccion" parameterMap="paramExecuteSeguimientoCalificacionCampana" >
		{call COM_PKG_PROCE.COM_PR_OBTIE_EVALU_SECCI_TRAMO( ?, ?, ?, ?, ?, ? )}
	</procedure>			

	<procedure id="executeResumenEvaluacionZona" parameterMap="paramExecuteSeguimientoCalificacionCampana" >
		{call COM_PKG_PROCE.COM_PR_OBTIE_EVALU_ZONA_TRAMO( ?, ?, ?, ?, ?, ? )}
	</procedure>			
	
	<!-- OBTIENE LOS DATOS DE COMISION -->
	<select id="getDatosComisionList" parameterClass="java.util.Map" resultMap="baseResultCom">
		SELECT COD_COMI AS CODIGO,
		       DES_COMI AS DESCRIPCION
		  FROM COM_DATOS_COMIS
		 WHERE COD_PAIS = #codigoPais#
		 <isNotEmpty prepend="AND" property="tipoComisionista">           
		 	COD_TIPO_COMI = #tipoComisionista#
		 </isNotEmpty>
  		 ORDER BY 2 ASC		    			 
	</select>
	
  	<resultMap id="datosComisionResult"              class="datosComision">
    	<result property="codigo"			               column="COD_COMI"/>
    	<result property="codigoPais" 					   column="COD_PAIS"/>
    	<result property="tipoComisionista" 			   column="COD_TIPO_COMI"/>
    	<result property="codigoMarca" 			           column="COD_MARC"/>
	    <result property="codigoCanal" 		 	           column="COD_CANA"/>
        <result property="descripcion" 				       column="DES_COMI"/>	    
        <result property="numeroDiasRecuperacionAspirante" column="NUM_DIAS_RECU_ASPI"/>
        <result property="porcentajeRecuperacionAspirante" column="VAL_PORC_RECU_ASPI"/>
        <result property="porcentajeComisionAspirante" 	   column="VAL_PORC_COMI_ASPI"/>
        <result property="numeroDiasRecuperacionEjecutiva" column="NUM_DIAS_RECU_EJEC"/>
        <result property="porcentajeRecuperacionEjecutiva" column="VAL_PORC_RECU_EJEC"/>
	</resultMap>
	
	<select id="getDatosComision" parameterClass="datosComision" resultMap="datosComisionResult">
		SELECT 
		   COD_COMI, COD_PAIS, COD_TIPO_COMI, 
		   COD_MARC, COD_CANA, DES_COMI, 
		   NUM_DIAS_RECU_ASPI, VAL_PORC_RECU_ASPI, 
		   VAL_PORC_COMI_ASPI, NUM_DIAS_RECU_EJEC, 
		   VAL_PORC_RECU_EJEC
		FROM COM_DATOS_COMIS
		WHERE COD_PAIS = #codigoPais#
		<isNotEmpty prepend="AND" property="codigo">           
			COD_COMI = #codigo#
		</isNotEmpty>
		<isNotEmpty prepend="AND" property="tipoComisionista">           
			COD_TIPO_COMI = #tipoComisionista#
		</isNotEmpty>
  		ORDER BY 1 ASC
	</select>

	<parameterMap id="paramExecuteCalculoComisionRecuperacionEjecutivas" class="map">
		<parameter property="codigoPais" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoMarca" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoCanal" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="tipoComisionista" 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codComision"    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="anioInicTramo"    	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codTramo"       	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" javaType="java.lang.String"	mode="IN"/>        
        <parameter property="codigoUsuario" 	jdbcType="VARCHAR" javaType="java.lang.String"	mode="IN"/>
                               
    </parameterMap>
	
	<procedure id="executeCalculoComisionRecuperacionEjecutivas" parameterMap="paramExecuteCalculoComisionRecuperacionEjecutivas" >
		{call COM_PKG_PROCE.COM_PR_CALCU_COMIC_RECUP(?, ?, ?, ?, ?, ?, ?, ?, ?)}
    </procedure>

    <select id="getCalculoComisionRecuperacionEjecutivasCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(*) 
		FROM COM_COMIS_EJCAL_CABEC A 
		WHERE A.COD_PAIS = #codigoPais#
			  AND A.COD_CAMP = #codigoPeriodo#
		      AND A.COD_COMI  = #codComision#
		      AND A.COD_TIPO_COMI = #tipoComisionista#
	</select>
    
    <select id="getTipoCalculoList" parameterClass="string" resultMap="baseResultCom">
		SELECT T.COD_PARA AS CODIGO, 
			   T.DES_PARA AS DESCRIPCION
		  FROM COM_COMIS_PARAM_GENER T
		 WHERE T.COD_PAIS = #codigoPais#
		   AND T.VAL_PARA = 'S'
		   ORDER BY 1 ASC
	</select>

 		<!-- OBTIENE LA CAMPAÑA INICIO Y FIN DEL RANGO  -->
	<select id="getCampanasRango" parameterClass="java.util.Map" resultMap="baseResultCom">
		SELECT CAM_INIC AS CODIGO, CAM_FINA AS DESCRIPCION
		  FROM COM_TRAMO_EJECU
		 WHERE COD_PAIS = #codigoPais#	  		  
             AND COD_RANG = #codigoTramo#	                                     
	</select>
	
	<resultMap id="indicadoresComisionResult"     class="java.util.HashMap">
    	<result property="indicadorFeriado"			column="IND_CONS_SABA_DOMI_FERI"/>
    	<result property="indicadorDsctoImpuesto" 	column="IND_DESC_IMPO_VENT_PAGO"/>
	</resultMap>
	
	<select id="getIndicadoresComision" parameterClass="java.util.Map" resultMap="indicadoresComisionResult">
		SELECT A.IND_CONS_SABA_DOMI_FERI, A.IND_DESC_IMPO_VENT_PAGO
		FROM COM_COMIS A
		WHERE A.OID_COMI = #oidComision#
	</select>  

	 <parameterMap id="paramComisionRecuperacionPerdidas" class="java.util.Map" >
		<parameter property="codigoPais"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoMarca"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoCanal"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoComision"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="anhoProceso"     	 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoRangoPeriodo" 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoComision"     	 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuarioLogin"     	 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoGerente"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeComisionRecuperacionPerdidas" parameterMap="paramComisionRecuperacionPerdidas" >
		{call COM_PKG_PROCE.COM_PR_COMIS_RECUP_PERDI(?,?,?,?,?,?,?,?,?)}
    </procedure>   
    
    
    <resultMap id="comisionRecuperacionPerdidasResult"     class="java.util.HashMap">    	
    	<result property="campanhaComision"			column="PERI_COD_PERI"/>
    	<result property="codigoComision"			column="COD_COMI"/>
    	<result property="codigoZona" 				column="COD_ZONA"/>
    	<result property="descripcionZona" 			column="DES_ZONA"/>
    	<result property="codigoLiderZona" 			column="COD_LIDE_ZONA"/>
    	<result property="nombreLiderZona" 			column="NOM_LIDE_ZONA"/>
    	<result property="promedioRecuperacion" 	column="VAL_PROM_RECU"/>
    	<result property="promedioActividad" 		column="VAL_PROM_ACTI"/>
    	<result property="montoComisionPerdida" 	column="VAL_COMI_PERD"/>
    	<result property="percentajeRecupTramo1" 	column="POR_RECU"/>
	</resultMap>
	
	<select id="getComisionRecuperacionPerdidas" parameterClass="java.util.Map" resultMap="comisionRecuperacionPerdidasResult">
				SELECT A.PERI_COD_PERI,
					   A.COD_COMI,
					   A.COD_ZONA,
					   (SELECT Y.DES_ZONA
					    FROM ZON_ZONA Y
						WHERE  Y.COD_ZONA = A.COD_ZONA) AS DES_ZONA,
					   A.COD_LIDE_ZONA,
					   A.NOM_LIDE_ZONA,
					   A.VAL_PROM_RECU,
					   A.VAL_PROM_ACTI,
					   A.VAL_COMI_PERD,
					   A.POR_RECU
				FROM COM_COMIS_PERIO_CALCU_ZONA A
				WHERE A.COD_COMI=#codigoComision#
				 AND <![CDATA[  (TO_NUMBER(A.PERI_COD_PERI)) >=(SELECT TO_NUMBER(#anhoProceso#||TRIM(Z.PER_INIC))
					     										FROM CRA_RANGO_PERIO Z
						 										WHERE  Z.COD_RAPE = #codigoRangoPeriodo#)]]>
				 AND <![CDATA[(TO_NUMBER(A.PERI_COD_PERI)) <=(SELECT TO_NUMBER(#anhoProceso#||TRIM(Z.PER_FINA))
					     									  FROM CRA_RANGO_PERIO Z
						 									   WHERE  Z.COD_RAPE = #codigoRangoPeriodo#)]]>
				 AND A.IMP_COMI_TRA1 = 0
				ORDER BY A.PERI_COD_PERI,A.COD_COMI,A.COD_ZONA				
	</select>
	
	<resultMap id="comisionRecuperacionPerdidasRegionResult" class="java.util.HashMap">    	
    	<result property="campanhaComision"			column="COD_PERI"/>
    	<result property="codigoComision"			column="COD_COMI"/>
    	<result property="codigoRegion" 		    column="COD_REGI"/>
    	<result property="descripcionRegion"		column="DES_REGI"/>
    	<result property="codigoLiderRegion"    	column="COD_LIDE_REGI"/>
    	<result property="nombreLiderRegion" 		column="NOM_LIDE_REGI"/>
    	<result property="promedioRecuperacion" 	column="VAL_PROM_RECU"/>
    	<result property="montoComisionPerdida" 	column="VAL_COMI_PERD"/>
    	<result property="percentajeRecupTramo1" 	column="POR_RECU_TRA1"/>
	</resultMap>
	
	<select id="getComisionRecuperacionPerdidasRegion" parameterClass="java.util.Map" resultMap="comisionRecuperacionPerdidasRegionResult">
				SELECT A.COD_PERI,         
				       A.COD_COMI,         
				       A.COD_REGI,         
				       (SELECT Y.DES_REGI          
				        FROM ZON_REGIO Y       
				        WHERE  Y.COD_REGI = A.COD_REGI) AS DES_REGI,         
				       A.COD_LIDE_REGI,         
				       A.NOM_LIDE_REGI,         
				       A.VAL_PROM_RECU,         
				       A.VAL_COMI_PERD,
       				   A.POR_RECU_TRA1 
				FROM COM_COMIS_PERIO_CALCU_REGIO A     
				WHERE A.COD_COMI = #codigoComision# 
				AND   <![CDATA[(TO_NUMBER(A.COD_PERI)) >= (SELECT TO_NUMBER(#anhoProceso#||TRIM(Z.PER_INIC))                     
				                                           FROM CRA_RANGO_PERIO Z                  
				                                           WHERE  Z.COD_RAPE = #codigoRangoPeriodo#)]]>      
				AND <![CDATA[(TO_NUMBER(A.COD_PERI)) <= (SELECT TO_NUMBER(#anhoProceso#||TRIM(Z.PER_FINA))                      
				                                         FROM CRA_RANGO_PERIO Z                    
				                                         WHERE  Z.COD_RAPE = #codigoRangoPeriodo#)]]>   
				AND A.IMP_MONT_COM1 = 0
				ORDER BY A.COD_PERI,A.COD_COMI,A.COD_REGI
	</select>
		    
    <resultMap id="periodosResultadosEvaluacionEjecutivaResult"     class="java.util.HashMap">    	
    	<result property="codigoTramoAnterior"		column="TRAM_ANTE"/>
    	<result property="anhoAnteriorTramo"		column="ANH_ANTE"/>
    	<result property="campanaInicioAct" 		column="CAM_ACT_INIC"/>
    	<result property="campanaFinAct" 			column="CAM_ACT_FINA"/>    	
	</resultMap>
	
	<select id="getPeriodosResultadosEvaluacionEjecutiva" parameterClass="java.util.Map" resultMap="periodosResultadosEvaluacionEjecutivaResult">
		SELECT 
	        CASE WHEN  (TO_NUMBER(X.COD_RANG)-1>0) THEN 
	           LPAD(TO_NUMBER(X.COD_RANG)-1,2,'0') 
	         ELSE (SELECT MAX(Z.COD_RANG)FROM COM_TRAMO_EJECU Z) 
        	END AS TRAM_ANTE,
        	CASE WHEN    (TO_NUMBER(X.COD_RANG)-1>0) THEN 
         		TO_NUMBER(#anhoInicialTramo#) 
       		ELSE TO_NUMBER(#anhoInicialTramo#)-1   
       		END AS ANH_ANTE,   
       		X.CAM_INIC CAM_ACT_INIC,
       		X.CAM_FINA CAM_ACT_FINA                                                 
		FROM COM_TRAMO_EJECU X
		WHERE X.COD_PAIS = #codigoPais#
		 AND X.COD_RANG = #codigoTramo#		
	</select>
	
	
   <update id="executeActualizacionEstatusEjecutivas" parameterClass="java.util.Map">
   
         UPDATE COM_HISTO_VARIA_EJETR_CABEC
		  SET  COD_NIVE = #codigoNivel#,
		       USU_MODI =#codigoUsuario#,
		       FEC_MODI= SYSDATE		    
		  WHERE  COD_PAIS = #codigoPais#
			AND  COD_MARC = #codigoMarca#
			AND  COD_CANA = #codigoCanal#
			AND COD_TIPO_COMI=#tipoComisionista#
			AND COD_EJEC=#codigoClienteBuscar#
			AND NUM_ANIO_INIC=#anioInicTramo#
			AND COD_RANG = #codTramo#
     	    
  </update>
	
  <parameterMap id="paramExecuteEliminarComisionRecuperacion" class="java.util.Map">
  		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="codigoMarca"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="codigoCanal"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="codigoComision"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	    <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="tipoComision"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="mensajeError"              jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
  </parameterMap>
  
  <procedure id="executeEliminarComisionRecuperacion" parameterMap="paramExecuteEliminarComisionRecuperacion">
  		{call COM_PKG_PROCE.COM_PR_ELIMI_COMIS_RECUP(?,?,?,?,?,?,?)}
  </procedure>

 <!-- OBTIENE LA RELACION DE COMISIONES -->
    <select id="getComisionByTipo" resultClass="baseGenericoCom"  parameterClass="java.util.Map">
		SELECT 
		C.COD_COMI AS CODIGO,
		C.COD_COMI || ' - ' || C.VAL_CONC AS DESCRIPCION 
		FROM COM_COMIS C 
		WHERE 1= 1
		
		<isNotEmpty prepend="AND" property="codigoTipoComision">
	    	C.TICO_TIPO_COMI = #codigoTipoComision#
	    </isNotEmpty>
		
		<isNotEmpty prepend="AND" property="indicadorEscalonada">
	    	C.IND_COMI_ESCA = #indicadorEscalonada#
	    </isNotEmpty>
	    
	    <isNotEmpty property="codigoBase" >
           	 <iterate prepend=" AND " property="codigoBase" open="coba_cod_base IN (" close=")" conjunction=",">
			    #codigoBase[]#
			 </iterate>    
         </isNotEmpty>
		ORDER BY COD_COMI			
    </select>
    
    
  <parameterMap id="paramExecuteObtenerListaZonasAsociadas" class="java.util.Map">
  		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	    <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
  </parameterMap>
  
  <procedure id="executeObtenerListaZonasAsociadas" parameterMap="paramExecuteObtenerListaZonasAsociadas">
  		{call CUP_PKG_PROG_NUEVAS.CUP_PR_NVS_OBTEN_ZONAS_ASOCI(?,?,?)}
  </procedure>

  <parameterMap id="paramExecuteValidarRegistroxCodigoConsultora" class="java.util.Map">
  		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
  		<parameter property="codigoConsultora"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
	    <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN" />
		<parameter property="mensajeSalida"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="OUT" />
  </parameterMap>
  
  <procedure id="executeValidarRegistroxCodigoConsultora" parameterMap="paramExecuteValidarRegistroxCodigoConsultora">
  		{call CUP_PKG_PROG_NUEVAS.CUP_PR_NVS_VALID_CONSU(?,?,?,?,?)}
  </procedure>
  
  <insert id="insertarConsultoraNuevas" parameterClass="java.util.Map">
  	Insert into CUP_CONSU_NUEVA(
	  	COD_PAIS, 
	    COD_PROG, 
	    COD_CONS, 
	    COD_ULT_NIVEL, 
	    CAMP_INI_CCC, 
	    CAMP_FIN_CCC, 
	    EST_PROC, 
	    IND_CONST, 
	    USU_DIGI, 
	    FEC_DIGI,
	    CAMP_INI_CCC_HIST, 
	    CAMP_FIN_CCC_HIST, 
	    COD_ULT_NIVEL_HIST, 
	    IND_ORIG_REGI
	)VALUES(
	    #codigoPais#,
	    #codigoPrograma#,
	    #codigoConsultora#,
	    '01',
	    gen_pkg_gener.gen_fn_perio_nsigu(#codigoPais#,#codigoPeriodo#,-1),
	    gen_pkg_gener.gen_fn_perio_nsigu(#codigoPais#,#codigoPeriodo#,-1),
	    '1',
	    (SELECT IND_CONST FROM CUP_PROG_NUEVA_CUPON WHERE COD_PAIS = #codigoPais# AND COD_PROG = #codigoPrograma#),
	    #usuarioLogin#,
	    SYSDATE,
	    gen_pkg_gener.gen_fn_perio_nsigu(#codigoPais#,#codigoPeriodo#,-1),
	    gen_pkg_gener.gen_fn_perio_nsigu(#codigoPais#,#codigoPeriodo#,-1),
	    '01',
	    '1'
	)
  </insert>
  
  <insert id="insertFacturacionPrograma" parameterClass="java.util.Map">
	INSERT INTO CUP_CONSU_FACTU(
		COD_PAIS, 
		COD_PROG, 
		COD_CONS, 
		IND_CONS, 
		USU_DIGI, 
		FEC_DIGI
	)VALUES(
		  #codigoPais#,
		  #codigoPrograma#,
		  #codigoConsultora#,
		  '0',
		  #usuarioLogin#,
	      SYSDATE
	)
  </insert>
  
  
  <select id="getIndicadorConstanciaProgramaAsociado" parameterClass="java.util.Map" resultClass="string">
  	SELECT IND_CONST||'_'|| NUM_VIG FROM CUP_PROG_NUEVA_CUPON
  		WHERE COD_PAIS =  #codigoPais# AND COD_PROG = #codigoPrograma#  
  </select>
  
  
  <insert id="insertNivelesConsultoras" parameterClass="java.util.Map">
  	INSERT INTO CUP_CONSU_NIVEL(
  		COD_PAIS,
		COD_PROG,
		COD_NIVEL,
		CAM_INIC_VIG,
		CAM_FIN_VIG,
		USU_DIGI,
		FEC_DIGI,
		COD_CONS
	)VALUES(
		#codigoPais#,
		#codigoPrograma#,
		#codigoNivel#,
		#campanyaInicioVigencia#,
		#campanyaFinVigencia#,
		#usuarioLogin#,
		SYSDATE,
		#codigoConsultora#
	)
  </insert>
  
  <resultMap id="paramGetListaMatrizEquivalente"     class="java.util.HashMap">    	
    	<result property="codigoPais"			column="COD_PAIS"/>
    	<result property="codigoPrograma"		column="COD_PROG"/>
    	<result property="codigoNivel" 			column="COD_NIVEL"/>
  </resultMap>
  
  <select id="getListaMatrizEquivalente" parameterClass="java.util.Map" resultMap="paramGetListaMatrizEquivalente">
 	SELECT DISTINCT COD_PAIS, COD_PROG, COD_NIVEL 
 		FROM CUP_CUPON_NIVEL WHERE  COD_PAIS = #codigoPais# AND COD_PROG = #codigoPrograma#
        ORDER BY COD_NIVEL
  </select>
  
  
  <update id="updateConsultoraNuevas" parameterClass="java.util.Map">
  	UPDATE CUP_CONSU_NUEVA
		SET CAMP_INI_CCC_HIST= (SELECT CAMP_INI_CCC FROM CUP_CONSU_NUEVA WHERE COD_PAIS = #codigoPais#  AND COD_PROG = #codigoPrograma# AND COD_CONS = #codigoConsultora# AND ROWNUM = 1),
		CAMP_FIN_CCC_HIST= (SELECT CAMP_FIN_CCC FROM CUP_CONSU_NUEVA WHERE COD_PAIS = #codigoPais#  AND COD_PROG = #codigoPrograma# AND COD_CONS = #codigoConsultora# AND ROWNUM = 1),
		COD_ULT_NIVEL_HIST= (SELECT COD_ULT_NIVEL FROM CUP_CONSU_NUEVA WHERE COD_PAIS = #codigoPais#  AND COD_PROG = #codigoPrograma# AND COD_CONS = #codigoConsultora# AND ROWNUM = 1),
		CAMP_INI_CCC= gen_pkg_gener.gen_fn_perio_nsigu(#codigoPais#,#codigoPeriodo#,-1),
		CAMP_FIN_CCC= gen_pkg_gener.gen_fn_perio_nsigu(#codigoPais#,#codigoPeriodo#,-1),
		COD_ULT_NIVEL= '01',
		EST_PROC = '1',
		USU_MODI = #usuarioLogin#,
		FEC_MODI = SYSDATE,
		IND_ORIG_REGI='1'
		WHERE COD_PAIS = #codigoPais# 
		AND COD_PROG = #codigoPrograma# 
		AND COD_CONS = #codigoConsultora#
  </update>
  
  <update id="updateConsultoraCupon" parameterClass="java.util.Map">
  	UPDATE CUP_CONSU_CUPON
		SET IND_UTILI ='0',
		CAM_UTILI = NULL,
		USU_MODI = #usuarioLogin#,
		FEC_MODI = SYSDATE
		WHERE 
		COD_PAIS = #codigoPais#
		AND COD_PROG = #codigoPrograma#
		AND COD_CONS = #codigoConsultora#
  </update>
  
  <update id="updateFacturacionPrograma" parameterClass="java.util.Map">
  	UPDATE CUP_CONSU_FACTU
		SET IND_CONS = '0',
		USU_MODI = #usuarioLogin#,
		FEC_MODI = SYSDATE
		WHERE COD_PAIS = #codigoPais#
		AND COD_PROG = #codigoPrograma#
		AND COD_CONS = #codigoConsultora#
  </update>
  
  <update id="updateNivelesConsultoras" parameterClass="java.util.Map">
  	UPDATE CUP_CONSU_NIVEL
		SET CAM_INIC_VIG = #campanyaInicioVigencia#,
		CAM_FIN_VIG	= #campanyaFinVigencia#,
		USU_MODI = #usuarioLogin#,
		FEC_MODI = SYSDATE
		WHERE COD_PAIS = #codigoPais#
		AND COD_PROG = #codigoPrograma#
		AND COD_CONS = #codigoConsultora#
  </update>
 
    <resultMap id="paramComisionRegionList"     class="java.util.HashMap">    	
    	<result property="codPeriodo"			column="COD_PERI"/>
    	<result property="codRegion"		column="COD_REGI"/>
    	<result property="numeroDocumentIdentidad"  column="NUM_DOCU_IDEN"/>
    	<result property="montoEstimado"		column="MON_CATA_ESTI"/>
    	<result property="montoReal"			column="MON_CATA_REAL"/>
    	<result property="porcentajeVenta"		column="POR_MON_CATA"/>
    	<result property="porcentajeComision"			column="POR_COMI_TRA1"/>
    	<result property="valorComi"				column="IMP_MONT_COM1"/>
  </resultMap>
  
  <select id="getComisionRegionList" resultMap="paramComisionRegionList" parameterClass="java.util.Map">
  <![CDATA[	   
  		select r.COD_PERI, 
  			   R.COD_REGI, 
		       ci.NUM_DOCU_IDEN, 
  			   r.MON_CATA_ESTI, 
  			   r.MON_CATA_REAL, 
  			   r.POR_MON_CATA, 
  			   r.POR_COMI_TRA1, 
  			   r.IMP_MONT_COMI1
          from com_comis_perio_calcu_regio r, 
               mae_clien m, 
		       mae_clien_datos_adici a,
		       mae_clien_ident ci
         where m.OID_CLIE = a.CLIE_OID_CLIE
           and r.COD_LIDE_REGI = m.COD_CLIE
		   and ci.CLIE_OID_CLIE = m.OID_CLIE
		   and ci.VAL_IDEN_DOCU_PRIN = 1
           and r.cod_peri >= #codigoPeriodoIni#
           and r.cod_peri <= #codigoPeriodoFin#
           ]]>
           <isNotEmpty property="codigoComision">        
			<iterate prepend="AND" property="codigoComision" open="(" close=")" conjunction="OR">
            	r.cod_comi = #codigoComision[]#
			</iterate>  
    	  </isNotEmpty>   
  </select>
  
    
  <resultMap id="paramComisionVal"     class="java.util.HashMap">    	
    	<result property="codigo"			column="cod_comi"/>
    	<result property="descripcion"		column="val_conc"/>
  </resultMap>
  
   <select id="getComisionVal" resultMap="paramComisionVal" parameterClass="java.util.Map"> 
  		select cod_comi , cod_comi ||' - ' ||val_conc val_conc  
   		  from com_comis 
   		  where 1=1
   		  <isNotEmpty property="estadoRegistro" prepend="and" >
           est_regi = #estadoRegistro# 
          </isNotEmpty>
          <isNotEmpty property="codigoBase" prepend="and">
          	coba_cod_base = #codigoBase#
          </isNotEmpty>
          <isNotEmpty property="tipoComision" prepend="and">
           TICO_TIPO_COMI = #tipoComision#
          </isNotEmpty>
          order by val_conc  
  </select>
  
  <select id="getComisionBase" resultMap="paramComisionVal" parameterClass="java.util.Map"> 
  		select cod_comi , cod_comi ||' - ' ||val_conc val_conc  
   		  from com_comis 
   		  where 1=1
   		  <isNotEmpty property="estadoRegistro" prepend="and" >
           est_regi = #estadoRegistro# 
          </isNotEmpty>
          
          <isNotEmpty property="codigoBase" >
           	 <iterate prepend=" AND " property="codigoBase" open="coba_cod_base IN (" close=")" conjunction=",">
			    #codigoBase[]#
			 </iterate>    
          </isNotEmpty>
          
          <isNotEmpty property="tipoComision" prepend="and">
           TICO_TIPO_COMI = #tipoComision#
          </isNotEmpty>
          order by val_conc  
  </select>
  
    <resultMap id="paramComGerenteZona"     class="java.util.HashMap">    	
        <result property="codigoComision"			column="cod_comi"/> 	
    	<result property="codigoPeriodo"			column="PERI_COD_PERI"/>
    	<result property="codigoRegion"				column="COD_REGI"/>
    	<result property="codigoZona"				column="COD_ZONA"/>
    	<result property="numeroIdentidad"			column="NUM_DOCU_IDEN"/>
    	<result property="codigoGerente"			column="COD_LIDE_ZONA"/>
    	<result property="valorFacturado"			column="VAL_FACT"/>
    	<result property="valorRecaudado"			column="IMP_PAGO_ANTE_LIMI_CIMP"/>
    	<result property="valorIva"					column="VAL_IMPU"/>
    	<result property="porcentajeRecuperacion"	column="POR_RECU"/>
    	<result property="ventaEstimada"			column="mon_cata_esti"/>
    	<result property="ventaReal"				column="mon_cata_real"/>
    	<result property="ventaRetail"				column="MON_VENT_RETL"/>
    	<result property="porcentajeVenta"			column="por_mon_cata"/>
    	<result property="porcentajeComision"		column="Val_Porc_comi_Tra1"/>
    	<result property="valorComision"			column="IMp_Comi_Tra1"/>
    	<result property="montoComisionable"		column="IMP_MONT_PAGO_COMI_CIMP"/>
    	<result property="nombreGerente"			column="NOM_LIDE_ZONA"/>
   </resultMap>
  
  <select id="getComGerenteZonaList" resultMap="paramComGerenteZona" parameterClass="java.util.Map">
  
	  select z.cod_comi,
	         Z.PERI_COD_PERI, 
	  		 Z.COD_REGI, 
	  		 Z.COD_ZONA, 
	  		 Z.COD_LIDE_ZONA,
	  		 (SELECT Y.NUM_DOCU_IDEN
	          FROM MAE_CLIEN X, 
	               MAE_CLIEN_IDENT Y
	          WHERE X.COD_CLIE = Z.COD_LIDE_ZONA
	            AND Y.CLIE_OID_CLIE = X.OID_CLIE
	            AND Y.VAL_IDEN_DOCU_PRIN = 1) NUM_DOCU_IDEN,
	        (Z.IMP_NETO_SREC_CIMP  -  IMP_DCTO_NETO_CIMP) VAL_FACT, 
	         z.IMP_PAGO_ANTE_LIMI_CIMP,
	         Z.IMP_IMPU_PAGO VAL_IMPU, 
	         Z.POR_RECU, 
	         z.mon_cata_esti  , 
	         z.mon_cata_real AS mon_cata_real, 
	         NVL(z.MON_VENT_RETL,0) AS MON_VENT_RETL, 
	         z.por_mon_cata, 
	         Z.Val_Porc_comi_Tra1,
	         Z.IMp_Comi_Tra1,
	         z.IMP_MONT_PAGO_COMI_CIMP,
             z.NOM_LIDE_ZONA
	 from COM_COMIS C, COM_COMIS_PERIO_CALCU_ZONA Z
	 where c.cod_comi = z.cod_comi
 	<isNotEmpty property="codigoComision">        
		<iterate prepend="AND" property="codigoComision" open="(" close=")" conjunction="OR">
           	z.cod_comi = #codigoComision[]#
		</iterate>  
     </isNotEmpty>   
 	<isNotEmpty property="codigoPeriodoInicial" prepend="and">        
           	z.peri_cod_peri >= #codigoPeriodoInicial#
     </isNotEmpty>
     <isNotEmpty property="codigoPeriodoFinal" prepend="and">
     <![CDATA[	           
           	z.peri_cod_peri <= #codigoPeriodoFinal#
           	]]>
     </isNotEmpty>      
 	<isNotEmpty property="codigoRegion">        
		<iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
           	z.cod_regi = #codigoRegion[]#
		</iterate>  
    </isNotEmpty>
    ORDER BY Z.COD_ZONA, z.peri_cod_peri
  </select>
  
	<resultMap id="resultExisteNivelConsultora"     class="java.util.HashMap">    	
    	<result property="codigoPais"					column="COD_PAIS"/>
    	<result property="codigoPrograma"				column="COD_PROG"/>
    	<result property="codigoNivel"					column="COD_NIVEL"/>
    	<result property="codigoConsultora"				column="COD_CONS"/>
    	<result property="campanyaInicialVigente"		column="CAM_INIC_VIG"/>
    	<result property="campanyaFinalVigente"			column="CAM_FIN_VIG"/>
	</resultMap>
  
	<select id="existeNivelConsultora" parameterClass="java.util.Map" resultMap="resultExisteNivelConsultora">
		SELECT COD_PAIS, COD_PROG, COD_NIVEL, COD_CONS, CAM_INIC_VIG, CAM_FIN_VIG FROM CUP_CONSU_NIVEL
		WHERE COD_PAIS    = #codigoPais# 
			AND COD_PROG  = #codigoPrograma# 
			AND COD_NIVEL = #codigoNivel# 
			AND COD_CONS  = #codigoConsultora#
	</select>
	
	<parameterMap id="paramCierreProcesosCampanna" class="java.util.Map" >
	    <parameter property="codigoPais"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>

    <procedure id="executeCierreProcesosCampanna" parameterMap="paramCierreProcesosCampanna" >
		{call COM_PKG_REPOR.COM_PR_ACTUA_COMIS_VENTA_RETAI(?, ?)}
    </procedure>	
    
    
	<resultMap id="paramComisionGerenteRegionObjetivo"     class="java.util.HashMap">    	
        <result property="codigoComision"			column="COD_COMI"/>  	
    	<result property="codigoPeriodo"			column="COD_PERI"/>
    	<result property="codigoRegion"				column="COD_REGI"/>
    	<result property="codigoGerente"			column="COD_LIDE_REGI"/>
    	<result property="numeroIdentidad"			column="NUM_DOCU_IDEN"/>
    	<result property="valorFacturado"			column="VAL_FACT"/>
    	<result property="valorRecaudado"			column="IMP_MONT_PAGA_TRA1_CIMP"/>
    	<result property="valorIva"					column="VAL_IMPU"/>
    	<result property="porcentajeRecuperacion"	column="POR_RECU_TRA1"/>
    	<result property="ventaEstimada"			column="mon_cata_esti"/>
    	<result property="ventaReal"				column="mon_cata_real"/>
    	<result property="ventaRetail"				column="MON_VENT_RETL"/>
    	<result property="porcentajeVenta"			column="por_mon_cata"/>
    	<result property="porcentajeComision"		column="POR_COMI_TRA1"/>
    	<result property="valorComision"			column="IMP_MONT_COM1"/>
    	<result property="montoComisionable"		column="IMP_MONT_PAGO_COMI_CIMP"/>
      	<result property="nombreGerente"			column="NOM_LIDE_REGI"/>
  </resultMap>
    
    <select id="getComisionGerenteRegionObjetivo" resultMap="paramComisionGerenteRegionObjetivo" parameterClass="java.util.Map">
	  select Z.COD_COMI,
	         Z.COD_PERI, 
	         Z.COD_REGI, 
	         Z.COD_LIDE_REGI,
	         (SELECT Y.NUM_DOCU_IDEN
	            FROM MAE_CLIEN X, 
	                 MAE_CLIEN_IDENT Y
	            WHERE X.COD_CLIE = Z.COD_LIDE_REGI
	              AND Y.CLIE_OID_CLIE = X.OID_CLIE
	              AND Y.VAL_IDEN_DOCU_PRIN = 1) NUM_DOCU_IDEN,
	          (Z.IMP_NETO_SREC_CIMP  -  IMP_DCTO_NETO_CIMP) VAL_FACT, 
	           z.IMP_MONT_PAGA_TRA1_CIMP,
	           Z.IMP_IMPU_PAGO VAL_IMPU, 
	           Z.POR_RECU_TRA1, 
	           z.mon_cata_esti  , 
	           z.mon_cata_real , 
	           NVL(z.MON_VENT_RETL,0) MON_VENT_RETL,
	           z.por_mon_cata, 
	           Z.POR_COMI_TRA1,
	           Z.IMP_MONT_COM1,
	           Z.IMP_MONT_PAGO_COMI_CIMP,
               Z.NOM_LIDE_REGI
	   from COM_COMIS C, COM_COMIS_PERIO_CALCU_REGIO Z
	   where c.cod_comi = z.cod_comi
 	<isNotEmpty property="codigoComision">        
		<iterate prepend="AND" property="codigoComision" open="(" close=")" conjunction="OR">
           	z.cod_comi = #codigoComision[]#
		</iterate>  
     </isNotEmpty>   
   	
 	<isNotEmpty property="codigoPeriodoInicial" prepend="and">        
           	z.cod_peri >= #codigoPeriodoInicial#
     </isNotEmpty>
     
     <isNotEmpty property="codigoPeriodoFinal" prepend="and">
     <![CDATA[	           
           	z.cod_peri <= #codigoPeriodoFinal#
           	]]>
     </isNotEmpty>      
 
 	<isNotEmpty property="codigoRegion">        
		<iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
           	z.cod_regi = #codigoRegion[]#
		</iterate>  
    </isNotEmpty>
    ORDER BY Z.COD_PERI, Z.COD_REGI
  </select>
  
  
  <parameterMap id="paramExecuteComisionesVentaRetail" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoMarca"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoCanal"               jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoComision"            jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="usuario.login"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	
	<procedure id="executeComisionesVentaRetail" parameterMap="paramExecuteComisionesVentaRetail" >
		{call COM_PKG_PROCE.COM_PR_CALCU_COMIS_VENTA_RETAI(?, ?, ?, ?, ?, ?)}
    </procedure>
  
  
    <resultMap id="paramComisionGerenteRetail"     class="java.util.HashMap">  
        <result property="codigoComision"			column="COD_COMI"/>  	
    	<result property="codigoPeriodo"			column="PERI_COD_PERI"/>
    	<result property="codigoZona"				column="COD_ZONA"/>
    	<result property="codigoGerente"			column="COD_LIDE_ZONA"/>
    	<result property="nombreGerente"			column="NOM_GERE"/>
    	<result property="numeroIdentidad"			column="NUM_DOCU_IDEN"/>
    	<result property="montoVenta"			    column="IMP_NETO_CIMP"/>
    	<result property="montoComision"			column="IMP_COMI_TRA1"/>
    </resultMap>
    
    <select id="getComisionRetail" resultMap="paramComisionGerenteRetail" parameterClass="java.util.Map">
	  select Z.COD_COMI,
	         Z.PERI_COD_PERI, 
	         Z.COD_ZONA, 
	         Z.COD_LIDE_ZONA,
	         (SELECT Y.NUM_DOCU_IDEN
	            FROM MAE_CLIEN X, 
	                 MAE_CLIEN_IDENT Y
	            WHERE X.COD_CLIE = Z.COD_LIDE_ZONA
	              AND Y.CLIE_OID_CLIE = X.OID_CLIE
	              AND Y.VAL_IDEN_DOCU_PRIN = 1) NUM_DOCU_IDEN,
	          (SELECT TRIM(X.VAL_NOM1) || ', ' || TRIM(X.VAL_APE1) || ' ' || TRIM(X.VAL_APE2)
	            FROM MAE_CLIEN X
	            WHERE X.COD_CLIE = Z.COD_LIDE_ZONA) NOM_GERE,
	           z.IMP_NETO_CIMP,
	           Z.IMP_COMI_TRA1 
	   from COM_COMIS_PERIO_CALCU_ZONA Z
	   where 1=1
 	<isNotEmpty property="codigoComision">        
		<iterate prepend="AND" property="codigoComision" open="(" close=")" conjunction="OR">
           	z.cod_comi = #codigoComision[]#
		</iterate>  
     </isNotEmpty>   
   	
 	<isNotEmpty property="codigoPeriodoInicial" prepend="and">        
           	z.PERI_COD_PERI >= #codigoPeriodoInicial#
     </isNotEmpty>
     
     <isNotEmpty property="codigoPeriodoFinal" prepend="and">
     <![CDATA[	           
           	z.PERI_COD_PERI <= #codigoPeriodoFinal#
           	]]>
     </isNotEmpty>      
 
 	<isNotEmpty property="codigoRegion">        
		<iterate prepend="AND" property="codigoRegion" open="(" close=")" conjunction="OR">
           	z.cod_regi = #codigoRegion[]#
		</iterate>  
    </isNotEmpty>
    ORDER BY Z.PERI_COD_PERI, Z.COD_COMI, Z.COD_ZONA
  </select>
  
  <parameterMap id="paramExecuteEliminarComisionesGerenteRetiradas" class="java.util.Map" >
	    <parameter property="codigoPeriodo"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoRegion"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoZona"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoCliente"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoComision"         jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="tipoComision"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>

    <procedure id="executeEliminarComisionesGerenteRetiradas" parameterMap="paramExecuteEliminarComisionesGerenteRetiradas" >
		{call COM_PKG_REPOR.COM_PR_ELIMI_COMIS_GEREN_RETIR(?, ?, ?, ?, ?, ?)}
    </procedure>	
    
   	<parameterMap id="paramExecuteGenerarBaseRecuperacionCobranza" class="java.util.Map" >
		<parameter property="codigoPais"                jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodo"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoPeriodoRecaudo"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="fechaFacturacion"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"             jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
	
	<procedure id="executeGenerarBaseRecuperacionCobranza" parameterMap="paramExecuteGenerarBaseRecuperacionCobranza" >
		{call COM_PKG_PROCE.COM_PR_GENER_BASE_RECUP_COBRA(?, ?, ?, ?, ?)}
    </procedure>    
  
</sqlMap>