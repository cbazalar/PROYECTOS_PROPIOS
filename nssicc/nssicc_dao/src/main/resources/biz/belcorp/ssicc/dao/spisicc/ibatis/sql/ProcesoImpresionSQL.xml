<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="ProcesoImpresionSQL">

    <typeAlias alias="procesoImpresion" type="biz.belcorp.ssicc.dao.spisicc.model.ProcesoImpresion"/>
    <typeAlias alias="subprocesoImpresion" type="biz.belcorp.ssicc.dao.spisicc.model.SubprocesoImpresion"/>
    <typeAlias alias="procesoSpool" type="biz.belcorp.ssicc.dao.spisicc.model.ProcesoSpool"/>
    
    <typeAlias alias="subprocesoImpresionPK" type="biz.belcorp.ssicc.dao.spisicc.model.SubprocesoImpresionPK"/>
    <typeAlias alias="archivoImpresion" type="biz.belcorp.ssicc.dao.spisicc.model.ArchivoImpresion"/>
    <typeAlias alias="baseGenericoIMP" type="biz.belcorp.ssicc.dao.sisicc.model.Base"/>

    <resultMap id="baseResult"          class="baseGenericoIMP">
    	<result property="codigo" 		column="CODIGO" 	/>
    	<result property="descripcion" 	column="DESCRIPCION"/>
    </resultMap>

    <resultMap id="procesoImpresionResult" class="procesoImpresion">
        <result property="codigo" column="COD_PROC"/>
        <result property="descripcion" column="DES_PROC"/>
        <result property="directorioOrigen" column="DIR_ORIG"/>
        <result property="directorioDestino" column="DIR_DEST"/>
        <result property="directorioHistorico" column="DIR_HIST"/>
        <result property="prefijoArchivo" column="PRE_ARCH"/>
        <result property="numeroCorrelativoAcumulado" column="NUM_CORR_ACUM" javaType="long" nullValue="0"/>
        <result property="numeroCorrelativoDiario" column="NUM_CORR_DIAR" javaType="long" nullValue="0"/>
        <result property="fechaUltimaEjecucion" column="FEC_ULTI_EJEC"/>
        <result property="flagEnvioFTP" column="FLA_FTP"/>
        <result property="servidorFTP" column="SER_FTP"/>
        <result property="puertoFTP" column="PUE_FTP" javaType="int" nullValue="21"/>
        <result property="usuarioFTP" column="USU_FTP"/>
        <result property="passwordFTP" column="PAS_FTP"/>
        <result property="directorioFTP" column="DIR_FTP"/>
        <result property="estado" column="EST_PROC"/>
        <result property="auditInfo.createdBy" column="USU_DIGI"/>
        <result property="auditInfo.created" column="FEC_DIGI"/>
        <result property="auditInfo.updatedBy" column="USU_MODI"/>
        <result property="auditInfo.lastUpdated" column="FEC_MODI"/>
    </resultMap>

    <select id="getProcesosImpresion" parameterClass="procesoImpresion" resultMap="procesoImpresionResult">
        SELECT 
        COD_PROC, 
        DES_PROC,
        DIR_ORIG, 
        DIR_DEST, 
        DIR_HIST, 
        PRE_ARCH, 
        NUM_CORR_ACUM, 
        NUM_CORR_DIAR, 
        FEC_ULTI_EJEC, 
        FLA_FTP, 
        SER_FTP, 
        PUE_FTP, 
        USU_FTP, 
        PAS_FTP, 
        DIR_FTP, 
        EST_PROC,
        USU_DIGI, 
        FEC_DIGI, 
        USU_MODI, 
        FEC_MODI
        FROM IMP_PROCE_IMPRE
        WHERE EST_PROC != '9'
        <isNotEmpty prepend="AND" property="codigo">
            COD_PROC = #codigo#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="descripcion">
            DES_PROC LIKE #descripcion#
        </isNotEmpty>
    </select>
    
    <select id="getProcesosImpresionByCriteria" parameterClass="java.util.Map" resultMap="procesoImpresionResult">
        SELECT 
        COD_PROC, 
        DES_PROC,
        DIR_ORIG, 
        DIR_DEST, 
        DIR_HIST, 
        PRE_ARCH, 
        NUM_CORR_ACUM, 
        NUM_CORR_DIAR, 
        FEC_ULTI_EJEC, 
        FLA_FTP, 
        SER_FTP, 
        PUE_FTP, 
        USU_FTP, 
        PAS_FTP, 
        DIR_FTP, 
        EST_PROC,
        USU_DIGI, 
        FEC_DIGI, 
        USU_MODI, 
        FEC_MODI
        FROM IMP_PROCE_IMPRE
        WHERE EST_PROC != '9'
        <isNotEmpty prepend="AND" property="codigoProcesoImpresion">
            COD_PROC = #codigoProcesoImpresion#
        </isNotEmpty>
        <isNotEmpty prepend="AND" property="descripcionProcesoImpresion">
            DES_PROC LIKE #descripcionProcesoImpresion#
        </isNotEmpty>
    </select>
    
    <select id="getProcesoImpresion" parameterClass="string" resultMap="procesoImpresionResult">
        SELECT 
        COD_PROC, 
        DES_PROC,
        DIR_ORIG, 
        DIR_DEST, 
        DIR_HIST, 
        PRE_ARCH, 
        NUM_CORR_ACUM, 
        NUM_CORR_DIAR, 
        FEC_ULTI_EJEC, 
        FLA_FTP, 
        SER_FTP, 
        PUE_FTP, 
        USU_FTP, 
        PAS_FTP, 
        DIR_FTP, 
        USU_DIGI, 
        FEC_DIGI, 
        EST_PROC,
        USU_MODI, 
        FEC_MODI
        FROM IMP_PROCE_IMPRE
        WHERE COD_PROC = #value#
    </select>
    
    <insert id="insertProcesoImpresion" parameterClass="procesoImpresion">
        INSERT INTO IMP_PROCE_IMPRE (
        COD_PROC,
        DES_PROC, 
        DIR_ORIG, 
        DIR_DEST, 
        DIR_HIST, 
        PRE_ARCH, 
        NUM_CORR_ACUM, 
        NUM_CORR_DIAR, 
        FEC_ULTI_EJEC, 
        FLA_FTP, 
        SER_FTP, 
        PUE_FTP, 
        USU_FTP, 
        PAS_FTP, 
        DIR_FTP, 
        EST_PROC,
        USU_DIGI, 
        FEC_DIGI) 
        VALUES ( 
        #codigo#,
        #descripcion#, 
        #directorioOrigen#, 
        #directorioDestino#,
        #directorioHistorico#, 
        #prefijoArchivo#, 
        #numeroCorrelativoAcumulado#,
        #numeroCorrelativoDiario#, 
        #fechaUltimaEjecucion#, 
        #flagEnvioFTP#,
        #servidorFTP#, 
        #puertoFTP#, 
        #usuarioFTP#,
        #passwordFTP#, 
        #directorioFTP#, 
        #estado#,
        #auditInfo.createdBy#, 
        #auditInfo.created#)
    </insert>
    
    <update id="updateProcesoImpresion" parameterClass="procesoImpresion">
        UPDATE IMP_PROCE_IMPRE SET    
        DES_PROC      = #descripcion#,
        DIR_ORIG      = #directorioOrigen#,
        DIR_DEST      = #directorioDestino#,
        DIR_HIST      = #directorioHistorico#,
        PRE_ARCH      = #prefijoArchivo#,
        NUM_CORR_ACUM = #numeroCorrelativoAcumulado#,
        NUM_CORR_DIAR = #numeroCorrelativoDiario#,
        FEC_ULTI_EJEC = #fechaUltimaEjecucion#,
        FLA_FTP       = #flagEnvioFTP#,
        SER_FTP       = #servidorFTP#,
        PUE_FTP       = #puertoFTP#,
        USU_FTP       = #usuarioFTP#,
        PAS_FTP       = #passwordFTP#,
        DIR_FTP       = #directorioFTP#,
        EST_PROC      = #estado#,
        USU_MODI      = #auditInfo.updatedBy#,
        FEC_MODI      = #auditInfo.lastUpdated#
        WHERE COD_PROC = #codigo#
    </update>

    <resultMap id="subprocesoImpresionResult" class="subprocesoImpresion">
        <result property="codigoProceso" column="PRIM_COD_PROC"/>
        <result property="codigo" column="COD_SUBP"/>
        <result property="descripcion" column="DES_SUBP"/>
        <result property="ordenEjecucion" column="ORD_PROC" javaType="int" nullValue="1"/>
        <result property="nombreArchivo" column="NOM_ARCH"/>
        <result property="estado" column="EST_SUBP"/>
    </resultMap>

    <select id="getSubprocesosImpresionByCodigoProceso" parameterClass="string" resultMap="subprocesoImpresionResult">
        SELECT 
        PRIM_COD_PROC, 
        COD_SUBP, 
        DES_SUBP, 
        ORD_PROC, 
        NOM_ARCH,
        EST_SUBP
        FROM IMP_SUBPR_IMPRE
        WHERE PRIM_COD_PROC = #value#
    </select>

    <resultMap id="archivoImpresionResult" class="archivoImpresion">
        <result property="codigoProceso" column="PRIM_COD_PROC"/>
        <result property="codigoSubproceso" column="SUIM_COD_SUBP"/>
        <result property="correlativo" column="COR_ARCH"/>
        <result property="patronNombre" column="PAT_NOMB"/>
        <result property="orden" column="ORD_ARCH"/>
        <result property="estado" column="EST_ARCH"/>
    </resultMap>

    <select id="getArchivosImpresionByCodigoSubproceso" parameterClass="subprocesoImpresionPK" resultMap="archivoImpresionResult">
        SELECT 
        PRIM_COD_PROC, 
        SUIM_COD_SUBP, 
        COR_ARCH, 
        PAT_NOMB, 
        ORD_ARCH, 
        EST_ARCH
        FROM IMP_ARCHI_SUBPR
        WHERE PRIM_COD_PROC = #codigoProceso#
        AND SUIM_COD_SUBP = #codigo#
    </select>

    <parameterMap id="cargarPaqueteDocumentarioMap" class="map">
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeCargarPaqueteDocumentarioSiCC" parameterMap="cargarPaqueteDocumentarioMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CARGA_XML_SICC(?, ?)}
    </procedure>

    <parameterMap id="cargarCuponPagoMap" class="map">
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeCargarCuponPago" parameterMap="cargarCuponPagoMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CARGA_XML_CUPON(?, ?)}
    </procedure>

    <procedure id="executeFusionarPaqueteDocumentario">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_COMPA_PAQUE_DOCUM()}
    </procedure>

    <parameterMap id="generarPaqueteDocumentarioMap" class="map">
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="numeroDocumento" jdbcType="NUMBER" mode="IN"/>
        <parameter property="numeroArchivosSalida" jdbcType="NUMBER" mode="IN"/>
    </parameterMap>

    <procedure id="executeGenerarPaqueteDocumentario" parameterMap="generarPaqueteDocumentarioMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_PAQUE_DOCUM_TO_FILE(?, ?, ?, ?)}
    </procedure>

    <update id="removeNotasCredito">
        TRUNCATE TABLE IMP_NOTA_CREDI
    </update>

    <parameterMap id="cargarNotaCreditoMap" class="map">
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="numeroSerie" jdbcType="NUMBER" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeCargarNotaCredito" parameterMap="cargarNotaCreditoMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CARGA_NOTA_CREDI(?, ?, ?, ?, ?)}
    </procedure>

    <parameterMap id="generarNotaCreditoConsolidadaMap" class="map">
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="numeroSerie" jdbcType="NUMBER" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGenerarNotaCreditoConsolidada" parameterMap="generarNotaCreditoConsolidadaMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_NOTA_CREDI_TO_FILE(?, ?, ?, ?, ?)}
    </procedure>

    <select id="getValorParametroImpresion" parameterClass="java.util.Map" resultClass="string">
        SELECT VAL_PARA_PRIM
        FROM IMP_PARAM_PROCE_IMPRE
        WHERE PRIM_COD_PROC = #codigoProceso#
        AND NOM_PARA_PRIM = #nombreParametro#
        AND EST_PARA_PRIM = '1'
    </select>
    
     <parameterMap id="executeGeneracionDocumentosLaserFaturaMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoMarca" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoCanal" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneracionDocumentosLaserFactura" parameterMap="executeGeneracionDocumentosLaserFaturaMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CALCU_DOCUM_LASER_FACTU(?, ?, ?, ?, ?)}
    </procedure>
    
    	
    <resultMap id="documentoLaserCabeceraResult" class="java.util.HashMap">
   			<result property="valNumeSoli"					column="VAL_NUME_SOLI"/>					
			<result property="oidCabe"						column="OID_CABE"/>								
			<result property="numDocuLega"					column="NUM_DOCU_LEGA"/>					
			<result property="codPais"						column="COD_PAIS"/>								
			<result property="desPais"						column="DES_PAIS"/>								
			<result property="fecEmis"						column="FEC_EMIS"/>								
			<result property="numDocuContInte"	 			column="NUM_DOCU_CONT_INTE"/>			
			<result property="oidClie"						column="OID_CLIE"/>								
			<result property="codClie"						column="COD_CLIE"/>								
			<result property="codPeri"						column="COD_PERI"/>								
			<result property="codRegi"						column="COD_REGI"/>								
			<result property="codZona"						column="COD_ZONA"/>								
			<result property="codTerr"						column="COD_TERR"/>								
			<result property="nomComp"						column="NOM_COMP"/>								
			<result property="valDireComp"					column="VAL_DIRE_COMP"/>					
			<result property="impDescTotaLoca"				column="IMP_DESC_TOTA_LOCA"/>			
			<result property="impImpuTotaLoca"				column="IMP_IMPU_TOTA_LOCA"/>			
			<result property="valNumeIdenFisc"				column="VAL_NUME_IDEN_FISC"/>			
			<result property="impFletTotaLoca"				column="IMP_FLET_TOTA_LOCA"/>			
			<result property="valTotaPagaLoca"				column="VAL_TOTA_PAGA_LOCA"/>			
			<result property="sumPconTotaLoca"				column="SUM_PCON_TOTA_LOCA"/>			
			<result property="sumPnetTotaFact"				column="SUM_PNET_TOTA_FACT"/>			
			<result property="sumSimpTotaFact"				column="SUM_SIMP_TOTA_FACT"/>			
			<result property="sumNumUnidAten"		  		column="SUM_NUM_UNID_ATEN"/>			
			<result property="sumTotaLetr"					column="SUM_TOTA_LETR"/>					
			<result property="valTasaImpu"					column="VAL_TASA_IMPU"/>					
			<result property="indTasaImpu"					column="IND_TASA_IMPU"/>					
			<result property="valDesc"						column="VAL_DESC"/>								
			<result property="valTotal"					    column="VAL_TOTA"/>					
			<result property="valImpoVent"					column="VAL_IMPO_VENT"/>					
			<result property="valBaseImpo"					column="VAL_BASE_IMPO"/>
			<result property="codPeriRefe"				    column="COD_PERI_REFE"/>
			<result property="valNumeSoliRefe"			    column="VAL_NUME_SOLI_REFE"/>
			<result property="codTipoDocu"			        column="COD_TIPO_DOCU"/>
			<result property="valSeriDocuLega"			    column="VAL_SERI_DOCU_LEGA"/>					

  </resultMap>  
     
     
  <select id="getDocumentoLaserCabeceraList" resultMap="documentoLaserCabeceraResult">
				SELECT VAL_NUME_SOLI,
			       OID_CABE,
			       NUM_DOCU_LEGA,
			       COD_PAIS,
			       DES_PAIS,
			       FEC_EMIS,
			       NUM_DOCU_CONT_INTE,
			       OID_CLIE,
			       COD_CLIE,
			       COD_PERI,
			       COD_REGI,
			       COD_ZONA,
			       COD_TERR,
			       NOM_COMP,
			       VAL_DIRE_COMP,
			       VAL_NUME_IDEN_FISC,
			       IMP_DESC_TOTA_LOCA,
			       IMP_IMPU_TOTA_LOCA,
			       IMP_FLET_TOTA_LOCA,
			       VAL_TOTA_PAGA_LOCA,
			       SUM_PCON_TOTA_LOCA,
			       SUM_PNET_TOTA_FACT,
			       SUM_SIMP_TOTA_FACT,
			       SUM_NUM_UNID_ATEN,
			       SUM_TOTA_LETR,
			       VAL_TASA_IMPU,
			       IND_TASA_IMPU,
			       VAL_DESC,
			       VAL_TOTA,
			       VAL_IMPO_VENT,
			       VAL_BASE_IMPO,
			       NVL(COD_PERI_REFE, ' ') COD_PERI_REFE,
			       NVL(VAL_NUME_SOLI_REFE, 0) VAL_NUME_SOLI_REFE,
			       COD_TIPO_DOCU,
			       VAL_SERI_DOCU_LEGA
 	 			FROM IMP_PAQUE_GENER_DOCUM_LASER
 	 			ORDER BY COD_CLIE, OID_CABE
 </select>
 
 
 <resultMap id="documentoLaserFacturaDetalleResult" class="java.util.HashMap">			
		<result property="dccaOidCabe"              			column="DCCA_OID_CABE"/>                        
		<result property="oidLine"               				column="OID_LINE"/>                         
		<result property="numLinea"                  			column="NUM_LINEA"/>                            
		<result property="numUnidAten"              			column="NUM_UNID_ATEN"/>                        
		<result property="prodOidProd"              			column="PROD_OID_PROD"/>                        
		<result property="desProd"			       			   	column="DES_PROD"/>                    
		<result property="valPrecCataUnitLoca"    			   	column="VAL_PREC_CATA_UNIT_LOCA"/>              
		<result property="valPrecCataTotaLoca"    			   	column="VAL_PREC_CATA_TOTA_LOCA"/>             
		<result property="valPrecContUnitLoca"    			   	column="VAL_PREC_CONT_UNIT_LOCA"/>              
		<result property="valPrecContTotaLoca"    			   	column="VAL_PREC_CONT_TOTA_LOCA"/>              
		<result property="impDescUnitLoca"         			   	column="IMP_DESC_UNIT_LOCA"/>                   
		<result property="impDescTotaLoca"         			   	column="IMP_DESC_TOTA_LOCA"/>                   
		<result property="valPrecFactUnitLoca"    			   	column="VAL_PREC_FACT_UNIT_LOCA"/>              
		<result property="valPrecFactTotaLoca"    			   	column="VAL_PREC_FACT_TOTA_LOCA"/>              
		<result property="impImpuUnitLoca"         		    	column="IMP_IMPU_UNIT_LOCA"/>                  
		<result property="impImpuTotaLoca"         			   	column="IMP_IMPU_TOTA_LOCA"/>                   
		<result property="valPrecNetoUnitLoca"    			   	column="VAL_PREC_NETO_UNIT_LOCA"/>              
		<result property="valPrecNetoTotaLoca"    			   	column="VAL_PREC_NETO_TOTA_LOCA"/>              
		<result property="valPorcDesc"              			column="VAL_PORC_DESC"/>   
		<result property="valPrecCataUnitFact"    			   	column="VAL_PREC_CATA_UNIT_FACT"/>              
		<result property="valPrecSinImpuTotaFact"			    column="VAL_PREC_SIN_IMPU_TOTA_FACT"/>          
		<result property="impDescTotaFact"         			   	column="IMP_DESC_TOTA_FACT"/>                   
		<result property="valPrecNetoTotaFact"    			   	column="VAL_PREC_NETO_TOTA_FACT"/>              
		<result property="impImpuTotaFact"          			column="IMP_IMPU_TOTA_FACT"/>                 	                     
   </resultMap>   
  
  <select id="getDocumentoLaserFacturaDetalleList" parameterClass="java.util.Map" resultMap="documentoLaserFacturaDetalleResult">
			SELECT * FROM 
			(SELECT AX.*,  ROWNUM  RNUM FROM    
			  (SELECT   X.DCCA_OID_CABE,
			         X.OID OID_LINE,
			         X.NUM_LINEA,
			         X.NUM_UNID_ATEN,
			         X.PROD_OID_PROD,
			         Y.VAL_I18N DES_PROD,
			         X.VAL_PREC_CATA_UNIT_LOCA, 
			         X.VAL_PREC_CATA_TOTA_LOCA,  
			         X.VAL_PREC_CONT_UNIT_LOCA,  
			         X.VAL_PREC_CONT_TOTA_LOCA,  
			         X.IMP_DESC_UNIT_LOCA,  
			         X.IMP_DESC_TOTA_LOCA,          
			         X.VAL_PREC_FACT_UNIT_LOCA,  
			         X.VAL_PREC_FACT_TOTA_LOCA,  
			         X.IMP_IMPU_UNIT_LOCA,  
			         X.IMP_IMPU_TOTA_LOCA,  
			         X.VAL_PREC_NETO_UNIT_LOCA,  
			         X.VAL_PREC_NETO_TOTA_LOCA,  
			         NVL(X.VAL_PORC_DESC, 0) VAL_PORC_DESC, 
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, X.VAL_PREC_CONT_UNIT_LOCA, X.VAL_PREC_CATA_UNIT_LOCA) VAL_PREC_CATA_UNIT_FACT,  
			         DECODE(X.VAL_PREC_CATA_TOTA_LOCA, 0, X.VAL_PREC_CONT_TOTA_LOCA, ROUND(X.VAL_PREC_CATA_TOTA_LOCA / (1 + #valTasaImpu# / 100), 2)) VAL_PREC_SIN_IMPU_TOTA_FACT, 
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, X.VAL_PREC_CONT_TOTA_LOCA, ROUND((X.VAL_PREC_CATA_TOTA_LOCA / (1 + #valTasaImpu# /100)) * (NVL(X.VAL_PORC_DESC, 0) / 100), 2)) IMP_DESC_TOTA_FACT,  
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, 0, X.VAL_PREC_NETO_TOTA_LOCA) VAL_PREC_NETO_TOTA_FACT, 
			         DECODE(X.VAL_PREC_CATA_TOTA_LOCA, 0, 0, X.IMP_IMPU_TOTA_LOCA) IMP_IMPU_TOTA_FACT   
			    FROM FAC_DOCUM_CONTA_LINEA X,
			         (SELECT VAL_I18N, VAL_OID FROM GEN_I18N_SICC WHERE ATTR_ENTI = 'MAE_PRODU') Y,
                     PED_SOLIC_POSIC Z,
                     PRE_OFERT_DETAL P
			   WHERE X.PROD_OID_PROD = Y.VAL_OID
                AND  X.SOPO_OID_SOLI_POSI = Z.OID_SOLI_POSI
                AND  Z.OFDE_OID_DETA_OFER = P.OID_DETA_OFER
                AND  NOT EXISTS (SELECT NULL
                                 FROM FAC_TIPO_OFERT_EXCLU O
                                 WHERE O.TOFE_OID_TIPO_OFER = P.TOFE_OID_TIPO_OFER)
			    AND  X.DCCA_OID_CABE = #oidCabe#
			    AND  X.NUM_UNID_ATEN > 0  
			   ORDER BY X.NUM_LINEA) AX 
			   
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowHasta">
					<![CDATA[ROWNUM <= #rowHasta#]]>
				</isNotEmpty>
			</dynamic>) 
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowDesde">
					RNUM >= #rowDesde#
				</isNotEmpty>
		     </dynamic>
  </select>
    
  <select id="getParametroPaginacionDetalle" parameterClass="java.util.Map" resultClass="java.lang.String">
		 SELECT A.VAL_PARA_PRIM
		 FROM IMP_PARAM_PROCE_IMPRE A
		 WHERE A.PRIM_COD_PROC = #codProceso#
		 AND A.NOM_PARA_PRIM = #nomParametro#
  </select>
  
  <insert id="saveDocumentoLaserXML" parameterClass="java.util.Map">	
  	INSERT INTO IMP_TMP_GENER_DOCUM_LASER
	  (OID_CABE, COD_CLIE, NUM_PAGI, XML_PAGI)
	VALUES
	  (#oidCabe#, #codClie#, #pagina#, #documentoLaserXML#)
  </insert>
  
  <procedure id="generacionDocumentosLaserFacturaXML">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_DOCUM_LASER_FACTU}
  </procedure>
    
   <parameterMap id="executeGeneracionDocumentosLaserGuiaMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoMarca" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoCanal" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>
  
    <procedure id="executeGeneracionDocumentosLaserGuia" parameterMap="executeGeneracionDocumentosLaserGuiaMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CALCU_DOCUM_LASER_GUIA(?, ?, ?, ?, ?)}
    </procedure>
    
    <resultMap id="documentoLaserGuiaDetalleResult" class="java.util.HashMap">			
		<result property="dccaOidCabe"              			column="DCCA_OID_CABE"/>                        
		<result property="oidLine"               				column="OID_LINE"/>                         
		<result property="numLinea"                  			column="NUM_LINEA"/>                            
		<result property="numUnidAten"              			column="NUM_UNID_ATEN"/>                        
		<result property="prodOidProd"              			column="PROD_OID_PROD"/>                        
		<result property="desProd"			       			   	column="DES_PROD"/>                    
		<result property="valPrecCataUnitLoca"    			   	column="VAL_PREC_CATA_UNIT_LOCA"/>              
		<result property="valPrecCataTotaLoca"    			   	column="VAL_PREC_CATA_TOTA_LOCA"/>             
		<result property="valPrecContUnitLoca"    			   	column="VAL_PREC_CONT_UNIT_LOCA"/>              
		<result property="valPrecContTotaLoca"    			   	column="VAL_PREC_CONT_TOTA_LOCA"/>              
		<result property="impDescUnitLoca"         			   	column="IMP_DESC_UNIT_LOCA"/>                   
		<result property="impDescTotaLoca"         			   	column="IMP_DESC_TOTA_LOCA"/>                   
		<result property="valPrecFactUnitLoca"    			   	column="VAL_PREC_FACT_UNIT_LOCA"/>              
		<result property="valPrecFactTotaLoca"    			   	column="VAL_PREC_FACT_TOTA_LOCA"/>              
		<result property="impImpuUnitLloca"         			column="IMP_IMPU_UNIT_LOCA"/>                  
		<result property="impImpuTotaLoca"         			   	column="IMP_IMPU_TOTA_LOCA"/>                   
		<result property="valPrecNetoUnitLoca"    			   	column="VAL_PREC_NETO_UNIT_LOCA"/>              
		<result property="valPrecNetoTotaLoca"    			   	column="VAL_PREC_NETO_TOTA_LOCA"/>              
		<result property="valPorcDesc"              			column="VAL_PORC_DESC"/> 
		                         
		          
   </resultMap>   
  
  <select id="getDocumentoLaserGuiaDetalleList" parameterClass="java.util.Map" resultMap="documentoLaserGuiaDetalleResult">
			SELECT * FROM 
			(SELECT AX.*,  ROWNUM  RNUM FROM    
			  (SELECT   X.DCCA_OID_CABE,
			         X.OID OID_LINE,
			         X.NUM_LINEA,
			         X.NUM_UNID_ATEN,
			         X.PROD_OID_PROD,
			         Y.VAL_I18N DES_PROD,
			         X.VAL_PREC_CATA_UNIT_LOCA, 
			         X.VAL_PREC_CATA_TOTA_LOCA,  
			         X.VAL_PREC_CONT_UNIT_LOCA,  
			         X.VAL_PREC_CONT_TOTA_LOCA,  
			         X.IMP_DESC_UNIT_LOCA,  
			         X.IMP_DESC_TOTA_LOCA,          
			         X.VAL_PREC_FACT_UNIT_LOCA,  
			         X.VAL_PREC_FACT_TOTA_LOCA,  
			         X.IMP_IMPU_UNIT_LOCA,  
			         X.IMP_IMPU_TOTA_LOCA,  
			         X.VAL_PREC_NETO_UNIT_LOCA,  
			         X.VAL_PREC_NETO_TOTA_LOCA,  
			         NVL(X.VAL_PORC_DESC, 0) VAL_PORC_DESC
			           
			    FROM FAC_DOCUM_CONTA_LINEA X,
			         (SELECT VAL_I18N, VAL_OID FROM GEN_I18N_SICC WHERE ATTR_ENTI = 'MAE_PRODU') Y
			   WHERE X.PROD_OID_PROD = Y.VAL_OID
			    AND  X.DCCA_OID_CABE = #oidCabe# 
			    AND  X.NUM_UNID_ATEN > 0 ) AX 
			   
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowHasta">
					<![CDATA[ROWNUM <=#rowHasta#]]>
				</isNotEmpty>
			</dynamic>) 
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowDesde">
					RNUM>=#rowDesde#
				</isNotEmpty>
		     </dynamic>
  </select>
  <procedure id="generacionDocumentosLaserGuiaXML">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_DOCUM_LASER_GUIA}
  </procedure>
   <resultMap id="documentoLaserCuentaCorrienteCabeceraResult" class="java.util.HashMap">			
		<result property="oidClie"              			column="OID_CLIE"/>                        
		<result property="codClie"               			column="COD_CLIE"/>                         
   </resultMap>   
  
  <select id="getDocumentoLaserCuentaCorrienteCabeceraList" parameterClass="java.util.Map" resultMap="documentoLaserCuentaCorrienteCabeceraResult">
		SELECT MC.OID_CLIE,
	       MC.COD_CLIE
	  FROM PED_SOLIC_CABEC CON,
	       MAE_CLIEN MC,
	       PED_TIPO_SOLIC_PAIS PTSP,
	       PED_TIPO_SOLIC PTS,
	       SEG_PAIS
	 WHERE MC.OID_CLIE = CON.CLIE_OID_CLIE
	   AND CON.FEC_FACT = TO_DATE (#fechaFacturacion#, 'DD/MM/YYYY')
	   AND CON.PERD_OID_PERI = ( SELECT gen_pkg_gener.GEN_FN_DEVUELVE_ID_CRA_PERIO(#codigoPeriodo#,
	        gen_pkg_gener.GEN_FN_DEVUELVE_ID_MARCA(#codigoMarca#),
	        gen_pkg_gener.GEN_FN_DEVUELVE_ID_CANAL(#codigoCanal#)) from dual)
	   AND SEG_PAIS.COD_PAIS = #codigoPais#
	   AND PTSP.TSOL_OID_TIPO_SOLI = PTS.OID_TIPO_SOLI
	   AND CON.TSPA_OID_TIPO_SOLI_PAIS = PTSP.OID_TIPO_SOLI_PAIS
	   AND CON.NUM_UNID_ATEN_TOTA > 0
	   AND PTS.COD_TIPO_SOLI = 'C1'
	ORDER BY MC.COD_CLIE
  </select>
  
  <select id="getSaldoActualConsultora" parameterClass="java.util.Map" resultClass="java.lang.String">
		SELECT GEN_PKG_GENER.GEN_FN_CALCU_VALOR_SALDO_VENCI(
           #oidClie#,
           GEN_PKG_GENER.GEN_FN_OBTIE_FECHA_VENCI
                            (#codigoPais#,
                             #codigoMarca#,
                             #codigoCanal#,
                             #codigoPeriodo#,
                             GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID (#oidClie#, 'COD_REGI'),
                             GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID (#oidClie#, 'COD_ZONA'),
                             #oidClie#
                            )
          ) SAL_ACTU
		FROM DUAL

  </select>
	  
	<resultMap id="documentoLaserCuentaCorrienteDetalleListResult" class="java.util.HashMap">	  
		<result property="fecEmis"				   column="FEC_EMIS"/>
		<result property="camRefe"			       column="CAM_REFE"/>
		<result property="tipMovi"			       column="TIP_MOVI"/>
		<result property="numDocu"			       column="NUM_DOCU"/>
		<result property="fecVenc"			       column="FEC_VENC"/>
		<result property="fecPago"			       column="FEC_PAGO"/>
		<result property="impCarg"			       column="IMP_CARG"/>
		<result property="impAbon"			       column="IMP_ABON"/>
		<result property="impMovi"			       column="IMP_MOVI"/>
	</resultMap>    
  
  <select id="getDocumentoLaserCuentaCorrienteDetalleList" parameterClass="java.util.Map" resultMap="documentoLaserCuentaCorrienteDetalleListResult">
		SELECT * FROM 
			(SELECT FEC_EMIS,
	                CAM_REFE,
	                TIP_MOVI,
	                NUM_DOCU,
	                FEC_VENC,
	                FEC_PAGO,
	                decode(IMP_CARG,' ',' ',to_char(IMP_CARG,'9999999999.00')) IMP_CARG,
	                decode(IMP_ABON,' ',' ',to_char(IMP_ABON,'9999999999.00')) IMP_ABON,
	                decode(IMP_MOVI,' ',' ',to_char(IMP_MOVI,'9999999999.00')) IMP_MOVI,  
					  ROWNUM  RNUM FROM   
			  (SELECT FEC_EMIS,
                       nvl(to_char(CAM_REFE),' ') CAM_REFE,
                       TIP_MOVI,
                       NUM_DOCU,
                       nvl(to_char(FEC_VENC,'dd/MM/yyyy'),' ') FEC_VENC,
                       nvl(to_char(FEC_PAGO,'dd/MM/yyyy'),' ') FEC_PAGO,
                       nvl(to_char(IMP_CARG),' ') IMP_CARG,
                       nvl(to_char(IMP_ABON),' ') IMP_ABON,
                       DECODE(IMP_CARG, NULL, IMP_ABON, -1 * IMP_CARG) IMP_MOVI
			    FROM (SELECT MCC.FEC_DOCU FEC_EMIS,
			                 SPC.COD_PERI CAM_REFE,
			                 CASE
			                    WHEN MCC.TCAB_OID_TCAB_CREA = 2001
			                       THEN CASE
			                              WHEN EXISTS (
			                                     SELECT OID_SOLI_CABE
			                                       FROM PED_SOLIC_CABEC P,
			                                            PED_TIPO_SOLIC_PAIS TP,
			                                            PED_TIPO_SOLIC T
			                                      WHERE P.SOCA_OID_SOLI_CABE = MCC.SOCA_OID_SOLI_CABE
			                                        AND P.TSPA_OID_TIPO_SOLI_PAIS = TP.OID_TIPO_SOLI_PAIS
			                                        AND TP.TSOL_OID_TIPO_SOLI = T.OID_TIPO_SOLI
			                                        AND P.IND_OC = 1
			                                        AND T.IND_SOLI_NEGA = 0)
			                                 THEN 'Pedido'
			                              ELSE CASE
			                              WHEN MCC.IMP_MOVI > 0
			                                 THEN 'AtenciÃ³n de Servicio'
			                              ELSE NVL
			                                     ((SELECT    'C'
			                                              || PERIOCORPO.COD_PERI
			                                              || ' '
			                                              || OPERA.VAL_DESC_LARG
			                                              || ' NRO.'
			                                              || CABECRECLA.NUM_RECL
			                                                                   AS DESCRIP
			                                         FROM PED_SOLIC_CABEC CONS,
			                                              PED_SOLIC_CABEC SOLICRECLA,
			                                              PED_SOLIC_CABEC SOLICORIGEN,
			                                              REC_SOLIC_OPERA SOLICOPERA,
			                                              REC_OPERA_RECLA OPERARECLA,
			                                              REC_CABEC_RECLA CABECRECLA,
			                                              REC_TIPOS_OPERA TIPOSOPERA,
			                                              REC_OPERA OPERA,
			                                              CRA_PERIO PERIO,
			                                              SEG_PERIO_CORPO PERIOCORPO
			                                        WHERE CONS.OID_SOLI_CABE = MCC.SOCA_OID_SOLI_CABE
			                                          AND CONS.OID_SOLI_CABE = SOLICRECLA.SOCA_OID_SOLI_CABE
			                                          AND SOLICRECLA.SOCA_OID_DOCU_REFE IS NOT NULL
			                                          AND SOLICRECLA.OID_SOLI_CABE = SOLICOPERA.SOCA_OID_SOLI_CABE
			                                          AND SOLICOPERA.OPRE_OID_OPER_RECL = OPERARECLA.OID_OPER_RECL
			                                          AND OPERARECLA.CARE_OID_CABE_RECL = CABECRECLA.OID_CABE_RECL
			                                          AND OPERARECLA.TIOP_OID_TIPO_OPER = TIPOSOPERA.OID_TIPO_OPER
			                                          AND TIPOSOPERA.ROPE_OID_OPER = OPERA.OID_OPER
			                                          AND SOLICRECLA.SOCA_OID_DOCU_REFE = SOLICORIGEN.OID_SOLI_CABE
			                                          AND SOLICORIGEN.PERD_OID_PERI = PERIO.OID_PERI
			                                          AND PERIO.PERI_OID_PERI = PERIOCORPO.OID_PERI
			                                          AND ROWNUM = 1),
			                                      'CDR'
			                                     )
			                           END
			                           END
			                    ELSE GEN.VAL_I18N
			                 END TIP_MOVI,
			                 MCC.SOCA_OID_SOLI_CABE SOCA_OID_SOLI_CABE,
			                 MCC.NUM_IDEN_CUOT NUM_DOCU,
			                 MCC.FEC_VENC FEC_VENC,
			                 NULL FEC_PAGO,
			                 CASE
			                    WHEN (MCC.IMP_MOVI > 0)
			                       THEN MCC.IMP_MOVI
			                    ELSE NULL
			                 END IMP_CARG,
			                 CASE
			                    WHEN (MCC.IMP_MOVI > 0)
			                       THEN NULL
			                    ELSE ABS (MCC.IMP_MOVI)
			                 END IMP_ABON
			            FROM CCC_MOVIM_CUENT_CORRI MCC,
			                 CCC_SUBPR CS,
			                 CCC_TIPO_ABONO_SUBPR TAS,
			                 CCC_TIPO_CARGO_ABONO TCA,
			                 GEN_I18N_SICC_PAIS GEN,
			                 CRA_PERIO CP,
			                 SEG_PERIO_CORPO SPC
			           WHERE MCC.SUBP_OID_SUBP_CREA = CS.OID_SUBP
			             AND CS.OID_SUBP = TAS.SUBP_OID_SUBP
			             AND TAS.TCAB_OID_TCAB = TCA.OID_TIPO_CARG_ABON
			             AND GEN.ATTR_ENTI LIKE 'CCC_TIPO_CARGO_ABONO'
			             AND GEN.VAL_OID = TCA.OID_TIPO_CARG_ABON
			             AND MCC.PERD_OID_PERI = CP.OID_PERI
			             AND CP.PERI_OID_PERI = SPC.OID_PERI
			             AND MCC.CLIE_OID_CLIE = #oidClie#
 						 /*AND ROWNUM = 1*/
			          UNION ALL
			          SELECT MB.FEC_PROC FEC_EMIS,
			                 NULL OID_PERI,
			                 CCB.DES_CC TIP_MOVI,
			                 MB.OID_MOVI_BANC SOCA_OID_SOLI_CABE,
			                 MB.NUM_LOTE NUM_DOCU,
			                 NULL FEC_VENC,
			                 MB.FEC_PAGO FEC_PAGO,
			                 NULL IMP_CARG,
			                 MB.IMP_PAGO IMP_ABON
			            FROM CCC_MOVIM_BANCA MB,
			                 CCC_CUENT_CORRI_BANCA CCB
			           WHERE MB.CCBA_OID_CC_BANC = CCB.OID_CUEN_CORR_BANC
			             AND MB.COD_IDEN_PROC = 'P'
			             AND MB.CLIE_OID_CLIE = #oidClie#)
			ORDER BY 1 DESC) AX
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowHasta">
					<![CDATA[ROWNUM <= #rowHasta#]]>
				</isNotEmpty>
			</dynamic>
			<isNotEmpty prepend="AND" property="fechaFacturacion">
					<![CDATA[fec_emis <= to_date(#fechaFacturacion#,'dd/MM/YYYY')]]> 
			</isNotEmpty>
			) 
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowDesde">
					RNUM >= #rowDesde#
				</isNotEmpty>
		     </dynamic>		    		    
			order by 1 ASC
  
  </select>
  <procedure id="deleteTablaDocumentosLaser">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_ELIMI_TABLA_DOCUM_LASER}
  </procedure>

 <procedure id="generacionDocumentosLaserCuentaCorrienteXML">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_DOCUM_LASER_CTCTE}
  </procedure>

 <update id="deleteDocumentoLaserCuentaCorrienteXML">
        TRUNCATE TABLE IMP_PAQUE_DOCUM_LASER_CTACT
 </update>
 
  <parameterMap id="executeGeneracionDocumentoLaserNotaCreditoMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
  </parameterMap>
  
  <procedure id="executeGeneracionDocumentoLaserNotaCredito" parameterMap="executeGeneracionDocumentoLaserNotaCreditoMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CALCU_DOCUM_LASER_NOCRE(?)}
  </procedure>
  
  <resultMap id="documentoLaserNotaCreditoDetalleResult" class="java.util.HashMap">			
		<result property="dccaOidCabe"              			column="DCCA_OID_CABE"/>                        
		<result property="oidLine"               				column="OID_LINE"/>                         
		<result property="numLinea"                  			column="NUM_LINEA"/>                            
		<result property="numUnidAten"              			column="NUM_UNID_ATEN"/>                        
		<result property="prodOidProd"              			column="PROD_OID_PROD"/>                        
		<result property="desProd"			       			   	column="DES_PROD"/>                    
		<result property="valPrecCataUnitLoca"    			   	column="VAL_PREC_CATA_UNIT_LOCA"/>              
		<result property="valPrecCataTotaLoca"    			   	column="VAL_PREC_CATA_TOTA_LOCA"/>             
		<result property="valPrecContUnitLoca"    			   	column="VAL_PREC_CONT_UNIT_LOCA"/>              
		<result property="valPrecContTotaLoca"    			   	column="VAL_PREC_CONT_TOTA_LOCA"/>              
		<result property="impDescUnitLoca"         			   	column="IMP_DESC_UNIT_LOCA"/>                   
		<result property="impDescTotaLoca"         			   	column="IMP_DESC_TOTA_LOCA"/>                   
		<result property="valPrecFactUnitLoca"    			   	column="VAL_PREC_FACT_UNIT_LOCA"/>              
		<result property="valPrecFactTotaLoca"    			   	column="VAL_PREC_FACT_TOTA_LOCA"/>              
		<result property="impImpuUnitLoca"         			    column="IMP_IMPU_UNIT_LOCA"/>                  
		<result property="impImpuTotaLoca"         			   	column="IMP_IMPU_TOTA_LOCA"/>                   
		<result property="valPrecNetoUnitLoca"    			   	column="VAL_PREC_NETO_UNIT_LOCA"/>              
		<result property="valPrecNetoTotaLoca"    			   	column="VAL_PREC_NETO_TOTA_LOCA"/>              
		<result property="valPorcDesc"              			column="VAL_PORC_DESC"/>
		<result property="valPrecCataUnitFact"    			   	column="VAL_PREC_CATA_UNIT_FACT"/>              
		<result property="valPrecSinImpuTotaFact"			    column="VAL_PREC_SIN_IMPU_TOTA_FACT"/>          
		<result property="impDescTotaFact"         			   	column="IMP_DESC_TOTA_FACT"/>                   
		<result property="valPrecNetoTotaFact"    			   	column="VAL_PREC_NETO_TOTA_FACT"/>              
		<result property="impImpuTotaFact"          			column="IMP_IMPU_TOTA_FACT"/> 
		                	                     
   </resultMap>   
  
  
   <select id="getDocumentoLaserNotaCreditoDetalleList" parameterClass="java.util.Map" resultMap="documentoLaserNotaCreditoDetalleResult">
			SELECT * FROM 
			(SELECT AX.*,  ROWNUM  RNUM FROM    
			  (SELECT   X.DCCA_OID_CABE,
			         X.OID OID_LINE,
			         X.NUM_LINEA,
			         X.NUM_UNID_ATEN,
			         X.PROD_OID_PROD,
			         Y.VAL_I18N DES_PROD,
			         X.VAL_PREC_CATA_UNIT_LOCA, 
			         X.VAL_PREC_CATA_TOTA_LOCA,  
			         X.VAL_PREC_CONT_UNIT_LOCA,  
			         X.VAL_PREC_CONT_TOTA_LOCA,  
			         X.IMP_DESC_UNIT_LOCA,  
			         X.IMP_DESC_TOTA_LOCA,          
			         X.VAL_PREC_FACT_UNIT_LOCA,  
			         X.VAL_PREC_FACT_TOTA_LOCA,  
			         X.IMP_IMPU_UNIT_LOCA,  
			         X.IMP_IMPU_TOTA_LOCA,  
			         X.VAL_PREC_NETO_UNIT_LOCA,  
			         X.VAL_PREC_NETO_TOTA_LOCA,  
			         NVL(X.VAL_PORC_DESC, 0) VAL_PORC_DESC,
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, X.VAL_PREC_CONT_UNIT_LOCA, X.VAL_PREC_CATA_UNIT_LOCA) VAL_PREC_CATA_UNIT_FACT,  
			         DECODE(X.VAL_PREC_CATA_TOTA_LOCA, 0, X.VAL_PREC_CONT_TOTA_LOCA, ROUND(X.VAL_PREC_CATA_TOTA_LOCA / (1 + #valTasaImpu# / 100), 2)) VAL_PREC_SIN_IMPU_TOTA_FACT, 
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, X.VAL_PREC_CONT_TOTA_LOCA, ROUND((X.VAL_PREC_CATA_TOTA_LOCA / (1 + #valTasaImpu# /100)) * (NVL(X.VAL_PORC_DESC, 0) / 100), 2)) IMP_DESC_TOTA_FACT,  
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, 0, VAL_PREC_NETO_TOTA_LOCA) VAL_PREC_NETO_TOTA_FACT, 
			         DECODE(X.VAL_PREC_CATA_TOTA_LOCA, 0, 0, X.IMP_IMPU_TOTA_LOCA) IMP_IMPU_TOTA_FACT 
			         
			    FROM FAC_DOCUM_CONTA_LINEA X,
			         (SELECT VAL_I18N, VAL_OID FROM GEN_I18N_SICC WHERE ATTR_ENTI = 'MAE_PRODU') Y
			   WHERE X.PROD_OID_PROD = Y.VAL_OID
			    AND  X.DCCA_OID_CABE = #oidCabe#
			    AND  <![CDATA[X.NUM_UNID_ATEN <> 0 ]]>
			   ORDER BY X.NUM_LINEA) AX 
			   
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowHasta">
					<![CDATA[ROWNUM <= #rowHasta#]]>
				</isNotEmpty>
			</dynamic>) 
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowDesde">
					RNUM >= #rowDesde#
				</isNotEmpty>
		     </dynamic>
  </select>
  
  <procedure id="generacionDocumentosLaserNotaCretidoXML">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_DOCUM_LASER_NOCRE}
  </procedure>
  
  
  <parameterMap id="executeGeneracionDocumentoLaserNotaDebitoMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
  </parameterMap>
  
  <procedure id="executeGeneracionDocumentoLaserNotaDebito" parameterMap="executeGeneracionDocumentoLaserNotaDebitoMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CALCU_DOCUM_LASER_NODEB(?)}
  </procedure>
  
  <resultMap id="documentoLaserNotaDebitoDetalleResult" class="java.util.HashMap">			
		<result property="dccaOidCabe"              			column="DCCA_OID_CABE"/>                        
		<result property="oidLine"               				column="OID_LINE"/>                         
		<result property="numLinea"                  			column="NUM_LINEA"/>                            
		<result property="numUnidAten"              			column="NUM_UNID_ATEN"/>                        
		<result property="prodOidProd"              			column="PROD_OID_PROD"/>                        
		<result property="desProd"			       			   	column="DES_PROD"/>                    
		<result property="valPrecCataUnitLoca"    			   	column="VAL_PREC_CATA_UNIT_LOCA"/>              
		<result property="valPrecCataTotaLoca"    			   	column="VAL_PREC_CATA_TOTA_LOCA"/>             
		<result property="valPrecContUnitLoca"    			   	column="VAL_PREC_CONT_UNIT_LOCA"/>              
		<result property="valPrecContTotaLoca"    			   	column="VAL_PREC_CONT_TOTA_LOCA"/>              
		<result property="impDescUnitLoca"         			   	column="IMP_DESC_UNIT_LOCA"/>                   
		<result property="impDescTotaLoca"         			   	column="IMP_DESC_TOTA_LOCA"/>                   
		<result property="valPrecFactUnitLoca"    			   	column="VAL_PREC_FACT_UNIT_LOCA"/>              
		<result property="valPrecFactTotaLoca"    			   	column="VAL_PREC_FACT_TOTA_LOCA"/>              
		<result property="impImpuUnitLoca"         			    column="IMP_IMPU_UNIT_LOCA"/>                  
		<result property="impImpuTotaLoca"         			   	column="IMP_IMPU_TOTA_LOCA"/>                   
		<result property="valPrecNetoUnitLoca"    			   	column="VAL_PREC_NETO_UNIT_LOCA"/>              
		<result property="valPrecNetoTotaLoca"    			   	column="VAL_PREC_NETO_TOTA_LOCA"/>              
		<result property="valPorcDesc"              			column="VAL_PORC_DESC"/>   
		<result property="valPrecCataUnitFact"    			   	column="VAL_PREC_CATA_UNIT_FACT"/>              
		<result property="valPrecSinImpuTotaFact"			    column="VAL_PREC_SIN_IMPU_TOTA_FACT"/>          
		<result property="impDescTotaFact"         			   	column="IMP_DESC_TOTA_FACT"/>                   
		<result property="valPrecNetoTotaFact"    			   	column="VAL_PREC_NETO_TOTA_FACT"/>              
		<result property="impImpuTotaFact"          			column="IMP_IMPU_TOTA_FACT"/> 
		                	                     
   </resultMap>   
  
  
   <select id="getDocumentoLaserNotaDebitoDetalleList" parameterClass="java.util.Map" resultMap="documentoLaserNotaDebitoDetalleResult">
			SELECT * FROM 
			(SELECT AX.*,  ROWNUM  RNUM FROM    
			  (SELECT   X.DCCA_OID_CABE,
			         X.OID OID_LINE,
			         X.NUM_LINEA,
			         X.NUM_UNID_ATEN,
			         X.PROD_OID_PROD,
			         Y.VAL_I18N DES_PROD,
			         X.VAL_PREC_CATA_UNIT_LOCA, 
			         X.VAL_PREC_CATA_TOTA_LOCA,  
			         X.VAL_PREC_CONT_UNIT_LOCA,  
			         X.VAL_PREC_CONT_TOTA_LOCA,  
			         X.IMP_DESC_UNIT_LOCA,  
			         X.IMP_DESC_TOTA_LOCA,          
			         X.VAL_PREC_FACT_UNIT_LOCA,  
			         X.VAL_PREC_FACT_TOTA_LOCA,  
			         X.IMP_IMPU_UNIT_LOCA,  
			         X.IMP_IMPU_TOTA_LOCA,  
			         X.VAL_PREC_NETO_UNIT_LOCA,  
			         X.VAL_PREC_NETO_TOTA_LOCA,  
			         NVL(X.VAL_PORC_DESC, 0) VAL_PORC_DESC,
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, X.VAL_PREC_CONT_UNIT_LOCA, X.VAL_PREC_CATA_UNIT_LOCA) VAL_PREC_CATA_UNIT_FACT,  
			         DECODE(X.VAL_PREC_CATA_TOTA_LOCA, 0, X.VAL_PREC_CONT_TOTA_LOCA, ROUND(X.VAL_PREC_CATA_TOTA_LOCA / (1 + #valTasaImpu# / 100), 2)) VAL_PREC_SIN_IMPU_TOTA_FACT, 
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, X.VAL_PREC_CONT_TOTA_LOCA, ROUND((X.VAL_PREC_CATA_TOTA_LOCA / (1 + #valTasaImpu# /100)) * (NVL(X.VAL_PORC_DESC, 0) / 100), 2)) IMP_DESC_TOTA_FACT,  
			         DECODE(X.VAL_PREC_CATA_UNIT_LOCA, 0, 0, VAL_PREC_NETO_TOTA_LOCA) VAL_PREC_NETO_TOTA_FACT, 
			         DECODE(X.VAL_PREC_CATA_TOTA_LOCA, 0, 0, X.IMP_IMPU_TOTA_LOCA) IMP_IMPU_TOTA_FACT 
			    FROM FAC_DOCUM_CONTA_LINEA X,
			         (SELECT VAL_I18N, VAL_OID FROM GEN_I18N_SICC WHERE ATTR_ENTI = 'MAE_PRODU') Y
			   WHERE X.PROD_OID_PROD = Y.VAL_OID
			     AND  X.DCCA_OID_CABE = #oidCabe#
			     AND   <![CDATA[X.NUM_UNID_ATEN <> 0]]>
			   ORDER BY X.NUM_LINEA) AX 
			   
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowHasta">
					<![CDATA[ROWNUM <= #rowHasta#]]>
				</isNotEmpty>
			</dynamic>) 
			<dynamic prepend="WHERE">
				<isNotEmpty prepend="AND" property="rowDesde">
					RNUM >= #rowDesde#
				</isNotEmpty>
		     </dynamic>
  </select>
  
  <procedure id="generacionDocumentosLaserNotaDebitoXML">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_DOCUM_LASER_NODEB}
  </procedure>
  
  <insert id="saveDocumentoLaserNotaCreditoAndNotaDebitoXML" parameterClass="java.util.Map">	
			  INSERT INTO IMP_TMP_GENER_DOCUM_LASER
			  (OID_CABE,
				   COD_CLIE,
				   OID_CLIE,
				   NUM_PAGI,
				   XML_PAGI,
				   COD_PAIS,
				   NUM_DOCU_CONT_INTE,
				   VAL_NUME_SOLI,
				   COD_PERI,
				   VAL_NUME_SOLI_REFE,
				   COD_PERI_REFE,
				   NUM_DOCU_LEGA,
				   COD_TIPO_DOCU,
				   FEC_EMIS,
				   VAL_SERI_DOCU_LEGA)
				VALUES
				  (#oidCabe#,
				   #codClie#,
				   #oidClie#,
				   #pagina#,
				   #documentoLaserXML#,
				   #codPais#,
				   #numDocuContInte#,
				   #valNumeSoli#,
				   #codPeri#,
				   #valNumeSoliRefe#,
				   #codPeriRefe#,
				   #numDocuLega#,
				   #codTipoDocu#,
				   #fecEmis#,
				   #valSeriDocuLega#
				 )
  </insert>
  
    <procedure id="executeActualizarIndicadorImpresionNotasCredito">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_ACTUA_NOTA_CREDI_IMPRE}
    </procedure>

    <procedure id="executeActualizarIndicadorImpresionNotasDebito">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_ACTUA_NOTA_DEBIT_IMPRE}
    </procedure>
   
   <select id="getSaldoInicialCtaCte" parameterClass="java.util.Map" resultClass="string">
   		select IMP_PKG_PROCE_COMPA.IMP_FN_CALCU_SALDO_INICI(#oidClie#, #rowHasta#, #fechaFacturacion#) from dual     
   </select>
   
    <parameterMap id="cargarHojaPicadoMap" class="map">
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeCargarHojaPicado" parameterMap="cargarHojaPicadoMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CARGA_XML_HOJA_PICAD(?, ?)}
    </procedure>

    <parameterMap id="procesaCuponesMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoFormularioCupon" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioLarissa" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioUltimoLote" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="tipoSaldoCupon" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoTipoDocumento" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaCuponesMatriciales" parameterMap="procesaCuponesMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_PROCE_CUPON_MATRI(?, ?, ?, ?, ?, ?, ?, ?)}
    </procedure>

    <parameterMap id="generaCuponesMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraCuponesMatriciales" parameterMap="generaCuponesMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_CUPON_MATRI(?, ?, ?, ?, ?)}
    </procedure>

   	<select id="getCantidadCuponesMatriciales" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(COD_CLIE) 
		FROM IMP_CUPON_MATRI
		WHERE COD_PAIS = #codigoPais#
   	</select>

    <parameterMap id="procesaFacturasMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoTipoDocumento" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioLarissa" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioUltimoLote" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaFacturasMatriciales" parameterMap="procesaFacturasMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_PROCE_FACTU_MATRI(?, ?, ?, ?, ?, ?)}
    </procedure>

    <parameterMap id="generaFacturasMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraFacturasMatriciales" parameterMap="generaFacturasMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_FACTU_MATRI(?, ?, ?, ?, ?)}
    </procedure>

   	<select id="getCantidadDocumentosMatriciales" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(COD_CLIE) 
		FROM IMP_DOCUM_CONTA_MATRI
		WHERE COD_PAIS = #codigoPais#
   	</select>

    <procedure id="executeEliminarPaquetesDocumentarios">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_ELIMI_PAQUE_DOCUM}
    </procedure>

    <parameterMap id="procesaNotasCreditoMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoTipoDocumento" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaNotasCreditoMatriciales" parameterMap="procesaNotasCreditoMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_PROCE_NOTA_CREDI(?, ?)}
    </procedure>

    <parameterMap id="generaNotasCreditoMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraNotasCreditoMatriciales" parameterMap="generaNotasCreditoMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_NOCRE_MATRI(?, ?, ?)}
    </procedure>

    <parameterMap id="procesaNotasDebitoMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoTipoDocumento" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaNotasDebitoMatriciales" parameterMap="procesaNotasDebitoMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_PROCE_NOTA_DEBIT(?, ?)}
    </procedure>

    <parameterMap id="generaNotasDebitoMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraNotasDebitoMatriciales" parameterMap="generaNotasDebitoMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_NODEB_MATRI(?, ?, ?)}
    </procedure>

    <parameterMap id="actualizaCorrelativoDocumentosMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoTipoDocumento" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeActualizaCorrelativoDocumentosMatriciales" parameterMap="actualizaCorrelativoDocumentosMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_ACTUA_CONTR_DOCUM_CONTA(?, ?)}
    </procedure>

    <parameterMap id="cargarBlobPaqueteDocumentarioMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeCargarBlobPaqueteDocumentarioSiCC" parameterMap="cargarBlobPaqueteDocumentarioMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CARGA_PAQUE_DOCUM_SICC(?, ?, ?)}
    </procedure>

    <parameterMap id="cargarBlobCuponPagoMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeCargarBlobCuponPago" parameterMap="cargarBlobCuponPagoMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_CARGA_PAQUE_DOCUM_CUPON(?, ?, ?)}
    </procedure>

    <parameterMap id="generarCuponPagoMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGenerarCuponPago" parameterMap="generarCuponPagoMap">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_PAQUE_DOCUM_CUPON(?, ?, ?)}
    </procedure>

    <parameterMap id="procesaFacturasPremioMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoTipoDocumento" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioLarissa" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioUltimoLote" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaFacturasPremioMatriciales" parameterMap="procesaFacturasPremioMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_PROCE_FACTU_PREMI_MATRI(?, ?, ?, ?, ?, ?)}
    </procedure>

    <parameterMap id="generaFacturasPremioMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraFacturasPremioMatriciales" parameterMap="generaFacturasPremioMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_FACTU_PREMI_MATRI(?, ?, ?, ?, ?)}
    </procedure>

    <parameterMap id="procesaGuiasRemisionMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoTipoDocumento" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioLarissa" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="indicadorEnvioUltimoLote" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaGuiasRemisionMatriciales" parameterMap="procesaGuiasRemisionMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_PROCE_GUIA_REMIS_MATRI(?, ?, ?, ?, ?, ?)}
    </procedure>

    <parameterMap id="generaGuiasRemisionMatricialesMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraGuiasRemisionMatriciales" parameterMap="generaGuiasRemisionMatricialesMap">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_GUIA_REMIS_MATRI(?, ?, ?, ?, ?)}
    </procedure>

    <!-- Nuevos procesos de impresion laser -->
    <parameterMap id="procesaDetallesFacturaLaserMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaDetallesFacturaLaser" parameterMap="procesaDetallesFacturaLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_DETAL_FACTU(?, ?, ?)}
    </procedure>

    <procedure id="executeReemplazaCaracteresDetallesFacturaLaser">
        {call IMP_PKG_PROCE_LASER.IMP_PR_REEMP_CARAC_DETAL_FACTU}
    </procedure>

    <parameterMap id="generaDetallesFacturaLaserMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraDetallesFacturaLaser" parameterMap="generaDetallesFacturaLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_DETAL_FACTU(?, ?, ?)}
    </procedure>

   	<select id="getCantidadDetallesFacturaLaser" parameterClass="java.util.Map" resultClass="int">
        SELECT COUNT(VAL_NUME_SOLI) 
        FROM IMP_PAQUE_DOCUM_DETAL_FACTU
   	</select>

    <parameterMap id="procesaDetallesCuentaCorrienteLaserMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaDetallesCuentaCorrienteLaser" parameterMap="procesaDetallesCuentaCorrienteLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_DETAL_CCC(?, ?, ?)}
    </procedure>

    <parameterMap id="generaDetallesCuentaCorrienteLaserMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraDetallesCuentaCorrienteLaser" parameterMap="generaDetallesCuentaCorrienteLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_DETAL_CCC(?, ?, ?)}
    </procedure>

   	<select id="getCantidadDetallesCuentaCorrienteLaser" parameterClass="java.util.Map" resultClass="int">
        SELECT COUNT(COD_CLIE) 
        FROM IMP_PAQUE_DOCUM_LASER_CTACT
   	</select>

    <procedure id="executeReemplazaCaracteresUltimasNoticiasPrivilegeLaser">
        {call IMP_PKG_PROCE_LASER.IMP_PR_REEMP_CARAC_PRIVI}
    </procedure>

    <parameterMap id="generaUltimasNoticiasPrivilegeLaserMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraUltimasNoticiasPrivilegeLaser" parameterMap="generaUltimasNoticiasPrivilegeLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_PRIVI(?, ?, ?)}
    </procedure>

   	<select id="getCantidadUltimasNoticiasPrivilegeLaser" parameterClass="java.util.Map" resultClass="int">
        SELECT COUNT(COD_CONS) 
        FROM IMP_PAQUE_DOCUM_PRIVI
   	</select>

    <parameterMap id="procesaPaquetesDocumentariosLaserMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeProcesaPaquetesDocumentariosLaser" parameterMap="procesaPaquetesDocumentariosLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_PAQUE_DOCUM(?, ?, ?)}
    </procedure>

    <procedure id="executeReemplazaCaracteresPaquetesDocumentariosLaser">
        {call IMP_PKG_PROCE_LASER.IMP_PR_REEMP_CARAC_PAQUE_DOCUM}
    </procedure>

    <parameterMap id="generaPaquetesDocumentariosLaserMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraPaquetesDocumentariosLaser" parameterMap="generaPaquetesDocumentariosLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_PAQUE_DOCUM(?, ?, ?)}
    </procedure>

   	<select id="getCantidadPaquetesDocumentariosLaser" parameterClass="java.util.Map" resultClass="int">
        SELECT COUNT(COD_CLIE) 
        FROM IMP_PAQUE_DOCUM
   	</select>


    <procedure id="executeGeneraDocumentoLaserOrdenCompraSimplificada" parameterMap="procesaPaquetesDocumentariosLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_PAQUE_DOCUM_OCS(?, ?, ?)}
    </procedure>

    <procedure id="executeGeneraDocumentoLaserBoletaDespacho" parameterMap="procesaPaquetesDocumentariosLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_PAQUE_DOCUM_BODES(?, ?, ?)}
    </procedure>

    <procedure id="executeGeneracionDocumentosLaserColor" parameterMap="procesaPaquetesDocumentariosLaserMap">
        {call IMP_PKG_PROCE_LASER_COLOR.IMP_PR_GENER_PAQUE_DOCUM_COLOR(?, ?, ?)}
    </procedure>
    
    <procedure id="executeEliminarPaquetesDocumentariosColor">
        {call IMP_PKG_PROCE_LASER_COLOR.IMP_PR_ELIMI_PAQUE_DOCUM_COLOR}
    </procedure>    
    
    <parameterMap id="generarPaqueteDocumentarioColorMap" class="map">
    	<parameter property="codigoPeriodo" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" 			jdbcType="VARCHAR" mode="IN"/>
        <parameter property="numeroDocumento" 		jdbcType="NUMBER" mode="IN"/>
        <parameter property="numeroArchivosSalida" 	jdbcType="NUMBER" mode="IN"/>
    </parameterMap>
    
    <procedure id="executeGenerarPaqueteDocumentarioColor" parameterMap="generarPaqueteDocumentarioColorMap">
        {call IMP_PKG_PROCE_LASER_COLOR.IMP_PR_PAQUE_DOCUM_COLOR_FILE(?, ?, ?, ?,?)}
    </procedure>

 	<select id="getConcursosBonificacion" parameterClass="java.util.Map" resultMap="baseResult">
		SELECT NUM_CONC AS CODIGO, 
		 	   NUM_CONC || ' - ' || VAL_NOMB AS DESCRIPCION
		  FROM INC_CONCU_PARAM_GENER gen, CRA_PERIO cra, SEG_PERIO_CORPO cor
		 WHERE gen.PERD_OID_PERI_DESD = cra.OID_PERI
		   AND cra.PERI_OID_PERI = cor.OID_PERI
		   AND gen.COIV_OID_CONC_IVR = 1
		   AND gen.CCON_OID_CLAS_CONC = 3
		   AND cor.COD_PERI = #codigoPeriodo#
		ORDER BY 1    	
     </select>
    
	<select id="getCantidadSeccionVentas" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
		  FROM IMP_INCEN_VENTA
		 WHERE COD_PERI = #codigoPeriodo#
		   AND NUM_CONC = #numeroConcurso#
		   AND IND_ACTI = '1'
	</select>  

	<delete id="deleteSeccionVentas" parameterClass="java.util.Map">
		UPDATE IMP_INCEN_VENTA
		   SET IND_ACTI = '0'
		 WHERE COD_PERI = #codigoPeriodo#
		   AND NUM_CONC = #numeroConcurso#
		   AND IND_ACTI = '1'
	</delete>     
	
	<insert id="insertListSeccionVentas" parameterClass="java.util.Map">
	   INSERT INTO IMP_INCEN_VENTA
         (NUM_CARG,
		  COD_PERI,
		  NUM_CONC,
		  COD_PERI_FINA,
		  NUM_NIVE,
		  NOM_IMAG_BASE_CONC,
		  NOM_IMAG_NIVE_ANTE,
		  NOM_IMAG_NIVE_OBTE,
		  NOM_IMAG_NIVE_SIGU,
		  NOM_IMAG_NUEV_CONC,
		  IND_ACTI,
		  COD_USUA,
		  FEC_ULTI_ACTU)
	   VALUES
	     (IMP_INVE_SEQ.NEXTVAL,
	      #1#,
	      #2#,
	      #3#,
	      #4#,
	      #5#,
	      #6#,
	      #7#,
	      #8#,
	      #9#,
	      '1',
	      #codigoUsuario#,
	      SYSDATE)
   </insert>

	<select id="getCantidadSeccionCompartamos" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
		  FROM IMP_INVIT_COMPA com, ZON_REGIO reg, ZON_ZONA zon
		 WHERE com.COD_PERI = #codigoPeriodo#
		   AND com.IND_ACTI = '1'
		   AND zon.ZORG_OID_REGI = reg.OID_REGI
		   AND zon.COD_ZONA = com.COD_ZONA
		   AND reg.COD_REGI = #codigoRegion#
	</select>  

	<select id="getValidacionSeccionCompartamos" parameterClass="java.util.Map" resultClass="string">
		SELECT IMP_PKG_PROCE_LASER_COLOR.IMP_FN_VALID_SECCI_COMPA(#codigoRegion#, #codigoZona#) FROM DUAL
	</select>  

	<delete id="deleteSeccionCompartamos" parameterClass="java.util.Map">
		UPDATE IMP_INVIT_COMPA
		   SET IND_ACTI = '0'
		 WHERE NUM_CARG IN (
					SELECT com.NUM_CARG
					  FROM IMP_INVIT_COMPA com, ZON_REGIO reg, ZON_ZONA zon
					 WHERE com.COD_PERI = #codigoPeriodo#
					   AND com.IND_ACTI = '1'
					   AND zon.ZORG_OID_REGI = reg.OID_REGI
					   AND zon.COD_ZONA = com.COD_ZONA
					   AND reg.COD_REGI = #codigoRegion#)
		 
	</delete>     
	
	<insert id="insertListSeccionCompartamos" parameterClass="java.util.Map">
	   INSERT INTO IMP_INVIT_COMPA
         (NUM_CARG,
	  	  COD_PERI,
		  COD_ZONA,
		  NOM_GERE_ZONA,
		  VAL_LOCA,
		  VAL_DIRE,
		  VAL_FECH,
		  VAL_HORA,
		  NOM_IMAG,
		  IND_ACTI,
		  COD_USUA,
		  FEC_ULTI_ACTU)
	   VALUES
	     (IMP_INCO_SEQ.NEXTVAL,
	      #1#,
	      #2#,
	      GEN_PKG_GENER.GEN_FN_CLIEN_DATOS_OID((SELECT CLIE_OID_CLIE FROM ZON_ZONA WHERE COD_ZONA = #2#), 'NOM_CLIE'),
	      #3#,	      
	      #4#,
	      #5#,
	      #6#,
	      #7#,
	      '1',
	      #codigoUsuario#,
	      SYSDATE)
	</insert>
	
	<select id="getCantidadPlanPiloto" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
		  FROM IMP_PLAN_PILOT
		 WHERE COD_PERI = #codigoPeriodo#
		   AND IND_ACTI = '1'
	</select>  

	<delete id="deletePlanPiloto" parameterClass="java.util.Map">
		UPDATE IMP_PLAN_PILOT
		   SET IND_ACTI = '0'
		 WHERE COD_PERI = #codigoPeriodo#
		   AND IND_ACTI = '1'
	</delete>
		
	<insert id="insertListPlanPiloto" parameterClass="java.util.Map">
	   INSERT INTO IMP_PLAN_PILOT
         (NUM_CARG,
	  	  COD_PERI,
	  	  COD_REGI,
		  COD_ZONA,
		  IND_ACTI,
		  COD_USUA,
		  FEC_ULTI_ACTU)
	   VALUES
	     (IMP_PLPI_SEQ.NEXTVAL,
	      #codigoPeriodo#,
	      #codigoRegion#,
	      #codigoZona#,
	      '1',
	      #codigoUsuario#,
	      SYSDATE)
   </insert>

	<select id="getCantidadSeccionFocalizados" parameterClass="java.util.Map" resultClass="int">
		SELECT COUNT(1)
		  FROM IMP_PROGR_FOCAL
		 WHERE COD_PERI = #codigoPeriodo#
		   AND IND_ACTI = '1'
	</select>  

	<select id="getValidacionSeccionFocalizados" parameterClass="java.util.Map" resultClass="string">
		SELECT IMP_PKG_PROCE_LASER_COLOR.IMP_FN_VALID_SECCI_FOCAL(#codigoZona#) FROM DUAL
	</select>  

	<delete id="deleteSeccionFocalizados" parameterClass="java.util.Map">
		UPDATE IMP_PROGR_FOCAL
		   SET IND_ACTI = '0'
		 WHERE COD_PERI = #codigoPeriodo#
		   AND IND_ACTI = '1'
	</delete>     
	
	<insert id="insertListSeccionFocalizados" parameterClass="java.util.Map">
	   INSERT INTO IMP_PROGR_FOCAL
         (NUM_CARG,
		  COD_PERI,
		  COD_ZONA,
		  NOM_IMAG_FOCA,
		  NOM_IMAG_NAC1,
		  NOM_IMAG_NAC2,
		  IND_ACTI,
		  COD_USUA,
		  FEC_ULTI_ACTU)
	   VALUES
	     (IMP_PRFO_SEQ.NEXTVAL,
	      #1#,
	      #2#,
	      #3#,
	      #4#,
	      #5#,
	      '1',
	      #codigoUsuario#,
	      SYSDATE)
   </insert>

  <parameterMap id="generaDocumentoLaserProcesoFacturaXMLMap" class="map">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoMarca" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoCanal" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>        
        
    <procedure id="executeGeneraDocumentoLaserProcesoFacturaXML" parameterMap="generaDocumentoLaserProcesoFacturaXMLMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_DOCUM_FACTU(?, ?, ?, ? ,?, ? ,? )}
    </procedure>        
    
    
    <select id="getListaRegionesActivasSpool"  resultClass="string">
		SELECT OID_REGI FROM ZON_REGIO R WHERE R.IND_ACTI ='1'
	</select>

<parameterMap id="executeProcesoIMPSpoolParams" class="procesoSpool">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>      
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>    
	
    <procedure id="executeProcesoIMPSpoolDetalleFactura" parameterMap="executeProcesoIMPSpoolParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_DETAL_FACTU2_REGI(?, ?, ?, ?)}
    </procedure>
        
<procedure id="executeSpoolCupones" parameterMap="executeProcesoIMPSpoolParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_PAQUE_DOCUM_CUP_Z(?, ?, ?, ?)}
    </procedure>

    <delete id="deleteProcesoIMPSpoolDetalleFactura">
        TRUNCATE TABLE IMP_PAQUE_DOCUM_DETAL_FACTU
    </delete>
	
    <select id="getListaZonasActivasSpool"  resultClass="string">
		SELECT OID_ZONA FROM ZON_ZONA Z WHERE Z.IND_ACTI ='1'
	</select>
    
    <delete id="deleteProcesoIMPSpoolCupones">
        TRUNCATE TABLE IMP_PAQUE_DOCUM_CUPON
    </delete>
    
    <parameterMap id="executeGeneraFacturaLaserMap" class="map">
        <parameter property="codigoPais" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoMarca" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoCanal" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="nombreArchivo" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="directorio" 		jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeGeneraFacturaLaser" parameterMap="executeGeneraFacturaLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_DOCUM_FACTU(?, ?, ?, ?, ?, ?, ?)}
    </procedure>

   	<select id="getCantidadFacturaLaser" parameterClass="java.util.Map" resultClass="int">
        SELECT COUNT(COD_CLIE) FROM IMP_PAQUE_DOCUM_LASER_FACTU
   	</select>

   	<procedure id="executeGeneraNotaCreditoLaser" parameterMap="executeGeneraFacturaLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_NOTA_CREDI(?, ?, ?, ?, ?, ?, ?)}
    </procedure>
	
   	<select id="getCantidadNotaCreditoLaser" parameterClass="java.util.Map" resultClass="int">
        SELECT COUNT(COD_CLIE) FROM IMP_NOTA_CREDI_LASER
   	</select>
	
   	<procedure id="executeGeneraNotaDebitoLaser" parameterMap="executeGeneraFacturaLaserMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_NOTA_DEBIT(?, ?, ?, ?, ?, ?, ?)}
    </procedure>

   	<select id="getCantidadNotaDebitoLaser" parameterClass="java.util.Map" resultClass="int">
        SELECT COUNT(COD_CLIE) FROM IMP_NOTA_DEBIT_LASER
   	</select>

   	<parameterMap id="executeEnviarAlmacenMap" class="map">
        <parameter property="codigoPais"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoSistema"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoInterfaz"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"        jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeEnviarAlmacen" parameterMap="executeEnviarAlmacenMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_ALMAC( ?, ?, ?, ?)}
    </procedure>

    <procedure id="executeSpoolUltimasNoticias" parameterMap="executeProcesoIMPSpoolParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_ULTIM_NOTIC_Z(?, ?, ?, ?)}
    </procedure>
    
    
     <parameterMap id="executeSpoolBoletaDespachoParams" class="procesoSpool">
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>      
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
   		<parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>        
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>     
    </parameterMap>       
    
     <procedure id="executeSpoolBoletaDespacho" parameterMap="executeSpoolBoletaDespachoParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_PAQUE_DOCUM_BDE_Z(?, ?, ?, ?)}
    </procedure>

     <procedure id="executeSpoolOrdenCompra" parameterMap="executeSpoolBoletaDespachoParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_PAQUE_DOCUM_OCS_Z(?, ?, ?, ?)}
    </procedure>
        
    <procedure id="executeSpoolEstadoCtaCte" parameterMap="executeSpoolBoletaDespachoParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_DETAL_CCC_Z(?, ?, ?, ?)}
    </procedure>        
    
     <parameterMap id="executeSpoolDetalleFacturaZonaParams" class="procesoSpool">
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>   
        <parameter property="codigoPais" jdbcType="VARCHAR" mode="IN"/>   
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>            
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>         
    </parameterMap>
    
    <procedure id="executeSpoolDetalleFacturaZona" parameterMap="executeSpoolDetalleFacturaZonaParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_DETAL_FACTU_ZONA(?, ?, ?,?)}
    </procedure>
        
 
    <!--  -->
    <procedure id="executeAsignacionStock" >
        {call ped_pkg_cuadr_ofert.ped_pr_stock()}
    </procedure>
    
     <procedure id="executeCalculoFlete" >
        {call ped_pkg_cuadr_ofert.ped_pr_flete()}
    </procedure>

    <parameterMap id="executeDocumentoChequeoParams" class="map">
        <parameter property="codigoPais"       		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeDocumentoChequeo" parameterMap="executeDocumentoChequeoParams">
        {call PED_PKG_PROCE.PED_PR_PROCE_PRINC(?)}
    </procedure>
            
    <parameterMap id="executeGeneraConsolidadoParams" class="map">
        <parameter property="codigoPeriodo"          jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="fechaFacturacion"       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoPais"       		 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeGeneraConsolidado" parameterMap="executeGeneraConsolidadoParams">
        {call FAC_PKG_PROC.fac_pr_genera_consolidado(GEN_PKG_GENER.GEN_FN_DEVUELVE_ID_CRA_PERIO2(?),?,?) }
    </procedure>
    

    <parameterMap id="executeSecuenciaPedidoParams" class="map">
        <parameter property="codigoPais"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoPeriodo"	       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="fechaFacturacion"  	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoUsuario"  	 jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeSecuenciaPedido" parameterMap="executeSecuenciaPedidoParams">
        {call APP_PKG_PROCE.APP_PR_PROCE_SECUE(?,?,?,?)}
    </procedure>                    
    <!--  -->
    <!-- spool -->
       
     <parameterMap id="executeBoletaElectronicasParams" class="procesoSpool">
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>      
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>   
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>         
    </parameterMap>
    
    <procedure id="executeBoletaElectronicas" parameterMap="executeBoletaElectronicasParams">
        {call fac_pkg_proc.fac_pr_genera_bol_elec_z(?, ?, ?)}
    </procedure>      
        
<procedure id="executeGeneraFechaRepartoMultihilo" parameterMap="executeBoletaElectronicasParams">
        {call fac_pkg_proc.fac_pr_genera_fecrep_z(?, ?, ?)}
    </procedure>        

    <parameterMap id="executeSpoolCalculaConsolidadoParams" class="procesoSpool">
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>               
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeSpoolCalculaConsolidado" parameterMap="executeSpoolCalculaConsolidadoParams">
        {call FAC_PKG_PROC.fac_pr_calculo_consolidado_z(?,?,?)}
    </procedure>
    
    <parameterMap id="executeSpoolCompaginacionFinalParams" class="procesoSpool">
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>               
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
                    
    </parameterMap>    
    
    <procedure id="executeSpoolCompaginacionFinal" parameterMap="executeSpoolCompaginacionFinalParams">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_COMPA_PAQDO_ZONA(?,?,?)}
    </procedure>

    <parameterMap id="archivoParams" class="map">
        <parameter property="codigoPais"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"	       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="directorio"  	 	   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
        
    <procedure id="executeSpoolGeneraArchivoBoletaMatricial" parameterMap="archivoParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_ARCHI_BOLET2(?, ?, ?)}
    </procedure>
    <procedure id="executeSpoolGeneraArchivoBoletaPremioMatricial" parameterMap="archivoParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_FACTU_PRE2(?, ?, ?)}
    </procedure>
    <procedure id="executeSpoolGeneraArchivoCuponPagoMatricial" parameterMap="archivoParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_CUPON2(?, ?, ?)}
    </procedure> 
    
    
    <procedure id="executeSpoolGeneraArchivoFacturaMatricial" parameterMap="archivoParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_ARCHI_FACTU2(?,?,?)}
    </procedure>
    <procedure id="executeSpoolGeneraArchivoGuiaRemisionMatricial" parameterMap="archivoParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_ARCHI_FACTU_GR2(?,?,?)}
    </procedure>
    <procedure id="executeSpoolGeneraArchivoNotaCreditoMatricial" parameterMap="archivoParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_ARCHI_NOCRE2(?,?,?)}
    </procedure>
    <procedure id="executeSpoolGeneraArchivoNotaDebitoMatricial" parameterMap="archivoParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_ARCHI_NODEB2(?,?,?)}
    </procedure>
    
     <parameterMap id="executeSpoolGeneraBoletaMatricialParams" class="procesoSpool">
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>               
    </parameterMap>   
    <procedure id="executeSpoolGeneraBoletaMatricial" parameterMap="executeSpoolGeneraBoletaMatricialParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_BOLET_MATRI_Z(?)}
    </procedure>       
        
     <parameterMap id="executeSpoolGeneraBoletaPremioMatricialParams" class="procesoSpool">
        <parameter property="oidZona" jdbcType="VARCHAR" mode="IN"/>               
    </parameterMap>           
    <procedure id="executeSpoolGeneraBoletaPremioMatricial" parameterMap="executeSpoolGeneraBoletaPremioMatricialParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_FACTU_PREMI_MAT_Z(?)}
    </procedure>
    <procedure id="executeSpoolGeneraCtaCteService" parameterMap="executeSpoolCalculaConsolidadoParams">
        {call FAC_PKG_PROC.fac_pr_genera_ccc_z(?,?,?)}
    </procedure>
    <procedure id="executeSpoolGeneraCuponMatricial" parameterMap="executeSpoolGeneraBoletaPremioMatricialParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_CUPON_MATRI_Z(?)}
    </procedure>
    <procedure id="executeSpoolGeneraDocumentosLegales" parameterMap="executeSpoolCalculaConsolidadoParams">
        {call FAC_PKG_PROC.fac_pr_genera_doclega_z(?,?,?)}
    </procedure>
    <procedure id="executeSpoolGeneraFacturaMatricial" parameterMap="executeSpoolGeneraBoletaPremioMatricialParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_FACTU_MATRI_Z(?)}
    </procedure>        
    
    
     <procedure id="executeSpoolGeneraGuiaRemisionMatricial" parameterMap="executeSpoolGeneraBoletaPremioMatricialParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_GUIA_REMIS_MAT_Z(?)}
    </procedure>
    <procedure id="executeSpoolGeneraNotaCreditoMatricial" parameterMap="executeSpoolGeneraBoletaPremioMatricialParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_NOCRE_MATRI_Z(?)}
    </procedure>
    <procedure id="executeSpoolGeneraNotaDebitoMatricial" parameterMap="executeSpoolGeneraBoletaPremioMatricialParams">
        {call IMP_PKG_PROCE_MATRI.IMP_PR_GENER_NODEB_MATRI_Z(?)}
    </procedure>
    <procedure id="executeSpoolGeneraRuv" parameterMap="executeSpoolCalculaConsolidadoParams">
        {call fac_pkg_proc.fac_pr_genera_ruv_z(?,?,?)}
    </procedure>           
    
    <parameterMap id="executeSpoolLaserMultihiloParams" class="procesoSpool">
        <parameter property="codigoPais" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="oidZona" 			jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>
    <procedure id="executeSpoolFacturaLaserMultihilo" parameterMap="executeSpoolLaserMultihiloParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_DOCUM_FAC_Z(?, ?, ?, ?)}
    </procedure>
    <procedure id="executeSpoolNotaCreditoLaserMultihilo" parameterMap="executeSpoolLaserMultihiloParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_NOTA_CRE_Z(?, ?, ?, ?)}
    </procedure>
    
    <parameterMap id="executeGeneraDocumentoInternoParams" class="map">
        <parameter property="codigoPais" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" 	jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>
    <procedure id="executeGeneraDocumentoInterno" parameterMap="executeGeneraDocumentoInternoParams">
        {call PED_PKG_PROCE.ped_pr_actua_secue_pedid2(?, ?, ?)}
    </procedure>
    
    <parameterMap id="executeGeneraPaqueteLaserParams"  class="map">
    	<parameter property="codigoPais"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"	       jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="directorio"  	 	   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeGeneraPaqueteLaser" parameterMap="executeGeneraPaqueteLaserParams">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_GENER_ARCHI_PAQDOC_FIN(?, ?, ?)}
    </procedure>
            
    <procedure id="executeGeneraDocumentoLaserProcesoNotCreditoXML" parameterMap="generaDocumentoLaserProcesoFacturaXMLMap">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_NOTA_CREDI(?, ?, ?, ? ,?, ? ,? )}
    </procedure>        
    
     <procedure id="executeSpoolNotaDebitoLaserMultihilo" parameterMap="executeSpoolLaserMultihiloParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_ENVIO_PAQUE_NOTA_DEB_Z(?, ?, ?, ?)}
    </procedure>
        
     <procedure id="executeSpoolGeneraNotaDebito" parameterMap="executeGeneraPaqueteLaserParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_NOTA_DEBIT(?, ?, ?)}
    </procedure>

     <procedure id="executeSpoolGeneraNotaCredito" parameterMap="executeGeneraPaqueteLaserParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_NOTA_CREDI(?, ?, ?)}
    </procedure>

     <procedure id="executeSpoolGeneraFacturaLaser" parameterMap="executeGeneraPaqueteLaserParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_GENER_ARCHI_FACTU_LASER(?, ?, ?)}
    </procedure>        
            
    <procedure id="executeSpoolDetalleFactura3" parameterMap="executeSpoolLaserMultihiloParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_DETAL_FACTU3_REGI(?, ?, ?, ?)}
    </procedure>
            
    
     <parameterMap id="executeSpoolCalculaConsolidadoTotalParams"  class="map">                       
        <parameter property="codigoPeriodo" jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>

    <procedure id="executeSpoolCalculaConsolidadoTotal" parameterMap="executeSpoolCalculaConsolidadoTotalParams">
        {call fac_pkg_proc.fac_pr_calculo_consolidado_z2(?,?)}
    </procedure>
    
    <procedure id="executeSpoolDetalleFactura4" parameterMap="executeSpoolLaserMultihiloParams">
        {call IMP_PKG_PROCE_LASER.IMP_PR_PROCE_DETAL_FACTU4_REGI(?, ?, ?, ?)}
    </procedure>
            
    <procedure id="executeSpoolGeneraCtaCorriente" >
        {call CCC_PKG_PROCE.CCC_PR_PROCE_CUENT_CORRI_GP5}
    </procedure>
            
     <parameterMap id="executeSpoolProcesoSecuenciacionParams" class="map">
        <parameter property="codigoPais" 		jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" 	jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>
    
     <procedure id="executeSpoolProcesoSecuenciacion" parameterMap="executeSpoolProcesoSecuenciacionParams">
        {call ped_pkg_proce.ped_pr_actua_secue_col(?,?,?)}
    </procedure>
            
     <parameterMap id="executeCompaginacionPaqueteDocumentarioFinal2Params" class="map">
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="fechaFacturacion" 	jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>
    
     <procedure id="executeCompaginacionPaqueteDocumentarioFinal2" parameterMap="executeCompaginacionPaqueteDocumentarioFinal2Params">
        {call IMP_PKG_PROCE_COMPA.IMP_PR_COMPA_PAQDO_FINAL2(?,?)}
    </procedure>
            
     <parameterMap id="executeCargaTemporalReporteErroresSTOParams" class="map">
     	<parameter property="codigoPais" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" mode="IN"/>
        <parameter property="codigoUsuario" 	jdbcType="VARCHAR" mode="IN"/>
    </parameterMap>
    
     <procedure id="executeCargaTemporalReporteErroresSTO" parameterMap="executeCargaTemporalReporteErroresSTOParams">
        {call STO_PKG_GENER.STO_PR_CARGA_TEMPO_REPO_ERRO(?,?,?)}
    </procedure>
    
    <select id="getParamEmailGerenteRegion" parameterClass="java.util.Map" resultClass="java.lang.String">
			SELECT val_para
			  FROM bas_param_pais
			 WHERE cod_pais = #codigoPais#
			   AND cod_sist = 'IMP'
			   AND nom_para = 'emaGerenteRegionDefecto'
			   AND ind_acti = '1'
   	</select>
    
    <resultMap id="mensajeResultGerenteRegionResultMap" class="java.util.HashMap">
    	<result property="codigoRegion" column="COD_REGI"/>
    	<result property="correoGerenteRegion" column="EMA_GR"/>
    	<result property="descripcionRegion" column="DES_REGI"/>
    </resultMap>
	
	<select id="getCorreosGerenteRegion" parameterClass="string" resultMap="mensajeResultGerenteRegionResultMap">
			select distinct zr.cod_regi,
			       (select mc.val_text_comu
			          from mae_clien_comun mc,
			               mae_tipo_comun mt
			          where mc.ticm_oid_tipo_comu = mt.oid_tipo_comu
			          and mt.cod_tipo_comu = 'ML'
			          and mc.clie_oid_clie = zr.clie_oid_clie
			          and rownum = 1
			           )ema_gr,
			        zr.des_regi   
			 from   (                     
					select 'FA', cc.fec_inic, cc.zzon_oid_zona
					from cra_crono cc,
					     cra_perio cp,
					     cra_activ ca,
					     bas_ctrl_fact bc
					where cp.oid_peri = cc.perd_oid_peri
					and bc.sta_camp = '0'
					and bc.ind_camp_act = '1'
					and cp.val_nomb_peri like '%'||bc.cod_peri||'%'
					and ca.oid_acti = cc.cact_oid_acti
					and ca.cod_acti = 'FA'
					) fac,
					(                     
					select 'RF', cc.fec_inic, cc.zzon_oid_zona
					from cra_crono cc,
					     cra_perio cp,
					     cra_activ ca,
					     bas_ctrl_fact bc
					where cp.oid_peri = cc.perd_oid_peri
					and bc.sta_camp = '0'
					and bc.ind_camp_act = '1'
					and cp.val_nomb_peri like '%'||bc.cod_peri||'%'
					and ca.oid_acti = cc.cact_oid_acti
					and ca.cod_acti = 'RF'
					) refac,
					zon_zona zz,
					zon_regio zr,
					bas_ctrl_fact bc
			 <![CDATA[  
			  where fac.fec_inic <= bc.fec_proc 
				and refac.fec_inic >= bc.fec_proc
			 ]]>
				and bc.sta_camp = '0'
				and bc.ind_camp_act = '1'
				and fac.zzon_oid_zona = refac.zzon_oid_zona
				and zz.oid_zona = fac.zzon_oid_zona
				and zr.oid_regi = zz.zorg_oid_regi
			                           
                and exists (SELECT 1 
			                           FROM sto_tempo_repor_error
			                          WHERE cod_usua = #value#
                               AND cod_regi_arri = zr.cod_regi )                          			                           			                  
	</select>
	
	<resultMap id="mensajeResultGerenteZonaResultMap" class="java.util.HashMap">
		<result property="codigoRegion" column="COD_REGI"/>
    	<result property="correoGerenteRegion" column="EMA_GR"/>
		<result property="codigoZona" column="COD_ZONA"/>
    	<result property="correoGerenteZona" column="EMA_GZ"/>
    	<result property="descripcionRegion" column="DES_REGI"/>
    	<result property="descripcionZona" column="DES_ZONA"/>
	</resultMap>
	
	<select id="getCorreosGerenteZona" parameterClass="string" resultMap="mensajeResultGerenteZonaResultMap">
			select distinct zr.cod_regi, 
			       (select mc.val_text_comu
			          from mae_clien_comun mc,
			               mae_tipo_comun mt
			          where mc.ticm_oid_tipo_comu = mt.oid_tipo_comu
			          and mt.cod_tipo_comu = 'ML'
			          and mc.clie_oid_clie = zr.clie_oid_clie
			          and rownum = 1
			           )ema_gr,       
			       zz.cod_zona,
			       (select mc.val_text_comu
			          from mae_clien_comun mc,
			               mae_tipo_comun mt
			          where mc.ticm_oid_tipo_comu = mt.oid_tipo_comu
			          and mt.cod_tipo_comu = 'ML'
			          and mc.clie_oid_clie = zz.clie_oid_clie
			          and rownum = 1
			           )ema_gz,
			       zr.des_regi,
			       zz.des_zona
			 from (                     
					select 'FA', cc.fec_inic, cc.zzon_oid_zona
					from cra_crono cc,
					     cra_perio cp,
					     cra_activ ca,
					     bas_ctrl_fact bc
					where cp.oid_peri = cc.perd_oid_peri
					and bc.sta_camp = '0'
					and bc.ind_camp_act = '1'
					and cp.val_nomb_peri like '%'||bc.cod_peri||'%'
					and ca.oid_acti = cc.cact_oid_acti
					and ca.cod_acti = 'FA'
					) fac,
					(                     
					select 'RF', cc.fec_inic, cc.zzon_oid_zona
					from cra_crono cc,
					     cra_perio cp,
					     cra_activ ca,
					     bas_ctrl_fact bc
					where cp.oid_peri = cc.perd_oid_peri
					and bc.sta_camp = '0'
					and bc.ind_camp_act = '1'
					and cp.val_nomb_peri like '%'||bc.cod_peri||'%'
					and ca.oid_acti = cc.cact_oid_acti
					and ca.cod_acti = 'RF'
					) refac,
					zon_zona zz,
					zon_regio zr,
					bas_ctrl_fact bc
			      <![CDATA[ 		
					where fac.fec_inic <= bc.fec_proc 
					and refac.fec_inic >= bc.fec_proc
				  ]]>
					and bc.sta_camp = '0'
					and bc.ind_camp_act = '1'
					and fac.zzon_oid_zona = refac.zzon_oid_zona
					and zz.oid_zona = fac.zzon_oid_zona
					and zr.oid_regi = zz.zorg_oid_regi
					
					AND exists (select 1 
			            FROM sto_tempo_repor_error
			           WHERE cod_usua = #value#
		                           AND cod_regi_arri = zr.cod_regi
		                           AND cod_zona_arri =  zz.cod_zona)
    </select>

    <parameterMap id="executeActualizaIndicadorGP2Params" class="map">
        <parameter property="codigoPais"          	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="codigoPeriodo"       	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="fechaFacturacion"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeActualizaIndicadorGP2" parameterMap="executeActualizaIndicadorGP2Params">
        {call OCR_SOLIC_PEDIDOS.ocr_pr_actu_indi_gp2(?,?,?) }
    </procedure>
            
    <parameterMap id="executeGenerarArchivoPaqueteDocumentarioParams" class="map">
        <parameter property="codigoPais"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="nombreArchivo"   jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="directorio"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
    </parameterMap>
    <procedure id="executeGenerarArchivoPaqueteDocumentario" parameterMap="executeGenerarArchivoPaqueteDocumentarioParams">
        {call IMP_PKG_PROCE_COMPA.imp_pr_gener_archi_paqdoc_fin2(?,?,?) }
    </procedure>    
    
 	<select id="getTipoProcesoDocElectronico" resultMap="baseResult">
 		SELECT COD_PROC AS CODIGO, DES_PROC AS DESCRIPCION FROM IMP_FELEC_TIPO_PROCE_CABEC ORDER BY 1    	
     </select>
     
	<resultMap id="pedidoControlFacturacionResult" class="pedidoControlFacturacion">       
		<result property="fechaProceso"	column="FEC_PROC" /> 
	</resultMap>       
     
  <select id="getControlFacturacionByCriteria" parameterClass="java.util.Map" resultMap="pedidoControlFacturacionResult">
		SELECT MAX(FEC_FACT) AS "FEC_PROC" FROM IMP_TMP_FELEC_CABEC
  </select>
  
  <select id="getDesdeFechaFacturacion" parameterClass="java.util.Map" resultClass="string">
		SELECT TO_CHAR((SYSDATE - TO_NUMBER(#valParaDiferenciaSysdate#)),'dd/MM/YYYY') as DATE_FACT From dual
  </select>
  
	<update id="deleteDocumentosElectonicos">
	       DELETE FROM IMP_TMP_FELEC_ARCHI
	</update>
	
    <insert id="insertDocumentosElectonicos" parameterClass="string">
        INSERT INTO IMP_TMP_FELEC_ARCHI(NUM_DOCU_ELEC,NUM_GRUP) VALUES (#value#,0)
    </insert>
    
	<resultMap id="getInterfacesDocElectronicoResult" class="java.util.HashMap">       
		<result property="codigoInterfaz"	column="COD_INTE" /> 
	</resultMap>
	    
 	<select id="getInterfacesDocElectronico" parameterClass="string" resultMap="getInterfacesDocElectronicoResult">
 		SELECT COD_INTE FROM IMP_FELEC_TIPO_PROCE_DETAL WHERE COD_PROC = #value# ORDER BY COD_INTE    	
     </select>
     
    <insert id="insertDocumentosInternos" parameterClass="java.util.Map">
		INSERT INTO imp_tmp_felec_archi(num_docu_elec)
		SELECT cab.num_docu_cont_inte
		  FROM fac_docum_conta_cabec cab,
		            fac_tipo_docum ftd,
		            imp_felec_tipo_proce_cabec ifc
		 WHERE cab.tido_oid_tipo_docu = ftd.oid_tipo_docu
		   AND ftd.cod_tipo_docu = ifc.cod_homo
		   AND cab.fec_fact >= TO_DATE (#fechaFacturacion#, 'DD/MM/YYYY')
		   AND cab.ind_proc_fact_elec = 0
    </insert>
    
	<resultMap id="getTipoDocumentosResult" class="java.util.HashMap">
		<result property="tipoDocumento"	column="TIP_DOC" />
	</resultMap>
    
 	<select id="getTipoDocumentos" parameterClass="java.util.Map" resultMap="getTipoDocumentosResult">
 		SELECT TIP_DOC FROM IMP_TMP_FELEC_CABEC WHERE FEC_FACT >= #fechaFacturacion# GROUP BY TIP_DOC ORDER BY 1
     </select>
     
    <parameterMap id="paramExecuteGeneraBoletaHonorarios" class="map">														
	    <parameter property="codigoPais" 		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoSistema"	    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoInterfaz"    jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="fechaFacturacion"  jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	    
		<parameter property="nombreArchivo"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="directorio"  	 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
		<parameter property="codigoUsuario"		jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>    
  	</parameterMap> 
        
    <procedure id="executeGeneraBoletaHonorarios" parameterMap="paramExecuteGeneraBoletaHonorarios">
        {call IMP_PKG_PROCE_ELECT.IMP_PR_PROCE_BOLET_HONOR(?, ?, ?, ? ,?, ? ,?, ? )}
    </procedure>
     
    <parameterMap id="paramInsertaDocumentosInternos" class="java.util.Map">
	    <parameter property="codigoPais" 			jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="fechaFacturacion"      jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	    <parameter property="tipoProceso"           jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
	</parameterMap>
	<procedure id="executeInsertaDocumentosInternos" parameterMap="paramInsertaDocumentosInternos">
		{call IMP_PKG_PROCE_ELECT.IMP_PR_INSER_DOCUM_INTER(?, ?, ?) }
	</procedure>
     
    <parameterMap id="paramExecuteGeneraFacturaGlobalMexico" class="map">														
	    <parameter property="codigoPeriodo" 	jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>
        <parameter property="fechaFacturacion"  jdbcType="VARCHAR" javaType="java.lang.String"  mode="IN"/>	    
  	</parameterMap> 
        
    <procedure id="executeGeneraFacturaGlobalMexico" parameterMap="paramExecuteGeneraFacturaGlobalMexico">
        {call FAC_PKG_PROC.FAC_PR_GENERA_FACT_GLOBAL(?, ?)}
    </procedure>
    
     <select id="getParametroSTO" parameterClass="java.util.Map" resultClass="java.lang.String">
     	SELECT STO_PKG_GENER.STO_FN_OBTEN_PARAM_OCR(#codigoPais#,#codigoParametro#) FROM DUAL	 
	</select>
	
	<procedure id="executeCalculoInterMora" >
        {call CCC_PKG_PROCE.CCC_PR_CALCU_INTER_MORA}
    </procedure>
    
    <select id="validacionLimiteTiempoEjecucionProceso" resultClass="java.lang.Integer">
     	select (b.fechaBasCtrlFact - a.fechaCalcuInterMora) as dia
		  from (SELECT MAX(TRUNC(FEC_PROC)) as fechaCalcuInterMora
		          FROM CCC_CONSO_CALCU_INTER_MORA) a,
		       (SELECT FEC_PROC as fechaBasCtrlFact
		          FROM BAS_CTRL_FACT
		         WHERE STA_CAMP = 0
		           AND IND_CAMP_ACT = 1) b
	</select>
         
</sqlMap>
